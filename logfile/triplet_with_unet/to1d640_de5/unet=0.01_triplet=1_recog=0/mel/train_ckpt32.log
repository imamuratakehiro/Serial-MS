
=== Using cuda(utils.func). ===

[2023-11-08 01:11:14,736][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-08 01:11:14,741][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0.01                                                       
│         recog_rate: 0                                                         
│         test_psd_mine: true                                                   
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640                         
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: true                                                             
│         n_mels: 259                                                           
│       ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-11
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0.01                                                       
│         recog_rate: 0                                                         
│         test_psd_mine: true                                                   
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/knn_avr                                                
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: 5                                                         
│         mode: max                                                             
│         auto_insert_metric_name: true                                         
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/knn_avr                                                
│         min_delta: 0.0                                                        
│         patience: 100                                                         
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 400                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 400                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       load_using_librosa: false                                               
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_psd_train: 3                                                    
│       seconds_psd_valid: 10                                                   
│       seconds_psd_test: 10                                                    
│       offset_psd_train: 1.5                                                   
│       offset_psd_valid: 5.0                                                   
│       offset_psd_test: 10.0                                                   
│       seconds_triplet_train: 3                                                
│       seconds_triplet_valid: 3                                                
│       offset_triplet_train: 1.5                                               
│       offset_triplet_valid: 1.5                                               
│       seconds_c32_train: 3                                                    
│       seconds_c32_valid: 10                                                   
│       seconds_c32_test: 10                                                    
│       offset_c32_train: 1.5                                                   
│       offset_c32_valid: 5.0                                                   
│       offset_c32_test: 10.0                                                   
│       sr: 44100                                                               
│       mel: true                                                               
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640                             
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       monitor_es: Valid/knn_avr                                               
│       monitor_mode_es: max                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 0.01                                                         
│       recog_rate: 0                                                           
│       test_psd_mine: true                                                     
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-08 01:11:14,817][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-08 01:11:14,833][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-08 01:11:18,052][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp14aw0e5t
[2023-11-08 01:11:18,052][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp14aw0e5t/_remote_module_non_scriptable.py
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=3200, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-08 01:11:20,378][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-08 01:11:20,378][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-08 01:11:20,409][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-08 01:11:20,411][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-08 01:11:20,412][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-08 01:11:20,412][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-08 01:11:20,467][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-08 01:11:20,730][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-08 01:11:20,988][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.6116225719451904 sec. *
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:07<00:00,  0.27it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 1: 100%|██████████| 2/2 [00:00<00:00,  4.36it/s]Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 2: 100%|██████████| 2/2 [00:00<00:00,  3.31it/s]Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 3: 100%|██████████| 2/2 [00:00<00:00,  3.31it/s]Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 4: 100%|██████████| 2/2 [00:00<00:00,  5.14it/s]Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 5:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 5: 100%|██████████| 2/2 [00:00<00:00,  3.06it/s]

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205168, 0.203525, 0.199812, 0.219886
Valid average loss UNet                 (all)                : 0.828391

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.145249, 0.148168, 0.204418
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.202464, 0.123607, 0.121143
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.179563, 0.267934, 0.298726
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.132588, 0.247400, 0.331514
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.121433, 0.396820, 0.496423
Valid average loss all      (Triplet)                 : 0.154896

== Recognize ==
Valid average loss Recognize     : 0.762213
Valid average accuracy drums     : 57.031250 %
Valid average accuracy bass      : 49.218750 %
Valid average accuracy piano     : 48.437500 %
Valid average accuracy guitar    : 53.906250 %
Valid average accuracy residuals : 53.906250 %

== Valid average loss all : 0.163180

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.677217960357666 sec. =
Valid knn accuracy drums     : 96.09375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.085416793823242 sec. =
Valid knn accuracy bass      : 60.9375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.285585880279541 sec. =
Valid knn accuracy piano     : 79.6875%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.02742600440979 sec. =
Valid knn accuracy guitar    : 78.125%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.2407429218292236 sec. =
Valid knn accuracy residuals : 96.875%

Valid knn accuracy average   : 82.34375%
                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s]Epoch 0:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.545, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=0.613]Epoch 0:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.545, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=0.613]Epoch 0:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.615]Epoch 0:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.615]Epoch 0:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=0.604]Epoch 0:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=0.604]Epoch 0:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.636]Epoch 0:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.636]Epoch 0:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.639]Epoch 0:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.639]Epoch 0:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.644]Epoch 0: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.644]Epoch 0: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.643]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.80it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.79it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  5.07it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.31it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.87it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:02<00:00,  5.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.126475, 0.126689, 0.116362, 0.115865
Valid average loss UNet                 (all)                : 0.485391

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.028520, 0.371108, 0.755141
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.175049, 0.414958, 0.473840
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.144877, 0.501046, 0.582645
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.070009, 0.549742, 0.830946
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.087772, 0.701122, 0.904601
Valid average loss all      (Triplet)                 : 0.096233

== Recognize ==
Valid average loss Recognize     : 0.627920
Valid average accuracy drums     : 69.500000 %
Valid average accuracy bass      : 65.500000 %
Valid average accuracy piano     : 65.500000 %
Valid average accuracy guitar    : 79.500000 %
Valid average accuracy residuals : 91.000000 %

== Valid average loss all : 0.101087

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.436667680740356 sec. =
Valid knn accuracy drums     : 80.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.572145223617554 sec. =
Valid knn accuracy bass      : 31.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.850072145462036 sec. =
Valid knn accuracy piano     : 19.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.305742263793945 sec. =
Valid knn accuracy guitar    : 55.60000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.243248701095581 sec. =
Valid knn accuracy residuals : 78.2%

Valid knn accuracy average   : 52.980000000000004%

                                                                        [AEpoch 0: 100%|██████████| 313/313 [06:28<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.643, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530]Epoch 0: 100%|██████████| 313/313 [06:28<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.643, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.123049, 0.123854, 0.124371, 0.140787
Train average loss UNet                 (all)                : 0.512060

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.051702, 0.344949, 0.657981
Train average loss bass     (Triplet, dist_p, dist_n) : 0.157544, 0.374251, 0.452317
Train average loss piano    (Triplet, dist_p, dist_n) : 0.154032, 0.503362, 0.589002
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.129766, 0.512740, 0.660325
Train average loss residuals(Triplet, dist_p, dist_n) : 0.106296, 0.692554, 0.910900
Train average loss all      (Triplet)                 : 0.120658

== Recognize ==
Train average loss Recognize     : 0.639910
Train average accuracy drums     : 59.165001 %
Train average accuracy bass      : 55.174999 %
Train average accuracy piano     : 64.195000 %
Train average accuracy guitar    : 70.150002 %
Train average accuracy residuals : 80.195000 %

== Train average loss all : 0.125779

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.643, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.643, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  16%|█▌        | 50/313 [00:43<03:50,  1.14it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.643, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  16%|█▌        | 50/313 [00:43<03:50,  1.14it/s, v_num=0, Train/loss_all_step=0.0788, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0739, Train/loss_recog_step=0.635, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  32%|███▏      | 100/313 [01:22<02:55,  1.21it/s, v_num=0, Train/loss_all_step=0.0788, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0739, Train/loss_recog_step=0.635, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  32%|███▏      | 100/313 [01:22<02:55,  1.21it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.463, Train/loss_triplet_all_step=0.0617, Train/loss_recog_step=0.642, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  48%|████▊     | 150/313 [01:59<02:10,  1.25it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.463, Train/loss_triplet_all_step=0.0617, Train/loss_recog_step=0.642, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  48%|████▊     | 150/313 [01:59<02:10,  1.25it/s, v_num=0, Train/loss_all_step=0.0776, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0728, Train/loss_recog_step=0.678, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  64%|██████▍   | 200/313 [02:38<01:29,  1.26it/s, v_num=0, Train/loss_all_step=0.0776, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0728, Train/loss_recog_step=0.678, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  64%|██████▍   | 200/313 [02:38<01:29,  1.26it/s, v_num=0, Train/loss_all_step=0.0782, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.0736, Train/loss_recog_step=0.655, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  80%|███████▉  | 250/313 [03:15<00:49,  1.28it/s, v_num=0, Train/loss_all_step=0.0782, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.0736, Train/loss_recog_step=0.655, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  80%|███████▉  | 250/313 [03:15<00:49,  1.28it/s, v_num=0, Train/loss_all_step=0.0796, Train/loss_unet_all_step=0.412, Train/loss_triplet_all_step=0.0755, Train/loss_recog_step=0.683, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  96%|█████████▌| 300/313 [03:53<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.0796, Train/loss_unet_all_step=0.412, Train/loss_triplet_all_step=0.0755, Train/loss_recog_step=0.683, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  96%|█████████▌| 300/313 [03:53<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.0762, Train/loss_unet_all_step=0.430, Train/loss_triplet_all_step=0.0719, Train/loss_recog_step=0.707, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1: 100%|██████████| 313/313 [04:01<00:00,  1.30it/s, v_num=0, Train/loss_all_step=0.0762, Train/loss_unet_all_step=0.430, Train/loss_triplet_all_step=0.0719, Train/loss_recog_step=0.707, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1: 100%|██████████| 313/313 [04:01<00:00,  1.30it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.418, Train/loss_triplet_all_step=0.0544, Train/loss_recog_step=0.687, Valid/loss_all_step=0.0613, Valid/loss_unet_all_step=0.477, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.485, Valid/loss_triplet_all_epoch=0.0962, Valid/loss_recog_epoch=0.628, Valid/knn_avr=0.530, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.09it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.08it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.77it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.54it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.03it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.41it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.127678, 0.126721, 0.115325, 0.108654
Valid average loss UNet                 (all)                : 0.478378

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.028594, 0.565620, 0.981172
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.175272, 0.586349, 0.658186
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.168301, 0.743023, 0.823937
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.075798, 0.759211, 1.099731
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.082830, 0.981366, 1.228081
Valid average loss all      (Triplet)                 : 0.100655

== Recognize ==
Valid average loss Recognize     : 0.663347
Valid average accuracy drums     : 69.500000 %
Valid average accuracy bass      : 60.500000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 82.000000 %
Valid average accuracy residuals : 79.500000 %

== Valid average loss all : 0.105438

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.209031581878662 sec. =
Valid knn accuracy drums     : 76.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.917837858200073 sec. =
Valid knn accuracy bass      : 25.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.13593339920044 sec. =
Valid knn accuracy piano     : 18.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.308690547943115 sec. =
Valid knn accuracy guitar    : 51.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.52455186843872 sec. =
Valid knn accuracy residuals : 77.10000000000001%

Valid knn accuracy average   : 49.7%

                                                                        [AEpoch 1: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.418, Train/loss_triplet_all_step=0.0544, Train/loss_recog_step=0.687, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.512, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640] Epoch 1: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.418, Train/loss_triplet_all_step=0.0544, Train/loss_recog_step=0.687, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.113572, 0.114512, 0.115095, 0.111658
Train average loss UNet                 (all)                : 0.454837

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.022528, 0.476051, 0.961234
Train average loss bass     (Triplet, dist_p, dist_n) : 0.111213, 0.510815, 0.682111
Train average loss piano    (Triplet, dist_p, dist_n) : 0.101576, 0.644246, 0.826728
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.079591, 0.674679, 0.940169
Train average loss residuals(Triplet, dist_p, dist_n) : 0.062530, 0.866577, 1.210469
Train average loss all      (Triplet)                 : 0.076244

== Recognize ==
Train average loss Recognize     : 0.664681
Train average accuracy drums     : 71.004997 %
Train average accuracy bass      : 61.865002 %
Train average accuracy piano     : 65.209999 %
Train average accuracy guitar    : 69.634995 %
Train average accuracy residuals : 72.659996 %

== Train average loss all : 0.080792

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.418, Train/loss_triplet_all_step=0.0544, Train/loss_recog_step=0.687, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.418, Train/loss_triplet_all_step=0.0544, Train/loss_recog_step=0.687, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]Epoch 2:  16%|█▌        | 50/313 [00:45<03:58,  1.10it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.418, Train/loss_triplet_all_step=0.0544, Train/loss_recog_step=0.687, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]Epoch 2:  16%|█▌        | 50/313 [00:45<03:58,  1.10it/s, v_num=0, Train/loss_all_step=0.0421, Train/loss_unet_all_step=0.436, Train/loss_triplet_all_step=0.0378, Train/loss_recog_step=0.724, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]Epoch 2:  32%|███▏      | 100/313 [01:24<02:59,  1.19it/s, v_num=0, Train/loss_all_step=0.0421, Train/loss_unet_all_step=0.436, Train/loss_triplet_all_step=0.0378, Train/loss_recog_step=0.724, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]Epoch 2:  32%|███▏      | 100/313 [01:24<02:59,  1.19it/s, v_num=0, Train/loss_all_step=0.0456, Train/loss_unet_all_step=0.444, Train/loss_triplet_all_step=0.0411, Train/loss_recog_step=0.691, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]Epoch 2:  48%|████▊     | 150/313 [02:03<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.0456, Train/loss_unet_all_step=0.444, Train/loss_triplet_all_step=0.0411, Train/loss_recog_step=0.691, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]Epoch 2:  48%|████▊     | 150/313 [02:03<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.0443, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.0393, Train/loss_recog_step=0.704, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]Epoch 2:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.0443, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.0393, Train/loss_recog_step=0.704, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]Epoch 2:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.0472, Train/loss_unet_all_step=0.421, Train/loss_triplet_all_step=0.043, Train/loss_recog_step=0.750, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665] Epoch 2:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.0472, Train/loss_unet_all_step=0.421, Train/loss_triplet_all_step=0.043, Train/loss_recog_step=0.750, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]Epoch 2:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.0391, Train/loss_unet_all_step=0.412, Train/loss_triplet_all_step=0.035, Train/loss_recog_step=0.767, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]Epoch 2:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.0391, Train/loss_unet_all_step=0.412, Train/loss_triplet_all_step=0.035, Train/loss_recog_step=0.767, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]Epoch 2:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.0442, Train/loss_unet_all_step=0.421, Train/loss_triplet_all_step=0.040, Train/loss_recog_step=0.738, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]Epoch 2: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.0442, Train/loss_unet_all_step=0.421, Train/loss_triplet_all_step=0.040, Train/loss_recog_step=0.738, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]Epoch 2: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.408, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.769, Valid/loss_all_step=0.0502, Valid/loss_unet_all_step=0.489, Valid/loss_triplet_all_step=0.0453, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.478, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.497, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.21it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:04<00:00,  3.39it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:04<00:00,  3.77it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.14it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.126428, 0.124624, 0.113286, 0.097543
Valid average loss UNet                 (all)                : 0.461881

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.028297, 0.822361, 1.283257
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.176344, 0.813982, 0.892128
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.218680, 1.101530, 1.162512
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.088537, 1.065301, 1.443029
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.076464, 1.341227, 1.638798
Valid average loss all      (Triplet)                 : 0.115258

== Recognize ==
Valid average loss Recognize     : 0.702455
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 69.000000 %
Valid average accuracy piano     : 82.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.119877

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.139362096786499 sec. =
Valid knn accuracy drums     : 74.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.284653186798096 sec. =
Valid knn accuracy bass      : 19.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.533202171325684 sec. =
Valid knn accuracy piano     : 17.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.440460681915283 sec. =
Valid knn accuracy guitar    : 52.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.794050693511963 sec. =
Valid knn accuracy residuals : 74.5%

Valid knn accuracy average   : 47.699999999999996%

                                                                        [AEpoch 2: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.408, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.769, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0808, Train/loss_unet_all_epoch=0.455, Train/loss_triplet_all_epoch=0.0762, Train/loss_recog_epoch=0.665]Epoch 2: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.408, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.769, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.110444, 0.111556, 0.112033, 0.101048
Train average loss UNet                 (all)                : 0.435082

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.008121, 0.672602, 1.285598
Train average loss bass     (Triplet, dist_p, dist_n) : 0.074517, 0.706462, 0.961954
Train average loss piano    (Triplet, dist_p, dist_n) : 0.057420, 0.866943, 1.154429
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.040572, 0.905474, 1.288669
Train average loss residuals(Triplet, dist_p, dist_n) : 0.031460, 1.130295, 1.591155
Train average loss all      (Triplet)                 : 0.043081

== Recognize ==
Train average loss Recognize     : 0.732886
Train average accuracy drums     : 54.095001 %
Train average accuracy bass      : 54.364998 %
Train average accuracy piano     : 58.149998 %
Train average accuracy guitar    : 56.884998 %
Train average accuracy residuals : 51.625000 %

== Train average loss all : 0.047432

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.408, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.769, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.408, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.769, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733]Epoch 3:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.408, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.769, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733]Epoch 3:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.440, Train/loss_triplet_all_step=0.00673, Train/loss_recog_step=0.755, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733]Epoch 3:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.440, Train/loss_triplet_all_step=0.00673, Train/loss_recog_step=0.755, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733]Epoch 3:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.0282, Train/loss_unet_all_step=0.438, Train/loss_triplet_all_step=0.0238, Train/loss_recog_step=0.756, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733] Epoch 3:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.0282, Train/loss_unet_all_step=0.438, Train/loss_triplet_all_step=0.0238, Train/loss_recog_step=0.756, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733]Epoch 3:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.812, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733]Epoch 3:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.812, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733]Epoch 3:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.429, Train/loss_triplet_all_step=0.00688, Train/loss_recog_step=0.773, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733]Epoch 3:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.429, Train/loss_triplet_all_step=0.00688, Train/loss_recog_step=0.773, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733]Epoch 3:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.403, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.781, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733] Epoch 3:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.403, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.781, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733]Epoch 3:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.0231, Train/loss_unet_all_step=0.411, Train/loss_triplet_all_step=0.019, Train/loss_recog_step=0.832, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733] Epoch 3: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.0231, Train/loss_unet_all_step=0.411, Train/loss_triplet_all_step=0.019, Train/loss_recog_step=0.832, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733]Epoch 3: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.00425, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.000203, Train/loss_recog_step=0.860, Valid/loss_all_step=0.0831, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.0785, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.120, Valid/loss_unet_all_epoch=0.462, Valid/loss_triplet_all_epoch=0.115, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.477, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.51it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  5.24it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.79it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.71it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.66it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.124158, 0.120146, 0.110421, 0.102516
Valid average loss UNet                 (all)                : 0.457240

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.033458, 1.068646, 1.688596
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.209468, 1.091108, 1.161928
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.230814, 1.474387, 1.557147
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.100869, 1.407675, 1.854563
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.097274, 1.749619, 2.052099
Valid average loss all      (Triplet)                 : 0.133657

== Recognize ==
Valid average loss Recognize     : 0.724742
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.138229

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.389446496963501 sec. =
Valid knn accuracy drums     : 73.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.381858348846436 sec. =
Valid knn accuracy bass      : 17.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.333053350448608 sec. =
Valid knn accuracy piano     : 17.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.705415964126587 sec. =
Valid knn accuracy guitar    : 50.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.408615589141846 sec. =
Valid knn accuracy residuals : 73.3%

Valid knn accuracy average   : 46.440000000000005%

                                                                        [AEpoch 3: 100%|██████████| 313/313 [06:24<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00425, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.000203, Train/loss_recog_step=0.860, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0474, Train/loss_unet_all_epoch=0.435, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.733] Epoch 3: 100%|██████████| 313/313 [06:24<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00425, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.000203, Train/loss_recog_step=0.860, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.108449, 0.109625, 0.110278, 0.096311
Train average loss UNet                 (all)                : 0.424664

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002003, 0.909800, 1.680183
Train average loss bass     (Triplet, dist_p, dist_n) : 0.041986, 0.938995, 1.294801
Train average loss piano    (Triplet, dist_p, dist_n) : 0.024221, 1.135871, 1.544970
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.016193, 1.185277, 1.696240
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011041, 1.450275, 2.049083
Train average loss all      (Triplet)                 : 0.019615

== Recognize ==
Train average loss Recognize     : 0.790760
Train average accuracy drums     : 49.485001 %
Train average accuracy bass      : 50.050003 %
Train average accuracy piano     : 50.305004 %
Train average accuracy guitar    : 49.919998 %
Train average accuracy residuals : 50.070000 %

== Train average loss all : 0.023861

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00425, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.000203, Train/loss_recog_step=0.860, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00425, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.000203, Train/loss_recog_step=0.860, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791]Epoch 4:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00425, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.000203, Train/loss_recog_step=0.860, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791]Epoch 4:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00988, Train/loss_unet_all_step=0.420, Train/loss_triplet_all_step=0.00568, Train/loss_recog_step=0.855, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791] Epoch 4:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00988, Train/loss_unet_all_step=0.420, Train/loss_triplet_all_step=0.00568, Train/loss_recog_step=0.855, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791]Epoch 4:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.408, Train/loss_triplet_all_step=0.00636, Train/loss_recog_step=0.810, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791] Epoch 4:  48%|████▊     | 150/313 [02:05<02:16,  1.20it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.408, Train/loss_triplet_all_step=0.00636, Train/loss_recog_step=0.810, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791]Epoch 4:  48%|████▊     | 150/313 [02:05<02:16,  1.20it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.442, Train/loss_triplet_all_step=0.00739, Train/loss_recog_step=0.827, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791]Epoch 4:  64%|██████▍   | 200/313 [02:43<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.442, Train/loss_triplet_all_step=0.00739, Train/loss_recog_step=0.827, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791]Epoch 4:  64%|██████▍   | 200/313 [02:43<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00549, Train/loss_unet_all_step=0.409, Train/loss_triplet_all_step=0.0014, Train/loss_recog_step=0.806, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791]Epoch 4:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00549, Train/loss_unet_all_step=0.409, Train/loss_triplet_all_step=0.0014, Train/loss_recog_step=0.806, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791]Epoch 4:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00836, Train/loss_unet_all_step=0.390, Train/loss_triplet_all_step=0.00446, Train/loss_recog_step=0.865, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791]Epoch 4:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00836, Train/loss_unet_all_step=0.390, Train/loss_triplet_all_step=0.00446, Train/loss_recog_step=0.865, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791]Epoch 4:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.412, Train/loss_triplet_all_step=0.00603, Train/loss_recog_step=0.841, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791] Epoch 4: 100%|██████████| 313/313 [04:11<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.412, Train/loss_triplet_all_step=0.00603, Train/loss_recog_step=0.841, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791]Epoch 4: 100%|██████████| 313/313 [04:11<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00754, Train/loss_unet_all_step=0.401, Train/loss_triplet_all_step=0.00353, Train/loss_recog_step=0.930, Valid/loss_all_step=0.0978, Valid/loss_unet_all_step=0.480, Valid/loss_triplet_all_step=0.093, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.457, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.464, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.75it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.82it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.62it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.91it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.122364, 0.116798, 0.107918, 0.096309
Valid average loss UNet                 (all)                : 0.443388

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.044301, 1.243932, 1.955877
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.221439, 1.315410, 1.410980
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.250392, 1.743233, 1.859382
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.119766, 1.682536, 2.135952
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.130445, 2.051261, 2.352233
Valid average loss all      (Triplet)                 : 0.152548

== Recognize ==
Valid average loss Recognize     : 0.732628
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 57.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.156982

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.183447360992432 sec. =
Valid knn accuracy drums     : 72.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.013752937316895 sec. =
Valid knn accuracy bass      : 17.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.632787466049194 sec. =
Valid knn accuracy piano     : 16.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.115329265594482 sec. =
Valid knn accuracy guitar    : 49.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.69698452949524 sec. =
Valid knn accuracy residuals : 71.39999999999999%

Valid knn accuracy average   : 45.4%

                                                                        [AEpoch 4: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00754, Train/loss_unet_all_step=0.401, Train/loss_triplet_all_step=0.00353, Train/loss_recog_step=0.930, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.425, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.791] Epoch 4: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00754, Train/loss_unet_all_step=0.401, Train/loss_triplet_all_step=0.00353, Train/loss_recog_step=0.930, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.106758, 0.107966, 0.108628, 0.092391
Train average loss UNet                 (all)                : 0.415743

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000640, 1.116336, 2.058410
Train average loss bass     (Triplet, dist_p, dist_n) : 0.019941, 1.142451, 1.602419
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009495, 1.374621, 1.897098
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006739, 1.450013, 2.098807
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004459, 1.765970, 2.505968
Train average loss all      (Triplet)                 : 0.008544

== Recognize ==
Train average loss Recognize     : 0.825879
Train average accuracy drums     : 50.075001 %
Train average accuracy bass      : 49.739998 %
Train average accuracy piano     : 49.524998 %
Train average accuracy guitar    : 49.399998 %
Train average accuracy residuals : 49.900002 %

== Train average loss all : 0.012702

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00754, Train/loss_unet_all_step=0.401, Train/loss_triplet_all_step=0.00353, Train/loss_recog_step=0.930, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00754, Train/loss_unet_all_step=0.401, Train/loss_triplet_all_step=0.00353, Train/loss_recog_step=0.930, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]Epoch 5:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00754, Train/loss_unet_all_step=0.401, Train/loss_triplet_all_step=0.00353, Train/loss_recog_step=0.930, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]Epoch 5:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00967, Train/loss_unet_all_step=0.413, Train/loss_triplet_all_step=0.00554, Train/loss_recog_step=0.851, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]Epoch 5:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00967, Train/loss_unet_all_step=0.413, Train/loss_triplet_all_step=0.00554, Train/loss_recog_step=0.851, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]Epoch 5:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00777, Train/loss_unet_all_step=0.416, Train/loss_triplet_all_step=0.00361, Train/loss_recog_step=0.857, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]Epoch 5:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00777, Train/loss_unet_all_step=0.416, Train/loss_triplet_all_step=0.00361, Train/loss_recog_step=0.857, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]Epoch 5:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00763, Train/loss_unet_all_step=0.433, Train/loss_triplet_all_step=0.0033, Train/loss_recog_step=0.846, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826] Epoch 5:  64%|██████▍   | 200/313 [02:44<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00763, Train/loss_unet_all_step=0.433, Train/loss_triplet_all_step=0.0033, Train/loss_recog_step=0.846, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]Epoch 5:  64%|██████▍   | 200/313 [02:44<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.391, Train/loss_triplet_all_step=0.00221, Train/loss_recog_step=0.880, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]Epoch 5:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.391, Train/loss_triplet_all_step=0.00221, Train/loss_recog_step=0.880, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]Epoch 5:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.393, Train/loss_triplet_all_step=0.00268, Train/loss_recog_step=0.837, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]Epoch 5:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.393, Train/loss_triplet_all_step=0.00268, Train/loss_recog_step=0.837, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]Epoch 5:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.401, Train/loss_triplet_all_step=0.000418, Train/loss_recog_step=0.825, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]Epoch 5: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.401, Train/loss_triplet_all_step=0.000418, Train/loss_recog_step=0.825, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]Epoch 5: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00809, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=0.842, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.469, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.752, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.80it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.48it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.73it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.66it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.52it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.55it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.121683, 0.117195, 0.108560, 0.088467
Valid average loss UNet                 (all)                : 0.435905

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.049573, 1.434325, 2.218090
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.216198, 1.547207, 1.682445
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.314671, 2.030919, 2.099773
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.087772, 2.034466, 2.616228
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.157697, 2.434019, 2.776647
Valid average loss all      (Triplet)                 : 0.163225

== Recognize ==
Valid average loss Recognize     : 0.785457
Valid average accuracy drums     : 42.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.167584

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.125807285308838 sec. =
Valid knn accuracy drums     : 69.69999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.47716999053955 sec. =
Valid knn accuracy bass      : 17.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.529706954956055 sec. =
Valid knn accuracy piano     : 18.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.038711547851562 sec. =
Valid knn accuracy guitar    : 50.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.147471189498901 sec. =
Valid knn accuracy residuals : 71.2%

Valid knn accuracy average   : 45.3%

                                                                        [AEpoch 5: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00809, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=0.842, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.416, Train/loss_triplet_all_epoch=0.00854, Train/loss_recog_epoch=0.826]Epoch 5: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00809, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=0.842, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.105663, 0.106955, 0.107609, 0.090930
Train average loss UNet                 (all)                : 0.411157

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000318, 1.299634, 2.385800
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010440, 1.356334, 1.920114
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004555, 1.644130, 2.287493
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003838, 1.723259, 2.496145
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002098, 2.057204, 2.940937
Train average loss all      (Triplet)                 : 0.004451

== Recognize ==
Train average loss Recognize     : 0.855493
Train average accuracy drums     : 50.164997 %
Train average accuracy bass      : 50.410004 %
Train average accuracy piano     : 49.974998 %
Train average accuracy guitar    : 49.459999 %
Train average accuracy residuals : 50.454998 %

== Train average loss all : 0.008563

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00809, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=0.842, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00809, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=0.842, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]Epoch 6:  16%|█▌        | 50/313 [00:43<03:51,  1.14it/s, v_num=0, Train/loss_all_step=0.00809, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=0.842, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]Epoch 6:  16%|█▌        | 50/313 [00:43<03:51,  1.14it/s, v_num=0, Train/loss_all_step=0.00986, Train/loss_unet_all_step=0.429, Train/loss_triplet_all_step=0.00557, Train/loss_recog_step=0.818, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]Epoch 6:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.00986, Train/loss_unet_all_step=0.429, Train/loss_triplet_all_step=0.00557, Train/loss_recog_step=0.818, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]Epoch 6:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.00464, Train/loss_unet_all_step=0.407, Train/loss_triplet_all_step=0.000575, Train/loss_recog_step=0.886, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]Epoch 6:  48%|████▊     | 150/313 [02:02<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.00464, Train/loss_unet_all_step=0.407, Train/loss_triplet_all_step=0.000575, Train/loss_recog_step=0.886, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]Epoch 6:  48%|████▊     | 150/313 [02:02<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.0087, Train/loss_unet_all_step=0.442, Train/loss_triplet_all_step=0.00427, Train/loss_recog_step=0.882, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]  Epoch 6:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.0087, Train/loss_unet_all_step=0.442, Train/loss_triplet_all_step=0.00427, Train/loss_recog_step=0.882, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]Epoch 6:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.00527, Train/loss_unet_all_step=0.392, Train/loss_triplet_all_step=0.00134, Train/loss_recog_step=0.896, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]Epoch 6:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.00527, Train/loss_unet_all_step=0.392, Train/loss_triplet_all_step=0.00134, Train/loss_recog_step=0.896, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]Epoch 6:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.00719, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.00334, Train/loss_recog_step=0.850, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]Epoch 6:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.00719, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.00334, Train/loss_recog_step=0.850, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]Epoch 6:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.014, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.969, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]   Epoch 6: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.014, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.969, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]Epoch 6: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.00398, Train/loss_unet_all_step=0.398, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.789, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.436, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.83it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.95it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.43it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.44it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.120823, 0.115684, 0.105724, 0.100696
Valid average loss UNet                 (all)                : 0.442926

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.048849, 1.654462, 2.466894
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.225065, 1.733572, 1.874030
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.374332, 2.362607, 2.354254
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.097991, 2.181012, 2.885518
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.098317, 2.541357, 2.993303
Valid average loss all      (Triplet)                 : 0.173368

== Recognize ==
Valid average loss Recognize     : 0.784666
Valid average accuracy drums     : 56.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 42.500000 %

== Valid average loss all : 0.177798

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.79984188079834 sec. =
Valid knn accuracy drums     : 70.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.706024408340454 sec. =
Valid knn accuracy bass      : 17.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.283596754074097 sec. =
Valid knn accuracy piano     : 18.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.481821775436401 sec. =
Valid knn accuracy guitar    : 51.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.400121688842773 sec. =
Valid knn accuracy residuals : 69.89999999999999%

Valid knn accuracy average   : 45.42%

                                                                        [AEpoch 6: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00398, Train/loss_unet_all_step=0.398, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00856, Train/loss_unet_all_epoch=0.411, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.855]Epoch 6: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00398, Train/loss_unet_all_step=0.398, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.104691, 0.105919, 0.106642, 0.088657
Train average loss UNet                 (all)                : 0.405909

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000927, 1.473582, 2.684712
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007475, 1.556316, 2.233566
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004610, 1.872432, 2.618397
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003659, 1.945936, 2.832734
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001536, 2.309717, 3.309528
Train average loss all      (Triplet)                 : 0.003720

== Recognize ==
Train average loss Recognize     : 0.874857
Train average accuracy drums     : 50.155003 %
Train average accuracy bass      : 49.990002 %
Train average accuracy piano     : 50.524998 %
Train average accuracy guitar    : 50.349998 %
Train average accuracy residuals : 49.724998 %

== Train average loss all : 0.007779

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00398, Train/loss_unet_all_step=0.398, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00398, Train/loss_unet_all_step=0.398, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]Epoch 7:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.00398, Train/loss_unet_all_step=0.398, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]Epoch 7:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.0075, Train/loss_unet_all_step=0.406, Train/loss_triplet_all_step=0.00344, Train/loss_recog_step=0.918, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]Epoch 7:  32%|███▏      | 100/313 [01:24<03:00,  1.18it/s, v_num=0, Train/loss_all_step=0.0075, Train/loss_unet_all_step=0.406, Train/loss_triplet_all_step=0.00344, Train/loss_recog_step=0.918, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]Epoch 7:  32%|███▏      | 100/313 [01:24<03:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00392, Train/loss_unet_all_step=0.392, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875] Epoch 7:  48%|████▊     | 150/313 [02:04<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.00392, Train/loss_unet_all_step=0.392, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]Epoch 7:  48%|████▊     | 150/313 [02:04<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.00532, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.000888, Train/loss_recog_step=0.918, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]Epoch 7:  64%|██████▍   | 200/313 [02:43<01:32,  1.23it/s, v_num=0, Train/loss_all_step=0.00532, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.000888, Train/loss_recog_step=0.918, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]Epoch 7:  64%|██████▍   | 200/313 [02:43<01:32,  1.23it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.388, Train/loss_triplet_all_step=0.00942, Train/loss_recog_step=0.914, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]  Epoch 7:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.388, Train/loss_triplet_all_step=0.00942, Train/loss_recog_step=0.914, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]Epoch 7:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00853, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.00468, Train/loss_recog_step=0.869, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]Epoch 7:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.00853, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.00468, Train/loss_recog_step=0.869, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]Epoch 7:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.00447, Train/loss_unet_all_step=0.393, Train/loss_triplet_all_step=0.000534, Train/loss_recog_step=0.892, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]Epoch 7: 100%|██████████| 313/313 [04:07<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.00447, Train/loss_unet_all_step=0.393, Train/loss_triplet_all_step=0.000534, Train/loss_recog_step=0.892, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]Epoch 7: 100%|██████████| 313/313 [04:07<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.00404, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.788, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.443, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.785, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.21it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.38it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.74it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.01it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.68it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.94it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.118506, 0.114438, 0.105005, 0.097205
Valid average loss UNet                 (all)                : 0.435153

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.032923, 1.768364, 2.837056
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.253329, 1.956672, 2.129637
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.319279, 2.535882, 2.588977
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.098963, 2.369072, 3.099682
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.116719, 2.771877, 3.207946
Valid average loss all      (Triplet)                 : 0.162226

== Recognize ==
Valid average loss Recognize     : 0.783010
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 56.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.166577

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.852038860321045 sec. =
Valid knn accuracy drums     : 72.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.166917324066162 sec. =
Valid knn accuracy bass      : 16.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.495959281921387 sec. =
Valid knn accuracy piano     : 18.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.957283020019531 sec. =
Valid knn accuracy guitar    : 49.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.222752094268799 sec. =
Valid knn accuracy residuals : 73.1%

Valid knn accuracy average   : 46.040000000000006%

                                                                        [AEpoch 7: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00404, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.406, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=0.875]Epoch 7: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00404, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.103890, 0.105038, 0.105802, 0.087406
Train average loss UNet                 (all)                : 0.402135

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001113, 1.652410, 3.042112
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007204, 1.712635, 2.455790
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005205, 2.045100, 2.866671
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002328, 2.114105, 3.085083
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001946, 2.507932, 3.596120
Train average loss all      (Triplet)                 : 0.003646

== Recognize ==
Train average loss Recognize     : 0.899954
Train average accuracy drums     : 49.500000 %
Train average accuracy bass      : 49.720001 %
Train average accuracy piano     : 50.005001 %
Train average accuracy guitar    : 49.689999 %
Train average accuracy residuals : 50.449997 %

== Train average loss all : 0.007668

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00404, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00404, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]Epoch 8:  16%|█▌        | 50/313 [00:44<03:53,  1.13it/s, v_num=0, Train/loss_all_step=0.00404, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]Epoch 8:  16%|█▌        | 50/313 [00:44<03:53,  1.13it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.422, Train/loss_triplet_all_step=0.00791, Train/loss_recog_step=0.946, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]Epoch 8:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.422, Train/loss_triplet_all_step=0.00791, Train/loss_recog_step=0.946, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]Epoch 8:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.403, Train/loss_triplet_all_step=0.00618, Train/loss_recog_step=0.912, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]Epoch 8:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.403, Train/loss_triplet_all_step=0.00618, Train/loss_recog_step=0.912, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]Epoch 8:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.429, Train/loss_triplet_all_step=0.00685, Train/loss_recog_step=0.841, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]Epoch 8:  64%|██████▍   | 200/313 [02:40<01:30,  1.24it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.429, Train/loss_triplet_all_step=0.00685, Train/loss_recog_step=0.841, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]Epoch 8:  64%|██████▍   | 200/313 [02:40<01:30,  1.24it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.391, Train/loss_triplet_all_step=0.00699, Train/loss_recog_step=0.866, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]Epoch 8:  80%|███████▉  | 250/313 [03:20<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.391, Train/loss_triplet_all_step=0.00699, Train/loss_recog_step=0.866, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]Epoch 8:  80%|███████▉  | 250/313 [03:20<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.000958, Train/loss_recog_step=0.901, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]Epoch 8:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.000958, Train/loss_recog_step=0.901, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]Epoch 8:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.00782, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.00395, Train/loss_recog_step=0.910, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900] Epoch 8: 100%|██████████| 313/313 [04:07<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.00782, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.00395, Train/loss_recog_step=0.910, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]Epoch 8: 100%|██████████| 313/313 [04:07<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.892, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.435, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.460, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.81it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.70it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.14it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.42it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.121016, 0.115226, 0.106818, 0.098745
Valid average loss UNet                 (all)                : 0.441805

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.048011, 1.954788, 3.023292
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.257443, 2.043559, 2.190310
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.401446, 2.744245, 2.782893
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.099208, 2.608879, 3.383790
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.115810, 3.003496, 3.516849
Valid average loss all      (Triplet)                 : 0.187870

== Recognize ==
Valid average loss Recognize     : 0.829350
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.192288

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.754114866256714 sec. =
Valid knn accuracy drums     : 69.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.392497539520264 sec. =
Valid knn accuracy bass      : 17.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.780767440795898 sec. =
Valid knn accuracy piano     : 17.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.277427196502686 sec. =
Valid knn accuracy guitar    : 50.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.95352578163147 sec. =
Valid knn accuracy residuals : 69.6%

Valid knn accuracy average   : 44.879999999999995%

                                                                        [AEpoch 8: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.892, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.402, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.900]Epoch 8: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.892, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.103132, 0.104449, 0.105183, 0.085531
Train average loss UNet                 (all)                : 0.398294

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001239, 1.804057, 3.277215
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006886, 1.855316, 2.680331
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004281, 2.215183, 3.116768
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003779, 2.280630, 3.340699
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002076, 2.701394, 3.881397
Train average loss all      (Triplet)                 : 0.003753

== Recognize ==
Train average loss Recognize     : 0.909587
Train average accuracy drums     : 50.410004 %
Train average accuracy bass      : 49.924999 %
Train average accuracy piano     : 49.654999 %
Train average accuracy guitar    : 49.680000 %
Train average accuracy residuals : 50.054996 %

== Train average loss all : 0.007736

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.892, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.892, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]Epoch 9:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.892, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]Epoch 9:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.00448, Train/loss_unet_all_step=0.411, Train/loss_triplet_all_step=0.000361, Train/loss_recog_step=0.881, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]Epoch 9:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00448, Train/loss_unet_all_step=0.411, Train/loss_triplet_all_step=0.000361, Train/loss_recog_step=0.881, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]Epoch 9:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00649, Train/loss_unet_all_step=0.383, Train/loss_triplet_all_step=0.00266, Train/loss_recog_step=0.959, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910] Epoch 9:  48%|████▊     | 150/313 [02:03<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.00649, Train/loss_unet_all_step=0.383, Train/loss_triplet_all_step=0.00266, Train/loss_recog_step=0.959, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]Epoch 9:  48%|████▊     | 150/313 [02:03<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.00432, Train/loss_unet_all_step=0.432, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]  Epoch 9:  64%|██████▍   | 200/313 [02:41<01:31,  1.24it/s, v_num=0, Train/loss_all_step=0.00432, Train/loss_unet_all_step=0.432, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]Epoch 9:  64%|██████▍   | 200/313 [02:41<01:31,  1.24it/s, v_num=0, Train/loss_all_step=0.00479, Train/loss_unet_all_step=0.380, Train/loss_triplet_all_step=0.000984, Train/loss_recog_step=0.965, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]Epoch 9:  80%|███████▉  | 250/313 [03:19<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.00479, Train/loss_unet_all_step=0.380, Train/loss_triplet_all_step=0.000984, Train/loss_recog_step=0.965, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]Epoch 9:  80%|███████▉  | 250/313 [03:19<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.378, Train/loss_triplet_all_step=0.014, Train/loss_recog_step=0.982, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]    Epoch 9:  96%|█████████▌| 300/313 [03:58<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.378, Train/loss_triplet_all_step=0.014, Train/loss_recog_step=0.982, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]Epoch 9:  96%|█████████▌| 300/313 [03:58<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.0064, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=0.905, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]Epoch 9: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.0064, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=0.905, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]Epoch 9: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.00238, Train/loss_recog_step=0.861, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.459, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.442, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.22it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.97it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.47it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.29it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.44it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.87it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.117035, 0.113381, 0.104127, 0.103928
Valid average loss UNet                 (all)                : 0.438471

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067281, 2.130934, 3.180193
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.264529, 2.235200, 2.406342
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.420488, 3.054233, 3.062153
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.151129, 2.812306, 3.518877
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.130277, 3.194390, 3.792285
Valid average loss all      (Triplet)                 : 0.212179

== Recognize ==
Valid average loss Recognize     : 0.810745
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.216564

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.945885181427002 sec. =
Valid knn accuracy drums     : 69.39999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.742868900299072 sec. =
Valid knn accuracy bass      : 16.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.942214250564575 sec. =
Valid knn accuracy piano     : 18.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.466506481170654 sec. =
Valid knn accuracy guitar    : 50.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.407755374908447 sec. =
Valid knn accuracy residuals : 68.8%

Valid knn accuracy average   : 44.64%

                                                                        [AEpoch 9: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.00238, Train/loss_recog_step=0.861, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.398, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=0.910]Epoch 9: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.00238, Train/loss_recog_step=0.861, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.102553, 0.103811, 0.104498, 0.085628
Train average loss UNet                 (all)                : 0.396490

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001357, 1.958545, 3.518314
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006635, 2.002403, 2.889624
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004240, 2.384127, 3.359648
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003626, 2.481282, 3.622325
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002896, 2.892753, 4.153402
Train average loss all      (Triplet)                 : 0.003840

== Recognize ==
Train average loss Recognize     : 0.929457
Train average accuracy drums     : 50.320000 %
Train average accuracy bass      : 50.070000 %
Train average accuracy piano     : 49.814999 %
Train average accuracy guitar    : 49.904999 %
Train average accuracy residuals : 50.155003 %

== Train average loss all : 0.007805

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.00238, Train/loss_recog_step=0.861, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.00238, Train/loss_recog_step=0.861, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]Epoch 10:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.00238, Train/loss_recog_step=0.861, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]Epoch 10:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.00404, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]  Epoch 10:  32%|███▏      | 100/313 [01:24<03:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00404, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]Epoch 10:  32%|███▏      | 100/313 [01:24<03:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.419, Train/loss_triplet_all_step=0.00268, Train/loss_recog_step=0.952, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]Epoch 10:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.419, Train/loss_triplet_all_step=0.00268, Train/loss_recog_step=0.952, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]Epoch 10:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.447, Train/loss_triplet_all_step=0.00245, Train/loss_recog_step=0.928, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]Epoch 10:  64%|██████▍   | 200/313 [02:43<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.447, Train/loss_triplet_all_step=0.00245, Train/loss_recog_step=0.928, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]Epoch 10:  64%|██████▍   | 200/313 [02:43<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00378, Train/loss_unet_all_step=0.378, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.934, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]  Epoch 10:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.00378, Train/loss_unet_all_step=0.378, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.934, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]Epoch 10:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.00886, Train/loss_recog_step=0.953, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]Epoch 10:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.00886, Train/loss_recog_step=0.953, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]Epoch 10:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.00955, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.00579, Train/loss_recog_step=1.000, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]Epoch 10: 100%|██████████| 313/313 [04:07<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.00955, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.00579, Train/loss_recog_step=1.000, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]Epoch 10: 100%|██████████| 313/313 [04:07<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.00463, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=1.020, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.472, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.836, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.438, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.73it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.93it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.85it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.120345, 0.113996, 0.104645, 0.084796
Valid average loss UNet                 (all)                : 0.423782

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060560, 2.163144, 3.194969
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.213973, 2.326144, 2.609636
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.376525, 3.031164, 3.110755
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.154688, 2.949314, 3.758357
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.108962, 3.323141, 3.939180
Valid average loss all      (Triplet)                 : 0.183520

== Recognize ==
Valid average loss Recognize     : 0.897632
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.187758

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.216497898101807 sec. =
Valid knn accuracy drums     : 71.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.669589757919312 sec. =
Valid knn accuracy bass      : 16.400000000000002%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.16080951690674 sec. =
Valid knn accuracy piano     : 17.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.28428339958191 sec. =
Valid knn accuracy guitar    : 50.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.415616035461426 sec. =
Valid knn accuracy residuals : 70.39999999999999%

Valid knn accuracy average   : 45.16%

                                                                        [AEpoch 10: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00463, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=1.020, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00781, Train/loss_unet_all_epoch=0.396, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.929]Epoch 10: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00463, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=1.020, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.102099, 0.103400, 0.104176, 0.084152
Train average loss UNet                 (all)                : 0.393827

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001012, 2.059559, 3.654817
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007082, 2.161449, 3.120077
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004873, 2.513094, 3.567798
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004341, 2.619591, 3.820146
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002820, 3.045876, 4.359107
Train average loss all      (Triplet)                 : 0.004088

== Recognize ==
Train average loss Recognize     : 0.944730
Train average accuracy drums     : 50.085003 %
Train average accuracy bass      : 49.395000 %
Train average accuracy piano     : 49.939999 %
Train average accuracy guitar    : 50.430000 %
Train average accuracy residuals : 49.505001 %

== Train average loss all : 0.008026

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00463, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=1.020, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00463, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=1.020, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]Epoch 11:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.00463, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=1.020, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]Epoch 11:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.00537, Train/loss_unet_all_step=0.402, Train/loss_triplet_all_step=0.00135, Train/loss_recog_step=0.942, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]Epoch 11:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00537, Train/loss_unet_all_step=0.402, Train/loss_triplet_all_step=0.00135, Train/loss_recog_step=0.942, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]Epoch 11:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.393, Train/loss_triplet_all_step=0.00441, Train/loss_recog_step=0.942, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]Epoch 11:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.393, Train/loss_triplet_all_step=0.00441, Train/loss_recog_step=0.942, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]Epoch 11:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00722, Train/loss_unet_all_step=0.418, Train/loss_triplet_all_step=0.00304, Train/loss_recog_step=0.901, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]Epoch 11:  64%|██████▍   | 200/313 [02:44<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00722, Train/loss_unet_all_step=0.418, Train/loss_triplet_all_step=0.00304, Train/loss_recog_step=0.901, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]Epoch 11:  64%|██████▍   | 200/313 [02:44<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.0212, Train/loss_unet_all_step=0.382, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=0.979, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]  Epoch 11:  80%|███████▉  | 250/313 [03:24<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.0212, Train/loss_unet_all_step=0.382, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=0.979, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]Epoch 11:  80%|███████▉  | 250/313 [03:24<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.372, Train/loss_triplet_all_step=0.00998, Train/loss_recog_step=1.020, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]Epoch 11:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.372, Train/loss_triplet_all_step=0.00998, Train/loss_recog_step=1.020, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]Epoch 11:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00635, Train/loss_unet_all_step=0.378, Train/loss_triplet_all_step=0.00257, Train/loss_recog_step=0.983, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]Epoch 11: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00635, Train/loss_unet_all_step=0.378, Train/loss_triplet_all_step=0.00257, Train/loss_recog_step=0.983, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]Epoch 11: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.386, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=0.870, Valid/loss_all_step=0.118, Valid/loss_unet_all_step=0.438, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.188, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.01it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.90it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.71it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.49it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.63it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.117823, 0.113765, 0.105049, 0.095157
Valid average loss UNet                 (all)                : 0.431795

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070104, 2.431114, 3.784246
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.265036, 2.538288, 2.792836
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.399963, 3.200945, 3.280041
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.132128, 3.106381, 3.945976
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.146563, 3.535107, 4.159292
Valid average loss all      (Triplet)                 : 0.206773

== Recognize ==
Valid average loss Recognize     : 0.870872
Valid average accuracy drums     : 44.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.211091

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.869449853897095 sec. =
Valid knn accuracy drums     : 70.89999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.127357721328735 sec. =
Valid knn accuracy bass      : 16.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.85679316520691 sec. =
Valid knn accuracy piano     : 17.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.925882339477539 sec. =
Valid knn accuracy guitar    : 51.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.151369333267212 sec. =
Valid knn accuracy residuals : 72.7%

Valid knn accuracy average   : 45.82%

                                                                        [AEpoch 11: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.386, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=0.870, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00803, Train/loss_unet_all_epoch=0.394, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.945]Epoch 11: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.386, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=0.870, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.101475, 0.102797, 0.103531, 0.083469
Train average loss UNet                 (all)                : 0.391272

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001792, 2.177907, 3.910262
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006188, 2.255535, 3.269213
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004809, 2.672476, 3.781634
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003377, 2.755008, 4.030294
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002536, 3.247630, 4.687266
Train average loss all      (Triplet)                 : 0.003756

== Recognize ==
Train average loss Recognize     : 0.943701
Train average accuracy drums     : 50.445004 %
Train average accuracy bass      : 50.164997 %
Train average accuracy piano     : 49.924999 %
Train average accuracy guitar    : 49.889999 %
Train average accuracy residuals : 50.414997 %

== Train average loss all : 0.007669

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.386, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=0.870, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.386, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=0.870, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]Epoch 12:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.386, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=0.870, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]Epoch 12:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.00396, Train/loss_unet_all_step=0.396, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.977, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944] Epoch 12:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00396, Train/loss_unet_all_step=0.396, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.977, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]Epoch 12:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.391, Train/loss_triplet_all_step=0.00649, Train/loss_recog_step=0.892, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]Epoch 12:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.391, Train/loss_triplet_all_step=0.00649, Train/loss_recog_step=0.892, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]Epoch 12:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.395, Train/loss_triplet_all_step=0.00799, Train/loss_recog_step=1.040, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]Epoch 12:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.395, Train/loss_triplet_all_step=0.00799, Train/loss_recog_step=1.040, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]Epoch 12:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00545, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.00177, Train/loss_recog_step=0.999, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]Epoch 12:  80%|███████▉  | 250/313 [03:26<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00545, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.00177, Train/loss_recog_step=0.999, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]Epoch 12:  80%|███████▉  | 250/313 [03:26<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00364, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]  Epoch 12:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00364, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]Epoch 12:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00554, Train/loss_unet_all_step=0.384, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.954, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]Epoch 12: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00554, Train/loss_unet_all_step=0.384, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.954, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]Epoch 12: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00492, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.923, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.446, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.211, Valid/loss_unet_all_epoch=0.432, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.458, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.79it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.83it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.44it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.71it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.19it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.116052, 0.113267, 0.103629, 0.098496
Valid average loss UNet                 (all)                : 0.431445

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.063413, 2.596095, 3.974746
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.274235, 2.580711, 2.880120
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.417258, 3.516338, 3.570174
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.146764, 3.276636, 4.318025
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.167382, 3.638889, 4.212267
Valid average loss all      (Triplet)                 : 0.226752

== Recognize ==
Valid average loss Recognize     : 0.843777
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.231067

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.048083543777466 sec. =
Valid knn accuracy drums     : 72.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.71470594406128 sec. =
Valid knn accuracy bass      : 17.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.38192868232727 sec. =
Valid knn accuracy piano     : 17.599999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.087156772613525 sec. =
Valid knn accuracy guitar    : 46.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.583753108978271 sec. =
Valid knn accuracy residuals : 74.5%

Valid knn accuracy average   : 45.72%

                                                                        [AEpoch 12: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00492, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.923, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.391, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.944]Epoch 12: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00492, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.923, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.101045, 0.102339, 0.103075, 0.082697
Train average loss UNet                 (all)                : 0.389155

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001568, 2.302459, 4.194235
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004727, 2.376251, 3.454190
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005243, 2.795315, 3.956140
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005611, 2.932842, 4.282983
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002893, 3.337337, 4.800485
Train average loss all      (Triplet)                 : 0.003977

== Recognize ==
Train average loss Recognize     : 0.961340
Train average accuracy drums     : 49.994999 %
Train average accuracy bass      : 49.985001 %
Train average accuracy piano     : 50.075001 %
Train average accuracy guitar    : 49.829998 %
Train average accuracy residuals : 50.160004 %

== Train average loss all : 0.007869

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00492, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.923, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00492, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.923, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]Epoch 13:  16%|█▌        | 50/313 [00:45<03:57,  1.11it/s, v_num=0, Train/loss_all_step=0.00492, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.923, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]Epoch 13:  16%|█▌        | 50/313 [00:45<03:57,  1.11it/s, v_num=0, Train/loss_all_step=0.00897, Train/loss_unet_all_step=0.397, Train/loss_triplet_all_step=0.00499, Train/loss_recog_step=0.988, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]Epoch 13:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00897, Train/loss_unet_all_step=0.397, Train/loss_triplet_all_step=0.00499, Train/loss_recog_step=0.988, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]Epoch 13:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.388, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]  Epoch 13:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.388, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]Epoch 13:  48%|████▊     | 150/313 [02:06<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.401, Train/loss_triplet_all_step=0.0073, Train/loss_recog_step=0.982, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]Epoch 13:  64%|██████▍   | 200/313 [02:44<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.401, Train/loss_triplet_all_step=0.0073, Train/loss_recog_step=0.982, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]Epoch 13:  64%|██████▍   | 200/313 [02:44<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]Epoch 13:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]Epoch 13:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00912, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=0.987, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]Epoch 13:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00912, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=0.987, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]Epoch 13:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00375, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]  Epoch 13: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00375, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]Epoch 13: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.844, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.40it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.92it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.25it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.75it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.116918, 0.112098, 0.102876, 0.097341
Valid average loss UNet                 (all)                : 0.429233

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070742, 2.721984, 4.295059
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.256517, 2.747268, 3.132249
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.455902, 3.615129, 3.704587
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.096844, 3.353713, 4.420896
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.161029, 3.796962, 4.603889
Valid average loss all      (Triplet)                 : 0.205989

== Recognize ==
Valid average loss Recognize     : 0.882669
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.210281

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.948533773422241 sec. =
Valid knn accuracy drums     : 70.39999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.392621994018555 sec. =
Valid knn accuracy bass      : 18.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.999807834625244 sec. =
Valid knn accuracy piano     : 16.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.089565992355347 sec. =
Valid knn accuracy guitar    : 47.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.066640615463257 sec. =
Valid knn accuracy residuals : 71.6%

Valid knn accuracy average   : 44.78%

                                                                        [AEpoch 13: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00787, Train/loss_unet_all_epoch=0.389, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.961]Epoch 13: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.100656, 0.101987, 0.102751, 0.082490
Train average loss UNet                 (all)                : 0.387884

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001368, 2.423650, 4.439127
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003950, 2.469024, 3.613966
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004654, 2.906426, 4.151906
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003510, 3.076310, 4.529319
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002670, 3.497549, 5.050881
Train average loss all      (Triplet)                 : 0.003282

== Recognize ==
Train average loss Recognize     : 0.961847
Train average accuracy drums     : 50.459999 %
Train average accuracy bass      : 50.605000 %
Train average accuracy piano     : 49.900002 %
Train average accuracy guitar    : 50.230003 %
Train average accuracy residuals : 50.129997 %

== Train average loss all : 0.007160

Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]          Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]Epoch 14:  16%|█▌        | 50/313 [00:45<03:57,  1.11it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]Epoch 14:  16%|█▌        | 50/313 [00:45<03:57,  1.11it/s, v_num=0, Train/loss_all_step=0.00844, Train/loss_unet_all_step=0.402, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.961, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]Epoch 14:  32%|███▏      | 100/313 [01:24<03:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00844, Train/loss_unet_all_step=0.402, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.961, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]Epoch 14:  32%|███▏      | 100/313 [01:24<03:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00536, Train/loss_unet_all_step=0.374, Train/loss_triplet_all_step=0.00163, Train/loss_recog_step=0.975, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]Epoch 14:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00536, Train/loss_unet_all_step=0.374, Train/loss_triplet_all_step=0.00163, Train/loss_recog_step=0.975, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]Epoch 14:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.434, Train/loss_triplet_all_step=0.000352, Train/loss_recog_step=0.894, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]Epoch 14:  64%|██████▍   | 200/313 [02:44<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.434, Train/loss_triplet_all_step=0.000352, Train/loss_recog_step=0.894, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]Epoch 14:  64%|██████▍   | 200/313 [02:44<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.370, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=0.974, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]  Epoch 14:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.370, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=0.974, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]Epoch 14:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00392, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000258, Train/loss_recog_step=0.954, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]Epoch 14:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00392, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000258, Train/loss_recog_step=0.954, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]Epoch 14:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.383, Train/loss_triplet_all_step=0.00219, Train/loss_recog_step=0.973, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962] Epoch 14: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.383, Train/loss_triplet_all_step=0.00219, Train/loss_recog_step=0.973, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]Epoch 14: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.00902, Train/loss_recog_step=0.988, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.429, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.82it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.47it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  5.03it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.06it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.37it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.114536, 0.111435, 0.102599, 0.096801
Valid average loss UNet                 (all)                : 0.425371

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.081453, 2.672987, 4.105162
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.282730, 2.852568, 3.185461
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.465947, 3.823315, 3.850536
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.123732, 3.450187, 4.390353
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.162258, 3.967447, 4.671975
Valid average loss all      (Triplet)                 : 0.225924

== Recognize ==
Valid average loss Recognize     : 0.925202
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.230177

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.700893640518188 sec. =
Valid knn accuracy drums     : 69.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.990957975387573 sec. =
Valid knn accuracy bass      : 17.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.402108192443848 sec. =
Valid knn accuracy piano     : 16.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.14742112159729 sec. =
Valid knn accuracy guitar    : 47.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.592145681381226 sec. =
Valid knn accuracy residuals : 70.6%

Valid knn accuracy average   : 44.2%

                                                                        [AEpoch 14: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.00902, Train/loss_recog_step=0.988, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00716, Train/loss_unet_all_epoch=0.388, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.962]Epoch 14: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.00902, Train/loss_recog_step=0.988, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.100173, 0.101407, 0.102302, 0.081063
Train average loss UNet                 (all)                : 0.384945

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000908, 2.473302, 4.497305
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006213, 2.575631, 3.764583
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003427, 2.977154, 4.269108
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003196, 3.149727, 4.646737
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003054, 3.622110, 5.261825
Train average loss all      (Triplet)                 : 0.003400

== Recognize ==
Train average loss Recognize     : 0.968288
Train average accuracy drums     : 50.305004 %
Train average accuracy bass      : 50.650002 %
Train average accuracy piano     : 49.614998 %
Train average accuracy guitar    : 49.840000 %
Train average accuracy residuals : 50.209999 %

== Train average loss all : 0.007249

Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.00902, Train/loss_recog_step=0.988, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]          Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.00902, Train/loss_recog_step=0.988, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]Epoch 15:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.00902, Train/loss_recog_step=0.988, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]Epoch 15:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.393, Train/loss_triplet_all_step=0.00889, Train/loss_recog_step=0.954, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]Epoch 15:  32%|███▏      | 100/313 [01:26<03:04,  1.16it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.393, Train/loss_triplet_all_step=0.00889, Train/loss_recog_step=0.954, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]Epoch 15:  32%|███▏      | 100/313 [01:26<03:04,  1.16it/s, v_num=0, Train/loss_all_step=0.00379, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968] Epoch 15:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00379, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]Epoch 15:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.412, Train/loss_triplet_all_step=0.00924, Train/loss_recog_step=0.988, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]Epoch 15:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.412, Train/loss_triplet_all_step=0.00924, Train/loss_recog_step=0.988, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]Epoch 15:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.00422, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.00053, Train/loss_recog_step=0.993, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]Epoch 15:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00422, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.00053, Train/loss_recog_step=0.993, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]Epoch 15:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00713, Train/loss_unet_all_step=0.366, Train/loss_triplet_all_step=0.00346, Train/loss_recog_step=0.982, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]Epoch 15:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00713, Train/loss_unet_all_step=0.366, Train/loss_triplet_all_step=0.00346, Train/loss_recog_step=0.982, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]Epoch 15:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.0038, Train/loss_unet_all_step=0.380, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]   Epoch 15: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.0038, Train/loss_unet_all_step=0.380, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]Epoch 15: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.0036, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.99it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.52it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.58it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.69it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.01it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.114307, 0.111780, 0.102932, 0.096719
Valid average loss UNet                 (all)                : 0.425738

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.089751, 2.848636, 4.364879
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.276889, 2.903428, 3.307546
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.476282, 3.919380, 3.934993
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.090435, 3.554212, 4.751098
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.172363, 4.099595, 4.702726
Valid average loss all      (Triplet)                 : 0.221075

== Recognize ==
Valid average loss Recognize     : 0.864418
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.225333

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.838494062423706 sec. =
Valid knn accuracy drums     : 68.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.91038179397583 sec. =
Valid knn accuracy bass      : 15.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.259312868118286 sec. =
Valid knn accuracy piano     : 17.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.23580288887024 sec. =
Valid knn accuracy guitar    : 49.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.65556263923645 sec. =
Valid knn accuracy residuals : 70.6%

Valid knn accuracy average   : 44.2%

                                                                        [AEpoch 15: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0036, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00725, Train/loss_unet_all_epoch=0.385, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.968]Epoch 15: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0036, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.099847, 0.101115, 0.101922, 0.080749
Train average loss UNet                 (all)                : 0.383633

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000423, 2.535119, 4.609129
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004752, 2.672488, 3.921055
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004555, 3.114314, 4.450672
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004027, 3.250587, 4.804080
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002143, 3.720036, 5.444269
Train average loss all      (Triplet)                 : 0.003185

== Recognize ==
Train average loss Recognize     : 0.974393
Train average accuracy drums     : 50.150002 %
Train average accuracy bass      : 50.120003 %
Train average accuracy piano     : 49.829998 %
Train average accuracy guitar    : 50.510002 %
Train average accuracy residuals : 50.155003 %

== Train average loss all : 0.007021

Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0036, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]          Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0036, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]Epoch 16:  16%|█▌        | 50/313 [00:45<03:59,  1.10it/s, v_num=0, Train/loss_all_step=0.0036, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]Epoch 16:  16%|█▌        | 50/313 [00:45<03:59,  1.10it/s, v_num=0, Train/loss_all_step=0.00386, Train/loss_unet_all_step=0.386, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]Epoch 16:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00386, Train/loss_unet_all_step=0.386, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]Epoch 16:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00393, Train/loss_unet_all_step=0.393, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]Epoch 16:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00393, Train/loss_unet_all_step=0.393, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]Epoch 16:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.405, Train/loss_triplet_all_step=0.000663, Train/loss_recog_step=0.920, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]Epoch 16:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.405, Train/loss_triplet_all_step=0.000663, Train/loss_recog_step=0.920, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]Epoch 16:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.00648, Train/loss_recog_step=1.040, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]  Epoch 16:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.00648, Train/loss_recog_step=1.040, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]Epoch 16:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00369, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974] Epoch 16:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00369, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]Epoch 16:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00374, Train/loss_unet_all_step=0.374, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]Epoch 16: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00374, Train/loss_unet_all_step=0.374, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]Epoch 16: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.00959, Train/loss_recog_step=1.010, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.439, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.27it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.80it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.80it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.93it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.61it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.114591, 0.111530, 0.102589, 0.095824
Valid average loss UNet                 (all)                : 0.424534

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.071124, 2.850314, 4.538252
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.374823, 3.093049, 3.348911
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.590933, 4.083125, 4.056106
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.115221, 3.656706, 4.784760
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.226364, 4.502989, 5.081487
Valid average loss all      (Triplet)                 : 0.276942

== Recognize ==
Valid average loss Recognize     : 0.897681
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 44.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.281187

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.006666660308838 sec. =
Valid knn accuracy drums     : 68.89999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.39429497718811 sec. =
Valid knn accuracy bass      : 15.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.736475229263306 sec. =
Valid knn accuracy piano     : 17.299999999999997%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.508861780166626 sec. =
Valid knn accuracy guitar    : 46.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.191008806228638 sec. =
Valid knn accuracy residuals : 71.1%

Valid knn accuracy average   : 43.92%

                                                                        [AEpoch 16: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.00959, Train/loss_recog_step=1.010, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00702, Train/loss_unet_all_epoch=0.384, Train/loss_triplet_all_epoch=0.00318, Train/loss_recog_epoch=0.974]Epoch 16: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.00959, Train/loss_recog_step=1.010, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.099577, 0.100951, 0.101672, 0.079989
Train average loss UNet                 (all)                : 0.382189

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000544, 2.636243, 4.765650
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004519, 2.794176, 4.109597
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004466, 3.294391, 4.734393
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003036, 3.402886, 5.051073
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001906, 3.890997, 5.679638
Train average loss all      (Triplet)                 : 0.002962

== Recognize ==
Train average loss Recognize     : 0.987598
Train average accuracy drums     : 49.875000 %
Train average accuracy bass      : 50.054996 %
Train average accuracy piano     : 49.389999 %
Train average accuracy guitar    : 50.510002 %
Train average accuracy residuals : 50.089996 %

== Train average loss all : 0.006784

Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.00959, Train/loss_recog_step=1.010, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988]          Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.00959, Train/loss_recog_step=1.010, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988]Epoch 17:  16%|█▌        | 50/313 [00:45<03:58,  1.10it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.00959, Train/loss_recog_step=1.010, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988]Epoch 17:  16%|█▌        | 50/313 [00:45<03:58,  1.10it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.394, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=1.020, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988] Epoch 17:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.394, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=1.020, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988]Epoch 17:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00523, Train/loss_unet_all_step=0.390, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=0.988, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988]Epoch 17:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00523, Train/loss_unet_all_step=0.390, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=0.988, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988]Epoch 17:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.424, Train/loss_triplet_all_step=0.00668, Train/loss_recog_step=1.070, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988] Epoch 17:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.424, Train/loss_triplet_all_step=0.00668, Train/loss_recog_step=1.070, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988]Epoch 17:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988] Epoch 17:  80%|███████▉  | 250/313 [03:26<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988]Epoch 17:  80%|███████▉  | 250/313 [03:26<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00724, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.00357, Train/loss_recog_step=0.974, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988]Epoch 17:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00724, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.00357, Train/loss_recog_step=0.974, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988]Epoch 17:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00761, Train/loss_unet_all_step=0.366, Train/loss_triplet_all_step=0.00395, Train/loss_recog_step=1.050, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988]Epoch 17: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00761, Train/loss_unet_all_step=0.366, Train/loss_triplet_all_step=0.00395, Train/loss_recog_step=1.050, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988]Epoch 17: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.00132, Train/loss_recog_step=1.010, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.843, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.14it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.54it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.86it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.55it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.115997, 0.112493, 0.103358, 0.087413
Valid average loss UNet                 (all)                : 0.419261

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.078441, 2.874092, 4.775937
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.370470, 3.047220, 3.353739
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.476769, 4.052660, 4.162583
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.140327, 3.851425, 4.931552
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.272338, 4.452956, 5.014127
Valid average loss all      (Triplet)                 : 0.259742

== Recognize ==
Valid average loss Recognize     : 0.906887
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 57.000000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.263934

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.375497341156006 sec. =
Valid knn accuracy drums     : 68.30000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.638092041015625 sec. =
Valid knn accuracy bass      : 16.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.318100452423096 sec. =
Valid knn accuracy piano     : 18.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.717306852340698 sec. =
Valid knn accuracy guitar    : 47.199999999999996%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.345390558242798 sec. =
Valid knn accuracy residuals : 68.60000000000001%

Valid knn accuracy average   : 43.74000000000001%

                                                                        [AEpoch 17: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.00132, Train/loss_recog_step=1.010, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00678, Train/loss_unet_all_epoch=0.382, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=0.988]Epoch 17: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.00132, Train/loss_recog_step=1.010, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.099230, 0.100548, 0.101349, 0.079828
Train average loss UNet                 (all)                : 0.380956

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000826, 2.633165, 4.764310
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005034, 2.803865, 4.126158
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003589, 3.261378, 4.701387
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002506, 3.389339, 5.050495
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002694, 3.880280, 5.715579
Train average loss all      (Triplet)                 : 0.003022

== Recognize ==
Train average loss Recognize     : 0.994281
Train average accuracy drums     : 50.105000 %
Train average accuracy bass      : 50.094997 %
Train average accuracy piano     : 49.724998 %
Train average accuracy guitar    : 49.665001 %
Train average accuracy residuals : 49.875000 %

== Train average loss all : 0.006832

Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.00132, Train/loss_recog_step=1.010, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]          Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.00132, Train/loss_recog_step=1.010, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]Epoch 18:  16%|█▌        | 50/313 [00:45<04:00,  1.10it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.00132, Train/loss_recog_step=1.010, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]Epoch 18:  16%|█▌        | 50/313 [00:45<04:00,  1.10it/s, v_num=0, Train/loss_all_step=0.00404, Train/loss_unet_all_step=0.382, Train/loss_triplet_all_step=0.00022, Train/loss_recog_step=1.020, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]Epoch 18:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00404, Train/loss_unet_all_step=0.382, Train/loss_triplet_all_step=0.00022, Train/loss_recog_step=1.020, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]Epoch 18:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00385, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]  Epoch 18:  48%|████▊     | 150/313 [02:04<02:15,  1.21it/s, v_num=0, Train/loss_all_step=0.00385, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]Epoch 18:  48%|████▊     | 150/313 [02:04<02:15,  1.21it/s, v_num=0, Train/loss_all_step=0.00418, Train/loss_unet_all_step=0.418, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]Epoch 18:  64%|██████▍   | 200/313 [02:44<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00418, Train/loss_unet_all_step=0.418, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]Epoch 18:  64%|██████▍   | 200/313 [02:44<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]Epoch 18:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]Epoch 18:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]Epoch 18:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]Epoch 18:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00393, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.000161, Train/loss_recog_step=0.988, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]Epoch 18: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00393, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.000161, Train/loss_recog_step=0.988, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]Epoch 18: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.264, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.260, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.20it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.72it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.30it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:02<00:00,  5.38it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.84it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.112816, 0.111052, 0.102418, 0.105060
Valid average loss UNet                 (all)                : 0.431346

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.069716, 2.906949, 4.747395
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.309745, 2.993762, 3.362182
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.534129, 4.077168, 4.155733
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.143942, 3.800857, 4.941071
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.190750, 4.405484, 5.013187
Valid average loss all      (Triplet)                 : 0.243724

== Recognize ==
Valid average loss Recognize     : 0.912994
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.248037

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.738686323165894 sec. =
Valid knn accuracy drums     : 70.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.543803691864014 sec. =
Valid knn accuracy bass      : 15.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.930806398391724 sec. =
Valid knn accuracy piano     : 17.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.285833835601807 sec. =
Valid knn accuracy guitar    : 49.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.618941307067871 sec. =
Valid knn accuracy residuals : 66.2%

Valid knn accuracy average   : 43.82%

                                                                        [AEpoch 18: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00683, Train/loss_unet_all_epoch=0.381, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=0.994]Epoch 18: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.098934, 0.100334, 0.101024, 0.079669
Train average loss UNet                 (all)                : 0.379960

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000889, 2.689597, 4.963185
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004452, 2.827934, 4.164041
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002694, 3.331664, 4.827742
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003117, 3.441051, 5.150126
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002169, 3.903315, 5.731686
Train average loss all      (Triplet)                 : 0.002704

== Recognize ==
Train average loss Recognize     : 0.994352
Train average accuracy drums     : 49.709999 %
Train average accuracy bass      : 49.599998 %
Train average accuracy piano     : 50.704998 %
Train average accuracy guitar    : 50.585003 %
Train average accuracy residuals : 49.649998 %

== Train average loss all : 0.006504

Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]          Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]Epoch 19:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]Epoch 19:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]Epoch 19:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]Epoch 19:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.004, Train/loss_unet_all_step=0.400, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.983, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]  Epoch 19:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.004, Train/loss_unet_all_step=0.400, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.983, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]Epoch 19:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.0043, Train/loss_unet_all_step=0.430, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]Epoch 19:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.0043, Train/loss_unet_all_step=0.430, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]Epoch 19:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.00231, Train/loss_recog_step=1.010, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]Epoch 19:  80%|███████▉  | 250/313 [03:26<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.00231, Train/loss_recog_step=1.010, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]Epoch 19:  80%|███████▉  | 250/313 [03:26<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]  Epoch 19:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]Epoch 19:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00785, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.00417, Train/loss_recog_step=1.010, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]Epoch 19: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00785, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.00417, Train/loss_recog_step=1.010, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]Epoch 19: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.431, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.09it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.95it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.65it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.45it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.112183, 0.111110, 0.102081, 0.099382
Valid average loss UNet                 (all)                : 0.424757

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065850, 2.983683, 4.829581
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.326156, 3.114063, 3.456509
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.591861, 4.332616, 4.318649
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.163555, 3.942154, 5.193182
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.203881, 4.388643, 4.978145
Valid average loss all      (Triplet)                 : 0.267303

== Recognize ==
Valid average loss Recognize     : 0.931923
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.271551

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.16217041015625 sec. =
Valid knn accuracy drums     : 72.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.841458082199097 sec. =
Valid knn accuracy bass      : 13.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.33732557296753 sec. =
Valid knn accuracy piano     : 19.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.991883754730225 sec. =
Valid knn accuracy guitar    : 45.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.531024932861328 sec. =
Valid knn accuracy residuals : 68.30000000000001%

Valid knn accuracy average   : 43.92%

                                                                        [AEpoch 19: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0065, Train/loss_unet_all_epoch=0.380, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.994]Epoch 19: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.098567, 0.099898, 0.100633, 0.078510
Train average loss UNet                 (all)                : 0.377608

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000397, 2.796678, 5.171589
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003739, 2.930392, 4.333720
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002290, 3.433201, 4.988706
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002258, 3.531111, 5.297397
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001552, 4.038751, 5.921045
Train average loss all      (Triplet)                 : 0.002055

== Recognize ==
Train average loss Recognize     : 1.011068
Train average accuracy drums     : 49.689999 %
Train average accuracy bass      : 50.570000 %
Train average accuracy piano     : 50.035000 %
Train average accuracy guitar    : 49.125000 %
Train average accuracy residuals : 49.654999 %

== Train average loss all : 0.005831

Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]          Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]Epoch 20:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]Epoch 20:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.00605, Train/loss_recog_step=0.968, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]Epoch 20:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.00605, Train/loss_recog_step=0.968, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]Epoch 20:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00395, Train/loss_unet_all_step=0.395, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]Epoch 20:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00395, Train/loss_unet_all_step=0.395, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]Epoch 20:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00406, Train/loss_unet_all_step=0.406, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]Epoch 20:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00406, Train/loss_unet_all_step=0.406, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]Epoch 20:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00953, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.00596, Train/loss_recog_step=1.020, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]Epoch 20:  80%|███████▉  | 250/313 [03:27<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00953, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.00596, Train/loss_recog_step=1.020, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]Epoch 20:  80%|███████▉  | 250/313 [03:27<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.997, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]  Epoch 20:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.997, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]Epoch 20:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00409, Train/loss_unet_all_step=0.374, Train/loss_triplet_all_step=0.000348, Train/loss_recog_step=0.988, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]Epoch 20: 100%|██████████| 313/313 [04:15<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.00409, Train/loss_unet_all_step=0.374, Train/loss_triplet_all_step=0.000348, Train/loss_recog_step=0.988, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]Epoch 20: 100%|██████████| 313/313 [04:15<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.195, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.19it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.98it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.92it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.45it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.20it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.114207, 0.111150, 0.104556, 0.093286
Valid average loss UNet                 (all)                : 0.423200

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.074751, 3.026027, 4.888865
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.306780, 3.354542, 3.799297
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.549080, 4.352804, 4.462803
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.173218, 4.120592, 5.225380
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.270307, 4.569675, 5.143129
Valid average loss all      (Triplet)                 : 0.269175

== Recognize ==
Valid average loss Recognize     : 0.925515
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.273407

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.004019260406494 sec. =
Valid knn accuracy drums     : 70.19999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.452651023864746 sec. =
Valid knn accuracy bass      : 14.799999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.450237274169922 sec. =
Valid knn accuracy piano     : 17.299999999999997%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.890949487686157 sec. =
Valid knn accuracy guitar    : 47.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.555808305740356 sec. =
Valid knn accuracy residuals : 67.10000000000001%

Valid knn accuracy average   : 43.36000000000001%

                                                                        [AEpoch 20: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.010]Epoch 20: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.098420, 0.099722, 0.100444, 0.078916
Train average loss UNet                 (all)                : 0.377502

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000926, 2.842687, 5.230435
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005762, 3.058579, 4.503932
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003211, 3.533399, 5.110531
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002907, 3.609685, 5.414859
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002259, 4.058464, 5.956250
Train average loss all      (Triplet)                 : 0.002954

== Recognize ==
Train average loss Recognize     : 1.011862
Train average accuracy drums     : 49.685001 %
Train average accuracy bass      : 49.889999 %
Train average accuracy piano     : 50.309998 %
Train average accuracy guitar    : 49.424999 %
Train average accuracy residuals : 50.505001 %

== Train average loss all : 0.006729

Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]          Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]Epoch 21:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]Epoch 21:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.00391, Train/loss_unet_all_step=0.391, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]Epoch 21:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00391, Train/loss_unet_all_step=0.391, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]Epoch 21:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00376, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]Epoch 21:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00376, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]Epoch 21:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00426, Train/loss_unet_all_step=0.408, Train/loss_triplet_all_step=0.000175, Train/loss_recog_step=1.080, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]Epoch 21:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00426, Train/loss_unet_all_step=0.408, Train/loss_triplet_all_step=0.000175, Train/loss_recog_step=1.080, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]Epoch 21:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00616, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.00264, Train/loss_recog_step=1.140, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010] Epoch 21:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00616, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.00264, Train/loss_recog_step=1.140, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]Epoch 21:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]  Epoch 21:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]Epoch 21:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.00302, Train/loss_recog_step=1.090, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]Epoch 21: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.00302, Train/loss_recog_step=1.090, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]Epoch 21: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.437, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.21it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.02it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.85it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.95it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.01it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.113314, 0.111068, 0.103284, 0.098292
Valid average loss UNet                 (all)                : 0.425957

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.074005, 3.091625, 4.988585
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.423604, 3.435247, 3.766321
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.527054, 4.600721, 4.697791
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.152454, 4.106480, 5.237162
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.328522, 4.704084, 5.201645
Valid average loss all      (Triplet)                 : 0.287116

== Recognize ==
Valid average loss Recognize     : 0.961491
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 39.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.291376

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.00715446472168 sec. =
Valid knn accuracy drums     : 68.10000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.680297136306763 sec. =
Valid knn accuracy bass      : 16.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.643394947052002 sec. =
Valid knn accuracy piano     : 17.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.190252780914307 sec. =
Valid knn accuracy guitar    : 45.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.573281288146973 sec. =
Valid knn accuracy residuals : 68.4%

Valid knn accuracy average   : 43.220000000000006%

                                                                        [AEpoch 21: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00673, Train/loss_unet_all_epoch=0.378, Train/loss_triplet_all_epoch=0.00295, Train/loss_recog_epoch=1.010]Epoch 21: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.097995, 0.099377, 0.100214, 0.078523
Train average loss UNet                 (all)                : 0.376110

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001156, 2.961626, 5.398362
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004809, 3.109961, 4.608308
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004416, 3.630744, 5.229317
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002632, 3.717434, 5.568516
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002200, 4.155841, 6.109759
Train average loss all      (Triplet)                 : 0.003047

== Recognize ==
Train average loss Recognize     : 1.039259
Train average accuracy drums     : 50.279999 %
Train average accuracy bass      : 50.424999 %
Train average accuracy piano     : 50.620003 %
Train average accuracy guitar    : 49.489998 %
Train average accuracy residuals : 49.695000 %

== Train average loss all : 0.006808

Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]          Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]Epoch 22:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]Epoch 22:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00376, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]Epoch 22:  32%|███▏      | 100/313 [01:24<02:59,  1.19it/s, v_num=0, Train/loss_all_step=0.00376, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]Epoch 22:  32%|███▏      | 100/313 [01:24<02:59,  1.19it/s, v_num=0, Train/loss_all_step=0.00528, Train/loss_unet_all_step=0.389, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.956, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]Epoch 22:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.00528, Train/loss_unet_all_step=0.389, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.956, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]Epoch 22:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.0041, Train/loss_unet_all_step=0.410, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]   Epoch 22:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.0041, Train/loss_unet_all_step=0.410, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]Epoch 22:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.00341, Train/loss_recog_step=1.100, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]Epoch 22:  80%|███████▉  | 250/313 [03:20<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.00341, Train/loss_recog_step=1.100, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]Epoch 22:  80%|███████▉  | 250/313 [03:20<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.00463, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=1.070, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]Epoch 22:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.00463, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=1.070, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]Epoch 22:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.0095, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.00574, Train/loss_recog_step=0.956, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]Epoch 22: 100%|██████████| 313/313 [04:07<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.0095, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.00574, Train/loss_recog_step=0.956, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]Epoch 22: 100%|██████████| 313/313 [04:07<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.426, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.19it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.68it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.70it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.67it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.88it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.112190, 0.110023, 0.101453, 0.097802
Valid average loss UNet                 (all)                : 0.421469

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.080123, 3.111154, 4.812892
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.401152, 3.561322, 3.932145
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.523380, 4.629868, 4.759800
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.202810, 4.324244, 5.530066
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.376458, 5.167628, 5.735297
Valid average loss all      (Triplet)                 : 0.291622

== Recognize ==
Valid average loss Recognize     : 0.948727
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.295836

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.08594822883606 sec. =
Valid knn accuracy drums     : 66.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.695375919342041 sec. =
Valid knn accuracy bass      : 16.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.610332012176514 sec. =
Valid knn accuracy piano     : 17.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.799973726272583 sec. =
Valid knn accuracy guitar    : 49.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.607782363891602 sec. =
Valid knn accuracy residuals : 69.69999999999999%

Valid knn accuracy average   : 44.00000000000001%

                                                                        [AEpoch 22: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00681, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.040]Epoch 22: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.097877, 0.099300, 0.100036, 0.078724
Train average loss UNet                 (all)                : 0.375936

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000823, 3.080092, 5.594225
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005464, 3.230445, 4.783434
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002494, 3.691483, 5.382453
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003240, 3.822523, 5.685856
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002140, 4.329361, 6.405943
Train average loss all      (Triplet)                 : 0.002885

== Recognize ==
Train average loss Recognize     : 1.033637
Train average accuracy drums     : 49.785000 %
Train average accuracy bass      : 50.540001 %
Train average accuracy piano     : 50.145000 %
Train average accuracy guitar    : 50.164997 %
Train average accuracy residuals : 50.594997 %

== Train average loss all : 0.006645

Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]          Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]Epoch 23:  16%|█▌        | 50/313 [00:45<03:58,  1.10it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]Epoch 23:  16%|█▌        | 50/313 [00:45<03:58,  1.10it/s, v_num=0, Train/loss_all_step=0.00538, Train/loss_unet_all_step=0.381, Train/loss_triplet_all_step=0.00157, Train/loss_recog_step=1.050, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]Epoch 23:  32%|███▏      | 100/313 [01:25<03:01,  1.18it/s, v_num=0, Train/loss_all_step=0.00538, Train/loss_unet_all_step=0.381, Train/loss_triplet_all_step=0.00157, Train/loss_recog_step=1.050, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]Epoch 23:  32%|███▏      | 100/313 [01:25<03:01,  1.18it/s, v_num=0, Train/loss_all_step=0.00387, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]  Epoch 23:  48%|████▊     | 150/313 [02:05<02:16,  1.20it/s, v_num=0, Train/loss_all_step=0.00387, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]Epoch 23:  48%|████▊     | 150/313 [02:05<02:16,  1.20it/s, v_num=0, Train/loss_all_step=0.00857, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.00458, Train/loss_recog_step=1.030, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]Epoch 23:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00857, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.00458, Train/loss_recog_step=1.030, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]Epoch 23:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.00759, Train/loss_recog_step=1.030, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030] Epoch 23:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.00759, Train/loss_recog_step=1.030, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]Epoch 23:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030] Epoch 23:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]Epoch 23:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00681, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.00313, Train/loss_recog_step=1.030, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]Epoch 23: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00681, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.00313, Train/loss_recog_step=1.030, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]Epoch 23: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.421, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.63it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  5.09it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.12it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.81it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.112865, 0.111192, 0.103560, 0.102742
Valid average loss UNet                 (all)                : 0.430359

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.100284, 3.190707, 4.964410
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.371310, 3.555484, 3.956379
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.567434, 4.704310, 4.735007
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.181216, 4.305210, 5.588498
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.338226, 4.983004, 5.558170
Valid average loss all      (Triplet)                 : 0.296901

== Recognize ==
Valid average loss Recognize     : 0.935594
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 41.500000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.301204

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.567601442337036 sec. =
Valid knn accuracy drums     : 69.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.042190313339233 sec. =
Valid knn accuracy bass      : 15.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.562691450119019 sec. =
Valid knn accuracy piano     : 18.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.352208852767944 sec. =
Valid knn accuracy guitar    : 51.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.881087303161621 sec. =
Valid knn accuracy residuals : 69.5%

Valid knn accuracy average   : 44.879999999999995%

                                                                        [AEpoch 23: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00664, Train/loss_unet_all_epoch=0.376, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.030]Epoch 23: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.097556, 0.099042, 0.099717, 0.078052
Train average loss UNet                 (all)                : 0.374367

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000562, 3.077642, 5.539331
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004433, 3.245794, 4.836931
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001920, 3.707185, 5.418833
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002375, 3.868098, 5.830544
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002079, 4.437859, 6.601458
Train average loss all      (Triplet)                 : 0.002309

== Recognize ==
Train average loss Recognize     : 1.030405
Train average accuracy drums     : 50.494999 %
Train average accuracy bass      : 50.400002 %
Train average accuracy piano     : 50.370003 %
Train average accuracy guitar    : 49.674999 %
Train average accuracy residuals : 50.134998 %

== Train average loss all : 0.006052

Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]          Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]Epoch 24:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]Epoch 24:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00381, Train/loss_unet_all_step=0.381, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]Epoch 24:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00381, Train/loss_unet_all_step=0.381, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]Epoch 24:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00517, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.00138, Train/loss_recog_step=1.020, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]Epoch 24:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00517, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.00138, Train/loss_recog_step=1.020, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]Epoch 24:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00559, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.0016, Train/loss_recog_step=1.050, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030] Epoch 24:  64%|██████▍   | 200/313 [02:43<01:32,  1.23it/s, v_num=0, Train/loss_all_step=0.00559, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.0016, Train/loss_recog_step=1.050, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]Epoch 24:  64%|██████▍   | 200/313 [02:43<01:32,  1.23it/s, v_num=0, Train/loss_all_step=0.00854, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00504, Train/loss_recog_step=1.060, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]Epoch 24:  80%|███████▉  | 250/313 [03:22<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.00854, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00504, Train/loss_recog_step=1.060, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]Epoch 24:  80%|███████▉  | 250/313 [03:22<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.00766, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.986, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]Epoch 24:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00766, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.986, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]Epoch 24:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00461, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.000958, Train/loss_recog_step=0.973, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]Epoch 24: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.00461, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.000958, Train/loss_recog_step=0.973, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]Epoch 24: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.00374, Train/loss_unet_all_step=0.374, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.457, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.852, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.430, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.936, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.98it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.95it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.49it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.95it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.96it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.111522, 0.111473, 0.102896, 0.094589
Valid average loss UNet                 (all)                : 0.420480

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.115930, 3.340345, 5.285644
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.415346, 3.611866, 3.931912
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.483200, 4.660606, 4.782886
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.165335, 4.359674, 5.649010
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.280752, 4.978375, 5.674010
Valid average loss all      (Triplet)                 : 0.290825

== Recognize ==
Valid average loss Recognize     : 0.946176
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.295030

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.439765930175781 sec. =
Valid knn accuracy drums     : 70.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.841327905654907 sec. =
Valid knn accuracy bass      : 15.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.22220754623413 sec. =
Valid knn accuracy piano     : 18.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.847628116607666 sec. =
Valid knn accuracy guitar    : 49.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.199885129928589 sec. =
Valid knn accuracy residuals : 69.69999999999999%

Valid knn accuracy average   : 44.5%

                                                                        [AEpoch 24: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00374, Train/loss_unet_all_step=0.374, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00605, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.030]Epoch 24: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00374, Train/loss_unet_all_step=0.374, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.097318, 0.098780, 0.099491, 0.078180
Train average loss UNet                 (all)                : 0.373769

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000882, 3.199517, 5.847402
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003613, 3.290121, 4.897156
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002434, 3.768313, 5.502517
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002805, 3.958810, 5.893011
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002495, 4.505415, 6.741229
Train average loss all      (Triplet)                 : 0.002498

== Recognize ==
Train average loss Recognize     : 1.035228
Train average accuracy drums     : 50.244999 %
Train average accuracy bass      : 50.305004 %
Train average accuracy piano     : 50.510002 %
Train average accuracy guitar    : 49.974998 %
Train average accuracy residuals : 50.215000 %

== Train average loss all : 0.006235

Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00374, Train/loss_unet_all_step=0.374, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]          Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00374, Train/loss_unet_all_step=0.374, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]Epoch 25:  16%|█▌        | 50/313 [00:46<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00374, Train/loss_unet_all_step=0.374, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]Epoch 25:  16%|█▌        | 50/313 [00:46<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.00906, Train/loss_recog_step=1.020, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]Epoch 25:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.00906, Train/loss_recog_step=1.020, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]Epoch 25:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00948, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=1.100, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]Epoch 25:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00948, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=1.100, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]Epoch 25:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00412, Train/loss_unet_all_step=0.412, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]  Epoch 25:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00412, Train/loss_unet_all_step=0.412, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]Epoch 25:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]Epoch 25:  80%|███████▉  | 250/313 [03:25<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]Epoch 25:  80%|███████▉  | 250/313 [03:25<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00356, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.998, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]Epoch 25:  96%|█████████▌| 300/313 [04:04<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00356, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.998, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]Epoch 25:  96%|█████████▌| 300/313 [04:04<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00557, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=1.000, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]Epoch 25: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00557, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=1.000, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]Epoch 25: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=1.110, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.21it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.52it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.54it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.38it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.83it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.92it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108170, 0.109889, 0.100489, 0.094350
Valid average loss UNet                 (all)                : 0.412899

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077704, 3.335488, 5.174234
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.448721, 3.723074, 4.069836
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.591519, 4.822400, 4.819056
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.168475, 4.415751, 5.927445
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.234919, 5.012390, 5.625629
Valid average loss all      (Triplet)                 : 0.301691

== Recognize ==
Valid average loss Recognize     : 1.015063
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.305820

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.335743427276611 sec. =
Valid knn accuracy drums     : 69.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.920511722564697 sec. =
Valid knn accuracy bass      : 15.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.95969009399414 sec. =
Valid knn accuracy piano     : 19.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.081090450286865 sec. =
Valid knn accuracy guitar    : 50.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.294851303100586 sec. =
Valid knn accuracy residuals : 68.60000000000001%

Valid knn accuracy average   : 44.64%

                                                                        [AEpoch 25: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=1.110, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00624, Train/loss_unet_all_epoch=0.374, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.040]Epoch 25: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=1.110, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.097084, 0.098479, 0.099241, 0.076789
Train average loss UNet                 (all)                : 0.371592

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000950, 3.201461, 5.785443
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003070, 3.391870, 5.021521
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002523, 3.858638, 5.618568
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001487, 4.018390, 6.029692
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002061, 4.529256, 6.767482
Train average loss all      (Triplet)                 : 0.002017

== Recognize ==
Train average loss Recognize     : 1.043267
Train average accuracy drums     : 49.500000 %
Train average accuracy bass      : 50.005001 %
Train average accuracy piano     : 50.314999 %
Train average accuracy guitar    : 50.094997 %
Train average accuracy residuals : 49.439999 %

== Train average loss all : 0.005733

Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=1.110, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]          Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=1.110, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]Epoch 26:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=1.110, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]Epoch 26:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.00912, Train/loss_recog_step=1.050, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]Epoch 26:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.00912, Train/loss_recog_step=1.050, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]Epoch 26:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00393, Train/loss_unet_all_step=0.382, Train/loss_triplet_all_step=0.000112, Train/loss_recog_step=0.943, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]Epoch 26:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00393, Train/loss_unet_all_step=0.382, Train/loss_triplet_all_step=0.000112, Train/loss_recog_step=0.943, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]Epoch 26:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.0043, Train/loss_unet_all_step=0.430, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]    Epoch 26:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.0043, Train/loss_unet_all_step=0.430, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]Epoch 26:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.060, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]Epoch 26:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.060, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]Epoch 26:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.00969, Train/loss_recog_step=0.903, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]Epoch 26:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.00969, Train/loss_recog_step=0.903, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]Epoch 26:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00951, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=0.996, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]Epoch 26: 100%|██████████| 313/313 [04:11<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00951, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=0.996, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]Epoch 26: 100%|██████████| 313/313 [04:11<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=1.080, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.412, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.98it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.51it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  5.22it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.66it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.25it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.111367, 0.111522, 0.102438, 0.098167
Valid average loss UNet                 (all)                : 0.423494

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073509, 3.479686, 5.432942
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.483979, 3.956525, 4.182218
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.527858, 4.851127, 5.115370
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.211405, 4.552418, 5.883879
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.228080, 5.048298, 5.718758
Valid average loss all      (Triplet)                 : 0.294648

== Recognize ==
Valid average loss Recognize     : 0.981735
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.298883

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.926090955734253 sec. =
Valid knn accuracy drums     : 69.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.000858545303345 sec. =
Valid knn accuracy bass      : 15.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.420984745025635 sec. =
Valid knn accuracy piano     : 17.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.920060157775879 sec. =
Valid knn accuracy guitar    : 50.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.627228736877441 sec. =
Valid knn accuracy residuals : 67.30000000000001%

Valid knn accuracy average   : 44.00000000000001%

                                                                        [AEpoch 26: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=1.080, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.040]Epoch 26: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=1.080, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.097050, 0.098357, 0.099149, 0.077263
Train average loss UNet                 (all)                : 0.371819

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001593, 3.316631, 6.087637
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003678, 3.491808, 5.182356
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003105, 3.990664, 5.761738
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003675, 4.119956, 6.175638
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001329, 4.622430, 6.880159
Train average loss all      (Triplet)                 : 0.002707

== Recognize ==
Train average loss Recognize     : 1.055467
Train average accuracy drums     : 50.195004 %
Train average accuracy bass      : 49.564999 %
Train average accuracy piano     : 49.889999 %
Train average accuracy guitar    : 50.024998 %
Train average accuracy residuals : 49.924999 %

== Train average loss all : 0.006425

Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=1.080, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]          Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=1.080, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]Epoch 27:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=1.080, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]Epoch 27:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.00378, Train/loss_unet_all_step=0.378, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060] Epoch 27:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00378, Train/loss_unet_all_step=0.378, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]Epoch 27:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.0139, Train/loss_unet_all_step=0.378, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=1.100, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]Epoch 27:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.0139, Train/loss_unet_all_step=0.378, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=1.100, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]Epoch 27:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.388, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]Epoch 27:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.388, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]Epoch 27:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00384, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.000276, Train/loss_recog_step=1.030, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]Epoch 27:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00384, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.000276, Train/loss_recog_step=1.030, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]Epoch 27:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.0227, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=1.130, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]   Epoch 27:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.0227, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=1.130, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]Epoch 27:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.0079, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.00428, Train/loss_recog_step=1.100, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]Epoch 27: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.0079, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.00428, Train/loss_recog_step=1.100, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]Epoch 27: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00395, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000483, Train/loss_recog_step=1.090, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.912, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.21it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.51it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.48it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.58it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.47it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.110303, 0.109612, 0.100114, 0.101615
Valid average loss UNet                 (all)                : 0.421644

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.069557, 3.437083, 5.334484
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.453580, 3.863565, 4.242301
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.480334, 4.851125, 5.152379
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.211538, 4.704692, 6.048923
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.405849, 5.517721, 6.047786
Valid average loss all      (Triplet)                 : 0.295380

== Recognize ==
Valid average loss Recognize     : 0.932254
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.299596

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.88892126083374 sec. =
Valid knn accuracy drums     : 69.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.57819128036499 sec. =
Valid knn accuracy bass      : 15.299999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.286519527435303 sec. =
Valid knn accuracy piano     : 18.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.11276388168335 sec. =
Valid knn accuracy guitar    : 51.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.676403522491455 sec. =
Valid knn accuracy residuals : 64.8%

Valid knn accuracy average   : 44.00000000000001%

                                                                        [AEpoch 27: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00395, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000483, Train/loss_recog_step=1.090, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00642, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.060]Epoch 27: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00395, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000483, Train/loss_recog_step=1.090, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.096858, 0.098231, 0.099020, 0.077714
Train average loss UNet                 (all)                : 0.371824

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001215, 3.378683, 6.302025
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004612, 3.558029, 5.263754
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003008, 3.954296, 5.713580
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003204, 4.217198, 6.356652
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001914, 4.644804, 6.906725
Train average loss all      (Triplet)                 : 0.002856

== Recognize ==
Train average loss Recognize     : 1.074059
Train average accuracy drums     : 49.950001 %
Train average accuracy bass      : 49.395000 %
Train average accuracy piano     : 49.634998 %
Train average accuracy guitar    : 50.220001 %
Train average accuracy residuals : 50.459999 %

== Train average loss all : 0.006574

Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00395, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000483, Train/loss_recog_step=1.090, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]          Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00395, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000483, Train/loss_recog_step=1.090, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]Epoch 28:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.00395, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000483, Train/loss_recog_step=1.090, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]Epoch 28:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.00374, Train/loss_unet_all_step=0.374, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]   Epoch 28:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00374, Train/loss_unet_all_step=0.374, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]Epoch 28:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]Epoch 28:  48%|████▊     | 150/313 [02:08<02:19,  1.16it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]Epoch 28:  48%|████▊     | 150/313 [02:08<02:19,  1.16it/s, v_num=0, Train/loss_all_step=0.00554, Train/loss_unet_all_step=0.415, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=1.050, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]Epoch 28:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00554, Train/loss_unet_all_step=0.415, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=1.050, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]Epoch 28:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]  Epoch 28:  80%|███████▉  | 250/313 [03:25<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]Epoch 28:  80%|███████▉  | 250/313 [03:25<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=1.030, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070] Epoch 28:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=1.030, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]Epoch 28:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00722, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=1.100, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]Epoch 28: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00722, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=1.100, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]Epoch 28: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.981, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.798, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.422, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.99it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.68it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.71it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.29it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.38it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.83it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.111599, 0.110748, 0.100700, 0.094643
Valid average loss UNet                 (all)                : 0.417690

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.074946, 3.474945, 5.349810
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.454817, 3.941151, 4.255823
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.497478, 4.961266, 5.153527
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.138941, 4.753769, 6.268809
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.232251, 5.308565, 6.007531
Valid average loss all      (Triplet)                 : 0.281223

== Recognize ==
Valid average loss Recognize     : 0.979665
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.285400

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.114216566085815 sec. =
Valid knn accuracy drums     : 68.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.870907545089722 sec. =
Valid knn accuracy bass      : 15.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.064740657806396 sec. =
Valid knn accuracy piano     : 18.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.43625020980835 sec. =
Valid knn accuracy guitar    : 51.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.771934747695923 sec. =
Valid knn accuracy residuals : 67.7%

Valid knn accuracy average   : 44.36%

                                                                        [AEpoch 28: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.981, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00657, Train/loss_unet_all_epoch=0.372, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=1.070]Epoch 28: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.981, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.096538, 0.097935, 0.098638, 0.076310
Train average loss UNet                 (all)                : 0.369421

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001007, 3.417912, 6.286958
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003983, 3.630047, 5.386775
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003045, 4.050024, 5.874633
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002518, 4.322359, 6.524955
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000979, 4.671921, 6.945684
Train average loss all      (Triplet)                 : 0.002310

== Recognize ==
Train average loss Recognize     : 1.077631
Train average accuracy drums     : 50.155003 %
Train average accuracy bass      : 50.139999 %
Train average accuracy piano     : 49.259998 %
Train average accuracy guitar    : 49.505001 %
Train average accuracy residuals : 50.155003 %

== Train average loss all : 0.006004

Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.981, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]          Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.981, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]Epoch 29:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.981, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]Epoch 29:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.00375, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]Epoch 29:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00375, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]Epoch 29:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00364, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]Epoch 29:  48%|████▊     | 150/313 [02:03<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.00364, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]Epoch 29:  48%|████▊     | 150/313 [02:03<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.00516, Train/loss_unet_all_step=0.409, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=1.050, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]Epoch 29:  64%|██████▍   | 200/313 [02:41<01:31,  1.24it/s, v_num=0, Train/loss_all_step=0.00516, Train/loss_unet_all_step=0.409, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=1.050, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]Epoch 29:  64%|██████▍   | 200/313 [02:41<01:31,  1.24it/s, v_num=0, Train/loss_all_step=0.00381, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.00029, Train/loss_recog_step=1.060, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]Epoch 29:  80%|███████▉  | 250/313 [03:20<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.00381, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.00029, Train/loss_recog_step=1.060, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]Epoch 29:  80%|███████▉  | 250/313 [03:20<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]  Epoch 29:  96%|█████████▌| 300/313 [03:58<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]Epoch 29:  96%|█████████▌| 300/313 [03:58<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=1.000, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]Epoch 29: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=1.000, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]Epoch 29: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.435, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.444, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.58it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.83it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.79it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.70it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.111825, 0.110728, 0.103060, 0.097952
Valid average loss UNet                 (all)                : 0.423566

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073101, 3.399133, 5.226311
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.454809, 4.030581, 4.411484
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.627449, 5.088652, 5.174692
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.145586, 4.621373, 6.079770
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.216482, 5.220189, 5.889791
Valid average loss all      (Triplet)                 : 0.304657

== Recognize ==
Valid average loss Recognize     : 0.945977
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 56.500000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.308893

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.465232849121094 sec. =
Valid knn accuracy drums     : 68.30000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.633352518081665 sec. =
Valid knn accuracy bass      : 17.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.751927614212036 sec. =
Valid knn accuracy piano     : 16.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.642416954040527 sec. =
Valid knn accuracy guitar    : 53.300000000000004%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.840454816818237 sec. =
Valid knn accuracy residuals : 65.60000000000001%

Valid knn accuracy average   : 44.1%

                                                                        [AEpoch 29: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.369, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.080]Epoch 29: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.096345, 0.097738, 0.098507, 0.076974
Train average loss UNet                 (all)                : 0.369564

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001693, 3.373058, 6.144154
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003827, 3.646206, 5.429356
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004165, 4.088675, 5.948557
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001786, 4.247942, 6.439133
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001925, 4.681126, 6.968556
Train average loss all      (Triplet)                 : 0.002656

== Recognize ==
Train average loss Recognize     : 1.078429
Train average accuracy drums     : 50.480003 %
Train average accuracy bass      : 50.155003 %
Train average accuracy piano     : 50.054996 %
Train average accuracy guitar    : 49.889999 %
Train average accuracy residuals : 50.000000 %

== Train average loss all : 0.006351

Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]          Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]Epoch 30:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]Epoch 30:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.0096, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.0059, Train/loss_recog_step=1.060, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]Epoch 30:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.0096, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.0059, Train/loss_recog_step=1.060, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]Epoch 30:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00937, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.00577, Train/loss_recog_step=1.070, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]Epoch 30:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00937, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.00577, Train/loss_recog_step=1.070, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]Epoch 30:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.419, Train/loss_triplet_all_step=0.00827, Train/loss_recog_step=1.080, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080] Epoch 30:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.419, Train/loss_triplet_all_step=0.00827, Train/loss_recog_step=1.080, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]Epoch 30:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.00977, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00627, Train/loss_recog_step=1.080, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]Epoch 30:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00977, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00627, Train/loss_recog_step=1.080, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]Epoch 30:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00378, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000237, Train/loss_recog_step=1.080, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]Epoch 30:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00378, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000237, Train/loss_recog_step=1.080, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]Epoch 30:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]   Epoch 30: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]Epoch 30: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.452, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.424, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.20it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.80it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.64it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.80it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.09it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.59it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.110407, 0.110440, 0.100535, 0.089357
Valid average loss UNet                 (all)                : 0.410740

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073055, 3.676908, 5.565830
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.492716, 4.012733, 4.274624
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.633078, 5.307710, 5.336634
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.201036, 5.019547, 6.421891
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.219218, 5.529804, 6.321422
Valid average loss all      (Triplet)                 : 0.327736

== Recognize ==
Valid average loss Recognize     : 1.001069
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 44.500000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.331844

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.886206150054932 sec. =
Valid knn accuracy drums     : 68.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.952192783355713 sec. =
Valid knn accuracy bass      : 18.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.499502897262573 sec. =
Valid knn accuracy piano     : 17.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.981565952301025 sec. =
Valid knn accuracy guitar    : 48.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.306112051010132 sec. =
Valid knn accuracy residuals : 67.2%

Valid knn accuracy average   : 43.98000000000001%

                                                                        [AEpoch 30: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.370, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.080]Epoch 30: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.096203, 0.097557, 0.098288, 0.076130
Train average loss UNet                 (all)                : 0.368178

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001189, 3.391353, 6.235636
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003576, 3.649197, 5.434656
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002230, 4.143370, 6.056380
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002507, 4.347730, 6.565004
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002367, 4.799923, 7.111742
Train average loss all      (Triplet)                 : 0.002391

== Recognize ==
Train average loss Recognize     : 1.079913
Train average accuracy drums     : 49.654999 %
Train average accuracy bass      : 49.895000 %
Train average accuracy piano     : 50.145000 %
Train average accuracy guitar    : 50.094997 %
Train average accuracy residuals : 50.045002 %

== Train average loss all : 0.006073

Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]          Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]Epoch 31:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]Epoch 31:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.00403, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.000357, Train/loss_recog_step=1.170, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]Epoch 31:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00403, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.000357, Train/loss_recog_step=1.170, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]Epoch 31:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00369, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]   Epoch 31:  48%|████▊     | 150/313 [02:03<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.00369, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]Epoch 31:  48%|████▊     | 150/313 [02:03<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.00497, Train/loss_unet_all_step=0.411, Train/loss_triplet_all_step=0.000854, Train/loss_recog_step=1.020, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]Epoch 31:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.00497, Train/loss_unet_all_step=0.411, Train/loss_triplet_all_step=0.000854, Train/loss_recog_step=1.020, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]Epoch 31:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]   Epoch 31:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]Epoch 31:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.00425, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000754, Train/loss_recog_step=1.140, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]Epoch 31:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.00425, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000754, Train/loss_recog_step=1.140, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]Epoch 31:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]   Epoch 31: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]Epoch 31: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.0272, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0237, Train/loss_recog_step=1.060, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.19it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.57it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.79it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.46it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.96it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109297, 0.109317, 0.100805, 0.089163
Valid average loss UNet                 (all)                : 0.408582

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.075692, 3.807620, 5.552734
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.439929, 4.044208, 4.400038
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.693984, 5.250798, 5.386534
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.155716, 5.028980, 6.728937
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.402159, 5.680483, 6.236470
Valid average loss all      (Triplet)                 : 0.348504

== Recognize ==
Valid average loss Recognize     : 0.962667
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 56.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.352589

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.847869634628296 sec. =
Valid knn accuracy drums     : 66.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.21496295928955 sec. =
Valid knn accuracy bass      : 17.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.333344459533691 sec. =
Valid knn accuracy piano     : 17.299999999999997%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.208654642105103 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.567213535308838 sec. =
Valid knn accuracy residuals : 68.7%

Valid knn accuracy average   : 44.06%

                                                                        [AEpoch 31: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0272, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0237, Train/loss_recog_step=1.060, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00607, Train/loss_unet_all_epoch=0.368, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.080]Epoch 31: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0272, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0237, Train/loss_recog_step=1.060, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.095950, 0.097342, 0.098126, 0.075991
Train average loss UNet                 (all)                : 0.367408

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000467, 3.449541, 6.298821
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002842, 3.709012, 5.511522
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003129, 4.215927, 6.173554
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002680, 4.491923, 6.794487
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001853, 4.977319, 7.404727
Train average loss all      (Triplet)                 : 0.002201

== Recognize ==
Train average loss Recognize     : 1.085850
Train average accuracy drums     : 50.419998 %
Train average accuracy bass      : 49.364998 %
Train average accuracy piano     : 49.869999 %
Train average accuracy guitar    : 50.250000 %
Train average accuracy residuals : 49.985001 %

== Train average loss all : 0.005875

Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0272, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0237, Train/loss_recog_step=1.060, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]          Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0272, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0237, Train/loss_recog_step=1.060, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]Epoch 32:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.0272, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0237, Train/loss_recog_step=1.060, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]Epoch 32:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.00379, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]Epoch 32:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00379, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]Epoch 32:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]Epoch 32:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]Epoch 32:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.005, Train/loss_unet_all_step=0.400, Train/loss_triplet_all_step=0.000999, Train/loss_recog_step=1.080, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]Epoch 32:  64%|██████▍   | 200/313 [02:48<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.005, Train/loss_unet_all_step=0.400, Train/loss_triplet_all_step=0.000999, Train/loss_recog_step=1.080, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]Epoch 32:  64%|██████▍   | 200/313 [02:48<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090] Epoch 32:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]Epoch 32:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]Epoch 32:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]Epoch 32:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]Epoch 32: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]Epoch 32: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.381, Valid/loss_unet_all_step=0.392, Valid/loss_triplet_all_step=0.378, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.19it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.50it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.67it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.53it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.53it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.111085, 0.110542, 0.101636, 0.091625
Valid average loss UNet                 (all)                : 0.414888

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.097818, 3.856303, 5.789713
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.444005, 4.099036, 4.348436
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.619350, 5.380853, 5.678532
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.162821, 5.066184, 6.804861
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.307332, 5.738039, 6.474443
Valid average loss all      (Triplet)                 : 0.337093

== Recognize ==
Valid average loss Recognize     : 1.003874
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 56.000000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.341242

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.471269607543945 sec. =
Valid knn accuracy drums     : 69.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.469475746154785 sec. =
Valid knn accuracy bass      : 15.299999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.565280437469482 sec. =
Valid knn accuracy piano     : 18.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.395206451416016 sec. =
Valid knn accuracy guitar    : 51.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.48427700996399 sec. =
Valid knn accuracy residuals : 68.5%

Valid knn accuracy average   : 44.64%

                                                                        [AEpoch 32: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.090]Epoch 32: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.095874, 0.097288, 0.098014, 0.075948
Train average loss UNet                 (all)                : 0.367124

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000422, 3.468118, 6.366919
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003585, 3.733823, 5.560707
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003386, 4.247677, 6.209877
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002549, 4.442439, 6.777894
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001865, 4.929325, 7.332541
Train average loss all      (Triplet)                 : 0.002313

== Recognize ==
Train average loss Recognize     : 1.095066
Train average accuracy drums     : 50.035000 %
Train average accuracy bass      : 49.735001 %
Train average accuracy piano     : 49.840000 %
Train average accuracy guitar    : 49.974998 %
Train average accuracy residuals : 49.704998 %

== Train average loss all : 0.005984

Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100]          Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100]Epoch 33:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100]Epoch 33:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.0038, Train/loss_unet_all_step=0.380, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100] Epoch 33:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.0038, Train/loss_unet_all_step=0.380, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100]Epoch 33:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00379, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100]Epoch 33:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00379, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100]Epoch 33:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00472, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.000955, Train/loss_recog_step=1.110, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100]Epoch 33:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00472, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.000955, Train/loss_recog_step=1.110, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100]Epoch 33:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00422, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.000708, Train/loss_recog_step=1.020, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100]Epoch 33:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00422, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.000708, Train/loss_recog_step=1.020, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100]Epoch 33:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00915, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.00565, Train/loss_recog_step=1.110, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100] Epoch 33:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00915, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.00565, Train/loss_recog_step=1.110, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100]Epoch 33:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00762, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.00398, Train/loss_recog_step=1.030, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100]Epoch 33: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.00762, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.00398, Train/loss_recog_step=1.030, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100]Epoch 33: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.00768, Train/loss_recog_step=1.050, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.417, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.446, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.19it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.74it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  5.14it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.76it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.70it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108297, 0.110055, 0.099426, 0.099771
Valid average loss UNet                 (all)                : 0.417549

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.088452, 3.660718, 5.976540
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.413507, 4.173251, 4.574047
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.649661, 5.379274, 5.514427
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.182698, 5.029943, 6.737714
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.465112, 5.809215, 6.317843
Valid average loss all      (Triplet)                 : 0.353692

== Recognize ==
Valid average loss Recognize     : 0.999848
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 58.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.357868

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.76130223274231 sec. =
Valid knn accuracy drums     : 67.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.317857265472412 sec. =
Valid knn accuracy bass      : 17.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.725338459014893 sec. =
Valid knn accuracy piano     : 18.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.5399808883667 sec. =
Valid knn accuracy guitar    : 48.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.21550989151001 sec. =
Valid knn accuracy residuals : 67.80000000000001%

Valid knn accuracy average   : 43.8%

                                                                        [AEpoch 33: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.00768, Train/loss_recog_step=1.050, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00598, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.100]Epoch 33: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.00768, Train/loss_recog_step=1.050, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.095773, 0.097152, 0.097923, 0.076236
Train average loss UNet                 (all)                : 0.367083

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000683, 3.514153, 6.535396
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003662, 3.797881, 5.613934
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002879, 4.383767, 6.399999
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002232, 4.494259, 6.817390
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002261, 5.006595, 7.445873
Train average loss all      (Triplet)                 : 0.002333

== Recognize ==
Train average loss Recognize     : 1.095524
Train average accuracy drums     : 49.849998 %
Train average accuracy bass      : 50.125004 %
Train average accuracy piano     : 50.139999 %
Train average accuracy guitar    : 49.924999 %
Train average accuracy residuals : 49.860001 %

== Train average loss all : 0.006004

Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.00768, Train/loss_recog_step=1.050, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]          Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.00768, Train/loss_recog_step=1.050, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]Epoch 34:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.00768, Train/loss_recog_step=1.050, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]Epoch 34:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=1.200, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]Epoch 34:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=1.200, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]Epoch 34:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.00261, Train/loss_recog_step=1.090, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100] Epoch 34:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.00261, Train/loss_recog_step=1.090, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]Epoch 34:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00936, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.00551, Train/loss_recog_step=1.050, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]Epoch 34:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00936, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.00551, Train/loss_recog_step=1.050, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]Epoch 34:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00674, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=1.090, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]Epoch 34:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00674, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=1.090, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]Epoch 34:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]  Epoch 34:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]Epoch 34:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00365, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]Epoch 34: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00365, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]Epoch 34: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.0199, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.914, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.438, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.22it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.95it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.25it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.84it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.45it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.94it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.110448, 0.111434, 0.099965, 0.102953
Valid average loss UNet                 (all)                : 0.424800

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.117261, 3.751599, 6.057180
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.382247, 4.226452, 4.627172
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.709648, 5.478886, 5.643160
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.213784, 5.072096, 6.516213
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.329084, 5.783050, 6.473078
Valid average loss all      (Triplet)                 : 0.364868

== Recognize ==
Valid average loss Recognize     : 0.945837
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 60.500000 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.369116

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.572999954223633 sec. =
Valid knn accuracy drums     : 65.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.006908416748047 sec. =
Valid knn accuracy bass      : 18.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.639604568481445 sec. =
Valid knn accuracy piano     : 18.099999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.213046550750732 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.693530082702637 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 43.96000000000001%

                                                                        [AEpoch 34: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0199, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.914, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.367, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.100]Epoch 34: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0199, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.914, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.095547, 0.096908, 0.097730, 0.076093
Train average loss UNet                 (all)                : 0.366278

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000565, 3.563576, 6.758107
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003044, 3.841038, 5.735089
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003543, 4.409051, 6.420882
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002960, 4.508718, 6.858918
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001960, 5.035300, 7.518428
Train average loss all      (Triplet)                 : 0.002382

== Recognize ==
Train average loss Recognize     : 1.090415
Train average accuracy drums     : 50.320000 %
Train average accuracy bass      : 49.775002 %
Train average accuracy piano     : 50.905003 %
Train average accuracy guitar    : 50.160004 %
Train average accuracy residuals : 50.230003 %

== Train average loss all : 0.006044

Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0199, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.914, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]          Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0199, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.914, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]Epoch 35:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0199, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.914, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]Epoch 35:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.00256, Train/loss_recog_step=1.130, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]Epoch 35:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.00256, Train/loss_recog_step=1.130, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]Epoch 35:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]  Epoch 35:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]Epoch 35:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.396, Train/loss_triplet_all_step=0.00305, Train/loss_recog_step=1.070, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]Epoch 35:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.396, Train/loss_triplet_all_step=0.00305, Train/loss_recog_step=1.070, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]Epoch 35:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00396, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000544, Train/loss_recog_step=1.220, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]Epoch 35:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00396, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000544, Train/loss_recog_step=1.220, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]Epoch 35:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]   Epoch 35:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]Epoch 35:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.0276, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.0241, Train/loss_recog_step=1.130, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]Epoch 35: 100%|██████████| 313/313 [04:11<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.0276, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.0241, Train/loss_recog_step=1.130, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]Epoch 35: 100%|██████████| 313/313 [04:11<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.979, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.59it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.53it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.31it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.40it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.13it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109600, 0.109560, 0.099417, 0.091911
Valid average loss UNet                 (all)                : 0.410488

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.100978, 3.827541, 6.040549
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.498872, 4.329031, 4.638082
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.651424, 5.528465, 5.860043
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.198291, 5.146344, 6.546232
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.272741, 5.575037, 6.533405
Valid average loss all      (Triplet)                 : 0.339751

== Recognize ==
Valid average loss Recognize     : 0.982331
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 44.000000 %

== Valid average loss all : 0.343856

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.207871437072754 sec. =
Valid knn accuracy drums     : 68.60000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.76441502571106 sec. =
Valid knn accuracy bass      : 17.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.524895429611206 sec. =
Valid knn accuracy piano     : 16.400000000000002%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.7381432056427 sec. =
Valid knn accuracy guitar    : 50.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.484398126602173 sec. =
Valid knn accuracy residuals : 67.80000000000001%

Valid knn accuracy average   : 44.02%

                                                                        [AEpoch 35: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00604, Train/loss_unet_all_epoch=0.366, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.090]Epoch 35: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.095437, 0.096793, 0.097517, 0.075616
Train average loss UNet                 (all)                : 0.365362

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000338, 3.647218, 6.796369
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005506, 3.995360, 5.915099
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001828, 4.550461, 6.687565
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002743, 4.666436, 7.176777
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000931, 5.190471, 7.731229
Train average loss all      (Triplet)                 : 0.002291

== Recognize ==
Train average loss Recognize     : 1.095951
Train average accuracy drums     : 49.224998 %
Train average accuracy bass      : 49.724998 %
Train average accuracy piano     : 50.344997 %
Train average accuracy guitar    : 50.129997 %
Train average accuracy residuals : 50.134998 %

== Train average loss all : 0.005944

Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]          Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]Epoch 36:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]Epoch 36:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.00376, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]Epoch 36:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00376, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]Epoch 36:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00546, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.00186, Train/loss_recog_step=1.190, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]Epoch 36:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00546, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.00186, Train/loss_recog_step=1.190, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]Epoch 36:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00396, Train/loss_unet_all_step=0.396, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]  Epoch 36:  64%|██████▍   | 200/313 [02:43<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00396, Train/loss_unet_all_step=0.396, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]Epoch 36:  64%|██████▍   | 200/313 [02:43<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]Epoch 36:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]Epoch 36:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.0224, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.019, Train/loss_recog_step=1.110, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100] Epoch 36:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.0224, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.019, Train/loss_recog_step=1.110, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]Epoch 36:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]Epoch 36: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]Epoch 36: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.926, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.92it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.56it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.42it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.92it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.76it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.110058, 0.110107, 0.099843, 0.097062
Valid average loss UNet                 (all)                : 0.417070

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.126200, 3.881827, 5.905341
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.426931, 4.410408, 4.905193
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.767847, 5.541142, 5.538339
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.206744, 5.388886, 6.949589
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.221549, 5.754295, 6.625025
Valid average loss all      (Triplet)                 : 0.352103

== Recognize ==
Valid average loss Recognize     : 0.976827
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 60.500000 %

== Valid average loss all : 0.356273

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.169827222824097 sec. =
Valid knn accuracy drums     : 65.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.673178672790527 sec. =
Valid knn accuracy bass      : 16.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.330418109893799 sec. =
Valid knn accuracy piano     : 18.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.597098112106323 sec. =
Valid knn accuracy guitar    : 53.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.169943809509277 sec. =
Valid knn accuracy residuals : 68.10000000000001%

Valid knn accuracy average   : 44.519999999999996%

                                                                        [AEpoch 36: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00594, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.100]Epoch 36: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.095231, 0.096652, 0.097334, 0.075837
Train average loss UNet                 (all)                : 0.365054

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000783, 3.661733, 6.862114
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002440, 3.971145, 5.961747
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002246, 4.505058, 6.618070
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001810, 4.653996, 7.138091
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000734, 5.156296, 7.698193
Train average loss all      (Triplet)                 : 0.001570

== Recognize ==
Train average loss Recognize     : 1.096071
Train average accuracy drums     : 49.520000 %
Train average accuracy bass      : 50.535000 %
Train average accuracy piano     : 49.360001 %
Train average accuracy guitar    : 50.234997 %
Train average accuracy residuals : 50.015003 %

== Train average loss all : 0.005220

Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]          Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]Epoch 37:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]Epoch 37:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00377, Train/loss_unet_all_step=0.377, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]Epoch 37:  32%|███▏      | 100/313 [01:26<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00377, Train/loss_unet_all_step=0.377, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]Epoch 37:  32%|███▏      | 100/313 [01:26<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00695, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.00327, Train/loss_recog_step=1.090, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]Epoch 37:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00695, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.00327, Train/loss_recog_step=1.090, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]Epoch 37:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00375, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]  Epoch 37:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.00375, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]Epoch 37:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.00486, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.00149, Train/loss_recog_step=1.160, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]Epoch 37:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00486, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.00149, Train/loss_recog_step=1.160, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]Epoch 37:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]  Epoch 37:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]Epoch 37:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.0053, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.00175, Train/loss_recog_step=1.060, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]Epoch 37: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.0053, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.00175, Train/loss_recog_step=1.060, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]Epoch 37: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.01it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.73it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  5.24it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.30it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.110012, 0.108693, 0.099911, 0.088342
Valid average loss UNet                 (all)                : 0.406958

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.089948, 3.867142, 6.201299
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.322318, 4.309134, 4.905525
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.733451, 5.696959, 5.720156
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.198161, 5.268177, 6.845509
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.263939, 5.641893, 6.493894
Valid average loss all      (Triplet)                 : 0.313606

== Recognize ==
Valid average loss Recognize     : 1.091951
Valid average accuracy drums     : 41.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.317676

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.830206155776978 sec. =
Valid knn accuracy drums     : 64.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.732858180999756 sec. =
Valid knn accuracy bass      : 16.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.303433418273926 sec. =
Valid knn accuracy piano     : 18.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.092846393585205 sec. =
Valid knn accuracy guitar    : 50.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.880353689193726 sec. =
Valid knn accuracy residuals : 65.60000000000001%

Valid knn accuracy average   : 43.3%

                                                                        [AEpoch 37: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.365, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.100]Epoch 37: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.095039, 0.096567, 0.097272, 0.075298
Train average loss UNet                 (all)                : 0.364176

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001094, 3.741066, 7.198821
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003928, 4.031332, 6.030100
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002196, 4.559352, 6.688399
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002091, 4.796334, 7.323535
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001422, 5.226076, 7.835191
Train average loss all      (Triplet)                 : 0.002223

== Recognize ==
Train average loss Recognize     : 1.101432
Train average accuracy drums     : 49.564999 %
Train average accuracy bass      : 49.759998 %
Train average accuracy piano     : 49.834999 %
Train average accuracy guitar    : 49.884998 %
Train average accuracy residuals : 50.340004 %

== Train average loss all : 0.005865

Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]          Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]Epoch 38:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]Epoch 38:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.00372, Train/loss_unet_all_step=0.372, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]Epoch 38:  32%|███▏      | 100/313 [01:25<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00372, Train/loss_unet_all_step=0.372, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]Epoch 38:  32%|███▏      | 100/313 [01:25<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.0127, Train/loss_recog_step=1.050, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]Epoch 38:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.0127, Train/loss_recog_step=1.050, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]Epoch 38:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.0039, Train/loss_unet_all_step=0.390, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100] Epoch 38:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.0039, Train/loss_unet_all_step=0.390, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]Epoch 38:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00345, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]Epoch 38:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00345, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]Epoch 38:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00447, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000873, Train/loss_recog_step=1.050, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]Epoch 38:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00447, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000873, Train/loss_recog_step=1.050, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]Epoch 38:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]   Epoch 38: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]Epoch 38: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.433, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.98it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.64it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.77it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.41it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.68it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.110231, 0.109285, 0.100301, 0.092985
Valid average loss UNet                 (all)                : 0.412802

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.109554, 4.101252, 6.035756
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.302982, 4.428529, 5.068251
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.754193, 6.097772, 6.212618
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.273674, 5.653191, 7.055845
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.247409, 5.860840, 6.851259
Valid average loss all      (Triplet)                 : 0.360338

== Recognize ==
Valid average loss Recognize     : 1.102250
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 41.000000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 57.500000 %

== Valid average loss all : 0.364466

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.401565790176392 sec. =
Valid knn accuracy drums     : 65.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.766349792480469 sec. =
Valid knn accuracy bass      : 15.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.244070053100586 sec. =
Valid knn accuracy piano     : 17.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.024352312088013 sec. =
Valid knn accuracy guitar    : 54.300000000000004%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.629643201828003 sec. =
Valid knn accuracy residuals : 68.0%

Valid knn accuracy average   : 44.28000000000001%

                                                                        [AEpoch 38: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00586, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.100]Epoch 38: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.094969, 0.096406, 0.097140, 0.075183
Train average loss UNet                 (all)                : 0.363698

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000965, 3.827170, 7.272135
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002476, 4.026452, 6.000019
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002723, 4.683338, 6.866272
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002014, 4.782180, 7.276270
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001875, 5.339089, 8.027638
Train average loss all      (Triplet)                 : 0.002118

== Recognize ==
Train average loss Recognize     : 1.095934
Train average accuracy drums     : 50.094997 %
Train average accuracy bass      : 49.630001 %
Train average accuracy piano     : 49.959999 %
Train average accuracy guitar    : 49.524998 %
Train average accuracy residuals : 50.314999 %

== Train average loss all : 0.005755

Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]          Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]Epoch 39:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]Epoch 39:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00365, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]Epoch 39:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00365, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]Epoch 39:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00447, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.000845, Train/loss_recog_step=1.160, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]Epoch 39:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00447, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.000845, Train/loss_recog_step=1.160, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]Epoch 39:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00409, Train/loss_unet_all_step=0.409, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]   Epoch 39:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00409, Train/loss_unet_all_step=0.409, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]Epoch 39:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]Epoch 39:  80%|███████▉  | 250/313 [03:29<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]Epoch 39:  80%|███████▉  | 250/313 [03:29<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00392, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000428, Train/loss_recog_step=1.090, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]Epoch 39:  96%|█████████▌| 300/313 [04:08<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00392, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000428, Train/loss_recog_step=1.090, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]Epoch 39:  96%|█████████▌| 300/313 [04:08<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]   Epoch 39: 100%|██████████| 313/313 [04:15<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]Epoch 39: 100%|██████████| 313/313 [04:15<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.00324, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.411, Valid/loss_unet_all_step=0.389, Valid/loss_triplet_all_step=0.407, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.364, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.20it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.74it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.79it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.85it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.51it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.69it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.110609, 0.109437, 0.099939, 0.098567
Valid average loss UNet                 (all)                : 0.418553

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.143137, 4.222248, 6.172760
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.447643, 4.635817, 5.092298
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.790507, 6.022518, 5.974939
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.274664, 5.683247, 7.178071
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.290332, 5.912815, 6.875458
Valid average loss all      (Triplet)                 : 0.384808

== Recognize ==
Valid average loss Recognize     : 1.096380
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 44.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.388994

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.905706644058228 sec. =
Valid knn accuracy drums     : 69.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.95922303199768 sec. =
Valid knn accuracy bass      : 17.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.75433897972107 sec. =
Valid knn accuracy piano     : 17.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.269895792007446 sec. =
Valid knn accuracy guitar    : 52.900000000000006%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.627556562423706 sec. =
Valid knn accuracy residuals : 64.0%

Valid knn accuracy average   : 44.04%

                                                                        [AEpoch 39: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00324, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00576, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.100]Epoch 39: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00324, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.094855, 0.096298, 0.097060, 0.075670
Train average loss UNet                 (all)                : 0.363884

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000956, 3.905399, 7.260419
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004062, 4.242906, 6.316287
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002402, 4.835105, 7.100688
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002695, 4.920186, 7.467528
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001625, 5.360367, 7.984465
Train average loss all      (Triplet)                 : 0.002323

== Recognize ==
Train average loss Recognize     : 1.105315
Train average accuracy drums     : 50.849998 %
Train average accuracy bass      : 49.849998 %
Train average accuracy piano     : 49.919998 %
Train average accuracy guitar    : 49.869999 %
Train average accuracy residuals : 50.174999 %

== Train average loss all : 0.005962

Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00324, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]          Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00324, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]Epoch 40:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.00324, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]Epoch 40:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]Epoch 40:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]Epoch 40:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00991, Train/loss_unet_all_step=0.373, Train/loss_triplet_all_step=0.00618, Train/loss_recog_step=1.090, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]Epoch 40:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00991, Train/loss_unet_all_step=0.373, Train/loss_triplet_all_step=0.00618, Train/loss_recog_step=1.090, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]Epoch 40:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00749, Train/loss_unet_all_step=0.383, Train/loss_triplet_all_step=0.00366, Train/loss_recog_step=1.160, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]Epoch 40:  64%|██████▍   | 200/313 [02:44<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00749, Train/loss_unet_all_step=0.383, Train/loss_triplet_all_step=0.00366, Train/loss_recog_step=1.160, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]Epoch 40:  64%|██████▍   | 200/313 [02:44<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00336, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]  Epoch 40:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00336, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]Epoch 40:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00434, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.00076, Train/loss_recog_step=1.080, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]Epoch 40:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00434, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.00076, Train/loss_recog_step=1.080, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]Epoch 40:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]  Epoch 40: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]Epoch 40: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.22it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.88it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.66it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.78it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.59it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.110472, 0.109371, 0.101111, 0.101623
Valid average loss UNet                 (all)                : 0.422576

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.121909, 4.282999, 6.308443
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.375385, 4.602011, 5.128815
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.778557, 6.269297, 6.362877
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.228133, 5.645297, 7.311540
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.240994, 6.218046, 7.173754
Valid average loss all      (Triplet)                 : 0.337745

== Recognize ==
Valid average loss Recognize     : 0.990365
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.341971

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.327525615692139 sec. =
Valid knn accuracy drums     : 65.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.250454425811768 sec. =
Valid knn accuracy bass      : 17.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.645035028457642 sec. =
Valid knn accuracy piano     : 17.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.161237478256226 sec. =
Valid knn accuracy guitar    : 53.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.773813486099243 sec. =
Valid knn accuracy residuals : 64.1%

Valid knn accuracy average   : 43.60000000000001%

                                                                        [AEpoch 40: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00596, Train/loss_unet_all_epoch=0.364, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.110]Epoch 40: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.094674, 0.096168, 0.096908, 0.074707
Train average loss UNet                 (all)                : 0.362457

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001145, 3.977080, 7.362040
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003884, 4.349018, 6.467340
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003082, 4.910005, 7.228436
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002165, 5.067266, 7.718958
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002140, 5.465120, 8.143591
Train average loss all      (Triplet)                 : 0.002469

== Recognize ==
Train average loss Recognize     : 1.117134
Train average accuracy drums     : 50.040001 %
Train average accuracy bass      : 50.094997 %
Train average accuracy piano     : 49.849998 %
Train average accuracy guitar    : 50.384998 %
Train average accuracy residuals : 49.369999 %

== Train average loss all : 0.006093

Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]          Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]Epoch 41:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]Epoch 41:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]Epoch 41:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]Epoch 41:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00361, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]Epoch 41:  48%|████▊     | 150/313 [02:05<02:16,  1.20it/s, v_num=0, Train/loss_all_step=0.00361, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]Epoch 41:  48%|████▊     | 150/313 [02:05<02:16,  1.20it/s, v_num=0, Train/loss_all_step=0.00402, Train/loss_unet_all_step=0.402, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]Epoch 41:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00402, Train/loss_unet_all_step=0.402, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]Epoch 41:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]Epoch 41:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]Epoch 41:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]Epoch 41:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]Epoch 41:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00363, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]Epoch 41: 100%|██████████| 313/313 [04:11<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00363, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]Epoch 41: 100%|██████████| 313/313 [04:11<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.79it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.01it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.78it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.70it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:02<00:00,  5.41it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108805, 0.109252, 0.100297, 0.101287
Valid average loss UNet                 (all)                : 0.419641

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.107695, 4.095861, 6.390825
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.448792, 4.664506, 5.175297
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.726261, 5.987089, 6.145721
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.224941, 5.609080, 7.270422
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.221642, 5.992100, 6.924731
Valid average loss all      (Triplet)                 : 0.329850

== Recognize ==
Valid average loss Recognize     : 1.001862
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.334046

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.203892946243286 sec. =
Valid knn accuracy drums     : 67.10000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.328828573226929 sec. =
Valid knn accuracy bass      : 18.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.680559396743774 sec. =
Valid knn accuracy piano     : 18.099999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.79042911529541 sec. =
Valid knn accuracy guitar    : 54.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.662636756896973 sec. =
Valid knn accuracy residuals : 64.5%

Valid knn accuracy average   : 44.480000000000004%

                                                                        [AEpoch 41: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00609, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.120]Epoch 41: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.094499, 0.095982, 0.096634, 0.074867
Train average loss UNet                 (all)                : 0.361982

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000118, 3.885475, 7.358707
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003597, 4.294460, 6.408252
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002388, 4.805393, 7.074305
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001375, 4.966575, 7.630329
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001314, 5.485830, 8.277974
Train average loss all      (Triplet)                 : 0.001916

== Recognize ==
Train average loss Recognize     : 1.111284
Train average accuracy drums     : 49.235001 %
Train average accuracy bass      : 50.320000 %
Train average accuracy piano     : 50.685001 %
Train average accuracy guitar    : 50.459999 %
Train average accuracy residuals : 50.005001 %

== Train average loss all : 0.005535

Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]          Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]Epoch 42:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]Epoch 42:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00377, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=8.89e-5, Train/loss_recog_step=1.100, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]Epoch 42:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00377, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=8.89e-5, Train/loss_recog_step=1.100, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]Epoch 42:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=0.982, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]Epoch 42:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=0.982, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]Epoch 42:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00722, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.00318, Train/loss_recog_step=1.140, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]Epoch 42:  64%|██████▍   | 200/313 [02:44<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00722, Train/loss_unet_all_step=0.404, Train/loss_triplet_all_step=0.00318, Train/loss_recog_step=1.140, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]Epoch 42:  64%|██████▍   | 200/313 [02:44<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00854, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.005, Train/loss_recog_step=1.080, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]  Epoch 42:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00854, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.005, Train/loss_recog_step=1.080, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]Epoch 42:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]Epoch 42:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]Epoch 42:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=9.38e-6, Train/loss_recog_step=1.170, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]Epoch 42: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=9.38e-6, Train/loss_recog_step=1.170, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]Epoch 42: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.426, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.00it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.63it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.20it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.53it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.82it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.20it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109564, 0.110117, 0.100870, 0.093694
Valid average loss UNet                 (all)                : 0.414246

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099612, 4.187007, 6.364409
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.460170, 4.726393, 5.163225
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.655264, 5.840911, 6.073476
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.244156, 5.604399, 7.201087
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.262898, 5.868215, 6.731156
Valid average loss all      (Triplet)                 : 0.324123

== Recognize ==
Valid average loss Recognize     : 1.039659
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.328265

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.281779527664185 sec. =
Valid knn accuracy drums     : 68.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.587446928024292 sec. =
Valid knn accuracy bass      : 16.400000000000002%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.859064102172852 sec. =
Valid knn accuracy piano     : 16.900000000000002%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.292585611343384 sec. =
Valid knn accuracy guitar    : 48.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.26692271232605 sec. =
Valid knn accuracy residuals : 66.5%

Valid knn accuracy average   : 43.36000000000001%

                                                                        [AEpoch 42: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00554, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.110]Epoch 42: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.094517, 0.095909, 0.096609, 0.075336
Train average loss UNet                 (all)                : 0.362370

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001085, 3.839058, 7.243506
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003498, 4.251745, 6.371314
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001710, 4.708244, 6.940629
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001639, 4.919821, 7.573582
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000469, 5.379757, 8.143019
Train average loss all      (Triplet)                 : 0.001713

== Recognize ==
Train average loss Recognize     : 1.107757
Train average accuracy drums     : 50.379997 %
Train average accuracy bass      : 50.325001 %
Train average accuracy piano     : 49.685001 %
Train average accuracy guitar    : 49.930000 %
Train average accuracy residuals : 50.360001 %

== Train average loss all : 0.005337

Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]          Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]Epoch 43:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]Epoch 43:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.00362, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]Epoch 43:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00362, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]Epoch 43:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00476, Train/loss_unet_all_step=0.382, Train/loss_triplet_all_step=0.000944, Train/loss_recog_step=0.995, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]Epoch 43:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00476, Train/loss_unet_all_step=0.382, Train/loss_triplet_all_step=0.000944, Train/loss_recog_step=0.995, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]Epoch 43:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00396, Train/loss_unet_all_step=0.396, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]   Epoch 43:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00396, Train/loss_unet_all_step=0.396, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]Epoch 43:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00428, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000908, Train/loss_recog_step=1.140, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]Epoch 43:  80%|███████▉  | 250/313 [03:24<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00428, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000908, Train/loss_recog_step=1.140, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]Epoch 43:  80%|███████▉  | 250/313 [03:24<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]   Epoch 43:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]Epoch 43:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00467, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.00119, Train/loss_recog_step=1.220, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]Epoch 43: 100%|██████████| 313/313 [04:11<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00467, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.00119, Train/loss_recog_step=1.220, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]Epoch 43: 100%|██████████| 313/313 [04:11<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00824, Train/loss_recog_step=1.000, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.94it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.61it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.55it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.81it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.04it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.55it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109503, 0.108975, 0.099653, 0.087205
Valid average loss UNet                 (all)                : 0.405336

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.095830, 4.185629, 6.303786
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.457888, 4.786999, 5.220625
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.685223, 6.014596, 6.214128
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.290624, 5.852808, 7.585126
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.280648, 5.888113, 6.776486
Valid average loss all      (Triplet)                 : 0.351784

== Recognize ==
Valid average loss Recognize     : 1.124513
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.355837

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.588381290435791 sec. =
Valid knn accuracy drums     : 64.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.862188816070557 sec. =
Valid knn accuracy bass      : 18.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.438267946243286 sec. =
Valid knn accuracy piano     : 17.299999999999997%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.331319808959961 sec. =
Valid knn accuracy guitar    : 55.400000000000006%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.776395082473755 sec. =
Valid knn accuracy residuals : 64.5%

Valid knn accuracy average   : 44.04%

                                                                        [AEpoch 43: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00824, Train/loss_recog_step=1.000, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.110]Epoch 43: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00824, Train/loss_recog_step=1.000, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.094311, 0.095816, 0.096468, 0.075537
Train average loss UNet                 (all)                : 0.362132

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000095, 3.867903, 7.145797
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004563, 4.280118, 6.395940
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001800, 4.778777, 7.034770
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002579, 5.033971, 7.694975
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001058, 5.351464, 8.056678
Train average loss all      (Triplet)                 : 0.001955

== Recognize ==
Train average loss Recognize     : 1.118286
Train average accuracy drums     : 49.540001 %
Train average accuracy bass      : 49.544998 %
Train average accuracy piano     : 49.235001 %
Train average accuracy guitar    : 50.335003 %
Train average accuracy residuals : 50.739998 %

== Train average loss all : 0.005576

Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00824, Train/loss_recog_step=1.000, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]          Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00824, Train/loss_recog_step=1.000, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 44:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00824, Train/loss_recog_step=1.000, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 44:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00376, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120] Epoch 44:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00376, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 44:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00363, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 44:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00363, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 44:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00387, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 44:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.00387, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 44:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=1.150, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 44:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=1.150, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 44:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120] Epoch 44:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 44:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 44: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 44: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00539, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.00213, Train/loss_recog_step=1.170, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.395, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.84it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.61it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.82it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.78it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.31it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108828, 0.109740, 0.099608, 0.087969
Valid average loss UNet                 (all)                : 0.406145

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.145021, 4.426314, 6.528623
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.414193, 4.892984, 5.466371
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.828077, 6.146036, 6.246130
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.233453, 6.033235, 7.422953
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.284855, 6.097616, 7.041710
Valid average loss all      (Triplet)                 : 0.393091

== Recognize ==
Valid average loss Recognize     : 1.138646
Valid average accuracy drums     : 43.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.397153

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.930234432220459 sec. =
Valid knn accuracy drums     : 63.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.186538934707642 sec. =
Valid knn accuracy bass      : 18.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.660130739212036 sec. =
Valid knn accuracy piano     : 17.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.521123886108398 sec. =
Valid knn accuracy guitar    : 49.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.62448239326477 sec. =
Valid knn accuracy residuals : 64.0%

Valid knn accuracy average   : 42.64%

                                                                        [AEpoch 44: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00539, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.00213, Train/loss_recog_step=1.170, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00558, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 44: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00539, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.00213, Train/loss_recog_step=1.170, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.094201, 0.095643, 0.096288, 0.075170
Train average loss UNet                 (all)                : 0.361302

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000388, 3.939846, 7.221434
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003241, 4.392073, 6.571634
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002973, 4.934241, 7.195699
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003221, 5.248593, 8.042563
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000845, 5.414769, 8.082650
Train average loss all      (Triplet)                 : 0.002132

== Recognize ==
Train average loss Recognize     : 1.124761
Train average accuracy drums     : 50.410004 %
Train average accuracy bass      : 50.029999 %
Train average accuracy piano     : 50.680000 %
Train average accuracy guitar    : 49.919998 %
Train average accuracy residuals : 50.054996 %

== Train average loss all : 0.005745

Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00539, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.00213, Train/loss_recog_step=1.170, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]          Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00539, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.00213, Train/loss_recog_step=1.170, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]Epoch 45:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.00539, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.00213, Train/loss_recog_step=1.170, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]Epoch 45:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.00728, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.00359, Train/loss_recog_step=1.140, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]Epoch 45:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00728, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.00359, Train/loss_recog_step=1.140, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]Epoch 45:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]  Epoch 45:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]Epoch 45:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.388, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]Epoch 45:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.388, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]Epoch 45:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]Epoch 45:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]Epoch 45:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]Epoch 45:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]Epoch 45:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.00222, Train/loss_recog_step=1.120, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]Epoch 45: 100%|██████████| 313/313 [04:13<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.00222, Train/loss_recog_step=1.120, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]Epoch 45: 100%|██████████| 313/313 [04:13<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00315, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.353, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.19it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:02<00:00,  5.55it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.51it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.62it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.44it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.111607, 0.112070, 0.100915, 0.098462
Valid average loss UNet                 (all)                : 0.423054

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.127991, 4.292371, 6.576622
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.411389, 4.805341, 5.359481
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.806495, 6.087450, 6.278913
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.275218, 5.945716, 7.576751
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.258140, 5.971073, 7.199600
Valid average loss all      (Triplet)                 : 0.382858

== Recognize ==
Valid average loss Recognize     : 1.037438
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 56.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.387089

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.958464860916138 sec. =
Valid knn accuracy drums     : 67.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.018396615982056 sec. =
Valid knn accuracy bass      : 16.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.424666166305542 sec. =
Valid knn accuracy piano     : 17.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.241440296173096 sec. =
Valid knn accuracy guitar    : 49.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.706691265106201 sec. =
Valid knn accuracy residuals : 66.3%

Valid knn accuracy average   : 43.44%

                                                                        [AEpoch 45: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00315, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00575, Train/loss_unet_all_epoch=0.361, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.120]Epoch 45: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00315, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.094207, 0.095655, 0.096356, 0.075322
Train average loss UNet                 (all)                : 0.361540

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000338, 3.967477, 7.276406
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002887, 4.448145, 6.657623
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003839, 5.020049, 7.360553
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003806, 5.316317, 8.141998
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001607, 5.502685, 8.245876
Train average loss all      (Triplet)                 : 0.002447

== Recognize ==
Train average loss Recognize     : 1.131635
Train average accuracy drums     : 49.730000 %
Train average accuracy bass      : 49.639999 %
Train average accuracy piano     : 49.904999 %
Train average accuracy guitar    : 50.449997 %
Train average accuracy residuals : 50.295002 %

== Train average loss all : 0.006063

Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00315, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]          Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00315, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]Epoch 46:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00315, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]Epoch 46:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]Epoch 46:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]Epoch 46:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00865, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.00499, Train/loss_recog_step=1.120, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]Epoch 46:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00865, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.00499, Train/loss_recog_step=1.120, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]Epoch 46:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00933, Train/loss_unet_all_step=0.394, Train/loss_triplet_all_step=0.00539, Train/loss_recog_step=1.180, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]Epoch 46:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.00933, Train/loss_unet_all_step=0.394, Train/loss_triplet_all_step=0.00539, Train/loss_recog_step=1.180, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]Epoch 46:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.00426, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000687, Train/loss_recog_step=1.100, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]Epoch 46:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00426, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000687, Train/loss_recog_step=1.100, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]Epoch 46:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]   Epoch 46:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]Epoch 46:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]Epoch 46: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]Epoch 46: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.331, Valid/loss_unet_all_step=0.432, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.62it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.59it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.78it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.31it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108805, 0.108975, 0.100074, 0.092264
Valid average loss UNet                 (all)                : 0.410118

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.132034, 4.376429, 6.616589
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.461398, 4.858389, 5.288376
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.697387, 6.114823, 6.543970
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.319896, 5.890353, 7.189704
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.295195, 6.153802, 7.289478
Valid average loss all      (Triplet)                 : 0.368751

== Recognize ==
Valid average loss Recognize     : 1.090853
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.372852

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.904608964920044 sec. =
Valid knn accuracy drums     : 65.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.881344318389893 sec. =
Valid knn accuracy bass      : 18.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.271025657653809 sec. =
Valid knn accuracy piano     : 17.299999999999997%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.442359209060669 sec. =
Valid knn accuracy guitar    : 51.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.600949048995972 sec. =
Valid knn accuracy residuals : 67.80000000000001%

Valid knn accuracy average   : 44.2%

                                                                        [AEpoch 46: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00606, Train/loss_unet_all_epoch=0.362, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.130]Epoch 46: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.093975, 0.095514, 0.096112, 0.074380
Train average loss UNet                 (all)                : 0.359981

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000275, 3.943695, 7.170599
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003582, 4.478904, 6.758283
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002694, 5.105817, 7.509610
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002743, 5.241245, 8.020352
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002088, 5.549869, 8.307652
Train average loss all      (Triplet)                 : 0.002234

== Recognize ==
Train average loss Recognize     : 1.133623
Train average accuracy drums     : 49.389999 %
Train average accuracy bass      : 50.370003 %
Train average accuracy piano     : 50.070000 %
Train average accuracy guitar    : 50.325001 %
Train average accuracy residuals : 49.759998 %

== Train average loss all : 0.005834

Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]          Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]Epoch 47:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]Epoch 47:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]Epoch 47:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]Epoch 47:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]Epoch 47:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]Epoch 47:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00608, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=1.140, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]Epoch 47:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00608, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=1.140, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]Epoch 47:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00335, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130] Epoch 47:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00335, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]Epoch 47:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]Epoch 47:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]Epoch 47:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]Epoch 47: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]Epoch 47: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.369, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.442, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.83it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.06it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.67it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.62it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.76it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.107804, 0.109337, 0.100694, 0.095363
Valid average loss UNet                 (all)                : 0.413197

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.133181, 4.497664, 6.629559
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.483629, 4.889995, 5.146929
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.824976, 6.169947, 6.351592
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.271313, 5.920278, 8.024775
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.286964, 6.231130, 7.159551
Valid average loss all      (Triplet)                 : 0.405393

== Recognize ==
Valid average loss Recognize     : 1.082065
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.409525

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.296663522720337 sec. =
Valid knn accuracy drums     : 66.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.836199283599854 sec. =
Valid knn accuracy bass      : 16.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.30981183052063 sec. =
Valid knn accuracy piano     : 17.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.567416906356812 sec. =
Valid knn accuracy guitar    : 53.300000000000004%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.479821920394897 sec. =
Valid knn accuracy residuals : 66.5%

Valid knn accuracy average   : 43.96%

                                                                        [AEpoch 47: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00583, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.130]Epoch 47: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.093865, 0.095315, 0.095979, 0.074402
Train average loss UNet                 (all)                : 0.359562

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000830, 4.092824, 7.414964
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003037, 4.570716, 6.897293
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001921, 5.092739, 7.560236
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002570, 5.238557, 8.071805
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000899, 5.675029, 8.497178
Train average loss all      (Triplet)                 : 0.001934

== Recognize ==
Train average loss Recognize     : 1.136955
Train average accuracy drums     : 50.204998 %
Train average accuracy bass      : 50.129997 %
Train average accuracy piano     : 49.935001 %
Train average accuracy guitar    : 50.564999 %
Train average accuracy residuals : 49.625000 %

== Train average loss all : 0.005530

Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]          Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]Epoch 48:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]Epoch 48:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00369, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]Epoch 48:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00369, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]Epoch 48:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00356, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]Epoch 48:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00356, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]Epoch 48:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00391, Train/loss_unet_all_step=0.391, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]Epoch 48:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00391, Train/loss_unet_all_step=0.391, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]Epoch 48:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140] Epoch 48:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]Epoch 48:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=1.070, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]Epoch 48:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=1.070, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]Epoch 48:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00383, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000247, Train/loss_recog_step=1.070, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]Epoch 48: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00383, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000247, Train/loss_recog_step=1.070, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]Epoch 48: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=1.260, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.409, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.76it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  5.32it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.86it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.12it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.111462, 0.110831, 0.100074, 0.088907
Valid average loss UNet                 (all)                : 0.411273

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.125123, 4.510139, 6.741727
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.446478, 4.936938, 5.362806
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.806991, 6.186625, 6.375854
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.213696, 5.921078, 7.548194
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.323816, 6.227147, 7.288293
Valid average loss all      (Triplet)                 : 0.403158

== Recognize ==
Valid average loss Recognize     : 1.081911
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 44.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.407270

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.43023681640625 sec. =
Valid knn accuracy drums     : 61.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.527551174163818 sec. =
Valid knn accuracy bass      : 17.599999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.860451221466064 sec. =
Valid knn accuracy piano     : 19.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.702698707580566 sec. =
Valid knn accuracy guitar    : 50.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.333570718765259 sec. =
Valid knn accuracy residuals : 66.4%

Valid knn accuracy average   : 43.16%

                                                                        [AEpoch 48: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=1.260, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00553, Train/loss_unet_all_epoch=0.360, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.140]Epoch 48: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=1.260, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.093754, 0.095148, 0.095880, 0.074222
Train average loss UNet                 (all)                : 0.359004

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001707, 4.128036, 7.583198
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002876, 4.567634, 6.884839
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002319, 5.144110, 7.631557
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001428, 5.278900, 8.211310
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001766, 5.721906, 8.538577
Train average loss all      (Triplet)                 : 0.002138

== Recognize ==
Train average loss Recognize     : 1.138385
Train average accuracy drums     : 49.549999 %
Train average accuracy bass      : 50.285000 %
Train average accuracy piano     : 49.735001 %
Train average accuracy guitar    : 50.524998 %
Train average accuracy residuals : 49.189999 %

== Train average loss all : 0.005728

Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=1.260, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]          Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=1.260, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]Epoch 49:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=1.260, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]Epoch 49:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.00471, Train/loss_recog_step=1.120, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]Epoch 49:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.00471, Train/loss_recog_step=1.120, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]Epoch 49:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.0037, Train/loss_unet_all_step=0.370, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]   Epoch 49:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.0037, Train/loss_unet_all_step=0.370, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]Epoch 49:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00386, Train/loss_unet_all_step=0.386, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]Epoch 49:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00386, Train/loss_unet_all_step=0.386, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]Epoch 49:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]Epoch 49:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]Epoch 49:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]Epoch 49:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]Epoch 49:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]Epoch 49: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]Epoch 49: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.29it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.35it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.93it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.91it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109924, 0.109845, 0.102572, 0.095813
Valid average loss UNet                 (all)                : 0.418153

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.126504, 4.398702, 6.576203
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.394691, 4.654122, 5.125961
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.763585, 6.170460, 6.373773
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.198670, 5.702242, 7.553688
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.285332, 5.897916, 6.819407
Valid average loss all      (Triplet)                 : 0.365765

== Recognize ==
Valid average loss Recognize     : 1.063947
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.369946

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.527978897094727 sec. =
Valid knn accuracy drums     : 64.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.886860132217407 sec. =
Valid knn accuracy bass      : 16.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.857185125350952 sec. =
Valid knn accuracy piano     : 19.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.579301118850708 sec. =
Valid knn accuracy guitar    : 47.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.663564205169678 sec. =
Valid knn accuracy residuals : 67.80000000000001%

Valid knn accuracy average   : 43.14%

                                                                        [AEpoch 49: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.140]Epoch 49: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.093592, 0.095069, 0.095762, 0.074671
Train average loss UNet                 (all)                : 0.359094

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000912, 4.055576, 7.493527
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003374, 4.429464, 6.692211
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002715, 5.056403, 7.458721
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001394, 5.194678, 8.053023
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001232, 5.551074, 8.343824
Train average loss all      (Triplet)                 : 0.001971

== Recognize ==
Train average loss Recognize     : 1.127012
Train average accuracy drums     : 50.545002 %
Train average accuracy bass      : 50.314999 %
Train average accuracy piano     : 49.364998 %
Train average accuracy guitar    : 50.274998 %
Train average accuracy residuals : 50.080002 %

== Train average loss all : 0.005562

Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]          Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 50:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 50:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 50:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 50:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00365, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 50:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00365, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 50:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.004, Train/loss_unet_all_step=0.400, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]  Epoch 50:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.004, Train/loss_unet_all_step=0.400, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 50:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 50:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 50:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00547, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=1.110, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 50:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00547, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=1.110, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 50:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]  Epoch 50: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 50: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.418, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.27it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.43it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.88it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.60it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109654, 0.110501, 0.098486, 0.088541
Valid average loss UNet                 (all)                : 0.407182

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.117672, 4.568482, 6.821746
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.506226, 4.814872, 5.211386
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.746062, 6.238533, 6.423615
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.218098, 5.896052, 7.645055
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.289477, 6.119299, 7.165337
Valid average loss all      (Triplet)                 : 0.390222

== Recognize ==
Valid average loss Recognize     : 1.117311
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 36.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.394293

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.673584938049316 sec. =
Valid knn accuracy drums     : 68.89999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.230393171310425 sec. =
Valid knn accuracy bass      : 14.499999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.89106798171997 sec. =
Valid knn accuracy piano     : 18.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.090378284454346 sec. =
Valid knn accuracy guitar    : 52.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.011723518371582 sec. =
Valid knn accuracy residuals : 66.5%

Valid knn accuracy average   : 44.1%

                                                                        [AEpoch 50: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.359, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 50: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.093476, 0.094917, 0.095583, 0.074385
Train average loss UNet                 (all)                : 0.358361

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000568, 4.097351, 7.582454
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001224, 4.328990, 6.556399
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003149, 4.982840, 7.414585
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001131, 5.168978, 8.045429
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000920, 5.563875, 8.393579
Train average loss all      (Triplet)                 : 0.001406

== Recognize ==
Train average loss Recognize     : 1.120841
Train average accuracy drums     : 50.344997 %
Train average accuracy bass      : 50.349998 %
Train average accuracy piano     : 50.169998 %
Train average accuracy guitar    : 50.099998 %
Train average accuracy residuals : 50.190002 %

== Train average loss all : 0.004990

Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]          Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]Epoch 51:  16%|█▌        | 50/313 [00:45<03:59,  1.10it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]Epoch 51:  16%|█▌        | 50/313 [00:45<03:59,  1.10it/s, v_num=0, Train/loss_all_step=0.0037, Train/loss_unet_all_step=0.370, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120] Epoch 51:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.0037, Train/loss_unet_all_step=0.370, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]Epoch 51:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]Epoch 51:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]Epoch 51:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00394, Train/loss_unet_all_step=0.394, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]Epoch 51:  64%|██████▍   | 200/313 [02:44<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00394, Train/loss_unet_all_step=0.394, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]Epoch 51:  64%|██████▍   | 200/313 [02:44<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.0231, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.0197, Train/loss_recog_step=1.090, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]Epoch 51:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.0231, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.0197, Train/loss_recog_step=1.090, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]Epoch 51:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00811, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.00457, Train/loss_recog_step=1.160, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]Epoch 51:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00811, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.00457, Train/loss_recog_step=1.160, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]Epoch 51:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.00115, Train/loss_recog_step=1.110, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]Epoch 51: 100%|██████████| 313/313 [04:11<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.00115, Train/loss_recog_step=1.110, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]Epoch 51: 100%|██████████| 313/313 [04:11<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.20it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.73it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.50it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.63it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.71it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.55it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.107315, 0.108941, 0.098782, 0.090591
Valid average loss UNet                 (all)                : 0.405628

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.126812, 4.553776, 6.783263
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.433971, 5.111092, 5.645050
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.767187, 6.351413, 6.554158
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.241690, 6.039744, 7.642421
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.304021, 6.375824, 7.291767
Valid average loss all      (Triplet)                 : 0.358641

== Recognize ==
Valid average loss Recognize     : 1.098855
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 43.500000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.362697

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.278137445449829 sec. =
Valid knn accuracy drums     : 70.19999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.015905141830444 sec. =
Valid knn accuracy bass      : 17.599999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.113472938537598 sec. =
Valid knn accuracy piano     : 17.599999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.73558235168457 sec. =
Valid knn accuracy guitar    : 48.699999999999996%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.192938566207886 sec. =
Valid knn accuracy residuals : 64.5%

Valid knn accuracy average   : 43.72%

                                                                        [AEpoch 51: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.120]Epoch 51: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.093358, 0.094787, 0.095369, 0.074879
Train average loss UNet                 (all)                : 0.358394

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001202, 4.156127, 7.790240
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002527, 4.503686, 6.779983
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001492, 5.060596, 7.528533
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001133, 5.234691, 8.106346
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000450, 5.527928, 8.302817
Train average loss all      (Triplet)                 : 0.001396

== Recognize ==
Train average loss Recognize     : 1.120707
Train average accuracy drums     : 50.305004 %
Train average accuracy bass      : 50.225002 %
Train average accuracy piano     : 49.169998 %
Train average accuracy guitar    : 49.610001 %
Train average accuracy residuals : 50.795002 %

== Train average loss all : 0.004980

Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120]          Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120]Epoch 52:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120]Epoch 52:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.0057, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.00216, Train/loss_recog_step=1.200, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120]Epoch 52:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.0057, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.00216, Train/loss_recog_step=1.200, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120]Epoch 52:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120] Epoch 52:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120]Epoch 52:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00391, Train/loss_unet_all_step=0.391, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120]Epoch 52:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00391, Train/loss_unet_all_step=0.391, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120]Epoch 52:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00846, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.00511, Train/loss_recog_step=1.190, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120]Epoch 52:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00846, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.00511, Train/loss_recog_step=1.190, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120]Epoch 52:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120]  Epoch 52:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120]Epoch 52:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120] Epoch 52: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120]Epoch 52: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=1.250, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.50it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.70it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.10it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.74it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109397, 0.109543, 0.098637, 0.096229
Valid average loss UNet                 (all)                : 0.413807

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.092698, 4.685513, 7.126561
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.427008, 5.083732, 5.704737
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.804527, 6.430864, 6.606592
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.302585, 6.124581, 8.119747
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.269042, 6.653313, 7.796626
Valid average loss all      (Triplet)                 : 0.382324

== Recognize ==
Valid average loss Recognize     : 1.029328
Valid average accuracy drums     : 56.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.386462

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.451988220214844 sec. =
Valid knn accuracy drums     : 67.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.580691576004028 sec. =
Valid knn accuracy bass      : 18.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.41201114654541 sec. =
Valid knn accuracy piano     : 17.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.067830562591553 sec. =
Valid knn accuracy guitar    : 56.89999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.543567419052124 sec. =
Valid knn accuracy residuals : 64.60000000000001%

Valid knn accuracy average   : 44.94%

                                                                        [AEpoch 52: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=1.250, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00498, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.120]Epoch 52: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=1.250, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.093324, 0.094696, 0.095426, 0.073972
Train average loss UNet                 (all)                : 0.357418

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000388, 4.252855, 7.885440
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003460, 4.709775, 7.020104
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002033, 5.180064, 7.622680
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003429, 5.489590, 8.490247
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001299, 5.721895, 8.575253
Train average loss all      (Triplet)                 : 0.002149

== Recognize ==
Train average loss Recognize     : 1.131414
Train average accuracy drums     : 49.834999 %
Train average accuracy bass      : 50.185001 %
Train average accuracy piano     : 49.489998 %
Train average accuracy guitar    : 49.494999 %
Train average accuracy residuals : 50.089996 %

== Train average loss all : 0.005723

Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=1.250, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]          Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=1.250, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]Epoch 53:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=1.250, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]Epoch 53:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.0168, Train/loss_unet_all_step=0.373, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=1.130, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]  Epoch 53:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.0168, Train/loss_unet_all_step=0.373, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=1.130, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]Epoch 53:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]Epoch 53:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]Epoch 53:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00377, Train/loss_unet_all_step=0.377, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]Epoch 53:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00377, Train/loss_unet_all_step=0.377, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]Epoch 53:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.00294, Train/loss_recog_step=1.140, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]Epoch 53:  80%|███████▉  | 250/313 [03:25<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.00294, Train/loss_recog_step=1.140, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]Epoch 53:  80%|███████▉  | 250/313 [03:25<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00335, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]  Epoch 53:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00335, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]Epoch 53:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00987, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.00637, Train/loss_recog_step=1.120, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]Epoch 53: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00987, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.00637, Train/loss_recog_step=1.120, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]Epoch 53: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.49it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.79it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.66it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.36it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.110365, 0.110339, 0.098994, 0.093825
Valid average loss UNet                 (all)                : 0.413522

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.121119, 4.864940, 7.019473
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.482287, 5.271328, 5.873779
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.764060, 6.612370, 6.693002
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.273163, 6.321766, 8.250181
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.346104, 6.478229, 7.581958
Valid average loss all      (Triplet)                 : 0.403877

== Recognize ==
Valid average loss Recognize     : 1.099895
Valid average accuracy drums     : 43.500000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.408012

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.558704376220703 sec. =
Valid knn accuracy drums     : 67.60000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.754093408584595 sec. =
Valid knn accuracy bass      : 18.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.631542444229126 sec. =
Valid knn accuracy piano     : 18.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.414802551269531 sec. =
Valid knn accuracy guitar    : 55.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.833719968795776 sec. =
Valid knn accuracy residuals : 64.60000000000001%

Valid knn accuracy average   : 44.82000000000001%

                                                                        [AEpoch 53: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00572, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.130]Epoch 53: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.093253, 0.094727, 0.095400, 0.074438
Train average loss UNet                 (all)                : 0.357818

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000666, 4.328194, 7.966928
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003516, 4.766705, 7.131421
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002363, 5.253132, 7.767735
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002920, 5.605512, 8.679172
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002166, 5.856274, 8.811015
Train average loss all      (Triplet)                 : 0.002340

== Recognize ==
Train average loss Recognize     : 1.145698
Train average accuracy drums     : 50.395000 %
Train average accuracy bass      : 50.320000 %
Train average accuracy piano     : 49.474998 %
Train average accuracy guitar    : 49.654999 %
Train average accuracy residuals : 50.040001 %

== Train average loss all : 0.005918

Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]          Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]Epoch 54:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]Epoch 54:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00364, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]Epoch 54:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00364, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]Epoch 54:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00375, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]Epoch 54:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00375, Train/loss_unet_all_step=0.375, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]Epoch 54:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00373, Train/loss_unet_all_step=0.373, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]Epoch 54:  64%|██████▍   | 200/313 [02:44<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00373, Train/loss_unet_all_step=0.373, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]Epoch 54:  64%|██████▍   | 200/313 [02:44<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000169, Train/loss_recog_step=1.150, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]Epoch 54:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000169, Train/loss_recog_step=1.150, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]Epoch 54:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00336, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]   Epoch 54:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00336, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]Epoch 54:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=1.140, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]Epoch 54: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=1.140, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]Epoch 54: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.429, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.19it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.73it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.82it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.38it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.63it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109022, 0.109126, 0.098716, 0.089675
Valid average loss UNet                 (all)                : 0.406540

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.103659, 4.823296, 7.259123
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.496968, 5.239954, 5.794733
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.759467, 6.641685, 6.791224
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.291850, 6.432466, 8.138423
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.301109, 6.487391, 7.466654
Valid average loss all      (Triplet)                 : 0.381006

== Recognize ==
Valid average loss Recognize     : 1.072619
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.385071

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.761672496795654 sec. =
Valid knn accuracy drums     : 68.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.912198305130005 sec. =
Valid knn accuracy bass      : 20.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.306412696838379 sec. =
Valid knn accuracy piano     : 17.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.242553472518921 sec. =
Valid knn accuracy guitar    : 53.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.79299807548523 sec. =
Valid knn accuracy residuals : 61.6%

Valid knn accuracy average   : 44.06%

                                                                        [AEpoch 54: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.00592, Train/loss_unet_all_epoch=0.358, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.150]Epoch 54: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.093154, 0.094553, 0.095254, 0.073633
Train average loss UNet                 (all)                : 0.356593

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000255, 4.355157, 8.036090
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003886, 4.830282, 7.228654
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002066, 5.318384, 7.884502
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002025, 5.628157, 8.711837
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001242, 5.862814, 8.799472
Train average loss all      (Triplet)                 : 0.001936

== Recognize ==
Train average loss Recognize     : 1.162767
Train average accuracy drums     : 49.755001 %
Train average accuracy bass      : 50.019997 %
Train average accuracy piano     : 49.895000 %
Train average accuracy guitar    : 49.959999 %
Train average accuracy residuals : 49.825001 %

== Train average loss all : 0.005501

Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]          Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]Epoch 55:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]Epoch 55:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.00365, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]Epoch 55:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00365, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]Epoch 55:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00975, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.00616, Train/loss_recog_step=1.140, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]Epoch 55:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00975, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.00616, Train/loss_recog_step=1.140, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]Epoch 55:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00386, Train/loss_unet_all_step=0.386, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]  Epoch 55:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00386, Train/loss_unet_all_step=0.386, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]Epoch 55:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]Epoch 55:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]Epoch 55:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]Epoch 55:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]Epoch 55:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]Epoch 55: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]Epoch 55: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.441, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.19it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.98it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.80it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.05it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.61it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109360, 0.109583, 0.098327, 0.087983
Valid average loss UNet                 (all)                : 0.405252

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.120915, 4.715222, 7.040329
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.522107, 5.417557, 6.026640
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.772073, 6.623875, 6.707267
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.395663, 6.615910, 8.116129
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.282050, 6.881491, 7.847277
Valid average loss all      (Triplet)                 : 0.401955

== Recognize ==
Valid average loss Recognize     : 1.112628
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 43.000000 %
Valid average accuracy piano     : 56.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 42.000000 %

== Valid average loss all : 0.406008

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.140595436096191 sec. =
Valid knn accuracy drums     : 68.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.48288893699646 sec. =
Valid knn accuracy bass      : 16.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.435359001159668 sec. =
Valid knn accuracy piano     : 17.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.322155952453613 sec. =
Valid knn accuracy guitar    : 52.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.76560378074646 sec. =
Valid knn accuracy residuals : 62.0%

Valid knn accuracy average   : 43.24000000000001%

                                                                        [AEpoch 55: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.357, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.160]Epoch 55: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.093019, 0.094456, 0.095124, 0.073900
Train average loss UNet                 (all)                : 0.356500

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000248, 4.389006, 8.150673
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003122, 4.909256, 7.377701
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002070, 5.344273, 7.942760
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001317, 5.678226, 8.766018
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002472, 6.010049, 9.002041
Train average loss all      (Triplet)                 : 0.001902

== Recognize ==
Train average loss Recognize     : 1.153393
Train average accuracy drums     : 49.950001 %
Train average accuracy bass      : 50.994999 %
Train average accuracy piano     : 50.344997 %
Train average accuracy guitar    : 49.584999 %
Train average accuracy residuals : 49.759998 %

== Train average loss all : 0.005467

Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]          Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]Epoch 56:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]Epoch 56:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.00381, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.00017, Train/loss_recog_step=1.130, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]Epoch 56:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00381, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.00017, Train/loss_recog_step=1.130, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]Epoch 56:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00365, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]  Epoch 56:  48%|████▊     | 150/313 [02:08<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00365, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]Epoch 56:  48%|████▊     | 150/313 [02:08<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00396, Train/loss_unet_all_step=0.396, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]Epoch 56:  64%|██████▍   | 200/313 [02:48<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00396, Train/loss_unet_all_step=0.396, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]Epoch 56:  64%|██████▍   | 200/313 [02:48<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]Epoch 56:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]Epoch 56:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.00487, Train/loss_recog_step=1.090, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]Epoch 56:  96%|█████████▌| 300/313 [04:08<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.00487, Train/loss_recog_step=1.090, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]Epoch 56:  96%|█████████▌| 300/313 [04:08<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00372, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.000212, Train/loss_recog_step=1.170, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]Epoch 56: 100%|██████████| 313/313 [04:15<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.00372, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.000212, Train/loss_recog_step=1.170, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]Epoch 56: 100%|██████████| 313/313 [04:15<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.00381, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000448, Train/loss_recog_step=1.140, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.391, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.432, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.33it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.71it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.86it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.66it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.106652, 0.109077, 0.098200, 0.095314
Valid average loss UNet                 (all)                : 0.409244

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.107846, 4.623623, 6.568274
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.518715, 5.346115, 6.025923
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.908449, 6.662096, 6.650514
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.453522, 6.499213, 7.887932
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.345610, 6.601595, 7.363487
Valid average loss all      (Triplet)                 : 0.477325

== Recognize ==
Valid average loss Recognize     : 0.999095
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.481417

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.896994352340698 sec. =
Valid knn accuracy drums     : 70.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.05091953277588 sec. =
Valid knn accuracy bass      : 19.900000000000002%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.895185470581055 sec. =
Valid knn accuracy piano     : 17.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.641047954559326 sec. =
Valid knn accuracy guitar    : 53.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.570676803588867 sec. =
Valid knn accuracy residuals : 63.5%

Valid knn accuracy average   : 44.879999999999995%

                                                                        [AEpoch 56: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00381, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000448, Train/loss_recog_step=1.140, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.150]Epoch 56: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00381, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000448, Train/loss_recog_step=1.140, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.093028, 0.094346, 0.095042, 0.074064
Train average loss UNet                 (all)                : 0.356480

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000214, 4.344390, 8.003896
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003252, 4.906882, 7.395771
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004364, 5.379638, 7.963989
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001652, 5.692955, 8.792418
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002040, 5.963841, 8.912707
Train average loss all      (Triplet)                 : 0.002334

== Recognize ==
Train average loss Recognize     : 1.147482
Train average accuracy drums     : 49.649998 %
Train average accuracy bass      : 50.309998 %
Train average accuracy piano     : 49.775002 %
Train average accuracy guitar    : 49.674999 %
Train average accuracy residuals : 50.209999 %

== Train average loss all : 0.005898

Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00381, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000448, Train/loss_recog_step=1.140, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]          Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00381, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000448, Train/loss_recog_step=1.140, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]Epoch 57:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00381, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000448, Train/loss_recog_step=1.140, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]Epoch 57:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00525, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=1.150, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150] Epoch 57:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00525, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=1.150, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]Epoch 57:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00362, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]  Epoch 57:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00362, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]Epoch 57:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00529, Train/loss_unet_all_step=0.377, Train/loss_triplet_all_step=0.00152, Train/loss_recog_step=1.190, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]Epoch 57:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00529, Train/loss_unet_all_step=0.377, Train/loss_triplet_all_step=0.00152, Train/loss_recog_step=1.190, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]Epoch 57:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]  Epoch 57:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]Epoch 57:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00885, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.00545, Train/loss_recog_step=1.170, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]Epoch 57:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00885, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.00545, Train/loss_recog_step=1.170, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]Epoch 57:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00703, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.00352, Train/loss_recog_step=1.110, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]Epoch 57: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00703, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.00352, Train/loss_recog_step=1.110, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]Epoch 57: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.400, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.449, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.79it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.69it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.72it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.79it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.55it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.107654, 0.109694, 0.099774, 0.094392
Valid average loss UNet                 (all)                : 0.411515

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.152386, 4.763051, 6.634074
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.562967, 5.334618, 5.990323
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.938008, 6.904374, 6.757687
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.348429, 6.679482, 8.332043
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.394956, 6.862446, 7.652073
Valid average loss all      (Triplet)                 : 0.497010

== Recognize ==
Valid average loss Recognize     : 1.070085
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 56.000000 %

== Valid average loss all : 0.501125

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.254582405090332 sec. =
Valid knn accuracy drums     : 64.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.146758317947388 sec. =
Valid knn accuracy bass      : 20.200000000000003%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.986128091812134 sec. =
Valid knn accuracy piano     : 17.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.916727542877197 sec. =
Valid knn accuracy guitar    : 53.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.420742988586426 sec. =
Valid knn accuracy residuals : 68.8%

Valid knn accuracy average   : 44.84%

                                                                        [AEpoch 57: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0059, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=1.150]Epoch 57: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.092895, 0.094336, 0.095008, 0.073934
Train average loss UNet                 (all)                : 0.356173

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000462, 4.376175, 7.934544
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003362, 4.956079, 7.512205
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002044, 5.405005, 7.990610
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001177, 5.724935, 8.844850
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002309, 6.020348, 9.005453
Train average loss all      (Triplet)                 : 0.001921

== Recognize ==
Train average loss Recognize     : 1.151873
Train average accuracy drums     : 49.649998 %
Train average accuracy bass      : 49.945000 %
Train average accuracy piano     : 50.169998 %
Train average accuracy guitar    : 49.845001 %
Train average accuracy residuals : 50.295002 %

== Train average loss all : 0.005482

Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]          Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]Epoch 58:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]Epoch 58:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.00716, Train/loss_recog_step=1.150, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]Epoch 58:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.00716, Train/loss_recog_step=1.150, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]Epoch 58:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00851, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.00496, Train/loss_recog_step=1.130, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]Epoch 58:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00851, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.00496, Train/loss_recog_step=1.130, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]Epoch 58:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00393, Train/loss_unet_all_step=0.393, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]  Epoch 58:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.00393, Train/loss_unet_all_step=0.393, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]Epoch 58:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150] Epoch 58:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]Epoch 58:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]Epoch 58:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]Epoch 58:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]Epoch 58: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]Epoch 58: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.37it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.25it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.70it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108705, 0.109325, 0.098499, 0.098374
Valid average loss UNet                 (all)                : 0.414904

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.110065, 4.833039, 7.218324
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.518964, 5.317573, 6.019867
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.025652, 6.870982, 6.651656
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.304731, 6.340376, 8.320341
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.416215, 6.747300, 7.490258
Valid average loss all      (Triplet)                 : 0.481339

== Recognize ==
Valid average loss Recognize     : 1.007943
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.485488

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.812355995178223 sec. =
Valid knn accuracy drums     : 66.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.357834100723267 sec. =
Valid knn accuracy bass      : 19.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.604509353637695 sec. =
Valid knn accuracy piano     : 16.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.205058813095093 sec. =
Valid knn accuracy guitar    : 54.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.493421077728271 sec. =
Valid knn accuracy residuals : 68.10000000000001%

Valid knn accuracy average   : 44.980000000000004%

                                                                        [AEpoch 58: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00548, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.150]Epoch 58: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.092876, 0.094338, 0.094976, 0.073970
Train average loss UNet                 (all)                : 0.356159

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000870, 4.425300, 8.124371
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004324, 5.019273, 7.614542
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002683, 5.455400, 8.025799
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002957, 5.722847, 8.808621
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002143, 6.111411, 9.182518
Train average loss all      (Triplet)                 : 0.002710

== Recognize ==
Train average loss Recognize     : 1.144334
Train average accuracy drums     : 50.470001 %
Train average accuracy bass      : 50.414997 %
Train average accuracy piano     : 49.639999 %
Train average accuracy guitar    : 50.295002 %
Train average accuracy residuals : 49.514999 %

== Train average loss all : 0.006272

Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]          Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]Epoch 59:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]Epoch 59:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=1.060, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]Epoch 59:  32%|███▏      | 100/313 [01:26<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=1.060, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]Epoch 59:  32%|███▏      | 100/313 [01:26<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.00196, Train/loss_recog_step=1.160, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]Epoch 59:  48%|████▊     | 150/313 [02:06<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.00196, Train/loss_recog_step=1.160, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]Epoch 59:  48%|████▊     | 150/313 [02:06<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.381, Train/loss_triplet_all_step=0.00767, Train/loss_recog_step=1.150, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140] Epoch 59:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.381, Train/loss_triplet_all_step=0.00767, Train/loss_recog_step=1.150, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]Epoch 59:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00429, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000909, Train/loss_recog_step=1.150, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]Epoch 59:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00429, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000909, Train/loss_recog_step=1.150, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]Epoch 59:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]   Epoch 59:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]Epoch 59:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=6.05e-5, Train/loss_recog_step=1.160, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]Epoch 59: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=6.05e-5, Train/loss_recog_step=1.160, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]Epoch 59: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.485, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.17it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.75it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.63it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.94it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.110810, 0.110276, 0.099279, 0.098917
Valid average loss UNet                 (all)                : 0.419282

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098477, 4.764557, 7.226516
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.561464, 5.359993, 6.032870
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.066278, 6.735824, 6.521585
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.301726, 6.599591, 8.356020
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.320004, 6.897712, 7.820755
Valid average loss all      (Triplet)                 : 0.498982

== Recognize ==
Valid average loss Recognize     : 1.026249
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.503175

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.093536138534546 sec. =
Valid knn accuracy drums     : 66.10000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.118041038513184 sec. =
Valid knn accuracy bass      : 21.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.455234289169312 sec. =
Valid knn accuracy piano     : 17.299999999999997%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.178743600845337 sec. =
Valid knn accuracy guitar    : 53.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.002649784088135 sec. =
Valid knn accuracy residuals : 67.60000000000001%

Valid knn accuracy average   : 45.18000000000001%

                                                                        [AEpoch 59: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00627, Train/loss_unet_all_epoch=0.356, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.140]Epoch 59: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.092654, 0.094059, 0.094731, 0.073905
Train average loss UNet                 (all)                : 0.355349

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000728, 4.362644, 8.314611
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003233, 4.862758, 7.390354
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001295, 5.328683, 7.880230
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001585, 5.708942, 8.841506
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001793, 6.032514, 9.118691
Train average loss all      (Triplet)                 : 0.001809

== Recognize ==
Train average loss Recognize     : 1.147887
Train average accuracy drums     : 49.779999 %
Train average accuracy bass      : 50.489998 %
Train average accuracy piano     : 50.735004 %
Train average accuracy guitar    : 49.865002 %
Train average accuracy residuals : 50.300003 %

== Train average loss all : 0.005363

Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]          Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]Epoch 60:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]Epoch 60:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00366, Train/loss_unet_all_step=0.366, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]Epoch 60:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00366, Train/loss_unet_all_step=0.366, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]Epoch 60:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.0186, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=1.150, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]Epoch 60:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.0186, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=1.150, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]Epoch 60:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.388, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]Epoch 60:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.388, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]Epoch 60:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]Epoch 60:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]Epoch 60:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00343, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]Epoch 60:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00343, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]Epoch 60:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00932, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.00588, Train/loss_recog_step=1.220, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]Epoch 60: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00932, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.00588, Train/loss_recog_step=1.220, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]Epoch 60: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=0.990, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.56it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.59it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.78it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.97it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108395, 0.109733, 0.099130, 0.098976
Valid average loss UNet                 (all)                : 0.416233

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.074763, 4.750645, 7.330732
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.441743, 5.341930, 6.035448
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.876215, 6.749531, 6.702938
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.326183, 6.650968, 8.396145
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.272280, 6.690101, 7.766546
Valid average loss all      (Triplet)                 : 0.399594

== Recognize ==
Valid average loss Recognize     : 1.062434
Valid average accuracy drums     : 56.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.403756

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.051542520523071 sec. =
Valid knn accuracy drums     : 66.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.666625261306763 sec. =
Valid knn accuracy bass      : 19.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.39045524597168 sec. =
Valid knn accuracy piano     : 17.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.711090803146362 sec. =
Valid knn accuracy guitar    : 53.800000000000004%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.451377153396606 sec. =
Valid knn accuracy residuals : 69.0%

Valid knn accuracy average   : 45.08%

                                                                        [AEpoch 60: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00536, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.150]Epoch 60: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.092603, 0.094002, 0.094707, 0.073779
Train average loss UNet                 (all)                : 0.355091

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000395, 4.350763, 8.136323
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002124, 4.901081, 7.493619
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001433, 5.318447, 7.887061
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002754, 5.719431, 8.850650
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001128, 6.081723, 9.211166
Train average loss all      (Triplet)                 : 0.001673

== Recognize ==
Train average loss Recognize     : 1.149205
Train average accuracy drums     : 49.794998 %
Train average accuracy bass      : 50.515003 %
Train average accuracy piano     : 50.505001 %
Train average accuracy guitar    : 50.500000 %
Train average accuracy residuals : 49.700001 %

== Train average loss all : 0.005224

Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]          Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]Epoch 61:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]Epoch 61:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.0068, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=1.110, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]Epoch 61:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.0068, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=1.110, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]Epoch 61:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.00391, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.00036, Train/loss_recog_step=1.140, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]Epoch 61:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00391, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.00036, Train/loss_recog_step=1.140, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]Epoch 61:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00401, Train/loss_unet_all_step=0.401, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]  Epoch 61:  64%|██████▍   | 200/313 [02:48<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00401, Train/loss_unet_all_step=0.401, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]Epoch 61:  64%|██████▍   | 200/313 [02:48<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150] Epoch 61:  80%|███████▉  | 250/313 [03:27<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]Epoch 61:  80%|███████▉  | 250/313 [03:27<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]Epoch 61:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]Epoch 61:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00938, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=1.210, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]Epoch 61: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00938, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=1.210, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]Epoch 61: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00312, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.21it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.08it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.95it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.43it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.41it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.67it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109791, 0.109419, 0.099356, 0.098632
Valid average loss UNet                 (all)                : 0.417197

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.093504, 4.967883, 7.606555
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.456031, 5.224869, 5.865555
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.857033, 6.753965, 6.827871
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.276760, 6.560147, 8.499891
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.270656, 7.002475, 8.071971
Valid average loss all      (Triplet)                 : 0.405134

== Recognize ==
Valid average loss Recognize     : 1.083906
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 43.000000 %
Valid average accuracy residuals : 57.500000 %

== Valid average loss all : 0.409306

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.208339214324951 sec. =
Valid knn accuracy drums     : 68.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.451760053634644 sec. =
Valid knn accuracy bass      : 18.099999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.116723775863647 sec. =
Valid knn accuracy piano     : 17.299999999999997%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.443651914596558 sec. =
Valid knn accuracy guitar    : 53.800000000000004%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.215304851531982 sec. =
Valid knn accuracy residuals : 68.5%

Valid knn accuracy average   : 45.18000000000001%

                                                                        [AEpoch 61: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00312, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00522, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.150]Epoch 61: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00312, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.092525, 0.093980, 0.094656, 0.073698
Train average loss UNet                 (all)                : 0.354859

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001567, 4.463711, 8.314514
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002146, 4.957401, 7.588916
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001235, 5.367576, 7.997014
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001750, 5.784777, 8.965480
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001667, 6.103421, 9.250488
Train average loss all      (Triplet)                 : 0.001657

== Recognize ==
Train average loss Recognize     : 1.162513
Train average accuracy drums     : 49.779999 %
Train average accuracy bass      : 49.639999 %
Train average accuracy piano     : 50.120003 %
Train average accuracy guitar    : 50.559998 %
Train average accuracy residuals : 50.059998 %

== Train average loss all : 0.005206

Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00312, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]          Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00312, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]Epoch 62:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00312, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]Epoch 62:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]Epoch 62:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]Epoch 62:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00816, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=1.230, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]Epoch 62:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00816, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=1.230, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]Epoch 62:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.398, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=1.190, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]  Epoch 62:  64%|██████▍   | 200/313 [02:48<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.398, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=1.190, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]Epoch 62:  64%|██████▍   | 200/313 [02:48<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.0141, Train/loss_recog_step=1.090, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]Epoch 62:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.0141, Train/loss_recog_step=1.090, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]Epoch 62:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=1.140, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]Epoch 62:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=1.140, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]Epoch 62:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]Epoch 62: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00357, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]Epoch 62: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00307, Train/loss_unet_all_step=0.307, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.433, Valid/loss_triplet_all_step=0.342, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.417, Valid/loss_triplet_all_epoch=0.405, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.452, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.19it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.56it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.84it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.78it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.91it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108852, 0.109808, 0.099831, 0.104353
Valid average loss UNet                 (all)                : 0.422844

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091658, 5.128010, 7.882287
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.444543, 5.382567, 6.124866
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.903237, 6.933100, 6.896083
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.292169, 6.651452, 8.509826
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.328429, 7.016658, 7.893052
Valid average loss all      (Triplet)                 : 0.432537

== Recognize ==
Valid average loss Recognize     : 1.029272
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 56.000000 %

== Valid average loss all : 0.436766

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.346120119094849 sec. =
Valid knn accuracy drums     : 64.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.538555145263672 sec. =
Valid knn accuracy bass      : 17.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.220277786254883 sec. =
Valid knn accuracy piano     : 17.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.390305042266846 sec. =
Valid knn accuracy guitar    : 50.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.491995096206665 sec. =
Valid knn accuracy residuals : 63.5%

Valid knn accuracy average   : 42.56%

                                                                        [AEpoch 62: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00307, Train/loss_unet_all_step=0.307, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.355, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.160]Epoch 62: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00307, Train/loss_unet_all_step=0.307, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.092248, 0.093820, 0.094428, 0.073152
Train average loss UNet                 (all)                : 0.353648

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000507, 4.574396, 8.555810
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003311, 5.024683, 7.549840
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000301, 5.429066, 8.089446
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001579, 5.789749, 8.941430
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000618, 6.149575, 9.336784
Train average loss all      (Triplet)                 : 0.001399

== Recognize ==
Train average loss Recognize     : 1.171692
Train average accuracy drums     : 49.654999 %
Train average accuracy bass      : 50.150002 %
Train average accuracy piano     : 49.945000 %
Train average accuracy guitar    : 49.974998 %
Train average accuracy residuals : 49.959999 %

== Train average loss all : 0.004935

Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00307, Train/loss_unet_all_step=0.307, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]          Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00307, Train/loss_unet_all_step=0.307, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]Epoch 63:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.00307, Train/loss_unet_all_step=0.307, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]Epoch 63:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.00366, Train/loss_unet_all_step=0.366, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]Epoch 63:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00366, Train/loss_unet_all_step=0.366, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]Epoch 63:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]Epoch 63:  48%|████▊     | 150/313 [02:05<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]Epoch 63:  48%|████▊     | 150/313 [02:05<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00692, Train/loss_unet_all_step=0.384, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=1.220, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]Epoch 63:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.00692, Train/loss_unet_all_step=0.384, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=1.220, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]Epoch 63:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]   Epoch 63:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]Epoch 63:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00335, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]Epoch 63:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00335, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]Epoch 63:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]Epoch 63: 100%|██████████| 313/313 [04:13<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]Epoch 63: 100%|██████████| 313/313 [04:13<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.440, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.423, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.426, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.44it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.52it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.80it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.48it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108216, 0.109084, 0.099606, 0.097549
Valid average loss UNet                 (all)                : 0.414454

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.104530, 4.969765, 7.566647
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.616953, 5.569613, 6.032810
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.992673, 7.066875, 6.980390
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.251433, 6.728546, 8.680412
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.343977, 7.186531, 8.040710
Valid average loss all      (Triplet)                 : 0.482554

== Recognize ==
Valid average loss Recognize     : 0.991939
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 42.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.486698

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.111916780471802 sec. =
Valid knn accuracy drums     : 67.30000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.168328762054443 sec. =
Valid knn accuracy bass      : 21.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.733975887298584 sec. =
Valid knn accuracy piano     : 18.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.308908939361572 sec. =
Valid knn accuracy guitar    : 53.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.403779029846191 sec. =
Valid knn accuracy residuals : 68.4%

Valid knn accuracy average   : 45.7%

                                                                        [AEpoch 63: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00494, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.170]Epoch 63: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.092299, 0.093712, 0.094388, 0.072885
Train average loss UNet                 (all)                : 0.353284

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001065, 4.590206, 8.624684
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002859, 5.040737, 7.605058
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002128, 5.508890, 8.161776
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000931, 5.778625, 8.908514
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001715, 6.203204, 9.390796
Train average loss all      (Triplet)                 : 0.001718

== Recognize ==
Train average loss Recognize     : 1.174490
Train average accuracy drums     : 49.059998 %
Train average accuracy bass      : 50.755001 %
Train average accuracy piano     : 49.895000 %
Train average accuracy guitar    : 49.570000 %
Train average accuracy residuals : 49.869999 %

== Train average loss all : 0.005251

Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]          Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]Epoch 64:  16%|█▌        | 50/313 [00:45<03:58,  1.10it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]Epoch 64:  16%|█▌        | 50/313 [00:45<03:58,  1.10it/s, v_num=0, Train/loss_all_step=0.00364, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]Epoch 64:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00364, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]Epoch 64:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]Epoch 64:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.367, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]Epoch 64:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00366, Train/loss_unet_all_step=0.366, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]Epoch 64:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00366, Train/loss_unet_all_step=0.366, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]Epoch 64:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]Epoch 64:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]Epoch 64:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170] Epoch 64:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]Epoch 64:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]Epoch 64: 100%|██████████| 313/313 [04:09<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]Epoch 64: 100%|██████████| 313/313 [04:09<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.00504, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.00167, Train/loss_recog_step=1.150, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.425, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=0.561, Valid/loss_all_epoch=0.487, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.457, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.80it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.75it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.46it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.50it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.57it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.107729, 0.108918, 0.098643, 0.109511
Valid average loss UNet                 (all)                : 0.424801

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098104, 5.038058, 7.567312
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.549721, 5.641707, 6.140709
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.985081, 7.051986, 7.028103
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.265801, 6.759935, 8.656273
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.304767, 7.183332, 8.119343
Valid average loss all      (Triplet)                 : 0.463959

== Recognize ==
Valid average loss Recognize     : 1.067521
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 57.000000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.468207

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.052673816680908 sec. =
Valid knn accuracy drums     : 65.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.919651508331299 sec. =
Valid knn accuracy bass      : 19.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.31251859664917 sec. =
Valid knn accuracy piano     : 17.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.275771856307983 sec. =
Valid knn accuracy guitar    : 55.300000000000004%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.041119813919067 sec. =
Valid knn accuracy residuals : 68.4%

Valid knn accuracy average   : 45.260000000000005%

                                                                        [AEpoch 64: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00504, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.00167, Train/loss_recog_step=1.150, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00525, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.170]Epoch 64: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00504, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.00167, Train/loss_recog_step=1.150, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.092408, 0.093824, 0.094401, 0.073856
Train average loss UNet                 (all)                : 0.354489

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000293, 4.577996, 8.504170
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001548, 5.063031, 7.671240
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003693, 5.679450, 8.383397
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001006, 5.837919, 8.985150
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000796, 6.172758, 9.390761
Train average loss all      (Triplet)                 : 0.001520

== Recognize ==
Train average loss Recognize     : 1.174863
Train average accuracy drums     : 49.955002 %
Train average accuracy bass      : 50.239998 %
Train average accuracy piano     : 50.040001 %
Train average accuracy guitar    : 49.634998 %
Train average accuracy residuals : 49.770000 %

== Train average loss all : 0.005065

Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00504, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.00167, Train/loss_recog_step=1.150, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]          Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00504, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.00167, Train/loss_recog_step=1.150, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]Epoch 65:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00504, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.00167, Train/loss_recog_step=1.150, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]Epoch 65:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]  Epoch 65:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]Epoch 65:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]Epoch 65:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]Epoch 65:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.382, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=1.170, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170] Epoch 65:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.382, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=1.170, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]Epoch 65:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00328, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]Epoch 65:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00328, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]Epoch 65:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.0278, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.0243, Train/loss_recog_step=1.040, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]Epoch 65:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.0278, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.0243, Train/loss_recog_step=1.040, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]Epoch 65:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00343, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]Epoch 65: 100%|██████████| 313/313 [04:11<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00343, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]Epoch 65: 100%|██████████| 313/313 [04:11<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.447, Valid/loss_triplet_all_step=0.513, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.425, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.80it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.59it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.79it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.22it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.96it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.106904, 0.107761, 0.098870, 0.098439
Valid average loss UNet                 (all)                : 0.411974

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.094355, 5.050326, 7.659434
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.416494, 5.511246, 6.214779
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.885165, 6.975406, 7.178174
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.306204, 6.626332, 8.479195
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.343437, 7.015890, 7.948761
Valid average loss all      (Triplet)                 : 0.444252

== Recognize ==
Valid average loss Recognize     : 1.088462
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 44.000000 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.448371

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.608439683914185 sec. =
Valid knn accuracy drums     : 66.10000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.149597883224487 sec. =
Valid knn accuracy bass      : 19.400000000000002%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.20170545578003 sec. =
Valid knn accuracy piano     : 18.099999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.631844758987427 sec. =
Valid knn accuracy guitar    : 53.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.727294683456421 sec. =
Valid knn accuracy residuals : 67.60000000000001%

Valid knn accuracy average   : 44.96000000000001%

                                                                        [AEpoch 65: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.354, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.170]Epoch 65: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.092245, 0.093653, 0.094277, 0.073231
Train average loss UNet                 (all)                : 0.353405

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000986, 4.605438, 8.567202
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002158, 5.162092, 7.828105
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002944, 5.685710, 8.450712
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001560, 5.908885, 9.100731
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002004, 6.262057, 9.509984
Train average loss all      (Triplet)                 : 0.002016

== Recognize ==
Train average loss Recognize     : 1.176926
Train average accuracy drums     : 49.855000 %
Train average accuracy bass      : 49.590000 %
Train average accuracy piano     : 49.410000 %
Train average accuracy guitar    : 50.174999 %
Train average accuracy residuals : 50.410004 %

== Train average loss all : 0.005550

Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]          Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]Epoch 66:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]Epoch 66:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00366, Train/loss_unet_all_step=0.366, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]Epoch 66:  32%|███▏      | 100/313 [01:26<03:04,  1.16it/s, v_num=0, Train/loss_all_step=0.00366, Train/loss_unet_all_step=0.366, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]Epoch 66:  32%|███▏      | 100/313 [01:26<03:04,  1.16it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]Epoch 66:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]Epoch 66:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00385, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]Epoch 66:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.00385, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]Epoch 66:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]Epoch 66:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]Epoch 66:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]Epoch 66:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]Epoch 66:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00345, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]Epoch 66: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00345, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]Epoch 66: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00309, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.402, Valid/loss_triplet_all_step=0.483, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.450, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.60it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.55it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.06it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.73it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.92it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109303, 0.108337, 0.100863, 0.100968
Valid average loss UNet                 (all)                : 0.419472

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101136, 5.062606, 7.512300
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.451113, 5.445417, 6.230820
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.815966, 6.962931, 7.102244
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.221125, 6.599972, 8.584526
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.363724, 7.013421, 7.999609
Valid average loss all      (Triplet)                 : 0.408625

== Recognize ==
Valid average loss Recognize     : 1.069260
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.412820

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.98071026802063 sec. =
Valid knn accuracy drums     : 67.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.500755548477173 sec. =
Valid knn accuracy bass      : 18.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.891081809997559 sec. =
Valid knn accuracy piano     : 18.099999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.386555671691895 sec. =
Valid knn accuracy guitar    : 49.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.067286729812622 sec. =
Valid knn accuracy residuals : 65.3%

Valid knn accuracy average   : 43.82%

                                                                        [AEpoch 66: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00309, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00555, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.180]Epoch 66: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00309, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.092125, 0.093534, 0.094201, 0.073343
Train average loss UNet                 (all)                : 0.353203

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000882, 4.593278, 8.470263
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003204, 5.145041, 7.808194
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001847, 5.636022, 8.414790
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002835, 5.943681, 9.160724
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001150, 6.178768, 9.369652
Train average loss all      (Triplet)                 : 0.002040

== Recognize ==
Train average loss Recognize     : 1.183478
Train average accuracy drums     : 49.794998 %
Train average accuracy bass      : 49.204998 %
Train average accuracy piano     : 49.799999 %
Train average accuracy guitar    : 50.155003 %
Train average accuracy residuals : 50.105000 %

== Train average loss all : 0.005572

Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00309, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]          Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00309, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]Epoch 67:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.00309, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]Epoch 67:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.00361, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]Epoch 67:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00361, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]Epoch 67:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00363, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]Epoch 67:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00363, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]Epoch 67:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00385, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]Epoch 67:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00385, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]Epoch 67:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]Epoch 67:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]Epoch 67:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]Epoch 67:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]Epoch 67:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00356, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]Epoch 67: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00356, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]Epoch 67: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.419, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.21it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.69it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.87it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.72it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.22it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.87it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108872, 0.108360, 0.099199, 0.088626
Valid average loss UNet                 (all)                : 0.405056

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.119849, 4.878033, 7.466489
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.361536, 5.425666, 6.349792
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.914922, 6.981372, 7.135623
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.248669, 6.594350, 8.515999
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.373491, 6.936066, 7.790478
Valid average loss all      (Triplet)                 : 0.423979

== Recognize ==
Valid average loss Recognize     : 1.161162
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 41.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 42.000000 %

== Valid average loss all : 0.428030

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.58031177520752 sec. =
Valid knn accuracy drums     : 66.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.957044124603271 sec. =
Valid knn accuracy bass      : 17.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.166579246520996 sec. =
Valid knn accuracy piano     : 17.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.268478870391846 sec. =
Valid knn accuracy guitar    : 51.300000000000004%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.46377682685852 sec. =
Valid knn accuracy residuals : 64.0%

Valid knn accuracy average   : 43.38%

                                                                        [AEpoch 67: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00557, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.180]Epoch 67: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.092042, 0.093400, 0.094060, 0.073191
Train average loss UNet                 (all)                : 0.352693

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000436, 4.583925, 8.435369
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003578, 5.171615, 7.840202
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001743, 5.641345, 8.471699
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001767, 5.862599, 9.035112
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000662, 6.186140, 9.405777
Train average loss all      (Triplet)                 : 0.001736

== Recognize ==
Train average loss Recognize     : 1.175089
Train average accuracy drums     : 49.669998 %
Train average accuracy bass      : 50.164997 %
Train average accuracy piano     : 50.279999 %
Train average accuracy guitar    : 50.160004 %
Train average accuracy residuals : 49.360001 %

== Train average loss all : 0.005263

Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]          Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]Epoch 68:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]Epoch 68:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.0036, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180] Epoch 68:  32%|███▏      | 100/313 [01:26<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.0036, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]Epoch 68:  32%|███▏      | 100/313 [01:26<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]Epoch 68:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]Epoch 68:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=1.310, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]Epoch 68:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.376, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=1.310, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]Epoch 68:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]Epoch 68:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]Epoch 68:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=1.130, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]Epoch 68:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=1.130, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]Epoch 68:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]Epoch 68: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]Epoch 68: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00328, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.393, Valid/loss_triplet_all_step=0.372, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.92it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.07it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.82it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.63it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.84it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108704, 0.108744, 0.099104, 0.098569
Valid average loss UNet                 (all)                : 0.415121

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.096822, 5.031960, 7.766973
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.540522, 5.499078, 6.084164
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.712109, 6.771862, 7.160172
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.311941, 6.800452, 8.819701
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.422696, 7.208951, 8.115726
Valid average loss all      (Triplet)                 : 0.439215

== Recognize ==
Valid average loss Recognize     : 1.127998
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.443366

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.30612564086914 sec. =
Valid knn accuracy drums     : 67.30000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.595871448516846 sec. =
Valid knn accuracy bass      : 16.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.6802659034729 sec. =
Valid knn accuracy piano     : 17.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.980160236358643 sec. =
Valid knn accuracy guitar    : 51.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.289276838302612 sec. =
Valid knn accuracy residuals : 66.5%

Valid knn accuracy average   : 43.760000000000005%

                                                                        [AEpoch 68: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00328, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.180]Epoch 68: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00328, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091963, 0.093395, 0.094023, 0.073449
Train average loss UNet                 (all)                : 0.352830

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000275, 4.643948, 8.470253
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003548, 5.225648, 7.911712
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001844, 5.666927, 8.477761
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002194, 5.944382, 9.158337
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000376, 6.250562, 9.479453
Train average loss all      (Triplet)                 : 0.001676

== Recognize ==
Train average loss Recognize     : 1.176354
Train average accuracy drums     : 49.634998 %
Train average accuracy bass      : 50.129997 %
Train average accuracy piano     : 50.054996 %
Train average accuracy guitar    : 50.029999 %
Train average accuracy residuals : 49.849998 %

== Train average loss all : 0.005204

Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00328, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180]          Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00328, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180]Epoch 69:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.00328, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180]Epoch 69:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.0036, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180] Epoch 69:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.0036, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180]Epoch 69:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00364, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180]Epoch 69:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00364, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180]Epoch 69:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00789, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=1.220, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180]Epoch 69:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.00789, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=1.220, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180]Epoch 69:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.00178, Train/loss_recog_step=1.210, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180]Epoch 69:  80%|███████▉  | 250/313 [03:27<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.00178, Train/loss_recog_step=1.210, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180]Epoch 69:  80%|███████▉  | 250/313 [03:27<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180] Epoch 69:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180]Epoch 69:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00774, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=1.230, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180]Epoch 69: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00774, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=1.230, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180]Epoch 69: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.430, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.62it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.61it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.03it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.78it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108577, 0.107721, 0.098225, 0.093324
Valid average loss UNet                 (all)                : 0.407848

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.112773, 5.302016, 7.803504
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.510064, 5.707615, 6.455416
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.759050, 7.125369, 7.428207
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.276884, 6.680399, 8.837415
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.408955, 7.279663, 8.230583
Valid average loss all      (Triplet)                 : 0.421355

== Recognize ==
Valid average loss Recognize     : 1.159143
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 43.000000 %

== Valid average loss all : 0.425433

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.688714027404785 sec. =
Valid knn accuracy drums     : 66.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.82687520980835 sec. =
Valid knn accuracy bass      : 18.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.575745582580566 sec. =
Valid knn accuracy piano     : 16.900000000000002%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.576770782470703 sec. =
Valid knn accuracy guitar    : 47.599999999999994%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.553269147872925 sec. =
Valid knn accuracy residuals : 64.5%

Valid knn accuracy average   : 42.72%

                                                                        [AEpoch 69: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0052, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.180]Epoch 69: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091988, 0.093405, 0.094043, 0.073892
Train average loss UNet                 (all)                : 0.353327

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000992, 4.753881, 8.740193
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002243, 5.226947, 7.913723
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002772, 5.754767, 8.542587
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001745, 6.066860, 9.303726
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001971, 6.419975, 9.734868
Train average loss all      (Triplet)                 : 0.001934

== Recognize ==
Train average loss Recognize     : 1.169190
Train average accuracy drums     : 50.349998 %
Train average accuracy bass      : 50.985001 %
Train average accuracy piano     : 50.220001 %
Train average accuracy guitar    : 50.274998 %
Train average accuracy residuals : 49.945000 %

== Train average loss all : 0.005467

Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]          Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]Epoch 70:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]Epoch 70:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]Epoch 70:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]Epoch 70:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00533, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.0018, Train/loss_recog_step=1.220, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]Epoch 70:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00533, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.0018, Train/loss_recog_step=1.220, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]Epoch 70:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.00285, Train/loss_recog_step=1.230, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]Epoch 70:  64%|██████▍   | 200/313 [02:48<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.00285, Train/loss_recog_step=1.230, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]Epoch 70:  64%|██████▍   | 200/313 [02:48<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]  Epoch 70:  80%|███████▉  | 250/313 [03:26<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]Epoch 70:  80%|███████▉  | 250/313 [03:26<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=1.260, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]Epoch 70:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=1.260, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]Epoch 70:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000409, Train/loss_recog_step=1.210, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]Epoch 70: 100%|██████████| 313/313 [04:13<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000409, Train/loss_recog_step=1.210, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]Epoch 70: 100%|██████████| 313/313 [04:13<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.99it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.10it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.60it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.60it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.26it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.110313, 0.109529, 0.098342, 0.093223
Valid average loss UNet                 (all)                : 0.411406

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.131210, 5.165091, 7.541794
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.456104, 5.667183, 6.329755
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.926823, 7.578693, 7.722823
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.349611, 7.115617, 9.192882
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.416304, 7.446271, 8.522207
Valid average loss all      (Triplet)                 : 0.494174

== Recognize ==
Valid average loss Recognize     : 1.111904
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.498288

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.281299352645874 sec. =
Valid knn accuracy drums     : 64.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.419755458831787 sec. =
Valid knn accuracy bass      : 17.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.025732040405273 sec. =
Valid knn accuracy piano     : 17.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.313967943191528 sec. =
Valid knn accuracy guitar    : 52.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.354408264160156 sec. =
Valid knn accuracy residuals : 65.7%

Valid knn accuracy average   : 43.60000000000001%

                                                                        [AEpoch 70: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.170]Epoch 70: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091783, 0.093169, 0.093891, 0.072951
Train average loss UNet                 (all)                : 0.351793

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000608, 4.829200, 8.693738
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002476, 5.241645, 7.937631
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002174, 5.880181, 8.774472
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001997, 6.168629, 9.429719
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002526, 6.511987, 9.870750
Train average loss all      (Triplet)                 : 0.001928

== Recognize ==
Train average loss Recognize     : 1.182431
Train average accuracy drums     : 50.209999 %
Train average accuracy bass      : 49.810001 %
Train average accuracy piano     : 49.649998 %
Train average accuracy guitar    : 50.005001 %
Train average accuracy residuals : 49.764999 %

== Train average loss all : 0.005446

Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]          Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 71:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 71:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.00373, Train/loss_unet_all_step=0.373, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 71:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00373, Train/loss_unet_all_step=0.373, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 71:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.370, Train/loss_triplet_all_step=0.00692, Train/loss_recog_step=1.090, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 71:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.370, Train/loss_triplet_all_step=0.00692, Train/loss_recog_step=1.090, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 71:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.388, Train/loss_triplet_all_step=0.00295, Train/loss_recog_step=1.230, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 71:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.388, Train/loss_triplet_all_step=0.00295, Train/loss_recog_step=1.230, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 71:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]  Epoch 71:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 71:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 71:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 71:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 71: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 71: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00315, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.551, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.547, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.436, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.54it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.71it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.95it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.56it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108401, 0.109315, 0.098857, 0.090426
Valid average loss UNet                 (all)                : 0.406999

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.111646, 5.104536, 7.805996
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.485710, 5.624635, 6.299458
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.782853, 7.289184, 7.353115
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.291557, 6.899816, 9.079426
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.382713, 7.338581, 8.472525
Valid average loss all      (Triplet)                 : 0.422413

== Recognize ==
Valid average loss Recognize     : 1.120050
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.426483

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.44723653793335 sec. =
Valid knn accuracy drums     : 67.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.635916948318481 sec. =
Valid knn accuracy bass      : 18.099999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.00448751449585 sec. =
Valid knn accuracy piano     : 16.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.197566032409668 sec. =
Valid knn accuracy guitar    : 55.900000000000006%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.654072761535645 sec. =
Valid knn accuracy residuals : 65.5%

Valid knn accuracy average   : 44.49999999999999%

                                                                        [AEpoch 71: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00315, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00545, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 71: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00315, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091762, 0.093225, 0.093865, 0.073834
Train average loss UNet                 (all)                : 0.352686

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000926, 4.757109, 8.629067
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002360, 5.262748, 8.030605
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002204, 5.802294, 8.675835
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002334, 6.199764, 9.575369
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001584, 6.544210, 9.955400
Train average loss all      (Triplet)                 : 0.001886

== Recognize ==
Train average loss Recognize     : 1.184582
Train average accuracy drums     : 50.115002 %
Train average accuracy bass      : 50.115002 %
Train average accuracy piano     : 50.515003 %
Train average accuracy guitar    : 49.355000 %
Train average accuracy residuals : 50.035000 %

== Train average loss all : 0.005413

Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00315, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180]          Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00315, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180]Epoch 72:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.00315, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180]Epoch 72:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.00692, Train/loss_recog_step=1.060, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180]Epoch 72:  32%|███▏      | 100/313 [01:25<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.00692, Train/loss_recog_step=1.060, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180]Epoch 72:  32%|███▏      | 100/313 [01:25<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00361, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180] Epoch 72:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00361, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180]Epoch 72:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00708, Train/loss_unet_all_step=0.389, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=1.110, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180]Epoch 72:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00708, Train/loss_unet_all_step=0.389, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=1.110, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180]Epoch 72:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180]  Epoch 72:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180]Epoch 72:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00392, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000507, Train/loss_recog_step=1.110, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180]Epoch 72:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00392, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000507, Train/loss_recog_step=1.110, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180]Epoch 72:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00532, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.00183, Train/loss_recog_step=1.160, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180] Epoch 72: 100%|██████████| 313/313 [04:11<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00532, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.00183, Train/loss_recog_step=1.160, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180]Epoch 72: 100%|██████████| 313/313 [04:11<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.00791, Train/loss_recog_step=1.250, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.96it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.56it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.84it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.76it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.05it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.91it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.107813, 0.108745, 0.098755, 0.095373
Valid average loss UNet                 (all)                : 0.410686

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.123176, 5.110385, 8.251953
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.394519, 5.585152, 6.404540
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.714136, 7.174985, 7.312298
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.298639, 6.912607, 8.940447
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.379572, 7.114079, 8.150259
Valid average loss all      (Triplet)                 : 0.388960

== Recognize ==
Valid average loss Recognize     : 1.095450
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.393067

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.707775354385376 sec. =
Valid knn accuracy drums     : 68.60000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.889591932296753 sec. =
Valid knn accuracy bass      : 18.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.229012489318848 sec. =
Valid knn accuracy piano     : 17.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.439697980880737 sec. =
Valid knn accuracy guitar    : 53.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.793550729751587 sec. =
Valid knn accuracy residuals : 62.8%

Valid knn accuracy average   : 44.32000000000001%

                                                                        [AEpoch 72: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.00791, Train/loss_recog_step=1.250, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00541, Train/loss_unet_all_epoch=0.353, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.180]Epoch 72: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.00791, Train/loss_recog_step=1.250, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091678, 0.093178, 0.093770, 0.073346
Train average loss UNet                 (all)                : 0.351972

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000505, 4.795270, 9.081792
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002500, 5.256179, 7.955240
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001088, 5.798969, 8.622196
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001566, 6.099495, 9.456351
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000595, 6.476319, 9.879334
Train average loss all      (Triplet)                 : 0.001258

== Recognize ==
Train average loss Recognize     : 1.180641
Train average accuracy drums     : 50.185001 %
Train average accuracy bass      : 50.320000 %
Train average accuracy piano     : 49.845001 %
Train average accuracy guitar    : 50.255001 %
Train average accuracy residuals : 50.059998 %

== Train average loss all : 0.004777

Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.00791, Train/loss_recog_step=1.250, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]          Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.00791, Train/loss_recog_step=1.250, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]Epoch 73:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.00791, Train/loss_recog_step=1.250, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]Epoch 73:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]  Epoch 73:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]Epoch 73:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]Epoch 73:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]Epoch 73:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00382, Train/loss_unet_all_step=0.382, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]Epoch 73:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00382, Train/loss_unet_all_step=0.382, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]Epoch 73:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00407, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000811, Train/loss_recog_step=1.190, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]Epoch 73:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00407, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000811, Train/loss_recog_step=1.190, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]Epoch 73:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00345, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]   Epoch 73:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00345, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]Epoch 73:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]Epoch 73: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]Epoch 73: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.91it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.65it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.72it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.68it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.65it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.94it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108029, 0.109587, 0.097776, 0.101016
Valid average loss UNet                 (all)                : 0.416408

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.141898, 5.020931, 7.847539
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.497439, 5.830261, 6.558033
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.912048, 7.396046, 7.478085
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.178974, 6.802943, 9.059217
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.353958, 7.141708, 8.310243
Valid average loss all      (Triplet)                 : 0.418597

== Recognize ==
Valid average loss Recognize     : 1.091139
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 57.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.422761

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.02602481842041 sec. =
Valid knn accuracy drums     : 70.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.140055179595947 sec. =
Valid knn accuracy bass      : 19.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.194345474243164 sec. =
Valid knn accuracy piano     : 16.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.013562202453613 sec. =
Valid knn accuracy guitar    : 52.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.653969287872314 sec. =
Valid knn accuracy residuals : 63.0%

Valid knn accuracy average   : 44.3%

                                                                        [AEpoch 73: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00478, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.180]Epoch 73: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091620, 0.092978, 0.093690, 0.072826
Train average loss UNet                 (all)                : 0.351115

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000417, 4.789590, 9.095013
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003088, 5.352892, 8.110502
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002254, 5.879025, 8.806708
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001134, 6.082017, 9.406446
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000849, 6.446459, 9.814579
Train average loss all      (Triplet)                 : 0.001580

== Recognize ==
Train average loss Recognize     : 1.176560
Train average accuracy drums     : 50.045002 %
Train average accuracy bass      : 50.169998 %
Train average accuracy piano     : 50.155003 %
Train average accuracy guitar    : 49.685001 %
Train average accuracy residuals : 49.599998 %

== Train average loss all : 0.005091

Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]          Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]Epoch 74:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]Epoch 74:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]Epoch 74:  32%|███▏      | 100/313 [01:26<03:04,  1.16it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]Epoch 74:  32%|███▏      | 100/313 [01:26<03:04,  1.16it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]Epoch 74:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]Epoch 74:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.397, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=1.130, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]Epoch 74:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.397, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=1.130, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]Epoch 74:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180] Epoch 74:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]Epoch 74:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00356, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]Epoch 74:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00356, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]Epoch 74:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]Epoch 74: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]Epoch 74: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.15it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.06it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.85it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.48it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.65it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108742, 0.108488, 0.098018, 0.096664
Valid average loss UNet                 (all)                : 0.411912

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.106322, 5.071143, 8.052639
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.503789, 5.793350, 6.633595
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.780430, 7.481452, 7.698766
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.241538, 6.894470, 8.895915
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.412878, 7.434331, 8.505762
Valid average loss all      (Triplet)                 : 0.397730

== Recognize ==
Valid average loss Recognize     : 1.070036
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 57.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.401849

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.550004243850708 sec. =
Valid knn accuracy drums     : 68.30000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.617940425872803 sec. =
Valid knn accuracy bass      : 16.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.789821147918701 sec. =
Valid knn accuracy piano     : 16.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.187322616577148 sec. =
Valid knn accuracy guitar    : 50.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.320819854736328 sec. =
Valid knn accuracy residuals : 67.60000000000001%

Valid knn accuracy average   : 43.92%

                                                                        [AEpoch 74: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00509, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.180]Epoch 74: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091616, 0.093038, 0.093745, 0.073393
Train average loss UNet                 (all)                : 0.351792

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000880, 4.798556, 9.027509
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002579, 5.356467, 8.118976
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002931, 5.876003, 8.783101
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002429, 6.104337, 9.485126
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000634, 6.360599, 9.641509
Train average loss all      (Triplet)                 : 0.001878

== Recognize ==
Train average loss Recognize     : 1.167407
Train average accuracy drums     : 50.564999 %
Train average accuracy bass      : 50.099998 %
Train average accuracy piano     : 50.094997 %
Train average accuracy guitar    : 50.449997 %
Train average accuracy residuals : 50.160004 %

== Train average loss all : 0.005396

Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]          Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]Epoch 75:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]Epoch 75:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]Epoch 75:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]Epoch 75:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]Epoch 75:  48%|████▊     | 150/313 [02:05<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]Epoch 75:  48%|████▊     | 150/313 [02:05<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.00391, Train/loss_unet_all_step=0.391, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]Epoch 75:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00391, Train/loss_unet_all_step=0.391, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]Epoch 75:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00323, Train/loss_unet_all_step=0.323, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]Epoch 75:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00323, Train/loss_unet_all_step=0.323, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]Epoch 75:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]Epoch 75:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]Epoch 75:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00343, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]Epoch 75: 100%|██████████| 313/313 [04:11<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00343, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]Epoch 75: 100%|██████████| 313/313 [04:11<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.423, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.23it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.93it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  5.10it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.63it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.07it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.90it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108237, 0.108963, 0.098771, 0.096280
Valid average loss UNet                 (all)                : 0.412251

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.097988, 5.042278, 7.935648
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.540894, 5.847541, 6.539962
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.848395, 7.585784, 7.707945
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.301533, 6.886392, 9.069482
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.383558, 7.319898, 8.293343
Valid average loss all      (Triplet)                 : 0.439415

== Recognize ==
Valid average loss Recognize     : 1.090607
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 43.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.443537

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.132173538208008 sec. =
Valid knn accuracy drums     : 66.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.978602886199951 sec. =
Valid knn accuracy bass      : 18.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.251579284667969 sec. =
Valid knn accuracy piano     : 16.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.685200452804565 sec. =
Valid knn accuracy guitar    : 54.800000000000004%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.665663719177246 sec. =
Valid knn accuracy residuals : 67.0%

Valid knn accuracy average   : 44.519999999999996%

                                                                        [AEpoch 75: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0054, Train/loss_unet_all_epoch=0.352, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.170]Epoch 75: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091447, 0.092924, 0.093489, 0.072940
Train average loss UNet                 (all)                : 0.350801

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000330, 4.834930, 9.088998
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001982, 5.389429, 8.164955
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002787, 5.938312, 8.861368
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002676, 6.134674, 9.521322
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000767, 6.418194, 9.746075
Train average loss all      (Triplet)                 : 0.001754

== Recognize ==
Train average loss Recognize     : 1.183533
Train average accuracy drums     : 49.169998 %
Train average accuracy bass      : 50.035000 %
Train average accuracy piano     : 50.330002 %
Train average accuracy guitar    : 50.875004 %
Train average accuracy residuals : 49.935001 %

== Train average loss all : 0.005262

Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]          Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]Epoch 76:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]Epoch 76:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00345, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]Epoch 76:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00345, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]Epoch 76:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00535, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.00187, Train/loss_recog_step=1.190, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]Epoch 76:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00535, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.00187, Train/loss_recog_step=1.190, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]Epoch 76:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00372, Train/loss_unet_all_step=0.372, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]  Epoch 76:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00372, Train/loss_unet_all_step=0.372, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]Epoch 76:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00335, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]Epoch 76:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00335, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]Epoch 76:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]Epoch 76:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]Epoch 76:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]Epoch 76: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]Epoch 76: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.428, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.49it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  5.24it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.77it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.77it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.41it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108574, 0.110481, 0.098883, 0.096282
Valid average loss UNet                 (all)                : 0.414220

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.109198, 5.178783, 8.422739
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.509767, 5.905672, 6.649930
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.950180, 7.697841, 7.778249
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.266679, 6.994590, 9.200151
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.368128, 7.559455, 8.599812
Valid average loss all      (Triplet)                 : 0.448419

== Recognize ==
Valid average loss Recognize     : 1.111512
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 43.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.452561

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.415082216262817 sec. =
Valid knn accuracy drums     : 65.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.545530557632446 sec. =
Valid knn accuracy bass      : 18.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.043095111846924 sec. =
Valid knn accuracy piano     : 16.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.302346229553223 sec. =
Valid knn accuracy guitar    : 53.800000000000004%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.517637968063354 sec. =
Valid knn accuracy residuals : 67.10000000000001%

Valid knn accuracy average   : 44.39999999999999%

                                                                        [AEpoch 76: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.180]Epoch 76: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091353, 0.092824, 0.093410, 0.072806
Train average loss UNet                 (all)                : 0.350394

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000923, 4.877355, 8.914038
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001031, 5.435485, 8.255544
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001305, 6.045651, 9.008625
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002448, 6.242263, 9.575885
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000426, 6.608271, 10.097044
Train average loss all      (Triplet)                 : 0.001168

== Recognize ==
Train average loss Recognize     : 1.193256
Train average accuracy drums     : 49.825001 %
Train average accuracy bass      : 49.970001 %
Train average accuracy piano     : 50.344997 %
Train average accuracy guitar    : 49.764999 %
Train average accuracy residuals : 50.234997 %

== Train average loss all : 0.004672

Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]          Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 77:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 77:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 77:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 77:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00361, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 77:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00361, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 77:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00378, Train/loss_unet_all_step=0.378, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 77:  64%|██████▍   | 200/313 [02:48<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00378, Train/loss_unet_all_step=0.378, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 77:  64%|██████▍   | 200/313 [02:48<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00328, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 77:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00328, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 77:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 77:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 77:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 77: 100%|██████████| 313/313 [04:15<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 77: 100%|██████████| 313/313 [04:15<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.0033, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.432, Valid/loss_unet_all_step=0.416, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.414, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.444, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.84it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.53it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.51it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.64it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.63it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108817, 0.110157, 0.098253, 0.088126
Valid average loss UNet                 (all)                : 0.405353

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098552, 5.044932, 8.223036
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.534788, 5.858101, 6.398432
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.873747, 7.778574, 7.805935
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.171685, 6.749670, 9.165653
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.402198, 7.506884, 8.468059
Valid average loss all      (Triplet)                 : 0.403190

== Recognize ==
Valid average loss Recognize     : 1.076655
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.407243

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.031289100646973 sec. =
Valid knn accuracy drums     : 67.10000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.915045976638794 sec. =
Valid knn accuracy bass      : 17.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.419563293457031 sec. =
Valid knn accuracy piano     : 17.599999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.490830183029175 sec. =
Valid knn accuracy guitar    : 55.800000000000004%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.640434741973877 sec. =
Valid knn accuracy residuals : 67.10000000000001%

Valid knn accuracy average   : 45.099999999999994%

                                                                        [AEpoch 77: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0033, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 77: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0033, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091306, 0.092733, 0.093416, 0.073305
Train average loss UNet                 (all)                : 0.350759

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000301, 4.932659, 9.299320
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001872, 5.386235, 8.180374
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002367, 6.048652, 9.003685
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002216, 6.256149, 9.586197
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000245, 6.530019, 9.936459
Train average loss all      (Triplet)                 : 0.001465

== Recognize ==
Train average loss Recognize     : 1.198199
Train average accuracy drums     : 49.945000 %
Train average accuracy bass      : 50.185001 %
Train average accuracy piano     : 49.735001 %
Train average accuracy guitar    : 49.700001 %
Train average accuracy residuals : 49.880001 %

== Train average loss all : 0.004973

Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0033, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]          Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0033, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]Epoch 78:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.0033, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]Epoch 78:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=1.320, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]Epoch 78:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=1.320, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]Epoch 78:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]Epoch 78:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]Epoch 78:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00981, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.00601, Train/loss_recog_step=1.280, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]Epoch 78:  64%|██████▍   | 200/313 [02:48<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00981, Train/loss_unet_all_step=0.379, Train/loss_triplet_all_step=0.00601, Train/loss_recog_step=1.280, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]Epoch 78:  64%|██████▍   | 200/313 [02:48<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]  Epoch 78:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]Epoch 78:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.0242, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=1.170, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]Epoch 78:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.0242, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=1.170, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]Epoch 78:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00662, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=1.220, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]Epoch 78: 100%|██████████| 313/313 [04:15<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00662, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=1.220, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]Epoch 78: 100%|██████████| 313/313 [04:15<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.403, Valid/loss_triplet_all_step=0.310, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.451, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.86it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.15it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.75it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.79it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.51it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.107737, 0.108585, 0.097783, 0.092442
Valid average loss UNet                 (all)                : 0.406547

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070626, 4.875789, 8.398102
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.603386, 5.828290, 6.403124
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.989954, 7.803124, 7.715739
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.270770, 6.606334, 8.886208
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.463896, 7.236675, 8.055318
Valid average loss all      (Triplet)                 : 0.470149

== Recognize ==
Valid average loss Recognize     : 1.088777
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.474215

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.166839122772217 sec. =
Valid knn accuracy drums     : 70.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.93613314628601 sec. =
Valid knn accuracy bass      : 15.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.634413003921509 sec. =
Valid knn accuracy piano     : 17.599999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.678515911102295 sec. =
Valid knn accuracy guitar    : 54.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.207865238189697 sec. =
Valid knn accuracy residuals : 64.2%

Valid knn accuracy average   : 44.26%

                                                                        [AEpoch 78: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00497, Train/loss_unet_all_epoch=0.351, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.200]Epoch 78: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091286, 0.092742, 0.093319, 0.072663
Train average loss UNet                 (all)                : 0.350010

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001174, 4.884898, 9.089991
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003744, 5.453048, 8.242370
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002225, 6.022991, 9.018429
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001742, 6.181533, 9.551958
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000857, 6.407454, 9.659310
Train average loss all      (Triplet)                 : 0.001972

== Recognize ==
Train average loss Recognize     : 1.178548
Train average accuracy drums     : 49.680000 %
Train average accuracy bass      : 50.594997 %
Train average accuracy piano     : 49.720001 %
Train average accuracy guitar    : 50.015003 %
Train average accuracy residuals : 50.230003 %

== Train average loss all : 0.005472

Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]          Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]Epoch 79:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]Epoch 79:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.00997, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=1.260, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]Epoch 79:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00997, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=1.260, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]Epoch 79:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]  Epoch 79:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]Epoch 79:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00362, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]Epoch 79:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00362, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]Epoch 79:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.00365, Train/loss_recog_step=1.250, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]Epoch 79:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.00365, Train/loss_recog_step=1.250, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]Epoch 79:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180] Epoch 79:  96%|█████████▌| 300/313 [04:09<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]Epoch 79:  96%|█████████▌| 300/313 [04:09<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.00335, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]Epoch 79: 100%|██████████| 313/313 [04:17<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.00335, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]Epoch 79: 100%|██████████| 313/313 [04:17<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.401, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.474, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.67it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.54it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.41it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.55it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109909, 0.110432, 0.100488, 0.092607
Valid average loss UNet                 (all)                : 0.413436

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.119703, 5.098938, 8.164311
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.515902, 5.935544, 6.642039
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.161919, 7.844605, 7.501515
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.278146, 6.806209, 9.143299
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.480953, 7.461577, 8.238976
Valid average loss all      (Triplet)                 : 0.538944

== Recognize ==
Valid average loss Recognize     : 1.141021
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 43.500000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.543079

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.44144868850708 sec. =
Valid knn accuracy drums     : 65.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.616887092590332 sec. =
Valid knn accuracy bass      : 16.400000000000002%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.683370113372803 sec. =
Valid knn accuracy piano     : 17.299999999999997%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.626985311508179 sec. =
Valid knn accuracy guitar    : 54.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.328262090682983 sec. =
Valid knn accuracy residuals : 68.8%

Valid knn accuracy average   : 44.519999999999996%

                                                                        [AEpoch 79: 100%|██████████| 313/313 [06:23<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00547, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.180]Epoch 79: 100%|██████████| 313/313 [06:23<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091321, 0.092769, 0.093375, 0.072731
Train average loss UNet                 (all)                : 0.350196

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000136, 4.920795, 9.206675
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004497, 5.468333, 8.180649
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001896, 5.980793, 8.883452
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001644, 6.213462, 9.607534
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001558, 6.563545, 9.873922
Train average loss all      (Triplet)                 : 0.001988

== Recognize ==
Train average loss Recognize     : 1.167342
Train average accuracy drums     : 51.035000 %
Train average accuracy bass      : 49.570000 %
Train average accuracy piano     : 49.410000 %
Train average accuracy guitar    : 49.895000 %
Train average accuracy residuals : 50.230003 %

== Train average loss all : 0.005490

Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]          Epoch 80:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]Epoch 80:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]Epoch 80:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]Epoch 80:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]Epoch 80:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]Epoch 80:  48%|████▊     | 150/313 [02:05<02:16,  1.20it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]Epoch 80:  48%|████▊     | 150/313 [02:05<02:16,  1.20it/s, v_num=0, Train/loss_all_step=0.00373, Train/loss_unet_all_step=0.373, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]Epoch 80:  64%|██████▍   | 200/313 [02:44<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00373, Train/loss_unet_all_step=0.373, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]Epoch 80:  64%|██████▍   | 200/313 [02:44<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]Epoch 80:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]Epoch 80:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]Epoch 80:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]Epoch 80:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]Epoch 80: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]Epoch 80: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00304, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.431, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.445, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.17it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.48it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.68it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.44it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.54it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.96it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.107618, 0.108688, 0.097965, 0.090982
Valid average loss UNet                 (all)                : 0.405253

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.134440, 5.109303, 8.265430
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.605141, 6.126672, 6.834601
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.917402, 7.575296, 7.597878
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.364433, 6.955395, 9.324600
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.457074, 7.797504, 8.613614
Valid average loss all      (Triplet)                 : 0.506398

== Recognize ==
Valid average loss Recognize     : 1.154672
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 44.000000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 43.000000 %

== Valid average loss all : 0.510450

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.447553396224976 sec. =
Valid knn accuracy drums     : 66.10000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.185936689376831 sec. =
Valid knn accuracy bass      : 17.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.238152265548706 sec. =
Valid knn accuracy piano     : 17.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.64447832107544 sec. =
Valid knn accuracy guitar    : 56.49999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.093327760696411 sec. =
Valid knn accuracy residuals : 66.5%

Valid knn accuracy average   : 44.800000000000004%

                                                                        [AEpoch 80: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00304, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.170]Epoch 80: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00304, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091247, 0.092715, 0.093242, 0.072696
Train average loss UNet                 (all)                : 0.349899

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000331, 4.883440, 9.150396
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003379, 5.484744, 8.333169
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001436, 5.920824, 8.842014
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001833, 6.164351, 9.608893
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002059, 6.608448, 10.006944
Train average loss all      (Triplet)                 : 0.001854

== Recognize ==
Train average loss Recognize     : 1.166671
Train average accuracy drums     : 50.305004 %
Train average accuracy bass      : 50.910004 %
Train average accuracy piano     : 50.064999 %
Train average accuracy guitar    : 49.775002 %
Train average accuracy residuals : 49.544998 %

== Train average loss all : 0.005353

Epoch 80:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00304, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]          Epoch 81:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00304, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]Epoch 81:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00304, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]Epoch 81:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]Epoch 81:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]Epoch 81:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00712, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=1.100, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]Epoch 81:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00712, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=1.100, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]Epoch 81:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.388, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]  Epoch 81:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.388, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]Epoch 81:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]Epoch 81:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]Epoch 81:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]Epoch 81:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]Epoch 81:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]Epoch 81: 100%|██████████| 313/313 [04:11<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]Epoch 81: 100%|██████████| 313/313 [04:11<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00421, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=1.160, Valid/loss_all_step=0.553, Valid/loss_unet_all_step=0.405, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.405, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.448, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.18it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.54it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.56it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.82it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.65it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.107951, 0.109544, 0.096790, 0.091353
Valid average loss UNet                 (all)                : 0.405638

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113223, 5.108273, 8.193134
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.556898, 6.259748, 6.960070
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.054365, 7.729163, 7.774799
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.211451, 6.842082, 9.270446
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.450406, 7.827899, 8.723125
Valid average loss all      (Triplet)                 : 0.464168

== Recognize ==
Valid average loss Recognize     : 1.068557
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 42.500000 %

== Valid average loss all : 0.468224

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.071518659591675 sec. =
Valid knn accuracy drums     : 65.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.489720821380615 sec. =
Valid knn accuracy bass      : 18.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.828757762908936 sec. =
Valid knn accuracy piano     : 17.599999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.316225290298462 sec. =
Valid knn accuracy guitar    : 50.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.473129749298096 sec. =
Valid knn accuracy residuals : 68.30000000000001%

Valid knn accuracy average   : 44.3%

                                                                        [AEpoch 81: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00421, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=1.160, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00535, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.170]Epoch 81: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00421, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=1.160, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091163, 0.092648, 0.093117, 0.072198
Train average loss UNet                 (all)                : 0.349127

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000476, 4.859783, 8.879299
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003522, 5.627312, 8.529146
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001466, 5.986657, 8.958504
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001305, 6.256970, 9.737910
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000878, 6.670583, 10.195486
Train average loss all      (Triplet)                 : 0.001564

== Recognize ==
Train average loss Recognize     : 1.174059
Train average accuracy drums     : 49.610001 %
Train average accuracy bass      : 50.169998 %
Train average accuracy piano     : 50.089996 %
Train average accuracy guitar    : 49.434998 %
Train average accuracy residuals : 49.939999 %

== Train average loss all : 0.005056

Epoch 81:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00421, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=1.160, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]          Epoch 82:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00421, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=1.160, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]Epoch 82:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00421, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=1.160, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]Epoch 82:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00714, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=1.100, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]Epoch 82:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00714, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=1.100, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]Epoch 82:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]  Epoch 82:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.359, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]Epoch 82:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00377, Train/loss_unet_all_step=0.377, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]Epoch 82:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.00377, Train/loss_unet_all_step=0.377, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]Epoch 82:  64%|██████▍   | 200/313 [02:46<01:33,  1.20it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]Epoch 82:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]Epoch 82:  80%|███████▉  | 250/313 [03:25<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]Epoch 82:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]Epoch 82:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]Epoch 82: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]Epoch 82: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00313, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.399, Valid/loss_triplet_all_step=0.426, Valid/loss_recog_step=0.968, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.17it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.62it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.84it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.17it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.50it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.106994, 0.108428, 0.097711, 0.102628
Valid average loss UNet                 (all)                : 0.415761

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.110624, 5.255520, 8.642688
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.602078, 6.092448, 6.786137
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.147275, 7.888518, 7.955379
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.369488, 6.919397, 8.895504
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.491922, 7.727769, 8.491466
Valid average loss all      (Triplet)                 : 0.552125

== Recognize ==
Valid average loss Recognize     : 1.078836
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.556282

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.713614463806152 sec. =
Valid knn accuracy drums     : 67.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.64945101737976 sec. =
Valid knn accuracy bass      : 17.299999999999997%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.340212106704712 sec. =
Valid knn accuracy piano     : 17.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.246997117996216 sec. =
Valid knn accuracy guitar    : 50.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.706352233886719 sec. =
Valid knn accuracy residuals : 64.3%

Valid knn accuracy average   : 43.46%

                                                                        [AEpoch 82: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00313, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00506, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.170]Epoch 82: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00313, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091054, 0.092600, 0.093113, 0.073629
Train average loss UNet                 (all)                : 0.350396

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000568, 4.909937, 9.168269
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002080, 5.649875, 8.655845
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002249, 6.100747, 9.141909
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001914, 6.205748, 9.598208
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000386, 6.564327, 10.004673
Train average loss all      (Triplet)                 : 0.001455

== Recognize ==
Train average loss Recognize     : 1.177560
Train average accuracy drums     : 50.024998 %
Train average accuracy bass      : 50.340004 %
Train average accuracy piano     : 49.945000 %
Train average accuracy guitar    : 49.579998 %
Train average accuracy residuals : 50.590004 %

== Train average loss all : 0.004959

Epoch 82:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00313, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]          Epoch 83:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00313, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 83:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00313, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 83:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00454, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.00105, Train/loss_recog_step=1.180, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 83:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00454, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.00105, Train/loss_recog_step=1.180, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 83:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]  Epoch 83:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 83:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00382, Train/loss_unet_all_step=0.382, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 83:  64%|██████▍   | 200/313 [02:48<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00382, Train/loss_unet_all_step=0.382, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 83:  64%|██████▍   | 200/313 [02:48<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 83:  80%|███████▉  | 250/313 [03:29<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 83:  80%|███████▉  | 250/313 [03:29<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.0033, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180] Epoch 83:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.0033, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 83:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 83: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 83: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.424, Valid/loss_triplet_all_step=0.722, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.556, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.552, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.22it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.90it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.53it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.81it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.19it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.83it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.107643, 0.109351, 0.097067, 0.089735
Valid average loss UNet                 (all)                : 0.403797

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.112222, 5.301241, 8.613625
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.521951, 6.016096, 6.903246
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.077486, 7.954397, 8.051493
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.368087, 7.008191, 9.056860
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.361873, 7.701652, 8.614433
Valid average loss all      (Triplet)                 : 0.515187

== Recognize ==
Valid average loss Recognize     : 1.063044
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 56.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.519225

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.371847867965698 sec. =
Valid knn accuracy drums     : 68.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.405903339385986 sec. =
Valid knn accuracy bass      : 18.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.081149578094482 sec. =
Valid knn accuracy piano     : 18.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.366148710250854 sec. =
Valid knn accuracy guitar    : 47.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.326390266418457 sec. =
Valid knn accuracy residuals : 66.0%

Valid knn accuracy average   : 43.720000000000006%

                                                                        [AEpoch 83: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.350, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 83: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091029, 0.092341, 0.093007, 0.072382
Train average loss UNet                 (all)                : 0.348759

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000307, 5.009883, 9.491596
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001699, 5.566675, 8.482884
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002123, 6.100428, 9.168900
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001405, 6.232802, 9.636622
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000850, 6.550980, 9.942603
Train average loss all      (Triplet)                 : 0.001245

== Recognize ==
Train average loss Recognize     : 1.186875
Train average accuracy drums     : 50.410004 %
Train average accuracy bass      : 50.139999 %
Train average accuracy piano     : 49.610001 %
Train average accuracy guitar    : 49.549999 %
Train average accuracy residuals : 49.639999 %

== Train average loss all : 0.004733

Epoch 83:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]          Epoch 84:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]Epoch 84:  16%|█▌        | 50/313 [00:45<03:59,  1.10it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]Epoch 84:  16%|█▌        | 50/313 [00:45<03:59,  1.10it/s, v_num=0, Train/loss_all_step=0.0036, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190] Epoch 84:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.0036, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]Epoch 84:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]Epoch 84:  48%|████▊     | 150/313 [02:07<02:18,  1.17it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]Epoch 84:  48%|████▊     | 150/313 [02:07<02:18,  1.17it/s, v_num=0, Train/loss_all_step=0.00385, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]Epoch 84:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00385, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]Epoch 84:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00324, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]Epoch 84:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00324, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]Epoch 84:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.00327, Train/loss_recog_step=1.230, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]Epoch 84:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.00327, Train/loss_recog_step=1.230, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]Epoch 84:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]  Epoch 84: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]Epoch 84: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=1.260, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.398, Valid/loss_triplet_all_step=0.605, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.404, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.437, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.95it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.82it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.91it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.73it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.81it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.106593, 0.107934, 0.097729, 0.098625
Valid average loss UNet                 (all)                : 0.410881

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.102608, 5.336121, 8.588795
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.467823, 6.120193, 7.043604
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.982774, 7.863538, 8.113110
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.329364, 7.199054, 9.503018
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.359109, 7.600584, 8.768423
Valid average loss all      (Triplet)                 : 0.444558

== Recognize ==
Valid average loss Recognize     : 1.174183
Valid average accuracy drums     : 44.000000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.448667

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.43595027923584 sec. =
Valid knn accuracy drums     : 69.39999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.171796798706055 sec. =
Valid knn accuracy bass      : 18.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.485191106796265 sec. =
Valid knn accuracy piano     : 16.400000000000002%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.277655601501465 sec. =
Valid knn accuracy guitar    : 50.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.586271524429321 sec. =
Valid knn accuracy residuals : 65.8%

Valid knn accuracy average   : 44.019999999999996%

                                                                        [AEpoch 84: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=1.260, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00473, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.190]Epoch 84: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=1.260, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090929, 0.092312, 0.092863, 0.072058
Train average loss UNet                 (all)                : 0.348162

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000007, 4.979949, 9.256131
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001972, 5.637249, 8.623958
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001108, 6.190475, 9.325665
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000989, 6.360443, 9.815825
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001906, 6.649884, 10.071421
Train average loss all      (Triplet)                 : 0.001192

== Recognize ==
Train average loss Recognize     : 1.189785
Train average accuracy drums     : 49.919998 %
Train average accuracy bass      : 49.829998 %
Train average accuracy piano     : 49.654999 %
Train average accuracy guitar    : 50.199997 %
Train average accuracy residuals : 49.340000 %

== Train average loss all : 0.004674

Epoch 84:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=1.260, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]          Epoch 85:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=1.260, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]Epoch 85:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=1.260, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]Epoch 85:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]Epoch 85:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]Epoch 85:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]Epoch 85:  48%|████▊     | 150/313 [02:07<02:18,  1.17it/s, v_num=0, Train/loss_all_step=0.00353, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]Epoch 85:  48%|████▊     | 150/313 [02:07<02:18,  1.17it/s, v_num=0, Train/loss_all_step=0.00801, Train/loss_unet_all_step=0.386, Train/loss_triplet_all_step=0.00415, Train/loss_recog_step=1.130, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]Epoch 85:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.00801, Train/loss_unet_all_step=0.386, Train/loss_triplet_all_step=0.00415, Train/loss_recog_step=1.130, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]Epoch 85:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.00335, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]  Epoch 85:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00335, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]Epoch 85:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]Epoch 85:  96%|█████████▌| 300/313 [04:08<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]Epoch 85:  96%|█████████▌| 300/313 [04:08<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190] Epoch 85: 100%|██████████| 313/313 [04:15<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]Epoch 85: 100%|██████████| 313/313 [04:15<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.404, Valid/loss_triplet_all_step=0.321, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.440, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.18it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.96it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.62it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.49it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.03it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108097, 0.110343, 0.098467, 0.094257
Valid average loss UNet                 (all)                : 0.411165

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.084930, 5.268510, 8.654789
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.499360, 6.069640, 7.023513
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.102243, 7.713222, 7.817912
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.334453, 7.410362, 9.540294
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.335235, 7.669645, 8.870818
Valid average loss all      (Triplet)                 : 0.470874

== Recognize ==
Valid average loss Recognize     : 1.136024
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.474985

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.813683986663818 sec. =
Valid knn accuracy drums     : 71.89999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.876527070999146 sec. =
Valid knn accuracy bass      : 16.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.77860426902771 sec. =
Valid knn accuracy piano     : 16.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.475672721862793 sec. =
Valid knn accuracy guitar    : 55.00000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.642794609069824 sec. =
Valid knn accuracy residuals : 60.0%

Valid knn accuracy average   : 43.89999999999999%

                                                                        [AEpoch 85: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.190]Epoch 85: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.091071, 0.092509, 0.093095, 0.072423
Train average loss UNet                 (all)                : 0.349098

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000221, 5.016363, 9.208007
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003778, 5.699606, 8.609652
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001726, 6.267419, 9.310452
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003153, 6.611020, 10.227119
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001104, 6.746170, 10.194736
Train average loss all      (Triplet)                 : 0.002012

== Recognize ==
Train average loss Recognize     : 1.187441
Train average accuracy drums     : 49.950001 %
Train average accuracy bass      : 50.094997 %
Train average accuracy piano     : 50.019997 %
Train average accuracy guitar    : 50.410004 %
Train average accuracy residuals : 49.750000 %

== Train average loss all : 0.005503

Epoch 85:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190]          Epoch 86:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190]Epoch 86:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190]Epoch 86:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.00932, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00583, Train/loss_recog_step=1.140, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190]Epoch 86:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00932, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00583, Train/loss_recog_step=1.140, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190]Epoch 86:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.00402, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000489, Train/loss_recog_step=1.170, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190]Epoch 86:  48%|████▊     | 150/313 [02:04<02:15,  1.21it/s, v_num=0, Train/loss_all_step=0.00402, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.000489, Train/loss_recog_step=1.170, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190]Epoch 86:  48%|████▊     | 150/313 [02:04<02:15,  1.21it/s, v_num=0, Train/loss_all_step=0.00385, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190]   Epoch 86:  64%|██████▍   | 200/313 [02:44<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00385, Train/loss_unet_all_step=0.385, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190]Epoch 86:  64%|██████▍   | 200/313 [02:44<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00911, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.00578, Train/loss_recog_step=1.120, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190]Epoch 86:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00911, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.00578, Train/loss_recog_step=1.120, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190]Epoch 86:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.0084, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.00495, Train/loss_recog_step=1.190, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190] Epoch 86:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.0084, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.00495, Train/loss_recog_step=1.190, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190]Epoch 86:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190] Epoch 86: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190]Epoch 86: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.475, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.21it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.53it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.88it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.55it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.51it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.106469, 0.108248, 0.097826, 0.103054
Valid average loss UNet                 (all)                : 0.415597

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.115141, 5.707011, 9.181173
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.560989, 6.173000, 6.987909
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.843327, 7.608428, 7.997865
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.260960, 7.179642, 9.166807
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.350133, 7.254066, 8.547097
Valid average loss all      (Triplet)                 : 0.401057

== Recognize ==
Valid average loss Recognize     : 1.076158
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.405213

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.610371828079224 sec. =
Valid knn accuracy drums     : 67.10000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.614705085754395 sec. =
Valid knn accuracy bass      : 15.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.186410903930664 sec. =
Valid knn accuracy piano     : 15.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.669185638427734 sec. =
Valid knn accuracy guitar    : 50.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.318759679794312 sec. =
Valid knn accuracy residuals : 64.2%

Valid knn accuracy average   : 42.7%

                                                                        [AEpoch 86: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0055, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.190]Epoch 86: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090979, 0.092383, 0.092854, 0.072965
Train average loss UNet                 (all)                : 0.349182

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000847, 4.967429, 9.169174
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003061, 5.652698, 8.570941
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002442, 6.065116, 8.973583
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002159, 6.505809, 10.123938
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000772, 6.658444, 10.082342
Train average loss all      (Triplet)                 : 0.001806

== Recognize ==
Train average loss Recognize     : 1.185283
Train average accuracy drums     : 49.884998 %
Train average accuracy bass      : 50.075001 %
Train average accuracy piano     : 50.125004 %
Train average accuracy guitar    : 49.564999 %
Train average accuracy residuals : 50.449997 %

== Train average loss all : 0.005298

Epoch 86:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]          Epoch 87:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 87:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 87:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190] Epoch 87:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 87:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 87:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 87:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00387, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 87:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00387, Train/loss_unet_all_step=0.387, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 87:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 87:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 87:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00335, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 87:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00335, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 87:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 87: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 87: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.405, Valid/loss_unet_all_epoch=0.416, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  2.00it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.33it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.75it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.79it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.56it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.107351, 0.107536, 0.096759, 0.096174
Valid average loss UNet                 (all)                : 0.407820

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.123406, 5.798549, 9.345171
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.473005, 6.369542, 7.258340
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.842903, 7.730383, 8.125486
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.256455, 7.250960, 9.529142
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.447443, 7.530526, 8.565198
Valid average loss all      (Triplet)                 : 0.409040

== Recognize ==
Valid average loss Recognize     : 1.165661
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 43.000000 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 44.000000 %

== Valid average loss all : 0.413118

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.326092958450317 sec. =
Valid knn accuracy drums     : 67.30000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.761361837387085 sec. =
Valid knn accuracy bass      : 18.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.486199617385864 sec. =
Valid knn accuracy piano     : 16.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.570706605911255 sec. =
Valid knn accuracy guitar    : 51.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.355010986328125 sec. =
Valid knn accuracy residuals : 62.2%

Valid knn accuracy average   : 43.32%

                                                                        [AEpoch 87: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 87: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090844, 0.092210, 0.092817, 0.072979
Train average loss UNet                 (all)                : 0.348850

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000210, 5.120214, 9.831742
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003011, 5.680945, 8.651832
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000775, 6.110580, 9.153345
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001573, 6.479712, 10.159216
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000834, 6.748533, 10.274254
Train average loss all      (Triplet)                 : 0.001313

== Recognize ==
Train average loss Recognize     : 1.189110
Train average accuracy drums     : 49.880001 %
Train average accuracy bass      : 49.509998 %
Train average accuracy piano     : 50.160004 %
Train average accuracy guitar    : 50.384998 %
Train average accuracy residuals : 50.260002 %

== Train average loss all : 0.004802

Epoch 87:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]          Epoch 88:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]Epoch 88:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]Epoch 88:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=1.230, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]Epoch 88:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=1.230, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]Epoch 88:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.0036, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]Epoch 88:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0036, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]Epoch 88:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00407, Train/loss_unet_all_step=0.407, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]Epoch 88:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00407, Train/loss_unet_all_step=0.407, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]Epoch 88:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]Epoch 88:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]Epoch 88:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.00345, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]Epoch 88:  96%|█████████▌| 300/313 [04:09<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.00345, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]Epoch 88:  96%|█████████▌| 300/313 [04:09<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.00539, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.00195, Train/loss_recog_step=1.200, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]Epoch 88: 100%|██████████| 313/313 [04:17<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.00539, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.00195, Train/loss_recog_step=1.200, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]Epoch 88: 100%|██████████| 313/313 [04:17<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.141, Valid/loss_unet_all_step=0.420, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.408, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.17it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.50it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.82it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.99it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.110207, 0.110406, 0.099058, 0.087559
Valid average loss UNet                 (all)                : 0.407229

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113101, 5.844085, 9.346261
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.484665, 6.161182, 7.024912
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.890020, 7.805207, 8.177286
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.152886, 7.458130, 9.803016
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.420052, 7.611300, 8.818821
Valid average loss all      (Triplet)                 : 0.415882

== Recognize ==
Valid average loss Recognize     : 1.187777
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.419954

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.912980079650879 sec. =
Valid knn accuracy drums     : 65.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.76247787475586 sec. =
Valid knn accuracy bass      : 15.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.74267053604126 sec. =
Valid knn accuracy piano     : 18.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.26688027381897 sec. =
Valid knn accuracy guitar    : 49.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.640108823776245 sec. =
Valid knn accuracy residuals : 65.4%

Valid knn accuracy average   : 42.74%

                                                                        [AEpoch 88: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0048, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.190]Epoch 88: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090794, 0.092275, 0.092728, 0.072544
Train average loss UNet                 (all)                : 0.348341

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000454, 5.192460, 9.839690
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003197, 5.864073, 8.942263
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001672, 6.256488, 9.357475
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001261, 6.611736, 10.392141
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001541, 6.850600, 10.387225
Train average loss all      (Triplet)                 : 0.001634

== Recognize ==
Train average loss Recognize     : 1.192951
Train average accuracy drums     : 50.594997 %
Train average accuracy bass      : 50.139999 %
Train average accuracy piano     : 49.880001 %
Train average accuracy guitar    : 50.155003 %
Train average accuracy residuals : 49.584999 %

== Train average loss all : 0.005118

Epoch 88:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]          Epoch 89:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]Epoch 89:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]Epoch 89:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]Epoch 89:  32%|███▏      | 100/313 [01:26<03:04,  1.16it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]Epoch 89:  32%|███▏      | 100/313 [01:26<03:04,  1.16it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.00666, Train/loss_recog_step=1.170, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]Epoch 89:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.00666, Train/loss_recog_step=1.170, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]Epoch 89:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00377, Train/loss_unet_all_step=0.377, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190] Epoch 89:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00377, Train/loss_unet_all_step=0.377, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]Epoch 89:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00323, Train/loss_unet_all_step=0.323, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]Epoch 89:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00323, Train/loss_unet_all_step=0.323, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]Epoch 89:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]Epoch 89:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]Epoch 89:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]Epoch 89: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]Epoch 89: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00318, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.396, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.407, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.19it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.76it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.80it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.91it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.31it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108072, 0.108821, 0.096993, 0.097697
Valid average loss UNet                 (all)                : 0.411583

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101674, 5.898542, 9.028563
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.525386, 6.186993, 7.031948
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.837401, 8.028986, 8.405062
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.225849, 7.523561, 10.003738
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.366785, 7.678598, 8.809502
Valid average loss all      (Triplet)                 : 0.384801

== Recognize ==
Valid average loss Recognize     : 1.091446
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.388917

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.747912645339966 sec. =
Valid knn accuracy drums     : 66.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.654311180114746 sec. =
Valid knn accuracy bass      : 15.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.249778747558594 sec. =
Valid knn accuracy piano     : 18.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.511650562286377 sec. =
Valid knn accuracy guitar    : 50.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.03780722618103 sec. =
Valid knn accuracy residuals : 64.9%

Valid knn accuracy average   : 43.00000000000001%

                                                                        [AEpoch 89: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00318, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.00512, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.190]Epoch 89: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00318, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090745, 0.092226, 0.092793, 0.072903
Train average loss UNet                 (all)                : 0.348666

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000189, 5.223482, 9.857426
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001157, 5.825678, 8.901465
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002090, 6.359001, 9.578380
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003211, 6.716449, 10.415268
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001096, 6.928401, 10.512291
Train average loss all      (Triplet)                 : 0.001513

== Recognize ==
Train average loss Recognize     : 1.198228
Train average accuracy drums     : 50.019997 %
Train average accuracy bass      : 49.494999 %
Train average accuracy piano     : 49.564999 %
Train average accuracy guitar    : 50.180000 %
Train average accuracy residuals : 50.645000 %

== Train average loss all : 0.004999

Epoch 89:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00318, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]          Epoch 90:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00318, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 90:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00318, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 90:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00498, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.00138, Train/loss_recog_step=1.120, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 90:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00498, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.00138, Train/loss_recog_step=1.120, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 90:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]  Epoch 90:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 90:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 90:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 90:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.0151, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=1.220, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 90:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.0151, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=1.220, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 90:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 90:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 90:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 90: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 90: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.413, Valid/loss_triplet_all_step=0.0965, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.412, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.430, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.62it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.97it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.62it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.57it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.107088, 0.110102, 0.097176, 0.095413
Valid average loss UNet                 (all)                : 0.409780

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.093988, 5.865194, 9.036782
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.532434, 6.404829, 7.302674
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.997918, 8.383550, 8.704916
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.264025, 7.630435, 10.045125
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.350230, 7.789113, 8.902743
Valid average loss all      (Triplet)                 : 0.441742

== Recognize ==
Valid average loss Recognize     : 1.143133
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.445840

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.278101682662964 sec. =
Valid knn accuracy drums     : 64.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.287647485733032 sec. =
Valid knn accuracy bass      : 17.599999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.53298044204712 sec. =
Valid knn accuracy piano     : 17.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.35247015953064 sec. =
Valid knn accuracy guitar    : 51.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.506794691085815 sec. =
Valid knn accuracy residuals : 66.3%

Valid knn accuracy average   : 43.44%

                                                                        [AEpoch 90: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.005, Train/loss_unet_all_epoch=0.349, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200] Epoch 90: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090735, 0.092188, 0.092704, 0.072760
Train average loss UNet                 (all)                : 0.348387

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000281, 5.262150, 9.730124
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000998, 5.858978, 8.984206
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001905, 6.437037, 9.709068
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003538, 6.860649, 10.553867
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000750, 6.975400, 10.608306
Train average loss all      (Triplet)                 : 0.001502

== Recognize ==
Train average loss Recognize     : 1.206034
Train average accuracy drums     : 49.399998 %
Train average accuracy bass      : 50.094997 %
Train average accuracy piano     : 50.134998 %
Train average accuracy guitar    : 50.629997 %
Train average accuracy residuals : 49.494999 %

== Train average loss all : 0.004986

Epoch 90:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]          Epoch 91:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]Epoch 91:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]Epoch 91:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]Epoch 91:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]Epoch 91:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]Epoch 91:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]Epoch 91:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00383, Train/loss_unet_all_step=0.383, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]Epoch 91:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00383, Train/loss_unet_all_step=0.383, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]Epoch 91:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]Epoch 91:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]Epoch 91:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]Epoch 91:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]Epoch 91:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]Epoch 91: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]Epoch 91: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.394, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.434, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.21it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.80it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.71it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.62it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.42it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.110340, 0.110458, 0.098412, 0.093793
Valid average loss UNet                 (all)                : 0.413002

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.097537, 6.022838, 9.789596
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.568684, 6.339316, 7.223067
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.933492, 8.315691, 8.594730
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.365024, 7.788057, 9.968098
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.517722, 7.907119, 8.709656
Valid average loss all      (Triplet)                 : 0.469246

== Recognize ==
Valid average loss Recognize     : 1.110489
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.473376

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.749953508377075 sec. =
Valid knn accuracy drums     : 64.60000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.85352873802185 sec. =
Valid knn accuracy bass      : 17.299999999999997%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.93787407875061 sec. =
Valid knn accuracy piano     : 18.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.439648628234863 sec. =
Valid knn accuracy guitar    : 47.199999999999996%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.746623277664185 sec. =
Valid knn accuracy residuals : 65.9%

Valid knn accuracy average   : 42.66%

                                                                        [AEpoch 91: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.210]Epoch 91: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090643, 0.092127, 0.092664, 0.072374
Train average loss UNet                 (all)                : 0.347808

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000772, 5.304664, 9.736962
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000847, 5.876376, 9.037348
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001300, 6.457893, 9.707146
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001709, 6.807282, 10.606691
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000273, 6.927823, 10.534038
Train average loss all      (Triplet)                 : 0.000971

== Recognize ==
Train average loss Recognize     : 1.211685
Train average accuracy drums     : 49.775002 %
Train average accuracy bass      : 49.349998 %
Train average accuracy piano     : 49.485001 %
Train average accuracy guitar    : 49.329998 %
Train average accuracy residuals : 50.344997 %

== Train average loss all : 0.004449

Epoch 91:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]          Epoch 92:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]Epoch 92:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]Epoch 92:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.00927, Train/loss_recog_step=1.180, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]Epoch 92:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.00927, Train/loss_recog_step=1.180, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]Epoch 92:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210] Epoch 92:  48%|████▊     | 150/313 [02:08<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]Epoch 92:  48%|████▊     | 150/313 [02:08<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.378, Train/loss_triplet_all_step=0.00232, Train/loss_recog_step=1.260, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]Epoch 92:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.378, Train/loss_triplet_all_step=0.00232, Train/loss_recog_step=1.260, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]Epoch 92:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.00323, Train/loss_unet_all_step=0.323, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210] Epoch 92:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00323, Train/loss_unet_all_step=0.323, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]Epoch 92:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.0081, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.00471, Train/loss_recog_step=1.200, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]Epoch 92:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.0081, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.00471, Train/loss_recog_step=1.200, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]Epoch 92:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00973, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.00632, Train/loss_recog_step=1.240, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]Epoch 92: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00973, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.00632, Train/loss_recog_step=1.240, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]Epoch 92: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.427, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.427, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.19it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.49it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.49it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.81it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.75it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.89it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.110560, 0.108724, 0.098317, 0.095612
Valid average loss UNet                 (all)                : 0.413213

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.128294, 5.846822, 9.237557
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.653505, 6.385030, 7.025518
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.970185, 8.326332, 8.692057
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.282390, 7.637388, 9.910343
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.485201, 8.142270, 9.103729
Valid average loss all      (Triplet)                 : 0.493563

== Recognize ==
Valid average loss Recognize     : 1.131212
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.497696

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.943291664123535 sec. =
Valid knn accuracy drums     : 65.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.817607402801514 sec. =
Valid knn accuracy bass      : 16.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.155420780181885 sec. =
Valid knn accuracy piano     : 18.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.412075757980347 sec. =
Valid knn accuracy guitar    : 48.699999999999996%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.74691891670227 sec. =
Valid knn accuracy residuals : 68.60000000000001%

Valid knn accuracy average   : 43.54%

                                                                        [AEpoch 92: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00445, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.000971, Train/loss_recog_epoch=1.210]Epoch 92: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090682, 0.092213, 0.092688, 0.072204
Train average loss UNet                 (all)                : 0.347786

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001064, 5.447982, 10.077497
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001914, 5.886206, 8.908060
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001640, 6.625298, 9.959245
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003634, 6.962858, 10.816926
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000859, 6.953630, 10.520008
Train average loss all      (Triplet)                 : 0.001730

== Recognize ==
Train average loss Recognize     : 1.204879
Train average accuracy drums     : 49.529999 %
Train average accuracy bass      : 50.274998 %
Train average accuracy piano     : 50.674999 %
Train average accuracy guitar    : 49.935001 %
Train average accuracy residuals : 49.755001 %

== Train average loss all : 0.005208

Epoch 92:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]          Epoch 93:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]Epoch 93:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]Epoch 93:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]Epoch 93:  32%|███▏      | 100/313 [01:27<03:06,  1.15it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.368, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]Epoch 93:  32%|███▏      | 100/313 [01:27<03:06,  1.15it/s, v_num=0, Train/loss_all_step=0.00499, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.00141, Train/loss_recog_step=1.120, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]Epoch 93:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00499, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.00141, Train/loss_recog_step=1.120, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]Epoch 93:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.00377, Train/loss_unet_all_step=0.377, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]  Epoch 93:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00377, Train/loss_unet_all_step=0.377, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]Epoch 93:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00319, Train/loss_unet_all_step=0.319, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]Epoch 93:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00319, Train/loss_unet_all_step=0.319, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]Epoch 93:  80%|███████▉  | 250/313 [03:26<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]Epoch 93:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]Epoch 93:  96%|█████████▌| 300/313 [04:05<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00811, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.00468, Train/loss_recog_step=1.210, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]Epoch 93: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00811, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.00468, Train/loss_recog_step=1.210, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]Epoch 93: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.421, Valid/loss_triplet_all_step=0.415, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.413, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.67it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.58it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.16it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.66it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.108381, 0.107911, 0.097183, 0.096661
Valid average loss UNet                 (all)                : 0.410136

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.129768, 5.916166, 9.877783
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.661289, 6.467927, 7.255214
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.826161, 8.199789, 8.623034
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.253618, 7.415069, 9.859264
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.541966, 7.894887, 8.736185
Valid average loss all      (Triplet)                 : 0.460527

== Recognize ==
Valid average loss Recognize     : 1.121192
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.464628

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.095417737960815 sec. =
Valid knn accuracy drums     : 67.30000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.71967077255249 sec. =
Valid knn accuracy bass      : 17.599999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.382901668548584 sec. =
Valid knn accuracy piano     : 16.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.488083124160767 sec. =
Valid knn accuracy guitar    : 44.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.371855020523071 sec. =
Valid knn accuracy residuals : 64.2%

Valid knn accuracy average   : 42.12%

                                                                        [AEpoch 93: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00521, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.200]Epoch 93: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090644, 0.092048, 0.092545, 0.072362
Train average loss UNet                 (all)                : 0.347599

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001040, 5.499806, 10.296235
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001809, 5.831831, 8.800923
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000948, 6.479723, 9.725948
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002665, 6.827905, 10.672745
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000864, 6.963264, 10.561204
Train average loss all      (Triplet)                 : 0.001485

== Recognize ==
Train average loss Recognize     : 1.201637
Train average accuracy drums     : 50.379997 %
Train average accuracy bass      : 50.355000 %
Train average accuracy piano     : 49.924999 %
Train average accuracy guitar    : 50.225002 %
Train average accuracy residuals : 49.544998 %

== Train average loss all : 0.004961

Epoch 93:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]          Epoch 94:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]Epoch 94:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]Epoch 94:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.00715, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.00366, Train/loss_recog_step=1.250, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]Epoch 94:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00715, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.00366, Train/loss_recog_step=1.250, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]Epoch 94:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.00361, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]  Epoch 94:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00361, Train/loss_unet_all_step=0.361, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]Epoch 94:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00377, Train/loss_unet_all_step=0.377, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]Epoch 94:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.00377, Train/loss_unet_all_step=0.377, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]Epoch 94:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.00324, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]Epoch 94:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00324, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]Epoch 94:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.00747, Train/loss_recog_step=1.170, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]Epoch 94:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.00747, Train/loss_recog_step=1.170, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]Epoch 94:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]  Epoch 94: 100%|██████████| 313/313 [04:15<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]Epoch 94: 100%|██████████| 313/313 [04:15<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.407, Valid/loss_triplet_all_step=0.400, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.410, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.421, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.22it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.67it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.73it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.53it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.96it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.113968, 0.112148, 0.099056, 0.083792
Valid average loss UNet                 (all)                : 0.408964

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.133907, 5.802871, 9.350301
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.749246, 6.560622, 7.301785
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.917123, 8.138408, 8.417229
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.203855, 7.523501, 9.825207
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.496703, 8.154722, 9.074619
Valid average loss all      (Triplet)                 : 0.489525

== Recognize ==
Valid average loss Recognize     : 1.143675
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.493615

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.696978330612183 sec. =
Valid knn accuracy drums     : 64.60000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.340261220932007 sec. =
Valid knn accuracy bass      : 16.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.827818870544434 sec. =
Valid knn accuracy piano     : 17.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.79795789718628 sec. =
Valid knn accuracy guitar    : 46.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.605990886688232 sec. =
Valid knn accuracy residuals : 63.6%

Valid knn accuracy average   : 41.74%

                                                                        [AEpoch 94: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00496, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.200]Epoch 94: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090518, 0.091947, 0.092488, 0.072415
Train average loss UNet                 (all)                : 0.347368

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000834, 5.459229, 10.235486
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001373, 5.936008, 9.032593
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001808, 6.462326, 9.654302
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001257, 6.821703, 10.619639
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000660, 6.955492, 10.587083
Train average loss all      (Triplet)                 : 0.001215

== Recognize ==
Train average loss Recognize     : 1.198282
Train average accuracy drums     : 50.524998 %
Train average accuracy bass      : 50.484997 %
Train average accuracy piano     : 50.305004 %
Train average accuracy guitar    : 49.945000 %
Train average accuracy residuals : 49.750000 %

== Train average loss all : 0.004688

Epoch 94:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]          Epoch 95:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]Epoch 95:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]Epoch 95:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.0056, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.00214, Train/loss_recog_step=1.200, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]Epoch 95:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.0056, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.00214, Train/loss_recog_step=1.200, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]Epoch 95:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00343, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200] Epoch 95:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00343, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]Epoch 95:  48%|████▊     | 150/313 [02:06<02:17,  1.19it/s, v_num=0, Train/loss_all_step=0.00393, Train/loss_unet_all_step=0.393, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]Epoch 95:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00393, Train/loss_unet_all_step=0.393, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]Epoch 95:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00893, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.00567, Train/loss_recog_step=1.230, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]Epoch 95:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00893, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.00567, Train/loss_recog_step=1.230, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]Epoch 95:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]  Epoch 95:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]Epoch 95:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]Epoch 95: 100%|██████████| 313/313 [04:11<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]Epoch 95: 100%|██████████| 313/313 [04:11<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.00313, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.397, Valid/loss_triplet_all_step=0.490, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.409, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.417, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.01it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.58it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:02<00:00,  5.45it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.68it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.78it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.92it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109793, 0.110111, 0.098321, 0.088031
Valid average loss UNet                 (all)                : 0.406256

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.097786, 5.857732, 9.776378
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.642281, 6.559973, 7.205545
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.006089, 8.273942, 8.450745
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.284260, 7.568419, 9.808992
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.342593, 7.986634, 9.024848
Valid average loss all      (Triplet)                 : 0.492245

== Recognize ==
Valid average loss Recognize     : 1.078439
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.496308

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.645682096481323 sec. =
Valid knn accuracy drums     : 66.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.418748378753662 sec. =
Valid knn accuracy bass      : 17.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.558175086975098 sec. =
Valid knn accuracy piano     : 16.900000000000002%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.391536951065063 sec. =
Valid knn accuracy guitar    : 46.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.427211046218872 sec. =
Valid knn accuracy residuals : 64.4%

Valid knn accuracy average   : 42.24%

                                                                        [AEpoch 95: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00313, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00469, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.200]Epoch 95: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00313, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090391, 0.091834, 0.092353, 0.072741
Train average loss UNet                 (all)                : 0.347320

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000842, 5.404996, 10.047970
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001783, 5.961607, 9.053295
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001283, 6.386756, 9.535488
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001105, 6.726163, 10.518250
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001659, 6.974544, 10.612218
Train average loss all      (Triplet)                 : 0.001384

== Recognize ==
Train average loss Recognize     : 1.193195
Train average accuracy drums     : 49.419998 %
Train average accuracy bass      : 50.005001 %
Train average accuracy piano     : 50.555004 %
Train average accuracy guitar    : 50.580002 %
Train average accuracy residuals : 50.305004 %

== Train average loss all : 0.004857

Epoch 95:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00313, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]          Epoch 96:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00313, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]Epoch 96:  16%|█▌        | 50/313 [00:44<03:55,  1.12it/s, v_num=0, Train/loss_all_step=0.00313, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]Epoch 96:  16%|█▌        | 50/313 [00:44<03:55,  1.12it/s, v_num=0, Train/loss_all_step=0.00356, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]Epoch 96:  32%|███▏      | 100/313 [01:24<03:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00356, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]Epoch 96:  32%|███▏      | 100/313 [01:24<03:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]Epoch 96:  48%|████▊     | 150/313 [02:05<02:16,  1.20it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]Epoch 96:  48%|████▊     | 150/313 [02:05<02:16,  1.20it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.383, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=1.210, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]Epoch 96:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.383, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=1.210, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]Epoch 96:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]Epoch 96:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]Epoch 96:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.00727, Train/loss_recog_step=1.240, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]Epoch 96:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.00727, Train/loss_recog_step=1.240, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]Epoch 96:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190] Epoch 96: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]Epoch 96: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.418, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.496, Valid/loss_unet_all_epoch=0.406, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.422, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.93it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.31it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.72it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.65it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.99it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.31it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109375, 0.108852, 0.097467, 0.095025
Valid average loss UNet                 (all)                : 0.410718

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.108887, 6.084550, 9.608018
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.610811, 6.571795, 7.402490
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.013955, 8.767397, 9.013769
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.296469, 7.813878, 10.046920
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.365784, 8.084253, 9.024404
Valid average loss all      (Triplet)                 : 0.512472

== Recognize ==
Valid average loss Recognize     : 1.178069
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 58.000000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.516579

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.847035646438599 sec. =
Valid knn accuracy drums     : 64.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.703675508499146 sec. =
Valid knn accuracy bass      : 14.000000000000002%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.490043640136719 sec. =
Valid knn accuracy piano     : 16.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.562108278274536 sec. =
Valid knn accuracy guitar    : 43.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.117160558700562 sec. =
Valid knn accuracy residuals : 66.8%

Valid knn accuracy average   : 41.04%

                                                                        [AEpoch 96: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.190]Epoch 96: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090320, 0.091708, 0.092285, 0.072349
Train average loss UNet                 (all)                : 0.346661

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000159, 5.427926, 10.070773
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001092, 6.031875, 9.263991
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001775, 6.511312, 9.725185
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000679, 6.756153, 10.549010
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001516, 7.062043, 10.799602
Train average loss all      (Triplet)                 : 0.001032

== Recognize ==
Train average loss Recognize     : 1.207907
Train average accuracy drums     : 49.759998 %
Train average accuracy bass      : 49.630001 %
Train average accuracy piano     : 50.019997 %
Train average accuracy guitar    : 50.105000 %
Train average accuracy residuals : 50.340004 %

== Train average loss all : 0.004498

Epoch 96:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]          Epoch 97:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]Epoch 97:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]Epoch 97:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210] Epoch 97:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]Epoch 97:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00806, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.00463, Train/loss_recog_step=1.330, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]Epoch 97:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00806, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.00463, Train/loss_recog_step=1.330, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]Epoch 97:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.00269, Train/loss_recog_step=1.080, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]Epoch 97:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.399, Train/loss_triplet_all_step=0.00269, Train/loss_recog_step=1.080, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]Epoch 97:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=1.260, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]Epoch 97:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=1.260, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]Epoch 97:  80%|███████▉  | 250/313 [03:27<00:52,  1.21it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]  Epoch 97:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]Epoch 97:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]Epoch 97: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00349, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]Epoch 97: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.578, Valid/loss_unet_all_step=0.411, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.410, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.79it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.48it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.60it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.56it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.41it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109269, 0.109588, 0.097455, 0.098645
Valid average loss UNet                 (all)                : 0.414957

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.122140, 5.926419, 9.763841
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.568123, 6.578356, 7.346390
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.247927, 8.756893, 8.748298
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.322798, 7.699851, 9.954767
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.397740, 8.010029, 9.115979
Valid average loss all      (Triplet)                 : 0.590182

== Recognize ==
Valid average loss Recognize     : 1.195816
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.594332

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.693285465240479 sec. =
Valid knn accuracy drums     : 66.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.870701313018799 sec. =
Valid knn accuracy bass      : 16.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.322711706161499 sec. =
Valid knn accuracy piano     : 18.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.652096033096313 sec. =
Valid knn accuracy guitar    : 47.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.367488384246826 sec. =
Valid knn accuracy residuals : 66.0%

Valid knn accuracy average   : 43.10000000000001%

                                                                        [AEpoch 97: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0045, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.210]Epoch 97: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090526, 0.091966, 0.092559, 0.072851
Train average loss UNet                 (all)                : 0.347903

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000693, 5.470428, 10.165512
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003453, 6.160861, 9.318651
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001747, 6.728353, 10.043466
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001859, 6.930480, 10.806107
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001019, 7.140736, 10.893013
Train average loss all      (Triplet)                 : 0.001801

== Recognize ==
Train average loss Recognize     : 1.210638
Train average accuracy drums     : 49.625000 %
Train average accuracy bass      : 50.685001 %
Train average accuracy piano     : 49.584999 %
Train average accuracy guitar    : 50.440002 %
Train average accuracy residuals : 50.735004 %

== Train average loss all : 0.005280

Epoch 97:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]          Epoch 98:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 98:  16%|█▌        | 50/313 [00:45<03:57,  1.11it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 98:  16%|█▌        | 50/313 [00:45<03:57,  1.11it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 98:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 98:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.00239, Train/loss_recog_step=1.310, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 98:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.00239, Train/loss_recog_step=1.310, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 98:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00383, Train/loss_unet_all_step=0.383, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]  Epoch 98:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00383, Train/loss_unet_all_step=0.383, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 98:  64%|██████▍   | 200/313 [02:46<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 98:  80%|███████▉  | 250/313 [03:26<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00325, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 98:  80%|███████▉  | 250/313 [03:26<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.0185, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.0152, Train/loss_recog_step=1.350, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 98:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.0185, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.0152, Train/loss_recog_step=1.350, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 98:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00343, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 98: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00343, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 98: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.419, Valid/loss_triplet_all_step=0.769, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.415, Valid/loss_triplet_all_epoch=0.590, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.431, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.96it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.97it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.75it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.94it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.88it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.107002, 0.109716, 0.096516, 0.086988
Valid average loss UNet                 (all)                : 0.400222

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.118042, 5.957963, 9.419477
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.562630, 6.637503, 7.295513
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.363229, 8.858339, 8.758290
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.357876, 7.715261, 9.879726
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.348824, 7.978182, 9.149383
Valid average loss all      (Triplet)                 : 0.602529

== Recognize ==
Valid average loss Recognize     : 1.200336
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 56.000000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.606532

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.716374397277832 sec. =
Valid knn accuracy drums     : 63.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.037970304489136 sec. =
Valid knn accuracy bass      : 15.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.579780101776123 sec. =
Valid knn accuracy piano     : 17.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.103281021118164 sec. =
Valid knn accuracy guitar    : 47.699999999999996%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.385709047317505 sec. =
Valid knn accuracy residuals : 64.60000000000001%

Valid knn accuracy average   : 41.760000000000005%

                                                                        [AEpoch 98: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00528, Train/loss_unet_all_epoch=0.348, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 98: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090255, 0.091684, 0.092278, 0.072880
Train average loss UNet                 (all)                : 0.347097

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001396, 5.538902, 10.193412
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002200, 6.168283, 9.428771
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000883, 6.710974, 10.055880
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001484, 6.926704, 10.879871
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000444, 7.198761, 11.010544
Train average loss all      (Triplet)                 : 0.001341

== Recognize ==
Train average loss Recognize     : 1.200876
Train average accuracy drums     : 50.535000 %
Train average accuracy bass      : 50.180000 %
Train average accuracy piano     : 50.465000 %
Train average accuracy guitar    : 50.835003 %
Train average accuracy residuals : 49.924999 %

== Train average loss all : 0.004811

Epoch 98:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200]          Epoch 99:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200]Epoch 99:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200]Epoch 99:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200]Epoch 99:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200]Epoch 99:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200] Epoch 99:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200]Epoch 99:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200]Epoch 99:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.371, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200]Epoch 99:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.00689, Train/loss_recog_step=1.300, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200]Epoch 99:  80%|███████▉  | 250/313 [03:27<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.00689, Train/loss_recog_step=1.300, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200]Epoch 99:  80%|███████▉  | 250/313 [03:27<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200] Epoch 99:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200]Epoch 99:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200] Epoch 99: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200]Epoch 99: 100%|██████████| 313/313 [04:13<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.795, Valid/loss_unet_all_step=0.378, Valid/loss_triplet_all_step=0.792, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.607, Valid/loss_unet_all_epoch=0.400, Valid/loss_triplet_all_epoch=0.603, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.418, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.21it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.94it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.97it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.70it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.72it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.93it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.107638, 0.108321, 0.096750, 0.098403
Valid average loss UNet                 (all)                : 0.411112

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.116047, 6.068211, 9.822718
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.643218, 6.808493, 7.441444
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.115788, 8.771049, 8.868438
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.331575, 7.736962, 9.902445
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.337450, 7.917758, 9.203994
Valid average loss all      (Triplet)                 : 0.550980

== Recognize ==
Valid average loss Recognize     : 1.138449
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.555091

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.278354167938232 sec. =
Valid knn accuracy drums     : 62.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.176355838775635 sec. =
Valid knn accuracy bass      : 20.7%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.406299591064453 sec. =
Valid knn accuracy piano     : 16.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.21938443183899 sec. =
Valid knn accuracy guitar    : 45.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.555986881256104 sec. =
Valid knn accuracy residuals : 62.3%

Valid knn accuracy average   : 41.419999999999995%

                                                                        [AEpoch 99: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.200]Epoch 99: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090279, 0.091576, 0.092161, 0.072271
Train average loss UNet                 (all)                : 0.346287

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000874, 5.621789, 10.556777
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001705, 6.134222, 9.363827
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001229, 6.733752, 10.038953
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001284, 6.894140, 10.797121
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001649, 7.205763, 11.016530
Train average loss all      (Triplet)                 : 0.001350

== Recognize ==
Train average loss Recognize     : 1.213784
Train average accuracy drums     : 49.590000 %
Train average accuracy bass      : 50.269997 %
Train average accuracy piano     : 49.985001 %
Train average accuracy guitar    : 50.169998 %
Train average accuracy residuals : 50.024998 %

== Train average loss all : 0.004813

Epoch 99:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]          Epoch 100:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]Epoch 100:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.00337, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]Epoch 100:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210] Epoch 100:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.0035, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]Epoch 100:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]Epoch 100:  48%|████▊     | 150/313 [02:07<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00342, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]Epoch 100:  48%|████▊     | 150/313 [02:07<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00389, Train/loss_unet_all_step=0.389, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]Epoch 100:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00389, Train/loss_unet_all_step=0.389, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]Epoch 100:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]Epoch 100:  80%|███████▉  | 250/313 [03:26<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]Epoch 100:  80%|███████▉  | 250/313 [03:26<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]Epoch 100:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]Epoch 100:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00336, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]Epoch 100: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00336, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]Epoch 100: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.670, Valid/loss_unet_all_step=0.415, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.411, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.414, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.75it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.11it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.35it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.62it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.50it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.109785, 0.110682, 0.098403, 0.100767
Valid average loss UNet                 (all)                : 0.419637

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.133452, 5.958077, 9.152908
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.570190, 6.661897, 7.507776
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.132716, 8.388344, 8.574821
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.196946, 7.553946, 9.811769
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.458118, 8.419253, 9.401768
Valid average loss all      (Triplet)                 : 0.508506

== Recognize ==
Valid average loss Recognize     : 1.037005
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 44.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.512702

= T-SNE...
T-SNE was finished!
= T-SNE time is 17.105531692504883 sec. =
Valid knn accuracy drums     : 60.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.980307340621948 sec. =
Valid knn accuracy bass      : 19.900000000000002%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.525491714477539 sec. =
Valid knn accuracy piano     : 16.400000000000002%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.811825037002563 sec. =
Valid knn accuracy guitar    : 47.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.916109800338745 sec. =
Valid knn accuracy residuals : 63.5%

Valid knn accuracy average   : 41.6%

                                                                        [AEpoch 100: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.633, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.513, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.00481, Train/loss_unet_all_epoch=0.346, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.210]Epoch 100: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.633, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.513, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.090218, 0.091583, 0.092226, 0.072634
Train average loss UNet                 (all)                : 0.346661

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001042, 5.529319, 10.285535
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001529, 6.225928, 9.593921
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002529, 6.684908, 9.952496
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002742, 6.901665, 10.765750
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001568, 7.120339, 10.889619
Train average loss all      (Triplet)                 : 0.001872

== Recognize ==
Train average loss Recognize     : 1.211312
Train average accuracy drums     : 50.389999 %
Train average accuracy bass      : 49.514999 %
Train average accuracy piano     : 49.485001 %
Train average accuracy guitar    : 50.274998 %
Train average accuracy residuals : 50.620003 %

== Train average loss all : 0.005338

Epoch 100: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00327, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.633, Valid/loss_unet_all_step=0.444, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.513, Valid/loss_unet_all_epoch=0.420, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.00534, Train/loss_unet_all_epoch=0.347, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.210]
[2023-11-08 11:48:36,620][source.train][INFO] - [rank: 0] Starting testing!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0: 100%|██████████| 16/16 [00:09<00:00,  1.74it/s]Testing DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]         Testing DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.61it/s]Testing DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         Testing DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.81it/s]Testing DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         Testing DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.84it/s]Testing DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         Testing DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 4: 100%|██████████| 16/16 [00:02<00:00,  5.77it/s]Testing DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         Testing DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.71it/s]
Test average accuracy drums     :  74.699997 %
Test average accuracy bass      :  63.800003 %
Test average accuracy piano     :  68.699997 %
Test average accuracy guitar    :  70.300003 %
Test average accuracy residuals :  89.200005 %
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.266116380691528 sec. =
Test knn accuracy drums     : 76.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.973344564437866 sec. =
Test knn accuracy bass      : 19.900000000000002%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.845170021057129 sec. =
Test knn accuracy piano     : 39.800000000000004%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.408432483673096 sec. =
Test knn accuracy guitar    : 15.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.447427749633789 sec. =
Test knn accuracy residuals : 72.39999999999999%

Test knn accuracy average   : 44.75999999999999%
Testing DataLoader 5: 100%|██████████| 16/16 [01:36<00:00,  0.17it/s]
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 0    ┃   DataLoader 1    ┃   DataLoader 2   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.44760000705718… │ 0.44760000705718… │ 0.4476000070571… │
│   Test/knn_bass   │ 0.19900000095367… │ 0.19900000095367… │ 0.1990000009536… │
│  Test/knn_drums   │ 0.76300001144409… │ 0.76300001144409… │ 0.7630000114440… │
│  Test/knn_guitar  │ 0.15399999916553… │ 0.15399999916553… │ 0.1539999991655… │
│  Test/knn_piano   │ 0.39800000190734… │ 0.39800000190734… │ 0.3980000019073… │
│ Test/knn_residua… │ 0.72399997711181… │ 0.72399997711181… │ 0.7239999771118… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 3    ┃   DataLoader 4    ┃   DataLoader 5   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.44760000705718… │ 0.44760000705718… │ 0.4476000070571… │
│   Test/knn_bass   │ 0.19900000095367… │ 0.19900000095367… │ 0.1990000009536… │
│  Test/knn_drums   │ 0.76300001144409… │ 0.76300001144409… │ 0.7630000114440… │
│  Test/knn_guitar  │ 0.15399999916553… │ 0.15399999916553… │ 0.1539999991655… │
│  Test/knn_piano   │ 0.39800000190734… │ 0.39800000190734… │ 0.3980000019073… │
│ Test/knn_residua… │ 0.72399997711181… │ 0.72399997711181… │ 0.7239999771118… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
[2023-11-08 11:51:00,400][source.train][INFO] - [rank: 0] Best ckpt path: /nas02/homes/imamura23-1000067/outputs/triplet_with_unet/runs/2023-11-08/01-11-14/checkpoints/epoch_epoch=000.ckpt
[2023-11-08 11:51:00,401][utils.utils][INFO] - [rank: 0] Output dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023-11-08/01-11-14
[2023-11-08 11:51:00,403][utils.utils][INFO] - [rank: 0] Metric name is None! Skipping metric value retrieval...

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Time taken to study : 10:39:45

All prosess was Done!
