
=== Using cuda(utils.func). ===


=== Using cuda(utils.logger). ===

[2023-11-03 07:52:19,165][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 07:52:19,171][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 100                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 20                                                       
│         batch_test: 64                                                        
│         num_workers: 2                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         train_dirname: 3s_on1.5                                               
│         test_dirname: 3s_on1.5                                                
│         load_using_librosa: true                                              
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_train: 3                                                      
│         seconds_test: 3                                                       
│         sr: 44100                                                             
│         mel: false                                                            
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 0.001                                                             
│         monitor_es: Valid/loss_all                                            
│         monitor_mode_es: min                                                  
│         triplet_rate: 0.1                                                     
│         unet_rate: 0                                                          
│         recog_rate: 1                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640                         
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│       cfg:                                                                    
│         n_epoch: 100                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 20                                                       
│         batch_test: 64                                                        
│         num_workers: 2                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         train_dirname: 3s_on1.5                                               
│         test_dirname: 3s_on1.5                                                
│         load_using_librosa: true                                              
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_train: 3                                                      
│         seconds_test: 3                                                       
│         sr: 44100                                                             
│         mel: false                                                            
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 0.001                                                             
│         monitor_es: Valid/loss_all                                            
│         monitor_mode_es: min                                                  
│         triplet_rate: 0.1                                                     
│         unet_rate: 0                                                          
│         recog_rate: 1                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/loss_all                                               
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: 1                                                         
│         mode: min                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/loss_all                                               
│         min_delta: 0.0                                                        
│         patience: 10                                                          
│         verbose: true                                                         
│         mode: min                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 100                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 100                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 20                                                         
│       batch_test: 64                                                          
│       num_workers: 2                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       train_dirname: 3s_on1.5                                                 
│       test_dirname: 3s_on1.5                                                  
│       load_using_librosa: true                                                
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_train: 3                                                        
│       seconds_test: 3                                                         
│       sr: 44100                                                               
│       mel: false                                                              
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640                             
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       lr: 0.001                                                               
│       monitor_es: Valid/loss_all                                              
│       monitor_mode_es: min                                                    
│       triplet_rate: 0.1                                                       
│       unet_rate: 0                                                            
│       recog_rate: 1                                                           
│       test_psd_mine: false                                                    
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['unet', 'model_2d_to1d640_de5']                                        
├── ckpt_path
│   └── /home/imamura23/nas02home/outputs/2023-10-29/18-45-05/checkpoints/epoch_
└── seed
    └── None                                                                    
[2023-11-03 07:52:19,252][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-03 07:52:19,271][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-03 07:52:24,024][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpa3bg0t8_
[2023-11-03 07:52:24,028][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpa3bg0t8_/_remote_module_non_scriptable.py
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=10880, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-03 07:52:24,138][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-03 07:52:24,138][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 07:52:24,151][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 07:52:24,155][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 07:52:24,156][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-03 07:52:24,156][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-03 07:52:24,237][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-03 07:52:24,769][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-03 07:52:25,139][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
The length of seg for train is 3s.
The length of seg for valid and test is 3s.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.6699085235595703 sec. *
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:09<00:00,  0.20it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 1: 100%|██████████| 2/2 [00:00<00:00,  3.42it/s]Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 2: 100%|██████████| 2/2 [00:00<00:00,  3.24it/s]Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 3: 100%|██████████| 2/2 [00:00<00:00,  3.08it/s]Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 4: 100%|██████████| 2/2 [00:00<00:00,  3.27it/s]Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 5:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 5: 100%|██████████| 2/2 [00:00<00:00,  2.75it/s]

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.081837, 0.081783, 0.081486, 0.053540
Valid average loss UNet                 (all)                : 0.298646

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.160017, 0.140253, 0.190814
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.207794, 0.184290, 0.176496
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.139280, 0.272901, 0.341317
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.179440, 0.249681, 0.270241
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.207207, 0.276249, 0.269042
Valid average loss all      (Triplet)                 : 0.182526

== Recognize ==
Valid average loss Recognize     : 0.943180
Valid average accuracy drums     : 54.687500 %
Valid average accuracy bass      : 53.125000 %
Valid average accuracy piano     : 46.093750 %
Valid average accuracy guitar    : 42.187500 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.961433

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 6.597903728485107 sec. =
Valid knn accuracy drums     : 50.78125%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 5.52558445930481 sec. =
Valid knn accuracy bass      : 46.875%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.5891902446746826 sec. =
Valid knn accuracy piano     : 55.46875%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.69708514213562 sec. =
Valid knn accuracy guitar    : 69.53125%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.47107195854187 sec. =
Valid knn accuracy residuals : 90.625%

Valid knn accuracy average   : 62.65625%
                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/1000 [00:00<?, ?it/s]Epoch 7:   0%|          | 0/1000 [00:00<?, ?it/s] Epoch 7:   5%|▌         | 50/1000 [03:37<1:08:47,  0.23it/s]Epoch 7:   5%|▌         | 50/1000 [03:37<1:08:47,  0.23it/s, v_num=0, Train/loss_all_step=0.642, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.298, Train/loss_recog_step=0.613]Epoch 7:  10%|█         | 100/1000 [06:59<1:02:58,  0.24it/s, v_num=0, Train/loss_all_step=0.642, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.298, Train/loss_recog_step=0.613]Epoch 7:  10%|█         | 100/1000 [06:59<1:02:58,  0.24it/s, v_num=0, Train/loss_all_step=0.629, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=0.588]Epoch 7:  15%|█▌        | 150/1000 [10:18<58:27,  0.24it/s, v_num=0, Train/loss_all_step=0.629, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=0.588]  Epoch 7:  15%|█▌        | 150/1000 [10:18<58:27,  0.24it/s, v_num=0, Train/loss_all_step=0.561, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.397, Train/loss_recog_step=0.521]Epoch 7:  20%|██        | 200/1000 [13:32<54:08,  0.25it/s, v_num=0, Train/loss_all_step=0.561, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.397, Train/loss_recog_step=0.521]Epoch 7:  20%|██        | 200/1000 [13:32<54:08,  0.25it/s, v_num=0, Train/loss_all_step=0.566, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.297, Train/loss_recog_step=0.536]Epoch 7:  25%|██▌       | 250/1000 [16:43<50:09,  0.25it/s, v_num=0, Train/loss_all_step=0.566, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.297, Train/loss_recog_step=0.536]Epoch 7:  25%|██▌       | 250/1000 [16:43<50:09,  0.25it/s, v_num=0, Train/loss_all_step=0.557, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=0.518]Epoch 7:  30%|███       | 300/1000 [19:50<46:17,  0.25it/s, v_num=0, Train/loss_all_step=0.557, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=0.518]Epoch 7:  30%|███       | 300/1000 [19:50<46:17,  0.25it/s, v_num=0, Train/loss_all_step=0.581, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=0.563]Epoch 7:  35%|███▌      | 350/1000 [22:55<42:34,  0.25it/s, v_num=0, Train/loss_all_step=0.581, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=0.563]Epoch 7:  35%|███▌      | 350/1000 [22:55<42:34,  0.25it/s, v_num=0, Train/loss_all_step=0.650, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.630]Epoch 7:  40%|████      | 400/1000 [25:53<38:49,  0.26it/s, v_num=0, Train/loss_all_step=0.650, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.630]Epoch 7:  40%|████      | 400/1000 [25:53<38:49,  0.26it/s, v_num=0, Train/loss_all_step=0.556, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.538]Epoch 7:  45%|████▌     | 450/1000 [28:46<35:10,  0.26it/s, v_num=0, Train/loss_all_step=0.556, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.538]Epoch 7:  45%|████▌     | 450/1000 [28:46<35:10,  0.26it/s, v_num=0, Train/loss_all_step=0.571, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.288, Train/loss_recog_step=0.542]Epoch 7:  50%|█████     | 500/1000 [31:38<31:38,  0.26it/s, v_num=0, Train/loss_all_step=0.571, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.288, Train/loss_recog_step=0.542]Epoch 7:  50%|█████     | 500/1000 [31:38<31:38,  0.26it/s, v_num=0, Train/loss_all_step=0.541, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.318, Train/loss_recog_step=0.509]Epoch 7:  55%|█████▌    | 550/1000 [34:38<28:20,  0.26it/s, v_num=0, Train/loss_all_step=0.541, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.318, Train/loss_recog_step=0.509]Epoch 7:  55%|█████▌    | 550/1000 [34:38<28:20,  0.26it/s, v_num=0, Train/loss_all_step=0.530, Train/loss_unet_all_step=0.314, Train/loss_triplet_all_step=0.267, Train/loss_recog_step=0.504]Epoch 7:  60%|██████    | 600/1000 [37:52<25:14,  0.26it/s, v_num=0, Train/loss_all_step=0.530, Train/loss_unet_all_step=0.314, Train/loss_triplet_all_step=0.267, Train/loss_recog_step=0.504]Epoch 7:  60%|██████    | 600/1000 [37:52<25:14,  0.26it/s, v_num=0, Train/loss_all_step=0.440, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.318, Train/loss_recog_step=0.408]Epoch 7:  65%|██████▌   | 650/1000 [41:03<22:06,  0.26it/s, v_num=0, Train/loss_all_step=0.440, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.318, Train/loss_recog_step=0.408]Epoch 7:  65%|██████▌   | 650/1000 [41:03<22:06,  0.26it/s, v_num=0, Train/loss_all_step=0.516, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=0.482]Epoch 7:  70%|███████   | 700/1000 [44:15<18:58,  0.26it/s, v_num=0, Train/loss_all_step=0.516, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=0.482]Epoch 7:  70%|███████   | 700/1000 [44:15<18:58,  0.26it/s, v_num=0, Train/loss_all_step=0.660, Train/loss_unet_all_step=0.269, Train/loss_triplet_all_step=0.366, Train/loss_recog_step=0.623]Epoch 7:  75%|███████▌  | 750/1000 [47:24<15:48,  0.26it/s, v_num=0, Train/loss_all_step=0.660, Train/loss_unet_all_step=0.269, Train/loss_triplet_all_step=0.366, Train/loss_recog_step=0.623]Epoch 7:  75%|███████▌  | 750/1000 [47:24<15:48,  0.26it/s, v_num=0, Train/loss_all_step=0.475, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.188, Train/loss_recog_step=0.457]Epoch 7:  80%|████████  | 800/1000 [50:32<12:38,  0.26it/s, v_num=0, Train/loss_all_step=0.475, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.188, Train/loss_recog_step=0.457]Epoch 7:  80%|████████  | 800/1000 [50:32<12:38,  0.26it/s, v_num=0, Train/loss_all_step=0.577, Train/loss_unet_all_step=0.253, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.563]Epoch 7:  85%|████████▌ | 850/1000 [53:41<09:28,  0.26it/s, v_num=0, Train/loss_all_step=0.577, Train/loss_unet_all_step=0.253, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.563]Epoch 7:  85%|████████▌ | 850/1000 [53:41<09:28,  0.26it/s, v_num=0, Train/loss_all_step=0.489, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.627, Train/loss_recog_step=0.427]Epoch 7:  90%|█████████ | 900/1000 [56:50<06:18,  0.26it/s, v_num=0, Train/loss_all_step=0.489, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.627, Train/loss_recog_step=0.427]Epoch 7:  90%|█████████ | 900/1000 [56:50<06:18,  0.26it/s, v_num=0, Train/loss_all_step=0.604, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.298, Train/loss_recog_step=0.574]Epoch 7:  95%|█████████▌| 950/1000 [59:55<03:09,  0.26it/s, v_num=0, Train/loss_all_step=0.604, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.298, Train/loss_recog_step=0.574]Epoch 7:  95%|█████████▌| 950/1000 [59:55<03:09,  0.26it/s, v_num=0, Train/loss_all_step=0.524, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.401, Train/loss_recog_step=0.484]Epoch 7: 100%|██████████| 1000/1000 [1:02:45<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.524, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.401, Train/loss_recog_step=0.484]Epoch 7: 100%|██████████| 1000/1000 [1:02:45<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.501, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.281, Train/loss_recog_step=0.473]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.56it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.57it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:13<00:00,  0.57it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:13<00:00,  0.53it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:12<00:00,  0.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078434, 0.084621, 0.083875, 0.052457
Valid average loss UNet                 (all)                : 0.299387

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101817, 0.574662, 1.621409
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.257979, 0.574382, 0.673858
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.432401, 0.963504, 0.860571
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.363522, 1.078885, 1.437586
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.440689, 1.503434, 1.757289
Valid average loss all      (Triplet)                 : 0.335887

== Recognize ==
Valid average loss Recognize     : 0.471375
Valid average accuracy drums     : 93.000000 %
Valid average accuracy bass      : 90.000000 %
Valid average accuracy piano     : 77.000000 %
Valid average accuracy guitar    : 57.000000 %
Valid average accuracy residuals : 93.500000 %

== Valid average loss all : 0.504964

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.15938115119934 sec. =
Valid knn accuracy drums     : 53.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.543175458908081 sec. =
Valid knn accuracy bass      : 22.983870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.50601315498352 sec. =
Valid knn accuracy piano     : 35.7421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.633628368377686 sec. =
Valid knn accuracy guitar    : 51.78571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.472800970077515 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 46.43239407638295%

                                                                      [AEpoch 7: 100%|██████████| 1000/1000 [1:06:03<00:00,  0.25it/s, v_num=0, Train/loss_all_step=0.501, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.281, Train/loss_recog_step=0.473, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464]Epoch 7: 100%|██████████| 1000/1000 [1:06:03<00:00,  0.25it/s, v_num=0, Train/loss_all_step=0.501, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.281, Train/loss_recog_step=0.473, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082200, 0.082095, 0.082300, 0.065494
Train average loss UNet                 (all)                : 0.312090

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.288789, 0.988655, 1.571081
Train average loss bass     (Triplet, dist_p, dist_n) : 0.393879, 0.880175, 0.919840
Train average loss piano    (Triplet, dist_p, dist_n) : 0.292817, 0.791811, 0.878715
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.277309, 0.859955, 1.042598
Train average loss residuals(Triplet, dist_p, dist_n) : 0.321715, 1.082403, 1.407471
Train average loss all      (Triplet)                 : 0.316159

== Recognize ==
Train average loss Recognize     : 0.500669
Train average accuracy drums     : 89.995003 %
Train average accuracy bass      : 82.010002 %
Train average accuracy piano     : 69.754997 %
Train average accuracy guitar    : 70.560005 %
Train average accuracy residuals : 81.669998 %

== Train average loss all : 0.532285

Epoch 7:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.501, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.281, Train/loss_recog_step=0.473, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]             Epoch 8:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.501, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.281, Train/loss_recog_step=0.473, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:   5%|▌         | 50/1000 [02:54<55:24,  0.29it/s, v_num=0, Train/loss_all_step=0.501, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.281, Train/loss_recog_step=0.473, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:   5%|▌         | 50/1000 [02:54<55:24,  0.29it/s, v_num=0, Train/loss_all_step=0.489, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.387, Train/loss_recog_step=0.450, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  10%|█         | 100/1000 [05:49<52:26,  0.29it/s, v_num=0, Train/loss_all_step=0.489, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.387, Train/loss_recog_step=0.450, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  10%|█         | 100/1000 [05:49<52:26,  0.29it/s, v_num=0, Train/loss_all_step=0.482, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.310, Train/loss_recog_step=0.451, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  15%|█▌        | 150/1000 [08:49<49:58,  0.28it/s, v_num=0, Train/loss_all_step=0.482, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.310, Train/loss_recog_step=0.451, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  15%|█▌        | 150/1000 [08:49<49:58,  0.28it/s, v_num=0, Train/loss_all_step=0.412, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.417, Train/loss_recog_step=0.371, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  20%|██        | 200/1000 [11:44<46:57,  0.28it/s, v_num=0, Train/loss_all_step=0.412, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.417, Train/loss_recog_step=0.371, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  20%|██        | 200/1000 [11:44<46:57,  0.28it/s, v_num=0, Train/loss_all_step=0.519, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.548, Train/loss_recog_step=0.464, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  25%|██▌       | 250/1000 [14:39<43:59,  0.28it/s, v_num=0, Train/loss_all_step=0.519, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.548, Train/loss_recog_step=0.464, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  25%|██▌       | 250/1000 [14:39<43:59,  0.28it/s, v_num=0, Train/loss_all_step=0.500, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.294, Train/loss_recog_step=0.470, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  30%|███       | 300/1000 [17:33<40:58,  0.28it/s, v_num=0, Train/loss_all_step=0.500, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.294, Train/loss_recog_step=0.470, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  30%|███       | 300/1000 [17:33<40:58,  0.28it/s, v_num=0, Train/loss_all_step=0.582, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.283, Train/loss_recog_step=0.553, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  35%|███▌      | 350/1000 [20:27<38:00,  0.29it/s, v_num=0, Train/loss_all_step=0.582, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.283, Train/loss_recog_step=0.553, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  35%|███▌      | 350/1000 [20:27<38:00,  0.29it/s, v_num=0, Train/loss_all_step=0.591, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.574, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  40%|████      | 400/1000 [23:16<34:54,  0.29it/s, v_num=0, Train/loss_all_step=0.591, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.574, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  40%|████      | 400/1000 [23:16<34:54,  0.29it/s, v_num=0, Train/loss_all_step=0.478, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.220, Train/loss_recog_step=0.456, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  45%|████▌     | 450/1000 [26:11<32:01,  0.29it/s, v_num=0, Train/loss_all_step=0.478, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.220, Train/loss_recog_step=0.456, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  45%|████▌     | 450/1000 [26:11<32:01,  0.29it/s, v_num=0, Train/loss_all_step=0.510, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.238, Train/loss_recog_step=0.486, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  50%|█████     | 500/1000 [29:03<29:03,  0.29it/s, v_num=0, Train/loss_all_step=0.510, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.238, Train/loss_recog_step=0.486, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  50%|█████     | 500/1000 [29:03<29:03,  0.29it/s, v_num=0, Train/loss_all_step=0.462, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.276, Train/loss_recog_step=0.434, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  55%|█████▌    | 550/1000 [31:51<26:04,  0.29it/s, v_num=0, Train/loss_all_step=0.462, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.276, Train/loss_recog_step=0.434, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  55%|█████▌    | 550/1000 [31:51<26:04,  0.29it/s, v_num=0, Train/loss_all_step=0.439, Train/loss_unet_all_step=0.307, Train/loss_triplet_all_step=0.293, Train/loss_recog_step=0.410, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  60%|██████    | 600/1000 [34:36<23:04,  0.29it/s, v_num=0, Train/loss_all_step=0.439, Train/loss_unet_all_step=0.307, Train/loss_triplet_all_step=0.293, Train/loss_recog_step=0.410, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  60%|██████    | 600/1000 [34:36<23:04,  0.29it/s, v_num=0, Train/loss_all_step=0.468, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.424, Train/loss_recog_step=0.426, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  65%|██████▌   | 650/1000 [37:31<20:12,  0.29it/s, v_num=0, Train/loss_all_step=0.468, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.424, Train/loss_recog_step=0.426, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  65%|██████▌   | 650/1000 [37:31<20:12,  0.29it/s, v_num=0, Train/loss_all_step=0.510, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.407, Train/loss_recog_step=0.469, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  70%|███████   | 700/1000 [40:24<17:18,  0.29it/s, v_num=0, Train/loss_all_step=0.510, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.407, Train/loss_recog_step=0.469, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  70%|███████   | 700/1000 [40:24<17:18,  0.29it/s, v_num=0, Train/loss_all_step=0.603, Train/loss_unet_all_step=0.262, Train/loss_triplet_all_step=0.235, Train/loss_recog_step=0.579, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  75%|███████▌  | 750/1000 [43:19<14:26,  0.29it/s, v_num=0, Train/loss_all_step=0.603, Train/loss_unet_all_step=0.262, Train/loss_triplet_all_step=0.235, Train/loss_recog_step=0.579, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  75%|███████▌  | 750/1000 [43:19<14:26,  0.29it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.304, Train/loss_recog_step=0.346, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  80%|████████  | 800/1000 [46:14<11:33,  0.29it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.304, Train/loss_recog_step=0.346, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  80%|████████  | 800/1000 [46:14<11:33,  0.29it/s, v_num=0, Train/loss_all_step=0.496, Train/loss_unet_all_step=0.257, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=0.478, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  85%|████████▌ | 850/1000 [49:11<08:40,  0.29it/s, v_num=0, Train/loss_all_step=0.496, Train/loss_unet_all_step=0.257, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=0.478, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  85%|████████▌ | 850/1000 [49:11<08:40,  0.29it/s, v_num=0, Train/loss_all_step=0.448, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.366, Train/loss_recog_step=0.412, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  90%|█████████ | 900/1000 [52:06<05:47,  0.29it/s, v_num=0, Train/loss_all_step=0.448, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.366, Train/loss_recog_step=0.412, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  90%|█████████ | 900/1000 [52:06<05:47,  0.29it/s, v_num=0, Train/loss_all_step=0.463, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.255, Train/loss_recog_step=0.437, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  95%|█████████▌| 950/1000 [55:02<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.463, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.255, Train/loss_recog_step=0.437, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8:  95%|█████████▌| 950/1000 [55:02<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.527, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.462, Train/loss_recog_step=0.481, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8: 100%|██████████| 1000/1000 [57:58<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.527, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.462, Train/loss_recog_step=0.481, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8: 100%|██████████| 1000/1000 [57:58<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.533, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.310, Train/loss_recog_step=0.502, Valid/loss_all_step=0.483, Valid/loss_unet_all_step=0.298, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.471, Valid/knn_avr=0.464, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:21<00:00,  0.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078516, 0.084683, 0.083942, 0.053475
Valid average loss UNet                 (all)                : 0.300616

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.138526, 0.796008, 1.716992
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.297761, 0.660336, 0.783355
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.453813, 0.983691, 0.874310
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.278770, 1.014973, 1.482734
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.311860, 1.064806, 1.392084
Valid average loss all      (Triplet)                 : 0.322461

== Recognize ==
Valid average loss Recognize     : 0.446346
Valid average accuracy drums     : 96.000000 %
Valid average accuracy bass      : 89.500000 %
Valid average accuracy piano     : 85.500000 %
Valid average accuracy guitar    : 62.000000 %
Valid average accuracy residuals : 89.500000 %

== Valid average loss all : 0.478592

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.792691707611084 sec. =
Valid knn accuracy drums     : 59.130434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.289762020111084 sec. =
Valid knn accuracy bass      : 23.991935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.705943822860718 sec. =
Valid knn accuracy piano     : 38.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.784803628921509 sec. =
Valid knn accuracy guitar    : 41.74107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.169478416442871 sec. =
Valid knn accuracy residuals : 69.54545454545455%

Valid knn accuracy average   : 46.616154248101125%

                                                                      [AEpoch 8: 100%|██████████| 1000/1000 [1:01:25<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.533, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.310, Train/loss_recog_step=0.502, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.532, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.316, Train/loss_recog_epoch=0.501]Epoch 8: 100%|██████████| 1000/1000 [1:01:25<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.533, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.310, Train/loss_recog_step=0.502, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082187, 0.082090, 0.082300, 0.064867
Train average loss UNet                 (all)                : 0.311445

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.291573, 1.018520, 1.790635
Train average loss bass     (Triplet, dist_p, dist_n) : 0.408294, 0.889413, 0.974612
Train average loss piano    (Triplet, dist_p, dist_n) : 0.301640, 0.756618, 0.905257
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.278395, 0.861311, 1.175320
Train average loss residuals(Triplet, dist_p, dist_n) : 0.341982, 1.101429, 1.502386
Train average loss all      (Triplet)                 : 0.324299

== Recognize ==
Train average loss Recognize     : 0.438950
Train average accuracy drums     : 94.129997 %
Train average accuracy bass      : 87.660004 %
Train average accuracy piano     : 75.370003 %
Train average accuracy guitar    : 76.470001 %
Train average accuracy residuals : 86.145004 %

== Train average loss all : 0.471380

Epoch 8:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.533, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.310, Train/loss_recog_step=0.502, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]             Epoch 9:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.533, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.310, Train/loss_recog_step=0.502, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:   5%|▌         | 50/1000 [02:52<54:40,  0.29it/s, v_num=0, Train/loss_all_step=0.533, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.310, Train/loss_recog_step=0.502, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:   5%|▌         | 50/1000 [02:52<54:40,  0.29it/s, v_num=0, Train/loss_all_step=0.470, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.412, Train/loss_recog_step=0.429, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  10%|█         | 100/1000 [05:38<50:48,  0.30it/s, v_num=0, Train/loss_all_step=0.470, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.412, Train/loss_recog_step=0.429, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  10%|█         | 100/1000 [05:38<50:48,  0.30it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.303, Train/loss_recog_step=0.446, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  15%|█▌        | 150/1000 [08:29<48:09,  0.29it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.303, Train/loss_recog_step=0.446, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  15%|█▌        | 150/1000 [08:29<48:09,  0.29it/s, v_num=0, Train/loss_all_step=0.409, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.478, Train/loss_recog_step=0.361, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  20%|██        | 200/1000 [11:26<45:44,  0.29it/s, v_num=0, Train/loss_all_step=0.409, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.478, Train/loss_recog_step=0.361, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  20%|██        | 200/1000 [11:26<45:44,  0.29it/s, v_num=0, Train/loss_all_step=0.547, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.488, Train/loss_recog_step=0.498, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  25%|██▌       | 250/1000 [14:23<43:11,  0.29it/s, v_num=0, Train/loss_all_step=0.547, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.488, Train/loss_recog_step=0.498, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  25%|██▌       | 250/1000 [14:23<43:11,  0.29it/s, v_num=0, Train/loss_all_step=0.448, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=0.411, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  30%|███       | 300/1000 [17:20<40:27,  0.29it/s, v_num=0, Train/loss_all_step=0.448, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=0.411, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  30%|███       | 300/1000 [17:20<40:27,  0.29it/s, v_num=0, Train/loss_all_step=0.487, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.241, Train/loss_recog_step=0.463, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  35%|███▌      | 350/1000 [20:15<37:38,  0.29it/s, v_num=0, Train/loss_all_step=0.487, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.241, Train/loss_recog_step=0.463, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  35%|███▌      | 350/1000 [20:15<37:38,  0.29it/s, v_num=0, Train/loss_all_step=0.548, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.223, Train/loss_recog_step=0.525, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  40%|████      | 400/1000 [23:06<34:39,  0.29it/s, v_num=0, Train/loss_all_step=0.548, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.223, Train/loss_recog_step=0.525, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  40%|████      | 400/1000 [23:06<34:39,  0.29it/s, v_num=0, Train/loss_all_step=0.435, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.421, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  45%|████▌     | 450/1000 [26:00<31:47,  0.29it/s, v_num=0, Train/loss_all_step=0.435, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.421, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  45%|████▌     | 450/1000 [26:00<31:47,  0.29it/s, v_num=0, Train/loss_all_step=0.401, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.387, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  50%|█████     | 500/1000 [28:52<28:52,  0.29it/s, v_num=0, Train/loss_all_step=0.401, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.387, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  50%|█████     | 500/1000 [28:52<28:52,  0.29it/s, v_num=0, Train/loss_all_step=0.435, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.204, Train/loss_recog_step=0.415, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  55%|█████▌    | 550/1000 [31:47<26:00,  0.29it/s, v_num=0, Train/loss_all_step=0.435, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.204, Train/loss_recog_step=0.415, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  55%|█████▌    | 550/1000 [31:47<26:00,  0.29it/s, v_num=0, Train/loss_all_step=0.436, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.232, Train/loss_recog_step=0.413, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  60%|██████    | 600/1000 [34:39<23:06,  0.29it/s, v_num=0, Train/loss_all_step=0.436, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.232, Train/loss_recog_step=0.413, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  60%|██████    | 600/1000 [34:39<23:06,  0.29it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.225, Train/loss_recog_step=0.331, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  65%|██████▌   | 650/1000 [37:26<20:09,  0.29it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.225, Train/loss_recog_step=0.331, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  65%|██████▌   | 650/1000 [37:26<20:09,  0.29it/s, v_num=0, Train/loss_all_step=0.474, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.335, Train/loss_recog_step=0.440, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  70%|███████   | 700/1000 [40:11<17:13,  0.29it/s, v_num=0, Train/loss_all_step=0.474, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.335, Train/loss_recog_step=0.440, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  70%|███████   | 700/1000 [40:11<17:13,  0.29it/s, v_num=0, Train/loss_all_step=0.610, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.270, Train/loss_recog_step=0.583, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  75%|███████▌  | 750/1000 [43:03<14:21,  0.29it/s, v_num=0, Train/loss_all_step=0.610, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.270, Train/loss_recog_step=0.583, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  75%|███████▌  | 750/1000 [43:03<14:21,  0.29it/s, v_num=0, Train/loss_all_step=0.392, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.209, Train/loss_recog_step=0.371, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  80%|████████  | 800/1000 [45:58<11:29,  0.29it/s, v_num=0, Train/loss_all_step=0.392, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.209, Train/loss_recog_step=0.371, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  80%|████████  | 800/1000 [45:58<11:29,  0.29it/s, v_num=0, Train/loss_all_step=0.473, Train/loss_unet_all_step=0.249, Train/loss_triplet_all_step=0.193, Train/loss_recog_step=0.454, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  85%|████████▌ | 850/1000 [48:54<08:37,  0.29it/s, v_num=0, Train/loss_all_step=0.473, Train/loss_unet_all_step=0.249, Train/loss_triplet_all_step=0.193, Train/loss_recog_step=0.454, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  85%|████████▌ | 850/1000 [48:54<08:37,  0.29it/s, v_num=0, Train/loss_all_step=0.442, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.511, Train/loss_recog_step=0.391, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  90%|█████████ | 900/1000 [51:47<05:45,  0.29it/s, v_num=0, Train/loss_all_step=0.442, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.511, Train/loss_recog_step=0.391, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  90%|█████████ | 900/1000 [51:47<05:45,  0.29it/s, v_num=0, Train/loss_all_step=0.414, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.258, Train/loss_recog_step=0.388, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  95%|█████████▌| 950/1000 [54:43<02:52,  0.29it/s, v_num=0, Train/loss_all_step=0.414, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.258, Train/loss_recog_step=0.388, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9:  95%|█████████▌| 950/1000 [54:43<02:52,  0.29it/s, v_num=0, Train/loss_all_step=0.573, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.495, Train/loss_recog_step=0.524, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9: 100%|██████████| 1000/1000 [57:37<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.573, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.495, Train/loss_recog_step=0.524, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9: 100%|██████████| 1000/1000 [57:37<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.510, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.277, Train/loss_recog_step=0.483, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.489, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.466, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.55it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.55it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078484, 0.084622, 0.083897, 0.056613
Valid average loss UNet                 (all)                : 0.303616

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113140, 0.707157, 1.654623
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.307472, 0.604643, 0.703539
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.495890, 1.012396, 0.923524
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.258837, 0.996914, 1.600488
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.402448, 1.194997, 1.298513
Valid average loss all      (Triplet)                 : 0.342053

== Recognize ==
Valid average loss Recognize     : 0.455990
Valid average accuracy drums     : 93.000000 %
Valid average accuracy bass      : 84.000000 %
Valid average accuracy piano     : 82.500000 %
Valid average accuracy guitar    : 60.000004 %
Valid average accuracy residuals : 92.000000 %

== Valid average loss all : 0.490195

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.332282304763794 sec. =
Valid knn accuracy drums     : 63.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.481647968292236 sec. =
Valid knn accuracy bass      : 14.717741935483872%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.377968549728394 sec. =
Valid knn accuracy piano     : 36.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.708335638046265 sec. =
Valid knn accuracy guitar    : 43.30357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.448389530181885 sec. =
Valid knn accuracy residuals : 65.68181818181819%

Valid knn accuracy average   : 44.66284098308774%

                                                                      [AEpoch 9: 100%|██████████| 1000/1000 [1:01:05<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.510, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.277, Train/loss_recog_step=0.483, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.471, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.324, Train/loss_recog_epoch=0.439]Epoch 9: 100%|██████████| 1000/1000 [1:01:05<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.510, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.277, Train/loss_recog_step=0.483, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082260, 0.082160, 0.082365, 0.065052
Train average loss UNet                 (all)                : 0.311838

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.282622, 1.041691, 1.901820
Train average loss bass     (Triplet, dist_p, dist_n) : 0.409373, 0.879923, 0.966859
Train average loss piano    (Triplet, dist_p, dist_n) : 0.297220, 0.739296, 0.923816
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.284183, 0.893973, 1.243791
Train average loss residuals(Triplet, dist_p, dist_n) : 0.342058, 1.143294, 1.576745
Train average loss all      (Triplet)                 : 0.321604

== Recognize ==
Train average loss Recognize     : 0.417151
Train average accuracy drums     : 94.845001 %
Train average accuracy bass      : 88.080002 %
Train average accuracy piano     : 77.635002 %
Train average accuracy guitar    : 79.049995 %
Train average accuracy residuals : 87.360001 %

== Train average loss all : 0.449311

Epoch 9:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.510, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.277, Train/loss_recog_step=0.483, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]             Epoch 10:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.510, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.277, Train/loss_recog_step=0.483, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:   5%|▌         | 50/1000 [02:59<56:49,  0.28it/s, v_num=0, Train/loss_all_step=0.510, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.277, Train/loss_recog_step=0.483, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:   5%|▌         | 50/1000 [02:59<56:49,  0.28it/s, v_num=0, Train/loss_all_step=0.432, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.282, Train/loss_recog_step=0.404, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  10%|█         | 100/1000 [05:53<52:58,  0.28it/s, v_num=0, Train/loss_all_step=0.432, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.282, Train/loss_recog_step=0.404, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  10%|█         | 100/1000 [05:53<52:58,  0.28it/s, v_num=0, Train/loss_all_step=0.481, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=0.462, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  15%|█▌        | 150/1000 [08:41<49:17,  0.29it/s, v_num=0, Train/loss_all_step=0.481, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=0.462, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  15%|█▌        | 150/1000 [08:41<49:17,  0.29it/s, v_num=0, Train/loss_all_step=0.461, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.514, Train/loss_recog_step=0.409, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  20%|██        | 200/1000 [11:29<45:56,  0.29it/s, v_num=0, Train/loss_all_step=0.461, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.514, Train/loss_recog_step=0.409, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  20%|██        | 200/1000 [11:29<45:56,  0.29it/s, v_num=0, Train/loss_all_step=0.463, Train/loss_unet_all_step=0.319, Train/loss_triplet_all_step=0.459, Train/loss_recog_step=0.417, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  25%|██▌       | 250/1000 [14:17<42:52,  0.29it/s, v_num=0, Train/loss_all_step=0.463, Train/loss_unet_all_step=0.319, Train/loss_triplet_all_step=0.459, Train/loss_recog_step=0.417, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  25%|██▌       | 250/1000 [14:17<42:52,  0.29it/s, v_num=0, Train/loss_all_step=0.444, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.291, Train/loss_recog_step=0.415, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  30%|███       | 300/1000 [17:14<40:14,  0.29it/s, v_num=0, Train/loss_all_step=0.444, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.291, Train/loss_recog_step=0.415, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  30%|███       | 300/1000 [17:14<40:14,  0.29it/s, v_num=0, Train/loss_all_step=0.496, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.284, Train/loss_recog_step=0.467, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  35%|███▌      | 350/1000 [20:10<37:27,  0.29it/s, v_num=0, Train/loss_all_step=0.496, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.284, Train/loss_recog_step=0.467, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  35%|███▌      | 350/1000 [20:10<37:27,  0.29it/s, v_num=0, Train/loss_all_step=0.490, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.473, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  40%|████      | 400/1000 [23:00<34:30,  0.29it/s, v_num=0, Train/loss_all_step=0.490, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.473, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  40%|████      | 400/1000 [23:00<34:30,  0.29it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.176, Train/loss_recog_step=0.407, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  45%|████▌     | 450/1000 [25:54<31:40,  0.29it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.176, Train/loss_recog_step=0.407, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  45%|████▌     | 450/1000 [25:54<31:40,  0.29it/s, v_num=0, Train/loss_all_step=0.400, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.383, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  50%|█████     | 500/1000 [28:50<28:50,  0.29it/s, v_num=0, Train/loss_all_step=0.400, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.383, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  50%|█████     | 500/1000 [28:50<28:50,  0.29it/s, v_num=0, Train/loss_all_step=0.419, Train/loss_unet_all_step=0.314, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.402, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  55%|█████▌    | 550/1000 [31:47<26:00,  0.29it/s, v_num=0, Train/loss_all_step=0.419, Train/loss_unet_all_step=0.314, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.402, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  55%|█████▌    | 550/1000 [31:47<26:00,  0.29it/s, v_num=0, Train/loss_all_step=0.401, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.318, Train/loss_recog_step=0.369, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  60%|██████    | 600/1000 [34:42<23:08,  0.29it/s, v_num=0, Train/loss_all_step=0.401, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.318, Train/loss_recog_step=0.369, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  60%|██████    | 600/1000 [34:42<23:08,  0.29it/s, v_num=0, Train/loss_all_step=0.386, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.254, Train/loss_recog_step=0.360, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  65%|██████▌   | 650/1000 [37:38<20:16,  0.29it/s, v_num=0, Train/loss_all_step=0.386, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.254, Train/loss_recog_step=0.360, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  65%|██████▌   | 650/1000 [37:38<20:16,  0.29it/s, v_num=0, Train/loss_all_step=0.496, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.406, Train/loss_recog_step=0.455, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  70%|███████   | 700/1000 [40:31<17:22,  0.29it/s, v_num=0, Train/loss_all_step=0.496, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.406, Train/loss_recog_step=0.455, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  70%|███████   | 700/1000 [40:31<17:22,  0.29it/s, v_num=0, Train/loss_all_step=0.563, Train/loss_unet_all_step=0.267, Train/loss_triplet_all_step=0.199, Train/loss_recog_step=0.543, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  75%|███████▌  | 750/1000 [43:19<14:26,  0.29it/s, v_num=0, Train/loss_all_step=0.563, Train/loss_unet_all_step=0.267, Train/loss_triplet_all_step=0.199, Train/loss_recog_step=0.543, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  75%|███████▌  | 750/1000 [43:19<14:26,  0.29it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.211, Train/loss_recog_step=0.384, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  80%|████████  | 800/1000 [46:05<11:31,  0.29it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.211, Train/loss_recog_step=0.384, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  80%|████████  | 800/1000 [46:05<11:31,  0.29it/s, v_num=0, Train/loss_all_step=0.470, Train/loss_unet_all_step=0.254, Train/loss_triplet_all_step=0.224, Train/loss_recog_step=0.447, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  85%|████████▌ | 850/1000 [48:54<08:37,  0.29it/s, v_num=0, Train/loss_all_step=0.470, Train/loss_unet_all_step=0.254, Train/loss_triplet_all_step=0.224, Train/loss_recog_step=0.447, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  85%|████████▌ | 850/1000 [48:54<08:37,  0.29it/s, v_num=0, Train/loss_all_step=0.457, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.423, Train/loss_recog_step=0.415, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  90%|█████████ | 900/1000 [51:51<05:45,  0.29it/s, v_num=0, Train/loss_all_step=0.457, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.423, Train/loss_recog_step=0.415, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  90%|█████████ | 900/1000 [51:51<05:45,  0.29it/s, v_num=0, Train/loss_all_step=0.427, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.228, Train/loss_recog_step=0.405, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  95%|█████████▌| 950/1000 [54:49<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.427, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.228, Train/loss_recog_step=0.405, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10:  95%|█████████▌| 950/1000 [54:49<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.519, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.464, Train/loss_recog_step=0.472, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10: 100%|██████████| 1000/1000 [57:47<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.519, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.464, Train/loss_recog_step=0.472, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10: 100%|██████████| 1000/1000 [57:47<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.435, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.417, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.447, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:20<00:00,  0.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.55it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:15<00:00,  0.53it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.47it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078463, 0.084504, 0.083873, 0.053618
Valid average loss UNet                 (all)                : 0.300458

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.121754, 0.646284, 1.919047
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.273691, 0.708494, 0.888748
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.454858, 1.000847, 1.040004
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.277381, 0.987799, 1.469446
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.410872, 1.190843, 1.315383
Valid average loss all      (Triplet)                 : 0.326689

== Recognize ==
Valid average loss Recognize     : 0.420535
Valid average accuracy drums     : 96.000000 %
Valid average accuracy bass      : 89.000000 %
Valid average accuracy piano     : 82.500000 %
Valid average accuracy guitar    : 58.000000 %
Valid average accuracy residuals : 92.000000 %

== Valid average loss all : 0.453204

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.20291781425476 sec. =
Valid knn accuracy drums     : 65.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.097744703292847 sec. =
Valid knn accuracy bass      : 15.92741935483871%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.396431684494019 sec. =
Valid knn accuracy piano     : 31.8359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.0045645236969 sec. =
Valid knn accuracy guitar    : 36.830357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.98402214050293 sec. =
Valid knn accuracy residuals : 63.63636363636363%

Valid knn accuracy average   : 42.6460155268119%

                                                                      [AEpoch 10: 100%|██████████| 1000/1000 [1:01:17<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.435, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.417, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.449, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.322, Train/loss_recog_epoch=0.417]Epoch 10: 100%|██████████| 1000/1000 [1:01:17<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.435, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.417, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082207, 0.082111, 0.082316, 0.064411
Train average loss UNet                 (all)                : 0.311045

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.274433, 1.026756, 1.918896
Train average loss bass     (Triplet, dist_p, dist_n) : 0.404016, 0.869413, 0.970099
Train average loss piano    (Triplet, dist_p, dist_n) : 0.297149, 0.749992, 0.954156
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.279793, 0.878061, 1.228387
Train average loss residuals(Triplet, dist_p, dist_n) : 0.332605, 1.144995, 1.602711
Train average loss all      (Triplet)                 : 0.317057

== Recognize ==
Train average loss Recognize     : 0.404700
Train average accuracy drums     : 95.544998 %
Train average accuracy bass      : 88.915001 %
Train average accuracy piano     : 77.875000 %
Train average accuracy guitar    : 80.075005 %
Train average accuracy residuals : 87.695000 %

== Train average loss all : 0.436405

Epoch 10:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.435, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.417, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]             Epoch 11:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.435, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.417, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:   5%|▌         | 50/1000 [03:00<57:02,  0.28it/s, v_num=0, Train/loss_all_step=0.435, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.417, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:   5%|▌         | 50/1000 [03:00<57:02,  0.28it/s, v_num=0, Train/loss_all_step=0.459, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.435, Train/loss_recog_step=0.416, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  10%|█         | 100/1000 [05:59<53:51,  0.28it/s, v_num=0, Train/loss_all_step=0.459, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.435, Train/loss_recog_step=0.416, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  10%|█         | 100/1000 [05:59<53:51,  0.28it/s, v_num=0, Train/loss_all_step=0.467, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.206, Train/loss_recog_step=0.446, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  15%|█▌        | 150/1000 [08:53<50:23,  0.28it/s, v_num=0, Train/loss_all_step=0.467, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.206, Train/loss_recog_step=0.446, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  15%|█▌        | 150/1000 [08:53<50:23,  0.28it/s, v_num=0, Train/loss_all_step=0.414, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.467, Train/loss_recog_step=0.368, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  20%|██        | 200/1000 [11:49<47:18,  0.28it/s, v_num=0, Train/loss_all_step=0.414, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.467, Train/loss_recog_step=0.368, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  20%|██        | 200/1000 [11:49<47:18,  0.28it/s, v_num=0, Train/loss_all_step=0.474, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.493, Train/loss_recog_step=0.425, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  25%|██▌       | 250/1000 [14:40<44:02,  0.28it/s, v_num=0, Train/loss_all_step=0.474, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.493, Train/loss_recog_step=0.425, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  25%|██▌       | 250/1000 [14:40<44:02,  0.28it/s, v_num=0, Train/loss_all_step=0.416, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.356, Train/loss_recog_step=0.380, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  30%|███       | 300/1000 [17:29<40:48,  0.29it/s, v_num=0, Train/loss_all_step=0.416, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.356, Train/loss_recog_step=0.380, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  30%|███       | 300/1000 [17:29<40:48,  0.29it/s, v_num=0, Train/loss_all_step=0.479, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.355, Train/loss_recog_step=0.443, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  35%|███▌      | 350/1000 [20:14<37:36,  0.29it/s, v_num=0, Train/loss_all_step=0.479, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.355, Train/loss_recog_step=0.443, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  35%|███▌      | 350/1000 [20:14<37:36,  0.29it/s, v_num=0, Train/loss_all_step=0.450, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=0.438, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  40%|████      | 400/1000 [23:02<34:34,  0.29it/s, v_num=0, Train/loss_all_step=0.450, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=0.438, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  40%|████      | 400/1000 [23:02<34:34,  0.29it/s, v_num=0, Train/loss_all_step=0.422, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=0.410, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  45%|████▌     | 450/1000 [25:54<31:39,  0.29it/s, v_num=0, Train/loss_all_step=0.422, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=0.410, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  45%|████▌     | 450/1000 [25:54<31:39,  0.29it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.219, Train/loss_recog_step=0.425, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  50%|█████     | 500/1000 [28:48<28:48,  0.29it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.219, Train/loss_recog_step=0.425, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  50%|█████     | 500/1000 [28:48<28:48,  0.29it/s, v_num=0, Train/loss_all_step=0.441, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=0.422, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  55%|█████▌    | 550/1000 [31:41<25:55,  0.29it/s, v_num=0, Train/loss_all_step=0.441, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=0.422, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  55%|█████▌    | 550/1000 [31:41<25:55,  0.29it/s, v_num=0, Train/loss_all_step=0.467, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.260, Train/loss_recog_step=0.441, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  60%|██████    | 600/1000 [34:35<23:03,  0.29it/s, v_num=0, Train/loss_all_step=0.467, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.260, Train/loss_recog_step=0.441, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  60%|██████    | 600/1000 [34:35<23:03,  0.29it/s, v_num=0, Train/loss_all_step=0.342, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.258, Train/loss_recog_step=0.316, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  65%|██████▌   | 650/1000 [37:31<20:12,  0.29it/s, v_num=0, Train/loss_all_step=0.342, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.258, Train/loss_recog_step=0.316, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  65%|██████▌   | 650/1000 [37:31<20:12,  0.29it/s, v_num=0, Train/loss_all_step=0.424, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=0.386, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  70%|███████   | 700/1000 [40:25<17:19,  0.29it/s, v_num=0, Train/loss_all_step=0.424, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=0.386, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  70%|███████   | 700/1000 [40:25<17:19,  0.29it/s, v_num=0, Train/loss_all_step=0.545, Train/loss_unet_all_step=0.260, Train/loss_triplet_all_step=0.229, Train/loss_recog_step=0.522, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  75%|███████▌  | 750/1000 [43:20<14:26,  0.29it/s, v_num=0, Train/loss_all_step=0.545, Train/loss_unet_all_step=0.260, Train/loss_triplet_all_step=0.229, Train/loss_recog_step=0.522, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  75%|███████▌  | 750/1000 [43:20<14:26,  0.29it/s, v_num=0, Train/loss_all_step=0.411, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.285, Train/loss_recog_step=0.383, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  80%|████████  | 800/1000 [46:16<11:34,  0.29it/s, v_num=0, Train/loss_all_step=0.411, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.285, Train/loss_recog_step=0.383, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  80%|████████  | 800/1000 [46:16<11:34,  0.29it/s, v_num=0, Train/loss_all_step=0.453, Train/loss_unet_all_step=0.248, Train/loss_triplet_all_step=0.0974, Train/loss_recog_step=0.443, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  85%|████████▌ | 850/1000 [49:04<08:39,  0.29it/s, v_num=0, Train/loss_all_step=0.453, Train/loss_unet_all_step=0.248, Train/loss_triplet_all_step=0.0974, Train/loss_recog_step=0.443, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  85%|████████▌ | 850/1000 [49:04<08:39,  0.29it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.373, Train/loss_recog_step=0.358, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405] Epoch 11:  90%|█████████ | 900/1000 [51:51<05:45,  0.29it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.373, Train/loss_recog_step=0.358, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  90%|█████████ | 900/1000 [51:51<05:45,  0.29it/s, v_num=0, Train/loss_all_step=0.424, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=0.390, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  95%|█████████▌| 950/1000 [54:36<02:52,  0.29it/s, v_num=0, Train/loss_all_step=0.424, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=0.390, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11:  95%|█████████▌| 950/1000 [54:36<02:52,  0.29it/s, v_num=0, Train/loss_all_step=0.459, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.416, Train/loss_recog_step=0.417, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11: 100%|██████████| 1000/1000 [57:33<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.459, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.416, Train/loss_recog_step=0.417, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11: 100%|██████████| 1000/1000 [57:33<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.497, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.257, Train/loss_recog_step=0.471, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.348, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.421, Valid/knn_avr=0.426, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:20<00:00,  0.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:13<00:00,  0.58it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.55it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.52it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:13<00:00,  0.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078484, 0.084528, 0.083904, 0.053284
Valid average loss UNet                 (all)                : 0.300200

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.130806, 0.640934, 1.949711
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.359369, 0.705660, 0.812798
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.414611, 1.036096, 1.141304
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.172222, 1.053482, 1.736561
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.499062, 1.360636, 1.413278
Valid average loss all      (Triplet)                 : 0.309947

== Recognize ==
Valid average loss Recognize     : 0.418809
Valid average accuracy drums     : 94.500000 %
Valid average accuracy bass      : 89.500000 %
Valid average accuracy piano     : 80.000000 %
Valid average accuracy guitar    : 68.000000 %
Valid average accuracy residuals : 89.000000 %

== Valid average loss all : 0.449803

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.696102619171143 sec. =
Valid knn accuracy drums     : 68.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.935481548309326 sec. =
Valid knn accuracy bass      : 14.717741935483872%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.77535104751587 sec. =
Valid knn accuracy piano     : 31.25%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.470998525619507 sec. =
Valid knn accuracy guitar    : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.185869216918945 sec. =
Valid knn accuracy residuals : 62.272727272727266%

Valid knn accuracy average   : 44.40624601555527%

                                                                      [AEpoch 11: 100%|██████████| 1000/1000 [1:01:01<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.497, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.257, Train/loss_recog_step=0.471, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.436, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.405]Epoch 11: 100%|██████████| 1000/1000 [1:01:01<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.497, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.257, Train/loss_recog_step=0.471, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082191, 0.082099, 0.082298, 0.064959
Train average loss UNet                 (all)                : 0.311547

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.268910, 1.058312, 2.022406
Train average loss bass     (Triplet, dist_p, dist_n) : 0.397637, 0.871744, 0.983852
Train average loss piano    (Triplet, dist_p, dist_n) : 0.295779, 0.761886, 0.974294
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.272747, 0.898645, 1.296506
Train average loss residuals(Triplet, dist_p, dist_n) : 0.326460, 1.162528, 1.660954
Train average loss all      (Triplet)                 : 0.313015

== Recognize ==
Train average loss Recognize     : 0.398701
Train average accuracy drums     : 95.910004 %
Train average accuracy bass      : 88.974998 %
Train average accuracy piano     : 78.074997 %
Train average accuracy guitar    : 80.815002 %
Train average accuracy residuals : 88.260002 %

== Train average loss all : 0.430002

Epoch 11:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.497, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.257, Train/loss_recog_step=0.471, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]             Epoch 12:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.497, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.257, Train/loss_recog_step=0.471, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:   5%|▌         | 50/1000 [03:02<57:52,  0.27it/s, v_num=0, Train/loss_all_step=0.497, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.257, Train/loss_recog_step=0.471, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:   5%|▌         | 50/1000 [03:02<57:52,  0.27it/s, v_num=0, Train/loss_all_step=0.459, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.373, Train/loss_recog_step=0.422, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  10%|█         | 100/1000 [06:01<54:10,  0.28it/s, v_num=0, Train/loss_all_step=0.459, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.373, Train/loss_recog_step=0.422, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  10%|█         | 100/1000 [06:01<54:10,  0.28it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.306, Train/loss_recog_step=0.408, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  15%|█▌        | 150/1000 [08:55<50:36,  0.28it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.306, Train/loss_recog_step=0.408, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  15%|█▌        | 150/1000 [08:55<50:36,  0.28it/s, v_num=0, Train/loss_all_step=0.409, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.558, Train/loss_recog_step=0.353, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  20%|██        | 200/1000 [11:52<47:30,  0.28it/s, v_num=0, Train/loss_all_step=0.409, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.558, Train/loss_recog_step=0.353, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  20%|██        | 200/1000 [11:52<47:30,  0.28it/s, v_num=0, Train/loss_all_step=0.458, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.519, Train/loss_recog_step=0.406, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  25%|██▌       | 250/1000 [14:48<44:25,  0.28it/s, v_num=0, Train/loss_all_step=0.458, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.519, Train/loss_recog_step=0.406, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  25%|██▌       | 250/1000 [14:48<44:25,  0.28it/s, v_num=0, Train/loss_all_step=0.449, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.290, Train/loss_recog_step=0.420, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  30%|███       | 300/1000 [17:43<41:21,  0.28it/s, v_num=0, Train/loss_all_step=0.449, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.290, Train/loss_recog_step=0.420, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  30%|███       | 300/1000 [17:43<41:21,  0.28it/s, v_num=0, Train/loss_all_step=0.403, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.272, Train/loss_recog_step=0.376, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  35%|███▌      | 350/1000 [20:33<38:10,  0.28it/s, v_num=0, Train/loss_all_step=0.403, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.272, Train/loss_recog_step=0.376, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  35%|███▌      | 350/1000 [20:33<38:10,  0.28it/s, v_num=0, Train/loss_all_step=0.552, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.534, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  40%|████      | 400/1000 [23:15<34:53,  0.29it/s, v_num=0, Train/loss_all_step=0.552, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.534, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  40%|████      | 400/1000 [23:15<34:53,  0.29it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.314, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=0.421, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  45%|████▌     | 450/1000 [26:01<31:49,  0.29it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.314, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=0.421, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  45%|████▌     | 450/1000 [26:01<31:49,  0.29it/s, v_num=0, Train/loss_all_step=0.460, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=0.440, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  50%|█████     | 500/1000 [28:53<28:53,  0.29it/s, v_num=0, Train/loss_all_step=0.460, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=0.440, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  50%|█████     | 500/1000 [28:53<28:53,  0.29it/s, v_num=0, Train/loss_all_step=0.455, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.199, Train/loss_recog_step=0.435, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  55%|█████▌    | 550/1000 [31:51<26:03,  0.29it/s, v_num=0, Train/loss_all_step=0.455, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.199, Train/loss_recog_step=0.435, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  55%|█████▌    | 550/1000 [31:51<26:03,  0.29it/s, v_num=0, Train/loss_all_step=0.360, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.222, Train/loss_recog_step=0.338, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  60%|██████    | 600/1000 [34:46<23:10,  0.29it/s, v_num=0, Train/loss_all_step=0.360, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.222, Train/loss_recog_step=0.338, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  60%|██████    | 600/1000 [34:46<23:10,  0.29it/s, v_num=0, Train/loss_all_step=0.378, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.349, Train/loss_recog_step=0.343, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  65%|██████▌   | 650/1000 [37:43<20:18,  0.29it/s, v_num=0, Train/loss_all_step=0.378, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.349, Train/loss_recog_step=0.343, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  65%|██████▌   | 650/1000 [37:43<20:18,  0.29it/s, v_num=0, Train/loss_all_step=0.407, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.374, Train/loss_recog_step=0.370, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  70%|███████   | 700/1000 [40:40<17:26,  0.29it/s, v_num=0, Train/loss_all_step=0.407, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.374, Train/loss_recog_step=0.370, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  70%|███████   | 700/1000 [40:40<17:26,  0.29it/s, v_num=0, Train/loss_all_step=0.574, Train/loss_unet_all_step=0.265, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=0.559, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  75%|███████▌  | 750/1000 [43:37<14:32,  0.29it/s, v_num=0, Train/loss_all_step=0.574, Train/loss_unet_all_step=0.265, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=0.559, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  75%|███████▌  | 750/1000 [43:37<14:32,  0.29it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=0.375, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  80%|████████  | 800/1000 [46:32<11:38,  0.29it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=0.375, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  80%|████████  | 800/1000 [46:32<11:38,  0.29it/s, v_num=0, Train/loss_all_step=0.484, Train/loss_unet_all_step=0.247, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.469, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  85%|████████▌ | 850/1000 [49:27<08:43,  0.29it/s, v_num=0, Train/loss_all_step=0.484, Train/loss_unet_all_step=0.247, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.469, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  85%|████████▌ | 850/1000 [49:27<08:43,  0.29it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.418, Train/loss_recog_step=0.353, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  90%|█████████ | 900/1000 [52:25<05:49,  0.29it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.418, Train/loss_recog_step=0.353, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  90%|█████████ | 900/1000 [52:25<05:49,  0.29it/s, v_num=0, Train/loss_all_step=0.386, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.220, Train/loss_recog_step=0.364, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  95%|█████████▌| 950/1000 [55:15<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.386, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.220, Train/loss_recog_step=0.364, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12:  95%|█████████▌| 950/1000 [55:15<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.547, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.489, Train/loss_recog_step=0.498, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12: 100%|██████████| 1000/1000 [58:00<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.547, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.489, Train/loss_recog_step=0.498, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12: 100%|██████████| 1000/1000 [58:00<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.275, Train/loss_recog_step=0.448, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.0688, Valid/loss_recog_step=0.435, Valid/loss_all_epoch=0.450, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.419, Valid/knn_avr=0.444, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:13<00:00,  0.58it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:13<00:00,  0.58it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.57it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:13<00:00,  0.53it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:12<00:00,  0.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078411, 0.084455, 0.083799, 0.051535
Valid average loss UNet                 (all)                : 0.298201

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.095871, 0.685878, 1.920210
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.251300, 0.545354, 0.660976
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.356614, 0.890840, 1.085569
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.245091, 1.021426, 1.553892
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.424306, 1.213779, 1.351886
Valid average loss all      (Triplet)                 : 0.266860

== Recognize ==
Valid average loss Recognize     : 0.445824
Valid average accuracy drums     : 94.000000 %
Valid average accuracy bass      : 85.000000 %
Valid average accuracy piano     : 80.500000 %
Valid average accuracy guitar    : 60.000004 %
Valid average accuracy residuals : 89.500000 %

== Valid average loss all : 0.472510

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.46753978729248 sec. =
Valid knn accuracy drums     : 70.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.490277528762817 sec. =
Valid knn accuracy bass      : 15.92741935483871%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.174138069152832 sec. =
Valid knn accuracy piano     : 36.9140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.151951313018799 sec. =
Valid knn accuracy guitar    : 42.857142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.139159202575684 sec. =
Valid knn accuracy residuals : 61.36363636363637%

Valid knn accuracy average   : 45.586365258601845%

                                                                      [AEpoch 12: 100%|██████████| 1000/1000 [1:01:17<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.275, Train/loss_recog_step=0.448, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.430, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.313, Train/loss_recog_epoch=0.399]Epoch 12: 100%|██████████| 1000/1000 [1:01:17<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.275, Train/loss_recog_step=0.448, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082174, 0.082083, 0.082282, 0.065227
Train average loss UNet                 (all)                : 0.311767

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.261420, 1.073858, 2.090778
Train average loss bass     (Triplet, dist_p, dist_n) : 0.413226, 0.900499, 1.003641
Train average loss piano    (Triplet, dist_p, dist_n) : 0.311537, 0.803115, 1.032304
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.269255, 0.894746, 1.325022
Train average loss residuals(Triplet, dist_p, dist_n) : 0.325738, 1.195615, 1.712099
Train average loss all      (Triplet)                 : 0.316660

== Recognize ==
Train average loss Recognize     : 0.392962
Train average accuracy drums     : 95.764999 %
Train average accuracy bass      : 89.540001 %
Train average accuracy piano     : 79.419998 %
Train average accuracy guitar    : 80.435005 %
Train average accuracy residuals : 88.625000 %

== Train average loss all : 0.424628

Epoch 12:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.275, Train/loss_recog_step=0.448, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]             Epoch 13:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.275, Train/loss_recog_step=0.448, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:   5%|▌         | 50/1000 [03:02<57:38,  0.27it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.275, Train/loss_recog_step=0.448, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:   5%|▌         | 50/1000 [03:02<57:38,  0.27it/s, v_num=0, Train/loss_all_step=0.465, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.344, Train/loss_recog_step=0.431, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  10%|█         | 100/1000 [05:59<53:51,  0.28it/s, v_num=0, Train/loss_all_step=0.465, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.344, Train/loss_recog_step=0.431, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  10%|█         | 100/1000 [05:59<53:51,  0.28it/s, v_num=0, Train/loss_all_step=0.500, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.299, Train/loss_recog_step=0.470, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  15%|█▌        | 150/1000 [08:54<50:28,  0.28it/s, v_num=0, Train/loss_all_step=0.500, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.299, Train/loss_recog_step=0.470, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  15%|█▌        | 150/1000 [08:54<50:28,  0.28it/s, v_num=0, Train/loss_all_step=0.389, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.454, Train/loss_recog_step=0.344, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  20%|██        | 200/1000 [11:49<47:19,  0.28it/s, v_num=0, Train/loss_all_step=0.389, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.454, Train/loss_recog_step=0.344, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  20%|██        | 200/1000 [11:49<47:19,  0.28it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.355, Train/loss_recog_step=0.440, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  25%|██▌       | 250/1000 [14:46<44:19,  0.28it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.355, Train/loss_recog_step=0.440, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  25%|██▌       | 250/1000 [14:46<44:19,  0.28it/s, v_num=0, Train/loss_all_step=0.430, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.271, Train/loss_recog_step=0.403, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  30%|███       | 300/1000 [17:44<41:24,  0.28it/s, v_num=0, Train/loss_all_step=0.430, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.271, Train/loss_recog_step=0.403, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  30%|███       | 300/1000 [17:44<41:24,  0.28it/s, v_num=0, Train/loss_all_step=0.557, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.341, Train/loss_recog_step=0.523, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  35%|███▌      | 350/1000 [20:38<38:20,  0.28it/s, v_num=0, Train/loss_all_step=0.557, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.341, Train/loss_recog_step=0.523, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  35%|███▌      | 350/1000 [20:38<38:20,  0.28it/s, v_num=0, Train/loss_all_step=0.472, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.220, Train/loss_recog_step=0.450, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  40%|████      | 400/1000 [23:30<35:15,  0.28it/s, v_num=0, Train/loss_all_step=0.472, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.220, Train/loss_recog_step=0.450, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  40%|████      | 400/1000 [23:30<35:15,  0.28it/s, v_num=0, Train/loss_all_step=0.377, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=0.361, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  45%|████▌     | 450/1000 [26:22<32:14,  0.28it/s, v_num=0, Train/loss_all_step=0.377, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=0.361, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  45%|████▌     | 450/1000 [26:22<32:14,  0.28it/s, v_num=0, Train/loss_all_step=0.427, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.415, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  50%|█████     | 500/1000 [29:08<29:08,  0.29it/s, v_num=0, Train/loss_all_step=0.427, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.415, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  50%|█████     | 500/1000 [29:08<29:08,  0.29it/s, v_num=0, Train/loss_all_step=0.396, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.382, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  55%|█████▌    | 550/1000 [31:55<26:07,  0.29it/s, v_num=0, Train/loss_all_step=0.396, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.382, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  55%|█████▌    | 550/1000 [31:55<26:07,  0.29it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.310, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.379, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  60%|██████    | 600/1000 [34:45<23:10,  0.29it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.310, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.379, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  60%|██████    | 600/1000 [34:45<23:10,  0.29it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.254, Train/loss_recog_step=0.322, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  65%|██████▌   | 650/1000 [37:40<20:17,  0.29it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.254, Train/loss_recog_step=0.322, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  65%|██████▌   | 650/1000 [37:40<20:17,  0.29it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.299, Train/loss_recog_step=0.369, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  70%|███████   | 700/1000 [40:37<17:24,  0.29it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.299, Train/loss_recog_step=0.369, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  70%|███████   | 700/1000 [40:37<17:24,  0.29it/s, v_num=0, Train/loss_all_step=0.553, Train/loss_unet_all_step=0.268, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=0.534, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  75%|███████▌  | 750/1000 [43:32<14:30,  0.29it/s, v_num=0, Train/loss_all_step=0.553, Train/loss_unet_all_step=0.268, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=0.534, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  75%|███████▌  | 750/1000 [43:32<14:30,  0.29it/s, v_num=0, Train/loss_all_step=0.374, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=0.357, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  80%|████████  | 800/1000 [46:27<11:36,  0.29it/s, v_num=0, Train/loss_all_step=0.374, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=0.357, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  80%|████████  | 800/1000 [46:27<11:36,  0.29it/s, v_num=0, Train/loss_all_step=0.382, Train/loss_unet_all_step=0.255, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.362, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  85%|████████▌ | 850/1000 [49:21<08:42,  0.29it/s, v_num=0, Train/loss_all_step=0.382, Train/loss_unet_all_step=0.255, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.362, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  85%|████████▌ | 850/1000 [49:21<08:42,  0.29it/s, v_num=0, Train/loss_all_step=0.404, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=0.366, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  90%|█████████ | 900/1000 [52:18<05:48,  0.29it/s, v_num=0, Train/loss_all_step=0.404, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=0.366, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  90%|█████████ | 900/1000 [52:18<05:48,  0.29it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.204, Train/loss_recog_step=0.370, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  95%|█████████▌| 950/1000 [55:13<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.204, Train/loss_recog_step=0.370, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13:  95%|█████████▌| 950/1000 [55:13<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.512, Train/loss_unet_all_step=0.307, Train/loss_triplet_all_step=0.481, Train/loss_recog_step=0.464, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13: 100%|██████████| 1000/1000 [58:07<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.512, Train/loss_unet_all_step=0.307, Train/loss_triplet_all_step=0.481, Train/loss_recog_step=0.464, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13: 100%|██████████| 1000/1000 [58:07<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.502, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.483, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.0734, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.446, Valid/knn_avr=0.456, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.56it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:13<00:00,  0.51it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:12<00:00,  0.55it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078468, 0.084497, 0.083827, 0.054743
Valid average loss UNet                 (all)                : 0.301535

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.093044, 0.873147, 2.093506
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.343255, 0.754122, 0.903756
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.396485, 1.041799, 1.200280
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.428562, 1.365882, 1.732318
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.543895, 1.278758, 1.256463
Valid average loss all      (Triplet)                 : 0.363944

== Recognize ==
Valid average loss Recognize     : 0.436077
Valid average accuracy drums     : 93.500000 %
Valid average accuracy bass      : 89.000000 %
Valid average accuracy piano     : 72.500000 %
Valid average accuracy guitar    : 61.000000 %
Valid average accuracy residuals : 93.000000 %

== Valid average loss all : 0.472472

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.321682929992676 sec. =
Valid knn accuracy drums     : 69.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.4596688747406 sec. =
Valid knn accuracy bass      : 16.33064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.34617805480957 sec. =
Valid knn accuracy piano     : 35.15625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.00812578201294 sec. =
Valid knn accuracy guitar    : 39.955357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.365411281585693 sec. =
Valid knn accuracy residuals : 57.95454545454546%

Valid knn accuracy average   : 43.792403029999456%

                                                                      [AEpoch 13: 100%|██████████| 1000/1000 [1:01:31<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.502, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.483, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.425, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.317, Train/loss_recog_epoch=0.393]Epoch 13: 100%|██████████| 1000/1000 [1:01:31<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.502, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.483, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082150, 0.082050, 0.082254, 0.064749
Train average loss UNet                 (all)                : 0.311203

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.259213, 1.094195, 2.165689
Train average loss bass     (Triplet, dist_p, dist_n) : 0.402832, 0.886821, 0.994023
Train average loss piano    (Triplet, dist_p, dist_n) : 0.299970, 0.789592, 1.026706
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.272698, 0.903066, 1.327549
Train average loss residuals(Triplet, dist_p, dist_n) : 0.315105, 1.177924, 1.709055
Train average loss all      (Triplet)                 : 0.309777

== Recognize ==
Train average loss Recognize     : 0.385047
Train average accuracy drums     : 96.135002 %
Train average accuracy bass      : 89.684998 %
Train average accuracy piano     : 79.750000 %
Train average accuracy guitar    : 81.425003 %
Train average accuracy residuals : 88.489998 %

== Train average loss all : 0.416025

Epoch 13:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.502, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.483, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]             Epoch 14:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.502, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.483, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:   5%|▌         | 50/1000 [02:55<55:40,  0.28it/s, v_num=0, Train/loss_all_step=0.502, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.483, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:   5%|▌         | 50/1000 [02:55<55:40,  0.28it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.310, Train/loss_recog_step=0.360, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  10%|█         | 100/1000 [05:43<51:31,  0.29it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.310, Train/loss_recog_step=0.360, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  10%|█         | 100/1000 [05:43<51:31,  0.29it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.219, Train/loss_recog_step=0.377, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  15%|█▌        | 150/1000 [08:38<48:55,  0.29it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.219, Train/loss_recog_step=0.377, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  15%|█▌        | 150/1000 [08:38<48:55,  0.29it/s, v_num=0, Train/loss_all_step=0.393, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.443, Train/loss_recog_step=0.349, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  20%|██        | 200/1000 [11:33<46:14,  0.29it/s, v_num=0, Train/loss_all_step=0.393, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.443, Train/loss_recog_step=0.349, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  20%|██        | 200/1000 [11:33<46:14,  0.29it/s, v_num=0, Train/loss_all_step=0.467, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.329, Train/loss_recog_step=0.435, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  25%|██▌       | 250/1000 [14:32<43:37,  0.29it/s, v_num=0, Train/loss_all_step=0.467, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.329, Train/loss_recog_step=0.435, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  25%|██▌       | 250/1000 [14:32<43:37,  0.29it/s, v_num=0, Train/loss_all_step=0.419, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.286, Train/loss_recog_step=0.390, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  30%|███       | 300/1000 [17:29<40:48,  0.29it/s, v_num=0, Train/loss_all_step=0.419, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.286, Train/loss_recog_step=0.390, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  30%|███       | 300/1000 [17:29<40:48,  0.29it/s, v_num=0, Train/loss_all_step=0.467, Train/loss_unet_all_step=0.278, Train/loss_triplet_all_step=0.350, Train/loss_recog_step=0.432, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  35%|███▌      | 350/1000 [20:25<37:56,  0.29it/s, v_num=0, Train/loss_all_step=0.467, Train/loss_unet_all_step=0.278, Train/loss_triplet_all_step=0.350, Train/loss_recog_step=0.432, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  35%|███▌      | 350/1000 [20:25<37:56,  0.29it/s, v_num=0, Train/loss_all_step=0.474, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=0.459, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  40%|████      | 400/1000 [23:14<34:52,  0.29it/s, v_num=0, Train/loss_all_step=0.474, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=0.459, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  40%|████      | 400/1000 [23:14<34:52,  0.29it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=0.368, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  45%|████▌     | 450/1000 [26:12<32:02,  0.29it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=0.368, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  45%|████▌     | 450/1000 [26:12<32:02,  0.29it/s, v_num=0, Train/loss_all_step=0.462, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.0808, Train/loss_recog_step=0.454, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  50%|█████     | 500/1000 [29:10<29:10,  0.29it/s, v_num=0, Train/loss_all_step=0.462, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.0808, Train/loss_recog_step=0.454, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  50%|█████     | 500/1000 [29:10<29:10,  0.29it/s, v_num=0, Train/loss_all_step=0.361, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.347, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385] Epoch 14:  55%|█████▌    | 550/1000 [32:05<26:15,  0.29it/s, v_num=0, Train/loss_all_step=0.361, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.347, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  55%|█████▌    | 550/1000 [32:05<26:15,  0.29it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.375, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  60%|██████    | 600/1000 [34:55<23:17,  0.29it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.375, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  60%|██████    | 600/1000 [34:55<23:17,  0.29it/s, v_num=0, Train/loss_all_step=0.278, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.257, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  65%|██████▌   | 650/1000 [37:44<20:19,  0.29it/s, v_num=0, Train/loss_all_step=0.278, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.257, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  65%|██████▌   | 650/1000 [37:44<20:19,  0.29it/s, v_num=0, Train/loss_all_step=0.426, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.317, Train/loss_recog_step=0.395, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  70%|███████   | 700/1000 [40:34<17:23,  0.29it/s, v_num=0, Train/loss_all_step=0.426, Train/loss_unet_all_step=0.364, Train/loss_triplet_all_step=0.317, Train/loss_recog_step=0.395, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  70%|███████   | 700/1000 [40:34<17:23,  0.29it/s, v_num=0, Train/loss_all_step=0.528, Train/loss_unet_all_step=0.271, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.510, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  75%|███████▌  | 750/1000 [43:31<14:30,  0.29it/s, v_num=0, Train/loss_all_step=0.528, Train/loss_unet_all_step=0.271, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.510, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  75%|███████▌  | 750/1000 [43:31<14:30,  0.29it/s, v_num=0, Train/loss_all_step=0.397, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=0.380, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  80%|████████  | 800/1000 [46:28<11:37,  0.29it/s, v_num=0, Train/loss_all_step=0.397, Train/loss_unet_all_step=0.353, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=0.380, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  80%|████████  | 800/1000 [46:28<11:37,  0.29it/s, v_num=0, Train/loss_all_step=0.484, Train/loss_unet_all_step=0.256, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=0.471, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  85%|████████▌ | 850/1000 [49:27<08:43,  0.29it/s, v_num=0, Train/loss_all_step=0.484, Train/loss_unet_all_step=0.256, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=0.471, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  85%|████████▌ | 850/1000 [49:27<08:43,  0.29it/s, v_num=0, Train/loss_all_step=0.369, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.314, Train/loss_recog_step=0.338, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  90%|█████████ | 900/1000 [52:23<05:49,  0.29it/s, v_num=0, Train/loss_all_step=0.369, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.314, Train/loss_recog_step=0.338, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  90%|█████████ | 900/1000 [52:23<05:49,  0.29it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.243, Train/loss_recog_step=0.358, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  95%|█████████▌| 950/1000 [55:19<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.243, Train/loss_recog_step=0.358, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14:  95%|█████████▌| 950/1000 [55:19<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.471, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.406, Train/loss_recog_step=0.430, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14: 100%|██████████| 1000/1000 [58:16<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.471, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.406, Train/loss_recog_step=0.430, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14: 100%|██████████| 1000/1000 [58:16<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.279, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.451, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.381, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.436, Valid/knn_avr=0.438, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:20<00:00,  0.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.55it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.51it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.47it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:14<00:00,  0.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078460, 0.084509, 0.083865, 0.056210
Valid average loss UNet                 (all)                : 0.303045

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.127592, 1.133291, 2.318474
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.334724, 0.722678, 0.783047
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.504161, 1.109366, 1.130748
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.362712, 1.133833, 1.574627
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.348664, 1.150668, 1.517727
Valid average loss all      (Triplet)                 : 0.359651

== Recognize ==
Valid average loss Recognize     : 0.428644
Valid average accuracy drums     : 96.500000 %
Valid average accuracy bass      : 88.500000 %
Valid average accuracy piano     : 80.000000 %
Valid average accuracy guitar    : 65.500000 %
Valid average accuracy residuals : 88.500000 %

== Valid average loss all : 0.464609

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.829039096832275 sec. =
Valid knn accuracy drums     : 69.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.901249885559082 sec. =
Valid knn accuracy bass      : 14.919354838709678%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.433562755584717 sec. =
Valid knn accuracy piano     : 33.0078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.43327260017395 sec. =
Valid knn accuracy guitar    : 42.63392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.178274393081665 sec. =
Valid knn accuracy residuals : 60.68181818181818%

Valid knn accuracy average   : 44.16162629665216%

                                                                      [AEpoch 14: 100%|██████████| 1000/1000 [1:01:46<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.279, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.451, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.416, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.310, Train/loss_recog_epoch=0.385]Epoch 14: 100%|██████████| 1000/1000 [1:01:46<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.279, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.451, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082141, 0.082038, 0.082241, 0.064895
Train average loss UNet                 (all)                : 0.311315

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.257078, 1.119828, 2.221519
Train average loss bass     (Triplet, dist_p, dist_n) : 0.397957, 0.875712, 0.987842
Train average loss piano    (Triplet, dist_p, dist_n) : 0.289787, 0.779398, 1.047232
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.260187, 0.912415, 1.378032
Train average loss residuals(Triplet, dist_p, dist_n) : 0.315846, 1.210712, 1.758167
Train average loss all      (Triplet)                 : 0.304757

== Recognize ==
Train average loss Recognize     : 0.380570
Train average accuracy drums     : 96.084999 %
Train average accuracy bass      : 89.864998 %
Train average accuracy piano     : 80.575005 %
Train average accuracy guitar    : 81.774994 %
Train average accuracy residuals : 89.279999 %

== Train average loss all : 0.411046

Epoch 14:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.279, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.451, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]             Epoch 15:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.279, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.451, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:   5%|▌         | 50/1000 [02:59<56:44,  0.28it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.279, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.451, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:   5%|▌         | 50/1000 [02:59<56:44,  0.28it/s, v_num=0, Train/loss_all_step=0.464, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.314, Train/loss_recog_step=0.432, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  10%|█         | 100/1000 [05:51<52:45,  0.28it/s, v_num=0, Train/loss_all_step=0.464, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.314, Train/loss_recog_step=0.432, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  10%|█         | 100/1000 [05:51<52:45,  0.28it/s, v_num=0, Train/loss_all_step=0.455, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.238, Train/loss_recog_step=0.431, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  15%|█▌        | 150/1000 [08:41<49:15,  0.29it/s, v_num=0, Train/loss_all_step=0.455, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.238, Train/loss_recog_step=0.431, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  15%|█▌        | 150/1000 [08:41<49:15,  0.29it/s, v_num=0, Train/loss_all_step=0.372, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.357, Train/loss_recog_step=0.336, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  20%|██        | 200/1000 [11:28<45:54,  0.29it/s, v_num=0, Train/loss_all_step=0.372, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.357, Train/loss_recog_step=0.336, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  20%|██        | 200/1000 [11:28<45:54,  0.29it/s, v_num=0, Train/loss_all_step=0.498, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.295, Train/loss_recog_step=0.468, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  25%|██▌       | 250/1000 [14:23<43:11,  0.29it/s, v_num=0, Train/loss_all_step=0.498, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.295, Train/loss_recog_step=0.468, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  25%|██▌       | 250/1000 [14:23<43:11,  0.29it/s, v_num=0, Train/loss_all_step=0.407, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.279, Train/loss_recog_step=0.379, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  30%|███       | 300/1000 [17:19<40:24,  0.29it/s, v_num=0, Train/loss_all_step=0.407, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.279, Train/loss_recog_step=0.379, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  30%|███       | 300/1000 [17:19<40:24,  0.29it/s, v_num=0, Train/loss_all_step=0.475, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.241, Train/loss_recog_step=0.451, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  35%|███▌      | 350/1000 [20:12<37:31,  0.29it/s, v_num=0, Train/loss_all_step=0.475, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.241, Train/loss_recog_step=0.451, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  35%|███▌      | 350/1000 [20:12<37:31,  0.29it/s, v_num=0, Train/loss_all_step=0.487, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=0.472, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  40%|████      | 400/1000 [22:59<34:29,  0.29it/s, v_num=0, Train/loss_all_step=0.487, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=0.472, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  40%|████      | 400/1000 [22:59<34:29,  0.29it/s, v_num=0, Train/loss_all_step=0.398, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.383, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  45%|████▌     | 450/1000 [25:56<31:41,  0.29it/s, v_num=0, Train/loss_all_step=0.398, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.383, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  45%|████▌     | 450/1000 [25:56<31:41,  0.29it/s, v_num=0, Train/loss_all_step=0.406, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.143, Train/loss_recog_step=0.391, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  50%|█████     | 500/1000 [28:48<28:48,  0.29it/s, v_num=0, Train/loss_all_step=0.406, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.143, Train/loss_recog_step=0.391, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  50%|█████     | 500/1000 [28:48<28:48,  0.29it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.408, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  55%|█████▌    | 550/1000 [31:42<25:56,  0.29it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.408, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  55%|█████▌    | 550/1000 [31:42<25:56,  0.29it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.308, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.372, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  60%|██████    | 600/1000 [34:41<23:07,  0.29it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.308, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.372, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  60%|██████    | 600/1000 [34:41<23:07,  0.29it/s, v_num=0, Train/loss_all_step=0.335, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.235, Train/loss_recog_step=0.311, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  65%|██████▌   | 650/1000 [37:36<20:15,  0.29it/s, v_num=0, Train/loss_all_step=0.335, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.235, Train/loss_recog_step=0.311, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  65%|██████▌   | 650/1000 [37:36<20:15,  0.29it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.318, Train/loss_recog_step=0.389, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  70%|███████   | 700/1000 [40:26<17:19,  0.29it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.318, Train/loss_recog_step=0.389, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  70%|███████   | 700/1000 [40:26<17:19,  0.29it/s, v_num=0, Train/loss_all_step=0.524, Train/loss_unet_all_step=0.271, Train/loss_triplet_all_step=0.201, Train/loss_recog_step=0.504, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  75%|███████▌  | 750/1000 [43:14<14:24,  0.29it/s, v_num=0, Train/loss_all_step=0.524, Train/loss_unet_all_step=0.271, Train/loss_triplet_all_step=0.201, Train/loss_recog_step=0.504, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  75%|███████▌  | 750/1000 [43:14<14:24,  0.29it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.204, Train/loss_recog_step=0.362, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  80%|████████  | 800/1000 [46:05<11:31,  0.29it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.204, Train/loss_recog_step=0.362, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  80%|████████  | 800/1000 [46:05<11:31,  0.29it/s, v_num=0, Train/loss_all_step=0.375, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.063, Train/loss_recog_step=0.369, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  85%|████████▌ | 850/1000 [49:00<08:38,  0.29it/s, v_num=0, Train/loss_all_step=0.375, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.063, Train/loss_recog_step=0.369, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  85%|████████▌ | 850/1000 [49:00<08:38,  0.29it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.275, Train/loss_recog_step=0.296, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  90%|█████████ | 900/1000 [52:00<05:46,  0.29it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.275, Train/loss_recog_step=0.296, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  90%|█████████ | 900/1000 [52:00<05:46,  0.29it/s, v_num=0, Train/loss_all_step=0.342, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.249, Train/loss_recog_step=0.317, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  95%|█████████▌| 950/1000 [54:55<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.342, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.249, Train/loss_recog_step=0.317, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15:  95%|█████████▌| 950/1000 [54:55<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.498, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.422, Train/loss_recog_step=0.456, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15: 100%|██████████| 1000/1000 [57:51<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.498, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.422, Train/loss_recog_step=0.456, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15: 100%|██████████| 1000/1000 [57:51<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.511, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=0.492, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.309, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.429, Valid/knn_avr=0.442, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:20<00:00,  0.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:15<00:00,  0.50it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.53it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078447, 0.084449, 0.083816, 0.050058
Valid average loss UNet                 (all)                : 0.296770

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.134009, 0.784127, 2.120975
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.287768, 0.678277, 0.839924
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.395056, 1.099056, 1.175896
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.291490, 1.161434, 1.607012
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.434859, 1.162527, 1.350269
Valid average loss all      (Triplet)                 : 0.316513

== Recognize ==
Valid average loss Recognize     : 0.397541
Valid average accuracy drums     : 95.500000 %
Valid average accuracy bass      : 88.000000 %
Valid average accuracy piano     : 81.000000 %
Valid average accuracy guitar    : 66.500000 %
Valid average accuracy residuals : 93.500000 %

== Valid average loss all : 0.429192

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.164249420166016 sec. =
Valid knn accuracy drums     : 72.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.114558696746826 sec. =
Valid knn accuracy bass      : 13.911290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.22373342514038 sec. =
Valid knn accuracy piano     : 36.71875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.414649724960327 sec. =
Valid knn accuracy guitar    : 42.857142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.177019119262695 sec. =
Valid knn accuracy residuals : 62.95454545454545%

Valid knn accuracy average   : 45.76660659641901%

                                                                      [AEpoch 15: 100%|██████████| 1000/1000 [1:01:20<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.511, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=0.492, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.411, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.305, Train/loss_recog_epoch=0.381]Epoch 15: 100%|██████████| 1000/1000 [1:01:20<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.511, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=0.492, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082110, 0.082009, 0.082205, 0.064692
Train average loss UNet                 (all)                : 0.311017

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.249386, 1.106365, 2.222626
Train average loss bass     (Triplet, dist_p, dist_n) : 0.385711, 0.830423, 0.944874
Train average loss piano    (Triplet, dist_p, dist_n) : 0.290730, 0.779439, 1.045453
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.255931, 0.892815, 1.348406
Train average loss residuals(Triplet, dist_p, dist_n) : 0.307624, 1.180630, 1.737867
Train average loss all      (Triplet)                 : 0.297180

== Recognize ==
Train average loss Recognize     : 0.377337
Train average accuracy drums     : 96.224998 %
Train average accuracy bass      : 90.230003 %
Train average accuracy piano     : 80.205002 %
Train average accuracy guitar    : 81.500000 %
Train average accuracy residuals : 89.084999 %

== Train average loss all : 0.407056

Epoch 15:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.511, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=0.492, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]             Epoch 16:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.511, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=0.492, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:   5%|▌         | 50/1000 [03:02<57:51,  0.27it/s, v_num=0, Train/loss_all_step=0.511, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=0.492, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:   5%|▌         | 50/1000 [03:02<57:51,  0.27it/s, v_num=0, Train/loss_all_step=0.445, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.257, Train/loss_recog_step=0.419, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  10%|█         | 100/1000 [06:01<54:10,  0.28it/s, v_num=0, Train/loss_all_step=0.445, Train/loss_unet_all_step=0.352, Train/loss_triplet_all_step=0.257, Train/loss_recog_step=0.419, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  10%|█         | 100/1000 [06:01<54:10,  0.28it/s, v_num=0, Train/loss_all_step=0.426, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.237, Train/loss_recog_step=0.402, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  15%|█▌        | 150/1000 [08:58<50:49,  0.28it/s, v_num=0, Train/loss_all_step=0.426, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.237, Train/loss_recog_step=0.402, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  15%|█▌        | 150/1000 [08:58<50:49,  0.28it/s, v_num=0, Train/loss_all_step=0.375, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.346, Train/loss_recog_step=0.340, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  20%|██        | 200/1000 [11:52<47:31,  0.28it/s, v_num=0, Train/loss_all_step=0.375, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.346, Train/loss_recog_step=0.340, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  20%|██        | 200/1000 [11:52<47:31,  0.28it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.352, Train/loss_recog_step=0.350, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  25%|██▌       | 250/1000 [14:41<44:05,  0.28it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.352, Train/loss_recog_step=0.350, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  25%|██▌       | 250/1000 [14:41<44:05,  0.28it/s, v_num=0, Train/loss_all_step=0.401, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.322, Train/loss_recog_step=0.368, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  30%|███       | 300/1000 [17:28<40:47,  0.29it/s, v_num=0, Train/loss_all_step=0.401, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.322, Train/loss_recog_step=0.368, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  30%|███       | 300/1000 [17:28<40:47,  0.29it/s, v_num=0, Train/loss_all_step=0.473, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.225, Train/loss_recog_step=0.450, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  35%|███▌      | 350/1000 [20:23<37:51,  0.29it/s, v_num=0, Train/loss_all_step=0.473, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.225, Train/loss_recog_step=0.450, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  35%|███▌      | 350/1000 [20:23<37:51,  0.29it/s, v_num=0, Train/loss_all_step=0.480, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=0.466, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  40%|████      | 400/1000 [23:11<34:47,  0.29it/s, v_num=0, Train/loss_all_step=0.480, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=0.466, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  40%|████      | 400/1000 [23:11<34:47,  0.29it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.323, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.374, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  45%|████▌     | 450/1000 [26:05<31:53,  0.29it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.323, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.374, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  45%|████▌     | 450/1000 [26:05<31:53,  0.29it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.0976, Train/loss_recog_step=0.373, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  50%|█████     | 500/1000 [28:59<28:59,  0.29it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.0976, Train/loss_recog_step=0.373, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  50%|█████     | 500/1000 [28:59<28:59,  0.29it/s, v_num=0, Train/loss_all_step=0.414, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.399, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377] Epoch 16:  55%|█████▌    | 550/1000 [31:54<26:06,  0.29it/s, v_num=0, Train/loss_all_step=0.414, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.399, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  55%|█████▌    | 550/1000 [31:54<26:06,  0.29it/s, v_num=0, Train/loss_all_step=0.350, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.333, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  60%|██████    | 600/1000 [34:50<23:13,  0.29it/s, v_num=0, Train/loss_all_step=0.350, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.333, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  60%|██████    | 600/1000 [34:50<23:13,  0.29it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.229, Train/loss_recog_step=0.305, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  65%|██████▌   | 650/1000 [37:48<20:21,  0.29it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.229, Train/loss_recog_step=0.305, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  65%|██████▌   | 650/1000 [37:48<20:21,  0.29it/s, v_num=0, Train/loss_all_step=0.444, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.323, Train/loss_recog_step=0.412, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  70%|███████   | 700/1000 [40:47<17:28,  0.29it/s, v_num=0, Train/loss_all_step=0.444, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.323, Train/loss_recog_step=0.412, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  70%|███████   | 700/1000 [40:47<17:28,  0.29it/s, v_num=0, Train/loss_all_step=0.556, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.202, Train/loss_recog_step=0.535, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  75%|███████▌  | 750/1000 [43:41<14:33,  0.29it/s, v_num=0, Train/loss_all_step=0.556, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.202, Train/loss_recog_step=0.535, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  75%|███████▌  | 750/1000 [43:41<14:33,  0.29it/s, v_num=0, Train/loss_all_step=0.409, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.391, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  80%|████████  | 800/1000 [46:31<11:37,  0.29it/s, v_num=0, Train/loss_all_step=0.409, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.391, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  80%|████████  | 800/1000 [46:31<11:37,  0.29it/s, v_num=0, Train/loss_all_step=0.416, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.260, Train/loss_recog_step=0.390, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  85%|████████▌ | 850/1000 [49:17<08:41,  0.29it/s, v_num=0, Train/loss_all_step=0.416, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.260, Train/loss_recog_step=0.390, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  85%|████████▌ | 850/1000 [49:17<08:41,  0.29it/s, v_num=0, Train/loss_all_step=0.362, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.282, Train/loss_recog_step=0.334, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  90%|█████████ | 900/1000 [52:05<05:47,  0.29it/s, v_num=0, Train/loss_all_step=0.362, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.282, Train/loss_recog_step=0.334, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  90%|█████████ | 900/1000 [52:05<05:47,  0.29it/s, v_num=0, Train/loss_all_step=0.400, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.212, Train/loss_recog_step=0.378, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  95%|█████████▌| 950/1000 [55:00<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.400, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.212, Train/loss_recog_step=0.378, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16:  95%|█████████▌| 950/1000 [55:00<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.377, Train/loss_recog_step=0.409, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16: 100%|██████████| 1000/1000 [57:56<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.377, Train/loss_recog_step=0.409, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16: 100%|██████████| 1000/1000 [57:56<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.436, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.218, Train/loss_recog_step=0.415, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.284, Valid/loss_triplet_all_step=0.140, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.398, Valid/knn_avr=0.458, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:20<00:00,  0.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:15<00:00,  0.52it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.49it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:14<00:00,  0.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078422, 0.084357, 0.083833, 0.055249
Valid average loss UNet                 (all)                : 0.301861

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.109090, 0.953172, 2.067841
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.397502, 0.768107, 0.897874
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.468426, 1.113013, 1.247848
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.338580, 1.175930, 1.722844
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.429198, 1.275524, 1.485706
Valid average loss all      (Triplet)                 : 0.357002

== Recognize ==
Valid average loss Recognize     : 0.427889
Valid average accuracy drums     : 98.000000 %
Valid average accuracy bass      : 87.500000 %
Valid average accuracy piano     : 82.000000 %
Valid average accuracy guitar    : 62.000000 %
Valid average accuracy residuals : 90.500000 %

== Valid average loss all : 0.463589

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.464756488800049 sec. =
Valid knn accuracy drums     : 75.43478260869566%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.168970108032227 sec. =
Valid knn accuracy bass      : 14.31451612903226%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.251131534576416 sec. =
Valid knn accuracy piano     : 34.5703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.744877338409424 sec. =
Valid knn accuracy guitar    : 40.848214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.338573217391968 sec. =
Valid knn accuracy residuals : 62.95454545454545%

Valid knn accuracy average   : 45.62447419559753%

                                                                      [AEpoch 16: 100%|██████████| 1000/1000 [1:01:25<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.436, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.218, Train/loss_recog_step=0.415, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.297, Train/loss_recog_epoch=0.377]Epoch 16: 100%|██████████| 1000/1000 [1:01:25<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.436, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.218, Train/loss_recog_step=0.415, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082131, 0.082030, 0.082223, 0.064579
Train average loss UNet                 (all)                : 0.310963

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.235074, 1.095350, 2.216404
Train average loss bass     (Triplet, dist_p, dist_n) : 0.382239, 0.841964, 0.968207
Train average loss piano    (Triplet, dist_p, dist_n) : 0.285631, 0.788405, 1.083153
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.254359, 0.914496, 1.406520
Train average loss residuals(Triplet, dist_p, dist_n) : 0.297970, 1.194629, 1.765473
Train average loss all      (Triplet)                 : 0.291300

== Recognize ==
Train average loss Recognize     : 0.375214
Train average accuracy drums     : 96.264999 %
Train average accuracy bass      : 90.120003 %
Train average accuracy piano     : 80.339996 %
Train average accuracy guitar    : 81.875000 %
Train average accuracy residuals : 89.375000 %

== Train average loss all : 0.404343

Epoch 16:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.436, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.218, Train/loss_recog_step=0.415, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]             Epoch 17:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.436, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.218, Train/loss_recog_step=0.415, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:   5%|▌         | 50/1000 [03:00<57:16,  0.28it/s, v_num=0, Train/loss_all_step=0.436, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.218, Train/loss_recog_step=0.415, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:   5%|▌         | 50/1000 [03:00<57:16,  0.28it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.236, Train/loss_recog_step=0.375, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  10%|█         | 100/1000 [05:58<53:47,  0.28it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.236, Train/loss_recog_step=0.375, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  10%|█         | 100/1000 [05:58<53:47,  0.28it/s, v_num=0, Train/loss_all_step=0.489, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.248, Train/loss_recog_step=0.464, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  15%|█▌        | 150/1000 [08:55<50:33,  0.28it/s, v_num=0, Train/loss_all_step=0.489, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.248, Train/loss_recog_step=0.464, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  15%|█▌        | 150/1000 [08:55<50:33,  0.28it/s, v_num=0, Train/loss_all_step=0.364, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=0.326, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  20%|██        | 200/1000 [11:50<47:21,  0.28it/s, v_num=0, Train/loss_all_step=0.364, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=0.326, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  20%|██        | 200/1000 [11:50<47:21,  0.28it/s, v_num=0, Train/loss_all_step=0.431, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=0.393, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  25%|██▌       | 250/1000 [14:47<44:21,  0.28it/s, v_num=0, Train/loss_all_step=0.431, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=0.393, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  25%|██▌       | 250/1000 [14:47<44:21,  0.28it/s, v_num=0, Train/loss_all_step=0.386, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=0.352, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  30%|███       | 300/1000 [17:40<41:15,  0.28it/s, v_num=0, Train/loss_all_step=0.386, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=0.352, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  30%|███       | 300/1000 [17:40<41:15,  0.28it/s, v_num=0, Train/loss_all_step=0.457, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.286, Train/loss_recog_step=0.429, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  35%|███▌      | 350/1000 [20:28<38:01,  0.28it/s, v_num=0, Train/loss_all_step=0.457, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.286, Train/loss_recog_step=0.429, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  35%|███▌      | 350/1000 [20:28<38:01,  0.28it/s, v_num=0, Train/loss_all_step=0.464, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.233, Train/loss_recog_step=0.441, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  40%|████      | 400/1000 [23:10<34:46,  0.29it/s, v_num=0, Train/loss_all_step=0.464, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.233, Train/loss_recog_step=0.441, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  40%|████      | 400/1000 [23:10<34:46,  0.29it/s, v_num=0, Train/loss_all_step=0.366, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.352, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  45%|████▌     | 450/1000 [26:00<31:47,  0.29it/s, v_num=0, Train/loss_all_step=0.366, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.352, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  45%|████▌     | 450/1000 [26:00<31:47,  0.29it/s, v_num=0, Train/loss_all_step=0.369, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=0.351, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  50%|█████     | 500/1000 [28:57<28:57,  0.29it/s, v_num=0, Train/loss_all_step=0.369, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=0.351, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  50%|█████     | 500/1000 [28:57<28:57,  0.29it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.359, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  55%|█████▌    | 550/1000 [31:53<26:05,  0.29it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.359, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  55%|█████▌    | 550/1000 [31:53<26:05,  0.29it/s, v_num=0, Train/loss_all_step=0.374, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=0.356, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  60%|██████    | 600/1000 [34:50<23:13,  0.29it/s, v_num=0, Train/loss_all_step=0.374, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=0.356, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  60%|██████    | 600/1000 [34:50<23:13,  0.29it/s, v_num=0, Train/loss_all_step=0.294, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.279, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  65%|██████▌   | 650/1000 [37:45<20:19,  0.29it/s, v_num=0, Train/loss_all_step=0.294, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.279, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  65%|██████▌   | 650/1000 [37:45<20:19,  0.29it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.398, Train/loss_recog_step=0.345, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  70%|███████   | 700/1000 [40:42<17:26,  0.29it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.398, Train/loss_recog_step=0.345, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  70%|███████   | 700/1000 [40:42<17:26,  0.29it/s, v_num=0, Train/loss_all_step=0.510, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=0.498, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  75%|███████▌  | 750/1000 [43:37<14:32,  0.29it/s, v_num=0, Train/loss_all_step=0.510, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=0.498, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  75%|███████▌  | 750/1000 [43:37<14:32,  0.29it/s, v_num=0, Train/loss_all_step=0.372, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.357, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  80%|████████  | 800/1000 [46:32<11:38,  0.29it/s, v_num=0, Train/loss_all_step=0.372, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.357, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  80%|████████  | 800/1000 [46:32<11:38,  0.29it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.250, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=0.338, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  85%|████████▌ | 850/1000 [49:29<08:44,  0.29it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.250, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=0.338, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  85%|████████▌ | 850/1000 [49:29<08:44,  0.29it/s, v_num=0, Train/loss_all_step=0.378, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.358, Train/loss_recog_step=0.342, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  90%|█████████ | 900/1000 [52:21<05:49,  0.29it/s, v_num=0, Train/loss_all_step=0.378, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.358, Train/loss_recog_step=0.342, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  90%|█████████ | 900/1000 [52:21<05:49,  0.29it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.223, Train/loss_recog_step=0.367, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  95%|█████████▌| 950/1000 [55:10<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.223, Train/loss_recog_step=0.367, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17:  95%|█████████▌| 950/1000 [55:10<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.436, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.372, Train/loss_recog_step=0.398, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17: 100%|██████████| 1000/1000 [57:56<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.436, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.372, Train/loss_recog_step=0.398, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17: 100%|██████████| 1000/1000 [57:56<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.501, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.331, Train/loss_recog_step=0.468, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0972, Valid/loss_recog_step=0.438, Valid/loss_all_epoch=0.464, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.428, Valid/knn_avr=0.456, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.55it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.53it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.49it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:14<00:00,  0.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078486, 0.084459, 0.083843, 0.057636
Valid average loss UNet                 (all)                : 0.304424

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.128105, 0.913508, 2.269969
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.329121, 0.721975, 0.846567
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.496543, 1.103310, 1.126408
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.261437, 1.264483, 1.770647
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.446457, 1.236768, 1.385150
Valid average loss all      (Triplet)                 : 0.331807

== Recognize ==
Valid average loss Recognize     : 0.410496
Valid average accuracy drums     : 97.000000 %
Valid average accuracy bass      : 90.000000 %
Valid average accuracy piano     : 79.000000 %
Valid average accuracy guitar    : 65.000000 %
Valid average accuracy residuals : 93.000000 %

== Valid average loss all : 0.443677

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.31278395652771 sec. =
Valid knn accuracy drums     : 72.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.815497636795044 sec. =
Valid knn accuracy bass      : 13.508064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.780946493148804 sec. =
Valid knn accuracy piano     : 35.546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.550548315048218 sec. =
Valid knn accuracy guitar    : 47.767857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.218383312225342 sec. =
Valid knn accuracy residuals : 57.49999999999999%

Valid knn accuracy average   : 45.42977672310158%

                                                                      [AEpoch 17: 100%|██████████| 1000/1000 [1:01:25<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.501, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.331, Train/loss_recog_step=0.468, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.404, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.291, Train/loss_recog_epoch=0.375]Epoch 17: 100%|██████████| 1000/1000 [1:01:25<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.501, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.331, Train/loss_recog_step=0.468, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082124, 0.082023, 0.082219, 0.065023
Train average loss UNet                 (all)                : 0.311388

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.238771, 1.108690, 2.250454
Train average loss bass     (Triplet, dist_p, dist_n) : 0.385429, 0.854227, 0.982032
Train average loss piano    (Triplet, dist_p, dist_n) : 0.293207, 0.795596, 1.082548
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.252194, 0.912012, 1.423393
Train average loss residuals(Triplet, dist_p, dist_n) : 0.298271, 1.217619, 1.815945
Train average loss all      (Triplet)                 : 0.292255

== Recognize ==
Train average loss Recognize     : 0.369773
Train average accuracy drums     : 96.264999 %
Train average accuracy bass      : 90.555000 %
Train average accuracy piano     : 81.095001 %
Train average accuracy guitar    : 82.114998 %
Train average accuracy residuals : 89.494995 %

== Train average loss all : 0.398998

Epoch 17:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.501, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.331, Train/loss_recog_step=0.468, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]             Epoch 18:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.501, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.331, Train/loss_recog_step=0.468, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:   5%|▌         | 50/1000 [03:01<57:33,  0.28it/s, v_num=0, Train/loss_all_step=0.501, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.331, Train/loss_recog_step=0.468, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:   5%|▌         | 50/1000 [03:01<57:33,  0.28it/s, v_num=0, Train/loss_all_step=0.462, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.274, Train/loss_recog_step=0.435, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  10%|█         | 100/1000 [05:57<53:41,  0.28it/s, v_num=0, Train/loss_all_step=0.462, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.274, Train/loss_recog_step=0.435, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  10%|█         | 100/1000 [05:57<53:41,  0.28it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.223, Train/loss_recog_step=0.373, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  15%|█▌        | 150/1000 [08:55<50:33,  0.28it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.223, Train/loss_recog_step=0.373, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  15%|█▌        | 150/1000 [08:55<50:33,  0.28it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.338, Train/loss_recog_step=0.361, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  20%|██        | 200/1000 [11:51<47:25,  0.28it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.338, Train/loss_recog_step=0.361, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  20%|██        | 200/1000 [11:51<47:25,  0.28it/s, v_num=0, Train/loss_all_step=0.437, Train/loss_unet_all_step=0.319, Train/loss_triplet_all_step=0.338, Train/loss_recog_step=0.403, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  25%|██▌       | 250/1000 [14:48<44:24,  0.28it/s, v_num=0, Train/loss_all_step=0.437, Train/loss_unet_all_step=0.319, Train/loss_triplet_all_step=0.338, Train/loss_recog_step=0.403, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  25%|██▌       | 250/1000 [14:48<44:24,  0.28it/s, v_num=0, Train/loss_all_step=0.404, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.281, Train/loss_recog_step=0.376, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  30%|███       | 300/1000 [17:45<41:26,  0.28it/s, v_num=0, Train/loss_all_step=0.404, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.281, Train/loss_recog_step=0.376, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  30%|███       | 300/1000 [17:45<41:26,  0.28it/s, v_num=0, Train/loss_all_step=0.445, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.318, Train/loss_recog_step=0.413, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  35%|███▌      | 350/1000 [20:40<38:24,  0.28it/s, v_num=0, Train/loss_all_step=0.445, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.318, Train/loss_recog_step=0.413, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  35%|███▌      | 350/1000 [20:40<38:24,  0.28it/s, v_num=0, Train/loss_all_step=0.460, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.222, Train/loss_recog_step=0.438, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  40%|████      | 400/1000 [23:30<35:16,  0.28it/s, v_num=0, Train/loss_all_step=0.460, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.222, Train/loss_recog_step=0.438, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  40%|████      | 400/1000 [23:30<35:16,  0.28it/s, v_num=0, Train/loss_all_step=0.378, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.365, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  45%|████▌     | 450/1000 [26:17<32:08,  0.29it/s, v_num=0, Train/loss_all_step=0.378, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.365, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  45%|████▌     | 450/1000 [26:17<32:08,  0.29it/s, v_num=0, Train/loss_all_step=0.401, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.388, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  50%|█████     | 500/1000 [29:05<29:05,  0.29it/s, v_num=0, Train/loss_all_step=0.401, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.388, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  50%|█████     | 500/1000 [29:05<29:05,  0.29it/s, v_num=0, Train/loss_all_step=0.414, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.208, Train/loss_recog_step=0.393, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  55%|█████▌    | 550/1000 [31:56<26:07,  0.29it/s, v_num=0, Train/loss_all_step=0.414, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.208, Train/loss_recog_step=0.393, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  55%|█████▌    | 550/1000 [31:56<26:07,  0.29it/s, v_num=0, Train/loss_all_step=0.352, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=0.342, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  60%|██████    | 600/1000 [34:54<23:16,  0.29it/s, v_num=0, Train/loss_all_step=0.352, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=0.342, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  60%|██████    | 600/1000 [34:54<23:16,  0.29it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.317, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  65%|██████▌   | 650/1000 [37:50<20:22,  0.29it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.317, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  65%|██████▌   | 650/1000 [37:50<20:22,  0.29it/s, v_num=0, Train/loss_all_step=0.409, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.323, Train/loss_recog_step=0.377, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  70%|███████   | 700/1000 [40:45<17:28,  0.29it/s, v_num=0, Train/loss_all_step=0.409, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.323, Train/loss_recog_step=0.377, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  70%|███████   | 700/1000 [40:45<17:28,  0.29it/s, v_num=0, Train/loss_all_step=0.533, Train/loss_unet_all_step=0.267, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=0.516, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  75%|███████▌  | 750/1000 [43:40<14:33,  0.29it/s, v_num=0, Train/loss_all_step=0.533, Train/loss_unet_all_step=0.267, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=0.516, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  75%|███████▌  | 750/1000 [43:40<14:33,  0.29it/s, v_num=0, Train/loss_all_step=0.380, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=0.359, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  80%|████████  | 800/1000 [46:35<11:38,  0.29it/s, v_num=0, Train/loss_all_step=0.380, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=0.359, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  80%|████████  | 800/1000 [46:35<11:38,  0.29it/s, v_num=0, Train/loss_all_step=0.432, Train/loss_unet_all_step=0.253, Train/loss_triplet_all_step=0.0902, Train/loss_recog_step=0.423, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  85%|████████▌ | 850/1000 [49:32<08:44,  0.29it/s, v_num=0, Train/loss_all_step=0.432, Train/loss_unet_all_step=0.253, Train/loss_triplet_all_step=0.0902, Train/loss_recog_step=0.423, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  85%|████████▌ | 850/1000 [49:32<08:44,  0.29it/s, v_num=0, Train/loss_all_step=0.367, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=0.328, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370] Epoch 18:  90%|█████████ | 900/1000 [52:29<05:49,  0.29it/s, v_num=0, Train/loss_all_step=0.367, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=0.328, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  90%|█████████ | 900/1000 [52:29<05:49,  0.29it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.255, Train/loss_recog_step=0.301, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  95%|█████████▌| 950/1000 [55:23<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.255, Train/loss_recog_step=0.301, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18:  95%|█████████▌| 950/1000 [55:23<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.445, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.390, Train/loss_recog_step=0.406, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18: 100%|██████████| 1000/1000 [58:16<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.445, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.390, Train/loss_recog_step=0.406, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18: 100%|██████████| 1000/1000 [58:16<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=0.422, Valid/loss_all_step=0.404, Valid/loss_unet_all_step=0.304, Valid/loss_triplet_all_step=0.0565, Valid/loss_recog_step=0.398, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.304, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.454, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:13<00:00,  0.58it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.57it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.55it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:13<00:00,  0.54it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078469, 0.084425, 0.083793, 0.050933
Valid average loss UNet                 (all)                : 0.297621

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.128306, 0.885662, 2.273883
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.300074, 0.689191, 0.819949
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.555494, 1.318840, 1.312030
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.287252, 1.221663, 1.821015
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.432022, 1.224313, 1.456670
Valid average loss all      (Triplet)                 : 0.338497

== Recognize ==
Valid average loss Recognize     : 0.364480
Valid average accuracy drums     : 97.500000 %
Valid average accuracy bass      : 91.500000 %
Valid average accuracy piano     : 78.500000 %
Valid average accuracy guitar    : 66.000000 %
Valid average accuracy residuals : 94.000000 %

== Valid average loss all : 0.398330

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.358322381973267 sec. =
Valid knn accuracy drums     : 67.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.15427565574646 sec. =
Valid knn accuracy bass      : 16.33064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.262965679168701 sec. =
Valid knn accuracy piano     : 37.6953125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.567584991455078 sec. =
Valid knn accuracy guitar    : 45.089285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.263514280319214 sec. =
Valid knn accuracy residuals : 64.54545454545455%

Valid knn accuracy average   : 46.16692219290178%

                                                                      [AEpoch 18: 100%|██████████| 1000/1000 [1:01:34<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=0.422, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.399, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.292, Train/loss_recog_epoch=0.370]Epoch 18: 100%|██████████| 1000/1000 [1:01:34<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=0.422, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082134, 0.082035, 0.082234, 0.064583
Train average loss UNet                 (all)                : 0.310985

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.234950, 1.113339, 2.312731
Train average loss bass     (Triplet, dist_p, dist_n) : 0.380064, 0.819705, 0.932485
Train average loss piano    (Triplet, dist_p, dist_n) : 0.279767, 0.779066, 1.081601
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.249647, 0.918363, 1.431688
Train average loss residuals(Triplet, dist_p, dist_n) : 0.294195, 1.209849, 1.820563
Train average loss all      (Triplet)                 : 0.287626

== Recognize ==
Train average loss Recognize     : 0.363589
Train average accuracy drums     : 96.855003 %
Train average accuracy bass      : 90.495003 %
Train average accuracy piano     : 81.360001 %
Train average accuracy guitar    : 83.284996 %
Train average accuracy residuals : 90.034996 %

== Train average loss all : 0.392352

Epoch 18:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=0.422, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]             Epoch 19:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=0.422, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:   5%|▌         | 50/1000 [02:51<54:22,  0.29it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=0.422, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:   5%|▌         | 50/1000 [02:51<54:22,  0.29it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.222, Train/loss_recog_step=0.361, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  10%|█         | 100/1000 [05:49<52:28,  0.29it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.222, Train/loss_recog_step=0.361, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  10%|█         | 100/1000 [05:49<52:28,  0.29it/s, v_num=0, Train/loss_all_step=0.446, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.280, Train/loss_recog_step=0.418, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  15%|█▌        | 150/1000 [08:45<49:36,  0.29it/s, v_num=0, Train/loss_all_step=0.446, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.280, Train/loss_recog_step=0.418, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  15%|█▌        | 150/1000 [08:45<49:36,  0.29it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.350, Train/loss_recog_step=0.299, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  20%|██        | 200/1000 [11:42<46:48,  0.28it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.350, Train/loss_recog_step=0.299, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  20%|██        | 200/1000 [11:42<46:48,  0.28it/s, v_num=0, Train/loss_all_step=0.468, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.237, Train/loss_recog_step=0.445, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  25%|██▌       | 250/1000 [14:37<43:52,  0.28it/s, v_num=0, Train/loss_all_step=0.468, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.237, Train/loss_recog_step=0.445, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  25%|██▌       | 250/1000 [14:37<43:52,  0.28it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.305, Train/loss_recog_step=0.368, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  30%|███       | 300/1000 [17:34<40:59,  0.28it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.305, Train/loss_recog_step=0.368, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  30%|███       | 300/1000 [17:34<40:59,  0.28it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.270, Train/loss_recog_step=0.449, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  35%|███▌      | 350/1000 [20:31<38:07,  0.28it/s, v_num=0, Train/loss_all_step=0.476, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.270, Train/loss_recog_step=0.449, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  35%|███▌      | 350/1000 [20:31<38:07,  0.28it/s, v_num=0, Train/loss_all_step=0.424, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=0.408, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  40%|████      | 400/1000 [23:24<35:06,  0.28it/s, v_num=0, Train/loss_all_step=0.424, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=0.408, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  40%|████      | 400/1000 [23:24<35:06,  0.28it/s, v_num=0, Train/loss_all_step=0.433, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=0.420, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  45%|████▌     | 450/1000 [26:15<32:05,  0.29it/s, v_num=0, Train/loss_all_step=0.433, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=0.420, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  45%|████▌     | 450/1000 [26:15<32:05,  0.29it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.370, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  50%|█████     | 500/1000 [29:12<29:12,  0.29it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.370, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  50%|█████     | 500/1000 [29:12<29:12,  0.29it/s, v_num=0, Train/loss_all_step=0.394, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.380, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  55%|█████▌    | 550/1000 [32:03<26:13,  0.29it/s, v_num=0, Train/loss_all_step=0.394, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.380, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  55%|█████▌    | 550/1000 [32:03<26:13,  0.29it/s, v_num=0, Train/loss_all_step=0.373, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.361, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  60%|██████    | 600/1000 [34:51<23:14,  0.29it/s, v_num=0, Train/loss_all_step=0.373, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.361, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  60%|██████    | 600/1000 [34:51<23:14,  0.29it/s, v_num=0, Train/loss_all_step=0.287, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.267, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  65%|██████▌   | 650/1000 [37:40<20:17,  0.29it/s, v_num=0, Train/loss_all_step=0.287, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.267, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  65%|██████▌   | 650/1000 [37:40<20:17,  0.29it/s, v_num=0, Train/loss_all_step=0.364, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.297, Train/loss_recog_step=0.334, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  70%|███████   | 700/1000 [40:36<17:24,  0.29it/s, v_num=0, Train/loss_all_step=0.364, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.297, Train/loss_recog_step=0.334, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  70%|███████   | 700/1000 [40:36<17:24,  0.29it/s, v_num=0, Train/loss_all_step=0.547, Train/loss_unet_all_step=0.261, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=0.528, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  75%|███████▌  | 750/1000 [43:33<14:31,  0.29it/s, v_num=0, Train/loss_all_step=0.547, Train/loss_unet_all_step=0.261, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=0.528, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  75%|███████▌  | 750/1000 [43:33<14:31,  0.29it/s, v_num=0, Train/loss_all_step=0.360, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=0.344, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  80%|████████  | 800/1000 [46:28<11:37,  0.29it/s, v_num=0, Train/loss_all_step=0.360, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=0.344, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  80%|████████  | 800/1000 [46:28<11:37,  0.29it/s, v_num=0, Train/loss_all_step=0.458, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.440, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  85%|████████▌ | 850/1000 [49:24<08:43,  0.29it/s, v_num=0, Train/loss_all_step=0.458, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.440, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  85%|████████▌ | 850/1000 [49:24<08:43,  0.29it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.387, Train/loss_recog_step=0.295, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  90%|█████████ | 900/1000 [52:21<05:49,  0.29it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.387, Train/loss_recog_step=0.295, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  90%|█████████ | 900/1000 [52:21<05:49,  0.29it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.338, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  95%|█████████▌| 950/1000 [55:17<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.338, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19:  95%|█████████▌| 950/1000 [55:17<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.462, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.421, Train/loss_recog_step=0.420, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19: 100%|██████████| 1000/1000 [58:12<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.462, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.421, Train/loss_recog_step=0.420, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19: 100%|██████████| 1000/1000 [58:12<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.504, Train/loss_unet_all_step=0.279, Train/loss_triplet_all_step=0.251, Train/loss_recog_step=0.479, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0849, Valid/loss_recog_step=0.220, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.364, Valid/knn_avr=0.462, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:20<00:00,  0.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:15<00:00,  0.53it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:15<00:00,  0.52it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:16<00:00,  0.50it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078432, 0.084393, 0.083755, 0.051662
Valid average loss UNet                 (all)                : 0.298241

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.137755, 0.938333, 2.388103
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.300194, 0.651063, 0.694902
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.507083, 1.044798, 1.115376
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.454260, 1.254915, 1.609648
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.458965, 1.241365, 1.424487
Valid average loss all      (Triplet)                 : 0.400270

== Recognize ==
Valid average loss Recognize     : 0.407013
Valid average accuracy drums     : 95.000000 %
Valid average accuracy bass      : 91.500000 %
Valid average accuracy piano     : 80.500000 %
Valid average accuracy guitar    : 65.000000 %
Valid average accuracy residuals : 90.000000 %

== Valid average loss all : 0.447040

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.697928667068481 sec. =
Valid knn accuracy drums     : 70.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.789125680923462 sec. =
Valid knn accuracy bass      : 16.733870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.201374530792236 sec. =
Valid knn accuracy piano     : 35.3515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.960896253585815 sec. =
Valid knn accuracy guitar    : 37.94642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.367153406143188 sec. =
Valid knn accuracy residuals : 61.59090909090909%

Valid knn accuracy average   : 44.32455422601592%

                                                                      [AEpoch 19: 100%|██████████| 1000/1000 [1:01:44<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.504, Train/loss_unet_all_step=0.279, Train/loss_triplet_all_step=0.251, Train/loss_recog_step=0.479, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.288, Train/loss_recog_epoch=0.364]Epoch 19: 100%|██████████| 1000/1000 [1:01:44<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.504, Train/loss_unet_all_step=0.279, Train/loss_triplet_all_step=0.251, Train/loss_recog_step=0.479, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082155, 0.082059, 0.082253, 0.064963
Train average loss UNet                 (all)                : 0.311431

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.232522, 1.135057, 2.360851
Train average loss bass     (Triplet, dist_p, dist_n) : 0.367676, 0.823532, 0.959992
Train average loss piano    (Triplet, dist_p, dist_n) : 0.288627, 0.808485, 1.137781
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.248550, 0.934649, 1.459303
Train average loss residuals(Triplet, dist_p, dist_n) : 0.286203, 1.228713, 1.852198
Train average loss all      (Triplet)                 : 0.283616

== Recognize ==
Train average loss Recognize     : 0.362494
Train average accuracy drums     : 96.605003 %
Train average accuracy bass      : 90.550003 %
Train average accuracy piano     : 81.095001 %
Train average accuracy guitar    : 83.324997 %
Train average accuracy residuals : 89.290001 %

== Train average loss all : 0.390857

Epoch 19:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.504, Train/loss_unet_all_step=0.279, Train/loss_triplet_all_step=0.251, Train/loss_recog_step=0.479, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]             Epoch 20:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.504, Train/loss_unet_all_step=0.279, Train/loss_triplet_all_step=0.251, Train/loss_recog_step=0.479, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:   5%|▌         | 50/1000 [02:58<56:29,  0.28it/s, v_num=0, Train/loss_all_step=0.504, Train/loss_unet_all_step=0.279, Train/loss_triplet_all_step=0.251, Train/loss_recog_step=0.479, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:   5%|▌         | 50/1000 [02:58<56:29,  0.28it/s, v_num=0, Train/loss_all_step=0.389, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.206, Train/loss_recog_step=0.368, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  10%|█         | 100/1000 [05:46<51:56,  0.29it/s, v_num=0, Train/loss_all_step=0.389, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.206, Train/loss_recog_step=0.368, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  10%|█         | 100/1000 [05:46<51:56,  0.29it/s, v_num=0, Train/loss_all_step=0.386, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.244, Train/loss_recog_step=0.361, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  15%|█▌        | 150/1000 [08:34<48:33,  0.29it/s, v_num=0, Train/loss_all_step=0.386, Train/loss_unet_all_step=0.357, Train/loss_triplet_all_step=0.244, Train/loss_recog_step=0.361, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  15%|█▌        | 150/1000 [08:34<48:33,  0.29it/s, v_num=0, Train/loss_all_step=0.341, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.242, Train/loss_recog_step=0.317, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  20%|██        | 200/1000 [11:27<45:50,  0.29it/s, v_num=0, Train/loss_all_step=0.341, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.242, Train/loss_recog_step=0.317, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  20%|██        | 200/1000 [11:27<45:50,  0.29it/s, v_num=0, Train/loss_all_step=0.449, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.254, Train/loss_recog_step=0.423, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  25%|██▌       | 250/1000 [14:28<43:24,  0.29it/s, v_num=0, Train/loss_all_step=0.449, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.254, Train/loss_recog_step=0.423, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  25%|██▌       | 250/1000 [14:28<43:24,  0.29it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.284, Train/loss_recog_step=0.396, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  30%|███       | 300/1000 [17:24<40:37,  0.29it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.284, Train/loss_recog_step=0.396, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  30%|███       | 300/1000 [17:24<40:37,  0.29it/s, v_num=0, Train/loss_all_step=0.454, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.251, Train/loss_recog_step=0.429, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  35%|███▌      | 350/1000 [20:22<37:49,  0.29it/s, v_num=0, Train/loss_all_step=0.454, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.251, Train/loss_recog_step=0.429, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  35%|███▌      | 350/1000 [20:22<37:49,  0.29it/s, v_num=0, Train/loss_all_step=0.458, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=0.442, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  40%|████      | 400/1000 [23:18<34:57,  0.29it/s, v_num=0, Train/loss_all_step=0.458, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=0.442, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  40%|████      | 400/1000 [23:18<34:57,  0.29it/s, v_num=0, Train/loss_all_step=0.386, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.216, Train/loss_recog_step=0.365, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  45%|████▌     | 450/1000 [26:08<31:57,  0.29it/s, v_num=0, Train/loss_all_step=0.386, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.216, Train/loss_recog_step=0.365, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  45%|████▌     | 450/1000 [26:08<31:57,  0.29it/s, v_num=0, Train/loss_all_step=0.361, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.350, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  50%|█████     | 500/1000 [29:06<29:06,  0.29it/s, v_num=0, Train/loss_all_step=0.361, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.350, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  50%|█████     | 500/1000 [29:06<29:06,  0.29it/s, v_num=0, Train/loss_all_step=0.418, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.211, Train/loss_recog_step=0.397, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  55%|█████▌    | 550/1000 [32:03<26:13,  0.29it/s, v_num=0, Train/loss_all_step=0.418, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.211, Train/loss_recog_step=0.397, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  55%|█████▌    | 550/1000 [32:03<26:13,  0.29it/s, v_num=0, Train/loss_all_step=0.355, Train/loss_unet_all_step=0.308, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.340, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  60%|██████    | 600/1000 [34:58<23:19,  0.29it/s, v_num=0, Train/loss_all_step=0.355, Train/loss_unet_all_step=0.308, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.340, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  60%|██████    | 600/1000 [34:58<23:19,  0.29it/s, v_num=0, Train/loss_all_step=0.309, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.294, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  65%|██████▌   | 650/1000 [37:48<20:21,  0.29it/s, v_num=0, Train/loss_all_step=0.309, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.294, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  65%|██████▌   | 650/1000 [37:48<20:21,  0.29it/s, v_num=0, Train/loss_all_step=0.378, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.230, Train/loss_recog_step=0.355, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  70%|███████   | 700/1000 [40:35<17:23,  0.29it/s, v_num=0, Train/loss_all_step=0.378, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.230, Train/loss_recog_step=0.355, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  70%|███████   | 700/1000 [40:35<17:23,  0.29it/s, v_num=0, Train/loss_all_step=0.602, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.586, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  75%|███████▌  | 750/1000 [43:21<14:27,  0.29it/s, v_num=0, Train/loss_all_step=0.602, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.586, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  75%|███████▌  | 750/1000 [43:21<14:27,  0.29it/s, v_num=0, Train/loss_all_step=0.400, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.227, Train/loss_recog_step=0.378, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  80%|████████  | 800/1000 [46:15<11:33,  0.29it/s, v_num=0, Train/loss_all_step=0.400, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.227, Train/loss_recog_step=0.378, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  80%|████████  | 800/1000 [46:15<11:33,  0.29it/s, v_num=0, Train/loss_all_step=0.389, Train/loss_unet_all_step=0.249, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.379, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  85%|████████▌ | 850/1000 [49:08<08:40,  0.29it/s, v_num=0, Train/loss_all_step=0.389, Train/loss_unet_all_step=0.249, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.379, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  85%|████████▌ | 850/1000 [49:08<08:40,  0.29it/s, v_num=0, Train/loss_all_step=0.359, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.356, Train/loss_recog_step=0.323, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  90%|█████████ | 900/1000 [52:04<05:47,  0.29it/s, v_num=0, Train/loss_all_step=0.359, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.356, Train/loss_recog_step=0.323, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  90%|█████████ | 900/1000 [52:04<05:47,  0.29it/s, v_num=0, Train/loss_all_step=0.328, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=0.309, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  95%|█████████▌| 950/1000 [55:02<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.328, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=0.309, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20:  95%|█████████▌| 950/1000 [55:02<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.418, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.431, Train/loss_recog_step=0.375, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20: 100%|██████████| 1000/1000 [57:55<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.418, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.431, Train/loss_recog_step=0.375, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20: 100%|██████████| 1000/1000 [57:55<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.474, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.242, Train/loss_recog_step=0.450, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.296, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=0.387, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.443, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:21<00:00,  0.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:15<00:00,  0.53it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.53it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078403, 0.084376, 0.083740, 0.049288
Valid average loss UNet                 (all)                : 0.295806

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.174198, 1.225398, 2.560166
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.275075, 0.695438, 0.831611
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.529984, 1.185657, 1.290256
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.459701, 1.288587, 1.633352
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.451578, 1.316703, 1.581664
Valid average loss all      (Triplet)                 : 0.414099

== Recognize ==
Valid average loss Recognize     : 0.379514
Valid average accuracy drums     : 96.500000 %
Valid average accuracy bass      : 92.500000 %
Valid average accuracy piano     : 79.500000 %
Valid average accuracy guitar    : 64.000000 %
Valid average accuracy residuals : 93.500000 %

== Valid average loss all : 0.420924

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.452232122421265 sec. =
Valid knn accuracy drums     : 71.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.775180578231812 sec. =
Valid knn accuracy bass      : 12.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.459511041641235 sec. =
Valid knn accuracy piano     : 27.34375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.362111806869507 sec. =
Valid knn accuracy guitar    : 41.07142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.272564888000488 sec. =
Valid knn accuracy residuals : 61.81818181818181%

Valid knn accuracy average   : 42.7640633822699%

                                                                      [AEpoch 20: 100%|██████████| 1000/1000 [1:01:24<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.474, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.242, Train/loss_recog_step=0.450, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.391, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.284, Train/loss_recog_epoch=0.362]Epoch 20: 100%|██████████| 1000/1000 [1:01:24<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.474, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.242, Train/loss_recog_step=0.450, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082140, 0.082041, 0.082231, 0.064970
Train average loss UNet                 (all)                : 0.311382

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.232691, 1.163500, 2.410072
Train average loss bass     (Triplet, dist_p, dist_n) : 0.359361, 0.790995, 0.920355
Train average loss piano    (Triplet, dist_p, dist_n) : 0.274619, 0.788926, 1.109844
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.243375, 0.905964, 1.439857
Train average loss residuals(Triplet, dist_p, dist_n) : 0.285226, 1.219672, 1.848058
Train average loss all      (Triplet)                 : 0.278129

== Recognize ==
Train average loss Recognize     : 0.359129
Train average accuracy drums     : 96.644997 %
Train average accuracy bass      : 91.035004 %
Train average accuracy piano     : 82.279999 %
Train average accuracy guitar    : 83.864998 %
Train average accuracy residuals : 89.709999 %

== Train average loss all : 0.386942

Epoch 20:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.474, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.242, Train/loss_recog_step=0.450, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]             Epoch 21:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.474, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.242, Train/loss_recog_step=0.450, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:   5%|▌         | 50/1000 [03:04<58:29,  0.27it/s, v_num=0, Train/loss_all_step=0.474, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.242, Train/loss_recog_step=0.450, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:   5%|▌         | 50/1000 [03:04<58:29,  0.27it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.230, Train/loss_recog_step=0.368, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  10%|█         | 100/1000 [06:01<54:10,  0.28it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.230, Train/loss_recog_step=0.368, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  10%|█         | 100/1000 [06:01<54:10,  0.28it/s, v_num=0, Train/loss_all_step=0.426, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.218, Train/loss_recog_step=0.404, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  15%|█▌        | 150/1000 [08:55<50:33,  0.28it/s, v_num=0, Train/loss_all_step=0.426, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.218, Train/loss_recog_step=0.404, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  15%|█▌        | 150/1000 [08:55<50:33,  0.28it/s, v_num=0, Train/loss_all_step=0.338, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.255, Train/loss_recog_step=0.313, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  20%|██        | 200/1000 [11:43<46:52,  0.28it/s, v_num=0, Train/loss_all_step=0.338, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.255, Train/loss_recog_step=0.313, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  20%|██        | 200/1000 [11:43<46:52,  0.28it/s, v_num=0, Train/loss_all_step=0.433, Train/loss_unet_all_step=0.316, Train/loss_triplet_all_step=0.303, Train/loss_recog_step=0.403, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  25%|██▌       | 250/1000 [14:32<43:38,  0.29it/s, v_num=0, Train/loss_all_step=0.433, Train/loss_unet_all_step=0.316, Train/loss_triplet_all_step=0.303, Train/loss_recog_step=0.403, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  25%|██▌       | 250/1000 [14:32<43:38,  0.29it/s, v_num=0, Train/loss_all_step=0.421, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.273, Train/loss_recog_step=0.394, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  30%|███       | 300/1000 [17:25<40:40,  0.29it/s, v_num=0, Train/loss_all_step=0.421, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.273, Train/loss_recog_step=0.394, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  30%|███       | 300/1000 [17:25<40:40,  0.29it/s, v_num=0, Train/loss_all_step=0.488, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.330, Train/loss_recog_step=0.455, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  35%|███▌      | 350/1000 [20:25<37:55,  0.29it/s, v_num=0, Train/loss_all_step=0.488, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.330, Train/loss_recog_step=0.455, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  35%|███▌      | 350/1000 [20:25<37:55,  0.29it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.425, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  40%|████      | 400/1000 [23:18<34:57,  0.29it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.425, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  40%|████      | 400/1000 [23:18<34:57,  0.29it/s, v_num=0, Train/loss_all_step=0.319, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.0879, Train/loss_recog_step=0.310, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  45%|████▌     | 450/1000 [26:09<31:57,  0.29it/s, v_num=0, Train/loss_all_step=0.319, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.0879, Train/loss_recog_step=0.310, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  45%|████▌     | 450/1000 [26:09<31:57,  0.29it/s, v_num=0, Train/loss_all_step=0.389, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.0544, Train/loss_recog_step=0.383, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  50%|█████     | 500/1000 [29:03<29:03,  0.29it/s, v_num=0, Train/loss_all_step=0.389, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.0544, Train/loss_recog_step=0.383, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  50%|█████     | 500/1000 [29:03<29:03,  0.29it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.196, Train/loss_recog_step=0.349, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359] Epoch 21:  55%|█████▌    | 550/1000 [32:00<26:11,  0.29it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.196, Train/loss_recog_step=0.349, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  55%|█████▌    | 550/1000 [32:00<26:11,  0.29it/s, v_num=0, Train/loss_all_step=0.357, Train/loss_unet_all_step=0.310, Train/loss_triplet_all_step=0.188, Train/loss_recog_step=0.338, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  60%|██████    | 600/1000 [34:57<23:18,  0.29it/s, v_num=0, Train/loss_all_step=0.357, Train/loss_unet_all_step=0.310, Train/loss_triplet_all_step=0.188, Train/loss_recog_step=0.338, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  60%|██████    | 600/1000 [34:57<23:18,  0.29it/s, v_num=0, Train/loss_all_step=0.314, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.197, Train/loss_recog_step=0.294, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  65%|██████▌   | 650/1000 [37:52<20:23,  0.29it/s, v_num=0, Train/loss_all_step=0.314, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.197, Train/loss_recog_step=0.294, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  65%|██████▌   | 650/1000 [37:52<20:23,  0.29it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.301, Train/loss_recog_step=0.408, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  70%|███████   | 700/1000 [40:49<17:29,  0.29it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.301, Train/loss_recog_step=0.408, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  70%|███████   | 700/1000 [40:49<17:29,  0.29it/s, v_num=0, Train/loss_all_step=0.547, Train/loss_unet_all_step=0.269, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.531, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  75%|███████▌  | 750/1000 [43:43<14:34,  0.29it/s, v_num=0, Train/loss_all_step=0.547, Train/loss_unet_all_step=0.269, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.531, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  75%|███████▌  | 750/1000 [43:43<14:34,  0.29it/s, v_num=0, Train/loss_all_step=0.408, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.392, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  80%|████████  | 800/1000 [46:32<11:38,  0.29it/s, v_num=0, Train/loss_all_step=0.408, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.392, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  80%|████████  | 800/1000 [46:32<11:38,  0.29it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.394, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  85%|████████▌ | 850/1000 [49:20<08:42,  0.29it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.394, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  85%|████████▌ | 850/1000 [49:20<08:42,  0.29it/s, v_num=0, Train/loss_all_step=0.333, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.298, Train/loss_recog_step=0.303, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  90%|█████████ | 900/1000 [52:14<05:48,  0.29it/s, v_num=0, Train/loss_all_step=0.333, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.298, Train/loss_recog_step=0.303, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  90%|█████████ | 900/1000 [52:14<05:48,  0.29it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.226, Train/loss_recog_step=0.324, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  95%|█████████▌| 950/1000 [55:11<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.226, Train/loss_recog_step=0.324, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21:  95%|█████████▌| 950/1000 [55:11<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.467, Train/loss_unet_all_step=0.307, Train/loss_triplet_all_step=0.362, Train/loss_recog_step=0.430, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21: 100%|██████████| 1000/1000 [58:05<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.467, Train/loss_unet_all_step=0.307, Train/loss_triplet_all_step=0.362, Train/loss_recog_step=0.430, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21: 100%|██████████| 1000/1000 [58:05<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.269, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.358, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.416, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.421, Valid/loss_unet_all_epoch=0.296, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.380, Valid/knn_avr=0.428, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:20<00:00,  0.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.55it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.53it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:14<00:00,  0.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078376, 0.084293, 0.083733, 0.056331
Valid average loss UNet                 (all)                : 0.302733

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.119275, 1.098857, 2.156846
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.280676, 0.673963, 0.789246
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.566095, 1.193379, 1.238918
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.145805, 0.844078, 1.470060
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.451380, 1.329362, 1.447297
Valid average loss all      (Triplet)                 : 0.310713

== Recognize ==
Valid average loss Recognize     : 0.413140
Valid average accuracy drums     : 96.000000 %
Valid average accuracy bass      : 93.000000 %
Valid average accuracy piano     : 82.500000 %
Valid average accuracy guitar    : 66.000000 %
Valid average accuracy residuals : 88.000000 %

== Valid average loss all : 0.444211

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.33903431892395 sec. =
Valid knn accuracy drums     : 76.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.196860313415527 sec. =
Valid knn accuracy bass      : 19.35483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.391140699386597 sec. =
Valid knn accuracy piano     : 29.1015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.532529592514038 sec. =
Valid knn accuracy guitar    : 41.964285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.640960216522217 sec. =
Valid knn accuracy residuals : 58.86363636363636%

Valid knn accuracy average   : 45.11773422273729%

                                                                      [AEpoch 21: 100%|██████████| 1000/1000 [1:01:34<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.269, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.358, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.278, Train/loss_recog_epoch=0.359]Epoch 21: 100%|██████████| 1000/1000 [1:01:34<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.269, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.358, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082088, 0.081992, 0.082178, 0.065039
Train average loss UNet                 (all)                : 0.311297

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.235535, 1.180387, 2.469252
Train average loss bass     (Triplet, dist_p, dist_n) : 0.364923, 0.797052, 0.935159
Train average loss piano    (Triplet, dist_p, dist_n) : 0.269499, 0.772236, 1.115419
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.243001, 0.911364, 1.473284
Train average loss residuals(Triplet, dist_p, dist_n) : 0.274086, 1.229851, 1.883534
Train average loss all      (Triplet)                 : 0.277190

== Recognize ==
Train average loss Recognize     : 0.360065
Train average accuracy drums     : 96.485001 %
Train average accuracy bass      : 91.004997 %
Train average accuracy piano     : 82.144997 %
Train average accuracy guitar    : 83.099998 %
Train average accuracy residuals : 89.684998 %

== Train average loss all : 0.387784

Epoch 21:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.269, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.358, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]             Epoch 22:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.269, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.358, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:   5%|▌         | 50/1000 [03:00<57:02,  0.28it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.269, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.358, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:   5%|▌         | 50/1000 [03:00<57:02,  0.28it/s, v_num=0, Train/loss_all_step=0.433, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.415, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  10%|█         | 100/1000 [05:57<53:39,  0.28it/s, v_num=0, Train/loss_all_step=0.433, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.415, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  10%|█         | 100/1000 [05:57<53:39,  0.28it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.244, Train/loss_recog_step=0.413, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  15%|█▌        | 150/1000 [08:54<50:27,  0.28it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.244, Train/loss_recog_step=0.413, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  15%|█▌        | 150/1000 [08:54<50:27,  0.28it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.280, Train/loss_recog_step=0.340, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  20%|██        | 200/1000 [11:50<47:22,  0.28it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.280, Train/loss_recog_step=0.340, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  20%|██        | 200/1000 [11:50<47:22,  0.28it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.217, Train/loss_recog_step=0.399, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  25%|██▌       | 250/1000 [14:44<44:13,  0.28it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.217, Train/loss_recog_step=0.399, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  25%|██▌       | 250/1000 [14:44<44:13,  0.28it/s, v_num=0, Train/loss_all_step=0.411, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.367, Train/loss_recog_step=0.375, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  30%|███       | 300/1000 [17:37<41:07,  0.28it/s, v_num=0, Train/loss_all_step=0.411, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.367, Train/loss_recog_step=0.375, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  30%|███       | 300/1000 [17:37<41:07,  0.28it/s, v_num=0, Train/loss_all_step=0.487, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.220, Train/loss_recog_step=0.465, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  35%|███▌      | 350/1000 [20:26<37:57,  0.29it/s, v_num=0, Train/loss_all_step=0.487, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.220, Train/loss_recog_step=0.465, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  35%|███▌      | 350/1000 [20:26<37:57,  0.29it/s, v_num=0, Train/loss_all_step=0.534, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.523, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  40%|████      | 400/1000 [23:13<34:50,  0.29it/s, v_num=0, Train/loss_all_step=0.534, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.523, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  40%|████      | 400/1000 [23:13<34:50,  0.29it/s, v_num=0, Train/loss_all_step=0.362, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.176, Train/loss_recog_step=0.345, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  45%|████▌     | 450/1000 [26:12<32:01,  0.29it/s, v_num=0, Train/loss_all_step=0.362, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.176, Train/loss_recog_step=0.345, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  45%|████▌     | 450/1000 [26:12<32:01,  0.29it/s, v_num=0, Train/loss_all_step=0.407, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.389, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  50%|█████     | 500/1000 [29:04<29:04,  0.29it/s, v_num=0, Train/loss_all_step=0.407, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.389, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  50%|█████     | 500/1000 [29:04<29:04,  0.29it/s, v_num=0, Train/loss_all_step=0.363, Train/loss_unet_all_step=0.316, Train/loss_triplet_all_step=0.295, Train/loss_recog_step=0.334, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  55%|█████▌    | 550/1000 [31:45<25:58,  0.29it/s, v_num=0, Train/loss_all_step=0.363, Train/loss_unet_all_step=0.316, Train/loss_triplet_all_step=0.295, Train/loss_recog_step=0.334, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  55%|█████▌    | 550/1000 [31:45<25:58,  0.29it/s, v_num=0, Train/loss_all_step=0.360, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.236, Train/loss_recog_step=0.336, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  60%|██████    | 600/1000 [34:25<22:57,  0.29it/s, v_num=0, Train/loss_all_step=0.360, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.236, Train/loss_recog_step=0.336, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  60%|██████    | 600/1000 [34:25<22:57,  0.29it/s, v_num=0, Train/loss_all_step=0.332, Train/loss_unet_all_step=0.310, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.314, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  65%|██████▌   | 650/1000 [37:06<19:58,  0.29it/s, v_num=0, Train/loss_all_step=0.332, Train/loss_unet_all_step=0.310, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.314, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  65%|██████▌   | 650/1000 [37:06<19:58,  0.29it/s, v_num=0, Train/loss_all_step=0.381, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.348, Train/loss_recog_step=0.346, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  70%|███████   | 700/1000 [39:46<17:02,  0.29it/s, v_num=0, Train/loss_all_step=0.381, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.348, Train/loss_recog_step=0.346, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  70%|███████   | 700/1000 [39:46<17:02,  0.29it/s, v_num=0, Train/loss_all_step=0.545, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=0.527, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  75%|███████▌  | 750/1000 [42:27<14:09,  0.29it/s, v_num=0, Train/loss_all_step=0.545, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=0.527, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  75%|███████▌  | 750/1000 [42:27<14:09,  0.29it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=0.307, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  80%|████████  | 800/1000 [45:08<11:17,  0.30it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=0.307, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  80%|████████  | 800/1000 [45:08<11:17,  0.30it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.342, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  85%|████████▌ | 850/1000 [47:48<08:26,  0.30it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.342, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  85%|████████▌ | 850/1000 [47:48<08:26,  0.30it/s, v_num=0, Train/loss_all_step=0.359, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.334, Train/loss_recog_step=0.326, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  90%|█████████ | 900/1000 [50:23<05:35,  0.30it/s, v_num=0, Train/loss_all_step=0.359, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.334, Train/loss_recog_step=0.326, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  90%|█████████ | 900/1000 [50:23<05:35,  0.30it/s, v_num=0, Train/loss_all_step=0.378, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.249, Train/loss_recog_step=0.353, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  95%|█████████▌| 950/1000 [52:57<02:47,  0.30it/s, v_num=0, Train/loss_all_step=0.378, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.249, Train/loss_recog_step=0.353, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22:  95%|█████████▌| 950/1000 [52:57<02:47,  0.30it/s, v_num=0, Train/loss_all_step=0.431, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.457, Train/loss_recog_step=0.385, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22: 100%|██████████| 1000/1000 [55:28<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.431, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.457, Train/loss_recog_step=0.385, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]Epoch 22: 100%|██████████| 1000/1000 [55:28<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.524, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.275, Train/loss_recog_step=0.496, Valid/loss_all_step=0.372, Valid/loss_unet_all_step=0.310, Valid/loss_triplet_all_step=0.0807, Valid/loss_recog_step=0.364, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.413, Valid/knn_avr=0.451, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:18<00:00,  0.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:13<00:00,  0.60it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:13<00:00,  0.59it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:13<00:00,  0.58it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:12<00:00,  0.55it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:12<00:00,  0.55it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078457, 0.084399, 0.083770, 0.050038
Valid average loss UNet                 (all)                : 0.296663

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.234678, 1.292300, 2.320886
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.365357, 0.796571, 0.934666
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.481099, 1.098966, 1.291431
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.260433, 1.099025, 1.608358
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.501997, 1.323403, 1.484191
Valid average loss all      (Triplet)                 : 0.376629

== Recognize ==
Valid average loss Recognize     : 0.410442
Valid average accuracy drums     : 95.000000 %
Valid average accuracy bass      : 91.000000 %
Valid average accuracy piano     : 78.000000 %
Valid average accuracy guitar    : 66.500000 %
Valid average accuracy residuals : 94.500000 %

== Valid average loss all : 0.448105

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.529788494110107 sec. =
Valid knn accuracy drums     : 79.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.13341236114502 sec. =
Valid knn accuracy bass      : 14.516129032258066%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.24642825126648 sec. =
Valid knn accuracy piano     : 25.5859375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.686342477798462 sec. =
Valid knn accuracy guitar    : 39.732142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.70765209197998 sec. =
Valid knn accuracy residuals : 59.31818181818181%

Valid knn accuracy average   : 43.74352171977741%

                                                                      [AEpoch 22: 100%|██████████| 1000/1000 [58:34<00:00,  0.28it/s, v_num=0, Train/loss_all_step=0.524, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.275, Train/loss_recog_step=0.496, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.277, Train/loss_recog_epoch=0.360] Epoch 22: 100%|██████████| 1000/1000 [58:34<00:00,  0.28it/s, v_num=0, Train/loss_all_step=0.524, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.275, Train/loss_recog_step=0.496, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082120, 0.082013, 0.082203, 0.065091
Train average loss UNet                 (all)                : 0.311427

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.226946, 1.176680, 2.468892
Train average loss bass     (Triplet, dist_p, dist_n) : 0.350517, 0.785344, 0.924829
Train average loss piano    (Triplet, dist_p, dist_n) : 0.277349, 0.808080, 1.161683
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.237729, 0.915258, 1.485119
Train average loss residuals(Triplet, dist_p, dist_n) : 0.265309, 1.209562, 1.856641
Train average loss all      (Triplet)                 : 0.270792

== Recognize ==
Train average loss Recognize     : 0.354670
Train average accuracy drums     : 96.639999 %
Train average accuracy bass      : 91.415001 %
Train average accuracy piano     : 81.784996 %
Train average accuracy guitar    : 84.070000 %
Train average accuracy residuals : 90.010002 %

== Train average loss all : 0.381749

Epoch 22:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.524, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.275, Train/loss_recog_step=0.496, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]           Epoch 23:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.524, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.275, Train/loss_recog_step=0.496, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:   5%|▌         | 50/1000 [02:45<52:33,  0.30it/s, v_num=0, Train/loss_all_step=0.524, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.275, Train/loss_recog_step=0.496, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:   5%|▌         | 50/1000 [02:45<52:33,  0.30it/s, v_num=0, Train/loss_all_step=0.371, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.242, Train/loss_recog_step=0.347, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  10%|█         | 100/1000 [05:27<49:07,  0.31it/s, v_num=0, Train/loss_all_step=0.371, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.242, Train/loss_recog_step=0.347, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  10%|█         | 100/1000 [05:27<49:07,  0.31it/s, v_num=0, Train/loss_all_step=0.407, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.266, Train/loss_recog_step=0.381, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  15%|█▌        | 150/1000 [08:09<46:15,  0.31it/s, v_num=0, Train/loss_all_step=0.407, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.266, Train/loss_recog_step=0.381, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  15%|█▌        | 150/1000 [08:09<46:15,  0.31it/s, v_num=0, Train/loss_all_step=0.344, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.331, Train/loss_recog_step=0.311, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  20%|██        | 200/1000 [10:51<43:24,  0.31it/s, v_num=0, Train/loss_all_step=0.344, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.331, Train/loss_recog_step=0.311, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  20%|██        | 200/1000 [10:51<43:24,  0.31it/s, v_num=0, Train/loss_all_step=0.403, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.388, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  25%|██▌       | 250/1000 [13:31<40:34,  0.31it/s, v_num=0, Train/loss_all_step=0.403, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.388, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  25%|██▌       | 250/1000 [13:31<40:34,  0.31it/s, v_num=0, Train/loss_all_step=0.392, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.363, Train/loss_recog_step=0.355, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  30%|███       | 300/1000 [16:12<37:50,  0.31it/s, v_num=0, Train/loss_all_step=0.392, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.363, Train/loss_recog_step=0.355, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  30%|███       | 300/1000 [16:12<37:50,  0.31it/s, v_num=0, Train/loss_all_step=0.490, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.400, Train/loss_recog_step=0.450, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  35%|███▌      | 350/1000 [18:53<35:05,  0.31it/s, v_num=0, Train/loss_all_step=0.490, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.400, Train/loss_recog_step=0.450, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  35%|███▌      | 350/1000 [18:53<35:05,  0.31it/s, v_num=0, Train/loss_all_step=0.482, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.462, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  40%|████      | 400/1000 [21:35<32:23,  0.31it/s, v_num=0, Train/loss_all_step=0.482, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.462, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  40%|████      | 400/1000 [21:35<32:23,  0.31it/s, v_num=0, Train/loss_all_step=0.358, Train/loss_unet_all_step=0.319, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.347, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  45%|████▌     | 450/1000 [24:14<29:37,  0.31it/s, v_num=0, Train/loss_all_step=0.358, Train/loss_unet_all_step=0.319, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.347, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  45%|████▌     | 450/1000 [24:14<29:37,  0.31it/s, v_num=0, Train/loss_all_step=0.342, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.0969, Train/loss_recog_step=0.332, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  50%|█████     | 500/1000 [26:48<26:48,  0.31it/s, v_num=0, Train/loss_all_step=0.342, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.0969, Train/loss_recog_step=0.332, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  50%|█████     | 500/1000 [26:48<26:48,  0.31it/s, v_num=0, Train/loss_all_step=0.333, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.221, Train/loss_recog_step=0.311, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355] Epoch 23:  55%|█████▌    | 550/1000 [29:22<24:01,  0.31it/s, v_num=0, Train/loss_all_step=0.333, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.221, Train/loss_recog_step=0.311, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  55%|█████▌    | 550/1000 [29:22<24:01,  0.31it/s, v_num=0, Train/loss_all_step=0.323, Train/loss_unet_all_step=0.307, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=0.305, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  60%|██████    | 600/1000 [31:57<21:18,  0.31it/s, v_num=0, Train/loss_all_step=0.323, Train/loss_unet_all_step=0.307, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=0.305, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  60%|██████    | 600/1000 [31:57<21:18,  0.31it/s, v_num=0, Train/loss_all_step=0.283, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=0.271, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  65%|██████▌   | 650/1000 [34:36<18:38,  0.31it/s, v_num=0, Train/loss_all_step=0.283, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=0.271, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  65%|██████▌   | 650/1000 [34:36<18:38,  0.31it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.253, Train/loss_recog_step=0.328, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  70%|███████   | 700/1000 [37:15<15:58,  0.31it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.253, Train/loss_recog_step=0.328, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  70%|███████   | 700/1000 [37:15<15:58,  0.31it/s, v_num=0, Train/loss_all_step=0.501, Train/loss_unet_all_step=0.270, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=0.485, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  75%|███████▌  | 750/1000 [39:55<13:18,  0.31it/s, v_num=0, Train/loss_all_step=0.501, Train/loss_unet_all_step=0.270, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=0.485, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  75%|███████▌  | 750/1000 [39:55<13:18,  0.31it/s, v_num=0, Train/loss_all_step=0.410, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.235, Train/loss_recog_step=0.387, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  80%|████████  | 800/1000 [42:35<10:38,  0.31it/s, v_num=0, Train/loss_all_step=0.410, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.235, Train/loss_recog_step=0.387, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  80%|████████  | 800/1000 [42:35<10:38,  0.31it/s, v_num=0, Train/loss_all_step=0.431, Train/loss_unet_all_step=0.254, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.420, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  85%|████████▌ | 850/1000 [45:15<07:59,  0.31it/s, v_num=0, Train/loss_all_step=0.431, Train/loss_unet_all_step=0.254, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.420, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  85%|████████▌ | 850/1000 [45:15<07:59,  0.31it/s, v_num=0, Train/loss_all_step=0.306, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.300, Train/loss_recog_step=0.276, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  90%|█████████ | 900/1000 [47:54<05:19,  0.31it/s, v_num=0, Train/loss_all_step=0.306, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.300, Train/loss_recog_step=0.276, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  90%|█████████ | 900/1000 [47:54<05:19,  0.31it/s, v_num=0, Train/loss_all_step=0.373, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=0.356, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  95%|█████████▌| 950/1000 [50:34<02:39,  0.31it/s, v_num=0, Train/loss_all_step=0.373, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=0.356, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23:  95%|█████████▌| 950/1000 [50:34<02:39,  0.31it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.328, Train/loss_recog_step=0.419, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23: 100%|██████████| 1000/1000 [53:13<00:00,  0.31it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.328, Train/loss_recog_step=0.419, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23: 100%|██████████| 1000/1000 [53:13<00:00,  0.31it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.271, Train/loss_triplet_all_step=0.278, Train/loss_recog_step=0.397, Valid/loss_all_step=0.412, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.399, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.410, Valid/knn_avr=0.437, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:13<00:00,  0.60it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:13<00:00,  0.60it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:13<00:00,  0.61it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:12<00:00,  0.55it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:12<00:00,  0.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078429, 0.084342, 0.083750, 0.051787
Valid average loss UNet                 (all)                : 0.298307

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.159123, 1.258457, 2.513466
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.347202, 0.744911, 0.874492
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.527507, 1.340333, 1.369177
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.162223, 1.037466, 1.860094
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.544976, 1.461956, 1.606100
Valid average loss all      (Triplet)                 : 0.361881

== Recognize ==
Valid average loss Recognize     : 0.401404
Valid average accuracy drums     : 96.000000 %
Valid average accuracy bass      : 91.000000 %
Valid average accuracy piano     : 80.000000 %
Valid average accuracy guitar    : 62.000000 %
Valid average accuracy residuals : 92.000000 %

== Valid average loss all : 0.437592

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.740721225738525 sec. =
Valid knn accuracy drums     : 73.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.86879849433899 sec. =
Valid knn accuracy bass      : 15.524193548387096%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.034419536590576 sec. =
Valid knn accuracy piano     : 29.296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.754181623458862 sec. =
Valid knn accuracy guitar    : 43.526785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.4197416305542 sec. =
Valid knn accuracy residuals : 58.18181818181818%

Valid knn accuracy average   : 43.95810840194167%

                                                                      [AEpoch 23: 100%|██████████| 1000/1000 [56:19<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.271, Train/loss_triplet_all_step=0.278, Train/loss_recog_step=0.397, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.382, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.271, Train/loss_recog_epoch=0.355]Epoch 23: 100%|██████████| 1000/1000 [56:19<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.271, Train/loss_triplet_all_step=0.278, Train/loss_recog_step=0.397, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082118, 0.082017, 0.082201, 0.064530
Train average loss UNet                 (all)                : 0.310866

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.224987, 1.172955, 2.474930
Train average loss bass     (Triplet, dist_p, dist_n) : 0.350548, 0.785032, 0.923972
Train average loss piano    (Triplet, dist_p, dist_n) : 0.266486, 0.782803, 1.135592
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.240063, 0.926351, 1.500954
Train average loss residuals(Triplet, dist_p, dist_n) : 0.268973, 1.235013, 1.909900
Train average loss all      (Triplet)                 : 0.269139

== Recognize ==
Train average loss Recognize     : 0.349113
Train average accuracy drums     : 96.724998 %
Train average accuracy bass      : 91.549995 %
Train average accuracy piano     : 82.389999 %
Train average accuracy guitar    : 84.339996 %
Train average accuracy residuals : 90.209999 %

== Train average loss all : 0.376027

Epoch 23:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.271, Train/loss_triplet_all_step=0.278, Train/loss_recog_step=0.397, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]           Epoch 24:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.271, Train/loss_triplet_all_step=0.278, Train/loss_recog_step=0.397, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:   5%|▌         | 50/1000 [02:38<50:10,  0.32it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.271, Train/loss_triplet_all_step=0.278, Train/loss_recog_step=0.397, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:   5%|▌         | 50/1000 [02:38<50:10,  0.32it/s, v_num=0, Train/loss_all_step=0.427, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.214, Train/loss_recog_step=0.406, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  10%|█         | 100/1000 [05:12<46:48,  0.32it/s, v_num=0, Train/loss_all_step=0.427, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.214, Train/loss_recog_step=0.406, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  10%|█         | 100/1000 [05:12<46:48,  0.32it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=0.364, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  15%|█▌        | 150/1000 [07:45<43:55,  0.32it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=0.364, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  15%|█▌        | 150/1000 [07:45<43:55,  0.32it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.214, Train/loss_recog_step=0.327, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  20%|██        | 200/1000 [10:23<41:35,  0.32it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.214, Train/loss_recog_step=0.327, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  20%|██        | 200/1000 [10:23<41:35,  0.32it/s, v_num=0, Train/loss_all_step=0.416, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.399, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  25%|██▌       | 250/1000 [13:02<39:07,  0.32it/s, v_num=0, Train/loss_all_step=0.416, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.399, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  25%|██▌       | 250/1000 [13:02<39:07,  0.32it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.209, Train/loss_recog_step=0.430, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  30%|███       | 300/1000 [15:39<36:32,  0.32it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.209, Train/loss_recog_step=0.430, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  30%|███       | 300/1000 [15:39<36:32,  0.32it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.373, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  35%|███▌      | 350/1000 [18:18<34:00,  0.32it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.373, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  35%|███▌      | 350/1000 [18:18<34:00,  0.32it/s, v_num=0, Train/loss_all_step=0.381, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.367, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  40%|████      | 400/1000 [20:57<31:26,  0.32it/s, v_num=0, Train/loss_all_step=0.381, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.367, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  40%|████      | 400/1000 [20:57<31:26,  0.32it/s, v_num=0, Train/loss_all_step=0.349, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.334, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  45%|████▌     | 450/1000 [23:37<28:53,  0.32it/s, v_num=0, Train/loss_all_step=0.349, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.334, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  45%|████▌     | 450/1000 [23:37<28:53,  0.32it/s, v_num=0, Train/loss_all_step=0.352, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0818, Train/loss_recog_step=0.344, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  50%|█████     | 500/1000 [26:17<26:17,  0.32it/s, v_num=0, Train/loss_all_step=0.352, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0818, Train/loss_recog_step=0.344, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  50%|█████     | 500/1000 [26:17<26:17,  0.32it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.228, Train/loss_recog_step=0.360, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349] Epoch 24:  55%|█████▌    | 550/1000 [28:55<23:40,  0.32it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.228, Train/loss_recog_step=0.360, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  55%|█████▌    | 550/1000 [28:55<23:40,  0.32it/s, v_num=0, Train/loss_all_step=0.375, Train/loss_unet_all_step=0.316, Train/loss_triplet_all_step=0.231, Train/loss_recog_step=0.352, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  60%|██████    | 600/1000 [31:35<21:03,  0.32it/s, v_num=0, Train/loss_all_step=0.375, Train/loss_unet_all_step=0.316, Train/loss_triplet_all_step=0.231, Train/loss_recog_step=0.352, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  60%|██████    | 600/1000 [31:35<21:03,  0.32it/s, v_num=0, Train/loss_all_step=0.308, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=0.294, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  65%|██████▌   | 650/1000 [34:10<18:24,  0.32it/s, v_num=0, Train/loss_all_step=0.308, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=0.294, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  65%|██████▌   | 650/1000 [34:10<18:24,  0.32it/s, v_num=0, Train/loss_all_step=0.321, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.262, Train/loss_recog_step=0.295, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  70%|███████   | 700/1000 [36:44<15:44,  0.32it/s, v_num=0, Train/loss_all_step=0.321, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.262, Train/loss_recog_step=0.295, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  70%|███████   | 700/1000 [36:44<15:44,  0.32it/s, v_num=0, Train/loss_all_step=0.580, Train/loss_unet_all_step=0.248, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.566, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  75%|███████▌  | 750/1000 [39:17<13:05,  0.32it/s, v_num=0, Train/loss_all_step=0.580, Train/loss_unet_all_step=0.248, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.566, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  75%|███████▌  | 750/1000 [39:17<13:05,  0.32it/s, v_num=0, Train/loss_all_step=0.397, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.219, Train/loss_recog_step=0.375, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  80%|████████  | 800/1000 [41:52<10:28,  0.32it/s, v_num=0, Train/loss_all_step=0.397, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.219, Train/loss_recog_step=0.375, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  80%|████████  | 800/1000 [41:52<10:28,  0.32it/s, v_num=0, Train/loss_all_step=0.454, Train/loss_unet_all_step=0.257, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.433, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  85%|████████▌ | 850/1000 [44:31<07:51,  0.32it/s, v_num=0, Train/loss_all_step=0.454, Train/loss_unet_all_step=0.257, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.433, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  85%|████████▌ | 850/1000 [44:31<07:51,  0.32it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.339, Train/loss_recog_step=0.287, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  90%|█████████ | 900/1000 [47:11<05:14,  0.32it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.339, Train/loss_recog_step=0.287, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  90%|█████████ | 900/1000 [47:11<05:14,  0.32it/s, v_num=0, Train/loss_all_step=0.332, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.244, Train/loss_recog_step=0.308, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  95%|█████████▌| 950/1000 [49:51<02:37,  0.32it/s, v_num=0, Train/loss_all_step=0.332, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.244, Train/loss_recog_step=0.308, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24:  95%|█████████▌| 950/1000 [49:51<02:37,  0.32it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.472, Train/loss_recog_step=0.399, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24: 100%|██████████| 1000/1000 [52:28<00:00,  0.32it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.472, Train/loss_recog_step=0.399, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24: 100%|██████████| 1000/1000 [52:28<00:00,  0.32it/s, v_num=0, Train/loss_all_step=0.497, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.272, Train/loss_recog_step=0.470, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.0255, Valid/loss_recog_step=0.362, Valid/loss_all_epoch=0.438, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.440, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:13<00:00,  0.61it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:13<00:00,  0.59it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:13<00:00,  0.59it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:12<00:00,  0.55it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:12<00:00,  0.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078468, 0.084367, 0.083810, 0.053152
Valid average loss UNet                 (all)                : 0.299797

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.210052, 1.345151, 2.412997
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.437737, 0.903304, 0.950932
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.524640, 1.277503, 1.341749
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.212457, 1.062497, 1.662081
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.532122, 1.408864, 1.546784
Valid average loss all      (Triplet)                 : 0.377395

== Recognize ==
Valid average loss Recognize     : 0.406527
Valid average accuracy drums     : 96.000000 %
Valid average accuracy bass      : 90.000000 %
Valid average accuracy piano     : 81.500000 %
Valid average accuracy guitar    : 61.500000 %
Valid average accuracy residuals : 93.000000 %

== Valid average loss all : 0.444267

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.474576234817505 sec. =
Valid knn accuracy drums     : 73.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.239538431167603 sec. =
Valid knn accuracy bass      : 16.93548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.152107000350952 sec. =
Valid knn accuracy piano     : 28.515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.532446384429932 sec. =
Valid knn accuracy guitar    : 47.32142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.551721572875977 sec. =
Valid knn accuracy residuals : 56.36363636363636%

Valid knn accuracy average   : 44.52288693511958%

                                                                      [AEpoch 24: 100%|██████████| 1000/1000 [55:34<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.497, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.272, Train/loss_recog_step=0.470, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.376, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.269, Train/loss_recog_epoch=0.349]Epoch 24: 100%|██████████| 1000/1000 [55:34<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.497, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.272, Train/loss_recog_step=0.470, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082102, 0.082000, 0.082194, 0.065023
Train average loss UNet                 (all)                : 0.311319

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.221438, 1.184247, 2.503623
Train average loss bass     (Triplet, dist_p, dist_n) : 0.353115, 0.807076, 0.955162
Train average loss piano    (Triplet, dist_p, dist_n) : 0.264420, 0.804187, 1.184856
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.230326, 0.920183, 1.513570
Train average loss residuals(Triplet, dist_p, dist_n) : 0.268727, 1.241298, 1.909426
Train average loss all      (Triplet)                 : 0.267398

== Recognize ==
Train average loss Recognize     : 0.348732
Train average accuracy drums     : 96.919998 %
Train average accuracy bass      : 91.849998 %
Train average accuracy piano     : 82.094994 %
Train average accuracy guitar    : 84.619995 %
Train average accuracy residuals : 90.060005 %

== Train average loss all : 0.375472

Epoch 24:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.497, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.272, Train/loss_recog_step=0.470, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]           Epoch 25:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.497, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.272, Train/loss_recog_step=0.470, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:   5%|▌         | 50/1000 [02:45<52:29,  0.30it/s, v_num=0, Train/loss_all_step=0.497, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.272, Train/loss_recog_step=0.470, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:   5%|▌         | 50/1000 [02:45<52:29,  0.30it/s, v_num=0, Train/loss_all_step=0.367, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.352, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  10%|█         | 100/1000 [05:25<48:52,  0.31it/s, v_num=0, Train/loss_all_step=0.367, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.352, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  10%|█         | 100/1000 [05:25<48:52,  0.31it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.240, Train/loss_recog_step=0.381, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  15%|█▌        | 150/1000 [08:06<45:57,  0.31it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.240, Train/loss_recog_step=0.381, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  15%|█▌        | 150/1000 [08:06<45:57,  0.31it/s, v_num=0, Train/loss_all_step=0.336, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.269, Train/loss_recog_step=0.309, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  20%|██        | 200/1000 [10:43<42:54,  0.31it/s, v_num=0, Train/loss_all_step=0.336, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.269, Train/loss_recog_step=0.309, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  20%|██        | 200/1000 [10:43<42:54,  0.31it/s, v_num=0, Train/loss_all_step=0.386, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=0.366, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  25%|██▌       | 250/1000 [13:17<39:52,  0.31it/s, v_num=0, Train/loss_all_step=0.386, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=0.366, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  25%|██▌       | 250/1000 [13:17<39:52,  0.31it/s, v_num=0, Train/loss_all_step=0.381, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.217, Train/loss_recog_step=0.360, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  30%|███       | 300/1000 [15:50<36:57,  0.32it/s, v_num=0, Train/loss_all_step=0.381, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.217, Train/loss_recog_step=0.360, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  30%|███       | 300/1000 [15:50<36:57,  0.32it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=0.420, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  35%|███▌      | 350/1000 [18:25<34:12,  0.32it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=0.420, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  35%|███▌      | 350/1000 [18:25<34:12,  0.32it/s, v_num=0, Train/loss_all_step=0.398, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.0768, Train/loss_recog_step=0.390, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  40%|████      | 400/1000 [21:03<31:35,  0.32it/s, v_num=0, Train/loss_all_step=0.398, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.0768, Train/loss_recog_step=0.390, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  40%|████      | 400/1000 [21:03<31:35,  0.32it/s, v_num=0, Train/loss_all_step=0.358, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.347, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349] Epoch 25:  45%|████▌     | 450/1000 [23:41<28:57,  0.32it/s, v_num=0, Train/loss_all_step=0.358, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.347, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  45%|████▌     | 450/1000 [23:41<28:57,  0.32it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.0851, Train/loss_recog_step=0.345, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  50%|█████     | 500/1000 [26:20<26:20,  0.32it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.0851, Train/loss_recog_step=0.345, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  50%|█████     | 500/1000 [26:20<26:20,  0.32it/s, v_num=0, Train/loss_all_step=0.332, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.313, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349] Epoch 25:  55%|█████▌    | 550/1000 [28:57<23:41,  0.32it/s, v_num=0, Train/loss_all_step=0.332, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.313, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  55%|█████▌    | 550/1000 [28:57<23:41,  0.32it/s, v_num=0, Train/loss_all_step=0.344, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.329, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  60%|██████    | 600/1000 [31:35<21:03,  0.32it/s, v_num=0, Train/loss_all_step=0.344, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.329, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  60%|██████    | 600/1000 [31:35<21:03,  0.32it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.256, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  65%|██████▌   | 650/1000 [34:11<18:24,  0.32it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.256, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  65%|██████▌   | 650/1000 [34:11<18:24,  0.32it/s, v_num=0, Train/loss_all_step=0.349, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.226, Train/loss_recog_step=0.326, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  70%|███████   | 700/1000 [36:48<15:46,  0.32it/s, v_num=0, Train/loss_all_step=0.349, Train/loss_unet_all_step=0.362, Train/loss_triplet_all_step=0.226, Train/loss_recog_step=0.326, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  70%|███████   | 700/1000 [36:48<15:46,  0.32it/s, v_num=0, Train/loss_all_step=0.502, Train/loss_unet_all_step=0.256, Train/loss_triplet_all_step=0.196, Train/loss_recog_step=0.483, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  75%|███████▌  | 750/1000 [39:26<13:08,  0.32it/s, v_num=0, Train/loss_all_step=0.502, Train/loss_unet_all_step=0.256, Train/loss_triplet_all_step=0.196, Train/loss_recog_step=0.483, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  75%|███████▌  | 750/1000 [39:26<13:08,  0.32it/s, v_num=0, Train/loss_all_step=0.335, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.316, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  80%|████████  | 800/1000 [42:02<10:30,  0.32it/s, v_num=0, Train/loss_all_step=0.335, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.316, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  80%|████████  | 800/1000 [42:02<10:30,  0.32it/s, v_num=0, Train/loss_all_step=0.398, Train/loss_unet_all_step=0.247, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.379, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  85%|████████▌ | 850/1000 [44:35<07:52,  0.32it/s, v_num=0, Train/loss_all_step=0.398, Train/loss_unet_all_step=0.247, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.379, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  85%|████████▌ | 850/1000 [44:35<07:52,  0.32it/s, v_num=0, Train/loss_all_step=0.314, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.260, Train/loss_recog_step=0.288, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  90%|█████████ | 900/1000 [47:09<05:14,  0.32it/s, v_num=0, Train/loss_all_step=0.314, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.260, Train/loss_recog_step=0.288, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  90%|█████████ | 900/1000 [47:09<05:14,  0.32it/s, v_num=0, Train/loss_all_step=0.373, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.256, Train/loss_recog_step=0.347, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  95%|█████████▌| 950/1000 [49:40<02:36,  0.32it/s, v_num=0, Train/loss_all_step=0.373, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.256, Train/loss_recog_step=0.347, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25:  95%|█████████▌| 950/1000 [49:40<02:36,  0.32it/s, v_num=0, Train/loss_all_step=0.480, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.388, Train/loss_recog_step=0.442, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25: 100%|██████████| 1000/1000 [52:16<00:00,  0.32it/s, v_num=0, Train/loss_all_step=0.480, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.388, Train/loss_recog_step=0.442, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]Epoch 25: 100%|██████████| 1000/1000 [52:16<00:00,  0.32it/s, v_num=0, Train/loss_all_step=0.473, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=0.454, Valid/loss_all_step=0.445, Valid/loss_unet_all_step=0.292, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=0.439, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.407, Valid/knn_avr=0.445, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:13<00:00,  0.59it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:13<00:00,  0.59it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.57it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:13<00:00,  0.51it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:12<00:00,  0.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078362, 0.084298, 0.083717, 0.045334
Valid average loss UNet                 (all)                : 0.291711

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.335759, 1.403242, 2.377557
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.355178, 0.772050, 0.864480
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.577901, 1.218941, 1.342622
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.131857, 1.047236, 1.863962
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.417806, 1.205779, 1.554667
Valid average loss all      (Triplet)                 : 0.358985

== Recognize ==
Valid average loss Recognize     : 0.364783
Valid average accuracy drums     : 94.000000 %
Valid average accuracy bass      : 90.500000 %
Valid average accuracy piano     : 83.500000 %
Valid average accuracy guitar    : 66.500000 %
Valid average accuracy residuals : 92.500000 %

== Valid average loss all : 0.400682

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.433864116668701 sec. =
Valid knn accuracy drums     : 72.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.119726419448853 sec. =
Valid knn accuracy bass      : 17.137096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.220423460006714 sec. =
Valid knn accuracy piano     : 33.0078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.004324674606323 sec. =
Valid knn accuracy guitar    : 42.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.683598518371582 sec. =
Valid knn accuracy residuals : 63.40909090909091%

Valid knn accuracy average   : 45.62656090622211%

                                                                      [AEpoch 25: 100%|██████████| 1000/1000 [55:26<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.473, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=0.454, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.267, Train/loss_recog_epoch=0.349] Epoch 25: 100%|██████████| 1000/1000 [55:26<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.473, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=0.454, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082110, 0.082007, 0.082197, 0.064370
Train average loss UNet                 (all)                : 0.310685

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.219005, 1.183092, 2.504381
Train average loss bass     (Triplet, dist_p, dist_n) : 0.335846, 0.753880, 0.894429
Train average loss piano    (Triplet, dist_p, dist_n) : 0.253870, 0.771032, 1.146020
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.234803, 0.930043, 1.518932
Train average loss residuals(Triplet, dist_p, dist_n) : 0.249813, 1.220177, 1.918331
Train average loss all      (Triplet)                 : 0.257667

== Recognize ==
Train average loss Recognize     : 0.346956
Train average accuracy drums     : 96.680000 %
Train average accuracy bass      : 91.279999 %
Train average accuracy piano     : 82.684998 %
Train average accuracy guitar    : 84.479996 %
Train average accuracy residuals : 90.334999 %

== Train average loss all : 0.372723

Epoch 25:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.473, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=0.454, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]           Epoch 26:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.473, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=0.454, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:   5%|▌         | 50/1000 [02:44<52:08,  0.30it/s, v_num=0, Train/loss_all_step=0.473, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=0.454, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:   5%|▌         | 50/1000 [02:44<52:08,  0.30it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.365, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  10%|█         | 100/1000 [05:24<48:37,  0.31it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.365, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  10%|█         | 100/1000 [05:24<48:37,  0.31it/s, v_num=0, Train/loss_all_step=0.416, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.223, Train/loss_recog_step=0.394, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  15%|█▌        | 150/1000 [08:03<45:42,  0.31it/s, v_num=0, Train/loss_all_step=0.416, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.223, Train/loss_recog_step=0.394, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  15%|█▌        | 150/1000 [08:03<45:42,  0.31it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.204, Train/loss_recog_step=0.293, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  20%|██        | 200/1000 [10:44<42:56,  0.31it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.204, Train/loss_recog_step=0.293, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  20%|██        | 200/1000 [10:44<42:56,  0.31it/s, v_num=0, Train/loss_all_step=0.375, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.363, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  25%|██▌       | 250/1000 [13:26<40:20,  0.31it/s, v_num=0, Train/loss_all_step=0.375, Train/loss_unet_all_step=0.317, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.363, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  25%|██▌       | 250/1000 [13:26<40:20,  0.31it/s, v_num=0, Train/loss_all_step=0.382, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.224, Train/loss_recog_step=0.360, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  30%|███       | 300/1000 [16:06<37:34,  0.31it/s, v_num=0, Train/loss_all_step=0.382, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.224, Train/loss_recog_step=0.360, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  30%|███       | 300/1000 [16:06<37:34,  0.31it/s, v_num=0, Train/loss_all_step=0.430, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.213, Train/loss_recog_step=0.409, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  35%|███▌      | 350/1000 [18:46<34:52,  0.31it/s, v_num=0, Train/loss_all_step=0.430, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.213, Train/loss_recog_step=0.409, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  35%|███▌      | 350/1000 [18:46<34:52,  0.31it/s, v_num=0, Train/loss_all_step=0.411, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.0883, Train/loss_recog_step=0.403, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  40%|████      | 400/1000 [21:22<32:03,  0.31it/s, v_num=0, Train/loss_all_step=0.411, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.0883, Train/loss_recog_step=0.403, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  40%|████      | 400/1000 [21:22<32:03,  0.31it/s, v_num=0, Train/loss_all_step=0.340, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.327, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347] Epoch 26:  45%|████▌     | 450/1000 [23:56<29:15,  0.31it/s, v_num=0, Train/loss_all_step=0.340, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.327, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  45%|████▌     | 450/1000 [23:56<29:15,  0.31it/s, v_num=0, Train/loss_all_step=0.412, Train/loss_unet_all_step=0.310, Train/loss_triplet_all_step=0.0905, Train/loss_recog_step=0.402, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  50%|█████     | 500/1000 [26:30<26:30,  0.31it/s, v_num=0, Train/loss_all_step=0.412, Train/loss_unet_all_step=0.310, Train/loss_triplet_all_step=0.0905, Train/loss_recog_step=0.402, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  50%|█████     | 500/1000 [26:30<26:30,  0.31it/s, v_num=0, Train/loss_all_step=0.375, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.201, Train/loss_recog_step=0.355, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347] Epoch 26:  55%|█████▌    | 550/1000 [29:08<23:50,  0.31it/s, v_num=0, Train/loss_all_step=0.375, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.201, Train/loss_recog_step=0.355, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  55%|█████▌    | 550/1000 [29:08<23:50,  0.31it/s, v_num=0, Train/loss_all_step=0.310, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=0.293, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  60%|██████    | 600/1000 [31:46<21:11,  0.31it/s, v_num=0, Train/loss_all_step=0.310, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=0.293, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  60%|██████    | 600/1000 [31:46<21:11,  0.31it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.284, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  65%|██████▌   | 650/1000 [34:25<18:32,  0.31it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.284, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  65%|██████▌   | 650/1000 [34:25<18:32,  0.31it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.429, Train/loss_recog_step=0.348, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  70%|███████   | 700/1000 [37:03<15:53,  0.31it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.429, Train/loss_recog_step=0.348, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  70%|███████   | 700/1000 [37:03<15:53,  0.31it/s, v_num=0, Train/loss_all_step=0.606, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.281, Train/loss_recog_step=0.578, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  75%|███████▌  | 750/1000 [39:44<13:14,  0.31it/s, v_num=0, Train/loss_all_step=0.606, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.281, Train/loss_recog_step=0.578, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  75%|███████▌  | 750/1000 [39:44<13:14,  0.31it/s, v_num=0, Train/loss_all_step=0.364, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.346, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  80%|████████  | 800/1000 [42:23<10:35,  0.31it/s, v_num=0, Train/loss_all_step=0.364, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.346, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  80%|████████  | 800/1000 [42:23<10:35,  0.31it/s, v_num=0, Train/loss_all_step=0.448, Train/loss_unet_all_step=0.247, Train/loss_triplet_all_step=0.0515, Train/loss_recog_step=0.443, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  85%|████████▌ | 850/1000 [45:03<07:57,  0.31it/s, v_num=0, Train/loss_all_step=0.448, Train/loss_unet_all_step=0.247, Train/loss_triplet_all_step=0.0515, Train/loss_recog_step=0.443, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  85%|████████▌ | 850/1000 [45:03<07:57,  0.31it/s, v_num=0, Train/loss_all_step=0.351, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.315, Train/loss_recog_step=0.319, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347] Epoch 26:  90%|█████████ | 900/1000 [47:41<05:17,  0.31it/s, v_num=0, Train/loss_all_step=0.351, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.315, Train/loss_recog_step=0.319, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  90%|█████████ | 900/1000 [47:41<05:17,  0.31it/s, v_num=0, Train/loss_all_step=0.310, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.231, Train/loss_recog_step=0.286, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  95%|█████████▌| 950/1000 [50:19<02:38,  0.31it/s, v_num=0, Train/loss_all_step=0.310, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.231, Train/loss_recog_step=0.286, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26:  95%|█████████▌| 950/1000 [50:19<02:38,  0.31it/s, v_num=0, Train/loss_all_step=0.442, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.319, Train/loss_recog_step=0.410, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26: 100%|██████████| 1000/1000 [52:55<00:00,  0.31it/s, v_num=0, Train/loss_all_step=0.442, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.319, Train/loss_recog_step=0.410, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26: 100%|██████████| 1000/1000 [52:55<00:00,  0.31it/s, v_num=0, Train/loss_all_step=0.456, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.282, Train/loss_recog_step=0.428, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.275, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.292, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.365, Valid/knn_avr=0.456, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:18<00:00,  0.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:12<00:00,  0.62it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:12<00:00,  0.62it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:13<00:00,  0.61it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:12<00:00,  0.56it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:12<00:00,  0.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078416, 0.084346, 0.083753, 0.055903
Valid average loss UNet                 (all)                : 0.302418

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.124137, 1.125177, 2.402809
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.306472, 0.780292, 0.900355
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.480689, 1.194508, 1.366261
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.173873, 1.015381, 1.872780
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.583978, 1.438028, 1.598829
Valid average loss all      (Triplet)                 : 0.340585

== Recognize ==
Valid average loss Recognize     : 0.420002
Valid average accuracy drums     : 97.500000 %
Valid average accuracy bass      : 90.000000 %
Valid average accuracy piano     : 78.000000 %
Valid average accuracy guitar    : 61.500000 %
Valid average accuracy residuals : 93.000000 %

== Valid average loss all : 0.454060

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.726993083953857 sec. =
Valid knn accuracy drums     : 68.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.803152322769165 sec. =
Valid knn accuracy bass      : 14.717741935483872%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.188080787658691 sec. =
Valid knn accuracy piano     : 28.125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.619229316711426 sec. =
Valid knn accuracy guitar    : 40.848214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.37847089767456 sec. =
Valid knn accuracy residuals : 57.04545454545455%

Valid knn accuracy average   : 41.88641258811315%

                                                                      [AEpoch 26: 100%|██████████| 1000/1000 [55:58<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.456, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.282, Train/loss_recog_step=0.428, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.373, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.258, Train/loss_recog_epoch=0.347]Epoch 26: 100%|██████████| 1000/1000 [55:58<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.456, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.282, Train/loss_recog_step=0.428, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082099, 0.081994, 0.082182, 0.064467
Train average loss UNet                 (all)                : 0.310741

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.209105, 1.186086, 2.546029
Train average loss bass     (Triplet, dist_p, dist_n) : 0.329517, 0.754056, 0.912667
Train average loss piano    (Triplet, dist_p, dist_n) : 0.249276, 0.793060, 1.186729
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.235447, 0.939577, 1.521969
Train average loss residuals(Triplet, dist_p, dist_n) : 0.247482, 1.226501, 1.906262
Train average loss all      (Triplet)                 : 0.253382

== Recognize ==
Train average loss Recognize     : 0.345738
Train average accuracy drums     : 96.750000 %
Train average accuracy bass      : 91.654999 %
Train average accuracy piano     : 82.384995 %
Train average accuracy guitar    : 83.925003 %
Train average accuracy residuals : 90.480003 %

== Train average loss all : 0.371077

Epoch 26:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.456, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.282, Train/loss_recog_step=0.428, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]           Epoch 27:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.456, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.282, Train/loss_recog_step=0.428, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:   5%|▌         | 50/1000 [02:39<50:21,  0.31it/s, v_num=0, Train/loss_all_step=0.456, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.282, Train/loss_recog_step=0.428, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:   5%|▌         | 50/1000 [02:39<50:21,  0.31it/s, v_num=0, Train/loss_all_step=0.363, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.350, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  10%|█         | 100/1000 [05:14<47:08,  0.32it/s, v_num=0, Train/loss_all_step=0.363, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.350, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  10%|█         | 100/1000 [05:14<47:08,  0.32it/s, v_num=0, Train/loss_all_step=0.392, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=0.373, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  15%|█▌        | 150/1000 [07:55<44:56,  0.32it/s, v_num=0, Train/loss_all_step=0.392, Train/loss_unet_all_step=0.356, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=0.373, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  15%|█▌        | 150/1000 [07:55<44:56,  0.32it/s, v_num=0, Train/loss_all_step=0.311, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.200, Train/loss_recog_step=0.291, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  20%|██        | 200/1000 [10:33<42:14,  0.32it/s, v_num=0, Train/loss_all_step=0.311, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.200, Train/loss_recog_step=0.291, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  20%|██        | 200/1000 [10:33<42:14,  0.32it/s, v_num=0, Train/loss_all_step=0.369, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.143, Train/loss_recog_step=0.354, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  25%|██▌       | 250/1000 [13:10<39:31,  0.32it/s, v_num=0, Train/loss_all_step=0.369, Train/loss_unet_all_step=0.324, Train/loss_triplet_all_step=0.143, Train/loss_recog_step=0.354, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  25%|██▌       | 250/1000 [13:10<39:31,  0.32it/s, v_num=0, Train/loss_all_step=0.423, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.259, Train/loss_recog_step=0.397, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  30%|███       | 300/1000 [15:49<36:56,  0.32it/s, v_num=0, Train/loss_all_step=0.423, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.259, Train/loss_recog_step=0.397, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  30%|███       | 300/1000 [15:49<36:56,  0.32it/s, v_num=0, Train/loss_all_step=0.504, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.486, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  35%|███▌      | 350/1000 [18:27<34:16,  0.32it/s, v_num=0, Train/loss_all_step=0.504, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.486, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  35%|███▌      | 350/1000 [18:27<34:16,  0.32it/s, v_num=0, Train/loss_all_step=0.410, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=0.394, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  40%|████      | 400/1000 [21:05<31:37,  0.32it/s, v_num=0, Train/loss_all_step=0.410, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=0.394, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  40%|████      | 400/1000 [21:05<31:37,  0.32it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.316, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.307, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  45%|████▌     | 450/1000 [23:41<28:57,  0.32it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.316, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.307, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  45%|████▌     | 450/1000 [23:41<28:57,  0.32it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.0805, Train/loss_recog_step=0.382, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  50%|█████     | 500/1000 [26:20<26:20,  0.32it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.0805, Train/loss_recog_step=0.382, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  50%|█████     | 500/1000 [26:20<26:20,  0.32it/s, v_num=0, Train/loss_all_step=0.357, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.213, Train/loss_recog_step=0.336, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346] Epoch 27:  55%|█████▌    | 550/1000 [28:57<23:41,  0.32it/s, v_num=0, Train/loss_all_step=0.357, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.213, Train/loss_recog_step=0.336, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  55%|█████▌    | 550/1000 [28:57<23:41,  0.32it/s, v_num=0, Train/loss_all_step=0.346, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.326, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  60%|██████    | 600/1000 [31:29<20:59,  0.32it/s, v_num=0, Train/loss_all_step=0.346, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.326, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  60%|██████    | 600/1000 [31:29<20:59,  0.32it/s, v_num=0, Train/loss_all_step=0.295, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.228, Train/loss_recog_step=0.272, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  65%|██████▌   | 650/1000 [34:02<18:19,  0.32it/s, v_num=0, Train/loss_all_step=0.295, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.228, Train/loss_recog_step=0.272, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  65%|██████▌   | 650/1000 [34:02<18:19,  0.32it/s, v_num=0, Train/loss_all_step=0.371, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.281, Train/loss_recog_step=0.343, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  70%|███████   | 700/1000 [36:35<15:40,  0.32it/s, v_num=0, Train/loss_all_step=0.371, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.281, Train/loss_recog_step=0.343, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  70%|███████   | 700/1000 [36:35<15:40,  0.32it/s, v_num=0, Train/loss_all_step=0.606, Train/loss_unet_all_step=0.267, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=0.587, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  75%|███████▌  | 750/1000 [39:12<13:04,  0.32it/s, v_num=0, Train/loss_all_step=0.606, Train/loss_unet_all_step=0.267, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=0.587, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  75%|███████▌  | 750/1000 [39:12<13:04,  0.32it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=0.386, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  80%|████████  | 800/1000 [41:50<10:27,  0.32it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=0.386, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  80%|████████  | 800/1000 [41:50<10:27,  0.32it/s, v_num=0, Train/loss_all_step=0.423, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=0.407, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  85%|████████▌ | 850/1000 [44:28<07:50,  0.32it/s, v_num=0, Train/loss_all_step=0.423, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=0.407, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  85%|████████▌ | 850/1000 [44:28<07:50,  0.32it/s, v_num=0, Train/loss_all_step=0.326, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.250, Train/loss_recog_step=0.301, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  90%|█████████ | 900/1000 [47:06<05:14,  0.32it/s, v_num=0, Train/loss_all_step=0.326, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.250, Train/loss_recog_step=0.301, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  90%|█████████ | 900/1000 [47:06<05:14,  0.32it/s, v_num=0, Train/loss_all_step=0.340, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.322, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  95%|█████████▌| 950/1000 [49:43<02:37,  0.32it/s, v_num=0, Train/loss_all_step=0.340, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.322, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27:  95%|█████████▌| 950/1000 [49:43<02:37,  0.32it/s, v_num=0, Train/loss_all_step=0.498, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.407, Train/loss_recog_step=0.457, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27: 100%|██████████| 1000/1000 [52:24<00:00,  0.32it/s, v_num=0, Train/loss_all_step=0.498, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.407, Train/loss_recog_step=0.457, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]Epoch 27: 100%|██████████| 1000/1000 [52:24<00:00,  0.32it/s, v_num=0, Train/loss_all_step=0.487, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.285, Train/loss_recog_step=0.458, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.0234, Valid/loss_recog_step=0.436, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.420, Valid/knn_avr=0.419, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:13<00:00,  0.61it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:13<00:00,  0.60it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.57it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:13<00:00,  0.53it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:12<00:00,  0.55it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078450, 0.084354, 0.083752, 0.052901
Valid average loss UNet                 (all)                : 0.299457

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.163908, 1.365452, 2.686604
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.358134, 0.785734, 0.859971
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.508037, 1.113474, 1.350071
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.359190, 1.186376, 1.724836
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.464148, 1.425004, 1.663394
Valid average loss all      (Triplet)                 : 0.406226

== Recognize ==
Valid average loss Recognize     : 0.400504
Valid average accuracy drums     : 98.000000 %
Valid average accuracy bass      : 88.500000 %
Valid average accuracy piano     : 79.500000 %
Valid average accuracy guitar    : 66.500000 %
Valid average accuracy residuals : 89.500000 %

== Valid average loss all : 0.441127

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.5421621799469 sec. =
Valid knn accuracy drums     : 75.43478260869566%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.11315631866455 sec. =
Valid knn accuracy bass      : 12.701612903225806%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.812879800796509 sec. =
Valid knn accuracy piano     : 30.6640625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.593904495239258 sec. =
Valid knn accuracy guitar    : 37.276785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.53793454170227 sec. =
Valid knn accuracy residuals : 61.81818181818181%

Valid knn accuracy average   : 43.579085108877806%

                                                                      [AEpoch 27: 100%|██████████| 1000/1000 [55:32<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.487, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.285, Train/loss_recog_step=0.458, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.371, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.253, Train/loss_recog_epoch=0.346] Epoch 27: 100%|██████████| 1000/1000 [55:32<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.487, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.285, Train/loss_recog_step=0.458, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082117, 0.082017, 0.082206, 0.064656
Train average loss UNet                 (all)                : 0.310995

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.210181, 1.215116, 2.635451
Train average loss bass     (Triplet, dist_p, dist_n) : 0.326237, 0.756569, 0.918806
Train average loss piano    (Triplet, dist_p, dist_n) : 0.242183, 0.792073, 1.213228
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.221943, 0.922747, 1.544432
Train average loss residuals(Triplet, dist_p, dist_n) : 0.235609, 1.224192, 1.938595
Train average loss all      (Triplet)                 : 0.246432

== Recognize ==
Train average loss Recognize     : 0.342738
Train average accuracy drums     : 96.910004 %
Train average accuracy bass      : 91.885002 %
Train average accuracy piano     : 82.404999 %
Train average accuracy guitar    : 84.449997 %
Train average accuracy residuals : 90.294998 %

== Train average loss all : 0.367381

Epoch 27:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.487, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.285, Train/loss_recog_step=0.458, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]           Epoch 28:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.487, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.285, Train/loss_recog_step=0.458, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:   5%|▌         | 50/1000 [02:44<52:05,  0.30it/s, v_num=0, Train/loss_all_step=0.487, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.285, Train/loss_recog_step=0.458, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:   5%|▌         | 50/1000 [02:44<52:05,  0.30it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=0.352, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  10%|█         | 100/1000 [05:22<48:23,  0.31it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=0.352, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  10%|█         | 100/1000 [05:22<48:23,  0.31it/s, v_num=0, Train/loss_all_step=0.392, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=0.374, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  15%|█▌        | 150/1000 [07:59<45:16,  0.31it/s, v_num=0, Train/loss_all_step=0.392, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=0.374, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  15%|█▌        | 150/1000 [07:59<45:16,  0.31it/s, v_num=0, Train/loss_all_step=0.330, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.208, Train/loss_recog_step=0.310, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  20%|██        | 200/1000 [10:32<42:11,  0.32it/s, v_num=0, Train/loss_all_step=0.330, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.208, Train/loss_recog_step=0.310, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  20%|██        | 200/1000 [10:32<42:11,  0.32it/s, v_num=0, Train/loss_all_step=0.416, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.0855, Train/loss_recog_step=0.408, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  25%|██▌       | 250/1000 [13:06<39:20,  0.32it/s, v_num=0, Train/loss_all_step=0.416, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.0855, Train/loss_recog_step=0.408, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  25%|██▌       | 250/1000 [13:06<39:20,  0.32it/s, v_num=0, Train/loss_all_step=0.336, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.259, Train/loss_recog_step=0.310, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343] Epoch 28:  30%|███       | 300/1000 [15:46<36:49,  0.32it/s, v_num=0, Train/loss_all_step=0.336, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.259, Train/loss_recog_step=0.310, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  30%|███       | 300/1000 [15:46<36:49,  0.32it/s, v_num=0, Train/loss_all_step=0.434, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=0.422, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  35%|███▌      | 350/1000 [18:25<34:13,  0.32it/s, v_num=0, Train/loss_all_step=0.434, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=0.422, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  35%|███▌      | 350/1000 [18:25<34:13,  0.32it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.354, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  40%|████      | 400/1000 [21:03<31:35,  0.32it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.354, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  40%|████      | 400/1000 [21:03<31:35,  0.32it/s, v_num=0, Train/loss_all_step=0.325, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=0.312, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  45%|████▌     | 450/1000 [23:40<28:56,  0.32it/s, v_num=0, Train/loss_all_step=0.325, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=0.312, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  45%|████▌     | 450/1000 [23:40<28:56,  0.32it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.0905, Train/loss_recog_step=0.345, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  50%|█████     | 500/1000 [26:18<26:18,  0.32it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.0905, Train/loss_recog_step=0.345, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  50%|█████     | 500/1000 [26:18<26:18,  0.32it/s, v_num=0, Train/loss_all_step=0.344, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=0.326, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343] Epoch 28:  55%|█████▌    | 550/1000 [28:56<23:40,  0.32it/s, v_num=0, Train/loss_all_step=0.344, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=0.326, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  55%|█████▌    | 550/1000 [28:56<23:40,  0.32it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.309, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  60%|██████    | 600/1000 [31:34<21:02,  0.32it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.309, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  60%|██████    | 600/1000 [31:34<21:02,  0.32it/s, v_num=0, Train/loss_all_step=0.272, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.253, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  65%|██████▌   | 650/1000 [34:12<18:25,  0.32it/s, v_num=0, Train/loss_all_step=0.272, Train/loss_unet_all_step=0.300, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.253, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  65%|██████▌   | 650/1000 [34:12<18:25,  0.32it/s, v_num=0, Train/loss_all_step=0.382, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.276, Train/loss_recog_step=0.354, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  70%|███████   | 700/1000 [36:49<15:47,  0.32it/s, v_num=0, Train/loss_all_step=0.382, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.276, Train/loss_recog_step=0.354, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  70%|███████   | 700/1000 [36:49<15:47,  0.32it/s, v_num=0, Train/loss_all_step=0.543, Train/loss_unet_all_step=0.267, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=0.527, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  75%|███████▌  | 750/1000 [39:27<13:09,  0.32it/s, v_num=0, Train/loss_all_step=0.543, Train/loss_unet_all_step=0.267, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=0.527, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  75%|███████▌  | 750/1000 [39:27<13:09,  0.32it/s, v_num=0, Train/loss_all_step=0.352, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.338, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  80%|████████  | 800/1000 [41:59<10:29,  0.32it/s, v_num=0, Train/loss_all_step=0.352, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.338, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  80%|████████  | 800/1000 [41:59<10:29,  0.32it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.258, Train/loss_triplet_all_step=0.0601, Train/loss_recog_step=0.350, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  85%|████████▌ | 850/1000 [44:33<07:51,  0.32it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.258, Train/loss_triplet_all_step=0.0601, Train/loss_recog_step=0.350, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  85%|████████▌ | 850/1000 [44:33<07:51,  0.32it/s, v_num=0, Train/loss_all_step=0.374, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.267, Train/loss_recog_step=0.348, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343] Epoch 28:  90%|█████████ | 900/1000 [47:05<05:13,  0.32it/s, v_num=0, Train/loss_all_step=0.374, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.267, Train/loss_recog_step=0.348, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  90%|█████████ | 900/1000 [47:05<05:13,  0.32it/s, v_num=0, Train/loss_all_step=0.318, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.209, Train/loss_recog_step=0.297, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  95%|█████████▌| 950/1000 [49:45<02:37,  0.32it/s, v_num=0, Train/loss_all_step=0.318, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.209, Train/loss_recog_step=0.297, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28:  95%|█████████▌| 950/1000 [49:45<02:37,  0.32it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.383, Train/loss_recog_step=0.408, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28: 100%|██████████| 1000/1000 [52:22<00:00,  0.32it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.309, Train/loss_triplet_all_step=0.383, Train/loss_recog_step=0.408, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28: 100%|██████████| 1000/1000 [52:22<00:00,  0.32it/s, v_num=0, Train/loss_all_step=0.499, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.193, Train/loss_recog_step=0.480, Valid/loss_all_step=0.417, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=0.391, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=0.401, Valid/knn_avr=0.436, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:12<00:00,  0.62it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:13<00:00,  0.60it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.56it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:12<00:00,  0.55it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:12<00:00,  0.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078413, 0.084274, 0.083735, 0.053805
Valid average loss UNet                 (all)                : 0.300228

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.123438, 1.299338, 2.537996
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.443718, 0.899269, 0.996250
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.598603, 1.236137, 1.434022
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.356608, 1.397614, 1.951590
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.571784, 1.495030, 1.753374
Valid average loss all      (Triplet)                 : 0.442565

== Recognize ==
Valid average loss Recognize     : 0.389631
Valid average accuracy drums     : 98.000000 %
Valid average accuracy bass      : 91.500000 %
Valid average accuracy piano     : 84.000000 %
Valid average accuracy guitar    : 64.500000 %
Valid average accuracy residuals : 91.500000 %

== Valid average loss all : 0.433888

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.484772205352783 sec. =
Valid knn accuracy drums     : 70.43478260869566%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.017740249633789 sec. =
Valid knn accuracy bass      : 15.92741935483871%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.285072088241577 sec. =
Valid knn accuracy piano     : 27.1484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.971346378326416 sec. =
Valid knn accuracy guitar    : 42.63392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.432384252548218 sec. =
Valid knn accuracy residuals : 60.45454545454545%

Valid knn accuracy average   : 43.31982269790168%

                                                                      [AEpoch 28: 100%|██████████| 1000/1000 [55:30<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.499, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.193, Train/loss_recog_step=0.480, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.377, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.443, Valid/loss_recog_epoch=0.390, Valid/knn_avr=0.433, Train/loss_all_epoch=0.367, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.246, Train/loss_recog_epoch=0.343]Epoch 28: 100%|██████████| 1000/1000 [55:30<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.499, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.193, Train/loss_recog_step=0.480, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.377, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.443, Valid/loss_recog_epoch=0.390, Valid/knn_avr=0.433, Train/loss_all_epoch=0.362, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.242, Train/loss_recog_epoch=0.338]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082125, 0.082025, 0.082209, 0.064672
Train average loss UNet                 (all)                : 0.311032

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.204266, 1.210502, 2.628937
Train average loss bass     (Triplet, dist_p, dist_n) : 0.313867, 0.722001, 0.875680
Train average loss piano    (Triplet, dist_p, dist_n) : 0.247026, 0.817316, 1.242320
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.218179, 0.932310, 1.560286
Train average loss residuals(Triplet, dist_p, dist_n) : 0.230973, 1.218619, 1.949504
Train average loss all      (Triplet)                 : 0.242208

== Recognize ==
Train average loss Recognize     : 0.338196
Train average accuracy drums     : 96.860001 %
Train average accuracy bass      : 91.885002 %
Train average accuracy piano     : 82.924995 %
Train average accuracy guitar    : 85.119995 %
Train average accuracy residuals : 90.610001 %

== Train average loss all : 0.362417

Epoch 28: 100%|██████████| 1000/1000 [55:30<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.499, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.193, Train/loss_recog_step=0.480, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.377, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.443, Valid/loss_recog_epoch=0.390, Valid/knn_avr=0.433, Train/loss_all_epoch=0.362, Train/loss_unet_all_epoch=0.311, Train/loss_triplet_all_epoch=0.242, Train/loss_recog_epoch=0.338]
[2023-11-04 05:53:23,298][source.train][INFO] - [rank: 0] Starting testing!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
The length of seg for train is 3s.
The length of seg for valid and test is 3s.
----------------------------------------
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]ディレクトリを作成します
ディレクトリを作成します
ディレクトリを作成します
ディレクトリを作成します
ディレクトリを作成します
ディレクトリを作成します
Testing DataLoader 0: 100%|██████████| 16/16 [00:38<00:00,  0.42it/s]Testing DataLoader 0:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 1: 100%|██████████| 15/15 [00:30<00:00,  0.49it/s]Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 2:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 2: 100%|██████████| 15/15 [00:27<00:00,  0.54it/s]Testing DataLoader 2:   0%|          | 0/13 [00:00<?, ?it/s]         Testing DataLoader 3:   0%|          | 0/13 [00:00<?, ?it/s]Testing DataLoader 3: 100%|██████████| 13/13 [00:26<00:00,  0.49it/s]Testing DataLoader 3:   0%|          | 0/14 [00:00<?, ?it/s]         Testing DataLoader 4:   0%|          | 0/14 [00:00<?, ?it/s]Testing DataLoader 4: 100%|██████████| 14/14 [00:26<00:00,  0.52it/s]Testing DataLoader 4:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 5:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 5: 100%|██████████| 15/15 [00:28<00:00,  0.52it/s]
Test average accuracy drums     :  88.599998 %
Test average accuracy bass      :  86.900002 %
Test average accuracy piano     :  78.599998 %
Test average accuracy guitar    :  81.199997 %
Test average accuracy residuals :  85.099998 %
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.866112232208252 sec. =
Test knn accuracy drums     : 47.48908296943232%
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.3317768573761 sec. =
Test knn accuracy bass      : 17.829457364341085%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.164905786514282 sec. =
Test knn accuracy piano     : 26.763990267639905%
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.86133646965027 sec. =
Test knn accuracy guitar    : 20.475113122171944%
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.74425458908081 sec. =
Test knn accuracy residuals : 41.550053821313234%

Test knn accuracy average   : 30.8215395089797%
Testing DataLoader 5: 100%|██████████| 15/15 [02:11<00:00,  0.11it/s]
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 0    ┃   DataLoader 1    ┃   DataLoader 2   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.30821540951728… │ 0.30821540951728… │ 0.3082154095172… │
│   Test/knn_bass   │ 0.17829456925392… │ 0.17829456925392… │ 0.1782945692539… │
│  Test/knn_drums   │ 0.47489082813262… │ 0.47489082813262… │ 0.4748908281326… │
│  Test/knn_guitar  │ 0.20475113391876… │ 0.20475113391876… │ 0.2047511339187… │
│  Test/knn_piano   │ 0.26763990521430… │ 0.26763990521430… │ 0.2676399052143… │
│ Test/knn_residua… │ 0.41550055146217… │ 0.41550055146217… │ 0.4155005514621… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 3    ┃   DataLoader 4    ┃   DataLoader 5   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.30821540951728… │ 0.30821540951728… │ 0.3082154095172… │
│   Test/knn_bass   │ 0.17829456925392… │ 0.17829456925392… │ 0.1782945692539… │
│  Test/knn_drums   │ 0.47489082813262… │ 0.47489082813262… │ 0.4748908281326… │
│  Test/knn_guitar  │ 0.20475113391876… │ 0.20475113391876… │ 0.2047511339187… │
│  Test/knn_piano   │ 0.26763990521430… │ 0.26763990521430… │ 0.2676399052143… │
│ Test/knn_residua… │ 0.41550055146217… │ 0.41550055146217… │ 0.4155005514621… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
[2023-11-04 05:58:40,231][source.train][INFO] - [rank: 0] Best ckpt path: /nas02/homes/imamura23-1000067/outputs/triplet_with_unet/runs/2023-11-03/07-52-19/checkpoints/epoch_018.ckpt
[2023-11-04 05:58:40,233][utils.utils][INFO] - [rank: 0] Output dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023-11-03/07-52-19
[2023-11-04 05:58:40,236][utils.utils][INFO] - [rank: 0] Metric name is None! Skipping metric value retrieval...

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Time taken to study : 22:06:21

All prosess was Done!
