
=== Using cuda(utils.func). ===

[2023-11-16 21:16:49,596][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-16 21:16:49,602][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
â”œâ”€â”€ data
â”‚   â””â”€â”€ _target_: dataset.TripletDataModule                                     
â”‚       cfg:                                                                    
â”‚         n_epoch: 400                                                          
â”‚         inst_list:                                                            
â”‚         - drums                                                               
â”‚         - bass                                                                
â”‚         - piano                                                               
â”‚         - guitar                                                              
â”‚         - residuals                                                           
â”‚         dataset_dir: /nas03/assets/Dataset/slakh                              
â”‚         n_dataset_test: 1000                                                  
â”‚         batch_train: 64                                                       
â”‚         batch_test: 64                                                        
â”‚         num_workers: 8                                                        
â”‚         pin_memory: true                                                      
â”‚         datasetname: slakh                                                    
â”‚         load_using_librosa: false                                             
â”‚         mix_minus_inst: false                                                 
â”‚         test_psd_mine: false                                                  
â”‚         mel: true                                                             
â”‚         n_mels: 259                                                           
â”‚         mono: true                                                            
â”‚         f_size: 2048                                                          
â”‚         hop_length: 512                                                       
â”‚         seconds_psd_train: 3                                                  
â”‚         seconds_psd_valid: 10                                                 
â”‚         seconds_psd_test: 10                                                  
â”‚         offset_psd_train: 1.5                                                 
â”‚         offset_psd_valid: 5.0                                                 
â”‚         offset_psd_test: 10.0                                                 
â”‚         seconds_triplet_train: 3                                              
â”‚         seconds_triplet_valid: 3                                              
â”‚         offset_triplet_train: 1.5                                             
â”‚         offset_triplet_valid: 1.5                                             
â”‚         seconds_c32_train: 3                                                  
â”‚         seconds_c32_valid: 10                                                 
â”‚         seconds_c32_test: 10                                                  
â”‚         offset_c32_train: 1.5                                                 
â”‚         offset_c32_valid: 5.0                                                 
â”‚         offset_c32_test: 10.0                                                 
â”‚         sr: 44100                                                             
â”‚         db: true                                                              
â”‚         target: model.UNetForTriplet_2d_de5_to1d640                           
â”‚         to1d_mode: mean_linear                                                
â”‚         order: timefreq                                                       
â”‚         margin: 0.2                                                           
â”‚         monitor_es: Valid/knn_avr                                             
â”‚         monitor_mode_es: max                                                  
â”‚         triplet_rate: 1                                                       
â”‚         unet_rate: 0                                                          
â”‚         recog_rate: 0.01                                                      
â”‚         ckpt_model_path: /nas02/homes/imamura23-1000067/outputs/pretrain/runs/
â”‚         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
â”‚                                                                               
â”œâ”€â”€ model
â”‚   â””â”€â”€ _target_: model.Triplet                                                 
â”‚       optimizer:                                                              
â”‚         _target_: torch.optim.Adam                                            
â”‚         _partial_: true                                                       
â”‚         lr: 0.001                                                             
â”‚         weight_decay: 0.0                                                     
â”‚       scheduler: null                                                         
â”‚       net:                                                                    
â”‚         _target_: model.UNetForTriplet_2d_de5_to1d640                         
â”‚         inst_list:                                                            
â”‚         - drums                                                               
â”‚         - bass                                                                
â”‚         - piano                                                               
â”‚         - guitar                                                              
â”‚         - residuals                                                           
â”‚         f_size: 2048                                                          
â”‚         mono: true                                                            
â”‚         to1d_mode: mean_linear                                                
â”‚         order: timefreq                                                       
â”‚         mel: true                                                             
â”‚         n_mels: 259                                                           
â”‚       ckpt_model_path: /nas02/homes/imamura23-1000067/outputs/pretrain/runs/20
â”‚       cfg:                                                                    
â”‚         n_epoch: 400                                                          
â”‚         inst_list:                                                            
â”‚         - drums                                                               
â”‚         - bass                                                                
â”‚         - piano                                                               
â”‚         - guitar                                                              
â”‚         - residuals                                                           
â”‚         dataset_dir: /nas03/assets/Dataset/slakh                              
â”‚         n_dataset_test: 1000                                                  
â”‚         batch_train: 64                                                       
â”‚         batch_test: 64                                                        
â”‚         num_workers: 8                                                        
â”‚         pin_memory: true                                                      
â”‚         datasetname: slakh                                                    
â”‚         load_using_librosa: false                                             
â”‚         mix_minus_inst: false                                                 
â”‚         test_psd_mine: false                                                  
â”‚         mel: true                                                             
â”‚         n_mels: 259                                                           
â”‚         mono: true                                                            
â”‚         f_size: 2048                                                          
â”‚         hop_length: 512                                                       
â”‚         seconds_psd_train: 3                                                  
â”‚         seconds_psd_valid: 10                                                 
â”‚         seconds_psd_test: 10                                                  
â”‚         offset_psd_train: 1.5                                                 
â”‚         offset_psd_valid: 5.0                                                 
â”‚         offset_psd_test: 10.0                                                 
â”‚         seconds_triplet_train: 3                                              
â”‚         seconds_triplet_valid: 3                                              
â”‚         offset_triplet_train: 1.5                                             
â”‚         offset_triplet_valid: 1.5                                             
â”‚         seconds_c32_train: 3                                                  
â”‚         seconds_c32_valid: 10                                                 
â”‚         seconds_c32_test: 10                                                  
â”‚         offset_c32_train: 1.5                                                 
â”‚         offset_c32_valid: 5.0                                                 
â”‚         offset_c32_test: 10.0                                                 
â”‚         sr: 44100                                                             
â”‚         db: true                                                              
â”‚         target: model.UNetForTriplet_2d_de5_to1d640                           
â”‚         to1d_mode: mean_linear                                                
â”‚         order: timefreq                                                       
â”‚         margin: 0.2                                                           
â”‚         monitor_es: Valid/knn_avr                                             
â”‚         monitor_mode_es: max                                                  
â”‚         triplet_rate: 1                                                       
â”‚         unet_rate: 0                                                          
â”‚         recog_rate: 0.01                                                      
â”‚         ckpt_model_path: /nas02/homes/imamura23-1000067/outputs/pretrain/runs/
â”‚         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
â”‚                                                                               
â”œâ”€â”€ callbacks
â”‚   â””â”€â”€ model_checkpoint:                                                       
â”‚         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
â”‚         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
â”‚         filename: epoch_{epoch:03d}                                           
â”‚         monitor: Valid/knn_avr                                                
â”‚         verbose: true                                                         
â”‚         save_last: true                                                       
â”‚         save_top_k: -1                                                        
â”‚         mode: max                                                             
â”‚         auto_insert_metric_name: false                                        
â”‚         save_weights_only: false                                              
â”‚         every_n_train_steps: null                                             
â”‚         train_time_interval: null                                             
â”‚         every_n_epochs: null                                                  
â”‚         save_on_train_epoch_end: null                                         
â”‚       early_stopping:                                                         
â”‚         _target_: pytorch_lightning.callbacks.EarlyStopping                   
â”‚         monitor: Valid/knn_avr                                                
â”‚         min_delta: 0.0                                                        
â”‚         patience: 200                                                         
â”‚         verbose: true                                                         
â”‚         mode: max                                                             
â”‚         strict: true                                                          
â”‚         check_finite: true                                                    
â”‚         stopping_threshold: null                                              
â”‚         divergence_threshold: null                                            
â”‚         check_on_train_epoch_end: null                                        
â”‚       tqdm_progress_bar:                                                      
â”‚         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
â”‚         refresh_rate: 50                                                      
â”‚                                                                               
â”œâ”€â”€ logger
â”‚   â””â”€â”€ tensorboard:                                                            
â”‚         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
â”‚         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
â”‚         name: lightning_logs                                                  
â”‚         log_graph: false                                                      
â”‚         default_hp_metric: true                                               
â”‚         prefix: ''                                                            
â”‚                                                                               
â”œâ”€â”€ trainer
â”‚   â””â”€â”€ _target_: pytorch_lightning.trainer.Trainer                             
â”‚       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
â”‚       min_epochs: 1                                                           
â”‚       max_epochs: 400                                                         
â”‚       accelerator: auto                                                       
â”‚       devices: 1                                                              
â”‚       precision: 16                                                           
â”‚       num_sanity_val_steps: 0                                                 
â”‚       check_val_every_n_epoch: 1                                              
â”‚       deterministic: false                                                    
â”‚       enable_progress_bar: true                                               
â”‚       log_every_n_steps: 10                                                   
â”‚                                                                               
â”œâ”€â”€ paths
â”‚   â””â”€â”€ root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
â”‚       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
â”‚       log_dir: /home/imamura23/nas02home/outputs/                             
â”‚       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
â”‚       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
â”‚                                                                               
â”œâ”€â”€ extras
â”‚   â””â”€â”€ ignore_warnings: false                                                  
â”‚       enforce_tags: true                                                      
â”‚       print_config: true                                                      
â”‚                                                                               
â”œâ”€â”€ task_name
â”‚   â””â”€â”€ triplet_with_unet                                                       
â”œâ”€â”€ train
â”‚   â””â”€â”€ n_epoch: 400                                                            
â”‚       inst_list:                                                              
â”‚       - drums                                                                 
â”‚       - bass                                                                  
â”‚       - piano                                                                 
â”‚       - guitar                                                                
â”‚       - residuals                                                             
â”‚       dataset_dir: /nas03/assets/Dataset/slakh                                
â”‚       n_dataset_test: 1000                                                    
â”‚       batch_train: 64                                                         
â”‚       batch_test: 64                                                          
â”‚       num_workers: 8                                                          
â”‚       pin_memory: true                                                        
â”‚       datasetname: slakh                                                      
â”‚       load_using_librosa: false                                               
â”‚       mix_minus_inst: false                                                   
â”‚       test_psd_mine: false                                                    
â”‚       mel: true                                                               
â”‚       n_mels: 259                                                             
â”‚       mono: true                                                              
â”‚       f_size: 2048                                                            
â”‚       hop_length: 512                                                         
â”‚       seconds_psd_train: 3                                                    
â”‚       seconds_psd_valid: 10                                                   
â”‚       seconds_psd_test: 10                                                    
â”‚       offset_psd_train: 1.5                                                   
â”‚       offset_psd_valid: 5.0                                                   
â”‚       offset_psd_test: 10.0                                                   
â”‚       seconds_triplet_train: 3                                                
â”‚       seconds_triplet_valid: 3                                                
â”‚       offset_triplet_train: 1.5                                               
â”‚       offset_triplet_valid: 1.5                                               
â”‚       seconds_c32_train: 3                                                    
â”‚       seconds_c32_valid: 10                                                   
â”‚       seconds_c32_test: 10                                                    
â”‚       offset_c32_train: 1.5                                                   
â”‚       offset_c32_valid: 5.0                                                   
â”‚       offset_c32_test: 10.0                                                   
â”‚       sr: 44100                                                               
â”‚       db: true                                                                
â”‚       target: model.UNetForTriplet_2d_de5_to1d640                             
â”‚       to1d_mode: mean_linear                                                  
â”‚       order: timefreq                                                         
â”‚       margin: 0.2                                                             
â”‚       monitor_es: Valid/knn_avr                                               
â”‚       monitor_mode_es: max                                                    
â”‚       triplet_rate: 1                                                         
â”‚       unet_rate: 0                                                            
â”‚       recog_rate: 0.01                                                        
â”‚       ckpt_model_path: /nas02/homes/imamura23-1000067/outputs/pretrain/runs/20
â”‚       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
â”‚                                                                               
â”œâ”€â”€ test
â”‚   â””â”€â”€ True                                                                    
â”œâ”€â”€ tags
â”‚   â””â”€â”€ ['triplet', 'model_2d_to1d640_de5']                                     
â”œâ”€â”€ ckpt_path
â”‚   â””â”€â”€ None                                                                    
â””â”€â”€ seed
    â””â”€â”€ None                                                                    
[2023-11-16 21:16:49,689][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-16 21:16:49,712][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet_old). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640_addencoder). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de1_to1d640). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-16 21:16:54,487][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpn1a0vpxm
[2023-11-16 21:16:54,489][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpn1a0vpxm/_remote_module_non_scriptable.py
== Loading pretrained model...
== pretrained model was loaded!
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=3200, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-16 21:16:57,804][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-16 21:16:57,804][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-16 21:16:57,813][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-16 21:16:57,816][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-16 21:16:57,816][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-16 21:16:57,817][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-16 21:16:57,883][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-16 21:16:58,285][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-16 21:16:58,640][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.690648078918457 sec. *
Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|â–ˆâ–Œ        | 50/313 [01:24<07:24,  0.59it/s]Epoch 0:  16%|â–ˆâ–Œ        | 50/313 [01:24<07:24,  0.59it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=1.360]Epoch 0:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:28<05:16,  0.67it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=1.360]Epoch 0:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:28<05:16,  0.67it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.552, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.120]Epoch 0:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:31<03:49,  0.71it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.552, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.120]Epoch 0:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:31<03:49,  0.71it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.573, Train/loss_triplet_all_step=0.204, Train/loss_recog_step=0.940]Epoch 0:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:33<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.573, Train/loss_triplet_all_step=0.204, Train/loss_recog_step=0.940]Epoch 0:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:33<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=0.954]Epoch 0:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:34<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=0.954]Epoch 0:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:34<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=0.811]Epoch 0:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:38<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=0.811]Epoch 0:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:38<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.969]Epoch 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [06:51<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.969]Epoch 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [06:51<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.607, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=0.789]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:02<00:00,  2.00it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:06<00:00,  1.61it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:04<00:00,  2.56it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:04<00:00,  2.63it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  3.02it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  2.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.181514, 0.184870, 0.189348
Valid average loss UNet            (all)              : 0.555732

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070704, 0.241314, 0.538622
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.204658, 0.216815, 0.215440
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.237429, 0.323330, 0.303087
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.141910, 0.257677, 0.327563
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.137205, 0.318253, 0.403744
Valid average loss all      (Triplet)                 : 0.166030

== Recognize ==
Valid average loss Recognize     : 0.855277
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.174583

= T-SNE...
ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™
T-SNE was finished!
= T-SNE time is 14.372896194458008 sec. =
Valid knn accuracy drums     : 69.85294117647058%
= T-SNE...
ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™
T-SNE was finished!
= T-SNE time is 15.060459852218628 sec. =
Valid knn accuracy bass      : 11.19186046511628%
= T-SNE...
ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™
T-SNE was finished!
= T-SNE time is 16.044727325439453 sec. =
Valid knn accuracy piano     : 29.18918918918919%
= T-SNE...
ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™
T-SNE was finished!
= T-SNE time is 13.703914880752563 sec. =
Valid knn accuracy guitar    : 43.34415584415584%
= T-SNE...
ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™
T-SNE was finished!
= T-SNE time is 13.64518404006958 sec. =
Valid knn accuracy residuals : 62.42138364779875%

Valid knn accuracy average   : 43.199906064546134%

                                                                        [AEpoch 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:18<00:00,  0.56it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.607, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=0.789, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432]Epoch 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:18<00:00,  0.56it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.607, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=0.789, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.186905, 0.187244, 0.186057
Train average loss UNet            (all)              : 0.560205

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.083471, 0.348879, 0.636475
Train average loss bass     (Triplet, dist_p, dist_n) : 0.207923, 0.335447, 0.340525
Train average loss piano    (Triplet, dist_p, dist_n) : 0.199516, 0.415574, 0.434311
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.179485, 0.403649, 0.459637
Train average loss residuals(Triplet, dist_p, dist_n) : 0.158340, 0.462188, 0.553935
Train average loss all      (Triplet)                 : 0.166821

== Recognize ==
Train average loss Recognize     : 1.150692
Train average accuracy drums     : 87.311668 %
Train average accuracy bass      : 89.143333 %
Train average accuracy piano     : 85.733337 %
Train average accuracy guitar    : 80.441666 %
Train average accuracy residuals : 87.635002 %

== Train average loss all : 0.178328

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.607, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=0.789, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.607, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=0.789, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]Epoch 1:  16%|â–ˆâ–Œ        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.607, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=0.789, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]Epoch 1:  16%|â–ˆâ–Œ        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=0.830, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]Epoch 1:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=0.830, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]Epoch 1:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=0.882, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]Epoch 1:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=0.882, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]Epoch 1:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.574, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=0.730, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]Epoch 1:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.574, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=0.730, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]Epoch 1:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.840, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]Epoch 1:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.840, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]Epoch 1:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.744, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]Epoch 1:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:08<00:15,  0.81it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.744, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]Epoch 1:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:08<00:15,  0.81it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.143, Train/loss_recog_step=0.931, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]Epoch 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.143, Train/loss_recog_step=0.931, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]Epoch 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.605, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=0.730, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.175, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.855, Valid/knn_avr=0.432, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:02<00:00,  1.96it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.37it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.46it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:03<00:00,  3.28it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:02<00:00,  3.47it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:02<00:00,  3.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.179778, 0.182972, 0.187185
Valid average loss UNet            (all)              : 0.549934

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073538, 0.236045, 0.527929
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.185138, 0.210594, 0.227426
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.198802, 0.284326, 0.296960
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.145707, 0.279019, 0.349268
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.135519, 0.304770, 0.398220
Valid average loss all      (Triplet)                 : 0.154741

== Recognize ==
Valid average loss Recognize     : 0.810389
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.162845

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.253273487091064 sec. =
Valid knn accuracy drums     : 70.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.74659252166748 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.332653284072876 sec. =
Valid knn accuracy piano     : 31.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.233485221862793 sec. =
Valid knn accuracy guitar    : 31.16883116883117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.6611967086792 sec. =
Valid knn accuracy residuals : 57.23270440251572%

Valid knn accuracy average   : 40.921147133495175%

                                                                        [AEpoch 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [08:24<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.605, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=0.730, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.150]Epoch 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [08:24<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.605, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=0.730, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.186922, 0.187265, 0.186054
Train average loss UNet            (all)              : 0.560241

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.062905, 0.274148, 0.619396
Train average loss bass     (Triplet, dist_p, dist_n) : 0.185441, 0.246075, 0.277501
Train average loss piano    (Triplet, dist_p, dist_n) : 0.173780, 0.309334, 0.356423
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.153529, 0.297112, 0.387061
Train average loss residuals(Triplet, dist_p, dist_n) : 0.130671, 0.373894, 0.497904
Train average loss all      (Triplet)                 : 0.142275

== Recognize ==
Train average loss Recognize     : 0.858260
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.150857

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.605, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=0.730, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.605, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=0.730, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]Epoch 2:  16%|â–ˆâ–Œ        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.605, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=0.730, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]Epoch 2:  16%|â–ˆâ–Œ        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=0.779, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]Epoch 2:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=0.779, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]Epoch 2:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.852, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]Epoch 2:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.852, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]Epoch 2:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=0.698, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]Epoch 2:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=0.698, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]Epoch 2:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=0.809, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]Epoch 2:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=0.809, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]Epoch 2:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.0982, Train/loss_recog_step=0.710, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]Epoch 2:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.0982, Train/loss_recog_step=0.710, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]Epoch 2:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.143, Train/loss_recog_step=0.914, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858] Epoch 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.143, Train/loss_recog_step=0.914, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]Epoch 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.603, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.703, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.409, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:01<00:00,  2.09it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.48it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.44it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:03<00:00,  3.41it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:02<00:00,  3.51it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:02<00:00,  3.42it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.181959, 0.185308, 0.189526
Valid average loss UNet            (all)              : 0.556792

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064353, 0.275431, 0.666188
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.161128, 0.254007, 0.308827
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.207093, 0.341521, 0.369506
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.174103, 0.305665, 0.395704
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.119813, 0.311888, 0.499276
Valid average loss all      (Triplet)                 : 0.149094

== Recognize ==
Valid average loss Recognize     : 0.787475
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.156969

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.123981952667236 sec. =
Valid knn accuracy drums     : 67.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.62422490119934 sec. =
Valid knn accuracy bass      : 15.55232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.663793087005615 sec. =
Valid knn accuracy piano     : 32.027027027027025%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.240013837814331 sec. =
Valid knn accuracy guitar    : 25.649350649350648%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.346651554107666 sec. =
Valid knn accuracy residuals : 65.09433962264151%

Valid knn accuracy average   : 41.25284387020056%

                                                                        [AEpoch 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [08:31<00:00,  0.61it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.603, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.703, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=0.858]Epoch 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [08:31<00:00,  0.61it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.603, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.703, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.187153, 0.187483, 0.186257
Train average loss UNet            (all)              : 0.560893

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.055584, 0.300934, 0.683577
Train average loss bass     (Triplet, dist_p, dist_n) : 0.172182, 0.274075, 0.326892
Train average loss piano    (Triplet, dist_p, dist_n) : 0.158290, 0.340911, 0.415350
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.140583, 0.328828, 0.448412
Train average loss residuals(Triplet, dist_p, dist_n) : 0.122108, 0.411093, 0.556201
Train average loss all      (Triplet)                 : 0.130907

== Recognize ==
Train average loss Recognize     : 0.829407
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.139201

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.603, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.703, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.603, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.703, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]Epoch 3:  16%|â–ˆâ–Œ        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.603, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.703, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]Epoch 3:  16%|â–ˆâ–Œ        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=0.759, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]Epoch 3:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=0.759, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]Epoch 3:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.839, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]Epoch 3:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.839, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]Epoch 3:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.572, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.681, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]Epoch 3:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:11<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.572, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.681, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]Epoch 3:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:11<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.0999, Train/loss_recog_step=0.803, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]Epoch 3:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:13<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.0999, Train/loss_recog_step=0.803, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]Epoch 3:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:13<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.0987, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.0916, Train/loss_recog_step=0.707, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]Epoch 3:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0987, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.0916, Train/loss_recog_step=0.707, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]Epoch 3:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.553, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.911, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]  Epoch 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.553, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.911, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]Epoch 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.603, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.688, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.157, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.413, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:01<00:00,  2.10it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.14it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.02it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:03<00:00,  3.09it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  3.23it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  3.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.184090, 0.187514, 0.192198
Valid average loss UNet            (all)              : 0.563802

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.082898, 0.320141, 0.667993
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.189535, 0.278443, 0.292342
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.214198, 0.378992, 0.383652
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.129609, 0.301913, 0.416013
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.127392, 0.378151, 0.527792
Valid average loss all      (Triplet)                 : 0.152345

== Recognize ==
Valid average loss Recognize     : 0.773127
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.160076

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.432573080062866 sec. =
Valid knn accuracy drums     : 71.61764705882354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.583184957504272 sec. =
Valid knn accuracy bass      : 16.424418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.915380954742432 sec. =
Valid knn accuracy piano     : 25.810810810810807%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.203832387924194 sec. =
Valid knn accuracy guitar    : 28.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.596476793289185 sec. =
Valid knn accuracy residuals : 59.74842767295597%

Valid knn accuracy average   : 40.434546543734015%

                                                                        [AEpoch 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [08:33<00:00,  0.61it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.603, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.688, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.829]Epoch 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [08:33<00:00,  0.61it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.603, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.688, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.186696, 0.187029, 0.185860
Train average loss UNet            (all)              : 0.559585

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.049135, 0.352998, 0.808365
Train average loss bass     (Triplet, dist_p, dist_n) : 0.166583, 0.309344, 0.375655
Train average loss piano    (Triplet, dist_p, dist_n) : 0.149643, 0.381523, 0.474320
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.129901, 0.372886, 0.520116
Train average loss residuals(Triplet, dist_p, dist_n) : 0.110324, 0.455257, 0.628871
Train average loss all      (Triplet)                 : 0.122065

== Recognize ==
Train average loss Recognize     : 0.817939
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.130244

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.603, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.688, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.603, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.688, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]Epoch 4:  16%|â–ˆâ–Œ        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.603, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.688, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]Epoch 4:  16%|â–ˆâ–Œ        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.746, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]Epoch 4:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.746, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]Epoch 4:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=0.831, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]Epoch 4:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=0.831, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]Epoch 4:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.573, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=0.671, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]Epoch 4:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.573, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=0.671, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]Epoch 4:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0925, Train/loss_recog_step=0.797, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]Epoch 4:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0925, Train/loss_recog_step=0.797, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]Epoch 4:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.0853, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.0783, Train/loss_recog_step=0.698, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]Epoch 4:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:13<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0853, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.0783, Train/loss_recog_step=0.698, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]Epoch 4:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:13<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=0.909, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]  Epoch 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=0.909, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]Epoch 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.599, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.679, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.572, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.404, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:02<00:00,  1.97it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.36it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.48it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:03<00:00,  3.51it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:02<00:00,  3.39it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  3.31it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.184249, 0.187288, 0.192783
Valid average loss UNet            (all)              : 0.564320

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065022, 0.386700, 0.820875
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.168460, 0.353372, 0.415198
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.201018, 0.462822, 0.490630
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.127420, 0.387513, 0.565738
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.119721, 0.462803, 0.661509
Valid average loss all      (Triplet)                 : 0.137306

== Recognize ==
Valid average loss Recognize     : 0.768277
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.144989

= T-SNE...
T-SNE was finished!
= T-SNE time is 16.74435782432556 sec. =
Valid knn accuracy drums     : 70.1470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.11836886405945 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.29717230796814 sec. =
Valid knn accuracy piano     : 28.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.91945481300354 sec. =
Valid knn accuracy guitar    : 36.688311688311686%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.004559993743896 sec. =
Valid knn accuracy residuals : 58.64779874213837%

Valid knn accuracy average   : 41.787394378765725%

                                                                        [AEpoch 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [08:44<00:00,  0.60it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.599, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.679, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.818]Epoch 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [08:44<00:00,  0.60it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.599, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.679, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.186734, 0.187076, 0.185872
Train average loss UNet            (all)              : 0.559682

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.043131, 0.378271, 0.868368
Train average loss bass     (Triplet, dist_p, dist_n) : 0.156324, 0.341612, 0.425560
Train average loss piano    (Triplet, dist_p, dist_n) : 0.134391, 0.428553, 0.552969
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.123803, 0.426969, 0.597104
Train average loss residuals(Triplet, dist_p, dist_n) : 0.103565, 0.503553, 0.699893
Train average loss all      (Triplet)                 : 0.113400

== Recognize ==
Train average loss Recognize     : 0.810797
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.121508

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.599, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.679, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.599, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.679, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]Epoch 5:  16%|â–ˆâ–Œ        | 50/313 [01:14<06:31,  0.67it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.599, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.679, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]Epoch 5:  16%|â–ˆâ–Œ        | 50/313 [01:14<06:31,  0.67it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=0.743, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]Epoch 5:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:19<04:56,  0.72it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=0.743, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]Epoch 5:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:19<04:56,  0.72it/s, v_num=0, Train/loss_all_step=0.086, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.0778, Train/loss_recog_step=0.827, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]Epoch 5:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.086, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.0778, Train/loss_recog_step=0.827, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]Epoch 5:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.659, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811] Epoch 5:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:28<02:31,  0.75it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.659, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]Epoch 5:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:28<02:31,  0.75it/s, v_num=0, Train/loss_all_step=0.095, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0871, Train/loss_recog_step=0.789, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]Epoch 5:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:31<01:23,  0.75it/s, v_num=0, Train/loss_all_step=0.095, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0871, Train/loss_recog_step=0.789, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]Epoch 5:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:31<01:23,  0.75it/s, v_num=0, Train/loss_all_step=0.0804, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.0735, Train/loss_recog_step=0.687, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]Epoch 5:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:35<00:17,  0.76it/s, v_num=0, Train/loss_all_step=0.0804, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.0735, Train/loss_recog_step=0.687, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]Epoch 5:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:35<00:17,  0.76it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.553, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.911, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]  Epoch 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [06:48<00:00,  0.77it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.553, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.911, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]Epoch 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [06:48<00:00,  0.77it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.600, Train/loss_triplet_all_step=0.0942, Train/loss_recog_step=0.670, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.570, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.564, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.418, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:02<00:00,  1.94it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.48it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.32it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:03<00:00,  3.28it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:02<00:00,  3.47it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  3.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.183572, 0.186461, 0.192269
Valid average loss UNet            (all)              : 0.562302

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.040102, 0.436978, 0.943040
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.229005, 0.451505, 0.440477
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.188477, 0.530468, 0.612148
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.112561, 0.498741, 0.753613
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.134293, 0.573013, 0.804605
Valid average loss all      (Triplet)                 : 0.152099

== Recognize ==
Valid average loss Recognize     : 0.763950
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.159738

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.985289335250854 sec. =
Valid knn accuracy drums     : 69.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.49436902999878 sec. =
Valid knn accuracy bass      : 12.645348837209303%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.143439054489136 sec. =
Valid knn accuracy piano     : 23.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.973121643066406 sec. =
Valid knn accuracy guitar    : 37.17532467532468%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.2247474193573 sec. =
Valid knn accuracy residuals : 57.861635220125784%

Valid knn accuracy average   : 40.2025984714922%

                                                                        [AEpoch 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:07<00:00,  0.57it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.600, Train/loss_triplet_all_step=0.0942, Train/loss_recog_step=0.670, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.811]Epoch 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:07<00:00,  0.57it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.600, Train/loss_triplet_all_step=0.0942, Train/loss_recog_step=0.670, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.186765, 0.187068, 0.185900
Train average loss UNet            (all)              : 0.559734

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.037843, 0.432288, 0.976852
Train average loss bass     (Triplet, dist_p, dist_n) : 0.148814, 0.390942, 0.492614
Train average loss piano    (Triplet, dist_p, dist_n) : 0.123071, 0.478137, 0.627704
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.116743, 0.470471, 0.655225
Train average loss residuals(Triplet, dist_p, dist_n) : 0.093215, 0.555571, 0.784271
Train average loss all      (Triplet)                 : 0.104954

== Recognize ==
Train average loss Recognize     : 0.805075
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.113005

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.600, Train/loss_triplet_all_step=0.0942, Train/loss_recog_step=0.670, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.600, Train/loss_triplet_all_step=0.0942, Train/loss_recog_step=0.670, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]Epoch 6:  16%|â–ˆâ–Œ        | 50/313 [01:14<06:29,  0.67it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.600, Train/loss_triplet_all_step=0.0942, Train/loss_recog_step=0.670, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]Epoch 6:  16%|â–ˆâ–Œ        | 50/313 [01:14<06:29,  0.67it/s, v_num=0, Train/loss_all_step=0.0856, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.0782, Train/loss_recog_step=0.734, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]Epoch 6:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.0856, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.0782, Train/loss_recog_step=0.734, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]Epoch 6:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.078, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0698, Train/loss_recog_step=0.823, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805] Epoch 6:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:23<03:40,  0.74it/s, v_num=0, Train/loss_all_step=0.078, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0698, Train/loss_recog_step=0.823, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]Epoch 6:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:23<03:40,  0.74it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.654, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805] Epoch 6:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:28<02:31,  0.75it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.654, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]Epoch 6:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:28<02:31,  0.75it/s, v_num=0, Train/loss_all_step=0.073, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.0651, Train/loss_recog_step=0.789, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]Epoch 6:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:33<01:23,  0.75it/s, v_num=0, Train/loss_all_step=0.073, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.0651, Train/loss_recog_step=0.789, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]Epoch 6:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:33<01:23,  0.75it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.542, Train/loss_triplet_all_step=0.0522, Train/loss_recog_step=0.688, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]Epoch 6:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:37<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.542, Train/loss_triplet_all_step=0.0522, Train/loss_recog_step=0.688, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]Epoch 6:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:37<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.905, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]  Epoch 6: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [06:50<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.905, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]Epoch 6: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [06:50<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.0617, Train/loss_recog_step=0.668, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.873, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.402, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:02<00:00,  1.82it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.12it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.13it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:03<00:00,  3.08it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  3.24it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  3.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.179942, 0.182846, 0.187942
Valid average loss UNet            (all)              : 0.550729

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065469, 0.485565, 0.975569
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.263037, 0.539277, 0.512256
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.215227, 0.623070, 0.705802
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.128528, 0.586670, 0.799155
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.133825, 0.725048, 1.034041
Valid average loss all      (Triplet)                 : 0.178696

== Recognize ==
Valid average loss Recognize     : 0.757895
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.186275

= T-SNE...
T-SNE was finished!
= T-SNE time is 17.54778480529785 sec. =
Valid knn accuracy drums     : 71.61764705882354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.685086488723755 sec. =
Valid knn accuracy bass      : 13.372093023255813%
= T-SNE...
T-SNE was finished!
= T-SNE time is 21.132683277130127 sec. =
Valid knn accuracy piano     : 32.027027027027025%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.583304166793823 sec. =
Valid knn accuracy guitar    : 39.44805194805195%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.506866455078125 sec. =
Valid knn accuracy residuals : 59.43396226415094%

Valid knn accuracy average   : 43.179756264261854%

                                                                        [AEpoch 6: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:25<00:00,  0.55it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.0617, Train/loss_recog_step=0.668, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.805]Epoch 6: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:25<00:00,  0.55it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.0617, Train/loss_recog_step=0.668, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.186936, 0.187253, 0.186083
Train average loss UNet            (all)              : 0.560271

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.033235, 0.491431, 1.068946
Train average loss bass     (Triplet, dist_p, dist_n) : 0.139285, 0.450636, 0.576301
Train average loss piano    (Triplet, dist_p, dist_n) : 0.114780, 0.531785, 0.706663
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.104255, 0.525208, 0.746818
Train average loss residuals(Triplet, dist_p, dist_n) : 0.083156, 0.620341, 0.882467
Train average loss all      (Triplet)                 : 0.096080

== Recognize ==
Train average loss Recognize     : 0.801704
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.104097

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.0617, Train/loss_recog_step=0.668, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.0617, Train/loss_recog_step=0.668, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]Epoch 7:  16%|â–ˆâ–Œ        | 50/313 [01:18<06:52,  0.64it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.0617, Train/loss_recog_step=0.668, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]Epoch 7:  16%|â–ˆâ–Œ        | 50/313 [01:18<06:52,  0.64it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0602, Train/loss_recog_step=0.730, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]Epoch 7:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:26<05:11,  0.68it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0602, Train/loss_recog_step=0.730, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]Epoch 7:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:26<05:11,  0.68it/s, v_num=0, Train/loss_all_step=0.074, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.0658, Train/loss_recog_step=0.821, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802] Epoch 7:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:34<03:52,  0.70it/s, v_num=0, Train/loss_all_step=0.074, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.0658, Train/loss_recog_step=0.821, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]Epoch 7:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:34<03:52,  0.70it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.573, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.645, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802] Epoch 7:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:42<02:39,  0.71it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.573, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.645, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]Epoch 7:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:42<02:39,  0.71it/s, v_num=0, Train/loss_all_step=0.0826, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.0748, Train/loss_recog_step=0.786, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]Epoch 7:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:50<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.0826, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.0748, Train/loss_recog_step=0.786, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]Epoch 7:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:50<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.0467, Train/loss_unet_all_step=0.542, Train/loss_triplet_all_step=0.0399, Train/loss_recog_step=0.684, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]Epoch 7:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:56<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.0467, Train/loss_unet_all_step=0.542, Train/loss_triplet_all_step=0.0399, Train/loss_recog_step=0.684, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]Epoch 7:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:56<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.553, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=0.909, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]  Epoch 7: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [07:09<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.553, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=0.909, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]Epoch 7: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [07:09<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0388, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=0.663, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.557, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.432, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.13it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.21it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:04<00:00,  2.87it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  3.18it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  3.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178845, 0.181519, 0.186225
Valid average loss UNet            (all)              : 0.546589

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.097602, 0.565289, 0.986788
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.252637, 0.560358, 0.534409
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.202601, 0.610405, 0.718909
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.135114, 0.599454, 0.785063
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.142082, 0.716456, 0.889287
Valid average loss all      (Triplet)                 : 0.182645

== Recognize ==
Valid average loss Recognize     : 0.756438
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.190209

= T-SNE...
T-SNE was finished!
= T-SNE time is 17.520506381988525 sec. =
Valid knn accuracy drums     : 71.61764705882354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.621173858642578 sec. =
Valid knn accuracy bass      : 11.918604651162791%
= T-SNE...
T-SNE was finished!
= T-SNE time is 20.6900954246521 sec. =
Valid knn accuracy piano     : 34.86486486486486%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.161412477493286 sec. =
Valid knn accuracy guitar    : 29.22077922077922%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.583823204040527 sec. =
Valid knn accuracy residuals : 56.60377358490566%

Valid knn accuracy average   : 40.84513387610721%

                                                                        [AEpoch 7: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:41<00:00,  0.54it/s, v_num=0, Train/loss_all_step=0.0388, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=0.663, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.104, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.0961, Train/loss_recog_epoch=0.802]Epoch 7: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:41<00:00,  0.54it/s, v_num=0, Train/loss_all_step=0.0388, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=0.663, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.187089, 0.187401, 0.186223
Train average loss UNet            (all)              : 0.560714

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.030757, 0.548227, 1.201323
Train average loss bass     (Triplet, dist_p, dist_n) : 0.131977, 0.501060, 0.641020
Train average loss piano    (Triplet, dist_p, dist_n) : 0.104089, 0.584575, 0.790606
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.094295, 0.589757, 0.840530
Train average loss residuals(Triplet, dist_p, dist_n) : 0.075643, 0.686544, 0.981322
Train average loss all      (Triplet)                 : 0.088086

== Recognize ==
Train average loss Recognize     : 0.799287
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.096079

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0388, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=0.663, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0388, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=0.663, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]Epoch 8:  16%|â–ˆâ–Œ        | 50/313 [01:18<06:52,  0.64it/s, v_num=0, Train/loss_all_step=0.0388, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=0.663, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]Epoch 8:  16%|â–ˆâ–Œ        | 50/313 [01:18<06:52,  0.64it/s, v_num=0, Train/loss_all_step=0.0639, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.0566, Train/loss_recog_step=0.729, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]Epoch 8:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:27<05:13,  0.68it/s, v_num=0, Train/loss_all_step=0.0639, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.0566, Train/loss_recog_step=0.729, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]Epoch 8:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:27<05:13,  0.68it/s, v_num=0, Train/loss_all_step=0.0433, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0352, Train/loss_recog_step=0.818, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]Epoch 8:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:34<03:53,  0.70it/s, v_num=0, Train/loss_all_step=0.0433, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0352, Train/loss_recog_step=0.818, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]Epoch 8:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:34<03:53,  0.70it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.575, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.641, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]  Epoch 8:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:42<02:39,  0.71it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.575, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.641, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]Epoch 8:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:42<02:39,  0.71it/s, v_num=0, Train/loss_all_step=0.0825, Train/loss_unet_all_step=0.565, Train/loss_triplet_all_step=0.0747, Train/loss_recog_step=0.782, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]Epoch 8:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:49<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.0825, Train/loss_unet_all_step=0.565, Train/loss_triplet_all_step=0.0747, Train/loss_recog_step=0.782, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]Epoch 8:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:49<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.073, Train/loss_unet_all_step=0.543, Train/loss_triplet_all_step=0.0662, Train/loss_recog_step=0.674, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799] Epoch 8:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:54<00:17,  0.72it/s, v_num=0, Train/loss_all_step=0.073, Train/loss_unet_all_step=0.543, Train/loss_triplet_all_step=0.0662, Train/loss_recog_step=0.674, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]Epoch 8:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:54<00:17,  0.72it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.0974, Train/loss_recog_step=0.902, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]Epoch 8: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [07:08<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.0974, Train/loss_recog_step=0.902, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]Epoch 8: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [07:08<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0456, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.039, Train/loss_recog_step=0.658, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:02<00:00,  1.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  2.79it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  2.82it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:04<00:00,  2.82it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  3.00it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  2.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.177661, 0.180287, 0.184749
Valid average loss UNet            (all)              : 0.542697

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064942, 0.555495, 1.130728
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.252724, 0.610575, 0.576333
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.239093, 0.749968, 0.828681
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.154419, 0.620702, 0.804390
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.165721, 0.789759, 0.905589
Valid average loss all      (Triplet)                 : 0.187611

== Recognize ==
Valid average loss Recognize     : 0.752332
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.195134

= T-SNE...
T-SNE was finished!
= T-SNE time is 17.732027053833008 sec. =
Valid knn accuracy drums     : 73.08823529411764%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.772806406021118 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 21.032888174057007 sec. =
Valid knn accuracy piano     : 30.405405405405407%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.803151607513428 sec. =
Valid knn accuracy guitar    : 36.038961038961034%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.481536626815796 sec. =
Valid knn accuracy residuals : 54.71698113207547%

Valid knn accuracy average   : 41.98945145783284%

                                                                        [AEpoch 8: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:43<00:00,  0.54it/s, v_num=0, Train/loss_all_step=0.0456, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.039, Train/loss_recog_step=0.658, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0961, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0881, Train/loss_recog_epoch=0.799]Epoch 8: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:43<00:00,  0.54it/s, v_num=0, Train/loss_all_step=0.0456, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.039, Train/loss_recog_step=0.658, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.187243, 0.187577, 0.186389
Train average loss UNet            (all)              : 0.561209

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.025410, 0.617012, 1.338561
Train average loss bass     (Triplet, dist_p, dist_n) : 0.119340, 0.563187, 0.735603
Train average loss piano    (Triplet, dist_p, dist_n) : 0.092735, 0.662378, 0.909893
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.084047, 0.657399, 0.946919
Train average loss residuals(Triplet, dist_p, dist_n) : 0.065560, 0.751993, 1.084483
Train average loss all      (Triplet)                 : 0.078633

== Recognize ==
Train average loss Recognize     : 0.797017
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.086603

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0456, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.039, Train/loss_recog_step=0.658, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0456, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.039, Train/loss_recog_step=0.658, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]Epoch 9:  16%|â–ˆâ–Œ        | 50/313 [01:19<06:58,  0.63it/s, v_num=0, Train/loss_all_step=0.0456, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.039, Train/loss_recog_step=0.658, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]Epoch 9:  16%|â–ˆâ–Œ        | 50/313 [01:19<06:58,  0.63it/s, v_num=0, Train/loss_all_step=0.0634, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0562, Train/loss_recog_step=0.724, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]Epoch 9:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:28<05:16,  0.67it/s, v_num=0, Train/loss_all_step=0.0634, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0562, Train/loss_recog_step=0.724, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]Epoch 9:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:28<05:16,  0.67it/s, v_num=0, Train/loss_all_step=0.0467, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0385, Train/loss_recog_step=0.818, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]Epoch 9:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:38<03:57,  0.69it/s, v_num=0, Train/loss_all_step=0.0467, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0385, Train/loss_recog_step=0.818, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]Epoch 9:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:38<03:57,  0.69it/s, v_num=0, Train/loss_all_step=0.0825, Train/loss_unet_all_step=0.575, Train/loss_triplet_all_step=0.0761, Train/loss_recog_step=0.638, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]Epoch 9:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:48<02:42,  0.69it/s, v_num=0, Train/loss_all_step=0.0825, Train/loss_unet_all_step=0.575, Train/loss_triplet_all_step=0.0761, Train/loss_recog_step=0.638, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]Epoch 9:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:48<02:42,  0.69it/s, v_num=0, Train/loss_all_step=0.0611, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0533, Train/loss_recog_step=0.784, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]Epoch 9:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:56<01:29,  0.70it/s, v_num=0, Train/loss_all_step=0.0611, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0533, Train/loss_recog_step=0.784, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]Epoch 9:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:56<01:29,  0.70it/s, v_num=0, Train/loss_all_step=0.0599, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.0532, Train/loss_recog_step=0.674, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]Epoch 9:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [07:03<00:18,  0.71it/s, v_num=0, Train/loss_all_step=0.0599, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.0532, Train/loss_recog_step=0.674, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]Epoch 9:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [07:03<00:18,  0.71it/s, v_num=0, Train/loss_all_step=0.0698, Train/loss_unet_all_step=0.553, Train/loss_triplet_all_step=0.0607, Train/loss_recog_step=0.909, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]Epoch 9: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [07:17<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.0698, Train/loss_unet_all_step=0.553, Train/loss_triplet_all_step=0.0607, Train/loss_recog_step=0.909, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]Epoch 9: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [07:17<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.030, Train/loss_unet_all_step=0.596, Train/loss_triplet_all_step=0.0235, Train/loss_recog_step=0.653, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:02<00:00,  1.59it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  2.86it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  2.84it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:04<00:00,  2.78it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  2.90it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  2.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.177314, 0.179992, 0.184432
Valid average loss UNet            (all)              : 0.541738

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077988, 0.706486, 1.349715
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.251223, 0.693841, 0.680378
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.264645, 0.870554, 1.030246
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.148752, 0.732786, 0.862520
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.180939, 0.937294, 1.049548
Valid average loss all      (Triplet)                 : 0.198867

== Recognize ==
Valid average loss Recognize     : 0.752177
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.206389

= T-SNE...
T-SNE was finished!
= T-SNE time is 18.30738401412964 sec. =
Valid knn accuracy drums     : 76.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.224624633789062 sec. =
Valid knn accuracy bass      : 13.372093023255813%
= T-SNE...
T-SNE was finished!
= T-SNE time is 20.804100513458252 sec. =
Valid knn accuracy piano     : 39.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.957666873931885 sec. =
Valid knn accuracy guitar    : 40.909090909090914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.72525906562805 sec. =
Valid knn accuracy residuals : 53.930817610062896%

Valid knn accuracy average   : 44.828409847432646%

                                                                        [AEpoch 9: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:53<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.030, Train/loss_unet_all_step=0.596, Train/loss_triplet_all_step=0.0235, Train/loss_recog_step=0.653, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0866, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0786, Train/loss_recog_epoch=0.797]Epoch 9: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:53<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.030, Train/loss_unet_all_step=0.596, Train/loss_triplet_all_step=0.0235, Train/loss_recog_step=0.653, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.187106, 0.187410, 0.186259
Train average loss UNet            (all)              : 0.560774

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.022656, 0.701087, 1.482823
Train average loss bass     (Triplet, dist_p, dist_n) : 0.110404, 0.634640, 0.835061
Train average loss piano    (Triplet, dist_p, dist_n) : 0.082331, 0.738326, 1.026776
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.075399, 0.722369, 1.047348
Train average loss residuals(Triplet, dist_p, dist_n) : 0.058428, 0.846996, 1.225152
Train average loss all      (Triplet)                 : 0.070912

== Recognize ==
Train average loss Recognize     : 0.796069
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.078872

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.030, Train/loss_unet_all_step=0.596, Train/loss_triplet_all_step=0.0235, Train/loss_recog_step=0.653, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.030, Train/loss_unet_all_step=0.596, Train/loss_triplet_all_step=0.0235, Train/loss_recog_step=0.653, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]Epoch 10:  16%|â–ˆâ–Œ        | 50/313 [01:17<06:49,  0.64it/s, v_num=0, Train/loss_all_step=0.030, Train/loss_unet_all_step=0.596, Train/loss_triplet_all_step=0.0235, Train/loss_recog_step=0.653, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]Epoch 10:  16%|â–ˆâ–Œ        | 50/313 [01:17<06:49,  0.64it/s, v_num=0, Train/loss_all_step=0.0528, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0455, Train/loss_recog_step=0.724, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]Epoch 10:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:26<05:11,  0.68it/s, v_num=0, Train/loss_all_step=0.0528, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0455, Train/loss_recog_step=0.724, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]Epoch 10:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:26<05:11,  0.68it/s, v_num=0, Train/loss_all_step=0.0495, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0413, Train/loss_recog_step=0.818, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]Epoch 10:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:34<03:52,  0.70it/s, v_num=0, Train/loss_all_step=0.0495, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0413, Train/loss_recog_step=0.818, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]Epoch 10:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:34<03:52,  0.70it/s, v_num=0, Train/loss_all_step=0.049, Train/loss_unet_all_step=0.579, Train/loss_triplet_all_step=0.0426, Train/loss_recog_step=0.638, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796] Epoch 10:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:42<02:39,  0.71it/s, v_num=0, Train/loss_all_step=0.049, Train/loss_unet_all_step=0.579, Train/loss_triplet_all_step=0.0426, Train/loss_recog_step=0.638, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]Epoch 10:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:42<02:39,  0.71it/s, v_num=0, Train/loss_all_step=0.0422, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0344, Train/loss_recog_step=0.782, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]Epoch 10:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:49<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.0422, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0344, Train/loss_recog_step=0.782, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]Epoch 10:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:49<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.0507, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.0441, Train/loss_recog_step=0.666, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]Epoch 10:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:54<00:17,  0.72it/s, v_num=0, Train/loss_all_step=0.0507, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.0441, Train/loss_recog_step=0.666, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]Epoch 10:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:54<00:17,  0.72it/s, v_num=0, Train/loss_all_step=0.0563, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.0473, Train/loss_recog_step=0.906, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]Epoch 10: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [07:07<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0563, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.0473, Train/loss_recog_step=0.906, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]Epoch 10: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [07:07<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0189, Train/loss_unet_all_step=0.597, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.654, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.206, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.199, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.448, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  2.99it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  2.82it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:04<00:00,  2.81it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  2.88it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  2.82it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.176775, 0.179496, 0.184026
Valid average loss UNet            (all)              : 0.540298

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077726, 0.828725, 1.537269
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.233892, 0.817414, 0.850950
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.259738, 0.960453, 1.099433
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.151759, 0.880254, 1.045030
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.170208, 1.006681, 1.220327
Valid average loss all      (Triplet)                 : 0.188792

== Recognize ==
Valid average loss Recognize     : 0.746834
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.196260

= T-SNE...
T-SNE was finished!
= T-SNE time is 17.737393856048584 sec. =
Valid knn accuracy drums     : 74.55882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.490792512893677 sec. =
Valid knn accuracy bass      : 16.424418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 20.22598361968994 sec. =
Valid knn accuracy piano     : 34.054054054054056%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.761988878250122 sec. =
Valid knn accuracy guitar    : 26.461038961038962%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.913044691085815 sec. =
Valid knn accuracy residuals : 59.905660377358494%

Valid knn accuracy average   : 42.28079910530288%

                                                                        [AEpoch 10: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:42<00:00,  0.54it/s, v_num=0, Train/loss_all_step=0.0189, Train/loss_unet_all_step=0.597, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.654, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0709, Train/loss_recog_epoch=0.796]Epoch 10: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:42<00:00,  0.54it/s, v_num=0, Train/loss_all_step=0.0189, Train/loss_unet_all_step=0.597, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.654, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.187346, 0.187662, 0.186486
Train average loss UNet            (all)              : 0.561494

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.021934, 0.778799, 1.654749
Train average loss bass     (Triplet, dist_p, dist_n) : 0.097540, 0.714977, 0.950146
Train average loss piano    (Triplet, dist_p, dist_n) : 0.071031, 0.827765, 1.166564
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.069739, 0.811609, 1.178435
Train average loss residuals(Triplet, dist_p, dist_n) : 0.050539, 0.940521, 1.355323
Train average loss all      (Triplet)                 : 0.062871

== Recognize ==
Train average loss Recognize     : 0.795159
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.070823

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0189, Train/loss_unet_all_step=0.597, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.654, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0189, Train/loss_unet_all_step=0.597, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.654, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]Epoch 11:  16%|â–ˆâ–Œ        | 50/313 [01:16<06:40,  0.66it/s, v_num=0, Train/loss_all_step=0.0189, Train/loss_unet_all_step=0.597, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.654, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]Epoch 11:  16%|â–ˆâ–Œ        | 50/313 [01:16<06:40,  0.66it/s, v_num=0, Train/loss_all_step=0.0589, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0517, Train/loss_recog_step=0.723, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]Epoch 11:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:24<05:07,  0.69it/s, v_num=0, Train/loss_all_step=0.0589, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0517, Train/loss_recog_step=0.723, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]Epoch 11:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:24<05:07,  0.69it/s, v_num=0, Train/loss_all_step=0.0421, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.034, Train/loss_recog_step=0.817, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795] Epoch 11:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:31<03:49,  0.71it/s, v_num=0, Train/loss_all_step=0.0421, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.034, Train/loss_recog_step=0.817, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]Epoch 11:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:31<03:49,  0.71it/s, v_num=0, Train/loss_all_step=0.0568, Train/loss_unet_all_step=0.578, Train/loss_triplet_all_step=0.0504, Train/loss_recog_step=0.636, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]Epoch 11:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:40<02:38,  0.71it/s, v_num=0, Train/loss_all_step=0.0568, Train/loss_unet_all_step=0.578, Train/loss_triplet_all_step=0.0504, Train/loss_recog_step=0.636, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]Epoch 11:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:40<02:38,  0.71it/s, v_num=0, Train/loss_all_step=0.0545, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.0467, Train/loss_recog_step=0.783, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]Epoch 11:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:47<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.0545, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.0467, Train/loss_recog_step=0.783, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]Epoch 11:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:47<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.0665, Train/loss_unet_all_step=0.546, Train/loss_triplet_all_step=0.0598, Train/loss_recog_step=0.668, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]Epoch 11:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:51<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.0665, Train/loss_unet_all_step=0.546, Train/loss_triplet_all_step=0.0598, Train/loss_recog_step=0.668, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]Epoch 11:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:51<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.0426, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.0336, Train/loss_recog_step=0.903, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]Epoch 11: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [07:04<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0426, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.0336, Train/loss_recog_step=0.903, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]Epoch 11: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [07:04<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0751, Train/loss_unet_all_step=0.597, Train/loss_triplet_all_step=0.0686, Train/loss_recog_step=0.652, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.861, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  2.86it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  2.94it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:04<00:00,  2.89it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  2.88it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  2.85it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.177387, 0.180061, 0.184270
Valid average loss UNet            (all)              : 0.541718

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.107981, 0.848327, 1.716708
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.267066, 0.862323, 0.854520
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.255032, 1.002402, 1.167194
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.156941, 0.855250, 1.118741
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.173921, 1.000428, 1.282175
Valid average loss all      (Triplet)                 : 0.205583

== Recognize ==
Valid average loss Recognize     : 0.743335
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.213016

= T-SNE...
T-SNE was finished!
= T-SNE time is 17.87445902824402 sec. =
Valid knn accuracy drums     : 69.11764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.740217208862305 sec. =
Valid knn accuracy bass      : 15.843023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 20.44190740585327 sec. =
Valid knn accuracy piano     : 34.32432432432432%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.575350761413574 sec. =
Valid knn accuracy guitar    : 39.12337662337662%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.059587717056274 sec. =
Valid knn accuracy residuals : 55.9748427672956%

Valid knn accuracy average   : 42.8766428059268%

                                                                        [AEpoch 11: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:39<00:00,  0.54it/s, v_num=0, Train/loss_all_step=0.0751, Train/loss_unet_all_step=0.597, Train/loss_triplet_all_step=0.0686, Train/loss_recog_step=0.652, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0708, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0629, Train/loss_recog_epoch=0.795]Epoch 11: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:39<00:00,  0.54it/s, v_num=0, Train/loss_all_step=0.0751, Train/loss_unet_all_step=0.597, Train/loss_triplet_all_step=0.0686, Train/loss_recog_step=0.652, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.187335, 0.187631, 0.186469
Train average loss UNet            (all)              : 0.561435

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.018359, 0.861225, 1.819698
Train average loss bass     (Triplet, dist_p, dist_n) : 0.092621, 0.805340, 1.074302
Train average loss piano    (Triplet, dist_p, dist_n) : 0.068545, 0.917998, 1.291340
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.058213, 0.904600, 1.323117
Train average loss residuals(Triplet, dist_p, dist_n) : 0.044464, 1.017795, 1.478911
Train average loss all      (Triplet)                 : 0.057322

== Recognize ==
Train average loss Recognize     : 0.794195
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.065264

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0751, Train/loss_unet_all_step=0.597, Train/loss_triplet_all_step=0.0686, Train/loss_recog_step=0.652, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0751, Train/loss_unet_all_step=0.597, Train/loss_triplet_all_step=0.0686, Train/loss_recog_step=0.652, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]Epoch 12:  16%|â–ˆâ–Œ        | 50/313 [01:18<06:53,  0.64it/s, v_num=0, Train/loss_all_step=0.0751, Train/loss_unet_all_step=0.597, Train/loss_triplet_all_step=0.0686, Train/loss_recog_step=0.652, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]Epoch 12:  16%|â–ˆâ–Œ        | 50/313 [01:18<06:53,  0.64it/s, v_num=0, Train/loss_all_step=0.034, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0268, Train/loss_recog_step=0.724, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794] Epoch 12:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:27<05:14,  0.68it/s, v_num=0, Train/loss_all_step=0.034, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0268, Train/loss_recog_step=0.724, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]Epoch 12:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:27<05:14,  0.68it/s, v_num=0, Train/loss_all_step=0.0628, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0546, Train/loss_recog_step=0.815, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]Epoch 12:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:36<03:55,  0.69it/s, v_num=0, Train/loss_all_step=0.0628, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0546, Train/loss_recog_step=0.815, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]Epoch 12:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:36<03:55,  0.69it/s, v_num=0, Train/loss_all_step=0.0427, Train/loss_unet_all_step=0.575, Train/loss_triplet_all_step=0.0364, Train/loss_recog_step=0.630, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]Epoch 12:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:45<02:41,  0.70it/s, v_num=0, Train/loss_all_step=0.0427, Train/loss_unet_all_step=0.575, Train/loss_triplet_all_step=0.0364, Train/loss_recog_step=0.630, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]Epoch 12:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:45<02:41,  0.70it/s, v_num=0, Train/loss_all_step=0.0342, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.0264, Train/loss_recog_step=0.779, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]Epoch 12:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:52<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.0342, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.0264, Train/loss_recog_step=0.779, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]Epoch 12:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:52<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.0358, Train/loss_unet_all_step=0.545, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=0.663, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]Epoch 12:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:58<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.0358, Train/loss_unet_all_step=0.545, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=0.663, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]Epoch 12:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [06:58<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.0339, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.0248, Train/loss_recog_step=0.909, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]Epoch 12: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [07:12<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.0339, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.0248, Train/loss_recog_step=0.909, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]Epoch 12: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [07:12<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.600, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.648, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.550, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.206, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.429, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:02<00:00,  1.93it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  2.93it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  2.84it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:04<00:00,  2.88it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  2.97it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  2.73it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178282, 0.180971, 0.185508
Valid average loss UNet            (all)              : 0.544762

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.119668, 0.932902, 1.803209
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.230944, 0.932224, 0.995511
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.282101, 1.204946, 1.382946
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.195090, 1.009928, 1.245625
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.179969, 1.177730, 1.423641
Valid average loss all      (Triplet)                 : 0.209242

== Recognize ==
Valid average loss Recognize     : 0.744884
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.216690

= T-SNE...
T-SNE was finished!
= T-SNE time is 18.701011419296265 sec. =
Valid knn accuracy drums     : 71.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.711161375045776 sec. =
Valid knn accuracy bass      : 18.313953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 20.103772163391113 sec. =
Valid knn accuracy piano     : 32.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.37055540084839 sec. =
Valid knn accuracy guitar    : 33.76623376623377%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.717725038528442 sec. =
Valid knn accuracy residuals : 60.22012578616353%

Valid knn accuracy average   : 43.294720795753236%

                                                                        [AEpoch 12: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:47<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.600, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.648, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0653, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0573, Train/loss_recog_epoch=0.794]Epoch 12: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:47<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.600, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.648, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.187216, 0.187539, 0.186361
Train average loss UNet            (all)              : 0.561116

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.016284, 0.938212, 2.012209
Train average loss bass     (Triplet, dist_p, dist_n) : 0.083207, 0.876292, 1.183294
Train average loss piano    (Triplet, dist_p, dist_n) : 0.060200, 1.006338, 1.432612
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.053599, 0.980090, 1.449033
Train average loss residuals(Triplet, dist_p, dist_n) : 0.037393, 1.106479, 1.614992
Train average loss all      (Triplet)                 : 0.050842

== Recognize ==
Train average loss Recognize     : 0.793425
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.058776

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.600, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.648, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.600, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.648, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]Epoch 13:  16%|â–ˆâ–Œ        | 50/313 [01:20<07:01,  0.62it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.600, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.648, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]Epoch 13:  16%|â–ˆâ–Œ        | 50/313 [01:20<07:01,  0.62it/s, v_num=0, Train/loss_all_step=0.0283, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.723, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]Epoch 13:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:28<05:16,  0.67it/s, v_num=0, Train/loss_all_step=0.0283, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.723, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]Epoch 13:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:28<05:16,  0.67it/s, v_num=0, Train/loss_all_step=0.0538, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0456, Train/loss_recog_step=0.815, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]Epoch 13:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:38<03:56,  0.69it/s, v_num=0, Train/loss_all_step=0.0538, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0456, Train/loss_recog_step=0.815, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]Epoch 13:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:38<03:56,  0.69it/s, v_num=0, Train/loss_all_step=0.0349, Train/loss_unet_all_step=0.574, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=0.631, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]Epoch 13:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:46<02:41,  0.70it/s, v_num=0, Train/loss_all_step=0.0349, Train/loss_unet_all_step=0.574, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=0.631, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]Epoch 13:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:46<02:41,  0.70it/s, v_num=0, Train/loss_all_step=0.0382, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.778, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]Epoch 13:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:54<01:29,  0.71it/s, v_num=0, Train/loss_all_step=0.0382, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.778, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]Epoch 13:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:54<01:29,  0.71it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.546, Train/loss_triplet_all_step=0.0543, Train/loss_recog_step=0.664, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793] Epoch 13:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [07:00<00:18,  0.71it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.546, Train/loss_triplet_all_step=0.0543, Train/loss_recog_step=0.664, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]Epoch 13:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 300/313 [07:00<00:18,  0.71it/s, v_num=0, Train/loss_all_step=0.0394, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.904, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]Epoch 13: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [07:14<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.0394, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.904, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]Epoch 13: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [07:14<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.0404, Train/loss_unet_all_step=0.601, Train/loss_triplet_all_step=0.0339, Train/loss_recog_step=0.654, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.217, Valid/loss_unet_all_epoch=0.545, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:02<00:00,  1.76it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:03<00:00,  3.15it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:03<00:00,  3.11it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  3.25it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  3.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178691, 0.181619, 0.186316
Valid average loss UNet            (all)              : 0.546626

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.109924, 1.009463, 1.948819
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.235263, 1.083296, 1.164102
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.201715, 1.205219, 1.466237
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.194983, 1.067596, 1.351812
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.176954, 1.198054, 1.513089
Valid average loss all      (Triplet)                 : 0.195169

== Recognize ==
Valid average loss Recognize     : 0.743638
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.202606

= T-SNE...
T-SNE was finished!
= T-SNE time is 18.409494161605835 sec. =
Valid knn accuracy drums     : 68.82352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.65075445175171 sec. =
Valid knn accuracy bass      : 16.13372093023256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.532342672348022 sec. =
Valid knn accuracy piano     : 32.432432432432435%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.00351881980896 sec. =
Valid knn accuracy guitar    : 32.95454545454545%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.018527269363403 sec. =
Valid knn accuracy residuals : 57.07547169811321%

Valid knn accuracy average   : 41.48393998541767%

                                                                        [AEpoch 13: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:46<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.0404, Train/loss_unet_all_step=0.601, Train/loss_triplet_all_step=0.0339, Train/loss_recog_step=0.654, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.415, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.793]Epoch 13: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 313/313 [09:46<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.0404, Train/loss_unet_all_step=0.601, Train/loss_triplet_all_step=0.0339, Train/loss_recog_step=0.654, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.415, Train/loss_all_epoch=0.051, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.793] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.187380, 0.187688, 0.186514
Train average loss UNet            (all)              : 0.561583

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.014302, 1.029373, 2.172686
Train average loss bass     (Triplet, dist_p, dist_n) : 0.072080, 0.963207, 1.317419
Train average loss piano    (Triplet, dist_p, dist_n) : 0.046879, 1.079820, 1.555610
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.045041, 1.072769, 1.617534
Train average loss residuals(Triplet, dist_p, dist_n) : 0.033631, 1.208002, 1.783200
Train average loss all      (Triplet)                 : 0.043085

== Recognize ==
Train average loss Recognize     : 0.793348
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.051018

Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0404, Train/loss_unet_all_step=0.601, Train/loss_triplet_all_step=0.0339, Train/loss_recog_step=0.654, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.415, Train/loss_all_epoch=0.051, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.793]          Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0404, Train/loss_unet_all_step=0.601, Train/loss_triplet_all_step=0.0339, Train/loss_recog_step=0.654, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.415, Train/loss_all_epoch=0.051, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.793]Epoch 14:  16%|â–ˆâ–Œ        | 50/313 [01:18<06:53,  0.64it/s, v_num=0, Train/loss_all_step=0.0404, Train/loss_unet_all_step=0.601, Train/loss_triplet_all_step=0.0339, Train/loss_recog_step=0.654, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.415, Train/loss_all_epoch=0.051, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.793]Epoch 14:  16%|â–ˆâ–Œ        | 50/313 [01:18<06:53,  0.64it/s, v_num=0, Train/loss_all_step=0.0466, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.0394, Train/loss_recog_step=0.719, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.415, Train/loss_all_epoch=0.051, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.793]Epoch 14:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:27<05:13,  0.68it/s, v_num=0, Train/loss_all_step=0.0466, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.0394, Train/loss_recog_step=0.719, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.415, Train/loss_all_epoch=0.051, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.793]Epoch 14:  32%|â–ˆâ–ˆâ–ˆâ–      | 100/313 [02:27<05:13,  0.68it/s, v_num=0, Train/loss_all_step=0.0454, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0373, Train/loss_recog_step=0.815, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.415, Train/loss_all_epoch=0.051, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.793]Epoch 14:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:36<03:55,  0.69it/s, v_num=0, Train/loss_all_step=0.0454, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0373, Train/loss_recog_step=0.815, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.415, Train/loss_all_epoch=0.051, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.793]Epoch 14:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 150/313 [03:36<03:55,  0.69it/s, v_num=0, Train/loss_all_step=0.0651, Train/loss_unet_all_step=0.574, Train/loss_triplet_all_step=0.0588, Train/loss_recog_step=0.630, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.415, Train/loss_all_epoch=0.051, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.793]Epoch 14:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:44<02:40,  0.70it/s, v_num=0, Train/loss_all_step=0.0651, Train/loss_unet_all_step=0.574, Train/loss_triplet_all_step=0.0588, Train/loss_recog_step=0.630, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.415, Train/loss_all_epoch=0.051, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.793]Epoch 14:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 200/313 [04:44<02:40,  0.70it/s, v_num=0, Train/loss_all_step=0.0442, Train/loss_unet_all_step=0.565, Train/loss_triplet_all_step=0.0364, Train/loss_recog_step=0.778, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.415, Train/loss_all_epoch=0.051, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.793]Epoch 14:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:51<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.0442, Train/loss_unet_all_step=0.565, Train/loss_triplet_all_step=0.0364, Train/loss_recog_step=0.778, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.415, Train/loss_all_epoch=0.051, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.793]Epoch 14:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 250/313 [05:51<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.0396, Train/loss_unet_all_step=0.546, Train/loss_triplet_all_step=0.033, Train/loss_recog_step=0.656, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.415, Train/loss_all_epoch=0.051, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.0431, Train/loss_recog_epoch=0.793] 