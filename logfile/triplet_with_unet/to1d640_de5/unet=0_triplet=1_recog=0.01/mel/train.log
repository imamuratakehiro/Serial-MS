
=== Using cuda(utils.func). ===

[2023-11-13 08:55:06,848][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-13 08:55:06,856][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0.01                                                      
│         test_psd_mine: false                                                  
│         ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640                         
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: true                                                             
│         n_mels: 259                                                           
│       ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-11
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0.01                                                      
│         test_psd_mine: false                                                  
│         ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/knn_avr                                                
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: -1                                                        
│         mode: max                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/knn_avr                                                
│         min_delta: 0.0                                                        
│         patience: 100                                                         
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 400                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       num_sanity_val_steps: 0                                                 
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 400                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       load_using_librosa: false                                               
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_psd_train: 3                                                    
│       seconds_psd_valid: 10                                                   
│       seconds_psd_test: 10                                                    
│       offset_psd_train: 1.5                                                   
│       offset_psd_valid: 5.0                                                   
│       offset_psd_test: 10.0                                                   
│       seconds_triplet_train: 3                                                
│       seconds_triplet_valid: 3                                                
│       offset_triplet_train: 1.5                                               
│       offset_triplet_valid: 1.5                                               
│       seconds_c32_train: 3                                                    
│       seconds_c32_valid: 10                                                   
│       seconds_c32_test: 10                                                    
│       offset_c32_train: 1.5                                                   
│       offset_c32_valid: 5.0                                                   
│       offset_c32_test: 10.0                                                   
│       sr: 44100                                                               
│       mel: true                                                               
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640                             
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       monitor_es: Valid/knn_avr                                               
│       monitor_mode_es: max                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 0                                                            
│       recog_rate: 0.01                                                        
│       test_psd_mine: false                                                    
│       ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-11
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-13 08:55:06,990][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-13 08:55:07,012][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640_addencoder). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de1_to1d640). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-13 08:55:10,490][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpi4tbq7ls
[2023-11-13 08:55:10,491][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpi4tbq7ls/_remote_module_non_scriptable.py
== Loading pretrained model...
== pretrained model was loaded!
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=3200, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-13 08:55:13,659][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-13 08:55:13,659][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-13 08:55:13,666][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-13 08:55:13,668][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-13 08:55:13,668][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-13 08:55:13,668][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-13 08:55:13,720][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-13 08:55:14,029][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-13 08:55:14,281][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.8539330959320068 sec. *
Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [01:20<07:01,  0.62it/s]Epoch 0:  16%|█▌        | 50/313 [01:20<07:01,  0.62it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=0.712]Epoch 0:  32%|███▏      | 100/313 [02:17<04:52,  0.73it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=0.712]Epoch 0:  32%|███▏      | 100/313 [02:17<04:52,  0.73it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.178, Train/loss_recog_step=0.676]Epoch 0:  48%|████▊     | 150/313 [03:16<03:33,  0.76it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.178, Train/loss_recog_step=0.676]Epoch 0:  48%|████▊     | 150/313 [03:16<03:33,  0.76it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.678]Epoch 0:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.678]Epoch 0:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.667]Epoch 0:  80%|███████▉  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.667]Epoch 0:  80%|███████▉  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.668]Epoch 0:  96%|█████████▌| 300/313 [06:09<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.668]Epoch 0:  96%|█████████▌| 300/313 [06:09<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.662]Epoch 0: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.662]Epoch 0: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=0.673]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:04<00:00,  1.00it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.06it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  2.68it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.84it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.77it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.96it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185755, 0.189079, 0.191497, 0.191027
Valid average loss UNet                 (all)                : 0.757358

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.054983, 0.414471, 0.850916
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.220875, 0.174585, 0.155075
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.225906, 0.190302, 0.164600
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.160167, 0.208684, 0.265016
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.110651, 0.239713, 0.392695
Valid average loss all      (Triplet)                 : 0.164856

== Recognize ==
Valid average loss Recognize     : 0.674472
Valid average accuracy drums     : 70.500000 %
Valid average accuracy bass      : 39.000000 %
Valid average accuracy piano     : 56.000000 %
Valid average accuracy guitar    : 68.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.171601

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 10.380378723144531 sec. =
Valid knn accuracy drums     : 88.91304347826086%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 10.341070175170898 sec. =
Valid knn accuracy bass      : 24.798387096774192%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 9.837898015975952 sec. =
Valid knn accuracy piano     : 19.3359375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 9.0479896068573 sec. =
Valid knn accuracy guitar    : 43.080357142857146%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 8.039365530014038 sec. =
Valid knn accuracy residuals : 60.22727272727273%

Valid knn accuracy average   : 47.27099958903299%

                                                                      [AEpoch 0: 100%|██████████| 313/313 [08:05<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=0.673, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473]Epoch 0: 100%|██████████| 313/313 [08:05<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=0.673, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188931, 0.189219, 0.188096, 0.193456
Train average loss UNet                 (all)                : 0.759703

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.041078, 0.425045, 0.856050
Train average loss bass     (Triplet, dist_p, dist_n) : 0.201586, 0.153476, 0.156298
Train average loss piano    (Triplet, dist_p, dist_n) : 0.200093, 0.165013, 0.168118
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.173223, 0.186358, 0.234132
Train average loss residuals(Triplet, dist_p, dist_n) : 0.161656, 0.214532, 0.278204
Train average loss all      (Triplet)                 : 0.157088

== Recognize ==
Train average loss Recognize     : 0.693558
Train average accuracy drums     : 64.490005 %
Train average accuracy bass      : 48.899998 %
Train average accuracy piano     : 51.195000 %
Train average accuracy guitar    : 54.495003 %
Train average accuracy residuals : 57.575001 %

== Train average loss all : 0.164024

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=0.673, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=0.673, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]Epoch 1:  16%|█▌        | 50/313 [01:11<06:13,  0.70it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=0.673, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]Epoch 1:  16%|█▌        | 50/313 [01:11<06:13,  0.70it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=0.665, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]Epoch 1:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=0.665, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]Epoch 1:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.666, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]Epoch 1:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.666, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]Epoch 1:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=0.635, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]Epoch 1:  64%|██████▍   | 200/313 [04:09<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=0.635, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]Epoch 1:  64%|██████▍   | 200/313 [04:09<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.658, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]Epoch 1:  80%|███████▉  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.658, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]Epoch 1:  80%|███████▉  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.0932, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0867, Train/loss_recog_step=0.642, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]Epoch 1:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0932, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0867, Train/loss_recog_step=0.642, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]Epoch 1:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.644, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]  Epoch 1: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.644, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]Epoch 1: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.646, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.680, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.473, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.33it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.13it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.19it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.67it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185381, 0.188641, 0.191305, 0.207025
Valid average loss UNet                 (all)                : 0.772352

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.048453, 0.391355, 0.853683
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.195085, 0.184413, 0.191427
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.225206, 0.203063, 0.178228
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.149405, 0.229731, 0.295937
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.104799, 0.254440, 0.396986
Valid average loss all      (Triplet)                 : 0.155859

== Recognize ==
Valid average loss Recognize     : 0.671953
Valid average accuracy drums     : 58.000000 %
Valid average accuracy bass      : 59.500004 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 64.000000 %
Valid average accuracy residuals : 72.500000 %

== Valid average loss all : 0.162578

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.371815919876099 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.388757467269897 sec. =
Valid knn accuracy bass      : 24.798387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.376293897628784 sec. =
Valid knn accuracy piano     : 26.5625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.607542037963867 sec. =
Valid knn accuracy guitar    : 40.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.939332962036133 sec. =
Valid knn accuracy residuals : 51.590909090909086%

Valid knn accuracy average   : 45.15014184623231%

                                                                      [AEpoch 1: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.646, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.164, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.694]Epoch 1: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.646, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188917, 0.189207, 0.188111, 0.194051
Train average loss UNet                 (all)                : 0.760286

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.031739, 0.436073, 0.940532
Train average loss bass     (Triplet, dist_p, dist_n) : 0.180331, 0.200613, 0.240214
Train average loss piano    (Triplet, dist_p, dist_n) : 0.184711, 0.212814, 0.236648
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.144000, 0.245646, 0.356307
Train average loss residuals(Triplet, dist_p, dist_n) : 0.133226, 0.301365, 0.424082
Train average loss all      (Triplet)                 : 0.136317

== Recognize ==
Train average loss Recognize     : 0.657382
Train average accuracy drums     : 73.025002 %
Train average accuracy bass      : 54.770000 %
Train average accuracy piano     : 58.689999 %
Train average accuracy guitar    : 61.230000 %
Train average accuracy residuals : 67.820000 %

== Train average loss all : 0.142890

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.646, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.646, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]Epoch 2:  16%|█▌        | 50/313 [01:06<05:49,  0.75it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.646, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]Epoch 2:  16%|█▌        | 50/313 [01:06<05:49,  0.75it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.637, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]Epoch 2:  32%|███▏      | 100/313 [02:04<04:24,  0.80it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.637, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]Epoch 2:  32%|███▏      | 100/313 [02:04<04:24,  0.80it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=0.639, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]Epoch 2:  48%|████▊     | 150/313 [03:02<03:18,  0.82it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=0.639, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]Epoch 2:  48%|████▊     | 150/313 [03:02<03:18,  0.82it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.623, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]Epoch 2:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.623, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]Epoch 2:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.644, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]Epoch 2:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.644, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]Epoch 2:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.088, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0817, Train/loss_recog_step=0.633, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]Epoch 2:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.088, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0817, Train/loss_recog_step=0.633, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]Epoch 2:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=0.639, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657] Epoch 2: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=0.639, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]Epoch 2: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.677, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.40it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.64it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.47it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.00it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:03<00:00,  2.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183850, 0.187128, 0.189319, 0.207373
Valid average loss UNet                 (all)                : 0.767669

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067675, 0.496647, 1.005774
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.158399, 0.207373, 0.257549
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.214356, 0.258875, 0.251007
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.159431, 0.272499, 0.371434
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.115700, 0.328078, 0.453428
Valid average loss all      (Triplet)                 : 0.149277

== Recognize ==
Valid average loss Recognize     : 0.652434
Valid average accuracy drums     : 73.000000 %
Valid average accuracy bass      : 83.500000 %
Valid average accuracy piano     : 43.500000 %
Valid average accuracy guitar    : 58.499996 %
Valid average accuracy residuals : 60.500000 %

== Valid average loss all : 0.155801

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.942067861557007 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.506037712097168 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.942542314529419 sec. =
Valid knn accuracy piano     : 27.5390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.301720380783081 sec. =
Valid knn accuracy guitar    : 41.964285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.973175287246704 sec. =
Valid knn accuracy residuals : 52.5%

Valid knn accuracy average   : 46.815816907934284%

                                                                      [AEpoch 2: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.677, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=0.657]Epoch 2: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.677, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188535, 0.188827, 0.187745, 0.193768
Train average loss UNet                 (all)                : 0.758875

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.023832, 0.511158, 1.085031
Train average loss bass     (Triplet, dist_p, dist_n) : 0.166843, 0.246738, 0.311757
Train average loss piano    (Triplet, dist_p, dist_n) : 0.166755, 0.277524, 0.329667
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.128124, 0.311700, 0.472176
Train average loss residuals(Triplet, dist_p, dist_n) : 0.118790, 0.355596, 0.515741
Train average loss all      (Triplet)                 : 0.122256

== Recognize ==
Train average loss Recognize     : 0.641026
Train average accuracy drums     : 83.290001 %
Train average accuracy bass      : 62.250000 %
Train average accuracy piano     : 60.385002 %
Train average accuracy guitar    : 60.959999 %
Train average accuracy residuals : 67.325005 %

== Train average loss all : 0.128666

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.677, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.677, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]Epoch 3:  16%|█▌        | 50/313 [01:06<05:50,  0.75it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.677, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]Epoch 3:  16%|█▌        | 50/313 [01:06<05:50,  0.75it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=0.637, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]Epoch 3:  32%|███▏      | 100/313 [02:03<04:23,  0.81it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=0.637, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]Epoch 3:  32%|███▏      | 100/313 [02:03<04:23,  0.81it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=0.625, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]Epoch 3:  48%|████▊     | 150/313 [03:02<03:17,  0.82it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=0.625, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]Epoch 3:  48%|████▊     | 150/313 [03:02<03:17,  0.82it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.608, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]Epoch 3:  64%|██████▍   | 200/313 [04:00<02:15,  0.83it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.608, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]Epoch 3:  64%|██████▍   | 200/313 [04:00<02:15,  0.83it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=0.625, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]Epoch 3:  80%|███████▉  | 250/313 [04:58<01:15,  0.84it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=0.625, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]Epoch 3:  80%|███████▉  | 250/313 [04:58<01:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0747, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0685, Train/loss_recog_step=0.618, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]Epoch 3:  96%|█████████▌| 300/313 [05:56<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0747, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0685, Train/loss_recog_step=0.618, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]Epoch 3:  96%|█████████▌| 300/313 [05:56<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0964, Train/loss_recog_step=0.655, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641] Epoch 3: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0964, Train/loss_recog_step=0.655, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]Epoch 3: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.0875, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0812, Train/loss_recog_step=0.632, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=0.620, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.652, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.35it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.03it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.78it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.38it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183771, 0.186968, 0.189293, 0.192618
Valid average loss UNet                 (all)                : 0.752650

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.053836, 0.546255, 1.106394
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.157912, 0.251100, 0.304018
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.201883, 0.320689, 0.334216
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.180533, 0.319612, 0.396904
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.113309, 0.363894, 0.494642
Valid average loss all      (Triplet)                 : 0.148926

== Recognize ==
Valid average loss Recognize     : 0.652784
Valid average accuracy drums     : 70.500000 %
Valid average accuracy bass      : 84.500000 %
Valid average accuracy piano     : 65.000000 %
Valid average accuracy guitar    : 59.500004 %
Valid average accuracy residuals : 78.000000 %

== Valid average loss all : 0.155454

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.486745119094849 sec. =
Valid knn accuracy drums     : 86.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.277079105377197 sec. =
Valid knn accuracy bass      : 23.588709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.783920764923096 sec. =
Valid knn accuracy piano     : 32.6171875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.807578563690186 sec. =
Valid knn accuracy guitar    : 37.94642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.1706862449646 sec. =
Valid knn accuracy residuals : 53.63636363636364%

Valid knn accuracy average   : 46.818607442259704%

                                                                      [AEpoch 3: 100%|██████████| 313/313 [07:32<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.0875, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0812, Train/loss_recog_step=0.632, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.641]Epoch 3: 100%|██████████| 313/313 [07:32<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.0875, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0812, Train/loss_recog_step=0.632, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188444, 0.188741, 0.187673, 0.194415
Train average loss UNet                 (all)                : 0.759273

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.018733, 0.581201, 1.192962
Train average loss bass     (Triplet, dist_p, dist_n) : 0.155478, 0.292569, 0.382017
Train average loss piano    (Triplet, dist_p, dist_n) : 0.150043, 0.347485, 0.430572
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.112503, 0.365453, 0.568976
Train average loss residuals(Triplet, dist_p, dist_n) : 0.105543, 0.409398, 0.605850
Train average loss all      (Triplet)                 : 0.109730

== Recognize ==
Train average loss Recognize     : 0.630638
Train average accuracy drums     : 89.014999 %
Train average accuracy bass      : 65.705002 %
Train average accuracy piano     : 62.664997 %
Train average accuracy guitar    : 62.405003 %
Train average accuracy residuals : 69.510002 %

== Train average loss all : 0.116037

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0875, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0812, Train/loss_recog_step=0.632, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0875, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0812, Train/loss_recog_step=0.632, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]Epoch 4:  16%|█▌        | 50/313 [01:06<05:49,  0.75it/s, v_num=0, Train/loss_all_step=0.0875, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0812, Train/loss_recog_step=0.632, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]Epoch 4:  16%|█▌        | 50/313 [01:06<05:49,  0.75it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.610, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]  Epoch 4:  32%|███▏      | 100/313 [02:03<04:23,  0.81it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.610, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]Epoch 4:  32%|███▏      | 100/313 [02:03<04:23,  0.81it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.634, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]Epoch 4:  48%|████▊     | 150/313 [03:02<03:17,  0.82it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.634, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]Epoch 4:  48%|████▊     | 150/313 [03:02<03:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0966, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0904, Train/loss_recog_step=0.622, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]Epoch 4:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0966, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0904, Train/loss_recog_step=0.622, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]Epoch 4:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0759, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0697, Train/loss_recog_step=0.625, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]Epoch 4:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0759, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0697, Train/loss_recog_step=0.625, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]Epoch 4:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0631, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.057, Train/loss_recog_step=0.607, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631] Epoch 4:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0631, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.057, Train/loss_recog_step=0.607, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]Epoch 4:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.635, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631] Epoch 4: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.635, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]Epoch 4: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.077, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0707, Train/loss_recog_step=0.633, Valid/loss_all_step=0.148, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=0.653, Valid/knn_avr=0.468, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.23it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.94it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.89it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183325, 0.186516, 0.188627, 0.194455
Valid average loss UNet                 (all)                : 0.752924

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.043667, 0.628284, 1.295559
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.147162, 0.287357, 0.356743
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.223448, 0.413930, 0.400188
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.179089, 0.411568, 0.541674
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.132591, 0.431555, 0.606870
Valid average loss all      (Triplet)                 : 0.151559

== Recognize ==
Valid average loss Recognize     : 0.640703
Valid average accuracy drums     : 68.000000 %
Valid average accuracy bass      : 76.500000 %
Valid average accuracy piano     : 65.500000 %
Valid average accuracy guitar    : 63.000000 %
Valid average accuracy residuals : 74.000000 %

== Valid average loss all : 0.157966

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.300050973892212 sec. =
Valid knn accuracy drums     : 81.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.518525123596191 sec. =
Valid knn accuracy bass      : 26.61290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.851272106170654 sec. =
Valid knn accuracy piano     : 31.0546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.127764701843262 sec. =
Valid knn accuracy guitar    : 38.392857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.494590997695923 sec. =
Valid knn accuracy residuals : 55.90909090909091%

Valid knn accuracy average   : 46.69825558163785%

                                                                      [AEpoch 4: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.077, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0707, Train/loss_recog_step=0.633, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.110, Train/loss_recog_epoch=0.631]Epoch 4: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.077, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0707, Train/loss_recog_step=0.633, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188645, 0.188945, 0.187868, 0.194650
Train average loss UNet                 (all)                : 0.760108

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.014226, 0.659237, 1.327498
Train average loss bass     (Triplet, dist_p, dist_n) : 0.144289, 0.349584, 0.463656
Train average loss piano    (Triplet, dist_p, dist_n) : 0.134555, 0.423067, 0.540883
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.098846, 0.436631, 0.683003
Train average loss residuals(Triplet, dist_p, dist_n) : 0.093280, 0.480813, 0.723847
Train average loss all      (Triplet)                 : 0.098274

== Recognize ==
Train average loss Recognize     : 0.625628
Train average accuracy drums     : 90.525002 %
Train average accuracy bass      : 66.275002 %
Train average accuracy piano     : 64.529999 %
Train average accuracy guitar    : 63.125004 %
Train average accuracy residuals : 72.915001 %

== Train average loss all : 0.104531

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.077, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0707, Train/loss_recog_step=0.633, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.077, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0707, Train/loss_recog_step=0.633, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]Epoch 5:  16%|█▌        | 50/313 [01:06<05:52,  0.75it/s, v_num=0, Train/loss_all_step=0.077, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0707, Train/loss_recog_step=0.633, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]Epoch 5:  16%|█▌        | 50/313 [01:06<05:52,  0.75it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.608, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626] Epoch 5:  32%|███▏      | 100/313 [02:04<04:25,  0.80it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.608, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]Epoch 5:  32%|███▏      | 100/313 [02:04<04:25,  0.80it/s, v_num=0, Train/loss_all_step=0.0979, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0916, Train/loss_recog_step=0.630, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]Epoch 5:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.0979, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0916, Train/loss_recog_step=0.630, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]Epoch 5:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.612, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]  Epoch 5:  64%|██████▍   | 200/313 [04:04<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.612, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]Epoch 5:  64%|██████▍   | 200/313 [04:04<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0855, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0794, Train/loss_recog_step=0.616, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]Epoch 5:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0855, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0794, Train/loss_recog_step=0.616, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]Epoch 5:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0677, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.0617, Train/loss_recog_step=0.604, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]Epoch 5:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0677, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.0617, Train/loss_recog_step=0.604, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]Epoch 5:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.0965, Train/loss_recog_step=0.621, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626] Epoch 5: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.0965, Train/loss_recog_step=0.621, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]Epoch 5: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0524, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0461, Train/loss_recog_step=0.634, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=0.641, Valid/knn_avr=0.467, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.40it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.20it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.79it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184184, 0.187328, 0.189515, 0.198692
Valid average loss UNet                 (all)                : 0.759718

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.058059, 0.715119, 1.424358
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.161593, 0.358722, 0.423037
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.212903, 0.464008, 0.457836
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.150277, 0.481069, 0.638472
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.116191, 0.482093, 0.759935
Valid average loss all      (Triplet)                 : 0.144827

== Recognize ==
Valid average loss Recognize     : 0.645211
Valid average accuracy drums     : 71.500000 %
Valid average accuracy bass      : 60.500000 %
Valid average accuracy piano     : 63.000000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 66.000000 %

== Valid average loss all : 0.151279

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.05465579032898 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.65522313117981 sec. =
Valid knn accuracy bass      : 31.451612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.389360666275024 sec. =
Valid knn accuracy piano     : 40.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.308037042617798 sec. =
Valid knn accuracy guitar    : 42.63392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.630738973617554 sec. =
Valid knn accuracy residuals : 61.81818181818181%

Valid knn accuracy average   : 52.05812237595854%

                                                                      [AEpoch 5: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0524, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0461, Train/loss_recog_step=0.634, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0983, Train/loss_recog_epoch=0.626]Epoch 5: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0524, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0461, Train/loss_recog_step=0.634, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188897, 0.189183, 0.188122, 0.194338
Train average loss UNet                 (all)                : 0.760540

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.010579, 0.760066, 1.504914
Train average loss bass     (Triplet, dist_p, dist_n) : 0.133078, 0.416626, 0.558587
Train average loss piano    (Triplet, dist_p, dist_n) : 0.116792, 0.492115, 0.651695
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.087686, 0.503613, 0.797435
Train average loss residuals(Triplet, dist_p, dist_n) : 0.081832, 0.547757, 0.830467
Train average loss all      (Triplet)                 : 0.087000

== Recognize ==
Train average loss Recognize     : 0.623213
Train average accuracy drums     : 89.529999 %
Train average accuracy bass      : 66.805000 %
Train average accuracy piano     : 64.490005 %
Train average accuracy guitar    : 64.200005 %
Train average accuracy residuals : 71.879997 %

== Train average loss all : 0.093232

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0524, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0461, Train/loss_recog_step=0.634, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0524, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0461, Train/loss_recog_step=0.634, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]Epoch 6:  16%|█▌        | 50/313 [01:06<05:51,  0.75it/s, v_num=0, Train/loss_all_step=0.0524, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0461, Train/loss_recog_step=0.634, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]Epoch 6:  16%|█▌        | 50/313 [01:06<05:51,  0.75it/s, v_num=0, Train/loss_all_step=0.0909, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0847, Train/loss_recog_step=0.622, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]Epoch 6:  32%|███▏      | 100/313 [02:05<04:27,  0.80it/s, v_num=0, Train/loss_all_step=0.0909, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0847, Train/loss_recog_step=0.622, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]Epoch 6:  32%|███▏      | 100/313 [02:05<04:27,  0.80it/s, v_num=0, Train/loss_all_step=0.0848, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0785, Train/loss_recog_step=0.628, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]Epoch 6:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.0848, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0785, Train/loss_recog_step=0.628, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]Epoch 6:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.0982, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0923, Train/loss_recog_step=0.591, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]Epoch 6:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0982, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0923, Train/loss_recog_step=0.591, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]Epoch 6:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0736, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0674, Train/loss_recog_step=0.618, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]Epoch 6:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0736, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0674, Train/loss_recog_step=0.618, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]Epoch 6:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0556, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.0495, Train/loss_recog_step=0.613, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]Epoch 6:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0556, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.0495, Train/loss_recog_step=0.613, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]Epoch 6:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0834, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.077, Train/loss_recog_step=0.632, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623] Epoch 6: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0834, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.077, Train/loss_recog_step=0.632, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]Epoch 6: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0371, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.617, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=0.645, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.36it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.80it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.51it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.29it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184121, 0.187319, 0.189311, 0.205177
Valid average loss UNet                 (all)                : 0.765928

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061489, 0.878000, 1.669201
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.196435, 0.498497, 0.540231
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.235007, 0.589764, 0.585879
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.149205, 0.604549, 0.800844
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.119113, 0.639478, 0.893805
Valid average loss all      (Triplet)                 : 0.161507

== Recognize ==
Valid average loss Recognize     : 0.632344
Valid average accuracy drums     : 56.000000 %
Valid average accuracy bass      : 60.500000 %
Valid average accuracy piano     : 62.000000 %
Valid average accuracy guitar    : 57.500000 %
Valid average accuracy residuals : 67.500000 %

== Valid average loss all : 0.167831

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.712140083312988 sec. =
Valid knn accuracy drums     : 81.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.233377933502197 sec. =
Valid knn accuracy bass      : 28.024193548387093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.83777928352356 sec. =
Valid knn accuracy piano     : 31.8359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.347032308578491 sec. =
Valid knn accuracy guitar    : 41.517857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.32439398765564 sec. =
Valid knn accuracy residuals : 61.81818181818181%

Valid knn accuracy average   : 48.94358182797216%

                                                                      [AEpoch 6: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0371, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.617, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0932, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.087, Train/loss_recog_epoch=0.623]Epoch 6: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0371, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.617, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189087, 0.189379, 0.188295, 0.194292
Train average loss UNet                 (all)                : 0.761053

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.009409, 0.885634, 1.710542
Train average loss bass     (Triplet, dist_p, dist_n) : 0.119806, 0.489866, 0.668817
Train average loss piano    (Triplet, dist_p, dist_n) : 0.101796, 0.580169, 0.785044
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.074764, 0.594085, 0.943731
Train average loss residuals(Triplet, dist_p, dist_n) : 0.068243, 0.630771, 0.970178
Train average loss all      (Triplet)                 : 0.075714

== Recognize ==
Train average loss Recognize     : 0.621706
Train average accuracy drums     : 83.150002 %
Train average accuracy bass      : 66.684998 %
Train average accuracy piano     : 65.080002 %
Train average accuracy guitar    : 65.834999 %
Train average accuracy residuals : 74.495003 %

== Train average loss all : 0.081931

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0371, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.617, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0371, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.617, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]Epoch 7:  16%|█▌        | 50/313 [01:07<05:52,  0.75it/s, v_num=0, Train/loss_all_step=0.0371, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.617, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]Epoch 7:  16%|█▌        | 50/313 [01:07<05:52,  0.75it/s, v_num=0, Train/loss_all_step=0.0776, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0714, Train/loss_recog_step=0.622, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]Epoch 7:  32%|███▏      | 100/313 [02:04<04:25,  0.80it/s, v_num=0, Train/loss_all_step=0.0776, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0714, Train/loss_recog_step=0.622, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]Epoch 7:  32%|███▏      | 100/313 [02:04<04:25,  0.80it/s, v_num=0, Train/loss_all_step=0.0835, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0773, Train/loss_recog_step=0.628, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]Epoch 7:  48%|████▊     | 150/313 [03:02<03:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0835, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0773, Train/loss_recog_step=0.628, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]Epoch 7:  48%|████▊     | 150/313 [03:02<03:18,  0.82it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.096, Train/loss_recog_step=0.608, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]  Epoch 7:  64%|██████▍   | 200/313 [04:00<02:15,  0.83it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.096, Train/loss_recog_step=0.608, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]Epoch 7:  64%|██████▍   | 200/313 [04:00<02:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0611, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.055, Train/loss_recog_step=0.615, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]Epoch 7:  80%|███████▉  | 250/313 [04:59<01:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0611, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.055, Train/loss_recog_step=0.615, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]Epoch 7:  80%|███████▉  | 250/313 [04:59<01:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0391, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.033, Train/loss_recog_step=0.610, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]Epoch 7:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0391, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.033, Train/loss_recog_step=0.610, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]Epoch 7:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0558, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.0498, Train/loss_recog_step=0.607, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]Epoch 7: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0558, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.0498, Train/loss_recog_step=0.607, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]Epoch 7: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0317, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.617, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.569, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.632, Valid/knn_avr=0.489, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.27it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.14it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.71it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185315, 0.188572, 0.190629, 0.198365
Valid average loss UNet                 (all)                : 0.762882

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061489, 1.019497, 1.771292
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.199238, 0.597467, 0.659139
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.237364, 0.715688, 0.761795
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.159502, 0.725013, 0.951024
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.138131, 0.787785, 1.131501
Valid average loss all      (Triplet)                 : 0.167464

== Recognize ==
Valid average loss Recognize     : 0.654400
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 67.000000 %
Valid average accuracy piano     : 59.500004 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 66.500000 %

== Valid average loss all : 0.174008

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.397292852401733 sec. =
Valid knn accuracy drums     : 82.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.357544660568237 sec. =
Valid knn accuracy bass      : 35.28225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.78406810760498 sec. =
Valid knn accuracy piano     : 46.484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.198075532913208 sec. =
Valid knn accuracy guitar    : 49.55357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.285348653793335 sec. =
Valid knn accuracy residuals : 60.68181818181818%

Valid knn accuracy average   : 54.87866540454637%

                                                                      [AEpoch 7: 100%|██████████| 313/313 [07:34<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.0317, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.617, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0819, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0757, Train/loss_recog_epoch=0.622]Epoch 7: 100%|██████████| 313/313 [07:34<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.0317, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.617, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188988, 0.189267, 0.188195, 0.194376
Train average loss UNet                 (all)                : 0.760826

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007503, 0.993102, 1.892342
Train average loss bass     (Triplet, dist_p, dist_n) : 0.108799, 0.562713, 0.780225
Train average loss piano    (Triplet, dist_p, dist_n) : 0.088405, 0.663352, 0.916546
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.067739, 0.670373, 1.069183
Train average loss residuals(Triplet, dist_p, dist_n) : 0.060492, 0.726025, 1.112402
Train average loss all      (Triplet)                 : 0.067280

== Recognize ==
Train average loss Recognize     : 0.622103
Train average accuracy drums     : 77.305000 %
Train average accuracy bass      : 65.415001 %
Train average accuracy piano     : 63.620003 %
Train average accuracy guitar    : 65.699997 %
Train average accuracy residuals : 76.004997 %

== Train average loss all : 0.073501

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0317, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.617, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0317, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.617, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]Epoch 8:  16%|█▌        | 50/313 [01:07<05:55,  0.74it/s, v_num=0, Train/loss_all_step=0.0317, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.617, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]Epoch 8:  16%|█▌        | 50/313 [01:07<05:55,  0.74it/s, v_num=0, Train/loss_all_step=0.0418, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0354, Train/loss_recog_step=0.635, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]Epoch 8:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.0418, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0354, Train/loss_recog_step=0.635, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]Epoch 8:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.0689, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0624, Train/loss_recog_step=0.648, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]Epoch 8:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0689, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0624, Train/loss_recog_step=0.648, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]Epoch 8:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0699, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.0639, Train/loss_recog_step=0.601, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]Epoch 8:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0699, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.0639, Train/loss_recog_step=0.601, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]Epoch 8:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0472, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0411, Train/loss_recog_step=0.613, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]Epoch 8:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0472, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0411, Train/loss_recog_step=0.613, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]Epoch 8:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0365, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.607, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]Epoch 8:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0365, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.607, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]Epoch 8:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0597, Train/loss_recog_step=0.635, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622] Epoch 8: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0597, Train/loss_recog_step=0.635, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]Epoch 8: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.633, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.654, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.15it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.37it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.64it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186849, 0.190102, 0.192489, 0.205082
Valid average loss UNet                 (all)                : 0.774521

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.057476, 1.173521, 2.116174
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.199784, 0.801246, 0.913517
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.249167, 0.882834, 0.919267
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.210466, 0.956869, 1.213749
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.164963, 0.994555, 1.302683
Valid average loss all      (Triplet)                 : 0.180979

== Recognize ==
Valid average loss Recognize     : 0.628535
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 62.000000 %
Valid average accuracy piano     : 62.000000 %
Valid average accuracy guitar    : 65.000000 %
Valid average accuracy residuals : 69.000000 %

== Valid average loss all : 0.187264

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.387450933456421 sec. =
Valid knn accuracy drums     : 80.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.26429557800293 sec. =
Valid knn accuracy bass      : 31.048387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.595517635345459 sec. =
Valid knn accuracy piano     : 37.3046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.550339460372925 sec. =
Valid knn accuracy guitar    : 48.660714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.24594783782959 sec. =
Valid knn accuracy residuals : 63.18181818181819%

Valid knn accuracy average   : 52.16955619547002%

                                                                      [AEpoch 8: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.633, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0673, Train/loss_recog_epoch=0.622]Epoch 8: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.633, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189084, 0.189378, 0.188283, 0.194781
Train average loss UNet                 (all)                : 0.761526

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006060, 1.114302, 2.106869
Train average loss bass     (Triplet, dist_p, dist_n) : 0.092657, 0.647651, 0.912033
Train average loss piano    (Triplet, dist_p, dist_n) : 0.070344, 0.753907, 1.070302
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.057520, 0.772604, 1.232064
Train average loss residuals(Triplet, dist_p, dist_n) : 0.051646, 0.827266, 1.274580
Train average loss all      (Triplet)                 : 0.056421

== Recognize ==
Train average loss Recognize     : 0.622787
Train average accuracy drums     : 72.455002 %
Train average accuracy bass      : 65.300003 %
Train average accuracy piano     : 62.695004 %
Train average accuracy guitar    : 65.660004 %
Train average accuracy residuals : 75.489998 %

== Train average loss all : 0.062649

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.633, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.633, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]Epoch 9:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.633, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]Epoch 9:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.0408, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0345, Train/loss_recog_step=0.624, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]Epoch 9:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0408, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0345, Train/loss_recog_step=0.624, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]Epoch 9:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0794, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0731, Train/loss_recog_step=0.625, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]Epoch 9:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0794, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0731, Train/loss_recog_step=0.625, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]Epoch 9:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0761, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0701, Train/loss_recog_step=0.597, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]Epoch 9:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0761, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0701, Train/loss_recog_step=0.597, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]Epoch 9:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.046, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0397, Train/loss_recog_step=0.636, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623] Epoch 9:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.046, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0397, Train/loss_recog_step=0.636, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]Epoch 9:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0189, Train/loss_recog_step=0.609, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]Epoch 9:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0189, Train/loss_recog_step=0.609, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]Epoch 9:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0536, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0472, Train/loss_recog_step=0.637, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]Epoch 9: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0536, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0472, Train/loss_recog_step=0.637, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]Epoch 9: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0257, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.635, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.0995, Valid/loss_recog_step=0.608, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.629, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.00it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.45it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.61it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186924, 0.190232, 0.192696, 0.198522
Valid average loss UNet                 (all)                : 0.768374

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.063115, 1.261577, 2.178317
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.204484, 0.866194, 0.986123
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.339341, 1.025399, 1.024740
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.220145, 1.052791, 1.315242
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.168445, 1.125951, 1.373298
Valid average loss all      (Triplet)                 : 0.197040

== Recognize ==
Valid average loss Recognize     : 0.648429
Valid average accuracy drums     : 69.500000 %
Valid average accuracy bass      : 60.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 61.500000 %
Valid average accuracy residuals : 58.999996 %

== Valid average loss all : 0.203524

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.588820934295654 sec. =
Valid knn accuracy drums     : 85.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.684415102005005 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.468298435211182 sec. =
Valid knn accuracy piano     : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.62509036064148 sec. =
Valid knn accuracy guitar    : 47.32142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.209294080734253 sec. =
Valid knn accuracy residuals : 61.36363636363637%

Valid knn accuracy average   : 53.57510905994427%

                                                                      [AEpoch 9: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0257, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.635, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0626, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0564, Train/loss_recog_epoch=0.623]Epoch 9: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0257, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.635, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188911, 0.189213, 0.188110, 0.194590
Train average loss UNet                 (all)                : 0.760824

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007243, 1.218462, 2.256446
Train average loss bass     (Triplet, dist_p, dist_n) : 0.084016, 0.734216, 1.043282
Train average loss piano    (Triplet, dist_p, dist_n) : 0.065673, 0.855558, 1.216022
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.049091, 0.865877, 1.380514
Train average loss residuals(Triplet, dist_p, dist_n) : 0.042946, 0.904908, 1.411357
Train average loss all      (Triplet)                 : 0.050759

== Recognize ==
Train average loss Recognize     : 0.624372
Train average accuracy drums     : 65.995003 %
Train average accuracy bass      : 66.145004 %
Train average accuracy piano     : 61.419998 %
Train average accuracy guitar    : 65.224998 %
Train average accuracy residuals : 72.599998 %

== Train average loss all : 0.057002

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0257, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.635, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0257, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.635, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]Epoch 10:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.0257, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.635, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]Epoch 10:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.0415, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0353, Train/loss_recog_step=0.617, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]Epoch 10:  32%|███▏      | 100/313 [02:06<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.0415, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0353, Train/loss_recog_step=0.617, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]Epoch 10:  32%|███▏      | 100/313 [02:06<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.0424, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0362, Train/loss_recog_step=0.616, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]Epoch 10:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0424, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0362, Train/loss_recog_step=0.616, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]Epoch 10:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0529, Train/loss_recog_step=0.620, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]Epoch 10:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0529, Train/loss_recog_step=0.620, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]Epoch 10:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0544, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0481, Train/loss_recog_step=0.626, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]Epoch 10:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0544, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0481, Train/loss_recog_step=0.626, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]Epoch 10:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0349, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.0289, Train/loss_recog_step=0.603, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]Epoch 10:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0349, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.0289, Train/loss_recog_step=0.603, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]Epoch 10:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0515, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=0.636, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]Epoch 10: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0515, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=0.636, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]Epoch 10: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0253, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.620, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.0967, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.197, Valid/loss_recog_epoch=0.648, Valid/knn_avr=0.536, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.68it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.05it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.11it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.83it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185808, 0.189107, 0.191323, 0.201880
Valid average loss UNet                 (all)                : 0.768118

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065852, 1.400622, 2.571890
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.310408, 1.067167, 1.111720
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.341683, 1.197660, 1.204465
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.248616, 1.197807, 1.547551
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.181825, 1.314022, 1.690345
Valid average loss all      (Triplet)                 : 0.239248

== Recognize ==
Valid average loss Recognize     : 0.661017
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 56.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 62.000000 %
Valid average accuracy residuals : 56.000000 %

== Valid average loss all : 0.245858

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.4254732131958 sec. =
Valid knn accuracy drums     : 82.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.17695689201355 sec. =
Valid knn accuracy bass      : 21.572580645161292%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.518792629241943 sec. =
Valid knn accuracy piano     : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.510340213775635 sec. =
Valid knn accuracy guitar    : 46.205357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.118053436279297 sec. =
Valid knn accuracy residuals : 66.81818181818183%

Valid knn accuracy average   : 50.89748479080527%

                                                                      [AEpoch 10: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0253, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.620, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.057, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0508, Train/loss_recog_epoch=0.624] Epoch 10: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0253, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.620, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188886, 0.189184, 0.188094, 0.195284
Train average loss UNet                 (all)                : 0.761448

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006108, 1.312733, 2.431005
Train average loss bass     (Triplet, dist_p, dist_n) : 0.071344, 0.816284, 1.164350
Train average loss piano    (Triplet, dist_p, dist_n) : 0.055038, 0.957038, 1.378952
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.044792, 0.971649, 1.548411
Train average loss residuals(Triplet, dist_p, dist_n) : 0.036594, 1.009652, 1.577303
Train average loss all      (Triplet)                 : 0.043408

== Recognize ==
Train average loss Recognize     : 0.627339
Train average accuracy drums     : 62.075001 %
Train average accuracy bass      : 63.840000 %
Train average accuracy piano     : 60.790001 %
Train average accuracy guitar    : 64.660004 %
Train average accuracy residuals : 72.089996 %

== Train average loss all : 0.049682

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0253, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.620, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0253, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.620, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]Epoch 11:  16%|█▌        | 50/313 [01:06<05:50,  0.75it/s, v_num=0, Train/loss_all_step=0.0253, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.620, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]Epoch 11:  16%|█▌        | 50/313 [01:06<05:50,  0.75it/s, v_num=0, Train/loss_all_step=0.0376, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0312, Train/loss_recog_step=0.636, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]Epoch 11:  32%|███▏      | 100/313 [02:03<04:23,  0.81it/s, v_num=0, Train/loss_all_step=0.0376, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0312, Train/loss_recog_step=0.636, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]Epoch 11:  32%|███▏      | 100/313 [02:03<04:23,  0.81it/s, v_num=0, Train/loss_all_step=0.0703, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0638, Train/loss_recog_step=0.648, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]Epoch 11:  48%|████▊     | 150/313 [03:02<03:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0703, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0638, Train/loss_recog_step=0.648, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]Epoch 11:  48%|████▊     | 150/313 [03:02<03:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0348, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=0.614, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]Epoch 11:  64%|██████▍   | 200/313 [04:00<02:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0348, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=0.614, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]Epoch 11:  64%|██████▍   | 200/313 [04:00<02:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0354, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=0.640, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627] Epoch 11:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0354, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=0.640, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]Epoch 11:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0276, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0212, Train/loss_recog_step=0.637, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]Epoch 11:  96%|█████████▌| 300/313 [05:57<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0276, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0212, Train/loss_recog_step=0.637, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]Epoch 11:  96%|█████████▌| 300/313 [05:57<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0409, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0343, Train/loss_recog_step=0.667, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]Epoch 11: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.0409, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0343, Train/loss_recog_step=0.667, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]Epoch 11: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.0222, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.642, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=0.661, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.07it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.83it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.07it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.41it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185995, 0.189214, 0.191932, 0.204172
Valid average loss UNet                 (all)                : 0.771312

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.059223, 1.607597, 2.967864
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.343895, 1.279081, 1.374416
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.347068, 1.417447, 1.453583
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.217120, 1.294063, 1.771974
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.231220, 1.676713, 1.929460
Valid average loss all      (Triplet)                 : 0.255820

== Recognize ==
Valid average loss Recognize     : 0.656204
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 65.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 59.500004 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.262382

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.329483270645142 sec. =
Valid knn accuracy drums     : 81.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.698374271392822 sec. =
Valid knn accuracy bass      : 27.21774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.519073486328125 sec. =
Valid knn accuracy piano     : 37.3046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.269639253616333 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.156216382980347 sec. =
Valid knn accuracy residuals : 65.68181818181819%

Valid knn accuracy average   : 52.34519734954737%

                                                                      [AEpoch 11: 100%|██████████| 313/313 [07:33<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.0222, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.642, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0497, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.627]Epoch 11: 100%|██████████| 313/313 [07:33<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.0222, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.642, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188600, 0.188881, 0.187821, 0.194918
Train average loss UNet                 (all)                : 0.760221

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005154, 1.411312, 2.628168
Train average loss bass     (Triplet, dist_p, dist_n) : 0.069882, 0.890164, 1.267083
Train average loss piano    (Triplet, dist_p, dist_n) : 0.045745, 1.032000, 1.505893
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.038236, 1.044428, 1.684397
Train average loss residuals(Triplet, dist_p, dist_n) : 0.028751, 1.090294, 1.716294
Train average loss all      (Triplet)                 : 0.038010

== Recognize ==
Train average loss Recognize     : 0.632238
Train average accuracy drums     : 59.249996 %
Train average accuracy bass      : 63.005001 %
Train average accuracy piano     : 59.925003 %
Train average accuracy guitar    : 62.370003 %
Train average accuracy residuals : 68.845001 %

== Train average loss all : 0.044332

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0222, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.642, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0222, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.642, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]Epoch 12:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.0222, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.642, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]Epoch 12:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.0314, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.025, Train/loss_recog_step=0.644, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632] Epoch 12:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.0314, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.025, Train/loss_recog_step=0.644, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]Epoch 12:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.0243, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.018, Train/loss_recog_step=0.634, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]Epoch 12:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.0243, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.018, Train/loss_recog_step=0.634, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]Epoch 12:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.045, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0389, Train/loss_recog_step=0.617, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]Epoch 12:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.045, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0389, Train/loss_recog_step=0.617, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]Epoch 12:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0488, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0424, Train/loss_recog_step=0.636, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]Epoch 12:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0488, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0424, Train/loss_recog_step=0.636, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]Epoch 12:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=0.622, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]Epoch 12:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=0.622, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]Epoch 12:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0256, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=0.639, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]Epoch 12: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0256, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=0.639, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]Epoch 12: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0396, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0334, Train/loss_recog_step=0.623, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.656, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.04it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.42it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.09it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185387, 0.188716, 0.191031, 0.201942
Valid average loss UNet                 (all)                : 0.767076

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.032765, 1.619674, 3.063945
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.392694, 1.371227, 1.398802
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.346094, 1.477480, 1.518120
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.193696, 1.371786, 1.925635
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.209151, 1.658997, 1.961004
Valid average loss all      (Triplet)                 : 0.258324

== Recognize ==
Valid average loss Recognize     : 0.681998
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 57.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.265144

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.02197790145874 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.704411506652832 sec. =
Valid knn accuracy bass      : 21.774193548387096%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.39892053604126 sec. =
Valid knn accuracy piano     : 31.0546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.414234638214111 sec. =
Valid knn accuracy guitar    : 41.74107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.309101581573486 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 49.41794306456167%

                                                                      [AEpoch 12: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0396, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0334, Train/loss_recog_step=0.623, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0443, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.038, Train/loss_recog_epoch=0.632]Epoch 12: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0396, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0334, Train/loss_recog_step=0.623, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188458, 0.188761, 0.187692, 0.194801
Train average loss UNet                 (all)                : 0.759713

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006179, 1.477914, 2.735394
Train average loss bass     (Triplet, dist_p, dist_n) : 0.056016, 0.948711, 1.374400
Train average loss piano    (Triplet, dist_p, dist_n) : 0.038640, 1.084493, 1.599786
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.034379, 1.105280, 1.780016
Train average loss residuals(Triplet, dist_p, dist_n) : 0.031384, 1.177475, 1.844759
Train average loss all      (Triplet)                 : 0.034103

== Recognize ==
Train average loss Recognize     : 0.636462
Train average accuracy drums     : 56.994999 %
Train average accuracy bass      : 61.395000 %
Train average accuracy piano     : 58.730000 %
Train average accuracy guitar    : 61.879997 %
Train average accuracy residuals : 65.934998 %

== Train average loss all : 0.040467

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0396, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0334, Train/loss_recog_step=0.623, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0396, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0334, Train/loss_recog_step=0.623, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]Epoch 13:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0396, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0334, Train/loss_recog_step=0.623, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]Epoch 13:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0332, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0269, Train/loss_recog_step=0.627, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]Epoch 13:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0332, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0269, Train/loss_recog_step=0.627, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]Epoch 13:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.036, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0293, Train/loss_recog_step=0.663, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636] Epoch 13:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.036, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0293, Train/loss_recog_step=0.663, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]Epoch 13:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0231, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=0.623, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]Epoch 13:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0231, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=0.623, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]Epoch 13:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0263, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0197, Train/loss_recog_step=0.660, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]Epoch 13:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0263, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0197, Train/loss_recog_step=0.660, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]Epoch 13:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0307, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0245, Train/loss_recog_step=0.618, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]Epoch 13:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0307, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0245, Train/loss_recog_step=0.618, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]Epoch 13:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.663, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636] Epoch 13: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.663, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]Epoch 13: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00815, Train/loss_recog_step=0.663, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.81it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.52it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.69it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.65it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185347, 0.188728, 0.191071, 0.201662
Valid average loss UNet                 (all)                : 0.766807

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.029292, 1.642970, 2.998014
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.302433, 1.353836, 1.510975
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.353765, 1.640462, 1.620151
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.210345, 1.440452, 2.118043
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.228000, 1.803032, 2.149493
Valid average loss all      (Triplet)                 : 0.234105

== Recognize ==
Valid average loss Recognize     : 0.685817
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 62.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.240964

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.50241231918335 sec. =
Valid knn accuracy drums     : 86.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.661020517349243 sec. =
Valid knn accuracy bass      : 25.60483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.11460280418396 sec. =
Valid knn accuracy piano     : 38.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.507497072219849 sec. =
Valid knn accuracy guitar    : 48.214285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.243816137313843 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 52.75314059625508%

                                                                      [AEpoch 13: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00815, Train/loss_recog_step=0.663, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0405, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0341, Train/loss_recog_epoch=0.636]Epoch 13: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00815, Train/loss_recog_step=0.663, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188444, 0.188745, 0.187686, 0.194867
Train average loss UNet                 (all)                : 0.759742

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004415, 1.551600, 2.864379
Train average loss bass     (Triplet, dist_p, dist_n) : 0.045507, 1.024362, 1.497547
Train average loss piano    (Triplet, dist_p, dist_n) : 0.034928, 1.175758, 1.744062
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.030969, 1.196638, 1.922145
Train average loss residuals(Triplet, dist_p, dist_n) : 0.026017, 1.268021, 1.995856
Train average loss all      (Triplet)                 : 0.028861

== Recognize ==
Train average loss Recognize     : 0.639765
Train average accuracy drums     : 56.185001 %
Train average accuracy bass      : 59.630001 %
Train average accuracy piano     : 56.965000 %
Train average accuracy guitar    : 60.959999 %
Train average accuracy residuals : 64.104996 %

== Train average loss all : 0.035259

Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00815, Train/loss_recog_step=0.663, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]          Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00815, Train/loss_recog_step=0.663, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]Epoch 14:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00815, Train/loss_recog_step=0.663, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]Epoch 14:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0296, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0231, Train/loss_recog_step=0.649, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640] Epoch 14:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.0296, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0231, Train/loss_recog_step=0.649, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]Epoch 14:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.0301, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0234, Train/loss_recog_step=0.665, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]Epoch 14:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0301, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0234, Train/loss_recog_step=0.665, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]Epoch 14:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0242, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0179, Train/loss_recog_step=0.626, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]Epoch 14:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0242, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0179, Train/loss_recog_step=0.626, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]Epoch 14:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0249, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=0.655, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]Epoch 14:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0249, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=0.655, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]Epoch 14:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00919, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00303, Train/loss_recog_step=0.616, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]Epoch 14:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00919, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00303, Train/loss_recog_step=0.616, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]Epoch 14:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0232, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.659, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]  Epoch 14: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0232, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.659, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]Epoch 14: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.696, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.24it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.26it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.84it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.58it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.94it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184943, 0.188316, 0.190708, 0.187165
Valid average loss UNet                 (all)                : 0.751132

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.039268, 1.742149, 3.132210
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.323928, 1.441803, 1.658156
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.352290, 1.723881, 1.733722
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.248595, 1.628523, 2.233496
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.236518, 1.862371, 2.246970
Valid average loss all      (Triplet)                 : 0.251601

== Recognize ==
Valid average loss Recognize     : 0.685673
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.258458

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.673548936843872 sec. =
Valid knn accuracy drums     : 81.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.60227346420288 sec. =
Valid knn accuracy bass      : 23.588709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.004018545150757 sec. =
Valid knn accuracy piano     : 37.890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.778337001800537 sec. =
Valid knn accuracy guitar    : 43.526785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.2470862865448 sec. =
Valid knn accuracy residuals : 65.0%

Valid knn accuracy average   : 50.2620936435584%

                                                                      [AEpoch 14: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0353, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0289, Train/loss_recog_epoch=0.640]Epoch 14: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188337, 0.188645, 0.187575, 0.195167
Train average loss UNet                 (all)                : 0.759725

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003042, 1.612526, 3.028706
Train average loss bass     (Triplet, dist_p, dist_n) : 0.040805, 1.093120, 1.615208
Train average loss piano    (Triplet, dist_p, dist_n) : 0.028617, 1.251034, 1.886867
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.023873, 1.279596, 2.077909
Train average loss residuals(Triplet, dist_p, dist_n) : 0.022074, 1.335002, 2.116275
Train average loss all      (Triplet)                 : 0.024182

== Recognize ==
Train average loss Recognize     : 0.644513
Train average accuracy drums     : 54.375000 %
Train average accuracy bass      : 58.695000 %
Train average accuracy piano     : 55.769997 %
Train average accuracy guitar    : 59.834999 %
Train average accuracy residuals : 61.494999 %

== Train average loss all : 0.030627

Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]          Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]Epoch 15:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]Epoch 15:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.0205, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.666, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]Epoch 15:  32%|███▏      | 100/313 [02:06<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.0205, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.666, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]Epoch 15:  32%|███▏      | 100/313 [02:06<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.0496, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0427, Train/loss_recog_step=0.686, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]Epoch 15:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.0496, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0427, Train/loss_recog_step=0.686, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]Epoch 15:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.0238, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=0.627, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]Epoch 15:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0238, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=0.627, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]Epoch 15:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0237, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=0.660, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]Epoch 15:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0237, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=0.660, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]Epoch 15:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.0127, Train/loss_recog_step=0.649, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]Epoch 15:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.0127, Train/loss_recog_step=0.649, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]Epoch 15:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0253, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=0.661, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]Epoch 15: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0253, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=0.661, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]Epoch 15: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.637, Valid/loss_all_step=0.198, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.503, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.54it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.05it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.96it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.68it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.12it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184604, 0.187893, 0.190408, 0.194446
Valid average loss UNet                 (all)                : 0.757351

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.082300, 1.765482, 3.154551
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.301990, 1.389971, 1.656163
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.283485, 1.501445, 1.741475
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.220109, 1.473386, 2.036234
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.208337, 1.871907, 2.137579
Valid average loss all      (Triplet)                 : 0.227672

== Recognize ==
Valid average loss Recognize     : 0.671723
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 57.000000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 63.000000 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.234389

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.9077627658844 sec. =
Valid knn accuracy drums     : 82.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.426679134368896 sec. =
Valid knn accuracy bass      : 28.42741935483871%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.528525829315186 sec. =
Valid knn accuracy piano     : 37.3046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.738170623779297 sec. =
Valid knn accuracy guitar    : 50.66964285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.234594583511353 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 53.027385515518844%

                                                                      [AEpoch 15: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.637, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0306, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.645]Epoch 15: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.637, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188325, 0.188644, 0.187564, 0.195308
Train average loss UNet                 (all)                : 0.759840

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003207, 1.686018, 3.133885
Train average loss bass     (Triplet, dist_p, dist_n) : 0.033927, 1.163658, 1.739033
Train average loss piano    (Triplet, dist_p, dist_n) : 0.026107, 1.301470, 1.984100
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.020348, 1.335990, 2.202184
Train average loss residuals(Triplet, dist_p, dist_n) : 0.018811, 1.415553, 2.256670
Train average loss all      (Triplet)                 : 0.020944

== Recognize ==
Train average loss Recognize     : 0.644453
Train average accuracy drums     : 54.009998 %
Train average accuracy bass      : 58.485001 %
Train average accuracy piano     : 55.715000 %
Train average accuracy guitar    : 58.590000 %
Train average accuracy residuals : 61.075001 %

== Train average loss all : 0.027389

Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.637, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]          Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.637, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]Epoch 16:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.637, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]Epoch 16:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.0226, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.660, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644] Epoch 16:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.0226, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.660, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]Epoch 16:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.0386, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.032, Train/loss_recog_step=0.653, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]Epoch 16:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0386, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.032, Train/loss_recog_step=0.653, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]Epoch 16:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0345, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0279, Train/loss_recog_step=0.654, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]Epoch 16:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0345, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0279, Train/loss_recog_step=0.654, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]Epoch 16:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0213, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.655, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]Epoch 16:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0213, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.655, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]Epoch 16:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.040, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0335, Train/loss_recog_step=0.649, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644] Epoch 16:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.040, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0335, Train/loss_recog_step=0.649, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]Epoch 16:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0185, Train/loss_recog_step=0.647, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]Epoch 16: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0185, Train/loss_recog_step=0.647, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]Epoch 16: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000306, Train/loss_recog_step=0.606, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.228, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.57it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.12it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.15it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.17it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185089, 0.188432, 0.190680, 0.200745
Valid average loss UNet                 (all)                : 0.764947

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064864, 1.786710, 3.189159
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.371675, 1.551059, 1.707324
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.323502, 1.662250, 1.798983
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.263736, 1.626515, 2.236567
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.269964, 1.970010, 2.302770
Valid average loss all      (Triplet)                 : 0.269285

== Recognize ==
Valid average loss Recognize     : 0.663349
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 63.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.275918

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.3374183177948 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.23486590385437 sec. =
Valid knn accuracy bass      : 18.951612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.005154371261597 sec. =
Valid knn accuracy piano     : 42.3828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.853307247161865 sec. =
Valid knn accuracy guitar    : 47.544642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.250240564346313 sec. =
Valid knn accuracy residuals : 64.0909090909091%

Valid knn accuracy average   : 51.028778078951206%

                                                                      [AEpoch 16: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000306, Train/loss_recog_step=0.606, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0274, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0209, Train/loss_recog_epoch=0.644]Epoch 16: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000306, Train/loss_recog_step=0.606, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188348, 0.188663, 0.187583, 0.195714
Train average loss UNet                 (all)                : 0.760308

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002836, 1.763608, 3.298444
Train average loss bass     (Triplet, dist_p, dist_n) : 0.031537, 1.252948, 1.888760
Train average loss piano    (Triplet, dist_p, dist_n) : 0.023229, 1.391602, 2.121043
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.019569, 1.435542, 2.376343
Train average loss residuals(Triplet, dist_p, dist_n) : 0.015509, 1.488983, 2.381178
Train average loss all      (Triplet)                 : 0.018760

== Recognize ==
Train average loss Recognize     : 0.651293
Train average accuracy drums     : 53.455002 %
Train average accuracy bass      : 55.295002 %
Train average accuracy piano     : 54.470001 %
Train average accuracy guitar    : 57.360001 %
Train average accuracy residuals : 58.764999 %

== Train average loss all : 0.025273

Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000306, Train/loss_recog_step=0.606, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]          Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000306, Train/loss_recog_step=0.606, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]Epoch 17:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000306, Train/loss_recog_step=0.606, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]Epoch 17:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.654, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]    Epoch 17:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.654, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]Epoch 17:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00937, Train/loss_recog_step=0.668, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]Epoch 17:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00937, Train/loss_recog_step=0.668, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]Epoch 17:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.657, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651] Epoch 17:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.657, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]Epoch 17:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0275, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=0.666, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]Epoch 17:  80%|███████▉  | 250/313 [05:06<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0275, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=0.666, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]Epoch 17:  80%|███████▉  | 250/313 [05:06<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0291, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.0229, Train/loss_recog_step=0.617, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]Epoch 17:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0291, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.0229, Train/loss_recog_step=0.617, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]Epoch 17:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.663, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]Epoch 17: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.663, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]Epoch 17: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00622, Train/loss_recog_step=0.639, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.663, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.58it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.16it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.21it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.01it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184544, 0.187860, 0.190048, 0.202592
Valid average loss UNet                 (all)                : 0.765044

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.055160, 1.738607, 3.218655
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.347793, 1.559403, 1.798069
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.314504, 1.616954, 1.719592
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.206393, 1.631773, 2.203972
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.224033, 1.870291, 2.259244
Valid average loss all      (Triplet)                 : 0.244982

== Recognize ==
Valid average loss Recognize     : 0.672036
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 58.499996 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.251702

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.694211721420288 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.277707815170288 sec. =
Valid knn accuracy bass      : 32.25806451612903%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.588992834091187 sec. =
Valid knn accuracy piano     : 40.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.202534675598145 sec. =
Valid knn accuracy guitar    : 53.34821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.604333639144897 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 55.29763915957815%

                                                                      [AEpoch 17: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00622, Train/loss_recog_step=0.639, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0253, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=0.651]Epoch 17: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00622, Train/loss_recog_step=0.639, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188269, 0.188560, 0.187485, 0.194720
Train average loss UNet                 (all)                : 0.759035

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003386, 1.785945, 3.262168
Train average loss bass     (Triplet, dist_p, dist_n) : 0.025416, 1.295488, 1.957815
Train average loss piano    (Triplet, dist_p, dist_n) : 0.024721, 1.434119, 2.181797
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.017720, 1.466576, 2.424989
Train average loss residuals(Triplet, dist_p, dist_n) : 0.014956, 1.543229, 2.479848
Train average loss all      (Triplet)                 : 0.017346

== Recognize ==
Train average loss Recognize     : 0.654574
Train average accuracy drums     : 53.965004 %
Train average accuracy bass      : 55.639999 %
Train average accuracy piano     : 54.540001 %
Train average accuracy guitar    : 56.919998 %
Train average accuracy residuals : 57.605000 %

== Train average loss all : 0.023891

Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00622, Train/loss_recog_step=0.639, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]          Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00622, Train/loss_recog_step=0.639, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]Epoch 18:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00622, Train/loss_recog_step=0.639, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]Epoch 18:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.676, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655] Epoch 18:  32%|███▏      | 100/313 [02:07<04:31,  0.79it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.676, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]Epoch 18:  32%|███▏      | 100/313 [02:07<04:31,  0.79it/s, v_num=0, Train/loss_all_step=0.0278, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0212, Train/loss_recog_step=0.656, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]Epoch 18:  48%|████▊     | 150/313 [03:03<03:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0278, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0212, Train/loss_recog_step=0.656, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]Epoch 18:  48%|████▊     | 150/313 [03:03<03:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0287, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=0.645, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]Epoch 18:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0287, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=0.645, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]Epoch 18:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0194, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0127, Train/loss_recog_step=0.665, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]Epoch 18:  80%|███████▉  | 250/313 [04:59<01:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0194, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0127, Train/loss_recog_step=0.665, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]Epoch 18:  80%|███████▉  | 250/313 [04:59<01:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00975, Train/loss_recog_step=0.644, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]Epoch 18:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00975, Train/loss_recog_step=0.644, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]Epoch 18:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.008, Train/loss_recog_step=0.668, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]  Epoch 18: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.008, Train/loss_recog_step=0.668, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]Epoch 18: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.668, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.672, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.48it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.14it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.30it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.78it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.55it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.42it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184731, 0.188085, 0.190388, 0.204553
Valid average loss UNet                 (all)                : 0.767757

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.044419, 1.799674, 3.079636
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.316795, 1.536273, 1.928924
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.336405, 1.811776, 1.925757
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.233065, 1.572509, 2.254910
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.255845, 2.104053, 2.364834
Valid average loss all      (Triplet)                 : 0.250770

== Recognize ==
Valid average loss Recognize     : 0.643205
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.257202

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.353114366531372 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.733163833618164 sec. =
Valid knn accuracy bass      : 24.39516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.564771890640259 sec. =
Valid knn accuracy piano     : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.357540607452393 sec. =
Valid knn accuracy guitar    : 43.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.220840454101562 sec. =
Valid knn accuracy residuals : 64.77272727272727%

Valid knn accuracy average   : 51.170534234349105%

                                                                      [AEpoch 18: 100%|██████████| 313/313 [07:34<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.668, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0239, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.655]Epoch 18: 100%|██████████| 313/313 [07:34<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.668, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188233, 0.188537, 0.187493, 0.194855
Train average loss UNet                 (all)                : 0.759117

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002092, 1.792188, 3.309243
Train average loss bass     (Triplet, dist_p, dist_n) : 0.025471, 1.345480, 2.050759
Train average loss piano    (Triplet, dist_p, dist_n) : 0.020686, 1.481962, 2.281278
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.015342, 1.489314, 2.473456
Train average loss residuals(Triplet, dist_p, dist_n) : 0.015563, 1.619077, 2.606082
Train average loss all      (Triplet)                 : 0.015893

== Recognize ==
Train average loss Recognize     : 0.652566
Train average accuracy drums     : 53.535004 %
Train average accuracy bass      : 55.379997 %
Train average accuracy piano     : 54.974998 %
Train average accuracy guitar    : 56.535000 %
Train average accuracy residuals : 58.859997 %

== Train average loss all : 0.022418

Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.668, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]          Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.668, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]Epoch 19:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.668, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]Epoch 19:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00957, Train/loss_recog_step=0.664, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]Epoch 19:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00957, Train/loss_recog_step=0.664, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]Epoch 19:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=0.651, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653] Epoch 19:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=0.651, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]Epoch 19:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00971, Train/loss_recog_step=0.675, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]Epoch 19:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00971, Train/loss_recog_step=0.675, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]Epoch 19:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00966, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=0.658, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]Epoch 19:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00966, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=0.658, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]Epoch 19:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00896, Train/loss_recog_step=0.636, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653] Epoch 19:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00896, Train/loss_recog_step=0.636, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]Epoch 19:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.017, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.675, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]  Epoch 19: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.017, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.675, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]Epoch 19: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.661, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.540, Valid/loss_all_epoch=0.257, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.643, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.33it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.90it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.30it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.84it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183993, 0.187347, 0.189509, 0.197321
Valid average loss UNet                 (all)                : 0.758170

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.049191, 1.828993, 3.232019
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.344550, 1.706452, 2.032354
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.355244, 1.807458, 1.928959
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.297094, 1.777461, 2.354304
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.248176, 2.158594, 2.465338
Valid average loss all      (Triplet)                 : 0.271710

== Recognize ==
Valid average loss Recognize     : 0.684835
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.278558

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.820290327072144 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.67987608909607 sec. =
Valid knn accuracy bass      : 25.806451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.60383939743042 sec. =
Valid knn accuracy piano     : 37.6953125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.301387786865234 sec. =
Valid knn accuracy guitar    : 46.205357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.283004522323608 sec. =
Valid knn accuracy residuals : 60.45454545454545%

Valid knn accuracy average   : 50.81494203771333%

                                                                      [AEpoch 19: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.661, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.0224, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.653]Epoch 19: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.661, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188085, 0.188418, 0.187350, 0.195411
Train average loss UNet                 (all)                : 0.759264

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001689, 1.807113, 3.394860
Train average loss bass     (Triplet, dist_p, dist_n) : 0.022936, 1.382386, 2.121780
Train average loss piano    (Triplet, dist_p, dist_n) : 0.018033, 1.519614, 2.349187
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.015138, 1.514378, 2.514575
Train average loss residuals(Triplet, dist_p, dist_n) : 0.013979, 1.657167, 2.678836
Train average loss all      (Triplet)                 : 0.014450

== Recognize ==
Train average loss Recognize     : 0.654894
Train average accuracy drums     : 53.570004 %
Train average accuracy bass      : 55.580002 %
Train average accuracy piano     : 53.525002 %
Train average accuracy guitar    : 56.099998 %
Train average accuracy residuals : 57.840000 %

== Train average loss all : 0.020999

Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.661, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655]          Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.661, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655]Epoch 20:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.661, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655]Epoch 20:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.0227, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.692, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655]Epoch 20:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.0227, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.692, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655]Epoch 20:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.019, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.670, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655] Epoch 20:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.019, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.670, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655]Epoch 20:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00847, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=0.658, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655]Epoch 20:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00847, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=0.658, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655]Epoch 20:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0222, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0155, Train/loss_recog_step=0.679, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655] Epoch 20:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0222, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0155, Train/loss_recog_step=0.679, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655]Epoch 20:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0235, Train/loss_recog_step=0.639, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655]Epoch 20:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0235, Train/loss_recog_step=0.639, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655]Epoch 20:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.695, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655] Epoch 20: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.695, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655]Epoch 20: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.508, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.29it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.31it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.72it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.96it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184474, 0.187823, 0.190041, 0.185045
Valid average loss UNet                 (all)                : 0.747383

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.042932, 1.815139, 3.156040
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.300347, 1.683696, 2.003397
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.352988, 1.959493, 2.052996
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.212515, 1.737666, 2.482441
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.365635, 2.244999, 2.456905
Valid average loss all      (Triplet)                 : 0.252734

== Recognize ==
Valid average loss Recognize     : 0.711423
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.259848

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.38729214668274 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.860435962677002 sec. =
Valid knn accuracy bass      : 26.814516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.529187440872192 sec. =
Valid knn accuracy piano     : 36.9140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.340588092803955 sec. =
Valid knn accuracy guitar    : 48.88392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.252788543701172 sec. =
Valid knn accuracy residuals : 66.81818181818183%

Valid knn accuracy average   : 52.66874649938072%

                                                                      [AEpoch 20: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.021, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0145, Train/loss_recog_epoch=0.655]Epoch 20: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188330, 0.188637, 0.187558, 0.194570
Train average loss UNet                 (all)                : 0.759096

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001476, 1.831240, 3.427398
Train average loss bass     (Triplet, dist_p, dist_n) : 0.019300, 1.418740, 2.192775
Train average loss piano    (Triplet, dist_p, dist_n) : 0.016659, 1.572481, 2.445692
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.014033, 1.556615, 2.597337
Train average loss residuals(Triplet, dist_p, dist_n) : 0.012443, 1.674627, 2.719451
Train average loss all      (Triplet)                 : 0.013051

== Recognize ==
Train average loss Recognize     : 0.657980
Train average accuracy drums     : 53.189999 %
Train average accuracy bass      : 54.834999 %
Train average accuracy piano     : 53.705002 %
Train average accuracy guitar    : 54.935001 %
Train average accuracy residuals : 57.744999 %

== Train average loss all : 0.019630

Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]          Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]Epoch 21:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]Epoch 21:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.688, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658] Epoch 21:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.688, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]Epoch 21:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.641, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]Epoch 21:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.641, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]Epoch 21:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.636, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]Epoch 21:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.636, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]Epoch 21:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00853, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00181, Train/loss_recog_step=0.672, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]Epoch 21:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00853, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00181, Train/loss_recog_step=0.672, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]Epoch 21:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0345, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0282, Train/loss_recog_step=0.634, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]  Epoch 21:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0345, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0282, Train/loss_recog_step=0.634, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]Epoch 21:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00877, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00185, Train/loss_recog_step=0.692, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]Epoch 21: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00877, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00185, Train/loss_recog_step=0.692, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]Epoch 21: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00732, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000651, Train/loss_recog_step=0.667, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.716, Valid/loss_all_epoch=0.260, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.20it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.20it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.96it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184168, 0.187517, 0.189788, 0.203069
Valid average loss UNet                 (all)                : 0.764543

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.054568, 1.760948, 3.212733
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.358030, 1.653231, 1.915425
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.313484, 1.781337, 1.942670
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.250505, 1.679688, 2.247997
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.202066, 2.094969, 2.391640
Valid average loss all      (Triplet)                 : 0.256007

== Recognize ==
Valid average loss Recognize     : 0.673632
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.262743

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.533771991729736 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.604665756225586 sec. =
Valid knn accuracy bass      : 36.08870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.553316831588745 sec. =
Valid knn accuracy piano     : 42.578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.27909255027771 sec. =
Valid knn accuracy guitar    : 48.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.213285446166992 sec. =
Valid knn accuracy residuals : 64.77272727272727%

Valid knn accuracy average   : 55.41889065089889%

                                                                      [AEpoch 21: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00732, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000651, Train/loss_recog_step=0.667, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=0.658]Epoch 21: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00732, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000651, Train/loss_recog_step=0.667, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.187962, 0.188275, 0.187207, 0.194990
Train average loss UNet                 (all)                : 0.758434

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002093, 1.841097, 3.469840
Train average loss bass     (Triplet, dist_p, dist_n) : 0.017690, 1.444394, 2.240179
Train average loss piano    (Triplet, dist_p, dist_n) : 0.017017, 1.580276, 2.462613
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011879, 1.591815, 2.662464
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011352, 1.694664, 2.761621
Train average loss all      (Triplet)                 : 0.012230

== Recognize ==
Train average loss Recognize     : 0.659046
Train average accuracy drums     : 53.544998 %
Train average accuracy bass      : 53.775002 %
Train average accuracy piano     : 53.810001 %
Train average accuracy guitar    : 54.820000 %
Train average accuracy residuals : 56.725002 %

== Train average loss all : 0.018820

Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00732, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000651, Train/loss_recog_step=0.667, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]          Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00732, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000651, Train/loss_recog_step=0.667, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]Epoch 22:  16%|█▌        | 50/313 [01:06<05:51,  0.75it/s, v_num=0, Train/loss_all_step=0.00732, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000651, Train/loss_recog_step=0.667, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]Epoch 22:  16%|█▌        | 50/313 [01:06<05:51,  0.75it/s, v_num=0, Train/loss_all_step=0.0235, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=0.674, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]   Epoch 22:  32%|███▏      | 100/313 [02:03<04:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0235, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=0.674, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]Epoch 22:  32%|███▏      | 100/313 [02:03<04:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0289, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=0.650, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]Epoch 22:  48%|████▊     | 150/313 [03:00<03:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0289, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=0.650, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]Epoch 22:  48%|████▊     | 150/313 [03:00<03:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0281, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=0.636, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]Epoch 22:  64%|██████▍   | 200/313 [04:00<02:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0281, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=0.636, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]Epoch 22:  64%|██████▍   | 200/313 [04:00<02:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00999, Train/loss_recog_step=0.667, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]Epoch 22:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00999, Train/loss_recog_step=0.667, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]Epoch 22:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.659, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659] Epoch 22:  96%|█████████▌| 300/313 [05:59<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.659, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]Epoch 22:  96%|█████████▌| 300/313 [05:59<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0212, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=0.671, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]Epoch 22: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0212, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=0.671, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]Epoch 22: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0321, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.648, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.604, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.674, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.12it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.85it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184895, 0.188260, 0.190372, 0.205069
Valid average loss UNet                 (all)                : 0.768595

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070445, 1.921642, 3.419566
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.335465, 1.645502, 2.052907
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.326359, 1.873186, 2.171010
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.222956, 1.879588, 2.496334
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.288358, 2.267267, 2.618026
Valid average loss all      (Triplet)                 : 0.259495

== Recognize ==
Valid average loss Recognize     : 0.704257
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.266538

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.360644102096558 sec. =
Valid knn accuracy drums     : 82.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.341379165649414 sec. =
Valid knn accuracy bass      : 29.838709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.815635204315186 sec. =
Valid knn accuracy piano     : 42.96875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.325558185577393 sec. =
Valid knn accuracy guitar    : 47.32142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.262748003005981 sec. =
Valid knn accuracy residuals : 65.68181818181819%

Valid knn accuracy average   : 53.64040215569844%

                                                                      [AEpoch 22: 100%|██████████| 313/313 [07:36<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.0321, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.648, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0188, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=0.659]Epoch 22: 100%|██████████| 313/313 [07:36<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.0321, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.648, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188062, 0.188360, 0.187291, 0.194546
Train average loss UNet                 (all)                : 0.758259

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002729, 1.892883, 3.533251
Train average loss bass     (Triplet, dist_p, dist_n) : 0.017196, 1.509446, 2.342236
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013712, 1.637463, 2.575412
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.013597, 1.666275, 2.794126
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011751, 1.750114, 2.854838
Train average loss all      (Triplet)                 : 0.012092

== Recognize ==
Train average loss Recognize     : 0.663127
Train average accuracy drums     : 52.939999 %
Train average accuracy bass      : 53.724998 %
Train average accuracy piano     : 53.375000 %
Train average accuracy guitar    : 54.840000 %
Train average accuracy residuals : 55.199997 %

== Train average loss all : 0.018723

Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0321, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.648, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]          Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0321, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.648, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]Epoch 23:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.0321, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.648, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]Epoch 23:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00574, Train/loss_recog_step=0.657, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]Epoch 23:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00574, Train/loss_recog_step=0.657, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]Epoch 23:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00571, Train/loss_recog_step=0.681, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]Epoch 23:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00571, Train/loss_recog_step=0.681, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]Epoch 23:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00518, Train/loss_recog_step=0.650, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]Epoch 23:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00518, Train/loss_recog_step=0.650, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]Epoch 23:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.017, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.647, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]  Epoch 23:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.017, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.647, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]Epoch 23:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00451, Train/loss_recog_step=0.666, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]Epoch 23:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00451, Train/loss_recog_step=0.666, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]Epoch 23:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0173, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.659, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663] Epoch 23: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0173, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.659, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]Epoch 23: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.698, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.759, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.24it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.09it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.07it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.63it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184273, 0.187599, 0.189931, 0.203217
Valid average loss UNet                 (all)                : 0.765019

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.055274, 1.790901, 3.384106
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.296829, 1.771738, 2.125953
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.347761, 1.898320, 2.128257
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.233635, 1.832835, 2.381705
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.233935, 2.105734, 2.455087
Valid average loss all      (Triplet)                 : 0.243921

== Recognize ==
Valid average loss Recognize     : 0.690100
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 58.999996 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.250822

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.426638841629028 sec. =
Valid knn accuracy drums     : 81.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.94005298614502 sec. =
Valid knn accuracy bass      : 31.048387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.663846015930176 sec. =
Valid knn accuracy piano     : 43.359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.162132024765015 sec. =
Valid knn accuracy guitar    : 49.330357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.127587080001831 sec. =
Valid knn accuracy residuals : 59.54545454545455%

Valid knn accuracy average   : 53.04801910484327%

                                                                      [AEpoch 23: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.698, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=0.663]Epoch 23: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.698, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188140, 0.188452, 0.187372, 0.195093
Train average loss UNet                 (all)                : 0.759056

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002708, 1.851607, 3.489687
Train average loss bass     (Triplet, dist_p, dist_n) : 0.015643, 1.481793, 2.321331
Train average loss piano    (Triplet, dist_p, dist_n) : 0.015855, 1.625486, 2.542968
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012027, 1.637548, 2.765392
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010957, 1.748502, 2.859187
Train average loss all      (Triplet)                 : 0.011503

== Recognize ==
Train average loss Recognize     : 0.657063
Train average accuracy drums     : 54.055000 %
Train average accuracy bass      : 54.669998 %
Train average accuracy piano     : 53.660000 %
Train average accuracy guitar    : 55.535000 %
Train average accuracy residuals : 56.535000 %

== Train average loss all : 0.018074

Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.698, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]          Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.698, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]Epoch 24:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.698, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]Epoch 24:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.0307, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=0.685, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]Epoch 24:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.0307, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=0.685, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]Epoch 24:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00788, Train/loss_recog_step=0.680, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]Epoch 24:  48%|████▊     | 150/313 [03:06<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00788, Train/loss_recog_step=0.680, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]Epoch 24:  48%|████▊     | 150/313 [03:06<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0276, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.0214, Train/loss_recog_step=0.620, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657] Epoch 24:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.0276, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.0214, Train/loss_recog_step=0.620, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]Epoch 24:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00434, Train/loss_recog_step=0.684, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]Epoch 24:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00434, Train/loss_recog_step=0.684, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]Epoch 24:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.0127, Train/loss_recog_step=0.650, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657] Epoch 24:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.0127, Train/loss_recog_step=0.650, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]Epoch 24:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00451, Train/loss_recog_step=0.676, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]Epoch 24: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00451, Train/loss_recog_step=0.676, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]Epoch 24: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00015, Train/loss_recog_step=0.624, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.59it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.14it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.12it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.88it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.70it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184509, 0.187897, 0.190318, 0.203852
Valid average loss UNet                 (all)                : 0.766575

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.039506, 1.744535, 3.249502
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.274981, 1.753440, 2.067079
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.340227, 1.825388, 2.052437
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.246020, 1.860533, 2.415884
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.262353, 2.201373, 2.497524
Valid average loss all      (Triplet)                 : 0.237724

== Recognize ==
Valid average loss Recognize     : 0.712878
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.244853

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.31458592414856 sec. =
Valid knn accuracy drums     : 79.13043478260869%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.214176654815674 sec. =
Valid knn accuracy bass      : 30.64516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.064570426940918 sec. =
Valid knn accuracy piano     : 43.1640625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.526559114456177 sec. =
Valid knn accuracy guitar    : 52.23214285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.30446982383728 sec. =
Valid knn accuracy residuals : 60.0%

Valid knn accuracy average   : 53.034360286014824%

                                                                      [AEpoch 24: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00015, Train/loss_recog_step=0.624, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0181, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.657]Epoch 24: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00015, Train/loss_recog_step=0.624, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188396, 0.188706, 0.187633, 0.195161
Train average loss UNet                 (all)                : 0.759895

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001937, 1.886583, 3.569689
Train average loss bass     (Triplet, dist_p, dist_n) : 0.016929, 1.565570, 2.447764
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013854, 1.687056, 2.645879
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009557, 1.681039, 2.839104
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008980, 1.792435, 2.937437
Train average loss all      (Triplet)                 : 0.010350

== Recognize ==
Train average loss Recognize     : 0.660334
Train average accuracy drums     : 54.650002 %
Train average accuracy bass      : 54.439999 %
Train average accuracy piano     : 53.084999 %
Train average accuracy guitar    : 54.445000 %
Train average accuracy residuals : 56.355000 %

== Train average loss all : 0.016953

Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00015, Train/loss_recog_step=0.624, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660]          Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00015, Train/loss_recog_step=0.624, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660]Epoch 25:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00015, Train/loss_recog_step=0.624, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660]Epoch 25:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00563, Train/loss_recog_step=0.661, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660] Epoch 25:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00563, Train/loss_recog_step=0.661, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660]Epoch 25:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.682, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660] Epoch 25:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.682, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660]Epoch 25:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0221, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0156, Train/loss_recog_step=0.654, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660]Epoch 25:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0221, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0156, Train/loss_recog_step=0.654, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660]Epoch 25:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00817, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00119, Train/loss_recog_step=0.698, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660]Epoch 25:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00817, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00119, Train/loss_recog_step=0.698, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660]Epoch 25:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.0143, Train/loss_recog_step=0.626, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660]  Epoch 25:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.0143, Train/loss_recog_step=0.626, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660]Epoch 25:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.661, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660]Epoch 25: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.661, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660]Epoch 25: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=0.696, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.530, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.30it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.07it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.51it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.27it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184188, 0.187545, 0.189732, 0.202833
Valid average loss UNet                 (all)                : 0.764298

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.076901, 1.920843, 3.481559
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.363380, 1.852962, 2.171228
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.389261, 1.991552, 2.141286
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.245255, 1.939788, 2.531616
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.194635, 2.263130, 2.771304
Valid average loss all      (Triplet)                 : 0.269452

== Recognize ==
Valid average loss Recognize     : 0.687716
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.276329

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.160557270050049 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.702285289764404 sec. =
Valid knn accuracy bass      : 23.991935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.677418947219849 sec. =
Valid knn accuracy piano     : 46.09375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.219394445419312 sec. =
Valid knn accuracy guitar    : 53.79464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.536490201950073 sec. =
Valid knn accuracy residuals : 69.0909090909091%

Valid knn accuracy average   : 55.37685618203676%

                                                                      [AEpoch 25: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=0.696, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=0.660]Epoch 25: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=0.696, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188221, 0.188519, 0.187450, 0.194012
Train average loss UNet                 (all)                : 0.758201

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002483, 1.956830, 3.650682
Train average loss bass     (Triplet, dist_p, dist_n) : 0.013710, 1.588712, 2.508154
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013363, 1.725584, 2.722354
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010764, 1.776184, 2.993763
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007229, 1.834671, 3.031920
Train average loss all      (Triplet)                 : 0.009684

== Recognize ==
Train average loss Recognize     : 0.664930
Train average accuracy drums     : 53.584999 %
Train average accuracy bass      : 53.350002 %
Train average accuracy piano     : 52.885002 %
Train average accuracy guitar    : 54.385002 %
Train average accuracy residuals : 55.669998 %

== Train average loss all : 0.016333

Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=0.696, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]          Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=0.696, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]Epoch 26:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=0.696, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]Epoch 26:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.0294, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0227, Train/loss_recog_step=0.665, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]Epoch 26:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.0294, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0227, Train/loss_recog_step=0.665, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]Epoch 26:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.636, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]Epoch 26:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.636, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]Epoch 26:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0297, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0232, Train/loss_recog_step=0.647, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]Epoch 26:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0297, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0232, Train/loss_recog_step=0.647, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]Epoch 26:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00804, Train/loss_recog_step=0.682, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]Epoch 26:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00804, Train/loss_recog_step=0.682, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]Epoch 26:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.00579, Train/loss_recog_step=0.646, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]Epoch 26:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.00579, Train/loss_recog_step=0.646, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]Epoch 26:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00754, Train/loss_recog_step=0.697, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]Epoch 26: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00754, Train/loss_recog_step=0.697, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]Epoch 26: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.274, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.96it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.51it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184713, 0.188059, 0.190490, 0.189808
Valid average loss UNet                 (all)                : 0.753071

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.046130, 1.823738, 3.486978
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.354400, 1.848390, 2.161019
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.358997, 2.037701, 2.108991
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.274005, 1.927120, 2.534482
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.199689, 2.265448, 2.759365
Valid average loss all      (Triplet)                 : 0.261316

== Recognize ==
Valid average loss Recognize     : 0.710863
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 44.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.268424

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.299572706222534 sec. =
Valid knn accuracy drums     : 81.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.605565547943115 sec. =
Valid knn accuracy bass      : 22.379032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.660330295562744 sec. =
Valid knn accuracy piano     : 45.8984375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.493868827819824 sec. =
Valid knn accuracy guitar    : 47.32142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.63591456413269 sec. =
Valid knn accuracy residuals : 64.54545454545455%

Valid knn accuracy average   : 52.333218401076486%

                                                                      [AEpoch 26: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0163, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00968, Train/loss_recog_epoch=0.665]Epoch 26: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188173, 0.188470, 0.187401, 0.195060
Train average loss UNet                 (all)                : 0.759104

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002155, 1.955947, 3.737400
Train average loss bass     (Triplet, dist_p, dist_n) : 0.016374, 1.622373, 2.548061
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010559, 1.741530, 2.785772
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010726, 1.760934, 2.972975
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010630, 1.899456, 3.093981
Train average loss all      (Triplet)                 : 0.010243

== Recognize ==
Train average loss Recognize     : 0.667692
Train average accuracy drums     : 52.780003 %
Train average accuracy bass      : 53.474998 %
Train average accuracy piano     : 52.845001 %
Train average accuracy guitar    : 54.160000 %
Train average accuracy residuals : 54.695000 %

== Train average loss all : 0.016920

Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668]          Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668]Epoch 27:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668]Epoch 27:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.00686, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.686, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668]Epoch 27:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.00686, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.686, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668]Epoch 27:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00418, Train/loss_recog_step=0.667, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668]Epoch 27:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00418, Train/loss_recog_step=0.667, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668]Epoch 27:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.670, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668] Epoch 27:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.670, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668]Epoch 27:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=0.674, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668]Epoch 27:  80%|███████▉  | 250/313 [05:06<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=0.674, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668]Epoch 27:  80%|███████▉  | 250/313 [05:06<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0067, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.000199, Train/loss_recog_step=0.650, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668]Epoch 27:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0067, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.000199, Train/loss_recog_step=0.650, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668]Epoch 27:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0152, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00858, Train/loss_recog_step=0.662, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668] Epoch 27: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0152, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00858, Train/loss_recog_step=0.662, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668]Epoch 27: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.22it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.90it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184363, 0.187584, 0.190217, 0.202189
Valid average loss UNet                 (all)                : 0.764354

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.056534, 1.785344, 3.390009
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.364350, 1.799858, 2.010789
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.321262, 1.863560, 2.257178
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.252660, 1.816581, 2.513426
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.235438, 2.111072, 2.651934
Valid average loss all      (Triplet)                 : 0.260959

== Recognize ==
Valid average loss Recognize     : 0.707920
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.268038

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.357972621917725 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.370967864990234 sec. =
Valid knn accuracy bass      : 30.241935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.950251579284668 sec. =
Valid knn accuracy piano     : 35.546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.616106510162354 sec. =
Valid knn accuracy guitar    : 45.75892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.184704065322876 sec. =
Valid knn accuracy residuals : 70.9090909090909%

Valid knn accuracy average   : 53.708757297225915%

                                                                      [AEpoch 27: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0169, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.668]Epoch 27: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188257, 0.188576, 0.187492, 0.194986
Train average loss UNet                 (all)                : 0.759311

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001935, 1.936316, 3.756517
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011999, 1.612291, 2.553125
Train average loss piano    (Triplet, dist_p, dist_n) : 0.015078, 1.765686, 2.779239
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010884, 1.756901, 2.998646
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006427, 1.829416, 3.017640
Train average loss all      (Triplet)                 : 0.009213

== Recognize ==
Train average loss Recognize     : 0.666767
Train average accuracy drums     : 53.875000 %
Train average accuracy bass      : 52.660000 %
Train average accuracy piano     : 51.775002 %
Train average accuracy guitar    : 54.290001 %
Train average accuracy residuals : 55.720001 %

== Train average loss all : 0.015881

Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]          Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]Epoch 28:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]Epoch 28:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.643, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]Epoch 28:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.643, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]Epoch 28:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00937, Train/loss_recog_step=0.676, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]Epoch 28:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00937, Train/loss_recog_step=0.676, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]Epoch 28:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.651, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667] Epoch 28:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.651, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]Epoch 28:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00791, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0012, Train/loss_recog_step=0.671, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]Epoch 28:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00791, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0012, Train/loss_recog_step=0.671, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]Epoch 28:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.729, Train/loss_triplet_all_step=0.00683, Train/loss_recog_step=0.676, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]Epoch 28:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.729, Train/loss_triplet_all_step=0.00683, Train/loss_recog_step=0.676, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]Epoch 28:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0201, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.660, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667] Epoch 28: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0201, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.660, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]Epoch 28: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0248, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.674, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.726, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.14it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.14it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.37it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.21it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183929, 0.187308, 0.189544, 0.195043
Valid average loss UNet                 (all)                : 0.755824

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.055534, 1.765725, 3.401311
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.360654, 1.868418, 2.118056
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.331694, 1.922978, 2.189292
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.271619, 1.911343, 2.516653
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.226275, 2.243471, 2.763810
Valid average loss all      (Triplet)                 : 0.263629

== Recognize ==
Valid average loss Recognize     : 0.698951
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.270618

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.431174755096436 sec. =
Valid knn accuracy drums     : 77.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.462401628494263 sec. =
Valid knn accuracy bass      : 37.096774193548384%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.229425191879272 sec. =
Valid knn accuracy piano     : 40.234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.438998937606812 sec. =
Valid knn accuracy guitar    : 50.22321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.498383045196533 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 54.532611826287315%

                                                                      [AEpoch 28: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0248, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.674, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00921, Train/loss_recog_epoch=0.667]Epoch 28: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0248, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.674, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188165, 0.188467, 0.187391, 0.194803
Train average loss UNet                 (all)                : 0.758826

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001750, 1.968361, 3.710543
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012284, 1.654500, 2.624926
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011117, 1.820134, 2.892694
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008469, 1.799494, 3.065971
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007452, 1.932580, 3.191183
Train average loss all      (Triplet)                 : 0.008366

== Recognize ==
Train average loss Recognize     : 0.668753
Train average accuracy drums     : 53.250004 %
Train average accuracy bass      : 52.799999 %
Train average accuracy piano     : 52.485001 %
Train average accuracy guitar    : 54.299999 %
Train average accuracy residuals : 54.825001 %

== Train average loss all : 0.015053

Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0248, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.674, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]          Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0248, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.674, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]Epoch 29:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.0248, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.674, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]Epoch 29:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.0083, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00176, Train/loss_recog_step=0.654, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]Epoch 29:  32%|███▏      | 100/313 [02:05<04:27,  0.80it/s, v_num=0, Train/loss_all_step=0.0083, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00176, Train/loss_recog_step=0.654, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]Epoch 29:  32%|███▏      | 100/313 [02:05<04:27,  0.80it/s, v_num=0, Train/loss_all_step=0.00898, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.688, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]Epoch 29:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.00898, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.688, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]Epoch 29:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.0198, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.657, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]  Epoch 29:  64%|██████▍   | 200/313 [04:00<02:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0198, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.657, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]Epoch 29:  64%|██████▍   | 200/313 [04:00<02:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00588, Train/loss_recog_step=0.673, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]Epoch 29:  80%|███████▉  | 250/313 [04:58<01:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00588, Train/loss_recog_step=0.673, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]Epoch 29:  80%|███████▉  | 250/313 [04:58<01:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.734, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.659, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]  Epoch 29:  96%|█████████▌| 300/313 [05:59<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.734, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.659, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]Epoch 29:  96%|█████████▌| 300/313 [05:59<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.641, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]Epoch 29: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.641, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]Epoch 29: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000563, Train/loss_recog_step=0.686, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.661, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.45it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.71it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.14it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.31it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.36it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184509, 0.187801, 0.190565, 0.203908
Valid average loss UNet                 (all)                : 0.766782

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.076055, 1.890720, 3.238113
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.366549, 1.862632, 2.180584
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.322969, 2.006558, 2.264236
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.291072, 1.992241, 2.684308
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.249986, 2.357148, 2.725072
Valid average loss all      (Triplet)                 : 0.276686

== Recognize ==
Valid average loss Recognize     : 0.736539
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.284051

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.394114017486572 sec. =
Valid knn accuracy drums     : 81.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.847650051116943 sec. =
Valid knn accuracy bass      : 27.016129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.512065649032593 sec. =
Valid knn accuracy piano     : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.393739461898804 sec. =
Valid knn accuracy guitar    : 50.66964285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.265368461608887 sec. =
Valid knn accuracy residuals : 72.95454545454545%

Valid knn accuracy average   : 53.932411294876225%

                                                                      [AEpoch 29: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000563, Train/loss_recog_step=0.686, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00837, Train/loss_recog_epoch=0.669]Epoch 29: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000563, Train/loss_recog_step=0.686, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188160, 0.188462, 0.187392, 0.194660
Train average loss UNet                 (all)                : 0.758674

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001694, 1.936232, 3.724540
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011962, 1.646299, 2.629873
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010509, 1.786827, 2.848692
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007597, 1.781662, 3.032138
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005812, 1.873016, 3.123419
Train average loss all      (Triplet)                 : 0.007507

== Recognize ==
Train average loss Recognize     : 0.664362
Train average accuracy drums     : 53.710003 %
Train average accuracy bass      : 53.245003 %
Train average accuracy piano     : 53.680004 %
Train average accuracy guitar    : 55.169998 %
Train average accuracy residuals : 55.734997 %

== Train average loss all : 0.014151

Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000563, Train/loss_recog_step=0.686, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]          Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000563, Train/loss_recog_step=0.686, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]Epoch 30:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000563, Train/loss_recog_step=0.686, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]Epoch 30:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00541, Train/loss_recog_step=0.682, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]  Epoch 30:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00541, Train/loss_recog_step=0.682, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]Epoch 30:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=0.670, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]  Epoch 30:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=0.670, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]Epoch 30:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=0.655, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]Epoch 30:  64%|██████▍   | 200/313 [04:02<02:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=0.655, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]Epoch 30:  64%|██████▍   | 200/313 [04:02<02:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00574, Train/loss_recog_step=0.687, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]Epoch 30:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00574, Train/loss_recog_step=0.687, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]Epoch 30:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00635, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=8.76e-5, Train/loss_recog_step=0.626, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]Epoch 30:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00635, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=8.76e-5, Train/loss_recog_step=0.626, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]Epoch 30:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00858, Train/loss_recog_step=0.683, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664] Epoch 30: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00858, Train/loss_recog_step=0.683, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]Epoch 30: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.737, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.47it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.22it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.88it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.99it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.59it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183814, 0.187106, 0.189540, 0.208445
Valid average loss UNet                 (all)                : 0.768905

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.055951, 1.880120, 3.402508
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.317669, 1.882138, 2.307336
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.336895, 2.140373, 2.328069
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.309123, 2.047644, 2.742111
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.186694, 2.245408, 2.783951
Valid average loss all      (Triplet)                 : 0.257736

== Recognize ==
Valid average loss Recognize     : 0.686447
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 57.000000 %

== Valid average loss all : 0.264601

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.353400707244873 sec. =
Valid knn accuracy drums     : 83.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.997169971466064 sec. =
Valid knn accuracy bass      : 25.403225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.048475503921509 sec. =
Valid knn accuracy piano     : 49.21875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.304680824279785 sec. =
Valid knn accuracy guitar    : 46.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.195952892303467 sec. =
Valid knn accuracy residuals : 71.81818181818181%

Valid knn accuracy average   : 55.31520543797017%

                                                                      [AEpoch 30: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0142, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00751, Train/loss_recog_epoch=0.664]Epoch 30: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188140, 0.188446, 0.187365, 0.194723
Train average loss UNet                 (all)                : 0.758673

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001355, 1.930588, 3.712834
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011497, 1.661751, 2.657303
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013016, 1.792104, 2.852806
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010508, 1.820175, 3.075033
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008709, 1.922480, 3.173388
Train average loss all      (Triplet)                 : 0.009058

== Recognize ==
Train average loss Recognize     : 0.667961
Train average accuracy drums     : 54.084999 %
Train average accuracy bass      : 53.044998 %
Train average accuracy piano     : 52.964996 %
Train average accuracy guitar    : 54.075005 %
Train average accuracy residuals : 54.299999 %

== Train average loss all : 0.015738

Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]          Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]Epoch 31:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]Epoch 31:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.0194, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.701, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]Epoch 31:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.0194, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.701, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]Epoch 31:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.00829, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.703, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]Epoch 31:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00829, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.703, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]Epoch 31:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0139, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00707, Train/loss_recog_step=0.681, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668] Epoch 31:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.0139, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00707, Train/loss_recog_step=0.681, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]Epoch 31:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00471, Train/loss_recog_step=0.681, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]Epoch 31:  80%|███████▉  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00471, Train/loss_recog_step=0.681, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]Epoch 31:  80%|███████▉  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.736, Train/loss_triplet_all_step=0.00505, Train/loss_recog_step=0.638, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]Epoch 31:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.736, Train/loss_triplet_all_step=0.00505, Train/loss_recog_step=0.638, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]Epoch 31:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00856, Train/loss_recog_step=0.679, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]Epoch 31: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00856, Train/loss_recog_step=0.679, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]Epoch 31: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00943, Train/loss_recog_step=0.703, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.258, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.29it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.09it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.08it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.03it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:03<00:00,  2.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184258, 0.187498, 0.190462, 0.193437
Valid average loss UNet                 (all)                : 0.755655

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.057953, 1.865339, 3.393535
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.316635, 1.915408, 2.264412
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.325569, 1.974082, 2.194162
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.268360, 2.006739, 2.749851
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.195043, 2.205667, 2.758788
Valid average loss all      (Triplet)                 : 0.240442

== Recognize ==
Valid average loss Recognize     : 0.717355
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.247616

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.402222633361816 sec. =
Valid knn accuracy drums     : 77.39130434782608%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.375648021697998 sec. =
Valid knn accuracy bass      : 20.766129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.71418023109436 sec. =
Valid knn accuracy piano     : 41.9921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.386607646942139 sec. =
Valid knn accuracy guitar    : 48.660714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.24308180809021 sec. =
Valid knn accuracy residuals : 63.40909090909091%

Valid knn accuracy average   : 50.44388521497787%

                                                                      [AEpoch 31: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00943, Train/loss_recog_step=0.703, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00906, Train/loss_recog_epoch=0.668]Epoch 31: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00943, Train/loss_recog_step=0.703, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188194, 0.188494, 0.187394, 0.194945
Train average loss UNet                 (all)                : 0.759028

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001518, 1.943950, 3.737753
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011788, 1.694405, 2.699840
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011180, 1.837544, 2.948072
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008747, 1.843376, 3.132972
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007292, 1.959999, 3.232105
Train average loss all      (Triplet)                 : 0.008318

== Recognize ==
Train average loss Recognize     : 0.666699
Train average accuracy drums     : 54.245003 %
Train average accuracy bass      : 53.875000 %
Train average accuracy piano     : 52.474998 %
Train average accuracy guitar    : 54.355003 %
Train average accuracy residuals : 54.739998 %

== Train average loss all : 0.014985

Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00943, Train/loss_recog_step=0.703, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]          Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00943, Train/loss_recog_step=0.703, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]Epoch 32:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00943, Train/loss_recog_step=0.703, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]Epoch 32:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00915, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0023, Train/loss_recog_step=0.685, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]Epoch 32:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00915, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0023, Train/loss_recog_step=0.685, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]Epoch 32:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0242, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=0.688, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667] Epoch 32:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0242, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=0.688, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]Epoch 32:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.663, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]Epoch 32:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.663, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]Epoch 32:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0173, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.668, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]Epoch 32:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0173, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.668, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]Epoch 32:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00934, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00314, Train/loss_recog_step=0.620, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]Epoch 32:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00934, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00314, Train/loss_recog_step=0.620, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]Epoch 32:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0251, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.698, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]  Epoch 32: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0251, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.698, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]Epoch 32: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.708, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.240, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.504, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.43it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.81it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.64it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.19it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.95it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183770, 0.187116, 0.189334, 0.195913
Valid average loss UNet                 (all)                : 0.756134

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.048764, 1.874853, 3.420136
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.329757, 2.016919, 2.393330
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.331777, 2.143766, 2.390967
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.243961, 2.199729, 2.923065
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.211156, 2.326252, 2.695459
Valid average loss all      (Triplet)                 : 0.241176

== Recognize ==
Valid average loss Recognize     : 0.689622
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 56.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.248072

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.002239227294922 sec. =
Valid knn accuracy drums     : 77.39130434782608%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.390115976333618 sec. =
Valid knn accuracy bass      : 29.233870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.774826049804688 sec. =
Valid knn accuracy piano     : 35.9375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.060945510864258 sec. =
Valid knn accuracy guitar    : 49.55357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.761627435684204 sec. =
Valid knn accuracy residuals : 68.63636363636364%

Valid knn accuracy average   : 52.15052207610063%

                                                                      [AEpoch 32: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=0.667]Epoch 32: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188154, 0.188455, 0.187382, 0.194926
Train average loss UNet                 (all)                : 0.758917

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001467, 1.948307, 3.670909
Train average loss bass     (Triplet, dist_p, dist_n) : 0.013847, 1.709974, 2.700312
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011200, 1.832138, 2.925436
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009963, 1.849167, 3.128248
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008791, 1.955163, 3.208837
Train average loss all      (Triplet)                 : 0.009158

== Recognize ==
Train average loss Recognize     : 0.669664
Train average accuracy drums     : 53.930004 %
Train average accuracy bass      : 52.745003 %
Train average accuracy piano     : 53.380001 %
Train average accuracy guitar    : 54.299999 %
Train average accuracy residuals : 54.535000 %

== Train average loss all : 0.015855

Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]          Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]Epoch 33:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]Epoch 33:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=3.49e-6, Train/loss_recog_step=0.704, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]Epoch 33:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=3.49e-6, Train/loss_recog_step=0.704, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]Epoch 33:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.020, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=0.688, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]   Epoch 33:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.020, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=0.688, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]Epoch 33:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00736, Train/loss_recog_step=0.684, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]Epoch 33:  64%|██████▍   | 200/313 [04:04<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00736, Train/loss_recog_step=0.684, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]Epoch 33:  64%|██████▍   | 200/313 [04:04<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00676, Train/loss_recog_step=0.681, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]Epoch 33:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00676, Train/loss_recog_step=0.681, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]Epoch 33:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.642, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]Epoch 33:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.642, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]Epoch 33:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.00645, Train/loss_recog_step=0.685, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]Epoch 33: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.00645, Train/loss_recog_step=0.685, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]Epoch 33: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.679, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.580, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.10it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.63it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183046, 0.186369, 0.188625, 0.187285
Valid average loss UNet                 (all)                : 0.745325

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.038356, 1.826963, 3.419456
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.451914, 1.981819, 2.234880
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.418600, 2.181298, 2.252643
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.304188, 2.082952, 2.849572
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.219356, 2.220004, 2.795808
Valid average loss all      (Triplet)                 : 0.310472

== Recognize ==
Valid average loss Recognize     : 0.695891
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 57.000000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 57.000000 %
Valid average accuracy residuals : 43.500000 %

== Valid average loss all : 0.317431

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.660537004470825 sec. =
Valid knn accuracy drums     : 78.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.265133142471313 sec. =
Valid knn accuracy bass      : 30.241935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.406540155410767 sec. =
Valid knn accuracy piano     : 40.234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.716531753540039 sec. =
Valid knn accuracy guitar    : 48.214285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.365066528320312 sec. =
Valid knn accuracy residuals : 66.5909090909091%

Valid knn accuracy average   : 52.708474970856635%

                                                                      [AEpoch 33: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.679, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00916, Train/loss_recog_epoch=0.670]Epoch 33: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.679, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188182, 0.188494, 0.187411, 0.194741
Train average loss UNet                 (all)                : 0.758828

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001421, 1.966133, 3.777880
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011678, 1.751148, 2.806062
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013413, 1.887577, 2.990205
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007913, 1.873742, 3.200846
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009089, 1.994564, 3.275984
Train average loss all      (Triplet)                 : 0.008931

== Recognize ==
Train average loss Recognize     : 0.668147
Train average accuracy drums     : 53.990002 %
Train average accuracy bass      : 53.320004 %
Train average accuracy piano     : 53.364998 %
Train average accuracy guitar    : 54.674999 %
Train average accuracy residuals : 54.799999 %

== Train average loss all : 0.015613

Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.679, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]          Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.679, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]Epoch 34:  16%|█▌        | 50/313 [01:07<05:52,  0.75it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.679, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]Epoch 34:  16%|█▌        | 50/313 [01:07<05:52,  0.75it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00807, Train/loss_recog_step=0.639, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]Epoch 34:  32%|███▏      | 100/313 [02:05<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00807, Train/loss_recog_step=0.639, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]Epoch 34:  32%|███▏      | 100/313 [02:05<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.00773, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000965, Train/loss_recog_step=0.677, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]Epoch 34:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.00773, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000965, Train/loss_recog_step=0.677, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]Epoch 34:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0185, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.684, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]   Epoch 34:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0185, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.684, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]Epoch 34:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00439, Train/loss_recog_step=0.678, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]Epoch 34:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00439, Train/loss_recog_step=0.678, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]Epoch 34:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=0.643, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668] Epoch 34:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=0.643, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]Epoch 34:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.024, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=0.658, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668] Epoch 34: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.024, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=0.658, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]Epoch 34: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.048, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0408, Train/loss_recog_step=0.713, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.688, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.35it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.50it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.39it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.89it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182939, 0.186332, 0.188340, 0.202806
Valid average loss UNet                 (all)                : 0.760418

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.049066, 1.867855, 3.432405
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.394504, 1.990451, 2.399178
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.312490, 2.078591, 2.358662
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.281019, 2.027824, 2.690014
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.268573, 2.422543, 2.964153
Valid average loss all      (Triplet)                 : 0.284209

== Recognize ==
Valid average loss Recognize     : 0.683589
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.291045

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.060017108917236 sec. =
Valid knn accuracy drums     : 82.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.953898668289185 sec. =
Valid knn accuracy bass      : 22.58064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.554874658584595 sec. =
Valid knn accuracy piano     : 36.71875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.57355546951294 sec. =
Valid knn accuracy guitar    : 48.214285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.194195985794067 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 51.24977174823774%

                                                                      [AEpoch 34: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.048, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0408, Train/loss_recog_step=0.713, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0156, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00893, Train/loss_recog_epoch=0.668]Epoch 34: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.048, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0408, Train/loss_recog_step=0.713, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188450, 0.188737, 0.187650, 0.194125
Train average loss UNet                 (all)                : 0.758961

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000830, 1.908600, 3.715674
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009802, 1.697687, 2.747968
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007768, 1.815830, 2.935899
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006931, 1.828847, 3.109968
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008557, 1.992011, 3.301465
Train average loss all      (Triplet)                 : 0.006619

== Recognize ==
Train average loss Recognize     : 0.664865
Train average accuracy drums     : 54.869999 %
Train average accuracy bass      : 53.425003 %
Train average accuracy piano     : 53.100002 %
Train average accuracy guitar    : 53.960003 %
Train average accuracy residuals : 55.690002 %

== Train average loss all : 0.013268

Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.048, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0408, Train/loss_recog_step=0.713, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]          Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.048, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0408, Train/loss_recog_step=0.713, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]Epoch 35:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.048, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0408, Train/loss_recog_step=0.713, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]Epoch 35:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]Epoch 35:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]Epoch 35:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00924, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00281, Train/loss_recog_step=0.643, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]Epoch 35:  48%|████▊     | 150/313 [03:08<03:25,  0.80it/s, v_num=0, Train/loss_all_step=0.00924, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00281, Train/loss_recog_step=0.643, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]Epoch 35:  48%|████▊     | 150/313 [03:08<03:25,  0.80it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.625, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]  Epoch 35:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.625, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]Epoch 35:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00335, Train/loss_recog_step=0.667, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]Epoch 35:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00335, Train/loss_recog_step=0.667, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]Epoch 35:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00786, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.00141, Train/loss_recog_step=0.645, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]Epoch 35:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00786, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.00141, Train/loss_recog_step=0.645, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]Epoch 35:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00738, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.000766, Train/loss_recog_step=0.661, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]Epoch 35: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00738, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.000766, Train/loss_recog_step=0.661, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]Epoch 35: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0536, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0466, Train/loss_recog_step=0.704, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.16it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.88it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.68it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182623, 0.185949, 0.188016, 0.187016
Valid average loss UNet                 (all)                : 0.743604

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.063869, 1.929192, 3.611907
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.385402, 2.030046, 2.509484
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.247126, 2.119501, 2.430136
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.281475, 2.170902, 2.867120
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.223640, 2.474664, 2.993952
Valid average loss all      (Triplet)                 : 0.266986

== Recognize ==
Valid average loss Recognize     : 0.713026
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.274116

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.317483901977539 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.303659915924072 sec. =
Valid knn accuracy bass      : 24.193548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.778043985366821 sec. =
Valid knn accuracy piano     : 46.09375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.351656436920166 sec. =
Valid knn accuracy guitar    : 48.88392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.375619649887085 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 53.62871179486712%

                                                                      [AEpoch 35: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0536, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0466, Train/loss_recog_step=0.704, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00662, Train/loss_recog_epoch=0.665]Epoch 35: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0536, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0466, Train/loss_recog_step=0.704, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188323, 0.188641, 0.187552, 0.194250
Train average loss UNet                 (all)                : 0.758765

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001286, 1.869102, 3.653048
Train average loss bass     (Triplet, dist_p, dist_n) : 0.013446, 1.723775, 2.760005
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007006, 1.801718, 2.910374
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006652, 1.819385, 3.141610
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007195, 1.971057, 3.280141
Train average loss all      (Triplet)                 : 0.007027

== Recognize ==
Train average loss Recognize     : 0.663228
Train average accuracy drums     : 54.985001 %
Train average accuracy bass      : 53.154999 %
Train average accuracy piano     : 53.665001 %
Train average accuracy guitar    : 54.529999 %
Train average accuracy residuals : 55.024998 %

== Train average loss all : 0.013659

Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0536, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0466, Train/loss_recog_step=0.704, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]          Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0536, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0466, Train/loss_recog_step=0.704, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]Epoch 36:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.0536, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0466, Train/loss_recog_step=0.704, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]Epoch 36:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.685, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]Epoch 36:  32%|███▏      | 100/313 [02:07<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.685, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]Epoch 36:  32%|███▏      | 100/313 [02:07<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00517, Train/loss_recog_step=0.676, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]Epoch 36:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00517, Train/loss_recog_step=0.676, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]Epoch 36:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00692, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000343, Train/loss_recog_step=0.657, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]Epoch 36:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00692, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000343, Train/loss_recog_step=0.657, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]Epoch 36:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00997, Train/loss_recog_step=0.663, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]  Epoch 36:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00997, Train/loss_recog_step=0.663, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]Epoch 36:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00852, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.00218, Train/loss_recog_step=0.634, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]Epoch 36:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00852, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.00218, Train/loss_recog_step=0.634, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]Epoch 36:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00394, Train/loss_recog_step=0.698, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663] Epoch 36: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00394, Train/loss_recog_step=0.698, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]Epoch 36: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.733, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.45it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.70it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.09it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182368, 0.185773, 0.187581, 0.200138
Valid average loss UNet                 (all)                : 0.755861

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.047645, 1.894337, 3.449168
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.366136, 2.085780, 2.618022
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.341774, 2.105829, 2.563541
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.310093, 2.171544, 2.887686
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.281552, 2.528601, 2.983401
Valid average loss all      (Triplet)                 : 0.290995

== Recognize ==
Valid average loss Recognize     : 0.708866
Valid average accuracy drums     : 56.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.298084

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.629915237426758 sec. =
Valid knn accuracy drums     : 81.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.4623544216156 sec. =
Valid knn accuracy bass      : 20.56451612903226%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.358365058898926 sec. =
Valid knn accuracy piano     : 45.5078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.400734424591064 sec. =
Valid knn accuracy guitar    : 47.32142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.189756155014038 sec. =
Valid knn accuracy residuals : 65.68181818181819%

Valid knn accuracy average   : 52.16294116341233%

                                                                      [AEpoch 36: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00703, Train/loss_recog_epoch=0.663]Epoch 36: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188223, 0.188526, 0.187428, 0.195162
Train average loss UNet                 (all)                : 0.759339

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001124, 1.951020, 3.820287
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009844, 1.780974, 2.884086
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009450, 1.885419, 3.018125
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008160, 1.919678, 3.275548
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006501, 2.084819, 3.482199
Train average loss all      (Triplet)                 : 0.007091

== Recognize ==
Train average loss Recognize     : 0.667925
Train average accuracy drums     : 54.715000 %
Train average accuracy bass      : 53.154999 %
Train average accuracy piano     : 53.474998 %
Train average accuracy guitar    : 54.119999 %
Train average accuracy residuals : 54.245003 %

== Train average loss all : 0.013770

Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]          Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]Epoch 37:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]Epoch 37:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]Epoch 37:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]Epoch 37:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.689, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]Epoch 37:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.689, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]Epoch 37:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000152, Train/loss_recog_step=0.663, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]Epoch 37:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000152, Train/loss_recog_step=0.663, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]Epoch 37:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00403, Train/loss_recog_step=0.711, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]  Epoch 37:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00403, Train/loss_recog_step=0.711, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]Epoch 37:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.647, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668] Epoch 37:  96%|█████████▌| 300/313 [06:08<00:15,  0.81it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.647, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]Epoch 37:  96%|█████████▌| 300/313 [06:08<00:15,  0.81it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0128, Train/loss_recog_step=0.678, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]Epoch 37: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0128, Train/loss_recog_step=0.678, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]Epoch 37: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.09it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.49it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.55it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182581, 0.185991, 0.187794, 0.203042
Valid average loss UNet                 (all)                : 0.759408

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.049426, 1.893706, 3.350908
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.416476, 2.132052, 2.432277
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.272633, 2.131565, 2.621901
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.224049, 2.053358, 2.845984
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.314465, 2.360853, 2.835598
Valid average loss all      (Triplet)                 : 0.277465

== Recognize ==
Valid average loss Recognize     : 0.666633
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.284131

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.42646837234497 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.583143949508667 sec. =
Valid knn accuracy bass      : 23.991935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.365858554840088 sec. =
Valid knn accuracy piano     : 43.9453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.472556114196777 sec. =
Valid knn accuracy guitar    : 39.955357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.558449268341064 sec. =
Valid knn accuracy residuals : 64.0909090909091%

Valid knn accuracy average   : 50.918441973962224%

                                                                      [AEpoch 37: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0138, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=0.668]Epoch 37: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188268, 0.188566, 0.187478, 0.195090
Train average loss UNet                 (all)                : 0.759402

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001759, 1.940580, 3.731658
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009860, 1.824342, 2.953659
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008387, 1.915881, 3.107822
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006864, 1.924100, 3.284442
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007385, 2.059475, 3.446622
Train average loss all      (Triplet)                 : 0.006938

== Recognize ==
Train average loss Recognize     : 0.671554
Train average accuracy drums     : 55.075001 %
Train average accuracy bass      : 52.119999 %
Train average accuracy piano     : 52.609997 %
Train average accuracy guitar    : 53.834999 %
Train average accuracy residuals : 54.509998 %

== Train average loss all : 0.013653

Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]          Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]Epoch 38:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]Epoch 38:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00517, Train/loss_recog_step=0.696, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]Epoch 38:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00517, Train/loss_recog_step=0.696, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]Epoch 38:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00827, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.683, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]Epoch 38:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00827, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.683, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]Epoch 38:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00668, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=1.18e-6, Train/loss_recog_step=0.668, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]Epoch 38:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00668, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=1.18e-6, Train/loss_recog_step=0.668, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]Epoch 38:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00761, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000651, Train/loss_recog_step=0.695, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]Epoch 38:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00761, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000651, Train/loss_recog_step=0.695, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]Epoch 38:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00744, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00117, Train/loss_recog_step=0.627, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672] Epoch 38:  96%|█████████▌| 300/313 [05:59<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00744, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00117, Train/loss_recog_step=0.627, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]Epoch 38:  96%|█████████▌| 300/313 [05:59<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0158, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.0091, Train/loss_recog_step=0.667, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]  Epoch 38: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0158, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.0091, Train/loss_recog_step=0.667, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]Epoch 38: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=0.678, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=0.547, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.667, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.39it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.21it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.13it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:04<00:00,  1.97it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:03<00:00,  2.28it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183146, 0.186561, 0.188433, 0.199371
Valid average loss UNet                 (all)                : 0.757511

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.030972, 1.893732, 3.252150
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.327352, 2.128586, 2.623714
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.329534, 2.128925, 2.644691
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.254938, 2.198938, 2.950032
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.370552, 2.495493, 2.851325
Valid average loss all      (Triplet)                 : 0.271315

== Recognize ==
Valid average loss Recognize     : 0.679903
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 57.000000 %

== Valid average loss all : 0.278114

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.298224687576294 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.672998189926147 sec. =
Valid knn accuracy bass      : 23.18548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.466609239578247 sec. =
Valid knn accuracy piano     : 40.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.371455907821655 sec. =
Valid knn accuracy guitar    : 47.32142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.612504720687866 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 52.50840447464527%

                                                                      [AEpoch 38: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=0.678, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0137, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00694, Train/loss_recog_epoch=0.672]Epoch 38: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=0.678, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188308, 0.188609, 0.187503, 0.194223
Train average loss UNet                 (all)                : 0.758643

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001269, 1.924019, 3.676665
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010362, 1.759709, 2.852482
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007016, 1.891004, 3.058428
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006307, 1.901706, 3.256045
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007248, 2.026247, 3.385126
Train average loss all      (Triplet)                 : 0.006474

== Recognize ==
Train average loss Recognize     : 0.669334
Train average accuracy drums     : 53.625000 %
Train average accuracy bass      : 53.324997 %
Train average accuracy piano     : 52.719997 %
Train average accuracy guitar    : 54.100002 %
Train average accuracy residuals : 54.809998 %

== Train average loss all : 0.013167

Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=0.678, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]          Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=0.678, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]Epoch 39:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=0.678, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]Epoch 39:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=0.665, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]Epoch 39:  32%|███▏      | 100/313 [02:07<04:31,  0.79it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=0.665, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]Epoch 39:  32%|███▏      | 100/313 [02:07<04:31,  0.79it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00943, Train/loss_recog_step=0.668, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]Epoch 39:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00943, Train/loss_recog_step=0.668, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]Epoch 39:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00996, Train/loss_recog_step=0.675, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]Epoch 39:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00996, Train/loss_recog_step=0.675, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]Epoch 39:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00789, Train/loss_recog_step=0.638, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]Epoch 39:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00789, Train/loss_recog_step=0.638, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]Epoch 39:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0141, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0077, Train/loss_recog_step=0.644, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669] Epoch 39:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0141, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0077, Train/loss_recog_step=0.644, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]Epoch 39:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0346, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.691, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]Epoch 39: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0346, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.691, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]Epoch 39: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.00888, Train/loss_recog_step=0.669, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.57it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.14it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.24it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.62it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.85it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182242, 0.185670, 0.187323, 0.203596
Valid average loss UNet                 (all)                : 0.758832

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.049675, 1.940588, 3.419494
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.427521, 2.222488, 2.422578
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.311569, 2.086197, 2.545556
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.297179, 2.230511, 3.153706
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.231015, 2.460115, 2.990191
Valid average loss all      (Triplet)                 : 0.289979

== Recognize ==
Valid average loss Recognize     : 0.710201
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.297081

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.31277346611023 sec. =
Valid knn accuracy drums     : 81.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.392573118209839 sec. =
Valid knn accuracy bass      : 26.008064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.812174797058105 sec. =
Valid knn accuracy piano     : 41.40625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.351866245269775 sec. =
Valid knn accuracy guitar    : 49.107142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.299036026000977 sec. =
Valid knn accuracy residuals : 63.18181818181819%

Valid knn accuracy average   : 52.3319594588441%

                                                                      [AEpoch 39: 100%|██████████| 313/313 [07:36<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.00888, Train/loss_recog_step=0.669, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00647, Train/loss_recog_epoch=0.669]Epoch 39: 100%|██████████| 313/313 [07:36<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.00888, Train/loss_recog_step=0.669, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188220, 0.188530, 0.187424, 0.194721
Train average loss UNet                 (all)                : 0.758895

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001587, 1.974491, 3.793599
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009597, 1.822226, 2.939147
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008224, 1.954029, 3.156037
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007823, 1.974355, 3.350085
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005231, 2.075138, 3.510618
Train average loss all      (Triplet)                 : 0.006540

== Recognize ==
Train average loss Recognize     : 0.670196
Train average accuracy drums     : 53.965004 %
Train average accuracy bass      : 53.044998 %
Train average accuracy piano     : 53.675003 %
Train average accuracy guitar    : 53.990002 %
Train average accuracy residuals : 54.425003 %

== Train average loss all : 0.013242

Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.00888, Train/loss_recog_step=0.669, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]          Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.00888, Train/loss_recog_step=0.669, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]Epoch 40:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.00888, Train/loss_recog_step=0.669, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]Epoch 40:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.696, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670] Epoch 40:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.696, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]Epoch 40:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00674, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000269, Train/loss_recog_step=0.647, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]Epoch 40:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.00674, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000269, Train/loss_recog_step=0.647, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]Epoch 40:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.0264, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=0.653, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]   Epoch 40:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0264, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=0.653, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]Epoch 40:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00829, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00182, Train/loss_recog_step=0.647, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]Epoch 40:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00829, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00182, Train/loss_recog_step=0.647, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]Epoch 40:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00789, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00152, Train/loss_recog_step=0.637, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]Epoch 40:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00789, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00152, Train/loss_recog_step=0.637, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]Epoch 40:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00969, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00274, Train/loss_recog_step=0.695, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]Epoch 40: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00969, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00274, Train/loss_recog_step=0.695, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]Epoch 40: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00919, Train/loss_recog_step=0.734, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.523, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.06it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.12it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.12it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:03<00:00,  2.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182864, 0.186305, 0.188045, 0.187022
Valid average loss UNet                 (all)                : 0.744236

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.045664, 1.905528, 3.483627
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.447356, 2.153877, 2.633872
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.328600, 2.152216, 2.541788
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.283750, 2.239614, 2.962461
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.224194, 2.448428, 2.941375
Valid average loss all      (Triplet)                 : 0.288803

== Recognize ==
Valid average loss Recognize     : 0.715599
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.295959

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.5658278465271 sec. =
Valid knn accuracy drums     : 82.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.618903160095215 sec. =
Valid knn accuracy bass      : 31.85483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.698161363601685 sec. =
Valid knn accuracy piano     : 39.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.63859510421753 sec. =
Valid knn accuracy guitar    : 52.00892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.272587299346924 sec. =
Valid knn accuracy residuals : 64.0909090909091%

Valid knn accuracy average   : 54.03794614396823%

                                                                      [AEpoch 40: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00919, Train/loss_recog_step=0.734, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00654, Train/loss_recog_epoch=0.670]Epoch 40: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00919, Train/loss_recog_step=0.734, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188036, 0.188334, 0.187257, 0.194941
Train average loss UNet                 (all)                : 0.758568

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001398, 1.926694, 3.727719
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006995, 1.783033, 2.928629
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010230, 1.910193, 3.090670
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006765, 1.942875, 3.327703
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005765, 2.042733, 3.418506
Train average loss all      (Triplet)                 : 0.006290

== Recognize ==
Train average loss Recognize     : 0.668447
Train average accuracy drums     : 55.299995 %
Train average accuracy bass      : 52.499996 %
Train average accuracy piano     : 53.390003 %
Train average accuracy guitar    : 54.189999 %
Train average accuracy residuals : 55.035000 %

== Train average loss all : 0.012974

Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00919, Train/loss_recog_step=0.734, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]          Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00919, Train/loss_recog_step=0.734, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]Epoch 41:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00919, Train/loss_recog_step=0.734, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]Epoch 41:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668] Epoch 41:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]Epoch 41:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00719, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000262, Train/loss_recog_step=0.692, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]Epoch 41:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00719, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000262, Train/loss_recog_step=0.692, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]Epoch 41:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00756, Train/loss_recog_step=0.664, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]  Epoch 41:  64%|██████▍   | 200/313 [04:04<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00756, Train/loss_recog_step=0.664, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]Epoch 41:  64%|██████▍   | 200/313 [04:04<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00904, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=0.660, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]Epoch 41:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00904, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=0.660, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]Epoch 41:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.677, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]  Epoch 41:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.677, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]Epoch 41:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00966, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00275, Train/loss_recog_step=0.692, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]Epoch 41: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00966, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00275, Train/loss_recog_step=0.692, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]Epoch 41: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000913, Train/loss_recog_step=0.651, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.734, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.540, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.37it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.13it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.84it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.55it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.69it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.84it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182895, 0.186298, 0.188195, 0.197709
Valid average loss UNet                 (all)                : 0.755096

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.052552, 1.861917, 3.201955
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.415264, 2.115042, 2.375498
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.285802, 2.153157, 2.571450
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.280958, 2.243590, 2.980171
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.252900, 2.396367, 2.768812
Valid average loss all      (Triplet)                 : 0.288344

== Recognize ==
Valid average loss Recognize     : 0.699597
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 42.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.295340

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.456910848617554 sec. =
Valid knn accuracy drums     : 81.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.812801122665405 sec. =
Valid knn accuracy bass      : 31.451612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.358127117156982 sec. =
Valid knn accuracy piano     : 44.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.420598030090332 sec. =
Valid knn accuracy guitar    : 50.22321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.573721170425415 sec. =
Valid knn accuracy residuals : 63.63636363636363%

Valid knn accuracy average   : 54.281667512886834%

                                                                      [AEpoch 41: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000913, Train/loss_recog_step=0.651, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00629, Train/loss_recog_epoch=0.668]Epoch 41: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000913, Train/loss_recog_step=0.651, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188507, 0.188800, 0.187722, 0.194613
Train average loss UNet                 (all)                : 0.759642

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000883, 1.897436, 3.604447
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009239, 1.809476, 2.955236
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008288, 1.932577, 3.138139
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005416, 1.953816, 3.353933
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004949, 2.084321, 3.527494
Train average loss all      (Triplet)                 : 0.005744

== Recognize ==
Train average loss Recognize     : 0.669971
Train average accuracy drums     : 55.045002 %
Train average accuracy bass      : 52.665001 %
Train average accuracy piano     : 53.645004 %
Train average accuracy guitar    : 54.355003 %
Train average accuracy residuals : 54.450001 %

== Train average loss all : 0.012443

Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000913, Train/loss_recog_step=0.651, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]          Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000913, Train/loss_recog_step=0.651, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]Epoch 42:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000913, Train/loss_recog_step=0.651, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]Epoch 42:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00341, Train/loss_recog_step=0.676, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]  Epoch 42:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00341, Train/loss_recog_step=0.676, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]Epoch 42:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00699, Train/loss_recog_step=0.664, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]Epoch 42:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00699, Train/loss_recog_step=0.664, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]Epoch 42:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.0084, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00166, Train/loss_recog_step=0.674, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]Epoch 42:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0084, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00166, Train/loss_recog_step=0.674, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]Epoch 42:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00433, Train/loss_recog_step=0.710, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]Epoch 42:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00433, Train/loss_recog_step=0.710, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]Epoch 42:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]  Epoch 42:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]Epoch 42:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=0.684, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]Epoch 42: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=0.684, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]Epoch 42: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0285, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=0.708, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.663, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.95it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.78it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.79it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.83it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182622, 0.185958, 0.187960, 0.203441
Valid average loss UNet                 (all)                : 0.759982

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.063645, 1.895376, 3.535432
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.383941, 2.141954, 2.540092
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.318877, 2.206164, 2.676091
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.301064, 2.330639, 3.115453
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.225723, 2.445043, 3.027542
Valid average loss all      (Triplet)                 : 0.276008

== Recognize ==
Valid average loss Recognize     : 0.729595
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.283304

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.471535444259644 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.612384796142578 sec. =
Valid knn accuracy bass      : 33.46774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.418543100357056 sec. =
Valid knn accuracy piano     : 47.8515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.309788703918457 sec. =
Valid knn accuracy guitar    : 46.42857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.208006381988525 sec. =
Valid knn accuracy residuals : 61.81818181818181%

Valid knn accuracy average   : 54.43495066688221%

                                                                      [AEpoch 42: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0285, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=0.708, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0124, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=0.670]Epoch 42: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0285, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=0.708, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188176, 0.188473, 0.187372, 0.195075
Train average loss UNet                 (all)                : 0.759096

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000928, 1.915572, 3.711850
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008559, 1.812803, 2.971319
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008394, 1.969853, 3.194458
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006998, 1.986759, 3.446344
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004389, 2.051870, 3.471583
Train average loss all      (Triplet)                 : 0.005890

== Recognize ==
Train average loss Recognize     : 0.670021
Train average accuracy drums     : 55.099998 %
Train average accuracy bass      : 52.139999 %
Train average accuracy piano     : 52.764999 %
Train average accuracy guitar    : 54.135002 %
Train average accuracy residuals : 54.764999 %

== Train average loss all : 0.012590

Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0285, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=0.708, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670]          Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0285, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=0.708, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670]Epoch 43:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.0285, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=0.708, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670]Epoch 43:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00747, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00097, Train/loss_recog_step=0.650, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670]Epoch 43:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00747, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00097, Train/loss_recog_step=0.650, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670]Epoch 43:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00845, Train/loss_recog_step=0.720, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670] Epoch 43:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00845, Train/loss_recog_step=0.720, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670]Epoch 43:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670] Epoch 43:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670]Epoch 43:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=0.658, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670]Epoch 43:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=0.658, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670]Epoch 43:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670] Epoch 43:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670]Epoch 43:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00772, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000765, Train/loss_recog_step=0.695, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670]Epoch 43: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00772, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000765, Train/loss_recog_step=0.695, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670]Epoch 43: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.648, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.771, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.33it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.91it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.03it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.58it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.57it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182553, 0.185806, 0.188091, 0.203091
Valid average loss UNet                 (all)                : 0.759540

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.057169, 1.889454, 3.416584
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.327388, 2.150589, 2.632935
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.315584, 2.134856, 2.468102
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.306192, 2.270411, 3.098753
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.241854, 2.449118, 3.057757
Valid average loss all      (Triplet)                 : 0.260786

== Recognize ==
Valid average loss Recognize     : 0.696110
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 43.500000 %
Valid average accuracy piano     : 56.000000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.267747

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.825270414352417 sec. =
Valid knn accuracy drums     : 82.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.260472297668457 sec. =
Valid knn accuracy bass      : 32.45967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.843770980834961 sec. =
Valid knn accuracy piano     : 48.828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.547996759414673 sec. =
Valid knn accuracy guitar    : 45.982142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.279464483261108 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 54.88284281024025%

                                                                      [AEpoch 43: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.648, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.670]Epoch 43: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.648, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188245, 0.188544, 0.187443, 0.194472
Train average loss UNet                 (all)                : 0.758704

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000987, 1.895507, 3.650569
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007329, 1.816070, 2.995382
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008326, 1.954380, 3.187768
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007586, 1.953814, 3.381493
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005749, 2.065706, 3.492062
Train average loss all      (Triplet)                 : 0.005998

== Recognize ==
Train average loss Recognize     : 0.667570
Train average accuracy drums     : 55.239998 %
Train average accuracy bass      : 53.184998 %
Train average accuracy piano     : 53.530003 %
Train average accuracy guitar    : 53.670002 %
Train average accuracy residuals : 54.590000 %

== Train average loss all : 0.012674

Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.648, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]          Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.648, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]Epoch 44:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.648, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]Epoch 44:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.0131, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00659, Train/loss_recog_step=0.648, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]Epoch 44:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.0131, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00659, Train/loss_recog_step=0.648, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]Epoch 44:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.0205, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.676, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668] Epoch 44:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0205, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.676, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]Epoch 44:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00527, Train/loss_recog_step=0.667, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]Epoch 44:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00527, Train/loss_recog_step=0.667, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]Epoch 44:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00801, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000949, Train/loss_recog_step=0.707, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]Epoch 44:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00801, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000949, Train/loss_recog_step=0.707, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]Epoch 44:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]   Epoch 44:  96%|█████████▌| 300/313 [05:59<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]Epoch 44:  96%|█████████▌| 300/313 [05:59<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00998, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00297, Train/loss_recog_step=0.701, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]Epoch 44: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00998, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00297, Train/loss_recog_step=0.701, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]Epoch 44: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=0.637, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.23it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.10it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.83it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.96it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.28it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182687, 0.186108, 0.187985, 0.206770
Valid average loss UNet                 (all)                : 0.763550

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.029007, 1.948972, 3.692359
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.384169, 2.193782, 2.588738
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.334079, 2.152555, 2.494700
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.329764, 2.305583, 3.212982
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.236009, 2.610967, 3.138392
Valid average loss all      (Triplet)                 : 0.287766

== Recognize ==
Valid average loss Recognize     : 0.696397
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.294730

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.69293737411499 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.439202070236206 sec. =
Valid knn accuracy bass      : 34.87903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.590273380279541 sec. =
Valid knn accuracy piano     : 40.4296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.999074697494507 sec. =
Valid knn accuracy guitar    : 41.964285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.516634941101074 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 53.867644572730924%

                                                                      [AEpoch 44: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=0.637, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.668]Epoch 44: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=0.637, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188241, 0.188556, 0.187445, 0.195334
Train average loss UNet                 (all)                : 0.759575

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001979, 1.908105, 3.740558
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008152, 1.812019, 2.962136
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008112, 1.926197, 3.121076
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005640, 1.994461, 3.466765
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005549, 2.025477, 3.397453
Train average loss all      (Triplet)                 : 0.005977

== Recognize ==
Train average loss Recognize     : 0.667927
Train average accuracy drums     : 55.234997 %
Train average accuracy bass      : 53.294998 %
Train average accuracy piano     : 52.539997 %
Train average accuracy guitar    : 53.324997 %
Train average accuracy residuals : 54.599998 %

== Train average loss all : 0.012656

Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=0.637, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668]          Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=0.637, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668]Epoch 45:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=0.637, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668]Epoch 45:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.00679, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.679, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668] Epoch 45:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00679, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.679, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668]Epoch 45:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00888, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00214, Train/loss_recog_step=0.675, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668]Epoch 45:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00888, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00214, Train/loss_recog_step=0.675, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668]Epoch 45:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00674, Train/loss_recog_step=0.695, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668] Epoch 45:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00674, Train/loss_recog_step=0.695, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668]Epoch 45:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00692, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.692, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668] Epoch 45:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00692, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.692, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668]Epoch 45:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00993, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00311, Train/loss_recog_step=0.682, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668]Epoch 45:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00993, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00311, Train/loss_recog_step=0.682, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668]Epoch 45:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00353, Train/loss_recog_step=0.670, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668] Epoch 45: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00353, Train/loss_recog_step=0.670, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668]Epoch 45: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.721, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.04it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  2.93it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.61it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.37it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.68it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182197, 0.185660, 0.187374, 0.201003
Valid average loss UNet                 (all)                : 0.756234

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.057422, 1.874560, 3.477326
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.370260, 2.128474, 2.515038
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.353288, 2.039567, 2.195058
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.304180, 2.130452, 2.794029
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.242033, 2.336555, 2.766895
Valid average loss all      (Triplet)                 : 0.278539

== Recognize ==
Valid average loss Recognize     : 0.725945
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.285798

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.41617226600647 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.479081630706787 sec. =
Valid knn accuracy bass      : 27.21774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.115106344223022 sec. =
Valid knn accuracy piano     : 42.7734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.617124319076538 sec. =
Valid knn accuracy guitar    : 42.63392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.386625289916992 sec. =
Valid knn accuracy residuals : 65.68181818181819%

Valid knn accuracy average   : 52.44399393339829%

                                                                      [AEpoch 45: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0127, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00598, Train/loss_recog_epoch=0.668]Epoch 45: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188083, 0.188383, 0.187293, 0.194713
Train average loss UNet                 (all)                : 0.758471

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000831, 1.985752, 3.835163
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007942, 1.900474, 3.106095
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006909, 1.973444, 3.226642
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005216, 2.050532, 3.535144
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004296, 2.115338, 3.544241
Train average loss all      (Triplet)                 : 0.005062

== Recognize ==
Train average loss Recognize     : 0.671609
Train average accuracy drums     : 54.759998 %
Train average accuracy bass      : 53.039997 %
Train average accuracy piano     : 53.299999 %
Train average accuracy guitar    : 53.660000 %
Train average accuracy residuals : 54.665001 %

== Train average loss all : 0.011778

Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672]          Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672]Epoch 46:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672]Epoch 46:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.658, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672] Epoch 46:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.658, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672]Epoch 46:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00682, Train/loss_recog_step=0.691, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672]Epoch 46:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00682, Train/loss_recog_step=0.691, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672]Epoch 46:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00376, Train/loss_recog_step=0.652, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672]Epoch 46:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00376, Train/loss_recog_step=0.652, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672]Epoch 46:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00822, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00145, Train/loss_recog_step=0.677, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672]Epoch 46:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00822, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00145, Train/loss_recog_step=0.677, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672]Epoch 46:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00486, Train/loss_recog_step=0.652, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672] Epoch 46:  96%|█████████▌| 300/313 [05:59<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00486, Train/loss_recog_step=0.652, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672]Epoch 46:  96%|█████████▌| 300/313 [05:59<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0281, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=0.655, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672] Epoch 46: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0281, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=0.655, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672]Epoch 46: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.765, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.524, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.35it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.32it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182517, 0.185969, 0.187587, 0.195584
Valid average loss UNet                 (all)                : 0.751658

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.057465, 1.819040, 3.418013
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.496615, 2.346151, 2.726175
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.389955, 2.237142, 2.352784
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.300196, 2.165683, 3.002628
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.318376, 2.584072, 2.959448
Valid average loss all      (Triplet)                 : 0.334412

== Recognize ==
Valid average loss Recognize     : 0.724822
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.341660

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.87950849533081 sec. =
Valid knn accuracy drums     : 83.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.50836706161499 sec. =
Valid knn accuracy bass      : 35.28225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.54740309715271 sec. =
Valid knn accuracy piano     : 39.453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.55206298828125 sec. =
Valid knn accuracy guitar    : 44.642857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.57689642906189 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 53.709640136336326%

                                                                      [AEpoch 46: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00506, Train/loss_recog_epoch=0.672]Epoch 46: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188237, 0.188543, 0.187439, 0.194678
Train average loss UNet                 (all)                : 0.758897

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001192, 1.972100, 3.867929
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006666, 1.866948, 3.067748
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007987, 1.982147, 3.229127
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005930, 1.986342, 3.406527
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006486, 2.100531, 3.505213
Train average loss all      (Triplet)                 : 0.005571

== Recognize ==
Train average loss Recognize     : 0.667310
Train average accuracy drums     : 55.554996 %
Train average accuracy bass      : 53.735001 %
Train average accuracy piano     : 53.875000 %
Train average accuracy guitar    : 54.100002 %
Train average accuracy residuals : 53.780003 %

== Train average loss all : 0.012244

Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667]          Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667]Epoch 47:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667]Epoch 47:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.018, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.651, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667] Epoch 47:  32%|███▏      | 100/313 [02:12<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.018, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.651, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667]Epoch 47:  32%|███▏      | 100/313 [02:12<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00612, Train/loss_recog_step=0.652, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667]Epoch 47:  48%|████▊     | 150/313 [03:11<03:27,  0.78it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00612, Train/loss_recog_step=0.652, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667]Epoch 47:  48%|████▊     | 150/313 [03:11<03:27,  0.78it/s, v_num=0, Train/loss_all_step=0.00906, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00208, Train/loss_recog_step=0.697, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667]Epoch 47:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.00906, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00208, Train/loss_recog_step=0.697, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667]Epoch 47:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.00942, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00222, Train/loss_recog_step=0.720, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667]Epoch 47:  80%|███████▉  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00942, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00222, Train/loss_recog_step=0.720, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667]Epoch 47:  80%|███████▉  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00905, Train/loss_recog_step=0.621, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667] Epoch 47:  96%|█████████▌| 300/313 [06:07<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00905, Train/loss_recog_step=0.621, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667]Epoch 47:  96%|█████████▌| 300/313 [06:07<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00771, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.657, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667]Epoch 47: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00771, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.657, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667]Epoch 47: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0082, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=0.633, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.75it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.46it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.31it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182216, 0.185626, 0.187495, 0.198427
Valid average loss UNet                 (all)                : 0.753764

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.041646, 1.857666, 3.442728
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.420257, 2.208565, 2.575138
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.392887, 2.253993, 2.417845
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.299179, 2.213659, 3.068408
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.280524, 2.514632, 3.046549
Valid average loss all      (Triplet)                 : 0.306394

== Recognize ==
Valid average loss Recognize     : 0.710708
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.313501

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.159929037094116 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.697741508483887 sec. =
Valid knn accuracy bass      : 31.653225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.498870849609375 sec. =
Valid knn accuracy piano     : 39.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.61539340019226 sec. =
Valid knn accuracy guitar    : 38.169642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.479176759719849 sec. =
Valid knn accuracy residuals : 66.81818181818183%

Valid knn accuracy average   : 51.9535497702683%

                                                                      [AEpoch 47: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0082, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=0.633, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=0.667]Epoch 47: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0082, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=0.633, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188235, 0.188557, 0.187438, 0.194503
Train average loss UNet                 (all)                : 0.758732

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001525, 1.906493, 3.700838
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006984, 1.867365, 3.037900
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005461, 1.924760, 3.166091
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006612, 1.972341, 3.395719
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005234, 2.068404, 3.481552
Train average loss all      (Triplet)                 : 0.005126

== Recognize ==
Train average loss Recognize     : 0.663559
Train average accuracy drums     : 56.019997 %
Train average accuracy bass      : 53.394997 %
Train average accuracy piano     : 53.934998 %
Train average accuracy guitar    : 54.100002 %
Train average accuracy residuals : 54.240002 %

== Train average loss all : 0.011761

Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0082, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=0.633, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]          Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0082, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=0.633, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]Epoch 48:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.0082, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=0.633, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]Epoch 48:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]  Epoch 48:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]Epoch 48:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000194, Train/loss_recog_step=0.654, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]Epoch 48:  48%|████▊     | 150/313 [03:06<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000194, Train/loss_recog_step=0.654, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]Epoch 48:  48%|████▊     | 150/313 [03:06<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.023, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=0.649, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]    Epoch 48:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.023, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=0.649, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]Epoch 48:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00765, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00088, Train/loss_recog_step=0.677, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]Epoch 48:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00765, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00088, Train/loss_recog_step=0.677, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]Epoch 48:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]  Epoch 48:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]Epoch 48:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]Epoch 48: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]Epoch 48: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.286, Valid/loss_recog_step=0.739, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.520, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.41it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.60it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.83it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.69it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.69it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182505, 0.185884, 0.187928, 0.197262
Valid average loss UNet                 (all)                : 0.753578

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077368, 1.826038, 3.248418
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.396959, 2.118576, 2.511630
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.305638, 2.160391, 2.435095
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.291777, 2.171883, 3.126672
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.287264, 2.554719, 2.987004
Valid average loss all      (Triplet)                 : 0.298794

== Recognize ==
Valid average loss Recognize     : 0.710397
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.305898

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.540405035018921 sec. =
Valid knn accuracy drums     : 80.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.26623249053955 sec. =
Valid knn accuracy bass      : 27.82258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.817708730697632 sec. =
Valid knn accuracy piano     : 44.53125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.378177404403687 sec. =
Valid knn accuracy guitar    : 41.517857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.241270303726196 sec. =
Valid knn accuracy residuals : 65.22727272727272%

Valid knn accuracy average   : 51.863270363927796%

                                                                      [AEpoch 48: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.664]Epoch 48: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188261, 0.188569, 0.187469, 0.194741
Train average loss UNet                 (all)                : 0.759040

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000814, 1.898106, 3.678504
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006628, 1.853094, 3.068581
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006497, 1.910221, 3.155406
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006285, 1.992910, 3.455968
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004407, 2.098748, 3.534207
Train average loss all      (Triplet)                 : 0.004928

== Recognize ==
Train average loss Recognize     : 0.662506
Train average accuracy drums     : 56.570000 %
Train average accuracy bass      : 53.560001 %
Train average accuracy piano     : 53.404999 %
Train average accuracy guitar    : 54.665001 %
Train average accuracy residuals : 54.759998 %

== Train average loss all : 0.011553

Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]          Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]Epoch 49:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]Epoch 49:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=9.46e-5, Train/loss_recog_step=0.648, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]Epoch 49:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=9.46e-5, Train/loss_recog_step=0.648, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]Epoch 49:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00711, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.711, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]  Epoch 49:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.00711, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.711, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]Epoch 49:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.019, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.675, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663] Epoch 49:  64%|██████▍   | 200/313 [04:06<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.019, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.675, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]Epoch 49:  64%|██████▍   | 200/313 [04:06<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]Epoch 49:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]Epoch 49:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00616, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.616, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]Epoch 49:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00616, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.616, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]Epoch 49:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.734, Train/loss_triplet_all_step=0.00693, Train/loss_recog_step=0.683, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]Epoch 49: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.734, Train/loss_triplet_all_step=0.00693, Train/loss_recog_step=0.683, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]Epoch 49: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.519, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.28it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.39it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.21it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.03it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.31it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:03<00:00,  2.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.181379, 0.184766, 0.186516, 0.200954
Valid average loss UNet                 (all)                : 0.753616

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.047140, 1.846540, 3.362995
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.380844, 2.251687, 2.615417
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.380035, 2.267533, 2.377325
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.298020, 2.302804, 3.337847
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.291221, 2.672601, 2.922375
Valid average loss all      (Triplet)                 : 0.293039

== Recognize ==
Valid average loss Recognize     : 0.699553
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 57.000000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.300035

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.601868867874146 sec. =
Valid knn accuracy drums     : 80.8695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.64906644821167 sec. =
Valid knn accuracy bass      : 26.814516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 48.695475816726685 sec. =
Valid knn accuracy piano     : 39.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.677691459655762 sec. =
Valid knn accuracy guitar    : 44.419642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.392965078353882 sec. =
Valid knn accuracy residuals : 65.0%

Valid knn accuracy average   : 51.35043234071328%

                                                                      [AEpoch 49: 100%|██████████| 313/313 [08:29<00:00,  0.61it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.663]Epoch 49: 100%|██████████| 313/313 [08:29<00:00,  0.61it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188509, 0.188799, 0.187700, 0.194357
Train average loss UNet                 (all)                : 0.759365

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001160, 1.900749, 3.618009
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007585, 1.897035, 3.140939
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005125, 1.948580, 3.205518
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005767, 2.032554, 3.473147
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006056, 2.118634, 3.545587
Train average loss all      (Triplet)                 : 0.005241

== Recognize ==
Train average loss Recognize     : 0.664381
Train average accuracy drums     : 56.655003 %
Train average accuracy bass      : 53.890003 %
Train average accuracy piano     : 53.439999 %
Train average accuracy guitar    : 53.584999 %
Train average accuracy residuals : 54.529999 %

== Train average loss all : 0.011885

Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]          Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]Epoch 50:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]Epoch 50:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.012, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00518, Train/loss_recog_step=0.680, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]Epoch 50:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.012, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00518, Train/loss_recog_step=0.680, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]Epoch 50:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00981, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.003, Train/loss_recog_step=0.682, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]Epoch 50:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00981, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.003, Train/loss_recog_step=0.682, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]Epoch 50:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=0.656, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]Epoch 50:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=0.656, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]Epoch 50:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.696, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664] Epoch 50:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.696, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]Epoch 50:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00682, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000219, Train/loss_recog_step=0.660, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]Epoch 50:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00682, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000219, Train/loss_recog_step=0.660, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]Epoch 50:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]   Epoch 50: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]Epoch 50: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.697, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.275, Valid/loss_recog_step=0.633, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.514, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.84it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.26it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.68it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182204, 0.185688, 0.187204, 0.191763
Valid average loss UNet                 (all)                : 0.746859

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.040792, 1.847628, 3.365373
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.390541, 2.250305, 2.433876
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.325411, 2.254842, 2.375513
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.245890, 2.266409, 3.196905
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.248817, 2.582735, 3.106936
Valid average loss all      (Triplet)                 : 0.262726

== Recognize ==
Valid average loss Recognize     : 0.715706
Valid average accuracy drums     : 43.500000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.269883

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.359584093093872 sec. =
Valid knn accuracy drums     : 79.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.00775694847107 sec. =
Valid knn accuracy bass      : 31.653225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.127685785293579 sec. =
Valid knn accuracy piano     : 41.015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.253080129623413 sec. =
Valid knn accuracy guitar    : 45.75892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.612479209899902 sec. =
Valid knn accuracy residuals : 65.45454545454545%

Valid knn accuracy average   : 52.68950844474599%

                                                                      [AEpoch 50: 100%|██████████| 313/313 [07:58<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.697, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0119, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=0.664]Epoch 50: 100%|██████████| 313/313 [07:58<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.697, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188234, 0.188524, 0.187439, 0.194716
Train average loss UNet                 (all)                : 0.758914

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001728, 1.928945, 3.727800
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007967, 1.913313, 3.138725
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005338, 1.956972, 3.206829
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006086, 2.041393, 3.530798
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004624, 2.128752, 3.592414
Train average loss all      (Triplet)                 : 0.005297

== Recognize ==
Train average loss Recognize     : 0.668916
Train average accuracy drums     : 56.400002 %
Train average accuracy bass      : 53.480000 %
Train average accuracy piano     : 52.259998 %
Train average accuracy guitar    : 53.425003 %
Train average accuracy residuals : 54.529999 %

== Train average loss all : 0.011986

Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.697, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]          Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.697, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]Epoch 51:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.697, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]Epoch 51:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00424, Train/loss_recog_step=0.669, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]Epoch 51:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00424, Train/loss_recog_step=0.669, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]Epoch 51:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.006, Train/loss_recog_step=0.638, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]  Epoch 51:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.006, Train/loss_recog_step=0.638, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]Epoch 51:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00382, Train/loss_recog_step=0.691, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]Epoch 51:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00382, Train/loss_recog_step=0.691, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]Epoch 51:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00862, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00173, Train/loss_recog_step=0.689, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]Epoch 51:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00862, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00173, Train/loss_recog_step=0.689, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]Epoch 51:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00874, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.00227, Train/loss_recog_step=0.648, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]Epoch 51:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00874, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.00227, Train/loss_recog_step=0.648, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]Epoch 51:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.688, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]  Epoch 51: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.688, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]Epoch 51: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000591, Train/loss_recog_step=0.630, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.527, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.32it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.36it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182317, 0.185690, 0.187401, 0.200677
Valid average loss UNet                 (all)                : 0.756085

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.051200, 1.762397, 3.149563
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.410260, 2.293972, 2.549698
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.412175, 2.240785, 2.513326
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.272522, 2.247770, 3.104441
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.279664, 2.702537, 2.989494
Valid average loss all      (Triplet)                 : 0.302669

== Recognize ==
Valid average loss Recognize     : 0.692562
Valid average accuracy drums     : 56.500000 %
Valid average accuracy bass      : 57.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.309595

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.316505432128906 sec. =
Valid knn accuracy drums     : 80.8695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.44364070892334 sec. =
Valid knn accuracy bass      : 32.056451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.101856708526611 sec. =
Valid knn accuracy piano     : 39.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.113533735275269 sec. =
Valid knn accuracy guitar    : 48.214285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.282042503356934 sec. =
Valid knn accuracy residuals : 59.77272727272728%

Valid knn accuracy average   : 52.1513559634615%

                                                                      [AEpoch 51: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000591, Train/loss_recog_step=0.630, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.669]Epoch 51: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000591, Train/loss_recog_step=0.630, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188203, 0.188524, 0.187415, 0.195013
Train average loss UNet                 (all)                : 0.759156

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000530, 1.881913, 3.620976
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006465, 1.888825, 3.138663
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007184, 1.915232, 3.152851
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005533, 2.005624, 3.499725
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005976, 2.129155, 3.570747
Train average loss all      (Triplet)                 : 0.005199

== Recognize ==
Train average loss Recognize     : 0.664168
Train average accuracy drums     : 56.440002 %
Train average accuracy bass      : 54.189999 %
Train average accuracy piano     : 52.939999 %
Train average accuracy guitar    : 53.845001 %
Train average accuracy residuals : 54.715000 %

== Train average loss all : 0.011841

Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000591, Train/loss_recog_step=0.630, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]          Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000591, Train/loss_recog_step=0.630, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]Epoch 52:  16%|█▌        | 50/313 [01:09<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000591, Train/loss_recog_step=0.630, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]Epoch 52:  16%|█▌        | 50/313 [01:09<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]   Epoch 52:  32%|███▏      | 100/313 [02:10<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]Epoch 52:  32%|███▏      | 100/313 [02:10<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00726, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000847, Train/loss_recog_step=0.642, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]Epoch 52:  48%|████▊     | 150/313 [03:10<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.00726, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000847, Train/loss_recog_step=0.642, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]Epoch 52:  48%|████▊     | 150/313 [03:10<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00339, Train/loss_recog_step=0.705, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]  Epoch 52:  64%|██████▍   | 200/313 [04:09<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00339, Train/loss_recog_step=0.705, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]Epoch 52:  64%|██████▍   | 200/313 [04:09<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00526, Train/loss_recog_step=0.657, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]Epoch 52:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00526, Train/loss_recog_step=0.657, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]Epoch 52:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.629, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664] Epoch 52:  96%|█████████▌| 300/313 [06:09<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.629, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]Epoch 52:  96%|█████████▌| 300/313 [06:09<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00543, Train/loss_recog_step=0.672, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]Epoch 52: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00543, Train/loss_recog_step=0.672, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]Epoch 52: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.40it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.16it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.85it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.48it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183102, 0.186462, 0.188334, 0.201615
Valid average loss UNet                 (all)                : 0.759514

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.058602, 1.790500, 3.402329
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.473493, 2.331753, 2.538117
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.452213, 2.322950, 2.441486
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.250992, 2.145000, 3.040459
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.216306, 2.579897, 3.196806
Valid average loss all      (Triplet)                 : 0.311949

== Recognize ==
Valid average loss Recognize     : 0.724881
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 44.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.319198

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.37527346611023 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.467517375946045 sec. =
Valid knn accuracy bass      : 35.685483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.756135702133179 sec. =
Valid knn accuracy piano     : 40.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.395855188369751 sec. =
Valid knn accuracy guitar    : 43.080357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.324447870254517 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 53.350500218575256%

                                                                      [AEpoch 52: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0052, Train/loss_recog_epoch=0.664]Epoch 52: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188282, 0.188592, 0.187499, 0.194903
Train average loss UNet                 (all)                : 0.759277

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000883, 1.883641, 3.649822
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006587, 1.872958, 3.096258
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006698, 1.982363, 3.249279
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004538, 2.019499, 3.524279
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004721, 2.093520, 3.542814
Train average loss all      (Triplet)                 : 0.004735

== Recognize ==
Train average loss Recognize     : 0.665471
Train average accuracy drums     : 56.805004 %
Train average accuracy bass      : 53.195000 %
Train average accuracy piano     : 53.605003 %
Train average accuracy guitar    : 53.789997 %
Train average accuracy residuals : 54.724998 %

== Train average loss all : 0.011389

Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]          Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]Epoch 53:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]Epoch 53:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.00711, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.711, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]Epoch 53:  32%|███▏      | 100/313 [02:07<04:31,  0.79it/s, v_num=0, Train/loss_all_step=0.00711, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.711, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]Epoch 53:  32%|███▏      | 100/313 [02:07<04:31,  0.79it/s, v_num=0, Train/loss_all_step=0.00801, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00112, Train/loss_recog_step=0.689, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]Epoch 53:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00801, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00112, Train/loss_recog_step=0.689, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]Epoch 53:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00956, Train/loss_recog_step=0.705, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665] Epoch 53:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00956, Train/loss_recog_step=0.705, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]Epoch 53:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665] Epoch 53:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]Epoch 53:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]Epoch 53:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]Epoch 53:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.015, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00841, Train/loss_recog_step=0.661, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]Epoch 53: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.015, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00841, Train/loss_recog_step=0.661, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]Epoch 53: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0073, Train/loss_recog_step=0.643, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.99it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.64it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.37it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.91it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.181475, 0.184870, 0.186467, 0.198736
Valid average loss UNet                 (all)                : 0.751549

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.048834, 1.796392, 3.350784
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.483913, 2.273685, 2.564615
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.363701, 2.237060, 2.542809
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.248756, 2.045087, 2.907553
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.229678, 2.573276, 3.086315
Valid average loss all      (Triplet)                 : 0.296578

== Recognize ==
Valid average loss Recognize     : 0.720024
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.303778

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.704014301300049 sec. =
Valid knn accuracy drums     : 80.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.250730514526367 sec. =
Valid knn accuracy bass      : 30.443548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.758142232894897 sec. =
Valid knn accuracy piano     : 39.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.363001346588135 sec. =
Valid knn accuracy guitar    : 48.660714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.285439491271973 sec. =
Valid knn accuracy residuals : 62.95454545454545%

Valid knn accuracy average   : 52.510946408079995%

                                                                      [AEpoch 53: 100%|██████████| 313/313 [07:36<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0073, Train/loss_recog_step=0.643, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00473, Train/loss_recog_epoch=0.665]Epoch 53: 100%|██████████| 313/313 [07:36<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0073, Train/loss_recog_step=0.643, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188482, 0.188791, 0.187680, 0.195081
Train average loss UNet                 (all)                : 0.760034

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001025, 1.899832, 3.723779
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009294, 1.913316, 3.138239
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005968, 1.956385, 3.211908
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004605, 1.998080, 3.505392
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003481, 2.086940, 3.551033
Train average loss all      (Triplet)                 : 0.005110

== Recognize ==
Train average loss Recognize     : 0.664975
Train average accuracy drums     : 56.930000 %
Train average accuracy bass      : 53.590000 %
Train average accuracy piano     : 52.549999 %
Train average accuracy guitar    : 54.505001 %
Train average accuracy residuals : 54.105003 %

== Train average loss all : 0.011759

Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0073, Train/loss_recog_step=0.643, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]          Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0073, Train/loss_recog_step=0.643, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]Epoch 54:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0073, Train/loss_recog_step=0.643, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]Epoch 54:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.0315, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0246, Train/loss_recog_step=0.684, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]Epoch 54:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.0315, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0246, Train/loss_recog_step=0.684, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]Epoch 54:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00266, Train/loss_recog_step=0.651, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]Epoch 54:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00266, Train/loss_recog_step=0.651, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]Epoch 54:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.00805, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=0.698, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]Epoch 54:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00805, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=0.698, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]Epoch 54:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00679, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.679, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]  Epoch 54:  80%|███████▉  | 250/313 [05:06<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00679, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.679, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]Epoch 54:  80%|███████▉  | 250/313 [05:06<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00882, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00231, Train/loss_recog_step=0.651, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]Epoch 54:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00882, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00231, Train/loss_recog_step=0.651, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]Epoch 54:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00571, Train/loss_recog_step=0.660, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665] Epoch 54: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00571, Train/loss_recog_step=0.660, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]Epoch 54: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.690, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.781, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.54it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.08it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.81it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.66it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.40it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.67it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.181687, 0.185046, 0.186709, 0.208592
Valid average loss UNet                 (all)                : 0.762034

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.029095, 1.836823, 3.561939
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.406371, 2.176299, 2.559169
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.357936, 2.251964, 2.512328
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.275903, 2.172040, 2.990132
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.315508, 2.658730, 3.256370
Valid average loss all      (Triplet)                 : 0.291518

== Recognize ==
Valid average loss Recognize     : 0.684772
Valid average accuracy drums     : 57.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.298365

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.441965579986572 sec. =
Valid knn accuracy drums     : 81.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.437216520309448 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.039579153060913 sec. =
Valid knn accuracy piano     : 40.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.671124696731567 sec. =
Valid knn accuracy guitar    : 53.79464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.08280086517334 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 54.305182994162216%

                                                                      [AEpoch 54: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.690, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=0.665]Epoch 54: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.690, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188130, 0.188409, 0.187331, 0.195316
Train average loss UNet                 (all)                : 0.759186

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000785, 1.830768, 3.660154
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005139, 1.832227, 3.052183
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006166, 1.911488, 3.161087
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003676, 1.942804, 3.404355
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004664, 2.080983, 3.532303
Train average loss all      (Triplet)                 : 0.004155

== Recognize ==
Train average loss Recognize     : 0.661758
Train average accuracy drums     : 57.375000 %
Train average accuracy bass      : 54.135002 %
Train average accuracy piano     : 52.284996 %
Train average accuracy guitar    : 54.505001 %
Train average accuracy residuals : 54.605000 %

== Train average loss all : 0.010773

Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.690, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]          Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.690, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]Epoch 55:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.690, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]Epoch 55:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=1.18e-5, Train/loss_recog_step=0.685, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]Epoch 55:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=1.18e-5, Train/loss_recog_step=0.685, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]Epoch 55:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.0231, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=0.669, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]  Epoch 55:  48%|████▊     | 150/313 [03:13<03:30,  0.78it/s, v_num=0, Train/loss_all_step=0.0231, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=0.669, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]Epoch 55:  48%|████▊     | 150/313 [03:13<03:30,  0.78it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.697, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]Epoch 55:  64%|██████▍   | 200/313 [04:10<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.697, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]Epoch 55:  64%|██████▍   | 200/313 [04:10<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0042, Train/loss_recog_step=0.671, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]Epoch 55:  80%|███████▉  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0042, Train/loss_recog_step=0.671, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]Epoch 55:  80%|███████▉  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.00657, Train/loss_recog_step=0.638, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]Epoch 55:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.00657, Train/loss_recog_step=0.638, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]Epoch 55:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0227, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.663, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662] Epoch 55: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0227, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.663, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]Epoch 55: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.43it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.83it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.67it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.55it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.04it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182764, 0.186161, 0.187827, 0.197433
Valid average loss UNet                 (all)                : 0.754184

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.054337, 1.716263, 3.333128
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.381618, 2.219082, 2.591374
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.377024, 2.237882, 2.420555
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.283620, 2.178141, 3.026980
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.268104, 2.499672, 3.029779
Valid average loss all      (Triplet)                 : 0.287983

== Recognize ==
Valid average loss Recognize     : 0.700033
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 57.000000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.294983

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.341120481491089 sec. =
Valid knn accuracy drums     : 80.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.590141296386719 sec. =
Valid knn accuracy bass      : 36.49193548387097%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.971333265304565 sec. =
Valid knn accuracy piano     : 39.0625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.701506614685059 sec. =
Valid knn accuracy guitar    : 49.107142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.32492709159851 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 54.60820499626601%

                                                                      [AEpoch 55: 100%|██████████| 313/313 [08:00<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=0.662]Epoch 55: 100%|██████████| 313/313 [08:00<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188632, 0.188963, 0.187845, 0.194015
Train average loss UNet                 (all)                : 0.759455

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001054, 1.834835, 3.676720
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005529, 1.862369, 3.107267
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006286, 1.934531, 3.232687
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004601, 1.955918, 3.439182
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004540, 2.126958, 3.635202
Train average loss all      (Triplet)                 : 0.004489

== Recognize ==
Train average loss Recognize     : 0.660023
Train average accuracy drums     : 57.810001 %
Train average accuracy bass      : 53.394997 %
Train average accuracy piano     : 53.390003 %
Train average accuracy guitar    : 54.415001 %
Train average accuracy residuals : 54.310001 %

== Train average loss all : 0.011090

Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]          Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]Epoch 56:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]Epoch 56:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00933, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=0.661, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]Epoch 56:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00933, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=0.661, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]Epoch 56:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00799, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00109, Train/loss_recog_step=0.690, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]Epoch 56:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00799, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00109, Train/loss_recog_step=0.690, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]Epoch 56:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]  Epoch 56:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]Epoch 56:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=0.700, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]Epoch 56:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=0.700, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]Epoch 56:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00724, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000812, Train/loss_recog_step=0.643, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]Epoch 56:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00724, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000812, Train/loss_recog_step=0.643, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]Epoch 56:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00796, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=0.673, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660] Epoch 56: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00796, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=0.673, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]Epoch 56: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00708, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.708, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.231, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.27it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.97it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.86it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.63it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182434, 0.185805, 0.187533, 0.202535
Valid average loss UNet                 (all)                : 0.758308

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.040015, 1.717141, 3.297519
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.472166, 2.251560, 2.525745
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.389849, 2.211743, 2.383825
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.266379, 2.172347, 3.016719
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.229442, 2.478529, 3.089911
Valid average loss all      (Triplet)                 : 0.300499

== Recognize ==
Valid average loss Recognize     : 0.705120
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 43.000000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.307550

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.351043939590454 sec. =
Valid knn accuracy drums     : 78.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.284684658050537 sec. =
Valid knn accuracy bass      : 40.12096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.338058471679688 sec. =
Valid knn accuracy piano     : 36.71875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.521991491317749 sec. =
Valid knn accuracy guitar    : 53.34821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.316757917404175 sec. =
Valid knn accuracy residuals : 57.95454545454546%

Valid knn accuracy average   : 53.28066940948253%

                                                                      [AEpoch 56: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00708, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.708, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=0.660]Epoch 56: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00708, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.708, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188074, 0.188377, 0.187291, 0.194733
Train average loss UNet                 (all)                : 0.758475

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000564, 1.875304, 3.719013
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005959, 1.918574, 3.171638
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005724, 1.961022, 3.255205
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003618, 2.007766, 3.538523
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004919, 2.157415, 3.668334
Train average loss all      (Triplet)                 : 0.004235

== Recognize ==
Train average loss Recognize     : 0.664096
Train average accuracy drums     : 56.449997 %
Train average accuracy bass      : 53.570004 %
Train average accuracy piano     : 53.490002 %
Train average accuracy guitar    : 54.375000 %
Train average accuracy residuals : 54.044998 %

== Train average loss all : 0.010876

Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00708, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.708, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]          Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00708, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.708, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]Epoch 57:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.00708, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.708, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]Epoch 57:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00463, Train/loss_recog_step=0.667, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]Epoch 57:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00463, Train/loss_recog_step=0.667, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]Epoch 57:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=0.650, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664] Epoch 57:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=0.650, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]Epoch 57:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]Epoch 57:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]Epoch 57:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.638, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]Epoch 57:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.638, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]Epoch 57:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.643, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]Epoch 57:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.643, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]Epoch 57:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=0.650, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]Epoch 57: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=0.650, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]Epoch 57: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.661, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.52it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.19it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.08it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.18it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.55it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183035, 0.186443, 0.188251, 0.205006
Valid average loss UNet                 (all)                : 0.762735

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.048963, 1.809773, 3.378221
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.440137, 2.247211, 2.567365
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.354046, 2.305349, 2.439443
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.239067, 2.282051, 3.229870
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.324492, 2.692838, 3.136492
Valid average loss all      (Triplet)                 : 0.306027

== Recognize ==
Valid average loss Recognize     : 0.695144
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 44.000000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.312978

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.361421585083008 sec. =
Valid knn accuracy drums     : 81.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.629398345947266 sec. =
Valid knn accuracy bass      : 30.443548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.417638778686523 sec. =
Valid knn accuracy piano     : 37.109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.46906065940857 sec. =
Valid knn accuracy guitar    : 49.330357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.309307098388672 sec. =
Valid knn accuracy residuals : 64.77272727272727%

Valid knn accuracy average   : 52.63554938662319%

                                                                      [AEpoch 57: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.661, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=0.664]Epoch 57: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.661, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188244, 0.188547, 0.187469, 0.194760
Train average loss UNet                 (all)                : 0.759020

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000615, 1.857828, 3.726079
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005374, 1.917122, 3.207507
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004561, 1.928598, 3.221012
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004298, 1.997987, 3.518824
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004860, 2.147585, 3.677248
Train average loss all      (Triplet)                 : 0.003969

== Recognize ==
Train average loss Recognize     : 0.659119
Train average accuracy drums     : 58.240002 %
Train average accuracy bass      : 53.399998 %
Train average accuracy piano     : 53.095001 %
Train average accuracy guitar    : 53.675003 %
Train average accuracy residuals : 54.949997 %

== Train average loss all : 0.010560

Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.661, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]          Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.661, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]Epoch 58:  16%|█▌        | 50/313 [01:07<05:54,  0.74it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.661, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]Epoch 58:  16%|█▌        | 50/313 [01:07<05:54,  0.74it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.677, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]Epoch 58:  32%|███▏      | 100/313 [02:06<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.677, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]Epoch 58:  32%|███▏      | 100/313 [02:06<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00722, Train/loss_recog_step=0.643, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]Epoch 58:  48%|████▊     | 150/313 [03:05<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00722, Train/loss_recog_step=0.643, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]Epoch 58:  48%|████▊     | 150/313 [03:05<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.00943, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00288, Train/loss_recog_step=0.654, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]Epoch 58:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00943, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00288, Train/loss_recog_step=0.654, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]Epoch 58:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000384, Train/loss_recog_step=0.663, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]Epoch 58:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000384, Train/loss_recog_step=0.663, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]Epoch 58:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000345, Train/loss_recog_step=0.643, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]Epoch 58:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000345, Train/loss_recog_step=0.643, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]Epoch 58:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0155, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00886, Train/loss_recog_step=0.666, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]  Epoch 58: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0155, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00886, Train/loss_recog_step=0.666, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]Epoch 58: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.265, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.623, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.54it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.60it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.58it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.56it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.62it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183658, 0.187094, 0.188632, 0.209164
Valid average loss UNet                 (all)                : 0.768548

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.033203, 1.813442, 3.309479
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.508479, 2.413524, 2.655140
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.329832, 2.344442, 2.637200
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.216332, 2.266028, 3.208585
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.337495, 2.788257, 3.468802
Valid average loss all      (Triplet)                 : 0.311747

== Recognize ==
Valid average loss Recognize     : 0.710437
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.318852

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.336642503738403 sec. =
Valid knn accuracy drums     : 81.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.577949523925781 sec. =
Valid knn accuracy bass      : 31.653225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.463062763214111 sec. =
Valid knn accuracy piano     : 41.015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.403617143630981 sec. =
Valid knn accuracy guitar    : 48.88392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.539707660675049 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 54.24731476885667%

                                                                      [AEpoch 58: 100%|██████████| 313/313 [07:36<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.659]Epoch 58: 100%|██████████| 313/313 [07:36<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188570, 0.188879, 0.187790, 0.194940
Train average loss UNet                 (all)                : 0.760179

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000758, 1.871654, 3.658347
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006302, 1.942760, 3.222876
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004540, 1.972848, 3.293121
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005727, 2.027747, 3.541536
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004422, 2.194484, 3.756998
Train average loss all      (Triplet)                 : 0.004452

== Recognize ==
Train average loss Recognize     : 0.664612
Train average accuracy drums     : 57.139999 %
Train average accuracy bass      : 52.394997 %
Train average accuracy piano     : 53.315002 %
Train average accuracy guitar    : 54.505001 %
Train average accuracy residuals : 54.215004 %

== Train average loss all : 0.011098

Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]          Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]Epoch 59:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]Epoch 59:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00685, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00021, Train/loss_recog_step=0.664, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]Epoch 59:  32%|███▏      | 100/313 [02:10<04:38,  0.77it/s, v_num=0, Train/loss_all_step=0.00685, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00021, Train/loss_recog_step=0.664, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]Epoch 59:  32%|███▏      | 100/313 [02:10<04:38,  0.77it/s, v_num=0, Train/loss_all_step=0.00943, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=0.674, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665] Epoch 59:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00943, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=0.674, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]Epoch 59:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0096, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=0.683, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]Epoch 59:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0096, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=0.683, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]Epoch 59:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0068, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.680, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]  Epoch 59:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0068, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.680, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]Epoch 59:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0151, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.00879, Train/loss_recog_step=0.631, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]Epoch 59:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0151, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.00879, Train/loss_recog_step=0.631, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]Epoch 59:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00635, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.635, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665] Epoch 59: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00635, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.635, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]Epoch 59: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.704, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.59it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.76it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.55it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.61it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.181582, 0.184937, 0.186361, 0.204780
Valid average loss UNet                 (all)                : 0.757660

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.041808, 1.714885, 3.244191
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.507407, 2.249858, 2.526382
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.260673, 2.101661, 2.493710
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.226782, 2.214975, 3.132397
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.256442, 2.723479, 3.196437
Valid average loss all      (Triplet)                 : 0.289407

== Recognize ==
Valid average loss Recognize     : 0.697408
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.296381

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.287955045700073 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.754048347473145 sec. =
Valid knn accuracy bass      : 36.895161290322584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.528385877609253 sec. =
Valid knn accuracy piano     : 42.96875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.234531879425049 sec. =
Valid knn accuracy guitar    : 48.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.520219326019287 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 55.06937316715542%

                                                                      [AEpoch 59: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.704, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=0.665]Epoch 59: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.704, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188217, 0.188509, 0.187432, 0.194971
Train average loss UNet                 (all)                : 0.759129

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001081, 1.902308, 3.742872
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005369, 1.966412, 3.263545
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005746, 2.018199, 3.353022
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004579, 2.064358, 3.636625
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003181, 2.184345, 3.734500
Train average loss all      (Triplet)                 : 0.004014

== Recognize ==
Train average loss Recognize     : 0.663654
Train average accuracy drums     : 57.529999 %
Train average accuracy bass      : 53.289997 %
Train average accuracy piano     : 53.700001 %
Train average accuracy guitar    : 54.025002 %
Train average accuracy residuals : 54.954998 %

== Train average loss all : 0.010651

Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.704, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]          Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.704, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]Epoch 60:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.704, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]Epoch 60:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.012, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00496, Train/loss_recog_step=0.706, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]Epoch 60:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.012, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00496, Train/loss_recog_step=0.706, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]Epoch 60:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00516, Train/loss_recog_step=0.663, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]Epoch 60:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00516, Train/loss_recog_step=0.663, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]Epoch 60:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.670, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]Epoch 60:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.670, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]Epoch 60:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00825, Train/loss_recog_step=0.665, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]Epoch 60:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00825, Train/loss_recog_step=0.665, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]Epoch 60:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=0.671, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]Epoch 60:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=0.671, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]Epoch 60:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.693, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664] Epoch 60: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.693, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]Epoch 60: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0215, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.646, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.289, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.76it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.82it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.89it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.45it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182358, 0.185756, 0.187332, 0.193502
Valid average loss UNet                 (all)                : 0.748947

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.027905, 1.843084, 3.433760
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.420807, 2.258060, 2.625052
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.336957, 2.381482, 2.517327
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.255913, 2.291638, 3.242544
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.324131, 2.799057, 3.304707
Valid average loss all      (Triplet)                 : 0.290159

== Recognize ==
Valid average loss Recognize     : 0.751281
Valid average accuracy drums     : 42.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.297672

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.427258968353271 sec. =
Valid knn accuracy drums     : 81.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.368456602096558 sec. =
Valid knn accuracy bass      : 37.903225806451616%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.794249296188354 sec. =
Valid knn accuracy piano     : 44.53125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.309352159500122 sec. =
Valid knn accuracy guitar    : 51.33928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.349873304367065 sec. =
Valid knn accuracy residuals : 70.68181818181817%

Valid knn accuracy average   : 57.23894202746763%

                                                                      [AEpoch 60: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0215, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.646, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.664]Epoch 60: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0215, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.646, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188329, 0.188642, 0.187565, 0.194907
Train average loss UNet                 (all)                : 0.759443

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000710, 1.895815, 3.656640
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006747, 2.019193, 3.377909
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005369, 2.046314, 3.394048
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005313, 2.108262, 3.672770
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003654, 2.205419, 3.764688
Train average loss all      (Triplet)                 : 0.004406

== Recognize ==
Train average loss Recognize     : 0.668692
Train average accuracy drums     : 56.985004 %
Train average accuracy bass      : 53.869999 %
Train average accuracy piano     : 53.445000 %
Train average accuracy guitar    : 53.640003 %
Train average accuracy residuals : 54.320000 %

== Train average loss all : 0.011093

Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0215, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.646, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]          Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0215, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.646, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]Epoch 61:  16%|█▌        | 50/313 [01:08<05:57,  0.73it/s, v_num=0, Train/loss_all_step=0.0215, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.646, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]Epoch 61:  16%|█▌        | 50/313 [01:08<05:57,  0.73it/s, v_num=0, Train/loss_all_step=0.00748, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000725, Train/loss_recog_step=0.676, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]Epoch 61:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00748, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000725, Train/loss_recog_step=0.676, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]Epoch 61:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.017, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.651, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]    Epoch 61:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.017, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.651, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]Epoch 61:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00356, Train/loss_recog_step=0.730, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]Epoch 61:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00356, Train/loss_recog_step=0.730, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]Epoch 61:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00984, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00292, Train/loss_recog_step=0.692, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]Epoch 61:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00984, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00292, Train/loss_recog_step=0.692, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]Epoch 61:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]  Epoch 61:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]Epoch 61:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0259, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.675, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]Epoch 61: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0259, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.675, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]Epoch 61: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0079, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.585, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.833, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.52it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.65it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.82it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182173, 0.185609, 0.187014, 0.199894
Valid average loss UNet                 (all)                : 0.754691

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065453, 1.868500, 3.320666
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.468692, 2.208578, 2.516125
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.313015, 2.206517, 2.430766
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.194459, 2.145161, 3.050981
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.284971, 2.508693, 3.034420
Valid average loss all      (Triplet)                 : 0.286459

== Recognize ==
Valid average loss Recognize     : 0.721929
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.293679

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.36729884147644 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.283995866775513 sec. =
Valid knn accuracy bass      : 32.86290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.193538665771484 sec. =
Valid knn accuracy piano     : 49.4140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.568866729736328 sec. =
Valid knn accuracy guitar    : 52.90178571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.207310438156128 sec. =
Valid knn accuracy residuals : 69.54545454545455%

Valid knn accuracy average   : 57.55353684928325%

                                                                      [AEpoch 61: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0079, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.585, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.669]Epoch 61: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0079, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.585, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188197, 0.188501, 0.187427, 0.194922
Train average loss UNet                 (all)                : 0.759047

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001282, 1.894609, 3.700344
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006146, 1.988420, 3.299727
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006573, 2.070154, 3.417353
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004585, 2.087616, 3.686734
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003570, 2.185327, 3.681015
Train average loss all      (Triplet)                 : 0.004392

== Recognize ==
Train average loss Recognize     : 0.666993
Train average accuracy drums     : 57.040001 %
Train average accuracy bass      : 53.390003 %
Train average accuracy piano     : 52.394997 %
Train average accuracy guitar    : 54.084999 %
Train average accuracy residuals : 55.379997 %

== Train average loss all : 0.011062

Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0079, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.585, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]          Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0079, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.585, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]Epoch 62:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.0079, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.585, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]Epoch 62:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00555, Train/loss_recog_step=0.685, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]Epoch 62:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00555, Train/loss_recog_step=0.685, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]Epoch 62:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00857, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00185, Train/loss_recog_step=0.672, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]Epoch 62:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.00857, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00185, Train/loss_recog_step=0.672, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]Epoch 62:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0043, Train/loss_recog_step=0.678, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]  Epoch 62:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0043, Train/loss_recog_step=0.678, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]Epoch 62:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.688, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]Epoch 62:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.688, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]Epoch 62:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.639, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]Epoch 62:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.639, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]Epoch 62:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]Epoch 62: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]Epoch 62: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0078, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0012, Train/loss_recog_step=0.660, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.15it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.68it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.83it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182402, 0.185852, 0.187334, 0.197908
Valid average loss UNet                 (all)                : 0.753496

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.048465, 1.957140, 3.524275
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.468799, 2.323189, 2.529342
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.401857, 2.195426, 2.470914
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.242500, 2.278955, 3.200476
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.302222, 2.630433, 3.050373
Valid average loss all      (Triplet)                 : 0.307256

== Recognize ==
Valid average loss Recognize     : 0.699167
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.314248

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.110016345977783 sec. =
Valid knn accuracy drums     : 81.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.882633924484253 sec. =
Valid knn accuracy bass      : 27.016129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.734959363937378 sec. =
Valid knn accuracy piano     : 43.1640625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.418877601623535 sec. =
Valid knn accuracy guitar    : 49.55357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.053968906402588 sec. =
Valid knn accuracy residuals : 66.13636363636364%

Valid knn accuracy average   : 53.47837314552558%

                                                                      [AEpoch 62: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0078, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0012, Train/loss_recog_step=0.660, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=0.667]Epoch 62: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0078, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0012, Train/loss_recog_step=0.660, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188369, 0.188693, 0.187577, 0.195166
Train average loss UNet                 (all)                : 0.759805

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001609, 1.894098, 3.706304
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004724, 1.940853, 3.259541
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004706, 2.031470, 3.373675
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004425, 2.049222, 3.587904
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004170, 2.147642, 3.625374
Train average loss all      (Triplet)                 : 0.003974

== Recognize ==
Train average loss Recognize     : 0.664592
Train average accuracy drums     : 57.355000 %
Train average accuracy bass      : 53.079998 %
Train average accuracy piano     : 52.329998 %
Train average accuracy guitar    : 53.715004 %
Train average accuracy residuals : 55.405003 %

== Train average loss all : 0.010620

Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0078, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0012, Train/loss_recog_step=0.660, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]          Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0078, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0012, Train/loss_recog_step=0.660, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]Epoch 63:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.0078, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0012, Train/loss_recog_step=0.660, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]Epoch 63:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0056, Train/loss_recog_step=0.655, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]Epoch 63:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0056, Train/loss_recog_step=0.655, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]Epoch 63:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]Epoch 63:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]Epoch 63:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00846, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.674, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]Epoch 63:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00846, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.674, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]Epoch 63:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00583, Train/loss_recog_step=0.698, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665] Epoch 63:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00583, Train/loss_recog_step=0.698, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]Epoch 63:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00953, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.00312, Train/loss_recog_step=0.641, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]Epoch 63:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00953, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.00312, Train/loss_recog_step=0.641, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]Epoch 63:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00972, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=0.700, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]Epoch 63: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00972, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=0.700, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]Epoch 63: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.27it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.12it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.86it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.64it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.38it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182458, 0.185811, 0.187622, 0.198323
Valid average loss UNet                 (all)                : 0.754214

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061672, 1.872716, 3.496439
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.451314, 2.302214, 2.687625
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.358876, 2.221724, 2.518202
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.263230, 2.268798, 3.277009
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.316756, 2.613743, 3.118729
Valid average loss all      (Triplet)                 : 0.298893

== Recognize ==
Valid average loss Recognize     : 0.728788
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.306181

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.609983921051025 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.705081224441528 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.902681589126587 sec. =
Valid knn accuracy piano     : 38.8671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.312809944152832 sec. =
Valid knn accuracy guitar    : 52.45535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.367215871810913 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 53.61322753114697%

                                                                      [AEpoch 63: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.665]Epoch 63: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188259, 0.188568, 0.187481, 0.195098
Train average loss UNet                 (all)                : 0.759406

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000580, 1.862742, 3.678316
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005908, 1.955136, 3.277974
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004965, 2.024980, 3.374503
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004569, 2.084381, 3.678307
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003204, 2.128018, 3.627257
Train average loss all      (Triplet)                 : 0.003820

== Recognize ==
Train average loss Recognize     : 0.662846
Train average accuracy drums     : 58.049999 %
Train average accuracy bass      : 53.030003 %
Train average accuracy piano     : 52.555000 %
Train average accuracy guitar    : 54.030003 %
Train average accuracy residuals : 55.290001 %

== Train average loss all : 0.010449

Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]          Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]Epoch 64:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]Epoch 64:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00891, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00268, Train/loss_recog_step=0.623, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]Epoch 64:  32%|███▏      | 100/313 [02:09<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00891, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00268, Train/loss_recog_step=0.623, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]Epoch 64:  32%|███▏      | 100/313 [02:09<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00818, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00151, Train/loss_recog_step=0.667, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]Epoch 64:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00818, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00151, Train/loss_recog_step=0.667, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]Epoch 64:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]   Epoch 64:  64%|██████▍   | 200/313 [04:08<02:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]Epoch 64:  64%|██████▍   | 200/313 [04:08<02:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00845, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00195, Train/loss_recog_step=0.650, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]Epoch 64:  80%|███████▉  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00845, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00195, Train/loss_recog_step=0.650, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]Epoch 64:  80%|███████▉  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]  Epoch 64:  96%|█████████▌| 300/313 [06:08<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]Epoch 64:  96%|█████████▌| 300/313 [06:08<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0253, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=0.666, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]Epoch 64: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0253, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=0.666, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]Epoch 64: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.50it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.59it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.11it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.13it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.67it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:03<00:00,  2.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182202, 0.185628, 0.187130, 0.200040
Valid average loss UNet                 (all)                : 0.755000

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060951, 1.805607, 3.242891
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.478518, 2.289106, 2.608317
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.310186, 2.210455, 2.547680
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.311579, 2.289150, 3.021021
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.314410, 2.733028, 2.951452
Valid average loss all      (Triplet)                 : 0.321444

== Recognize ==
Valid average loss Recognize     : 0.691062
Valid average accuracy drums     : 56.500000 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 42.000000 %

== Valid average loss all : 0.328354

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.368782043457031 sec. =
Valid knn accuracy drums     : 82.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.454660415649414 sec. =
Valid knn accuracy bass      : 32.66129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.479459762573242 sec. =
Valid knn accuracy piano     : 38.4765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.323673486709595 sec. =
Valid knn accuracy guitar    : 48.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.36280345916748 sec. =
Valid knn accuracy residuals : 71.13636363636363%

Valid knn accuracy average   : 54.707560683093206%

                                                                      [AEpoch 64: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0104, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.663]Epoch 64: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188230, 0.188533, 0.187449, 0.194557
Train average loss UNet                 (all)                : 0.758769

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001043, 1.904193, 3.789675
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004266, 1.990215, 3.326490
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005700, 2.069808, 3.443271
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002912, 2.112261, 3.752326
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003250, 2.173129, 3.713648
Train average loss all      (Triplet)                 : 0.003500

== Recognize ==
Train average loss Recognize     : 0.664267
Train average accuracy drums     : 57.395000 %
Train average accuracy bass      : 52.579998 %
Train average accuracy piano     : 52.974998 %
Train average accuracy guitar    : 54.000004 %
Train average accuracy residuals : 54.935001 %

== Train average loss all : 0.010143

Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]          Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]Epoch 65:  16%|█▌        | 50/313 [01:11<06:15,  0.70it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]Epoch 65:  16%|█▌        | 50/313 [01:11<06:15,  0.70it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00597, Train/loss_recog_step=0.699, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]Epoch 65:  32%|███▏      | 100/313 [02:13<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00597, Train/loss_recog_step=0.699, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]Epoch 65:  32%|███▏      | 100/313 [02:13<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00967, Train/loss_recog_step=0.649, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]Epoch 65:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00967, Train/loss_recog_step=0.649, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]Epoch 65:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0042, Train/loss_recog_step=0.660, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664] Epoch 65:  64%|██████▍   | 200/313 [04:10<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0042, Train/loss_recog_step=0.660, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]Epoch 65:  64%|██████▍   | 200/313 [04:10<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.00707, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.707, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]Epoch 65:  80%|███████▉  | 250/313 [05:09<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00707, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.707, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]Epoch 65:  80%|███████▉  | 250/313 [05:09<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.00651, Train/loss_recog_step=0.642, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]Epoch 65:  96%|█████████▌| 300/313 [06:08<00:15,  0.81it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.00651, Train/loss_recog_step=0.642, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]Epoch 65:  96%|█████████▌| 300/313 [06:08<00:15,  0.81it/s, v_num=0, Train/loss_all_step=0.00788, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=0.620, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]Epoch 65: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00788, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=0.620, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]Epoch 65: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.624, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.627, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.37it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.03it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.85it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.65it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.68it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182615, 0.186051, 0.187587, 0.201544
Valid average loss UNet                 (all)                : 0.757797

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.022064, 1.813280, 3.470241
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.460218, 2.385304, 2.760714
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.341924, 2.310568, 2.419381
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.337317, 2.375695, 3.377100
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.304197, 2.726642, 3.071503
Valid average loss all      (Triplet)                 : 0.319587

== Recognize ==
Valid average loss Recognize     : 0.708841
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 59.500004 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.326675

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.604531049728394 sec. =
Valid knn accuracy drums     : 78.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.479426383972168 sec. =
Valid knn accuracy bass      : 33.266129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.673547744750977 sec. =
Valid knn accuracy piano     : 42.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.534743547439575 sec. =
Valid knn accuracy guitar    : 47.99107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.43826150894165 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 53.88459226607895%

                                                                      [AEpoch 65: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.624, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=0.664]Epoch 65: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.624, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188559, 0.188882, 0.187769, 0.194773
Train average loss UNet                 (all)                : 0.759984

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000835, 1.881162, 3.700754
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004150, 1.991539, 3.353695
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006272, 2.094906, 3.472537
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002963, 2.118373, 3.761581
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002815, 2.143182, 3.654929
Train average loss all      (Triplet)                 : 0.003397

== Recognize ==
Train average loss Recognize     : 0.663082
Train average accuracy drums     : 57.955002 %
Train average accuracy bass      : 54.305000 %
Train average accuracy piano     : 53.149998 %
Train average accuracy guitar    : 53.584999 %
Train average accuracy residuals : 54.834999 %

== Train average loss all : 0.010027

Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.624, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663]          Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.624, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663]Epoch 66:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.624, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663]Epoch 66:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00388, Train/loss_recog_step=0.687, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663]Epoch 66:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00388, Train/loss_recog_step=0.687, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663]Epoch 66:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.0222, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0154, Train/loss_recog_step=0.684, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663] Epoch 66:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0222, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0154, Train/loss_recog_step=0.684, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663]Epoch 66:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.014, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00699, Train/loss_recog_step=0.700, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663]Epoch 66:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.014, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00699, Train/loss_recog_step=0.700, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663]Epoch 66:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.018, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.691, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663] Epoch 66:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.018, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.691, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663]Epoch 66:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00342, Train/loss_recog_step=0.669, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663]Epoch 66:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00342, Train/loss_recog_step=0.669, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663]Epoch 66:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=0.661, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663]Epoch 66: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=0.661, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663]Epoch 66: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.642, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.539, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.30it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.83it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.90it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.28it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.31it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183164, 0.186612, 0.188284, 0.204106
Valid average loss UNet                 (all)                : 0.762165

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.021533, 1.846400, 3.438872
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.362363, 2.354455, 2.802261
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.320332, 2.181380, 2.468195
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.383337, 2.441138, 3.268725
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.350168, 2.746696, 3.155696
Valid average loss all      (Triplet)                 : 0.300656

== Recognize ==
Valid average loss Recognize     : 0.720048
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.307856

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.645652770996094 sec. =
Valid knn accuracy drums     : 81.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.519254922866821 sec. =
Valid knn accuracy bass      : 30.040322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.834268569946289 sec. =
Valid knn accuracy piano     : 41.2109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.402099370956421 sec. =
Valid knn accuracy guitar    : 54.24107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.599182605743408 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 54.898861558760316%

                                                                      [AEpoch 66: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.642, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=0.663]Epoch 66: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.642, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188379, 0.188703, 0.187608, 0.195799
Train average loss UNet                 (all)                : 0.760489

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000696, 1.867262, 3.717862
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005151, 1.997002, 3.332438
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004987, 2.068238, 3.449850
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004969, 2.128181, 3.720798
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003635, 2.169584, 3.683364
Train average loss all      (Triplet)                 : 0.003896

== Recognize ==
Train average loss Recognize     : 0.663720
Train average accuracy drums     : 57.750000 %
Train average accuracy bass      : 52.710003 %
Train average accuracy piano     : 52.119999 %
Train average accuracy guitar    : 54.310001 %
Train average accuracy residuals : 54.674999 %

== Train average loss all : 0.010533

Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.642, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]          Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.642, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]Epoch 67:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.642, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]Epoch 67:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0068, Train/loss_recog_step=0.682, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]Epoch 67:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0068, Train/loss_recog_step=0.682, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]Epoch 67:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.00716, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000685, Train/loss_recog_step=0.647, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]Epoch 67:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.00716, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000685, Train/loss_recog_step=0.647, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]Epoch 67:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.019, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.666, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]    Epoch 67:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.019, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.666, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]Epoch 67:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00887, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00197, Train/loss_recog_step=0.689, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]Epoch 67:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00887, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00197, Train/loss_recog_step=0.689, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]Epoch 67:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.736, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]  Epoch 67:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.736, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]Epoch 67:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00715, Train/loss_recog_step=0.711, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]Epoch 67: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00715, Train/loss_recog_step=0.711, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]Epoch 67: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00945, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00326, Train/loss_recog_step=0.619, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.43it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.15it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.59it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.59it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.77it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183088, 0.186521, 0.188172, 0.204685
Valid average loss UNet                 (all)                : 0.762467

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.046894, 1.743561, 3.278858
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.395790, 2.209004, 2.604677
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.328499, 2.102501, 2.415319
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.327284, 2.271552, 3.011425
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.295571, 2.351393, 3.070620
Valid average loss all      (Triplet)                 : 0.296535

== Recognize ==
Valid average loss Recognize     : 0.720281
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 44.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.303738

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.642289161682129 sec. =
Valid knn accuracy drums     : 84.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.310837030410767 sec. =
Valid knn accuracy bass      : 29.435483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.785064697265625 sec. =
Valid knn accuracy piano     : 40.4296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.159697532653809 sec. =
Valid knn accuracy guitar    : 55.13392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.582980871200562 sec. =
Valid knn accuracy residuals : 70.9090909090909%

Valid knn accuracy average   : 56.13815990942788%

                                                                      [AEpoch 67: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00945, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00326, Train/loss_recog_step=0.619, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.664]Epoch 67: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00945, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00326, Train/loss_recog_step=0.619, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188470, 0.188768, 0.187686, 0.194517
Train average loss UNet                 (all)                : 0.759440

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000817, 1.842708, 3.647045
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005620, 1.969121, 3.283962
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005618, 2.031585, 3.400467
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005354, 2.073905, 3.671085
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004670, 2.168779, 3.684656
Train average loss all      (Triplet)                 : 0.004321

== Recognize ==
Train average loss Recognize     : 0.660668
Train average accuracy drums     : 59.264999 %
Train average accuracy bass      : 53.969997 %
Train average accuracy piano     : 52.544998 %
Train average accuracy guitar    : 53.460003 %
Train average accuracy residuals : 54.375000 %

== Train average loss all : 0.010927

Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00945, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00326, Train/loss_recog_step=0.619, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661]          Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00945, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00326, Train/loss_recog_step=0.619, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661]Epoch 68:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00945, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00326, Train/loss_recog_step=0.619, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661]Epoch 68:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00576, Train/loss_recog_step=0.633, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661] Epoch 68:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00576, Train/loss_recog_step=0.633, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661]Epoch 68:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661] Epoch 68:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661]Epoch 68:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00771, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.00108, Train/loss_recog_step=0.663, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661]Epoch 68:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00771, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.00108, Train/loss_recog_step=0.663, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661]Epoch 68:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=0.672, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661] Epoch 68:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=0.672, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661]Epoch 68:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00618, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.618, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661] Epoch 68:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00618, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.618, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661]Epoch 68:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661]Epoch 68: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661]Epoch 68: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0064, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.640, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.225, Valid/loss_recog_step=0.766, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.35it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.72it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.04it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.31it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182886, 0.186172, 0.188053, 0.195163
Valid average loss UNet                 (all)                : 0.752274

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.044598, 1.779862, 3.292756
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.449365, 2.244267, 2.563936
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.340011, 2.213359, 2.433175
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.285468, 2.257043, 3.077192
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.307409, 2.507363, 3.113961
Valid average loss all      (Triplet)                 : 0.306337

== Recognize ==
Valid average loss Recognize     : 0.714788
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 42.000000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.313485

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.575923442840576 sec. =
Valid knn accuracy drums     : 81.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.423715353012085 sec. =
Valid knn accuracy bass      : 26.814516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.935685873031616 sec. =
Valid knn accuracy piano     : 43.1640625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.426882266998291 sec. =
Valid knn accuracy guitar    : 43.973214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.332460641860962 sec. =
Valid knn accuracy residuals : 69.31818181818183%

Valid knn accuracy average   : 53.04529929441176%

                                                                      [AEpoch 68: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0064, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.640, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00432, Train/loss_recog_epoch=0.661]Epoch 68: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0064, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.640, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188426, 0.188730, 0.187640, 0.194819
Train average loss UNet                 (all)                : 0.759615

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000867, 1.808549, 3.623479
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004364, 1.912629, 3.217749
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004138, 1.985968, 3.331480
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003801, 2.023006, 3.565235
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002875, 2.144794, 3.693400
Train average loss all      (Triplet)                 : 0.003162

== Recognize ==
Train average loss Recognize     : 0.652704
Train average accuracy drums     : 61.070000 %
Train average accuracy bass      : 54.084999 %
Train average accuracy piano     : 53.154999 %
Train average accuracy guitar    : 54.549999 %
Train average accuracy residuals : 55.024998 %

== Train average loss all : 0.009689

Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0064, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.640, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]          Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0064, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.640, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]Epoch 69:  16%|█▌        | 50/313 [01:09<06:07,  0.71it/s, v_num=0, Train/loss_all_step=0.0064, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.640, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]Epoch 69:  16%|█▌        | 50/313 [01:09<06:07,  0.71it/s, v_num=0, Train/loss_all_step=0.00666, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.666, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]Epoch 69:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00666, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.666, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]Epoch 69:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00407, Train/loss_recog_step=0.667, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]Epoch 69:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00407, Train/loss_recog_step=0.667, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]Epoch 69:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653] Epoch 69:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]Epoch 69:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=8.77e-5, Train/loss_recog_step=0.679, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]Epoch 69:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=8.77e-5, Train/loss_recog_step=0.679, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]Epoch 69:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00622, Train/loss_recog_step=0.677, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]  Epoch 69:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00622, Train/loss_recog_step=0.677, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]Epoch 69:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.677, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]Epoch 69: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.677, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]Epoch 69: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00695, Train/loss_recog_step=0.690, Valid/loss_all_step=0.248, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.723, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.715, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.37it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.51it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.69it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184077, 0.187502, 0.189451, 0.200065
Valid average loss UNet                 (all)                : 0.761094

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.040938, 1.857131, 3.426517
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.434201, 2.384902, 2.618429
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.385829, 2.469704, 2.571841
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.280622, 2.353003, 3.252522
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.244604, 2.622584, 3.296350
Valid average loss all      (Triplet)                 : 0.290238

== Recognize ==
Valid average loss Recognize     : 0.725335
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.297491

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.7939293384552 sec. =
Valid knn accuracy drums     : 85.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.648726463317871 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.381868362426758 sec. =
Valid knn accuracy piano     : 41.6015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.449973106384277 sec. =
Valid knn accuracy guitar    : 52.90178571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.253353118896484 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 55.20712125576036%

                                                                      [AEpoch 69: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00695, Train/loss_recog_step=0.690, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00969, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00316, Train/loss_recog_epoch=0.653]Epoch 69: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00695, Train/loss_recog_step=0.690, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188248, 0.188562, 0.187473, 0.194967
Train average loss UNet                 (all)                : 0.759250

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001217, 1.888076, 3.701364
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005256, 2.012412, 3.385495
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003822, 2.086559, 3.493939
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003863, 2.130413, 3.726924
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003134, 2.238970, 3.845647
Train average loss all      (Triplet)                 : 0.003355

== Recognize ==
Train average loss Recognize     : 0.663380
Train average accuracy drums     : 58.824997 %
Train average accuracy bass      : 53.579998 %
Train average accuracy piano     : 52.710003 %
Train average accuracy guitar    : 53.305000 %
Train average accuracy residuals : 54.724998 %

== Train average loss all : 0.009989

Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00695, Train/loss_recog_step=0.690, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]          Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00695, Train/loss_recog_step=0.690, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]Epoch 70:  16%|█▌        | 50/313 [01:10<06:12,  0.71it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00695, Train/loss_recog_step=0.690, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]Epoch 70:  16%|█▌        | 50/313 [01:10<06:12,  0.71it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.632, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663] Epoch 70:  32%|███▏      | 100/313 [02:07<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.632, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]Epoch 70:  32%|███▏      | 100/313 [02:07<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00914, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00265, Train/loss_recog_step=0.649, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]Epoch 70:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00914, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00265, Train/loss_recog_step=0.649, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]Epoch 70:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0227, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.676, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]   Epoch 70:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0227, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.676, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]Epoch 70:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=0.699, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]Epoch 70:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=0.699, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]Epoch 70:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]  Epoch 70:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]Epoch 70:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=0.652, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]Epoch 70: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=0.652, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]Epoch 70: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00841, Train/loss_recog_step=0.592, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.11it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.32it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.99it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.68it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.82it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182935, 0.186271, 0.188159, 0.191635
Valid average loss UNet                 (all)                : 0.749000

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.059916, 1.839557, 3.433392
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.429200, 2.294038, 2.495426
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.344186, 2.340694, 2.499014
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.258738, 2.392126, 3.375141
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.233015, 2.744014, 3.317776
Valid average loss all      (Triplet)                 : 0.280395

== Recognize ==
Valid average loss Recognize     : 0.757716
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 56.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.287972

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.475407600402832 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.104506969451904 sec. =
Valid knn accuracy bass      : 32.66129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.580582857131958 sec. =
Valid knn accuracy piano     : 36.9140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.400936841964722 sec. =
Valid knn accuracy guitar    : 47.544642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.322054386138916 sec. =
Valid knn accuracy residuals : 69.31818181818183%

Valid knn accuracy average   : 54.20067897784193%

                                                                      [AEpoch 70: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00841, Train/loss_recog_step=0.592, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00999, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=0.663]Epoch 70: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00841, Train/loss_recog_step=0.592, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188459, 0.188765, 0.187666, 0.195119
Train average loss UNet                 (all)                : 0.760009

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001287, 1.887377, 3.799475
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005237, 2.022887, 3.401351
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005372, 2.057708, 3.473391
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003438, 2.143510, 3.786518
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004663, 2.251894, 3.846307
Train average loss all      (Triplet)                 : 0.004064

== Recognize ==
Train average loss Recognize     : 0.662675
Train average accuracy drums     : 57.520000 %
Train average accuracy bass      : 53.810001 %
Train average accuracy piano     : 53.144997 %
Train average accuracy guitar    : 53.945000 %
Train average accuracy residuals : 54.459999 %

== Train average loss all : 0.010691

Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00841, Train/loss_recog_step=0.592, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663]          Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00841, Train/loss_recog_step=0.592, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663]Epoch 71:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00841, Train/loss_recog_step=0.592, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663]Epoch 71:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00819, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00174, Train/loss_recog_step=0.645, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663]Epoch 71:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00819, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00174, Train/loss_recog_step=0.645, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663]Epoch 71:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00442, Train/loss_recog_step=0.659, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663]  Epoch 71:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00442, Train/loss_recog_step=0.659, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663]Epoch 71:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00618, Train/loss_recog_step=0.676, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663]Epoch 71:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00618, Train/loss_recog_step=0.676, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663]Epoch 71:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00716, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.716, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663] Epoch 71:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00716, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.716, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663]Epoch 71:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00529, Train/loss_recog_step=0.650, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663]Epoch 71:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00529, Train/loss_recog_step=0.650, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663]Epoch 71:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.636, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663] Epoch 71: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.636, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663]Epoch 71: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.691, Valid/loss_all_step=0.196, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.02it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.65it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.15it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.12it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183766, 0.187099, 0.189178, 0.201104
Valid average loss UNet                 (all)                : 0.761148

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061769, 1.825738, 3.354453
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.425545, 2.406328, 2.610154
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.282035, 2.213499, 2.442405
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.261068, 2.367905, 3.465154
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.230679, 2.711753, 3.385352
Valid average loss all      (Triplet)                 : 0.274140

== Recognize ==
Valid average loss Recognize     : 0.713458
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.281274

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.065683364868164 sec. =
Valid knn accuracy drums     : 86.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.703196287155151 sec. =
Valid knn accuracy bass      : 27.419354838709676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.843750715255737 sec. =
Valid knn accuracy piano     : 42.7734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.31143593788147 sec. =
Valid knn accuracy guitar    : 44.86607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.175342082977295 sec. =
Valid knn accuracy residuals : 68.18181818181817%

Valid knn accuracy average   : 54.03944073764595%

                                                                      [AEpoch 71: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.691, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.663]Epoch 71: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.691, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188355, 0.188670, 0.187582, 0.194597
Train average loss UNet                 (all)                : 0.759204

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000632, 1.863614, 3.707741
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005695, 1.990688, 3.341661
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003946, 2.041563, 3.400800
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005014, 2.143615, 3.818055
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004852, 2.250542, 3.847898
Train average loss all      (Triplet)                 : 0.004011

== Recognize ==
Train average loss Recognize     : 0.660832
Train average accuracy drums     : 59.135002 %
Train average accuracy bass      : 54.160000 %
Train average accuracy piano     : 52.880001 %
Train average accuracy guitar    : 53.375000 %
Train average accuracy residuals : 54.549999 %

== Train average loss all : 0.010619

Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.691, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]          Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.691, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]Epoch 72:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.691, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]Epoch 72:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.0209, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=0.705, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]Epoch 72:  32%|███▏      | 100/313 [02:10<04:38,  0.77it/s, v_num=0, Train/loss_all_step=0.0209, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=0.705, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]Epoch 72:  32%|███▏      | 100/313 [02:10<04:38,  0.77it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]Epoch 72:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]Epoch 72:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0074, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000861, Train/loss_recog_step=0.654, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]Epoch 72:  64%|██████▍   | 200/313 [04:09<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.0074, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000861, Train/loss_recog_step=0.654, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]Epoch 72:  64%|██████▍   | 200/313 [04:09<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.00865, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00192, Train/loss_recog_step=0.673, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]Epoch 72:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00865, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00192, Train/loss_recog_step=0.673, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]Epoch 72:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.640, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661] Epoch 72:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.640, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]Epoch 72:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.661, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661] Epoch 72: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.661, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]Epoch 72: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.655, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.67it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.81it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183087, 0.186441, 0.188177, 0.200191
Valid average loss UNet                 (all)                : 0.757896

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060715, 1.864869, 3.460767
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.540592, 2.617238, 2.857579
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.287450, 2.296389, 2.614573
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.270823, 2.328874, 3.304192
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.249542, 2.659839, 3.566465
Valid average loss all      (Triplet)                 : 0.314041

== Recognize ==
Valid average loss Recognize     : 0.734949
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.321390

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.60877275466919 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.427369832992554 sec. =
Valid knn accuracy bass      : 33.064516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.028048753738403 sec. =
Valid knn accuracy piano     : 40.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.337697267532349 sec. =
Valid knn accuracy guitar    : 54.01785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.257016897201538 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 55.69562485200634%

                                                                      [AEpoch 72: 100%|██████████| 313/313 [07:43<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.655, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.661]Epoch 72: 100%|██████████| 313/313 [07:43<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.655, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188577, 0.188861, 0.187785, 0.194333
Train average loss UNet                 (all)                : 0.759556

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001712, 1.905932, 3.790623
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003930, 2.032656, 3.453682
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004166, 2.117998, 3.540604
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003367, 2.148953, 3.804637
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003941, 2.251390, 3.886696
Train average loss all      (Triplet)                 : 0.003458

== Recognize ==
Train average loss Recognize     : 0.662446
Train average accuracy drums     : 57.880001 %
Train average accuracy bass      : 53.950001 %
Train average accuracy piano     : 52.850002 %
Train average accuracy guitar    : 53.490002 %
Train average accuracy residuals : 55.055000 %

== Train average loss all : 0.010083

Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.655, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]          Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.655, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]Epoch 73:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.655, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]Epoch 73:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]Epoch 73:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]Epoch 73:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.0071, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.710, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662] Epoch 73:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.0071, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.710, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]Epoch 73:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.00737, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000373, Train/loss_recog_step=0.700, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]Epoch 73:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00737, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000373, Train/loss_recog_step=0.700, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]Epoch 73:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00685, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.685, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]   Epoch 73:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00685, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.685, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]Epoch 73:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]Epoch 73:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]Epoch 73:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00954, Train/loss_recog_step=0.679, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]Epoch 73: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00954, Train/loss_recog_step=0.679, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]Epoch 73: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.821, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.56it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.14it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.47it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.17it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.13it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183359, 0.186714, 0.188657, 0.201821
Valid average loss UNet                 (all)                : 0.760550

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.044748, 1.813771, 3.427523
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.509284, 2.572246, 2.621868
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.301710, 2.375619, 2.590785
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.300141, 2.371546, 3.269918
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.288139, 2.548936, 3.148631
Valid average loss all      (Triplet)                 : 0.314606

== Recognize ==
Valid average loss Recognize     : 0.671071
Valid average accuracy drums     : 56.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 57.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.321316

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.30632734298706 sec. =
Valid knn accuracy drums     : 86.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.267176628112793 sec. =
Valid knn accuracy bass      : 29.233870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.799026489257812 sec. =
Valid knn accuracy piano     : 42.3828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.91653299331665 sec. =
Valid knn accuracy guitar    : 41.964285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.311885833740234 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 53.15888158344111%

                                                                      [AEpoch 73: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=0.662]Epoch 73: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188342, 0.188641, 0.187564, 0.194893
Train average loss UNet                 (all)                : 0.759440

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000621, 1.894067, 3.745596
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006148, 2.053307, 3.432075
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005661, 2.105272, 3.495999
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002634, 2.112240, 3.716661
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002412, 2.197403, 3.775511
Train average loss all      (Triplet)                 : 0.003568

== Recognize ==
Train average loss Recognize     : 0.662176
Train average accuracy drums     : 58.095001 %
Train average accuracy bass      : 53.700001 %
Train average accuracy piano     : 53.175003 %
Train average accuracy guitar    : 53.890003 %
Train average accuracy residuals : 54.529999 %

== Train average loss all : 0.010190

Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]          Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]Epoch 74:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]Epoch 74:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00907, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00227, Train/loss_recog_step=0.680, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]Epoch 74:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00907, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00227, Train/loss_recog_step=0.680, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]Epoch 74:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]  Epoch 74:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]Epoch 74:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.693, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]Epoch 74:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.693, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]Epoch 74:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=0.666, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]Epoch 74:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=0.666, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]Epoch 74:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00457, Train/loss_recog_step=0.662, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]Epoch 74:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00457, Train/loss_recog_step=0.662, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]Epoch 74:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00944, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00275, Train/loss_recog_step=0.669, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]Epoch 74: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00944, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00275, Train/loss_recog_step=0.669, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]Epoch 74: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0053, Train/loss_recog_step=0.650, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.599, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.671, Valid/knn_avr=0.532, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.22it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.78it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.69it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183754, 0.187268, 0.188799, 0.189804
Valid average loss UNet                 (all)                : 0.749625

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.049762, 1.740205, 3.160130
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.435582, 2.510917, 2.688173
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.289595, 2.182519, 2.451149
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.269957, 2.233392, 3.088852
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.219520, 2.473333, 3.193845
Valid average loss all      (Triplet)                 : 0.276620

== Recognize ==
Valid average loss Recognize     : 0.771806
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 54.500000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.284338

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.380161046981812 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.251016855239868 sec. =
Valid knn accuracy bass      : 30.846774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.786519050598145 sec. =
Valid knn accuracy piano     : 42.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.40199613571167 sec. =
Valid knn accuracy guitar    : 47.99107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.491671085357666 sec. =
Valid knn accuracy residuals : 66.5909090909091%

Valid knn accuracy average   : 54.044990073040566%

                                                                      [AEpoch 74: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0053, Train/loss_recog_step=0.650, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00357, Train/loss_recog_epoch=0.662]Epoch 74: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0053, Train/loss_recog_step=0.650, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188040, 0.188348, 0.187281, 0.194689
Train average loss UNet                 (all)                : 0.758359

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000583, 1.856491, 3.651836
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004979, 2.050041, 3.450012
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004150, 2.075836, 3.504169
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002122, 2.084397, 3.714234
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002825, 2.179538, 3.746303
Train average loss all      (Triplet)                 : 0.002941

== Recognize ==
Train average loss Recognize     : 0.659634
Train average accuracy drums     : 58.520000 %
Train average accuracy bass      : 53.125000 %
Train average accuracy piano     : 52.705002 %
Train average accuracy guitar    : 54.320000 %
Train average accuracy residuals : 55.379997 %

== Train average loss all : 0.009537

Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0053, Train/loss_recog_step=0.650, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660]          Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0053, Train/loss_recog_step=0.650, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660]Epoch 75:  16%|█▌        | 50/313 [01:09<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0053, Train/loss_recog_step=0.650, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660]Epoch 75:  16%|█▌        | 50/313 [01:09<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660]Epoch 75:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660]Epoch 75:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.650, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660]Epoch 75:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.650, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660]Epoch 75:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660] Epoch 75:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660]Epoch 75:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00864, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00214, Train/loss_recog_step=0.650, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660]Epoch 75:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00864, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00214, Train/loss_recog_step=0.650, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660]Epoch 75:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00848, Train/loss_recog_step=0.618, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660] Epoch 75:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00848, Train/loss_recog_step=0.618, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660]Epoch 75:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660] Epoch 75: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660]Epoch 75: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00681, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.681, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.41it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.23it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.48it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.32it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.63it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184194, 0.187650, 0.189583, 0.201893
Valid average loss UNet                 (all)                : 0.763320

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.039921, 1.737167, 3.153863
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.435535, 2.475009, 2.657614
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.370483, 2.365419, 2.462428
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.235012, 2.238650, 3.198110
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.336938, 2.744147, 3.012716
Valid average loss all      (Triplet)                 : 0.296769

== Recognize ==
Valid average loss Recognize     : 0.725127
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.304020

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.33077073097229 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.625362873077393 sec. =
Valid knn accuracy bass      : 30.64516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.518547058105469 sec. =
Valid knn accuracy piano     : 35.7421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.304465532302856 sec. =
Valid knn accuracy guitar    : 56.91964285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.257259130477905 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 54.67918489075792%

                                                                      [AEpoch 75: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00681, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.681, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00954, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.660]Epoch 75: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00681, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.681, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188722, 0.189013, 0.187940, 0.194969
Train average loss UNet                 (all)                : 0.760645

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000979, 1.833441, 3.563140
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003709, 2.023937, 3.439352
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003914, 2.062094, 3.478544
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002432, 2.070875, 3.690900
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003082, 2.213928, 3.810923
Train average loss all      (Triplet)                 : 0.002854

== Recognize ==
Train average loss Recognize     : 0.656332
Train average accuracy drums     : 59.004997 %
Train average accuracy bass      : 54.415001 %
Train average accuracy piano     : 53.584999 %
Train average accuracy guitar    : 54.255001 %
Train average accuracy residuals : 55.239998 %

== Train average loss all : 0.009418

Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00681, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.681, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]          Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00681, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.681, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]Epoch 76:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00681, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.681, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]Epoch 76:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00439, Train/loss_recog_step=0.643, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]Epoch 76:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00439, Train/loss_recog_step=0.643, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]Epoch 76:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00668, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.668, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656] Epoch 76:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00668, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.668, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]Epoch 76:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=9.5e-5, Train/loss_recog_step=0.646, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]Epoch 76:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=9.5e-5, Train/loss_recog_step=0.646, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]Epoch 76:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.669, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656] Epoch 76:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.669, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]Epoch 76:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=0.610, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]Epoch 76:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=0.610, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]Epoch 76:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00473, Train/loss_recog_step=0.650, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]Epoch 76: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00473, Train/loss_recog_step=0.650, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]Epoch 76: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00888, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.677, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.725, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.31it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.72it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.95it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183813, 0.187099, 0.189404, 0.194116
Valid average loss UNet                 (all)                : 0.754432

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070514, 1.739199, 3.290153
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.390013, 2.396205, 2.661475
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.306416, 2.302089, 2.486946
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.268750, 2.291054, 3.258307
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.300504, 2.701196, 3.121219
Valid average loss all      (Triplet)                 : 0.278766

== Recognize ==
Valid average loss Recognize     : 0.731497
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.286081

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.39599084854126 sec. =
Valid knn accuracy drums     : 80.43478260869566%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.723975658416748 sec. =
Valid knn accuracy bass      : 26.411290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.65951156616211 sec. =
Valid knn accuracy piano     : 36.9140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.327998638153076 sec. =
Valid knn accuracy guitar    : 50.66964285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.564542293548584 sec. =
Valid knn accuracy residuals : 68.63636363636364%

Valid knn accuracy average   : 52.61322838495656%

                                                                      [AEpoch 76: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00888, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.677, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00285, Train/loss_recog_epoch=0.656]Epoch 76: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00888, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.677, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188847, 0.189119, 0.188049, 0.194407
Train average loss UNet                 (all)                : 0.760421

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000613, 1.847317, 3.651916
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003649, 1.974699, 3.359572
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004417, 2.048897, 3.428255
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003402, 2.049929, 3.613139
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002955, 2.192679, 3.755546
Train average loss all      (Triplet)                 : 0.002984

== Recognize ==
Train average loss Recognize     : 0.652172
Train average accuracy drums     : 60.230000 %
Train average accuracy bass      : 53.930004 %
Train average accuracy piano     : 54.235001 %
Train average accuracy guitar    : 54.275002 %
Train average accuracy residuals : 54.689999 %

== Train average loss all : 0.009505

Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00888, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.677, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]          Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00888, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.677, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]Epoch 77:  16%|█▌        | 50/313 [01:07<05:54,  0.74it/s, v_num=0, Train/loss_all_step=0.00888, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.677, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]Epoch 77:  16%|█▌        | 50/313 [01:07<05:54,  0.74it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]  Epoch 77:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]Epoch 77:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]Epoch 77:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]Epoch 77:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00838, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00151, Train/loss_recog_step=0.687, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]Epoch 77:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00838, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00151, Train/loss_recog_step=0.687, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]Epoch 77:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]  Epoch 77:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]Epoch 77:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00782, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00145, Train/loss_recog_step=0.637, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]Epoch 77:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00782, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00145, Train/loss_recog_step=0.637, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]Epoch 77:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]  Epoch 77: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]Epoch 77: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00695, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.695, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.71it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.69it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.63it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183810, 0.187160, 0.189002, 0.206181
Valid average loss UNet                 (all)                : 0.766153

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.049122, 1.726602, 3.168099
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.427711, 2.384996, 2.520011
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.324400, 2.328403, 2.548745
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.329733, 2.378565, 3.082148
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.299086, 2.650650, 3.126636
Valid average loss all      (Triplet)                 : 0.302248

== Recognize ==
Valid average loss Recognize     : 0.692185
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.309170

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.320701599121094 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.583825588226318 sec. =
Valid knn accuracy bass      : 32.86290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.537545680999756 sec. =
Valid knn accuracy piano     : 38.0859375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.353134155273438 sec. =
Valid knn accuracy guitar    : 52.00892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.696988821029663 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 55.20420208079088%

                                                                      [AEpoch 77: 100%|██████████| 313/313 [07:43<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00695, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.695, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00951, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.652]Epoch 77: 100%|██████████| 313/313 [07:43<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00695, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.695, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188590, 0.188897, 0.187795, 0.195030
Train average loss UNet                 (all)                : 0.760311

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000836, 1.842215, 3.668728
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005815, 2.024814, 3.356003
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002809, 2.050829, 3.443885
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004021, 2.105238, 3.716974
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003729, 2.205283, 3.764904
Train average loss all      (Triplet)                 : 0.003491

== Recognize ==
Train average loss Recognize     : 0.656645
Train average accuracy drums     : 59.785004 %
Train average accuracy bass      : 54.275002 %
Train average accuracy piano     : 53.065002 %
Train average accuracy guitar    : 54.065002 %
Train average accuracy residuals : 54.799999 %

== Train average loss all : 0.010057

Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00695, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.695, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]          Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00695, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.695, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]Epoch 78:  16%|█▌        | 50/313 [01:07<05:52,  0.75it/s, v_num=0, Train/loss_all_step=0.00695, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.695, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]Epoch 78:  16%|█▌        | 50/313 [01:07<05:52,  0.75it/s, v_num=0, Train/loss_all_step=0.0094, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=0.696, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]Epoch 78:  32%|███▏      | 100/313 [02:06<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.0094, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=0.696, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]Epoch 78:  32%|███▏      | 100/313 [02:06<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000278, Train/loss_recog_step=0.639, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]Epoch 78:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000278, Train/loss_recog_step=0.639, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]Epoch 78:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00649, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.649, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]   Epoch 78:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00649, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.649, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]Epoch 78:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00848, Train/loss_recog_step=0.684, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]Epoch 78:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00848, Train/loss_recog_step=0.684, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]Epoch 78:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000385, Train/loss_recog_step=0.628, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]Epoch 78:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000385, Train/loss_recog_step=0.628, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]Epoch 78:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00603, Train/loss_recog_step=0.678, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]  Epoch 78: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00603, Train/loss_recog_step=0.678, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]Epoch 78: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00365, Train/loss_recog_step=0.732, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.639, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.53it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.98it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.79it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.65it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183331, 0.186618, 0.188583, 0.188436
Valid average loss UNet                 (all)                : 0.746968

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.035881, 1.738115, 3.323695
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.478017, 2.509235, 2.605259
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.290135, 2.284317, 2.553060
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.336530, 2.283918, 3.058655
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.313063, 2.626757, 3.414496
Valid average loss all      (Triplet)                 : 0.320210

== Recognize ==
Valid average loss Recognize     : 0.746585
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.327675

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.51645016670227 sec. =
Valid knn accuracy drums     : 84.1304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.314895868301392 sec. =
Valid knn accuracy bass      : 34.87903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.807471990585327 sec. =
Valid knn accuracy piano     : 47.4609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.369298458099365 sec. =
Valid knn accuracy guitar    : 53.79464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.315279960632324 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 57.64391857047231%

                                                                      [AEpoch 78: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00365, Train/loss_recog_step=0.732, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=0.657]Epoch 78: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00365, Train/loss_recog_step=0.732, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188611, 0.188901, 0.187816, 0.194995
Train average loss UNet                 (all)                : 0.760324

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000755, 1.861497, 3.740465
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004549, 2.032478, 3.404473
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002391, 2.089747, 3.519224
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003151, 2.118903, 3.763527
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002766, 2.242942, 3.888899
Train average loss all      (Triplet)                 : 0.002802

== Recognize ==
Train average loss Recognize     : 0.654816
Train average accuracy drums     : 60.105003 %
Train average accuracy bass      : 53.850002 %
Train average accuracy piano     : 53.259998 %
Train average accuracy guitar    : 54.149998 %
Train average accuracy residuals : 55.344997 %

== Train average loss all : 0.009350

Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00365, Train/loss_recog_step=0.732, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]          Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00365, Train/loss_recog_step=0.732, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]Epoch 79:  16%|█▌        | 50/313 [01:09<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00365, Train/loss_recog_step=0.732, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]Epoch 79:  16%|█▌        | 50/313 [01:09<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.0199, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=0.681, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]Epoch 79:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.0199, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=0.681, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]Epoch 79:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.0091, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00271, Train/loss_recog_step=0.639, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]Epoch 79:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0091, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00271, Train/loss_recog_step=0.639, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]Epoch 79:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00914, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00244, Train/loss_recog_step=0.670, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]Epoch 79:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00914, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00244, Train/loss_recog_step=0.670, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]Epoch 79:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.656, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]  Epoch 79:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.656, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]Epoch 79:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000529, Train/loss_recog_step=0.643, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]Epoch 79:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000529, Train/loss_recog_step=0.643, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]Epoch 79:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]   Epoch 79: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]Epoch 79: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00711, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.711, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.725, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.08it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.16it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  2.97it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.67it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.56it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183504, 0.186870, 0.188606, 0.188490
Valid average loss UNet                 (all)                : 0.747470

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.059035, 1.753275, 3.351404
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.418679, 2.249406, 2.519298
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.311263, 2.232781, 2.384774
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.288427, 2.153283, 3.049353
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.236601, 2.551002, 3.042982
Valid average loss all      (Triplet)                 : 0.281587

== Recognize ==
Valid average loss Recognize     : 0.749233
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.289079

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.56849193572998 sec. =
Valid knn accuracy drums     : 78.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.588632345199585 sec. =
Valid knn accuracy bass      : 30.241935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.039016962051392 sec. =
Valid knn accuracy piano     : 42.96875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.642571926116943 sec. =
Valid knn accuracy guitar    : 51.11607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.306464195251465 sec. =
Valid knn accuracy residuals : 69.0909090909091%

Valid knn accuracy average   : 54.335707113713774%

                                                                      [AEpoch 79: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00711, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.711, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00935, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.655]Epoch 79: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00711, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.711, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188393, 0.188688, 0.187597, 0.194712
Train average loss UNet                 (all)                : 0.759390

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001106, 1.859814, 3.678692
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005570, 2.012934, 3.383480
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003670, 2.094277, 3.518883
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002992, 2.098623, 3.720761
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003378, 2.247938, 3.857821
Train average loss all      (Triplet)                 : 0.003349

== Recognize ==
Train average loss Recognize     : 0.655673
Train average accuracy drums     : 61.559998 %
Train average accuracy bass      : 53.825005 %
Train average accuracy piano     : 53.250004 %
Train average accuracy guitar    : 54.425003 %
Train average accuracy residuals : 54.375000 %

== Train average loss all : 0.009905

Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00711, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.711, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]          Epoch 80:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00711, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.711, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]Epoch 80:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00711, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.711, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]Epoch 80:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00808, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00171, Train/loss_recog_step=0.637, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]Epoch 80:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00808, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00171, Train/loss_recog_step=0.637, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]Epoch 80:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]  Epoch 80:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]Epoch 80:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000326, Train/loss_recog_step=0.660, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]Epoch 80:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000326, Train/loss_recog_step=0.660, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]Epoch 80:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00749, Train/loss_recog_step=0.674, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]  Epoch 80:  80%|███████▉  | 250/313 [05:03<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00749, Train/loss_recog_step=0.674, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]Epoch 80:  80%|███████▉  | 250/313 [05:03<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]  Epoch 80:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]Epoch 80:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00746, Train/loss_recog_step=0.689, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]Epoch 80: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00746, Train/loss_recog_step=0.689, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]Epoch 80: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.656, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.715, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.850, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.30it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.84it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.22it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.05it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.42it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:03<00:00,  2.28it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183864, 0.187274, 0.189082, 0.203582
Valid average loss UNet                 (all)                : 0.763802

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.032737, 1.732637, 3.150595
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.433194, 2.405737, 2.656432
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.333656, 2.330499, 2.698453
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.312676, 2.353024, 3.258984
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.292394, 2.767960, 3.363859
Valid average loss all      (Triplet)                 : 0.305754

== Recognize ==
Valid average loss Recognize     : 0.680470
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.312559

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.496362209320068 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.406080722808838 sec. =
Valid knn accuracy bass      : 33.46774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.45186996459961 sec. =
Valid knn accuracy piano     : 44.3359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.56431245803833 sec. =
Valid knn accuracy guitar    : 50.44642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.28665018081665 sec. =
Valid knn accuracy residuals : 66.81818181818183%

Valid knn accuracy average   : 55.44844057371451%

                                                                      [AEpoch 80: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.656, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.656]Epoch 80: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.656, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188681, 0.188989, 0.187882, 0.194956
Train average loss UNet                 (all)                : 0.760507

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000930, 1.849387, 3.673500
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004200, 1.991877, 3.344457
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004952, 2.060193, 3.455817
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003443, 2.042140, 3.633880
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003188, 2.202211, 3.787203
Train average loss all      (Triplet)                 : 0.003382

== Recognize ==
Train average loss Recognize     : 0.651854
Train average accuracy drums     : 59.925003 %
Train average accuracy bass      : 54.350002 %
Train average accuracy piano     : 53.539997 %
Train average accuracy guitar    : 54.630001 %
Train average accuracy residuals : 55.465000 %

== Train average loss all : 0.009900

Epoch 80:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.656, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]          Epoch 81:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.656, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]Epoch 81:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.656, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]Epoch 81:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.00935, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00292, Train/loss_recog_step=0.643, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]Epoch 81:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.00935, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00292, Train/loss_recog_step=0.643, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]Epoch 81:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000278, Train/loss_recog_step=0.618, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]Epoch 81:  48%|████▊     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000278, Train/loss_recog_step=0.618, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]Epoch 81:  48%|████▊     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00769, Train/loss_recog_step=0.703, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]  Epoch 81:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00769, Train/loss_recog_step=0.703, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]Epoch 81:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.00979, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00316, Train/loss_recog_step=0.663, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]Epoch 81:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00979, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00316, Train/loss_recog_step=0.663, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]Epoch 81:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.0061, Train/loss_recog_step=0.639, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]  Epoch 81:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.0061, Train/loss_recog_step=0.639, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]Epoch 81:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00446, Train/loss_recog_step=0.671, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]Epoch 81: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00446, Train/loss_recog_step=0.671, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]Epoch 81: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.571, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.554, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.75it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.71it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.89it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.62it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183982, 0.187361, 0.189186, 0.198375
Valid average loss UNet                 (all)                : 0.758904

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.053488, 1.750312, 3.119959
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.476548, 2.399750, 2.585123
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.360395, 2.454671, 2.626025
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.263929, 2.381656, 3.326640
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.314922, 2.742014, 3.235913
Valid average loss all      (Triplet)                 : 0.315028

== Recognize ==
Valid average loss Recognize     : 0.718996
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.322218

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.438910007476807 sec. =
Valid knn accuracy drums     : 82.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.353819131851196 sec. =
Valid knn accuracy bass      : 20.766129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.584171056747437 sec. =
Valid knn accuracy piano     : 44.53125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.637168169021606 sec. =
Valid knn accuracy guitar    : 54.24107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.3557767868042 sec. =
Valid knn accuracy residuals : 70.22727272727273%

Valid knn accuracy average   : 54.51836202892479%

                                                                      [AEpoch 81: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.0099, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.652]Epoch 81: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188925, 0.189210, 0.188122, 0.193978
Train average loss UNet                 (all)                : 0.760234

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000710, 1.836208, 3.607892
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003756, 2.008360, 3.397460
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005844, 2.109716, 3.511537
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003680, 2.068917, 3.658469
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003480, 2.220257, 3.817103
Train average loss all      (Triplet)                 : 0.003318

== Recognize ==
Train average loss Recognize     : 0.656065
Train average accuracy drums     : 60.840000 %
Train average accuracy bass      : 54.014999 %
Train average accuracy piano     : 53.609997 %
Train average accuracy guitar    : 54.205002 %
Train average accuracy residuals : 55.005001 %

== Train average loss all : 0.009879

Epoch 81:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]          Epoch 82:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]Epoch 82:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]Epoch 82:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.669, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]Epoch 82:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.669, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]Epoch 82:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.0072, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000416, Train/loss_recog_step=0.679, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]Epoch 82:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0072, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000416, Train/loss_recog_step=0.679, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]Epoch 82:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00649, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.649, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]  Epoch 82:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.00649, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.649, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]Epoch 82:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.00976, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00321, Train/loss_recog_step=0.655, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]Epoch 82:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00976, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00321, Train/loss_recog_step=0.655, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]Epoch 82:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00805, Train/loss_recog_step=0.624, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656] Epoch 82:  96%|█████████▌| 300/313 [06:09<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00805, Train/loss_recog_step=0.624, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]Epoch 82:  96%|█████████▌| 300/313 [06:09<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656] Epoch 82: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]Epoch 82: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0263, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=0.647, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.36it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.32it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:04<00:00,  1.99it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.67it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183528, 0.186856, 0.188799, 0.202444
Valid average loss UNet                 (all)                : 0.761627

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.039792, 1.753731, 3.337186
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.405550, 2.443327, 2.750481
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.309760, 2.233414, 2.483420
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.386069, 2.362483, 3.012081
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.278214, 2.636284, 3.455880
Valid average loss all      (Triplet)                 : 0.301392

== Recognize ==
Valid average loss Recognize     : 0.730629
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.308699

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.48792028427124 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.319181203842163 sec. =
Valid knn accuracy bass      : 29.838709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.97648811340332 sec. =
Valid knn accuracy piano     : 44.921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.438914775848389 sec. =
Valid knn accuracy guitar    : 50.44642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.629847764968872 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 55.241007392852595%

                                                                      [AEpoch 82: 100%|██████████| 313/313 [08:04<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.0263, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=0.647, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00988, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00332, Train/loss_recog_epoch=0.656]Epoch 82: 100%|██████████| 313/313 [08:04<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.0263, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=0.647, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188478, 0.188772, 0.187688, 0.194083
Train average loss UNet                 (all)                : 0.759021

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001243, 1.821391, 3.555869
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004845, 2.008985, 3.400908
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002340, 2.067066, 3.489485
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003326, 2.054605, 3.654576
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003363, 2.236019, 3.838131
Train average loss all      (Triplet)                 : 0.003139

== Recognize ==
Train average loss Recognize     : 0.650308
Train average accuracy drums     : 61.070000 %
Train average accuracy bass      : 54.759998 %
Train average accuracy piano     : 54.325001 %
Train average accuracy guitar    : 54.830002 %
Train average accuracy residuals : 55.164997 %

== Train average loss all : 0.009642

Epoch 82:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0263, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=0.647, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]          Epoch 83:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0263, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=0.647, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]Epoch 83:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.0263, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=0.647, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]Epoch 83:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00692, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000425, Train/loss_recog_step=0.649, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]Epoch 83:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00692, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000425, Train/loss_recog_step=0.649, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]Epoch 83:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]   Epoch 83:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]Epoch 83:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.0159, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00927, Train/loss_recog_step=0.666, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]Epoch 83:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.0159, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00927, Train/loss_recog_step=0.666, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]Epoch 83:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00739, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.739, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650] Epoch 83:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00739, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.739, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]Epoch 83:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.015, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00856, Train/loss_recog_step=0.641, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]Epoch 83:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.015, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00856, Train/loss_recog_step=0.641, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]Epoch 83:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00716, Train/loss_recog_step=0.663, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]Epoch 83: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00716, Train/loss_recog_step=0.663, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]Epoch 83: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.04it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.82it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184484, 0.187804, 0.189826, 0.200330
Valid average loss UNet                 (all)                : 0.762444

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.056769, 1.812780, 3.459985
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.339523, 2.415142, 2.682881
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.400670, 2.402122, 2.589319
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.355670, 2.393231, 3.045676
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.313126, 2.697347, 3.499428
Valid average loss all      (Triplet)                 : 0.297407

== Recognize ==
Valid average loss Recognize     : 0.730652
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 58.499996 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.304714

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.350194215774536 sec. =
Valid knn accuracy drums     : 83.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.737087965011597 sec. =
Valid knn accuracy bass      : 30.846774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.81767463684082 sec. =
Valid knn accuracy piano     : 42.7734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.408880949020386 sec. =
Valid knn accuracy guitar    : 50.89285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.608151912689209 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 54.82356238388191%

                                                                      [AEpoch 83: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00964, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=0.650]Epoch 83: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188479, 0.188794, 0.187695, 0.194610
Train average loss UNet                 (all)                : 0.759578

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000693, 1.898271, 3.807353
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003861, 2.060949, 3.511788
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003039, 2.106523, 3.527370
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002747, 2.129844, 3.714810
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003604, 2.302015, 3.948493
Train average loss all      (Triplet)                 : 0.002784

== Recognize ==
Train average loss Recognize     : 0.654724
Train average accuracy drums     : 59.605003 %
Train average accuracy bass      : 53.990002 %
Train average accuracy piano     : 54.020000 %
Train average accuracy guitar    : 53.805000 %
Train average accuracy residuals : 55.119999 %

== Train average loss all : 0.009332

Epoch 83:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]          Epoch 84:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]Epoch 84:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]Epoch 84:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.0204, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=0.652, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]Epoch 84:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.0204, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=0.652, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]Epoch 84:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655] Epoch 84:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]Epoch 84:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00668, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.668, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]Epoch 84:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00668, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.668, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]Epoch 84:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00699, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.699, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]Epoch 84:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00699, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.699, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]Epoch 84:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]Epoch 84:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]Epoch 84:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00422, Train/loss_recog_step=0.661, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]Epoch 84: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00422, Train/loss_recog_step=0.661, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]Epoch 84: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.03it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.54it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.31it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.17it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.55it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184484, 0.187823, 0.189600, 0.199298
Valid average loss UNet                 (all)                : 0.761205

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.041613, 1.797906, 3.460808
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.375787, 2.562041, 2.928222
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.449938, 2.640163, 2.729945
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.388859, 2.537147, 3.296740
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.302360, 2.808569, 3.641949
Valid average loss all      (Triplet)                 : 0.318586

== Recognize ==
Valid average loss Recognize     : 0.711504
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 60.000004 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 40.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.325701

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.409287214279175 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.594189167022705 sec. =
Valid knn accuracy bass      : 29.233870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.68431305885315 sec. =
Valid knn accuracy piano     : 46.6796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.374516010284424 sec. =
Valid knn accuracy guitar    : 51.5625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.412626504898071 sec. =
Valid knn accuracy residuals : 70.22727272727273%

Valid knn accuracy average   : 55.97544884769859%

                                                                      [AEpoch 84: 100%|██████████| 313/313 [07:43<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00278, Train/loss_recog_epoch=0.655]Epoch 84: 100%|██████████| 313/313 [07:43<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188948, 0.189257, 0.188156, 0.194619
Train average loss UNet                 (all)                : 0.760980

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000367, 1.866370, 3.789775
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003232, 2.050306, 3.523043
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004275, 2.127093, 3.580453
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002852, 2.184413, 3.815780
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002830, 2.317530, 4.002169
Train average loss all      (Triplet)                 : 0.002839

== Recognize ==
Train average loss Recognize     : 0.655476
Train average accuracy drums     : 60.869999 %
Train average accuracy bass      : 53.869999 %
Train average accuracy piano     : 52.880001 %
Train average accuracy guitar    : 54.959999 %
Train average accuracy residuals : 54.989998 %

== Train average loss all : 0.009394

Epoch 84:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]          Epoch 85:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]Epoch 85:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]Epoch 85:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]Epoch 85:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]Epoch 85:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000275, Train/loss_recog_step=0.640, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]Epoch 85:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000275, Train/loss_recog_step=0.640, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]Epoch 85:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00826, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00181, Train/loss_recog_step=0.646, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655] Epoch 85:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00826, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00181, Train/loss_recog_step=0.646, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]Epoch 85:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]  Epoch 85:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]Epoch 85:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00595, Train/loss_recog_step=0.628, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]Epoch 85:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00595, Train/loss_recog_step=0.628, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]Epoch 85:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00999, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.627, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]Epoch 85: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00999, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.627, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]Epoch 85: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0068, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.680, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.43it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.94it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.66it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.25it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184341, 0.187647, 0.189665, 0.200152
Valid average loss UNet                 (all)                : 0.761805

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.066905, 1.771245, 3.357392
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.381793, 2.393316, 2.770969
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.372790, 2.376037, 2.500403
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.263009, 2.232635, 3.003596
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.241857, 2.511416, 3.180923
Valid average loss all      (Triplet)                 : 0.273750

== Recognize ==
Valid average loss Recognize     : 0.713127
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.280882

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.317484617233276 sec. =
Valid knn accuracy drums     : 78.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.378665924072266 sec. =
Valid knn accuracy bass      : 29.838709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.785091638565063 sec. =
Valid knn accuracy piano     : 40.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.369933843612671 sec. =
Valid knn accuracy guitar    : 44.642857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.258013248443604 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 51.98969281069561%

                                                                      [AEpoch 85: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0068, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.680, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00939, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.655]Epoch 85: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0068, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.680, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188654, 0.188957, 0.187849, 0.194866
Train average loss UNet                 (all)                : 0.760326

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000529, 1.843168, 3.721854
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004979, 2.101105, 3.553487
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003482, 2.183461, 3.703965
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003064, 2.141310, 3.777682
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003990, 2.336356, 4.026319
Train average loss all      (Triplet)                 : 0.003276

== Recognize ==
Train average loss Recognize     : 0.657450
Train average accuracy drums     : 61.129997 %
Train average accuracy bass      : 54.065002 %
Train average accuracy piano     : 52.799999 %
Train average accuracy guitar    : 53.270000 %
Train average accuracy residuals : 55.365002 %

== Train average loss all : 0.009851

Epoch 85:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0068, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.680, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]          Epoch 86:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0068, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.680, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]Epoch 86:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.0068, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.680, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]Epoch 86:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.00813, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00178, Train/loss_recog_step=0.635, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]Epoch 86:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00813, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00178, Train/loss_recog_step=0.635, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]Epoch 86:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000533, Train/loss_recog_step=0.647, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]Epoch 86:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000533, Train/loss_recog_step=0.647, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]Epoch 86:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0169, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.672, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]   Epoch 86:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0169, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.672, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]Epoch 86:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00774, Train/loss_recog_step=0.649, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]Epoch 86:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00774, Train/loss_recog_step=0.649, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]Epoch 86:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657] Epoch 86:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]Epoch 86:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00373, Train/loss_recog_step=0.667, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]Epoch 86: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00373, Train/loss_recog_step=0.667, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]Epoch 86: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.143, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.18it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.92it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.33it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.26it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.84it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183863, 0.187275, 0.188998, 0.196027
Valid average loss UNet                 (all)                : 0.756163

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.034450, 1.792808, 3.534511
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.334632, 2.392927, 2.714559
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.336596, 2.372414, 2.649321
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.283137, 2.378362, 3.206059
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.332072, 2.510868, 3.111557
Valid average loss all      (Triplet)                 : 0.264646

== Recognize ==
Valid average loss Recognize     : 0.720460
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.271851

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.38956618309021 sec. =
Valid knn accuracy drums     : 82.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.24119782447815 sec. =
Valid knn accuracy bass      : 30.241935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.307904243469238 sec. =
Valid knn accuracy piano     : 39.2578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.439316272735596 sec. =
Valid knn accuracy guitar    : 45.089285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.19684362411499 sec. =
Valid knn accuracy residuals : 72.5%

Valid knn accuracy average   : 53.896067609196564%

                                                                      [AEpoch 86: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00985, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=0.657]Epoch 86: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188755, 0.189047, 0.187943, 0.194772
Train average loss UNet                 (all)                : 0.760517

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000879, 1.807107, 3.637070
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003094, 2.041465, 3.432037
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004618, 2.119642, 3.569412
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002307, 2.085079, 3.714857
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002864, 2.272655, 3.983703
Train average loss all      (Triplet)                 : 0.002738

== Recognize ==
Train average loss Recognize     : 0.653759
Train average accuracy drums     : 63.134998 %
Train average accuracy bass      : 53.500004 %
Train average accuracy piano     : 52.590000 %
Train average accuracy guitar    : 54.075005 %
Train average accuracy residuals : 54.739998 %

== Train average loss all : 0.009275

Epoch 86:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654]          Epoch 87:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654]Epoch 87:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654]Epoch 87:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.00803, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00115, Train/loss_recog_step=0.687, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654]Epoch 87:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.00803, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00115, Train/loss_recog_step=0.687, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654]Epoch 87:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000149, Train/loss_recog_step=0.654, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654]Epoch 87:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000149, Train/loss_recog_step=0.654, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654]Epoch 87:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.00987, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00339, Train/loss_recog_step=0.649, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654] Epoch 87:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.00987, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00339, Train/loss_recog_step=0.649, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654]Epoch 87:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.00788, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000726, Train/loss_recog_step=0.716, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654]Epoch 87:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00788, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000726, Train/loss_recog_step=0.716, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654]Epoch 87:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000419, Train/loss_recog_step=0.620, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654]Epoch 87:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000419, Train/loss_recog_step=0.620, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654]Epoch 87:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00963, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00263, Train/loss_recog_step=0.700, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654] Epoch 87: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00963, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00263, Train/loss_recog_step=0.700, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654]Epoch 87: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00998, Train/loss_recog_step=0.674, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.0966, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.539, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.37it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.10it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.94it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.65it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184524, 0.187897, 0.189742, 0.205264
Valid average loss UNet                 (all)                : 0.767427

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.054108, 1.848186, 3.410443
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.323085, 2.508410, 2.915565
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.461317, 2.530358, 2.623911
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.347846, 2.568210, 3.502638
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.286259, 2.548662, 3.107236
Valid average loss all      (Triplet)                 : 0.292011

== Recognize ==
Valid average loss Recognize     : 0.718544
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.299197

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.816619634628296 sec. =
Valid knn accuracy drums     : 78.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.301250457763672 sec. =
Valid knn accuracy bass      : 33.266129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.496713161468506 sec. =
Valid knn accuracy piano     : 45.1171875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.656913757324219 sec. =
Valid knn accuracy guitar    : 44.19642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.346102952957153 sec. =
Valid knn accuracy residuals : 69.31818181818183%

Valid knn accuracy average   : 54.03175929741717%

                                                                      [AEpoch 87: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00998, Train/loss_recog_step=0.674, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00928, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=0.654]Epoch 87: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00998, Train/loss_recog_step=0.674, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188352, 0.188639, 0.187552, 0.194759
Train average loss UNet                 (all)                : 0.759301

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001042, 1.845872, 3.701352
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003152, 2.067722, 3.502296
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003469, 2.132046, 3.617427
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002624, 2.141879, 3.834204
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003126, 2.301556, 3.979347
Train average loss all      (Triplet)                 : 0.002716

== Recognize ==
Train average loss Recognize     : 0.655546
Train average accuracy drums     : 61.084999 %
Train average accuracy bass      : 54.084999 %
Train average accuracy piano     : 53.235001 %
Train average accuracy guitar    : 53.880001 %
Train average accuracy residuals : 54.615002 %

== Train average loss all : 0.009272

Epoch 87:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00998, Train/loss_recog_step=0.674, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]          Epoch 88:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00998, Train/loss_recog_step=0.674, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]Epoch 88:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00998, Train/loss_recog_step=0.674, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]Epoch 88:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656] Epoch 88:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]Epoch 88:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]Epoch 88:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]Epoch 88:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]Epoch 88:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]Epoch 88:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00437, Train/loss_recog_step=0.706, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]Epoch 88:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00437, Train/loss_recog_step=0.706, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]Epoch 88:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000899, Train/loss_recog_step=0.608, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]Epoch 88:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000899, Train/loss_recog_step=0.608, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]Epoch 88:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.007, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00038, Train/loss_recog_step=0.662, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]   Epoch 88: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.007, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00038, Train/loss_recog_step=0.662, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]Epoch 88: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.696, Valid/loss_all_step=0.0819, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.0746, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.37it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.00it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  2.97it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.93it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183767, 0.187129, 0.189198, 0.191490
Valid average loss UNet                 (all)                : 0.751583

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061563, 1.871552, 3.388367
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.444427, 2.687040, 3.154351
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.445641, 2.700035, 2.707957
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.304193, 2.590300, 3.507952
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.333642, 2.915575, 3.480441
Valid average loss all      (Triplet)                 : 0.332757

== Recognize ==
Valid average loss Recognize     : 0.736078
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 42.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.340118

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.886906862258911 sec. =
Valid knn accuracy drums     : 80.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.041716575622559 sec. =
Valid knn accuracy bass      : 31.048387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.571764469146729 sec. =
Valid knn accuracy piano     : 43.1640625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.661971807479858 sec. =
Valid knn accuracy guitar    : 47.098214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.40132737159729 sec. =
Valid knn accuracy residuals : 70.9090909090909%

Valid knn accuracy average   : 54.487429219185444%

                                                                      [AEpoch 88: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.696, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00927, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=0.656]  Epoch 88: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.696, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188340, 0.188639, 0.187544, 0.194303
Train average loss UNet                 (all)                : 0.758826

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000494, 1.859755, 3.724935
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003266, 2.082683, 3.542653
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003708, 2.176985, 3.640931
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004470, 2.194904, 3.828946
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002318, 2.337066, 4.028529
Train average loss all      (Triplet)                 : 0.002794

== Recognize ==
Train average loss Recognize     : 0.654466
Train average accuracy drums     : 61.095001 %
Train average accuracy bass      : 53.880001 %
Train average accuracy piano     : 53.700001 %
Train average accuracy guitar    : 54.565002 %
Train average accuracy residuals : 54.739998 %

== Train average loss all : 0.009338

Epoch 88:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.696, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]          Epoch 89:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.696, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]Epoch 89:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.696, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]Epoch 89:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]Epoch 89:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]Epoch 89:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.0168, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.619, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]Epoch 89:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0168, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.619, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]Epoch 89:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00619, Train/loss_recog_step=0.676, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]Epoch 89:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00619, Train/loss_recog_step=0.676, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]Epoch 89:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00913, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00199, Train/loss_recog_step=0.714, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]Epoch 89:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00913, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00199, Train/loss_recog_step=0.714, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]Epoch 89:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00692, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000461, Train/loss_recog_step=0.645, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]Epoch 89:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00692, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000461, Train/loss_recog_step=0.645, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]Epoch 89:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00377, Train/loss_recog_step=0.656, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]  Epoch 89: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00377, Train/loss_recog_step=0.656, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]Epoch 89: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00921, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00258, Train/loss_recog_step=0.664, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.813, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.28it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.02it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.04it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182901, 0.186199, 0.188138, 0.199432
Valid average loss UNet                 (all)                : 0.756670

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.046725, 1.787641, 3.473131
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.294867, 2.501983, 2.910239
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.329304, 2.379622, 2.693032
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.325610, 2.493705, 3.263689
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.343501, 2.740550, 3.321813
Valid average loss all      (Triplet)                 : 0.265201

== Recognize ==
Valid average loss Recognize     : 0.709359
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 43.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.272294

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.42670464515686 sec. =
Valid knn accuracy drums     : 80.8695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.541210889816284 sec. =
Valid knn accuracy bass      : 32.45967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.453530073165894 sec. =
Valid knn accuracy piano     : 40.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.29522180557251 sec. =
Valid knn accuracy guitar    : 43.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.40086054801941 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 52.6963883000765%

                                                                      [AEpoch 89: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00921, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00258, Train/loss_recog_step=0.664, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00934, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=0.654]Epoch 89: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00921, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00258, Train/loss_recog_step=0.664, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188349, 0.188643, 0.187573, 0.194783
Train average loss UNet                 (all)                : 0.759349

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000884, 1.892632, 3.731944
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003635, 2.157697, 3.670065
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004284, 2.257966, 3.801941
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004490, 2.272646, 3.978215
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002134, 2.382040, 4.113451
Train average loss all      (Triplet)                 : 0.003090

== Recognize ==
Train average loss Recognize     : 0.661377
Train average accuracy drums     : 60.869999 %
Train average accuracy bass      : 53.385002 %
Train average accuracy piano     : 52.920002 %
Train average accuracy guitar    : 52.875000 %
Train average accuracy residuals : 54.345001 %

== Train average loss all : 0.009704

Epoch 89:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00921, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00258, Train/loss_recog_step=0.664, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661]          Epoch 90:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00921, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00258, Train/loss_recog_step=0.664, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661]Epoch 90:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00921, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00258, Train/loss_recog_step=0.664, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661]Epoch 90:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00731, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00115, Train/loss_recog_step=0.616, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661]Epoch 90:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00731, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00115, Train/loss_recog_step=0.616, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661]Epoch 90:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=0.671, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661] Epoch 90:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=0.671, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661]Epoch 90:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0085, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00242, Train/loss_recog_step=0.608, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661]Epoch 90:  64%|██████▍   | 200/313 [04:04<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0085, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00242, Train/loss_recog_step=0.608, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661]Epoch 90:  64%|██████▍   | 200/313 [04:04<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661] Epoch 90:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661]Epoch 90:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.00487, Train/loss_recog_step=0.628, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661]Epoch 90:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.00487, Train/loss_recog_step=0.628, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661]Epoch 90:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00665, Train/loss_recog_step=0.656, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661]Epoch 90: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00665, Train/loss_recog_step=0.656, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661]Epoch 90: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.691, Valid/loss_all_step=0.0757, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.069, Valid/loss_recog_step=0.667, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.709, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.94it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.47it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.72it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184590, 0.187939, 0.189910, 0.199070
Valid average loss UNet                 (all)                : 0.761509

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065531, 1.816302, 3.215873
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.330626, 2.331415, 2.677008
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.354398, 2.330660, 2.620062
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.363240, 2.534927, 3.063154
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.326387, 2.527832, 2.909992
Valid average loss all      (Triplet)                 : 0.287561

== Recognize ==
Valid average loss Recognize     : 0.666397
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 58.999996 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.294225

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.949487209320068 sec. =
Valid knn accuracy drums     : 84.1304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.754812002182007 sec. =
Valid knn accuracy bass      : 32.056451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.825271129608154 sec. =
Valid knn accuracy piano     : 41.6015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.245506763458252 sec. =
Valid knn accuracy guitar    : 43.30357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.231098651885986 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 54.17294951936212%

                                                                      [AEpoch 90: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.691, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0097, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=0.661] Epoch 90: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.691, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188613, 0.188922, 0.187831, 0.194309
Train average loss UNet                 (all)                : 0.759675

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000861, 1.874441, 3.792843
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003958, 2.114761, 3.580271
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004201, 2.159336, 3.678259
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003047, 2.196827, 3.893449
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002153, 2.281548, 3.950654
Train average loss all      (Triplet)                 : 0.002935

== Recognize ==
Train average loss Recognize     : 0.651954
Train average accuracy drums     : 61.830002 %
Train average accuracy bass      : 53.974998 %
Train average accuracy piano     : 53.084999 %
Train average accuracy guitar    : 54.060001 %
Train average accuracy residuals : 55.325001 %

== Train average loss all : 0.009455

Epoch 90:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.691, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]          Epoch 91:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.691, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]Epoch 91:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.691, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]Epoch 91:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00058, Train/loss_recog_step=0.639, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]Epoch 91:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00058, Train/loss_recog_step=0.639, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]Epoch 91:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00544, Train/loss_recog_step=0.639, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652] Epoch 91:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00544, Train/loss_recog_step=0.639, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]Epoch 91:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00938, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00311, Train/loss_recog_step=0.628, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]Epoch 91:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00938, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00311, Train/loss_recog_step=0.628, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]Epoch 91:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00664, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.664, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]  Epoch 91:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00664, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.664, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]Epoch 91:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00825, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.619, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]Epoch 91:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00825, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.619, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]Epoch 91:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]  Epoch 91: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]Epoch 91: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0284, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=0.683, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.537, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.31it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.15it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.40it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.41it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183792, 0.187121, 0.189131, 0.201084
Valid average loss UNet                 (all)                : 0.761127

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.059299, 1.931410, 3.594331
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.385692, 2.548359, 2.845391
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.321581, 2.345215, 2.653566
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.350557, 2.568757, 3.440585
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.346553, 2.632621, 3.156362
Valid average loss all      (Triplet)                 : 0.296211

== Recognize ==
Valid average loss Recognize     : 0.723595
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.303447

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.330283164978027 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.27428674697876 sec. =
Valid knn accuracy bass      : 30.64516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.797719717025757 sec. =
Valid knn accuracy piano     : 49.21875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.362342596054077 sec. =
Valid knn accuracy guitar    : 45.75892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.322543144226074 sec. =
Valid knn accuracy residuals : 65.68181818181819%

Valid knn accuracy average   : 54.69571421740952%

                                                                      [AEpoch 91: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0284, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=0.683, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00945, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=0.652]Epoch 91: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0284, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=0.683, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188653, 0.188942, 0.187829, 0.194651
Train average loss UNet                 (all)                : 0.760075

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000493, 1.855643, 3.736706
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002365, 2.055732, 3.507846
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002261, 2.109636, 3.620632
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001600, 2.140981, 3.837617
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001597, 2.217762, 3.854314
Train average loss all      (Triplet)                 : 0.001779

== Recognize ==
Train average loss Recognize     : 0.643327
Train average accuracy drums     : 64.320000 %
Train average accuracy bass      : 53.460003 %
Train average accuracy piano     : 53.399998 %
Train average accuracy guitar    : 55.524998 %
Train average accuracy residuals : 56.010002 %

== Train average loss all : 0.008212

Epoch 91:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0284, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=0.683, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]          Epoch 92:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0284, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=0.683, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]Epoch 92:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.0284, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=0.683, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]Epoch 92:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.636, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]Epoch 92:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.636, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]Epoch 92:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.657, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]Epoch 92:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.657, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]Epoch 92:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00324, Train/loss_recog_step=0.680, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]Epoch 92:  64%|██████▍   | 200/313 [04:11<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00324, Train/loss_recog_step=0.680, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]Epoch 92:  64%|██████▍   | 200/313 [04:11<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.00647, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.647, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]Epoch 92:  80%|███████▉  | 250/313 [05:13<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.00647, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.647, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]Epoch 92:  80%|███████▉  | 250/313 [05:13<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.638, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]Epoch 92:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.638, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]Epoch 92:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643] Epoch 92: 100%|██████████| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]Epoch 92: 100%|██████████| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00685, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.685, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.59it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.58it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.68it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.72it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.66it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.83it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184031, 0.187330, 0.189601, 0.201967
Valid average loss UNet                 (all)                : 0.762929

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.056489, 1.820601, 3.433685
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.425405, 2.595820, 2.900884
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.349380, 2.326284, 2.602931
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.342265, 2.507411, 3.197150
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.307774, 2.493772, 3.238236
Valid average loss all      (Triplet)                 : 0.314177

== Recognize ==
Valid average loss Recognize     : 0.702639
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.321203

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.622455358505249 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.27122163772583 sec. =
Valid knn accuracy bass      : 32.25806451612903%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.626732110977173 sec. =
Valid knn accuracy piano     : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.325730800628662 sec. =
Valid knn accuracy guitar    : 49.776785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.572825193405151 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 55.99911431485764%

                                                                      [AEpoch 92: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00685, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.685, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00821, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=0.643]Epoch 92: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00685, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.685, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188194, 0.188470, 0.187408, 0.193990
Train average loss UNet                 (all)                : 0.758062

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001313, 1.864547, 3.658430
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003024, 2.098415, 3.571893
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003346, 2.119379, 3.604582
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003961, 2.176214, 3.867747
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002082, 2.248209, 3.891411
Train average loss all      (Triplet)                 : 0.002729

== Recognize ==
Train average loss Recognize     : 0.647241
Train average accuracy drums     : 62.725002 %
Train average accuracy bass      : 53.105003 %
Train average accuracy piano     : 53.885002 %
Train average accuracy guitar    : 54.595001 %
Train average accuracy residuals : 55.545002 %

== Train average loss all : 0.009201

Epoch 92:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00685, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.685, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]          Epoch 93:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00685, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.685, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]Epoch 93:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00685, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.685, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]Epoch 93:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.0086, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.655, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]Epoch 93:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.0086, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.655, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]Epoch 93:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.669, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]Epoch 93:  48%|████▊     | 150/313 [03:10<03:27,  0.79it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.669, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]Epoch 93:  48%|████▊     | 150/313 [03:10<03:27,  0.79it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.690, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]  Epoch 93:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.690, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]Epoch 93:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.00662, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.662, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]Epoch 93:  80%|███████▉  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.00662, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.662, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]Epoch 93:  80%|███████▉  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]Epoch 93:  96%|█████████▌| 300/313 [06:13<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]Epoch 93:  96%|█████████▌| 300/313 [06:13<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]Epoch 93: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]Epoch 93: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.49it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.74it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183873, 0.187106, 0.189352, 0.198265
Valid average loss UNet                 (all)                : 0.758595

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.043857, 1.791005, 3.404147
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.371469, 2.584316, 2.908519
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.296290, 2.307313, 2.668933
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.326711, 2.442193, 3.253465
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.318913, 2.548235, 3.259581
Valid average loss all      (Triplet)                 : 0.276130

== Recognize ==
Valid average loss Recognize     : 0.748640
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.283617

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.550174474716187 sec. =
Valid knn accuracy drums     : 84.1304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.60125994682312 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.75172233581543 sec. =
Valid knn accuracy piano     : 44.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.410686016082764 sec. =
Valid knn accuracy guitar    : 46.651785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.366418838500977 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 54.03882129879237%

                                                                      [AEpoch 93: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0092, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.647]Epoch 93: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188577, 0.188866, 0.187791, 0.194484
Train average loss UNet                 (all)                : 0.759718

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000845, 1.866595, 3.774791
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004900, 2.109549, 3.621908
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003705, 2.159773, 3.676086
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002527, 2.163846, 3.819846
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002464, 2.238080, 3.875575
Train average loss all      (Triplet)                 : 0.002920

== Recognize ==
Train average loss Recognize     : 0.649770
Train average accuracy drums     : 63.325001 %
Train average accuracy bass      : 53.689999 %
Train average accuracy piano     : 52.705002 %
Train average accuracy guitar    : 54.404999 %
Train average accuracy residuals : 55.169998 %

== Train average loss all : 0.009417

Epoch 93:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]          Epoch 94:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]Epoch 94:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]Epoch 94:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.0086, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=0.670, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]Epoch 94:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.0086, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=0.670, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]Epoch 94:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00622, Train/loss_recog_step=0.585, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]Epoch 94:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00622, Train/loss_recog_step=0.585, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]Epoch 94:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.0071, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000146, Train/loss_recog_step=0.696, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]Epoch 94:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.0071, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000146, Train/loss_recog_step=0.696, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]Epoch 94:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.696, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]  Epoch 94:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.696, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]Epoch 94:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]Epoch 94:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]Epoch 94:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0324, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.681, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]Epoch 94: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0324, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.681, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]Epoch 94: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.840, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.86it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.85it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.81it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183726, 0.187017, 0.188987, 0.198093
Valid average loss UNet                 (all)                : 0.757822

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.052743, 1.799508, 3.409461
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.384464, 2.358002, 2.719317
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.442360, 2.461783, 2.638643
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.374140, 2.428295, 3.154490
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.353709, 2.634529, 3.091644
Valid average loss all      (Triplet)                 : 0.327512

== Recognize ==
Valid average loss Recognize     : 0.746724
Valid average accuracy drums     : 42.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.334980

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.303687810897827 sec. =
Valid knn accuracy drums     : 80.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.254384517669678 sec. =
Valid knn accuracy bass      : 24.193548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.708561658859253 sec. =
Valid knn accuracy piano     : 36.9140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.387742519378662 sec. =
Valid knn accuracy guitar    : 46.42857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.29918909072876 sec. =
Valid knn accuracy residuals : 65.45454545454545%

Valid knn accuracy average   : 50.64162381491229%

                                                                      [AEpoch 94: 100%|██████████| 313/313 [08:00<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.00942, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.650]Epoch 94: 100%|██████████| 313/313 [08:00<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188410, 0.188722, 0.187632, 0.194726
Train average loss UNet                 (all)                : 0.759490

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000844, 1.876204, 3.813147
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004702, 2.146078, 3.641300
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002910, 2.159737, 3.654027
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002500, 2.181884, 3.852272
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003203, 2.338741, 4.042933
Train average loss all      (Triplet)                 : 0.002869

== Recognize ==
Train average loss Recognize     : 0.652978
Train average accuracy drums     : 63.285000 %
Train average accuracy bass      : 54.090000 %
Train average accuracy piano     : 53.294998 %
Train average accuracy guitar    : 53.584999 %
Train average accuracy residuals : 53.200001 %

== Train average loss all : 0.009399

Epoch 94:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653]          Epoch 95:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653]Epoch 95:  16%|█▌        | 50/313 [01:12<06:22,  0.69it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653]Epoch 95:  16%|█▌        | 50/313 [01:12<06:22,  0.69it/s, v_num=0, Train/loss_all_step=0.00875, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00229, Train/loss_recog_step=0.646, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653]Epoch 95:  32%|███▏      | 100/313 [02:14<04:46,  0.74it/s, v_num=0, Train/loss_all_step=0.00875, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00229, Train/loss_recog_step=0.646, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653]Epoch 95:  32%|███▏      | 100/313 [02:14<04:46,  0.74it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653]  Epoch 95:  48%|████▊     | 150/313 [03:16<03:33,  0.76it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653]Epoch 95:  48%|████▊     | 150/313 [03:16<03:33,  0.76it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.690, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653] Epoch 95:  64%|██████▍   | 200/313 [04:17<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.690, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653]Epoch 95:  64%|██████▍   | 200/313 [04:17<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.00988, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00306, Train/loss_recog_step=0.682, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653]Epoch 95:  80%|███████▉  | 250/313 [05:17<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00988, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00306, Train/loss_recog_step=0.682, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653]Epoch 95:  80%|███████▉  | 250/313 [05:17<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.00603, Train/loss_recog_step=0.633, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653] Epoch 95:  96%|█████████▌| 300/313 [06:17<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.00603, Train/loss_recog_step=0.633, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653]Epoch 95:  96%|█████████▌| 300/313 [06:17<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00978, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00297, Train/loss_recog_step=0.681, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653]Epoch 95: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00978, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00297, Train/loss_recog_step=0.681, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653]Epoch 95: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.819, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.747, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.82it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.64it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.38it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184024, 0.187321, 0.189355, 0.201390
Valid average loss UNet                 (all)                : 0.762090

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.056698, 1.756465, 3.112350
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.357356, 2.478024, 2.825654
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.370316, 2.392228, 2.551798
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.335850, 2.420357, 3.213676
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.308724, 2.603007, 3.129755
Valid average loss all      (Triplet)                 : 0.284966

== Recognize ==
Valid average loss Recognize     : 0.730273
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 44.500000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.292269

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.124907970428467 sec. =
Valid knn accuracy drums     : 84.1304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.373196601867676 sec. =
Valid knn accuracy bass      : 27.016129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.939281702041626 sec. =
Valid knn accuracy piano     : 41.2109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.701789140701294 sec. =
Valid knn accuracy guitar    : 49.330357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.510840654373169 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 53.51938987336297%

                                                                      [AEpoch 95: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=0.653]Epoch 95: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188237, 0.188524, 0.187450, 0.195457
Train average loss UNet                 (all)                : 0.759669

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001196, 1.803382, 3.670556
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003068, 2.034888, 3.523846
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002886, 2.115045, 3.566794
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002612, 2.094179, 3.734491
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002747, 2.252449, 3.925699
Train average loss all      (Triplet)                 : 0.002523

== Recognize ==
Train average loss Recognize     : 0.646570
Train average accuracy drums     : 63.820000 %
Train average accuracy bass      : 54.040001 %
Train average accuracy piano     : 53.759998 %
Train average accuracy guitar    : 54.665001 %
Train average accuracy residuals : 54.919998 %

== Train average loss all : 0.008989

Epoch 95:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]          Epoch 96:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]Epoch 96:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]Epoch 96:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.0067, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.670, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647] Epoch 96:  32%|███▏      | 100/313 [02:13<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.0067, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.670, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]Epoch 96:  32%|███▏      | 100/313 [02:13<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]Epoch 96:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]Epoch 96:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.00662, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.662, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]Epoch 96:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.00662, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.662, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]Epoch 96:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00512, Train/loss_recog_step=0.670, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]Epoch 96:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00512, Train/loss_recog_step=0.670, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]Epoch 96:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.627, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]Epoch 96:  96%|█████████▌| 300/313 [06:17<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.627, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]Epoch 96:  96%|█████████▌| 300/313 [06:17<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647] Epoch 96: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]Epoch 96: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.669, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.100, Valid/loss_recog_step=0.672, Valid/loss_all_epoch=0.292, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.26it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.26it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.51it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.67it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184722, 0.188101, 0.190078, 0.197844
Valid average loss UNet                 (all)                : 0.760745

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.041052, 1.672000, 3.032920
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.418441, 2.515290, 2.838036
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.392872, 2.463967, 2.667090
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.308263, 2.317537, 3.065997
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.329762, 2.630986, 3.020708
Valid average loss all      (Triplet)                 : 0.307835

== Recognize ==
Valid average loss Recognize     : 0.691829
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.314754

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.70393419265747 sec. =
Valid knn accuracy drums     : 83.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.434334516525269 sec. =
Valid knn accuracy bass      : 38.91129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.004895687103271 sec. =
Valid knn accuracy piano     : 40.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.512120246887207 sec. =
Valid knn accuracy guitar    : 54.6875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.456961154937744 sec. =
Valid knn accuracy residuals : 70.0%

Valid knn accuracy average   : 57.37974447755961%

                                                                      [AEpoch 96: 100%|██████████| 313/313 [08:02<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.669, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.647]Epoch 96: 100%|██████████| 313/313 [08:02<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.669, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188369, 0.188660, 0.187585, 0.194535
Train average loss UNet                 (all)                : 0.759149

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000712, 1.773455, 3.582815
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003002, 2.036826, 3.506237
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002796, 2.115035, 3.577809
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002902, 2.067847, 3.662920
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002308, 2.225770, 3.901185
Train average loss all      (Triplet)                 : 0.002308

== Recognize ==
Train average loss Recognize     : 0.642415
Train average accuracy drums     : 65.720001 %
Train average accuracy bass      : 54.705002 %
Train average accuracy piano     : 53.785004 %
Train average accuracy guitar    : 54.845001 %
Train average accuracy residuals : 55.529999 %

== Train average loss all : 0.008733

Epoch 96:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.669, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]          Epoch 97:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.669, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]Epoch 97:  16%|█▌        | 50/313 [01:12<06:19,  0.69it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.669, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]Epoch 97:  16%|█▌        | 50/313 [01:12<06:19,  0.69it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]Epoch 97:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]Epoch 97:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.00935, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00317, Train/loss_recog_step=0.619, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]Epoch 97:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.00935, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00317, Train/loss_recog_step=0.619, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]Epoch 97:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00499, Train/loss_recog_step=0.657, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642] Epoch 97:  64%|██████▍   | 200/313 [04:18<02:25,  0.77it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00499, Train/loss_recog_step=0.657, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]Epoch 97:  64%|██████▍   | 200/313 [04:18<02:25,  0.77it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642] Epoch 97:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]Epoch 97:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000506, Train/loss_recog_step=0.605, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]Epoch 97:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000506, Train/loss_recog_step=0.605, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]Epoch 97:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]   Epoch 97: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]Epoch 97: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.692, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.33it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.71it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.38it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.14it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184138, 0.187428, 0.189537, 0.200228
Valid average loss UNet                 (all)                : 0.761331

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.045551, 1.767434, 3.396308
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.438870, 2.481870, 2.711478
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.381413, 2.477779, 2.837360
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.300968, 2.344436, 3.115355
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.391214, 2.593630, 3.304528
Valid average loss all      (Triplet)                 : 0.323016

== Recognize ==
Valid average loss Recognize     : 0.724081
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.330257

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.468838453292847 sec. =
Valid knn accuracy drums     : 82.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.591396808624268 sec. =
Valid knn accuracy bass      : 32.86290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.65295958518982 sec. =
Valid knn accuracy piano     : 38.4765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.476394891738892 sec. =
Valid knn accuracy guitar    : 61.38392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.542060852050781 sec. =
Valid knn accuracy residuals : 68.18181818181817%

Valid knn accuracy average   : 56.74625988711498%

                                                                      [AEpoch 97: 100%|██████████| 313/313 [08:04<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00873, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=0.642]Epoch 97: 100%|██████████| 313/313 [08:04<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188463, 0.188768, 0.187682, 0.194223
Train average loss UNet                 (all)                : 0.759137

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000402, 1.743396, 3.595058
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001553, 2.008061, 3.484740
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002340, 2.091658, 3.586877
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001330, 2.082865, 3.708133
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002185, 2.242649, 3.906876
Train average loss all      (Triplet)                 : 0.001635

== Recognize ==
Train average loss Recognize     : 0.636535
Train average accuracy drums     : 67.989998 %
Train average accuracy bass      : 54.700001 %
Train average accuracy piano     : 54.299999 %
Train average accuracy guitar    : 54.985001 %
Train average accuracy residuals : 56.215000 %

== Train average loss all : 0.008000

Epoch 97:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]          Epoch 98:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]Epoch 98:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]Epoch 98:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]Epoch 98:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]Epoch 98:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.00928, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00307, Train/loss_recog_step=0.621, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]Epoch 98:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.00928, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00307, Train/loss_recog_step=0.621, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]Epoch 98:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]  Epoch 98:  64%|██████▍   | 200/313 [04:10<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]Epoch 98:  64%|██████▍   | 200/313 [04:10<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.00681, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.681, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]Epoch 98:  80%|███████▉  | 250/313 [05:10<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.00681, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.681, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]Epoch 98:  80%|███████▉  | 250/313 [05:10<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000472, Train/loss_recog_step=0.650, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]Epoch 98:  96%|█████████▌| 300/313 [06:12<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000472, Train/loss_recog_step=0.650, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]Epoch 98:  96%|█████████▌| 300/313 [06:12<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=0.661, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]  Epoch 98: 100%|██████████| 313/313 [06:24<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=0.661, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]Epoch 98: 100%|██████████| 313/313 [06:24<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.724, Valid/knn_avr=0.567, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.76it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.59it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.69it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.85it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183296, 0.186556, 0.188463, 0.196377
Valid average loss UNet                 (all)                : 0.754693

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.038386, 1.678438, 3.217645
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.458305, 2.453349, 2.787495
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.379326, 2.350011, 2.571401
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.297812, 2.300769, 3.061954
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.344256, 2.518424, 3.124471
Valid average loss all      (Triplet)                 : 0.316606

== Recognize ==
Valid average loss Recognize     : 0.748605
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 42.500000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 58.000000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.324093

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.599329233169556 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.38866114616394 sec. =
Valid knn accuracy bass      : 29.63709677419355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.789066314697266 sec. =
Valid knn accuracy piano     : 42.3828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.3033127784729 sec. =
Valid knn accuracy guitar    : 54.91071428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.185506820678711 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 54.658851984708846%

                                                                      [AEpoch 98: 100%|██████████| 313/313 [07:58<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.637]Epoch 98: 100%|██████████| 313/313 [07:58<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188234, 0.188531, 0.187462, 0.194624
Train average loss UNet                 (all)                : 0.758852

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000370, 1.746541, 3.600985
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002357, 2.056926, 3.570480
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002561, 2.092890, 3.562959
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001981, 2.075376, 3.695700
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002005, 2.212406, 3.863157
Train average loss all      (Triplet)                 : 0.001818

== Recognize ==
Train average loss Recognize     : 0.641815
Train average accuracy drums     : 66.989998 %
Train average accuracy bass      : 54.250000 %
Train average accuracy piano     : 53.785004 %
Train average accuracy guitar    : 54.945000 %
Train average accuracy residuals : 55.119999 %

== Train average loss all : 0.008236

Epoch 98:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642]          Epoch 99:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642]Epoch 99:  16%|█▌        | 50/313 [01:12<06:19,  0.69it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642]Epoch 99:  16%|█▌        | 50/313 [01:12<06:19,  0.69it/s, v_num=0, Train/loss_all_step=0.00837, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00234, Train/loss_recog_step=0.603, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642]Epoch 99:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.00837, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00234, Train/loss_recog_step=0.603, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642]Epoch 99:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.00779, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0016, Train/loss_recog_step=0.618, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642] Epoch 99:  48%|████▊     | 150/313 [03:13<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.00779, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0016, Train/loss_recog_step=0.618, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642]Epoch 99:  48%|████▊     | 150/313 [03:13<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642] Epoch 99:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642]Epoch 99:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.677, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642]Epoch 99:  80%|███████▉  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.677, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642]Epoch 99:  80%|███████▉  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.624, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642]Epoch 99:  96%|█████████▌| 300/313 [06:13<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.624, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642]Epoch 99:  96%|█████████▌| 300/313 [06:13<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642] Epoch 99: 100%|██████████| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642]Epoch 99: 100%|██████████| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.649, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.841, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.09it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.43it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.26it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183321, 0.186619, 0.188427, 0.184934
Valid average loss UNet                 (all)                : 0.743301

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.046314, 1.660493, 3.270021
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.481391, 2.477206, 2.741689
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.387405, 2.245273, 2.417423
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.375225, 2.270773, 2.970443
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.245149, 2.431160, 3.102528
Valid average loss all      (Triplet)                 : 0.330259

== Recognize ==
Valid average loss Recognize     : 0.776536
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.338025

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.748759031295776 sec. =
Valid knn accuracy drums     : 84.1304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.40300703048706 sec. =
Valid knn accuracy bass      : 35.88709677419355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.49627685546875 sec. =
Valid knn accuracy piano     : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.219357013702393 sec. =
Valid knn accuracy guitar    : 55.13392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.594969034194946 sec. =
Valid knn accuracy residuals : 69.54545454545455%

Valid knn accuracy average   : 58.00188293473707%

                                                                      [AEpoch 99: 100%|██████████| 313/313 [08:01<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.649, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.642]Epoch 99: 100%|██████████| 313/313 [08:01<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.649, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188393, 0.188686, 0.187612, 0.194403
Train average loss UNet                 (all)                : 0.759094

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000427, 1.785260, 3.651046
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003929, 2.107355, 3.625932
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002692, 2.102185, 3.592396
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002128, 2.109392, 3.739183
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004717, 2.327601, 4.014637
Train average loss all      (Triplet)                 : 0.002879

== Recognize ==
Train average loss Recognize     : 0.642969
Train average accuracy drums     : 66.605003 %
Train average accuracy bass      : 54.180000 %
Train average accuracy piano     : 53.340000 %
Train average accuracy guitar    : 54.924999 %
Train average accuracy residuals : 55.559998 %

== Train average loss all : 0.009309

Epoch 99:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.649, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]          Epoch 100:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.649, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]Epoch 100:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.649, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]Epoch 100:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=0.654, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643] Epoch 100:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=0.654, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]Epoch 100:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.00635, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.635, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]Epoch 100:  48%|████▊     | 150/313 [03:13<03:30,  0.78it/s, v_num=0, Train/loss_all_step=0.00635, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.635, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]Epoch 100:  48%|████▊     | 150/313 [03:13<03:30,  0.78it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]Epoch 100:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]Epoch 100:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.00664, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.664, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]Epoch 100:  80%|███████▉  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.00664, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.664, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]Epoch 100:  80%|███████▉  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.631, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]Epoch 100:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.631, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]Epoch 100:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00851, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=0.652, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]Epoch 100: 100%|██████████| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00851, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=0.652, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]Epoch 100: 100%|██████████| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.743, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.25it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.10it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  2.99it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.58it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.77it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184637, 0.187936, 0.190029, 0.193801
Valid average loss UNet                 (all)                : 0.756403

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.054045, 1.678293, 3.136465
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.366673, 2.497632, 2.804574
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.399109, 2.385257, 2.465764
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.337827, 2.371488, 3.197125
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.305315, 2.558410, 3.309719
Valid average loss all      (Triplet)                 : 0.297650

== Recognize ==
Valid average loss Recognize     : 0.712866
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.304779

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.54944372177124 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.623036623001099 sec. =
Valid knn accuracy bass      : 36.895161290322584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.5686194896698 sec. =
Valid knn accuracy piano     : 41.6015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.3743896484375 sec. =
Valid knn accuracy guitar    : 53.79464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.28583812713623 sec. =
Valid knn accuracy residuals : 66.13636363636364%

Valid knn accuracy average   : 56.381198230678855%

                                                                      [AEpoch 100: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00931, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.643]Epoch 100: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188558, 0.188871, 0.187777, 0.194881
Train average loss UNet                 (all)                : 0.760087

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000654, 1.808402, 3.657699
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004773, 2.118634, 3.619229
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004788, 2.150144, 3.629927
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004880, 2.225944, 3.906862
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002919, 2.361358, 4.090982
Train average loss all      (Triplet)                 : 0.003663

== Recognize ==
Train average loss Recognize     : 0.649215
Train average accuracy drums     : 65.100006 %
Train average accuracy bass      : 53.294998 %
Train average accuracy piano     : 53.250004 %
Train average accuracy guitar    : 54.500000 %
Train average accuracy residuals : 55.374996 %

== Train average loss all : 0.010155

Epoch 100:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]          Epoch 101:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]Epoch 101:  16%|█▌        | 50/313 [01:13<06:27,  0.68it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]Epoch 101:  16%|█▌        | 50/313 [01:13<06:27,  0.68it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]Epoch 101:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]Epoch 101:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.0096, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.638, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]Epoch 101:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.0096, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.638, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]Epoch 101:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.00781, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000779, Train/loss_recog_step=0.703, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]Epoch 101:  64%|██████▍   | 200/313 [04:11<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.00781, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000779, Train/loss_recog_step=0.703, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]Epoch 101:  64%|██████▍   | 200/313 [04:11<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]   Epoch 101:  80%|███████▉  | 250/313 [05:13<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]Epoch 101:  80%|███████▉  | 250/313 [05:13<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.00625, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.625, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]Epoch 101:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00625, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.625, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]Epoch 101:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00664, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=1.21e-5, Train/loss_recog_step=0.663, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]Epoch 101: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00664, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=1.21e-5, Train/loss_recog_step=0.663, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]Epoch 101: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.687, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.64it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.96it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184406, 0.187701, 0.189949, 0.197856
Valid average loss UNet                 (all)                : 0.759912

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.041985, 1.673179, 3.320513
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.388444, 2.475955, 2.730296
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.267928, 2.342525, 2.582529
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.342003, 2.430216, 3.100108
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.292964, 2.539343, 3.250665
Valid average loss all      (Triplet)                 : 0.283870

== Recognize ==
Valid average loss Recognize     : 0.717223
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 57.000000 %

== Valid average loss all : 0.291042

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.300724983215332 sec. =
Valid knn accuracy drums     : 87.82608695652175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.414441347122192 sec. =
Valid knn accuracy bass      : 34.274193548387096%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.708077430725098 sec. =
Valid knn accuracy piano     : 44.7265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.350167989730835 sec. =
Valid knn accuracy guitar    : 48.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.312434434890747 sec. =
Valid knn accuracy residuals : 72.04545454545455%

Valid knn accuracy average   : 57.46195951007268%

                                                                      [AEpoch 101: 100%|██████████| 313/313 [08:00<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.687, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=0.649]Epoch 101: 100%|██████████| 313/313 [08:00<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.687, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188335, 0.188627, 0.187547, 0.194858
Train average loss UNet                 (all)                : 0.759368

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000848, 1.820801, 3.689627
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004522, 2.113498, 3.633732
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003117, 2.182815, 3.706855
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002744, 2.201821, 3.898019
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001988, 2.363029, 4.128401
Train average loss all      (Triplet)                 : 0.002729

== Recognize ==
Train average loss Recognize     : 0.651373
Train average accuracy drums     : 63.930000 %
Train average accuracy bass      : 53.434998 %
Train average accuracy piano     : 53.030003 %
Train average accuracy guitar    : 53.880001 %
Train average accuracy residuals : 55.000000 %

== Train average loss all : 0.009243

Epoch 101:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.687, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]          Epoch 102:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.687, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]Epoch 102:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.687, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]Epoch 102:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.0067, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000151, Train/loss_recog_step=0.655, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]Epoch 102:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.0067, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000151, Train/loss_recog_step=0.655, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]Epoch 102:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.00641, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=8.94e-5, Train/loss_recog_step=0.632, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]Epoch 102:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.00641, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=8.94e-5, Train/loss_recog_step=0.632, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]Epoch 102:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000586, Train/loss_recog_step=0.646, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]Epoch 102:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000586, Train/loss_recog_step=0.646, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]Epoch 102:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00426, Train/loss_recog_step=0.624, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]  Epoch 102:  80%|███████▉  | 250/313 [05:09<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00426, Train/loss_recog_step=0.624, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]Epoch 102:  80%|███████▉  | 250/313 [05:09<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.599, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651] Epoch 102:  96%|█████████▌| 300/313 [06:12<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.599, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]Epoch 102:  96%|█████████▌| 300/313 [06:12<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.00647, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.647, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]Epoch 102: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00647, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.647, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]Epoch 102: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00641, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.641, Valid/loss_all_step=0.231, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.284, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.27it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.21it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.80it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.22it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.28it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184342, 0.187587, 0.189841, 0.202775
Valid average loss UNet                 (all)                : 0.764546

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.047484, 1.657185, 3.320140
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.395458, 2.538039, 2.746826
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.306708, 2.214010, 2.321616
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.284329, 2.294144, 3.040063
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.291100, 2.570158, 3.331847
Valid average loss all      (Triplet)                 : 0.277960

== Recognize ==
Valid average loss Recognize     : 0.729049
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 41.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.285251

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.29075312614441 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.299192428588867 sec. =
Valid knn accuracy bass      : 45.16129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.511399984359741 sec. =
Valid knn accuracy piano     : 41.40625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.617354154586792 sec. =
Valid knn accuracy guitar    : 47.544642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.26054573059082 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 56.69990699167593%

                                                                      [AEpoch 102: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00641, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.641, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.651]Epoch 102: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00641, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.641, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188458, 0.188754, 0.187671, 0.194527
Train average loss UNet                 (all)                : 0.759410

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000568, 1.828608, 3.772982
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004073, 2.121868, 3.654068
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003561, 2.155390, 3.658299
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001541, 2.168576, 3.852316
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002485, 2.390695, 4.215721
Train average loss all      (Triplet)                 : 0.002555

== Recognize ==
Train average loss Recognize     : 0.646047
Train average accuracy drums     : 65.750000 %
Train average accuracy bass      : 53.445000 %
Train average accuracy piano     : 54.255001 %
Train average accuracy guitar    : 54.795002 %
Train average accuracy residuals : 55.099998 %

== Train average loss all : 0.009016

Epoch 102:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00641, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.641, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]          Epoch 103:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00641, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.641, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]Epoch 103:  16%|█▌        | 50/313 [01:12<06:21,  0.69it/s, v_num=0, Train/loss_all_step=0.00641, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.641, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]Epoch 103:  16%|█▌        | 50/313 [01:12<06:21,  0.69it/s, v_num=0, Train/loss_all_step=0.00929, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00297, Train/loss_recog_step=0.631, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]Epoch 103:  32%|███▏      | 100/313 [02:15<04:48,  0.74it/s, v_num=0, Train/loss_all_step=0.00929, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00297, Train/loss_recog_step=0.631, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]Epoch 103:  32%|███▏      | 100/313 [02:15<04:48,  0.74it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]   Epoch 103:  48%|████▊     | 150/313 [03:17<03:34,  0.76it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]Epoch 103:  48%|████▊     | 150/313 [03:17<03:34,  0.76it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00485, Train/loss_recog_step=0.672, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]Epoch 103:  64%|██████▍   | 200/313 [04:18<02:26,  0.77it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00485, Train/loss_recog_step=0.672, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]Epoch 103:  64%|██████▍   | 200/313 [04:18<02:26,  0.77it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646] Epoch 103:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]Epoch 103:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]Epoch 103:  96%|█████████▌| 300/313 [06:19<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]Epoch 103:  96%|█████████▌| 300/313 [06:19<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.655, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]Epoch 103: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.655, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]Epoch 103: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.90it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.79it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.46it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184329, 0.187681, 0.189688, 0.202438
Valid average loss UNet                 (all)                : 0.764136

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.055282, 1.814208, 3.621351
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.342597, 2.532840, 2.791660
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.418561, 2.459458, 2.480126
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.321249, 2.355661, 3.234049
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.342683, 2.663235, 3.419705
Valid average loss all      (Triplet)                 : 0.303106

== Recognize ==
Valid average loss Recognize     : 0.715513
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.310262

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.505278587341309 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.207095623016357 sec. =
Valid knn accuracy bass      : 30.443548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.57133936882019 sec. =
Valid knn accuracy piano     : 39.453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.614420890808105 sec. =
Valid knn accuracy guitar    : 52.67857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.308245420455933 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 54.669199160762105%

                                                                      [AEpoch 103: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00902, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=0.646]Epoch 103: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188480, 0.188764, 0.187663, 0.195045
Train average loss UNet                 (all)                : 0.759952

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000418, 1.839646, 3.802303
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003252, 2.098027, 3.596885
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003096, 2.142111, 3.667850
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002383, 2.171746, 3.900628
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002153, 2.339077, 4.094754
Train average loss all      (Triplet)                 : 0.002174

== Recognize ==
Train average loss Recognize     : 0.642207
Train average accuracy drums     : 67.559998 %
Train average accuracy bass      : 53.910000 %
Train average accuracy piano     : 54.035004 %
Train average accuracy guitar    : 54.855000 %
Train average accuracy residuals : 55.879997 %

== Train average loss all : 0.008596

Epoch 103:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]          Epoch 104:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]Epoch 104:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]Epoch 104:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]Epoch 104:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]Epoch 104:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.00885, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=0.652, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]Epoch 104:  48%|████▊     | 150/313 [03:12<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.00885, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=0.652, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]Epoch 104:  48%|████▊     | 150/313 [03:12<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.00934, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00295, Train/loss_recog_step=0.639, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]Epoch 104:  64%|██████▍   | 200/313 [04:11<02:22,  0.80it/s, v_num=0, Train/loss_all_step=0.00934, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00295, Train/loss_recog_step=0.639, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]Epoch 104:  64%|██████▍   | 200/313 [04:11<02:22,  0.80it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]  Epoch 104:  80%|███████▉  | 250/313 [05:13<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]Epoch 104:  80%|███████▉  | 250/313 [05:13<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.00618, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.618, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]Epoch 104:  96%|█████████▌| 300/313 [06:17<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00618, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.618, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]Epoch 104:  96%|█████████▌| 300/313 [06:17<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00702, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.702, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]Epoch 104: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00702, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.702, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]Epoch 104: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00651, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.651, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.310, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.64it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.64it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.46it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.46it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184262, 0.187626, 0.189703, 0.203070
Valid average loss UNet                 (all)                : 0.764661

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.068138, 1.724481, 3.282156
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.396644, 2.488813, 2.758152
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.354582, 2.364049, 2.429775
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.263839, 2.254003, 3.177683
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.287798, 2.545840, 2.979422
Valid average loss all      (Triplet)                 : 0.293807

== Recognize ==
Valid average loss Recognize     : 0.701102
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 56.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.300818

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.3661208152771 sec. =
Valid knn accuracy drums     : 83.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.63293194770813 sec. =
Valid knn accuracy bass      : 33.66935483870967%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.369809865951538 sec. =
Valid knn accuracy piano     : 49.8046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.69431471824646 sec. =
Valid knn accuracy guitar    : 48.660714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.200046300888062 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 57.17003432883736%

                                                                      [AEpoch 104: 100%|██████████| 313/313 [07:58<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00651, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.651, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0086, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.642]Epoch 104: 100%|██████████| 313/313 [07:58<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00651, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.651, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188457, 0.188763, 0.187652, 0.194620
Train average loss UNet                 (all)                : 0.759492

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000563, 1.853704, 3.840002
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003636, 2.144040, 3.638636
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003480, 2.184404, 3.700893
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002351, 2.197349, 3.940923
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001527, 2.339097, 4.105920
Train average loss all      (Triplet)                 : 0.002270

== Recognize ==
Train average loss Recognize     : 0.643424
Train average accuracy drums     : 66.849998 %
Train average accuracy bass      : 53.574997 %
Train average accuracy piano     : 54.345001 %
Train average accuracy guitar    : 54.879997 %
Train average accuracy residuals : 55.250000 %

== Train average loss all : 0.008704

Epoch 104:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00651, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.651, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]          Epoch 105:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00651, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.651, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]Epoch 105:  16%|█▌        | 50/313 [01:13<06:27,  0.68it/s, v_num=0, Train/loss_all_step=0.00651, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.651, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]Epoch 105:  16%|█▌        | 50/313 [01:13<06:27,  0.68it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00615, Train/loss_recog_step=0.656, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]Epoch 105:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00615, Train/loss_recog_step=0.656, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]Epoch 105:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00893, Train/loss_recog_step=0.637, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]Epoch 105:  48%|████▊     | 150/313 [03:13<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00893, Train/loss_recog_step=0.637, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]Epoch 105:  48%|████▊     | 150/313 [03:13<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0094, Train/loss_recog_step=0.687, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643] Epoch 105:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0094, Train/loss_recog_step=0.687, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]Epoch 105:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00454, Train/loss_recog_step=0.608, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]Epoch 105:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00454, Train/loss_recog_step=0.608, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]Epoch 105:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00811, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.00176, Train/loss_recog_step=0.635, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]Epoch 105:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00811, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.00176, Train/loss_recog_step=0.635, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]Epoch 105:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]  Epoch 105: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]Epoch 105: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.72it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.64it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.26it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185525, 0.188787, 0.191335, 0.196221
Valid average loss UNet                 (all)                : 0.761868

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.068241, 1.823751, 3.478322
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.407437, 2.494080, 2.818060
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.254749, 2.386281, 2.837087
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.297244, 2.379709, 3.149558
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.264269, 2.696678, 3.173110
Valid average loss all      (Triplet)                 : 0.282780

== Recognize ==
Valid average loss Recognize     : 0.718708
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 44.500000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.289968

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.302320957183838 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.276867628097534 sec. =
Valid knn accuracy bass      : 31.451612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.401714086532593 sec. =
Valid knn accuracy piano     : 43.359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.485217332839966 sec. =
Valid knn accuracy guitar    : 52.45535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.237991333007812 sec. =
Valid knn accuracy residuals : 67.27272727272727%

Valid knn accuracy average   : 55.82085794202292%

                                                                      [AEpoch 105: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0087, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=0.643]Epoch 105: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189026, 0.189304, 0.188208, 0.194933
Train average loss UNet                 (all)                : 0.761471

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000799, 1.829548, 3.791981
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003154, 2.130644, 3.672340
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003254, 2.188920, 3.710085
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003137, 2.173256, 3.857593
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001662, 2.278828, 3.984644
Train average loss all      (Triplet)                 : 0.002444

== Recognize ==
Train average loss Recognize     : 0.642492
Train average accuracy drums     : 67.625000 %
Train average accuracy bass      : 53.635002 %
Train average accuracy piano     : 53.660000 %
Train average accuracy guitar    : 54.924999 %
Train average accuracy residuals : 55.844997 %

== Train average loss all : 0.008869

Epoch 105:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]          Epoch 106:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]Epoch 106:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]Epoch 106:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.00764, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00109, Train/loss_recog_step=0.655, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]Epoch 106:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.00764, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00109, Train/loss_recog_step=0.655, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]Epoch 106:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]  Epoch 106:  48%|████▊     | 150/313 [03:14<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]Epoch 106:  48%|████▊     | 150/313 [03:14<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]Epoch 106:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]Epoch 106:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.00743, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000874, Train/loss_recog_step=0.656, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]Epoch 106:  80%|███████▉  | 250/313 [05:17<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00743, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000874, Train/loss_recog_step=0.656, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]Epoch 106:  80%|███████▉  | 250/313 [05:17<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]    Epoch 106:  96%|█████████▌| 300/313 [06:18<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]Epoch 106:  96%|█████████▌| 300/313 [06:18<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]Epoch 106: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]Epoch 106: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.286, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=0.649, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.35it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.11it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  2.96it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.11it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:03<00:00,  2.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184485, 0.187779, 0.189977, 0.190224
Valid average loss UNet                 (all)                : 0.752465

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.051342, 1.762146, 3.485556
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.400533, 2.521739, 2.881971
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.307911, 2.500683, 2.881714
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.324189, 2.380751, 3.213606
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.277647, 2.594897, 3.193855
Valid average loss all      (Triplet)                 : 0.297183

== Recognize ==
Valid average loss Recognize     : 0.768747
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.304870

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.335551261901855 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.351135730743408 sec. =
Valid knn accuracy bass      : 33.064516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.426813125610352 sec. =
Valid knn accuracy piano     : 42.3828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.57935881614685 sec. =
Valid knn accuracy guitar    : 43.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.303393602371216 sec. =
Valid knn accuracy residuals : 71.5909090909091%

Valid knn accuracy average   : 55.02721276137957%

                                                                      [AEpoch 106: 100%|██████████| 313/313 [08:02<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00887, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.642]Epoch 106: 100%|██████████| 313/313 [08:02<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188745, 0.189039, 0.187940, 0.194491
Train average loss UNet                 (all)                : 0.760214

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000750, 1.890247, 3.897933
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002303, 2.199918, 3.814536
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002043, 2.267378, 3.877643
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002337, 2.265180, 4.039565
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001908, 2.374904, 4.178223
Train average loss all      (Triplet)                 : 0.001865

== Recognize ==
Train average loss Recognize     : 0.644233
Train average accuracy drums     : 65.900002 %
Train average accuracy bass      : 53.955002 %
Train average accuracy piano     : 54.035004 %
Train average accuracy guitar    : 54.830002 %
Train average accuracy residuals : 55.779999 %

== Train average loss all : 0.008308

Epoch 106:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]          Epoch 107:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]Epoch 107:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]Epoch 107:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.657, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]Epoch 107:  32%|███▏      | 100/313 [02:11<04:40,  0.76it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.657, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]Epoch 107:  32%|███▏      | 100/313 [02:11<04:40,  0.76it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]Epoch 107:  48%|████▊     | 150/313 [03:14<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]Epoch 107:  48%|████▊     | 150/313 [03:14<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.00615, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.615, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]Epoch 107:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.00615, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.615, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]Epoch 107:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.656, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]Epoch 107:  80%|███████▉  | 250/313 [05:17<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.656, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]Epoch 107:  80%|███████▉  | 250/313 [05:17<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]Epoch 107:  96%|█████████▌| 300/313 [06:19<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]Epoch 107:  96%|█████████▌| 300/313 [06:19<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00705, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000502, Train/loss_recog_step=0.655, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]Epoch 107: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00705, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000502, Train/loss_recog_step=0.655, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]Epoch 107: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.722, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.769, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.04it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.62it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.14it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.70it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184040, 0.187353, 0.189488, 0.199887
Valid average loss UNet                 (all)                : 0.760768

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062208, 1.849061, 3.544355
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.554112, 2.750184, 2.872867
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.375150, 2.723569, 2.913249
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.330082, 2.492197, 3.321002
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.332042, 2.827593, 3.494424
Valid average loss all      (Triplet)                 : 0.362525

== Recognize ==
Valid average loss Recognize     : 0.695345
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.369478

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.59460163116455 sec. =
Valid knn accuracy drums     : 85.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.429616928100586 sec. =
Valid knn accuracy bass      : 29.435483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.412026405334473 sec. =
Valid knn accuracy piano     : 49.0234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.215991735458374 sec. =
Valid knn accuracy guitar    : 53.34821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.5711088180542 sec. =
Valid knn accuracy residuals : 70.22727272727273%

Valid knn accuracy average   : 57.40688167679095%

                                                                      [AEpoch 107: 100%|██████████| 313/313 [08:02<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00831, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.644]Epoch 107: 100%|██████████| 313/313 [08:02<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188679, 0.188975, 0.187893, 0.194212
Train average loss UNet                 (all)                : 0.759760

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000482, 1.902229, 3.873395
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003341, 2.222461, 3.760470
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002994, 2.301617, 3.912289
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002824, 2.258415, 4.003279
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002100, 2.428323, 4.269893
Train average loss all      (Triplet)                 : 0.002367

== Recognize ==
Train average loss Recognize     : 0.647714
Train average accuracy drums     : 64.334999 %
Train average accuracy bass      : 53.184998 %
Train average accuracy piano     : 54.060001 %
Train average accuracy guitar    : 54.630001 %
Train average accuracy residuals : 55.400002 %

== Train average loss all : 0.008844

Epoch 107:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]          Epoch 108:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]Epoch 108:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]Epoch 108:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.656, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]Epoch 108:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.656, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]Epoch 108:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]Epoch 108:  48%|████▊     | 150/313 [03:10<03:27,  0.79it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]Epoch 108:  48%|████▊     | 150/313 [03:10<03:27,  0.79it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]Epoch 108:  64%|██████▍   | 200/313 [04:11<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]Epoch 108:  64%|██████▍   | 200/313 [04:11<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00359, Train/loss_recog_step=0.659, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]Epoch 108:  80%|███████▉  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00359, Train/loss_recog_step=0.659, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]Epoch 108:  80%|███████▉  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00399, Train/loss_recog_step=0.625, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]Epoch 108:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00399, Train/loss_recog_step=0.625, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]Epoch 108:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648] Epoch 108: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]Epoch 108: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.35it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.12it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.62it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.20it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.56it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184358, 0.187657, 0.189959, 0.201162
Valid average loss UNet                 (all)                : 0.763137

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060246, 1.805555, 3.516080
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.545295, 2.666319, 2.919234
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.276557, 2.547870, 2.961401
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.317997, 2.476135, 3.387248
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.269567, 2.714441, 3.285258
Valid average loss all      (Triplet)                 : 0.330576

== Recognize ==
Valid average loss Recognize     : 0.716362
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.337740

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.475089311599731 sec. =
Valid knn accuracy drums     : 85.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.658003330230713 sec. =
Valid knn accuracy bass      : 31.85483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.588755130767822 sec. =
Valid knn accuracy piano     : 44.7265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.33183479309082 sec. =
Valid knn accuracy guitar    : 45.982142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.211430788040161 sec. =
Valid knn accuracy residuals : 75.45454545454545%

Valid knn accuracy average   : 56.77753094775141%

                                                                      [AEpoch 108: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00884, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.648]Epoch 108: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188414, 0.188703, 0.187633, 0.194899
Train average loss UNet                 (all)                : 0.759649

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000866, 1.865704, 3.885291
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002468, 2.192642, 3.796592
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003647, 2.258586, 3.870073
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002196, 2.220683, 3.986595
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002199, 2.388480, 4.215592
Train average loss all      (Triplet)                 : 0.002260

== Recognize ==
Train average loss Recognize     : 0.645813
Train average accuracy drums     : 64.714996 %
Train average accuracy bass      : 53.899998 %
Train average accuracy piano     : 53.114998 %
Train average accuracy guitar    : 54.410000 %
Train average accuracy residuals : 55.860001 %

== Train average loss all : 0.008718

Epoch 108:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646]          Epoch 109:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646]Epoch 109:  16%|█▌        | 50/313 [01:11<06:14,  0.70it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646]Epoch 109:  16%|█▌        | 50/313 [01:11<06:14,  0.70it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.668, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646] Epoch 109:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.668, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646]Epoch 109:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.00714, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000813, Train/loss_recog_step=0.632, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646]Epoch 109:  48%|████▊     | 150/313 [03:14<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.00714, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000813, Train/loss_recog_step=0.632, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646]Epoch 109:  48%|████▊     | 150/313 [03:14<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.00988, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00332, Train/loss_recog_step=0.656, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646] Epoch 109:  64%|██████▍   | 200/313 [04:16<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.00988, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00332, Train/loss_recog_step=0.656, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646]Epoch 109:  64%|██████▍   | 200/313 [04:16<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.00939, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00238, Train/loss_recog_step=0.700, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646]Epoch 109:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.00939, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00238, Train/loss_recog_step=0.700, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646]Epoch 109:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00392, Train/loss_recog_step=0.637, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646] Epoch 109:  96%|█████████▌| 300/313 [06:21<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00392, Train/loss_recog_step=0.637, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646]Epoch 109:  96%|█████████▌| 300/313 [06:21<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646] Epoch 109: 100%|██████████| 313/313 [06:33<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646]Epoch 109: 100%|██████████| 313/313 [06:33<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.33it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.23it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.68it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.56it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183568, 0.186854, 0.188971, 0.197987
Valid average loss UNet                 (all)                : 0.757381

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060576, 1.745482, 3.353210
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.540264, 2.612270, 2.817523
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.403807, 2.666812, 2.832109
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.351377, 2.329240, 3.158835
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.274198, 2.742728, 3.376095
Valid average loss all      (Triplet)                 : 0.357212

== Recognize ==
Valid average loss Recognize     : 0.732750
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.364540

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.341213703155518 sec. =
Valid knn accuracy drums     : 82.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.371756553649902 sec. =
Valid knn accuracy bass      : 28.62903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.847867250442505 sec. =
Valid knn accuracy piano     : 44.921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.418268203735352 sec. =
Valid knn accuracy guitar    : 46.205357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.295252799987793 sec. =
Valid knn accuracy residuals : 72.95454545454545%

Valid knn accuracy average   : 55.02042284065865%

                                                                      [AEpoch 109: 100%|██████████| 313/313 [08:01<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00872, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.646]Epoch 109: 100%|██████████| 313/313 [08:01<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188267, 0.188552, 0.187485, 0.194313
Train average loss UNet                 (all)                : 0.758617

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000349, 1.843410, 3.762316
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001966, 2.165828, 3.774030
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003027, 2.267358, 3.862525
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002071, 2.209162, 3.959940
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002635, 2.359527, 4.137248
Train average loss all      (Triplet)                 : 0.001970

== Recognize ==
Train average loss Recognize     : 0.640149
Train average accuracy drums     : 69.574997 %
Train average accuracy bass      : 54.615002 %
Train average accuracy piano     : 54.245003 %
Train average accuracy guitar    : 55.444996 %
Train average accuracy residuals : 54.599998 %

== Train average loss all : 0.008372

Epoch 109:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]          Epoch 110:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]Epoch 110:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]Epoch 110:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.00615, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.615, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]Epoch 110:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.00615, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.615, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]Epoch 110:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.00958, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00353, Train/loss_recog_step=0.605, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]Epoch 110:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.00958, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00353, Train/loss_recog_step=0.605, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]Epoch 110:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.636, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]  Epoch 110:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.636, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]Epoch 110:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.638, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]Epoch 110:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.638, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]Epoch 110:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]Epoch 110:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]Epoch 110:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]Epoch 110: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]Epoch 110: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=0.733, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.30it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.43it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.01it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183788, 0.187066, 0.189175, 0.204209
Valid average loss UNet                 (all)                : 0.764239

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.050105, 1.641893, 3.149581
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.369157, 2.366373, 2.733989
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.384609, 2.440325, 2.557078
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.274256, 2.297032, 3.113338
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.270090, 2.484917, 3.093414
Valid average loss all      (Triplet)                 : 0.280232

== Recognize ==
Valid average loss Recognize     : 0.710878
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 56.000000 %

== Valid average loss all : 0.287341

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.411338329315186 sec. =
Valid knn accuracy drums     : 87.17391304347825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.205992221832275 sec. =
Valid knn accuracy bass      : 31.85483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.50707459449768 sec. =
Valid knn accuracy piano     : 52.1484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.533739566802979 sec. =
Valid knn accuracy guitar    : 48.214285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.22690200805664 sec. =
Valid knn accuracy residuals : 68.18181818181817%

Valid knn accuracy average   : 57.51465862985191%

                                                                      [AEpoch 110: 100%|██████████| 313/313 [07:58<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00837, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.640]Epoch 110: 100%|██████████| 313/313 [07:58<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188480, 0.188790, 0.187697, 0.194699
Train average loss UNet                 (all)                : 0.759666

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000461, 1.773370, 3.585747
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002813, 2.160251, 3.740158
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004127, 2.200922, 3.723763
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002361, 2.164503, 3.843369
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002888, 2.304277, 4.021702
Train average loss all      (Triplet)                 : 0.002623

== Recognize ==
Train average loss Recognize     : 0.631655
Train average accuracy drums     : 72.845001 %
Train average accuracy bass      : 55.449997 %
Train average accuracy piano     : 54.210003 %
Train average accuracy guitar    : 55.409996 %
Train average accuracy residuals : 56.954998 %

== Train average loss all : 0.008940

Epoch 110:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]          Epoch 111:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]Epoch 111:  16%|█▌        | 50/313 [01:13<06:24,  0.68it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]Epoch 111:  16%|█▌        | 50/313 [01:13<06:24,  0.68it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]Epoch 111:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]Epoch 111:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.00724, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000437, Train/loss_recog_step=0.680, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]Epoch 111:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.00724, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000437, Train/loss_recog_step=0.680, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]Epoch 111:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]   Epoch 111:  64%|██████▍   | 200/313 [04:16<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]Epoch 111:  64%|██████▍   | 200/313 [04:16<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.669, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]Epoch 111:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.669, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]Epoch 111:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.00813, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=0.645, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]Epoch 111:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00813, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=0.645, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]Epoch 111:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.655, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]  Epoch 111: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.655, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]Epoch 111: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00976, Train/loss_recog_step=0.643, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.24it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.91it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.59it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.18it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.65it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184241, 0.187606, 0.189664, 0.194528
Valid average loss UNet                 (all)                : 0.756040

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.018144, 1.695616, 3.291204
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.416049, 2.662260, 2.997471
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.261145, 2.557930, 2.761849
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.308886, 2.497101, 3.372916
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.300354, 2.757376, 3.373327
Valid average loss all      (Triplet)                 : 0.286284

== Recognize ==
Valid average loss Recognize     : 0.704723
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.293331

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.33801555633545 sec. =
Valid knn accuracy drums     : 87.60869565217392%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.619626760482788 sec. =
Valid knn accuracy bass      : 29.435483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.522772550582886 sec. =
Valid knn accuracy piano     : 45.8984375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.270303010940552 sec. =
Valid knn accuracy guitar    : 60.04464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.536300420761108 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 58.0065428851478%

                                                                      [AEpoch 111: 100%|██████████| 313/313 [08:04<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00976, Train/loss_recog_step=0.643, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00894, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=0.632]Epoch 111: 100%|██████████| 313/313 [08:04<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00976, Train/loss_recog_step=0.643, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188432, 0.188738, 0.187612, 0.195414
Train average loss UNet                 (all)                : 0.760196

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000928, 1.859882, 3.718647
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003508, 2.226133, 3.829940
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003155, 2.269203, 3.881598
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002887, 2.263876, 3.991486
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002216, 2.398684, 4.192451
Train average loss all      (Triplet)                 : 0.002501

== Recognize ==
Train average loss Recognize     : 0.641297
Train average accuracy drums     : 68.150002 %
Train average accuracy bass      : 53.125000 %
Train average accuracy piano     : 53.705002 %
Train average accuracy guitar    : 55.694996 %
Train average accuracy residuals : 55.825001 %

== Train average loss all : 0.008913

Epoch 111:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00976, Train/loss_recog_step=0.643, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641]          Epoch 112:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00976, Train/loss_recog_step=0.643, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641]Epoch 112:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00976, Train/loss_recog_step=0.643, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641]Epoch 112:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00725, Train/loss_recog_step=0.645, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641]Epoch 112:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00725, Train/loss_recog_step=0.645, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641]Epoch 112:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00629, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.629, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641] Epoch 112:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.00629, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.629, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641]Epoch 112:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641]Epoch 112:  64%|██████▍   | 200/313 [04:11<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641]Epoch 112:  64%|██████▍   | 200/313 [04:11<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00608, Train/loss_recog_step=0.646, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641]Epoch 112:  80%|███████▉  | 250/313 [05:11<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00608, Train/loss_recog_step=0.646, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641]Epoch 112:  80%|███████▉  | 250/313 [05:11<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.00629, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.629, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641] Epoch 112:  96%|█████████▌| 300/313 [06:10<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.00629, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.629, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641]Epoch 112:  96%|█████████▌| 300/313 [06:10<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.00674, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000353, Train/loss_recog_step=0.639, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641]Epoch 112: 100%|██████████| 313/313 [06:23<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00674, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000353, Train/loss_recog_step=0.639, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641]Epoch 112: 100%|██████████| 313/313 [06:23<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.626, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.49it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.11it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.92it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.06it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.51it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183225, 0.186569, 0.188454, 0.204717
Valid average loss UNet                 (all)                : 0.762966

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.046850, 1.669813, 3.212716
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.405097, 2.396581, 2.776069
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.298657, 2.363302, 2.672746
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.286960, 2.323010, 3.099783
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.271853, 2.628409, 3.220830
Valid average loss all      (Triplet)                 : 0.277589

== Recognize ==
Valid average loss Recognize     : 0.729802
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 42.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 60.000004 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.284887

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.342560291290283 sec. =
Valid knn accuracy drums     : 80.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.697079420089722 sec. =
Valid knn accuracy bass      : 35.28225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.515066862106323 sec. =
Valid knn accuracy piano     : 44.53125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.350653886795044 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.231529474258423 sec. =
Valid knn accuracy residuals : 65.22727272727272%

Valid knn accuracy average   : 55.138590940966466%

                                                                      [AEpoch 112: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00891, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=0.641]Epoch 112: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188687, 0.188990, 0.187891, 0.195053
Train average loss UNet                 (all)                : 0.760621

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000549, 1.856145, 3.762424
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002900, 2.207085, 3.806918
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004208, 2.257684, 3.832731
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002586, 2.256090, 4.025309
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001972, 2.342560, 4.118412
Train average loss all      (Triplet)                 : 0.002468

== Recognize ==
Train average loss Recognize     : 0.641828
Train average accuracy drums     : 67.675003 %
Train average accuracy bass      : 53.925003 %
Train average accuracy piano     : 54.079998 %
Train average accuracy guitar    : 54.250000 %
Train average accuracy residuals : 55.980003 %

== Train average loss all : 0.008887

Epoch 112:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]          Epoch 113:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]Epoch 113:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]Epoch 113:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]Epoch 113:  32%|███▏      | 100/313 [02:12<04:42,  0.76it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]Epoch 113:  32%|███▏      | 100/313 [02:12<04:42,  0.76it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]Epoch 113:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]Epoch 113:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]Epoch 113:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]Epoch 113:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0056, Train/loss_recog_step=0.680, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]Epoch 113:  80%|███████▉  | 250/313 [05:14<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0056, Train/loss_recog_step=0.680, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]Epoch 113:  80%|███████▉  | 250/313 [05:14<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642] Epoch 113:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]Epoch 113:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00376, Train/loss_recog_step=0.652, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]Epoch 113: 100%|██████████| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00376, Train/loss_recog_step=0.652, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]Epoch 113: 100%|██████████| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.37it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.12it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.50it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.14it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184404, 0.187754, 0.189915, 0.198751
Valid average loss UNet                 (all)                : 0.760824

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.035954, 1.674519, 3.181957
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.495984, 2.606897, 2.855966
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.338997, 2.428828, 2.679805
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.376345, 2.434773, 3.328184
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.284654, 2.614058, 3.124960
Valid average loss all      (Triplet)                 : 0.332451

== Recognize ==
Valid average loss Recognize     : 0.718165
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.339633

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.792306184768677 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.424002647399902 sec. =
Valid knn accuracy bass      : 22.58064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.709201335906982 sec. =
Valid knn accuracy piano     : 46.6796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.290144443511963 sec. =
Valid knn accuracy guitar    : 47.99107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.270681381225586 sec. =
Valid knn accuracy residuals : 65.22727272727272%

Valid knn accuracy average   : 53.017474493861684%

                                                                      [AEpoch 113: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00889, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=0.642]Epoch 113: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188292, 0.188600, 0.187511, 0.194554
Train average loss UNet                 (all)                : 0.758956

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000338, 1.843153, 3.775697
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001590, 2.156226, 3.727139
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002014, 2.234815, 3.859246
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001094, 2.229187, 4.012864
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001738, 2.313464, 4.090219
Train average loss all      (Triplet)                 : 0.001373

== Recognize ==
Train average loss Recognize     : 0.631510
Train average accuracy drums     : 70.880005 %
Train average accuracy bass      : 55.019997 %
Train average accuracy piano     : 54.230000 %
Train average accuracy guitar    : 55.554996 %
Train average accuracy residuals : 57.505001 %

== Train average loss all : 0.007688

Epoch 113:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]          Epoch 114:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]Epoch 114:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]Epoch 114:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]Epoch 114:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]Epoch 114:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00421, Train/loss_recog_step=0.627, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]Epoch 114:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00421, Train/loss_recog_step=0.627, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]Epoch 114:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632] Epoch 114:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]Epoch 114:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]Epoch 114:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]Epoch 114:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00807, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=0.624, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]Epoch 114:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00807, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=0.624, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]Epoch 114:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00948, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00286, Train/loss_recog_step=0.661, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]Epoch 114: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00948, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00286, Train/loss_recog_step=0.661, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]Epoch 114: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.710, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.14it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.90it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.72it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.07it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184014, 0.187392, 0.189334, 0.200871
Valid average loss UNet                 (all)                : 0.761611

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.024439, 1.691121, 3.242393
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.447787, 2.563257, 2.751497
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.397990, 2.400502, 2.571597
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.406066, 2.458461, 3.142351
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.266625, 2.510843, 2.961710
Valid average loss all      (Triplet)                 : 0.326301

== Recognize ==
Valid average loss Recognize     : 0.700461
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.333305

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.905375719070435 sec. =
Valid knn accuracy drums     : 87.82608695652175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.180085897445679 sec. =
Valid knn accuracy bass      : 31.653225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.759504318237305 sec. =
Valid knn accuracy piano     : 42.3828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.361249446868896 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.3755943775177 sec. =
Valid knn accuracy residuals : 68.63636363636364%

Valid knn accuracy average   : 56.099697779867405%

                                                                      [AEpoch 114: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00137, Train/loss_recog_epoch=0.632]Epoch 114: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188089, 0.188392, 0.187319, 0.194339
Train average loss UNet                 (all)                : 0.758140

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000392, 1.789520, 3.601647
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002608, 2.159677, 3.704522
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001970, 2.201854, 3.805488
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002330, 2.240512, 3.971392
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002271, 2.309587, 4.048329
Train average loss all      (Triplet)                 : 0.001920

== Recognize ==
Train average loss Recognize     : 0.632386
Train average accuracy drums     : 73.379997 %
Train average accuracy bass      : 53.904999 %
Train average accuracy piano     : 54.730000 %
Train average accuracy guitar    : 55.379997 %
Train average accuracy residuals : 56.674999 %

== Train average loss all : 0.008244

Epoch 114:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]          Epoch 115:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]Epoch 115:  16%|█▌        | 50/313 [01:11<06:18,  0.70it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]Epoch 115:  16%|█▌        | 50/313 [01:11<06:18,  0.70it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00701, Train/loss_recog_step=0.617, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]Epoch 115:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00701, Train/loss_recog_step=0.617, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]Epoch 115:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.0083, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00191, Train/loss_recog_step=0.639, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]Epoch 115:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.0083, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00191, Train/loss_recog_step=0.639, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]Epoch 115:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632] Epoch 115:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]Epoch 115:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.00919, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00278, Train/loss_recog_step=0.641, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]Epoch 115:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00919, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00278, Train/loss_recog_step=0.641, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]Epoch 115:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]  Epoch 115:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]Epoch 115:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00664, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.664, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]Epoch 115: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00664, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.664, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]Epoch 115: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.589, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.666, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.20it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.50it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.54it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.63it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184370, 0.187799, 0.189695, 0.193016
Valid average loss UNet                 (all)                : 0.754881

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.034540, 1.647124, 3.040884
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.334608, 2.378328, 2.707027
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.389272, 2.374599, 2.398816
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.356138, 2.346190, 3.155694
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.232004, 2.516430, 3.189984
Valid average loss all      (Triplet)                 : 0.277738

== Recognize ==
Valid average loss Recognize     : 0.740828
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.285146

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.27762746810913 sec. =
Valid knn accuracy drums     : 86.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.292111873626709 sec. =
Valid knn accuracy bass      : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.73699426651001 sec. =
Valid knn accuracy piano     : 45.5078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.312936305999756 sec. =
Valid knn accuracy guitar    : 52.23214285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.244882583618164 sec. =
Valid knn accuracy residuals : 67.27272727272727%

Valid knn accuracy average   : 55.30688435206098%

                                                                      [AEpoch 115: 100%|██████████| 313/313 [08:00<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.589, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00824, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=0.632]Epoch 115: 100%|██████████| 313/313 [08:00<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.589, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188424, 0.188703, 0.187620, 0.194682
Train average loss UNet                 (all)                : 0.759429

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000602, 1.846847, 3.772354
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002670, 2.182070, 3.748774
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003298, 2.268870, 3.874128
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002164, 2.256122, 4.029704
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003242, 2.375051, 4.149437
Train average loss all      (Triplet)                 : 0.002391

== Recognize ==
Train average loss Recognize     : 0.630147
Train average accuracy drums     : 71.044998 %
Train average accuracy bass      : 54.700001 %
Train average accuracy piano     : 54.665001 %
Train average accuracy guitar    : 56.255001 %
Train average accuracy residuals : 56.605000 %

== Train average loss all : 0.008692

Epoch 115:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.589, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]          Epoch 116:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.589, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]Epoch 116:  16%|█▌        | 50/313 [01:11<06:17,  0.70it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.589, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]Epoch 116:  16%|█▌        | 50/313 [01:11<06:17,  0.70it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]Epoch 116:  32%|███▏      | 100/313 [02:14<04:47,  0.74it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]Epoch 116:  32%|███▏      | 100/313 [02:14<04:47,  0.74it/s, v_num=0, Train/loss_all_step=0.00608, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.608, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]Epoch 116:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.00608, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.608, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]Epoch 116:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]Epoch 116:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]Epoch 116:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00486, Train/loss_recog_step=0.615, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]Epoch 116:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00486, Train/loss_recog_step=0.615, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]Epoch 116:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00663, Train/loss_recog_step=0.581, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]Epoch 116:  96%|█████████▌| 300/313 [06:18<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00663, Train/loss_recog_step=0.581, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]Epoch 116:  96%|█████████▌| 300/313 [06:18<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00618, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.618, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630] Epoch 116: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00618, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.618, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]Epoch 116: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00803, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=0.650, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.28it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.99it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.57it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.17it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.66it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184557, 0.187893, 0.190199, 0.202658
Valid average loss UNet                 (all)                : 0.765306

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.033567, 1.645029, 3.294864
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.404735, 2.671022, 3.018156
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.293404, 2.385720, 2.531053
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.400324, 2.330841, 2.922294
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.310788, 2.654929, 3.308448
Valid average loss all      (Triplet)                 : 0.301798

== Recognize ==
Valid average loss Recognize     : 0.687639
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.308675

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.391846418380737 sec. =
Valid knn accuracy drums     : 86.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.304439544677734 sec. =
Valid knn accuracy bass      : 36.895161290322584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.834343433380127 sec. =
Valid knn accuracy piano     : 45.8984375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.300177097320557 sec. =
Valid knn accuracy guitar    : 51.5625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.308460712432861 sec. =
Valid knn accuracy residuals : 62.04545454545455%

Valid knn accuracy average   : 56.67161501498151%

                                                                      [AEpoch 116: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00803, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=0.650, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=0.630]Epoch 116: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00803, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=0.650, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188554, 0.188861, 0.187782, 0.194889
Train average loss UNet                 (all)                : 0.760087

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000754, 1.824539, 3.725514
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003331, 2.252715, 3.890652
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002278, 2.246670, 3.858943
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001585, 2.242501, 4.028728
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002174, 2.386703, 4.219537
Train average loss all      (Triplet)                 : 0.002088

== Recognize ==
Train average loss Recognize     : 0.632046
Train average accuracy drums     : 70.434998 %
Train average accuracy bass      : 53.745003 %
Train average accuracy piano     : 54.325001 %
Train average accuracy guitar    : 55.285000 %
Train average accuracy residuals : 57.454998 %

== Train average loss all : 0.008409

Epoch 116:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00803, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=0.650, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]          Epoch 117:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00803, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=0.650, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]Epoch 117:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.00803, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=0.650, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]Epoch 117:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.00978, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00314, Train/loss_recog_step=0.664, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]Epoch 117:  32%|███▏      | 100/313 [02:15<04:48,  0.74it/s, v_num=0, Train/loss_all_step=0.00978, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00314, Train/loss_recog_step=0.664, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]Epoch 117:  32%|███▏      | 100/313 [02:15<04:48,  0.74it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00955, Train/loss_recog_step=0.652, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632] Epoch 117:  48%|████▊     | 150/313 [03:17<03:34,  0.76it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00955, Train/loss_recog_step=0.652, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]Epoch 117:  48%|████▊     | 150/313 [03:17<03:34,  0.76it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000407, Train/loss_recog_step=0.653, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]Epoch 117:  64%|██████▍   | 200/313 [04:17<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000407, Train/loss_recog_step=0.653, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]Epoch 117:  64%|██████▍   | 200/313 [04:17<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.638, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]  Epoch 117:  80%|███████▉  | 250/313 [05:20<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.638, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]Epoch 117:  80%|███████▉  | 250/313 [05:20<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.00647, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.647, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632] Epoch 117:  96%|█████████▌| 300/313 [06:21<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00647, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.647, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]Epoch 117:  96%|█████████▌| 300/313 [06:21<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]Epoch 117: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]Epoch 117: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.601, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.29it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.04it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185809, 0.189142, 0.191740, 0.202977
Valid average loss UNet                 (all)                : 0.769668

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060799, 1.839346, 3.594274
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.418021, 2.837104, 3.222896
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.288027, 2.542986, 2.714477
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.368318, 2.587950, 3.282949
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.288454, 2.624171, 3.323129
Valid average loss all      (Triplet)                 : 0.306397

== Recognize ==
Valid average loss Recognize     : 0.711806
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 56.000000 %

== Valid average loss all : 0.313515

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.374546766281128 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.364423513412476 sec. =
Valid knn accuracy bass      : 27.82258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.72693657875061 sec. =
Valid knn accuracy piano     : 47.65625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.364976167678833 sec. =
Valid knn accuracy guitar    : 54.46428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.764817237854004 sec. =
Valid knn accuracy residuals : 65.22727272727272%

Valid knn accuracy average   : 55.72972999125698%

                                                                      [AEpoch 117: 100%|██████████| 313/313 [08:07<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=0.632]Epoch 117: 100%|██████████| 313/313 [08:07<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188971, 0.189245, 0.188147, 0.194096
Train average loss UNet                 (all)                : 0.760458

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000261, 1.833978, 3.772901
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003589, 2.320865, 4.020483
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002193, 2.279033, 3.955574
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001749, 2.240926, 4.023374
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003490, 2.428444, 4.238210
Train average loss all      (Triplet)                 : 0.002340

== Recognize ==
Train average loss Recognize     : 0.637305
Train average accuracy drums     : 71.450005 %
Train average accuracy bass      : 53.004997 %
Train average accuracy piano     : 53.890003 %
Train average accuracy guitar    : 55.279999 %
Train average accuracy residuals : 56.470001 %

== Train average loss all : 0.008713

Epoch 117:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637]          Epoch 118:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637]Epoch 118:  16%|█▌        | 50/313 [01:12<06:21,  0.69it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637]Epoch 118:  16%|█▌        | 50/313 [01:12<06:21,  0.69it/s, v_num=0, Train/loss_all_step=0.00723, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000819, Train/loss_recog_step=0.641, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637]Epoch 118:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.00723, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000819, Train/loss_recog_step=0.641, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637]Epoch 118:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00516, Train/loss_recog_step=0.610, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637]  Epoch 118:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00516, Train/loss_recog_step=0.610, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637]Epoch 118:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000238, Train/loss_recog_step=0.633, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637]Epoch 118:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000238, Train/loss_recog_step=0.633, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637]Epoch 118:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.00848, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00217, Train/loss_recog_step=0.631, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637] Epoch 118:  80%|███████▉  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.00848, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00217, Train/loss_recog_step=0.631, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637]Epoch 118:  80%|███████▉  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.00713, Train/loss_recog_step=0.628, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637] Epoch 118:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.00713, Train/loss_recog_step=0.628, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637]Epoch 118:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00664, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.664, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637] Epoch 118: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00664, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.664, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637]Epoch 118: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00925, Train/loss_recog_step=0.615, Valid/loss_all_step=0.279, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=0.668, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.33it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.33it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.88it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.04it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.85it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.61it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184315, 0.187663, 0.189784, 0.198855
Valid average loss UNet                 (all)                : 0.760618

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.047681, 1.786376, 3.289298
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.422033, 2.759606, 3.174835
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.338187, 2.531563, 2.700196
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.319741, 2.449539, 3.155917
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.260671, 2.609653, 3.302751
Valid average loss all      (Triplet)                 : 0.295720

== Recognize ==
Valid average loss Recognize     : 0.779511
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 43.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 43.500000 %

== Valid average loss all : 0.303515

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.350963592529297 sec. =
Valid knn accuracy drums     : 87.60869565217392%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.345375537872314 sec. =
Valid knn accuracy bass      : 33.66935483870967%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.922492504119873 sec. =
Valid knn accuracy piano     : 43.9453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.626905918121338 sec. =
Valid knn accuracy guitar    : 48.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.153375148773193 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 56.27762714363127%

                                                                      [AEpoch 118: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00925, Train/loss_recog_step=0.615, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=0.637]Epoch 118: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00925, Train/loss_recog_step=0.615, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189299, 0.189600, 0.188475, 0.194134
Train average loss UNet                 (all)                : 0.761509

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000740, 1.830366, 3.808082
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003990, 2.256282, 3.868624
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004056, 2.283143, 3.882067
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003779, 2.238318, 3.920948
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002384, 2.394769, 4.163668
Train average loss all      (Triplet)                 : 0.003014

== Recognize ==
Train average loss Recognize     : 0.638424
Train average accuracy drums     : 69.294998 %
Train average accuracy bass      : 53.825005 %
Train average accuracy piano     : 54.575001 %
Train average accuracy guitar    : 55.134998 %
Train average accuracy residuals : 55.459999 %

== Train average loss all : 0.009398

Epoch 118:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00925, Train/loss_recog_step=0.615, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638]          Epoch 119:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00925, Train/loss_recog_step=0.615, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638]Epoch 119:  16%|█▌        | 50/313 [01:12<06:19,  0.69it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00925, Train/loss_recog_step=0.615, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638]Epoch 119:  16%|█▌        | 50/313 [01:12<06:19,  0.69it/s, v_num=0, Train/loss_all_step=0.0208, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.585, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638]  Epoch 119:  32%|███▏      | 100/313 [02:14<04:46,  0.74it/s, v_num=0, Train/loss_all_step=0.0208, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.585, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638]Epoch 119:  32%|███▏      | 100/313 [02:14<04:46,  0.74it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638]Epoch 119:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638]Epoch 119:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.631, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638]Epoch 119:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.631, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638]Epoch 119:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00349, Train/loss_recog_step=0.669, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638]Epoch 119:  80%|███████▉  | 250/313 [05:14<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00349, Train/loss_recog_step=0.669, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638]Epoch 119:  80%|███████▉  | 250/313 [05:14<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.00781, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.642, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638]Epoch 119:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00781, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.642, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638]Epoch 119:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.613, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638] Epoch 119: 100%|██████████| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.613, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638]Epoch 119: 100%|██████████| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=0.820, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.45it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.16it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.57it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.63it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183866, 0.187244, 0.189166, 0.191360
Valid average loss UNet                 (all)                : 0.751636

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.032100, 1.634775, 3.190803
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.409680, 2.578151, 2.953576
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.283883, 2.375234, 2.606431
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.303251, 2.244722, 3.013850
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.298641, 2.478070, 3.174672
Valid average loss all      (Triplet)                 : 0.281518

== Recognize ==
Valid average loss Recognize     : 0.756901
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.289087

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.342987775802612 sec. =
Valid knn accuracy drums     : 84.1304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.575042963027954 sec. =
Valid knn accuracy bass      : 28.42741935483871%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.55258846282959 sec. =
Valid knn accuracy piano     : 43.9453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.318918228149414 sec. =
Valid knn accuracy guitar    : 48.660714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.525356769561768 sec. =
Valid knn accuracy residuals : 68.86363636363636%

Valid knn accuracy average   : 54.805503457359606%

                                                                      [AEpoch 119: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.0094, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.638]Epoch 119: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188953, 0.189250, 0.188137, 0.195193
Train average loss UNet                 (all)                : 0.761532

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000417, 1.780540, 3.624187
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002097, 2.169670, 3.759412
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002344, 2.218778, 3.810206
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001921, 2.180066, 3.878240
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002785, 2.362168, 4.114547
Train average loss all      (Triplet)                 : 0.001973

== Recognize ==
Train average loss Recognize     : 0.634554
Train average accuracy drums     : 72.485001 %
Train average accuracy bass      : 54.280003 %
Train average accuracy piano     : 52.964996 %
Train average accuracy guitar    : 54.724998 %
Train average accuracy residuals : 57.180000 %

== Train average loss all : 0.008318

Epoch 119:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]          Epoch 120:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]Epoch 120:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]Epoch 120:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.00739, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000964, Train/loss_recog_step=0.642, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]Epoch 120:  32%|███▏      | 100/313 [02:12<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.00739, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000964, Train/loss_recog_step=0.642, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]Epoch 120:  32%|███▏      | 100/313 [02:12<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]   Epoch 120:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]Epoch 120:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.675, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635] Epoch 120:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.675, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]Epoch 120:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000699, Train/loss_recog_step=0.607, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]Epoch 120:  80%|███████▉  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000699, Train/loss_recog_step=0.607, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]Epoch 120:  80%|███████▉  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.734, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]   Epoch 120:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.734, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]Epoch 120:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]Epoch 120: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]Epoch 120: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.26it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.21it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.10it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.86it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.88it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184627, 0.187999, 0.190374, 0.205091
Valid average loss UNet                 (all)                : 0.768090

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.033046, 1.572861, 3.016326
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.412995, 2.359381, 2.710830
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.322495, 2.295726, 2.520004
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.307455, 2.195993, 2.871897
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.227957, 2.342388, 2.955844
Valid average loss all      (Triplet)                 : 0.282896

== Recognize ==
Valid average loss Recognize     : 0.694861
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.289845

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.387642860412598 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.24954605102539 sec. =
Valid knn accuracy bass      : 35.685483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.830602407455444 sec. =
Valid knn accuracy piano     : 44.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.527068376541138 sec. =
Valid knn accuracy guitar    : 46.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.47766923904419 sec. =
Valid knn accuracy residuals : 68.18181818181817%

Valid knn accuracy average   : 55.67223758447023%

                                                                      [AEpoch 120: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00832, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=0.635]Epoch 120: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188957, 0.189255, 0.188132, 0.194668
Train average loss UNet                 (all)                : 0.761012

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000187, 1.717232, 3.553715
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001674, 2.067140, 3.607193
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001907, 2.168620, 3.731781
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000940, 2.095743, 3.783718
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002573, 2.293802, 4.044301
Train average loss all      (Triplet)                 : 0.001508

== Recognize ==
Train average loss Recognize     : 0.622742
Train average accuracy drums     : 75.375000 %
Train average accuracy bass      : 56.304996 %
Train average accuracy piano     : 54.395000 %
Train average accuracy guitar    : 57.055004 %
Train average accuracy residuals : 57.760002 %

== Train average loss all : 0.007736

Epoch 120:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]          Epoch 121:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]Epoch 121:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]Epoch 121:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]Epoch 121:  32%|███▏      | 100/313 [02:09<04:34,  0.77it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]Epoch 121:  32%|███▏      | 100/313 [02:09<04:34,  0.77it/s, v_num=0, Train/loss_all_step=0.00906, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00287, Train/loss_recog_step=0.619, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]Epoch 121:  48%|████▊     | 150/313 [03:06<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00906, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00287, Train/loss_recog_step=0.619, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]Epoch 121:  48%|████▊     | 150/313 [03:06<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]  Epoch 121:  64%|██████▍   | 200/313 [04:04<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]Epoch 121:  64%|██████▍   | 200/313 [04:04<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]Epoch 121:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]Epoch 121:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.599, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]Epoch 121:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.599, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]Epoch 121:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00433, Train/loss_recog_step=0.648, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]Epoch 121: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00433, Train/loss_recog_step=0.648, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]Epoch 121: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=0.583, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.23it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.64it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.91it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.64it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.44it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184301, 0.187635, 0.189864, 0.199676
Valid average loss UNet                 (all)                : 0.761475

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.020880, 1.518040, 3.072731
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.335442, 2.160023, 2.471062
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.318412, 2.181534, 2.306323
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.287043, 2.126449, 2.883358
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.249117, 2.223470, 2.923417
Valid average loss all      (Triplet)                 : 0.260849

== Recognize ==
Valid average loss Recognize     : 0.689164
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.267741

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.754067182540894 sec. =
Valid knn accuracy drums     : 85.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.141706943511963 sec. =
Valid knn accuracy bass      : 24.596774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.141704797744751 sec. =
Valid knn accuracy piano     : 40.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.465276956558228 sec. =
Valid knn accuracy guitar    : 54.91071428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.19747281074524 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 54.99429043300669%

                                                                      [AEpoch 121: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00774, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=0.623]Epoch 121: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188554, 0.188867, 0.187773, 0.194574
Train average loss UNet                 (all)                : 0.759769

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000533, 1.725337, 3.586106
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001102, 2.057920, 3.579689
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002733, 2.134377, 3.637841
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001115, 2.092944, 3.779202
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001521, 2.292520, 4.057191
Train average loss all      (Triplet)                 : 0.001381

== Recognize ==
Train average loss Recognize     : 0.623091
Train average accuracy drums     : 74.849998 %
Train average accuracy bass      : 56.449997 %
Train average accuracy piano     : 53.890003 %
Train average accuracy guitar    : 56.765003 %
Train average accuracy residuals : 58.420002 %

== Train average loss all : 0.007612

Epoch 121:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]          Epoch 122:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]Epoch 122:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]Epoch 122:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]Epoch 122:  32%|███▏      | 100/313 [02:07<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]Epoch 122:  32%|███▏      | 100/313 [02:07<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]Epoch 122:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]Epoch 122:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.638, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]Epoch 122:  64%|██████▍   | 200/313 [04:02<02:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.638, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]Epoch 122:  64%|██████▍   | 200/313 [04:02<02:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]Epoch 122:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]Epoch 122:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]Epoch 122:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]Epoch 122:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623] Epoch 122: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]Epoch 122: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.630, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.56it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.52it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.23it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.13it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.83it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183596, 0.186901, 0.189103, 0.207664
Valid average loss UNet                 (all)                : 0.767264

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.040634, 1.674297, 3.396542
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.427817, 2.413129, 2.803920
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.324396, 2.335209, 2.491577
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.328315, 2.356252, 3.128043
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.248653, 2.380966, 3.284658
Valid average loss all      (Triplet)                 : 0.292605

== Recognize ==
Valid average loss Recognize     : 0.721868
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.299824

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.429518461227417 sec. =
Valid knn accuracy drums     : 86.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.731746673583984 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.766701936721802 sec. =
Valid knn accuracy piano     : 39.0625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.309020042419434 sec. =
Valid knn accuracy guitar    : 48.214285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.555322170257568 sec. =
Valid knn accuracy residuals : 69.31818181818183%

Valid knn accuracy average   : 54.38631468461412%

                                                                      [AEpoch 122: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00761, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.623]Epoch 122: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188387, 0.188717, 0.187611, 0.194472
Train average loss UNet                 (all)                : 0.759188

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000354, 1.729838, 3.605286
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001805, 2.063371, 3.569896
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002337, 2.147470, 3.664983
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001862, 2.121938, 3.838673
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001973, 2.291460, 4.036250
Train average loss all      (Triplet)                 : 0.001649

== Recognize ==
Train average loss Recognize     : 0.622855
Train average accuracy drums     : 75.639999 %
Train average accuracy bass      : 56.585003 %
Train average accuracy piano     : 55.500000 %
Train average accuracy guitar    : 56.620003 %
Train average accuracy residuals : 58.139999 %

== Train average loss all : 0.007878

Epoch 122:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]          Epoch 123:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]Epoch 123:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]Epoch 123:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]Epoch 123:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]Epoch 123:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.00582, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.582, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]Epoch 123:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00582, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.582, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]Epoch 123:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]Epoch 123:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]Epoch 123:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00642, Train/loss_recog_step=0.654, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]Epoch 123:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00642, Train/loss_recog_step=0.654, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]Epoch 123:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00989, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00376, Train/loss_recog_step=0.613, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]Epoch 123:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00989, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00376, Train/loss_recog_step=0.613, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]Epoch 123:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000281, Train/loss_recog_step=0.608, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]Epoch 123: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000281, Train/loss_recog_step=0.608, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]Epoch 123: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.300, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.293, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.47it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.05it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.61it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183653, 0.186975, 0.189092, 0.203961
Valid average loss UNet                 (all)                : 0.763681

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.048431, 1.674524, 3.256078
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.444946, 2.583091, 2.895563
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.373728, 2.439054, 2.531783
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.308667, 2.359487, 3.151092
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.271790, 2.365033, 2.990143
Valid average loss all      (Triplet)                 : 0.309371

== Recognize ==
Valid average loss Recognize     : 0.706027
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.316432

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.459718465805054 sec. =
Valid knn accuracy drums     : 88.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.432160377502441 sec. =
Valid knn accuracy bass      : 34.274193548387096%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.907413482666016 sec. =
Valid knn accuracy piano     : 41.015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.477668285369873 sec. =
Valid knn accuracy guitar    : 53.34821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.349180221557617 sec. =
Valid knn accuracy residuals : 72.27272727272728%

Valid knn accuracy average   : 57.87780419527877%

                                                                      [AEpoch 123: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00788, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=0.623]Epoch 123: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188551, 0.188856, 0.187757, 0.194526
Train average loss UNet                 (all)                : 0.759690

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000200, 1.733206, 3.584337
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001808, 2.106807, 3.648065
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002388, 2.168317, 3.683449
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001785, 2.133308, 3.868814
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001628, 2.313783, 4.083481
Train average loss all      (Triplet)                 : 0.001546

== Recognize ==
Train average loss Recognize     : 0.628001
Train average accuracy drums     : 75.375000 %
Train average accuracy bass      : 55.624996 %
Train average accuracy piano     : 54.744999 %
Train average accuracy guitar    : 56.274998 %
Train average accuracy residuals : 56.919998 %

== Train average loss all : 0.007826

Epoch 123:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]          Epoch 124:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]Epoch 124:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]Epoch 124:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]Epoch 124:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]Epoch 124:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000591, Train/loss_recog_step=0.608, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]Epoch 124:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000591, Train/loss_recog_step=0.608, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]Epoch 124:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0082, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00226, Train/loss_recog_step=0.594, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]  Epoch 124:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0082, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00226, Train/loss_recog_step=0.594, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]Epoch 124:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00432, Train/loss_recog_step=0.639, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]Epoch 124:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00432, Train/loss_recog_step=0.639, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]Epoch 124:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=7.9e-5, Train/loss_recog_step=0.624, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]Epoch 124:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=7.9e-5, Train/loss_recog_step=0.624, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]Epoch 124:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]  Epoch 124: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]Epoch 124: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000261, Train/loss_recog_step=0.662, Valid/loss_all_step=0.257, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.697, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.35it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.20it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  2.79it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.37it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.56it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182493, 0.185829, 0.187525, 0.202205
Valid average loss UNet                 (all)                : 0.758052

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.034195, 1.626422, 3.278959
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.495728, 2.489627, 2.639740
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.369948, 2.349450, 2.447137
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.287233, 2.233477, 3.013489
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.255550, 2.360418, 2.925442
Valid average loss all      (Triplet)                 : 0.311576

== Recognize ==
Valid average loss Recognize     : 0.763801
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 44.500000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.319214

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.336684942245483 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.380648851394653 sec. =
Valid knn accuracy bass      : 32.45967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.798633098602295 sec. =
Valid knn accuracy piano     : 39.453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.40839672088623 sec. =
Valid knn accuracy guitar    : 61.16071428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.394171476364136 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 57.20165986275296%

                                                                      [AEpoch 124: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000261, Train/loss_recog_step=0.662, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.628]Epoch 124: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000261, Train/loss_recog_step=0.662, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188900, 0.189208, 0.188099, 0.194046
Train average loss UNet                 (all)                : 0.760253

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000745, 1.789275, 3.688226
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003084, 2.157146, 3.703311
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001795, 2.174319, 3.730130
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001610, 2.227486, 4.014831
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001613, 2.300939, 4.074272
Train average loss all      (Triplet)                 : 0.001768

== Recognize ==
Train average loss Recognize     : 0.625645
Train average accuracy drums     : 76.000000 %
Train average accuracy bass      : 55.795002 %
Train average accuracy piano     : 54.865002 %
Train average accuracy guitar    : 56.185001 %
Train average accuracy residuals : 57.740002 %

== Train average loss all : 0.008025

Epoch 124:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000261, Train/loss_recog_step=0.662, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]          Epoch 125:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000261, Train/loss_recog_step=0.662, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 125:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000261, Train/loss_recog_step=0.662, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 125:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]   Epoch 125:  32%|███▏      | 100/313 [02:06<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 125:  32%|███▏      | 100/313 [02:06<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 125:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 125:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 125:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 125:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.693, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 125:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.693, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 125:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.620, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626] Epoch 125:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.620, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 125:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00984, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.662, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 125: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00984, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.662, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 125: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.312, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.41it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.44it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.73it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.27it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184560, 0.187859, 0.190040, 0.193583
Valid average loss UNet                 (all)                : 0.756042

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.020010, 1.694137, 3.232995
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.425271, 2.665153, 3.062985
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.295480, 2.349710, 2.787562
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.278697, 2.357033, 3.267470
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.265449, 2.497210, 3.147939
Valid average loss all      (Triplet)                 : 0.278783

== Recognize ==
Valid average loss Recognize     : 0.729130
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.286074

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.341660737991333 sec. =
Valid knn accuracy drums     : 86.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.425415515899658 sec. =
Valid knn accuracy bass      : 43.95161290322581%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.475067138671875 sec. =
Valid knn accuracy piano     : 52.1484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.55095887184143 sec. =
Valid knn accuracy guitar    : 52.23214285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.19098949432373 sec. =
Valid knn accuracy residuals : 68.18181818181817%

Valid knn accuracy average   : 60.60715011452432%

                                                                      [AEpoch 125: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 125: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188792, 0.189098, 0.187990, 0.194482
Train average loss UNet                 (all)                : 0.760361

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000479, 1.871223, 3.816777
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003635, 2.284654, 3.922555
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004688, 2.319969, 3.908500
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002476, 2.285275, 4.063129
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003283, 2.467295, 4.350693
Train average loss all      (Triplet)                 : 0.002976

== Recognize ==
Train average loss Recognize     : 0.635126
Train average accuracy drums     : 72.364998 %
Train average accuracy bass      : 54.294998 %
Train average accuracy piano     : 53.289997 %
Train average accuracy guitar    : 56.015003 %
Train average accuracy residuals : 56.475002 %

== Train average loss all : 0.009327

Epoch 125:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]          Epoch 126:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]Epoch 126:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]Epoch 126:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00658, Train/loss_recog_step=0.630, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]Epoch 126:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00658, Train/loss_recog_step=0.630, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]Epoch 126:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00568, Train/loss_recog_step=0.627, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]Epoch 126:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00568, Train/loss_recog_step=0.627, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]Epoch 126:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635] Epoch 126:  64%|██████▍   | 200/313 [04:07<02:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]Epoch 126:  64%|██████▍   | 200/313 [04:07<02:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0098, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00283, Train/loss_recog_step=0.697, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]Epoch 126:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0098, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00283, Train/loss_recog_step=0.697, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]Epoch 126:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00722, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.00118, Train/loss_recog_step=0.604, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]Epoch 126:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00722, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.00118, Train/loss_recog_step=0.604, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]Epoch 126:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00684, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000101, Train/loss_recog_step=0.674, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]Epoch 126: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00684, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000101, Train/loss_recog_step=0.674, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]Epoch 126: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.606, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.36it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.94it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.34it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.14it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.10it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183910, 0.187200, 0.189501, 0.200080
Valid average loss UNet                 (all)                : 0.760690

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.028278, 1.746783, 3.484254
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.533994, 2.805441, 3.072701
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.309469, 2.650626, 2.950273
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.275877, 2.519224, 3.407724
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.292525, 2.609346, 3.283370
Valid average loss all      (Triplet)                 : 0.324243

== Recognize ==
Valid average loss Recognize     : 0.694875
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.331191

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.340311765670776 sec. =
Valid knn accuracy drums     : 88.91304347826086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.72549557685852 sec. =
Valid knn accuracy bass      : 37.903225806451616%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.54462718963623 sec. =
Valid knn accuracy piano     : 43.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.402567148208618 sec. =
Valid knn accuracy guitar    : 52.90178571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.243445634841919 sec. =
Valid knn accuracy residuals : 68.4090909090909%

Valid knn accuracy average   : 58.37542918161782%

                                                                      [AEpoch 126: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00933, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00298, Train/loss_recog_epoch=0.635]Epoch 126: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188925, 0.189210, 0.188115, 0.194292
Train average loss UNet                 (all)                : 0.760543

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000662, 1.800049, 3.582668
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003692, 2.252250, 3.833948
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003569, 2.298711, 3.900291
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001439, 2.232192, 3.979277
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003128, 2.399261, 4.207827
Train average loss all      (Triplet)                 : 0.002514

== Recognize ==
Train average loss Recognize     : 0.633229
Train average accuracy drums     : 73.755005 %
Train average accuracy bass      : 54.380001 %
Train average accuracy piano     : 53.175003 %
Train average accuracy guitar    : 56.585003 %
Train average accuracy residuals : 56.199997 %

== Train average loss all : 0.008847

Epoch 126:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]          Epoch 127:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]Epoch 127:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]Epoch 127:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]Epoch 127:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]Epoch 127:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]Epoch 127:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]Epoch 127:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0006, Train/loss_recog_step=0.628, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]Epoch 127:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0006, Train/loss_recog_step=0.628, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]Epoch 127:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633] Epoch 127:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]Epoch 127:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.734, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.585, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]Epoch 127:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.734, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.585, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]Epoch 127:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.656, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]Epoch 127: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.656, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]Epoch 127: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.395, Valid/loss_recog_step=0.634, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.42it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.98it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.41it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.14it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.02it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184099, 0.187378, 0.189615, 0.198386
Valid average loss UNet                 (all)                : 0.759479

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.040017, 1.593269, 3.047951
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.437390, 2.484015, 2.768242
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.357226, 2.420562, 2.485823
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.284150, 2.186948, 2.983514
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.279696, 2.316008, 2.750790
Valid average loss all      (Triplet)                 : 0.301426

== Recognize ==
Valid average loss Recognize     : 0.721773
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.308644

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.659231901168823 sec. =
Valid knn accuracy drums     : 87.82608695652175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.955612659454346 sec. =
Valid knn accuracy bass      : 40.12096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.076341390609741 sec. =
Valid knn accuracy piano     : 42.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.942776203155518 sec. =
Valid knn accuracy guitar    : 50.66964285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.338600873947144 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 57.56993042021092%

                                                                      [AEpoch 127: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00885, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00251, Train/loss_recog_epoch=0.633]Epoch 127: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188713, 0.189013, 0.187915, 0.193983
Train average loss UNet                 (all)                : 0.759624

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000542, 1.874995, 3.881754
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003420, 2.278342, 3.896760
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003224, 2.347270, 3.997465
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002050, 2.284231, 4.050285
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002170, 2.404312, 4.235734
Train average loss all      (Triplet)                 : 0.002304

== Recognize ==
Train average loss Recognize     : 0.632316
Train average accuracy drums     : 72.089996 %
Train average accuracy bass      : 54.680000 %
Train average accuracy piano     : 54.165001 %
Train average accuracy guitar    : 55.549995 %
Train average accuracy residuals : 56.945004 %

== Train average loss all : 0.008627

Epoch 127:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]          Epoch 128:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]Epoch 128:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]Epoch 128:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]Epoch 128:  32%|███▏      | 100/313 [02:07<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]Epoch 128:  32%|███▏      | 100/313 [02:07<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00476, Train/loss_recog_step=0.613, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]Epoch 128:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00476, Train/loss_recog_step=0.613, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]Epoch 128:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.020, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.616, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]  Epoch 128:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.020, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.616, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]Epoch 128:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]Epoch 128:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]Epoch 128:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]  Epoch 128:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]Epoch 128:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]Epoch 128: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]Epoch 128: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=0.675, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.40it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.85it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.63it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.56it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.82it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183294, 0.186543, 0.188715, 0.197829
Valid average loss UNet                 (all)                : 0.756382

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.045626, 1.529947, 3.052063
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.383565, 2.352262, 2.542042
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.395031, 2.281198, 2.320757
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.256792, 2.163716, 2.894519
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.283961, 2.328432, 2.808027
Valid average loss all      (Triplet)                 : 0.286327

== Recognize ==
Valid average loss Recognize     : 0.730749
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.293634

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.410114049911499 sec. =
Valid knn accuracy drums     : 85.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.725728750228882 sec. =
Valid knn accuracy bass      : 33.87096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.605916500091553 sec. =
Valid knn accuracy piano     : 43.1640625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.24408483505249 sec. =
Valid knn accuracy guitar    : 48.660714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.430822134017944 sec. =
Valid knn accuracy residuals : 64.0909090909091%

Valid knn accuracy average   : 55.13124376719004%

                                                                      [AEpoch 128: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00863, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=0.632]Epoch 128: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188175, 0.188469, 0.187401, 0.194257
Train average loss UNet                 (all)                : 0.758303

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000205, 1.812314, 3.703063
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003600, 2.221919, 3.811399
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001994, 2.312207, 3.969143
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002006, 2.239331, 3.984729
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001923, 2.416787, 4.299162
Train average loss all      (Triplet)                 : 0.001903

== Recognize ==
Train average loss Recognize     : 0.626323
Train average accuracy drums     : 77.360001 %
Train average accuracy bass      : 55.365002 %
Train average accuracy piano     : 54.235001 %
Train average accuracy guitar    : 57.410004 %
Train average accuracy residuals : 56.809998 %

== Train average loss all : 0.008166

Epoch 128:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]          Epoch 129:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]Epoch 129:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]Epoch 129:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000589, Train/loss_recog_step=0.604, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]Epoch 129:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000589, Train/loss_recog_step=0.604, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]Epoch 129:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00651, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.651, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]   Epoch 129:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.00651, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.651, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]Epoch 129:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.689, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]Epoch 129:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.689, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]Epoch 129:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0064, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.640, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626] Epoch 129:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0064, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.640, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]Epoch 129:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00515, Train/loss_recog_step=0.612, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]Epoch 129:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00515, Train/loss_recog_step=0.612, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]Epoch 129:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626] Epoch 129: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]Epoch 129: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00778, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.00158, Train/loss_recog_step=0.620, Valid/loss_all_step=0.227, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.662, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.731, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.17it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.13it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  2.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184125, 0.187385, 0.189816, 0.201677
Valid average loss UNet                 (all)                : 0.763003

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.034036, 1.655146, 3.287180
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.400505, 2.627258, 2.929447
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.334573, 2.442644, 2.781697
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.362775, 2.424857, 3.275284
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.295490, 2.500294, 3.193863
Valid average loss all      (Triplet)                 : 0.299933

== Recognize ==
Valid average loss Recognize     : 0.719952
Valid average accuracy drums     : 42.500000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 44.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.307132

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.375280857086182 sec. =
Valid knn accuracy drums     : 83.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.428437948226929 sec. =
Valid knn accuracy bass      : 37.29838709677419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.283228874206543 sec. =
Valid knn accuracy piano     : 41.796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.239119291305542 sec. =
Valid knn accuracy guitar    : 46.651785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.53455400466919 sec. =
Valid knn accuracy residuals : 72.27272727272728%

Valid knn accuracy average   : 56.25612892980091%

                                                                      [AEpoch 129: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00778, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.00158, Train/loss_recog_step=0.620, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00817, Train/loss_unet_all_epoch=0.758, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.626]Epoch 129: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00778, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.00158, Train/loss_recog_step=0.620, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188775, 0.189080, 0.187958, 0.194670
Train average loss UNet                 (all)                : 0.760483

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000231, 1.806172, 3.757399
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002893, 2.240767, 3.860632
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001567, 2.292236, 3.960236
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000909, 2.244119, 4.049435
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001882, 2.405967, 4.288426
Train average loss all      (Triplet)                 : 0.001518

== Recognize ==
Train average loss Recognize     : 0.626338
Train average accuracy drums     : 77.520004 %
Train average accuracy bass      : 54.674999 %
Train average accuracy piano     : 54.939999 %
Train average accuracy guitar    : 56.089996 %
Train average accuracy residuals : 58.125000 %

== Train average loss all : 0.007781

Epoch 129:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00778, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.00158, Train/loss_recog_step=0.620, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]          Epoch 130:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00778, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.00158, Train/loss_recog_step=0.620, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]Epoch 130:  16%|█▌        | 50/313 [01:11<06:14,  0.70it/s, v_num=0, Train/loss_all_step=0.00778, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.00158, Train/loss_recog_step=0.620, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]Epoch 130:  16%|█▌        | 50/313 [01:11<06:14,  0.70it/s, v_num=0, Train/loss_all_step=0.0157, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00935, Train/loss_recog_step=0.631, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626] Epoch 130:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.0157, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00935, Train/loss_recog_step=0.631, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]Epoch 130:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.00616, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.616, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626] Epoch 130:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00616, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.616, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]Epoch 130:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.636, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]Epoch 130:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.636, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]Epoch 130:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=4.09e-5, Train/loss_recog_step=0.667, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]Epoch 130:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=4.09e-5, Train/loss_recog_step=0.667, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]Epoch 130:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]  Epoch 130:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]Epoch 130:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00982, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00401, Train/loss_recog_step=0.582, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]Epoch 130: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00982, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00401, Train/loss_recog_step=0.582, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]Epoch 130: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.55it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.36it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.96it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.34it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.18it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183743, 0.187012, 0.189292, 0.202059
Valid average loss UNet                 (all)                : 0.762105

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.039211, 1.656918, 3.363644
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.434613, 2.577916, 2.898407
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.339688, 2.414931, 2.604044
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.272368, 2.401113, 3.307222
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.304763, 2.546919, 3.044681
Valid average loss all      (Triplet)                 : 0.299508

== Recognize ==
Valid average loss Recognize     : 0.706680
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 56.500000 %

== Valid average loss all : 0.306575

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.744202852249146 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.381600856781006 sec. =
Valid knn accuracy bass      : 36.29032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.927983045578003 sec. =
Valid knn accuracy piano     : 41.6015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.439804315567017 sec. =
Valid knn accuracy guitar    : 50.89285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.35676646232605 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 56.89133579647911%

                                                                      [AEpoch 130: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=0.626]Epoch 130: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188656, 0.188952, 0.187853, 0.194397
Train average loss UNet                 (all)                : 0.759858

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000177, 1.870625, 3.882020
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003471, 2.344578, 4.048454
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001352, 2.332191, 4.000295
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003634, 2.345887, 4.151134
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001191, 2.424034, 4.261996
Train average loss all      (Triplet)                 : 0.002017

== Recognize ==
Train average loss Recognize     : 0.628486
Train average accuracy drums     : 76.334999 %
Train average accuracy bass      : 54.285004 %
Train average accuracy piano     : 55.304996 %
Train average accuracy guitar    : 55.575001 %
Train average accuracy residuals : 57.505001 %

== Train average loss all : 0.008302

Epoch 130:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]          Epoch 131:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]Epoch 131:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]Epoch 131:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00649, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000458, Train/loss_recog_step=0.604, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]Epoch 131:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00649, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000458, Train/loss_recog_step=0.604, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]Epoch 131:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00576, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.576, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]   Epoch 131:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.00576, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.576, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]Epoch 131:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.0186, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=0.612, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]Epoch 131:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0186, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=0.612, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]Epoch 131:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.631, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]Epoch 131:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.631, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]Epoch 131:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00587, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.587, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]Epoch 131:  96%|█████████▌| 300/313 [05:59<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00587, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.587, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]Epoch 131:  96%|█████████▌| 300/313 [05:59<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.610, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628] Epoch 131: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.610, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]Epoch 131: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.709, Valid/loss_all_step=0.243, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.42it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.19it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.26it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.70it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183779, 0.187112, 0.189030, 0.202346
Valid average loss UNet                 (all)                : 0.762267

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.034585, 1.714679, 3.450713
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.457270, 2.680537, 2.972805
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.423754, 2.488937, 2.566237
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.291624, 2.458179, 3.210300
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.310925, 2.543079, 3.074774
Valid average loss all      (Triplet)                 : 0.321491

== Recognize ==
Valid average loss Recognize     : 0.701818
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.328509

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.646228313446045 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.549129009246826 sec. =
Valid knn accuracy bass      : 39.91935483870967%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.766010046005249 sec. =
Valid knn accuracy piano     : 45.703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.539849996566772 sec. =
Valid knn accuracy guitar    : 55.58035714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.72253704071045 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 58.82752391805249%

                                                                      [AEpoch 131: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.709, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.0083, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=0.628]Epoch 131: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.709, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188406, 0.188707, 0.187613, 0.194670
Train average loss UNet                 (all)                : 0.759396

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000509, 1.888945, 3.928215
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002705, 2.307858, 3.978042
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001869, 2.288831, 3.927094
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002132, 2.334013, 4.185834
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001769, 2.431400, 4.300991
Train average loss all      (Triplet)                 : 0.001774

== Recognize ==
Train average loss Recognize     : 0.626177
Train average accuracy drums     : 75.294998 %
Train average accuracy bass      : 55.779999 %
Train average accuracy piano     : 54.340000 %
Train average accuracy guitar    : 55.129997 %
Train average accuracy residuals : 59.030003 %

== Train average loss all : 0.008035

Epoch 131:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.709, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]          Epoch 132:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.709, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 132:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.709, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 132:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.00629, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=2.46e-5, Train/loss_recog_step=0.626, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 132:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00629, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=2.46e-5, Train/loss_recog_step=0.626, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 132:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00867, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00257, Train/loss_recog_step=0.610, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 132:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00867, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00257, Train/loss_recog_step=0.610, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 132:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]  Epoch 132:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 132:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 132:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 132:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00415, Train/loss_recog_step=0.593, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 132:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00415, Train/loss_recog_step=0.593, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 132:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00856, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00241, Train/loss_recog_step=0.615, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 132: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00856, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00241, Train/loss_recog_step=0.615, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 132: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.688, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.98it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.84it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.54it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183779, 0.187085, 0.189225, 0.207345
Valid average loss UNet                 (all)                : 0.767435

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.047845, 1.736871, 3.685475
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.506397, 2.677218, 2.986646
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.331458, 2.586012, 2.826299
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.290134, 2.425693, 3.368246
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.329846, 2.654610, 3.250127
Valid average loss all      (Triplet)                 : 0.330866

== Recognize ==
Valid average loss Recognize     : 0.683875
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 56.500000 %
Valid average accuracy guitar    : 58.000000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.337705

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.595468282699585 sec. =
Valid knn accuracy drums     : 85.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.775318384170532 sec. =
Valid knn accuracy bass      : 36.693548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.660248041152954 sec. =
Valid knn accuracy piano     : 41.40625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.546798944473267 sec. =
Valid knn accuracy guitar    : 54.46428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.309518575668335 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 57.05827136573104%

                                                                      [AEpoch 132: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.688, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.626]Epoch 132: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.688, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188253, 0.188559, 0.187464, 0.194563
Train average loss UNet                 (all)                : 0.758838

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000353, 1.886145, 3.980570
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001106, 2.244706, 3.938137
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001686, 2.257275, 3.873763
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002636, 2.334572, 4.180007
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002120, 2.436885, 4.273352
Train average loss all      (Triplet)                 : 0.001587

== Recognize ==
Train average loss Recognize     : 0.624541
Train average accuracy drums     : 74.705002 %
Train average accuracy bass      : 55.475002 %
Train average accuracy piano     : 53.890003 %
Train average accuracy guitar    : 56.825001 %
Train average accuracy residuals : 58.939999 %

== Train average loss all : 0.007833

Epoch 132:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.688, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]          Epoch 133:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.688, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]Epoch 133:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.688, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]Epoch 133:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]Epoch 133:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]Epoch 133:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00787, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00159, Train/loss_recog_step=0.628, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]Epoch 133:  48%|████▊     | 150/313 [03:08<03:25,  0.80it/s, v_num=0, Train/loss_all_step=0.00787, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00159, Train/loss_recog_step=0.628, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]Epoch 133:  48%|████▊     | 150/313 [03:08<03:25,  0.80it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.624, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]   Epoch 133:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.624, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]Epoch 133:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000457, Train/loss_recog_step=0.628, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]Epoch 133:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000457, Train/loss_recog_step=0.628, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]Epoch 133:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]   Epoch 133:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]Epoch 133:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]Epoch 133: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]Epoch 133: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00825, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.699, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.40it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.15it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.01it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183332, 0.186593, 0.188865, 0.204314
Valid average loss UNet                 (all)                : 0.763104

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.041759, 1.574064, 3.303722
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.525109, 2.675852, 2.721596
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.320626, 2.310174, 2.473472
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.239007, 2.314726, 3.337914
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.239460, 2.350734, 2.976239
Valid average loss all      (Triplet)                 : 0.303655

== Recognize ==
Valid average loss Recognize     : 0.696109
Valid average accuracy drums     : 56.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.310616

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.316218852996826 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.520708084106445 sec. =
Valid knn accuracy bass      : 29.63709677419355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.609390258789062 sec. =
Valid knn accuracy piano     : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.34566879272461 sec. =
Valid knn accuracy guitar    : 53.34821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.211405038833618 sec. =
Valid knn accuracy residuals : 70.68181818181817%

Valid knn accuracy average   : 56.578534543997385%

                                                                      [AEpoch 133: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00825, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.699, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00783, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00159, Train/loss_recog_epoch=0.625]Epoch 133: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00825, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.699, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188315, 0.188616, 0.187533, 0.194749
Train average loss UNet                 (all)                : 0.759213

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000711, 1.920405, 4.025377
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001615, 2.347275, 4.085783
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002425, 2.343757, 4.025749
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001880, 2.396402, 4.319601
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001636, 2.507505, 4.418087
Train average loss all      (Triplet)                 : 0.001628

== Recognize ==
Train average loss Recognize     : 0.628392
Train average accuracy drums     : 74.730003 %
Train average accuracy bass      : 54.630001 %
Train average accuracy piano     : 53.535004 %
Train average accuracy guitar    : 55.909996 %
Train average accuracy residuals : 58.305000 %

== Train average loss all : 0.007912

Epoch 133:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00825, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.699, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]          Epoch 134:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00825, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.699, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]Epoch 134:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00825, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.699, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]Epoch 134:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.661, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]  Epoch 134:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.661, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]Epoch 134:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.00595, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.595, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]Epoch 134:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00595, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.595, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]Epoch 134:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000753, Train/loss_recog_step=0.614, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]Epoch 134:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000753, Train/loss_recog_step=0.614, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]Epoch 134:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00618, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.618, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]   Epoch 134:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00618, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.618, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]Epoch 134:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]Epoch 134:  96%|█████████▌| 300/313 [05:59<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]Epoch 134:  96%|█████████▌| 300/313 [05:59<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00905, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00277, Train/loss_recog_step=0.628, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]Epoch 134: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00905, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00277, Train/loss_recog_step=0.628, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]Epoch 134: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.54it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.23it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.28it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.69it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183432, 0.186793, 0.188667, 0.203292
Valid average loss UNet                 (all)                : 0.762184

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.055781, 1.696352, 3.317289
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.443284, 2.583790, 2.855303
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.303424, 2.433029, 2.767406
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.337743, 2.514485, 3.390933
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.269329, 2.751107, 3.379110
Valid average loss all      (Triplet)                 : 0.299733

== Recognize ==
Valid average loss Recognize     : 0.694695
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 42.500000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.306680

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.403520107269287 sec. =
Valid knn accuracy drums     : 81.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.42147970199585 sec. =
Valid knn accuracy bass      : 32.45967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.989963054656982 sec. =
Valid knn accuracy piano     : 44.53125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.453670978546143 sec. =
Valid knn accuracy guitar    : 49.55357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.291154384613037 sec. =
Valid knn accuracy residuals : 71.13636363636363%

Valid knn accuracy average   : 55.883998583814495%

                                                                      [AEpoch 134: 100%|██████████| 313/313 [07:35<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.628]Epoch 134: 100%|██████████| 313/313 [07:35<00:00,  0.69it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188864, 0.189179, 0.188070, 0.194566
Train average loss UNet                 (all)                : 0.760680

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000603, 1.965082, 4.023901
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002921, 2.389860, 4.103805
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002574, 2.393590, 4.073678
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001681, 2.426093, 4.411498
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003188, 2.580648, 4.518453
Train average loss all      (Triplet)                 : 0.002231

== Recognize ==
Train average loss Recognize     : 0.629318
Train average accuracy drums     : 74.055000 %
Train average accuracy bass      : 54.154999 %
Train average accuracy piano     : 55.680000 %
Train average accuracy guitar    : 56.335003 %
Train average accuracy residuals : 56.664997 %

== Train average loss all : 0.008524

Epoch 134:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]          Epoch 135:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]Epoch 135:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]Epoch 135:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.656, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]Epoch 135:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.656, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]Epoch 135:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00434, Train/loss_recog_step=0.595, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]Epoch 135:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00434, Train/loss_recog_step=0.595, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]Epoch 135:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00793, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.654, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]Epoch 135:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00793, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.654, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]Epoch 135:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00637, Train/loss_recog_step=0.697, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629] Epoch 135:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00637, Train/loss_recog_step=0.697, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]Epoch 135:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=0.609, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]Epoch 135:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=0.609, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]Epoch 135:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629] Epoch 135: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]Epoch 135: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.695, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.37it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.06it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.85it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.40it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182801, 0.186115, 0.187925, 0.188686
Valid average loss UNet                 (all)                : 0.745527

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.035514, 1.744710, 3.383670
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.511691, 2.760821, 3.101758
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.284512, 2.395549, 2.739028
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.343557, 2.501559, 3.252454
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.293215, 2.617176, 3.312636
Valid average loss all      (Triplet)                 : 0.320100

== Recognize ==
Valid average loss Recognize     : 0.735713
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 43.000000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.327457

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.170752763748169 sec. =
Valid knn accuracy drums     : 81.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.639299154281616 sec. =
Valid knn accuracy bass      : 29.63709677419355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.768145084381104 sec. =
Valid knn accuracy piano     : 43.359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.55367112159729 sec. =
Valid knn accuracy guitar    : 52.23214285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.547142267227173 sec. =
Valid knn accuracy residuals : 68.18181818181817%

Valid knn accuracy average   : 55.029912649587445%

                                                                      [AEpoch 135: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00852, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=0.629]Epoch 135: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]   

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188539, 0.188863, 0.187779, 0.194102
Train average loss UNet                 (all)                : 0.759284

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000865, 1.898770, 3.858735
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002917, 2.349885, 4.091450
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002530, 2.335315, 4.005597
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001615, 2.348840, 4.260203
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002045, 2.492748, 4.411434
Train average loss all      (Triplet)                 : 0.001997

== Recognize ==
Train average loss Recognize     : 0.620682
Train average accuracy drums     : 76.875000 %
Train average accuracy bass      : 56.260002 %
Train average accuracy piano     : 55.980003 %
Train average accuracy guitar    : 56.849998 %
Train average accuracy residuals : 59.235001 %

== Train average loss all : 0.008204

Epoch 135:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]          Epoch 136:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]Epoch 136:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]Epoch 136:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00682, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000196, Train/loss_recog_step=0.662, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]Epoch 136:  32%|███▏      | 100/313 [02:04<04:26,  0.80it/s, v_num=0, Train/loss_all_step=0.00682, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000196, Train/loss_recog_step=0.662, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]Epoch 136:  32%|███▏      | 100/313 [02:04<04:26,  0.80it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.581, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]   Epoch 136:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.581, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]Epoch 136:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.0076, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00153, Train/loss_recog_step=0.606, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]Epoch 136:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0076, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00153, Train/loss_recog_step=0.606, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]Epoch 136:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0083, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=0.640, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621] Epoch 136:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0083, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=0.640, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]Epoch 136:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00958, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00345, Train/loss_recog_step=0.614, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]Epoch 136:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00958, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00345, Train/loss_recog_step=0.614, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]Epoch 136:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000292, Train/loss_recog_step=0.619, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]Epoch 136: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000292, Train/loss_recog_step=0.619, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]Epoch 136: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.550, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.49it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.04it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.79it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.74it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.70it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183892, 0.187225, 0.189235, 0.201899
Valid average loss UNet                 (all)                : 0.762250

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.074123, 1.625104, 3.140632
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.402631, 2.489284, 2.791905
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.326062, 2.323271, 2.583881
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.337225, 2.383358, 3.174991
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.344411, 2.548201, 3.184882
Valid average loss all      (Triplet)                 : 0.311229

== Recognize ==
Valid average loss Recognize     : 0.708433
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.318313

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.579181909561157 sec. =
Valid knn accuracy drums     : 84.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.045600175857544 sec. =
Valid knn accuracy bass      : 32.25806451612903%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.78391718864441 sec. =
Valid knn accuracy piano     : 45.8984375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.249730110168457 sec. =
Valid knn accuracy guitar    : 54.24107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.886784791946411 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 57.02694551897962%

                                                                      [AEpoch 136: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=0.621]Epoch 136: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188735, 0.189016, 0.187914, 0.194298
Train average loss UNet                 (all)                : 0.759963

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000305, 1.914767, 3.909150
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002124, 2.344930, 4.052710
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002504, 2.338596, 4.017355
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002456, 2.356578, 4.213057
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001327, 2.472786, 4.392797
Train average loss all      (Triplet)                 : 0.001726

== Recognize ==
Train average loss Recognize     : 0.627137
Train average accuracy drums     : 74.645004 %
Train average accuracy bass      : 55.470001 %
Train average accuracy piano     : 54.790001 %
Train average accuracy guitar    : 56.075001 %
Train average accuracy residuals : 57.785000 %

== Train average loss all : 0.007997

Epoch 136:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]          Epoch 137:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]Epoch 137:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]Epoch 137:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00649, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.649, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]Epoch 137:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00649, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.649, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]Epoch 137:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]Epoch 137:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]Epoch 137:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]Epoch 137:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]Epoch 137:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00979, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00306, Train/loss_recog_step=0.672, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]Epoch 137:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00979, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00306, Train/loss_recog_step=0.672, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]Epoch 137:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]  Epoch 137:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]Epoch 137:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.012, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00594, Train/loss_recog_step=0.605, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]Epoch 137: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.012, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00594, Train/loss_recog_step=0.605, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]Epoch 137: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.708, Valid/knn_avr=0.570, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.55it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.86it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.80it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.60it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.85it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185035, 0.188339, 0.190698, 0.200440
Valid average loss UNet                 (all)                : 0.764512

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060034, 1.669235, 3.217659
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.481821, 2.725657, 3.047738
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.335202, 2.474652, 2.706116
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.308500, 2.468505, 3.411326
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.379953, 2.685714, 3.299118
Valid average loss all      (Triplet)                 : 0.336799

== Recognize ==
Valid average loss Recognize     : 0.711411
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 44.000000 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.343913

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.034782648086548 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.43447732925415 sec. =
Valid knn accuracy bass      : 32.66129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.925631523132324 sec. =
Valid knn accuracy piano     : 43.359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.7311532497406 sec. =
Valid knn accuracy guitar    : 48.88392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.366207599639893 sec. =
Valid knn accuracy residuals : 67.27272727272727%

Valid knn accuracy average   : 55.348507711608164%

                                                                      [AEpoch 137: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.627]Epoch 137: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188478, 0.188773, 0.187684, 0.195277
Train average loss UNet                 (all)                : 0.760212

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000259, 1.858353, 3.858567
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001763, 2.309299, 4.010959
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001583, 2.335226, 4.006047
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001981, 2.339532, 4.253284
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000762, 2.415141, 4.339220
Train average loss all      (Triplet)                 : 0.001290

== Recognize ==
Train average loss Recognize     : 0.619237
Train average accuracy drums     : 78.175003 %
Train average accuracy bass      : 56.750000 %
Train average accuracy piano     : 54.465000 %
Train average accuracy guitar    : 56.765003 %
Train average accuracy residuals : 59.399998 %

== Train average loss all : 0.007482

Epoch 137:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]          Epoch 138:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]Epoch 138:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]Epoch 138:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00539, Train/loss_recog_step=0.633, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]Epoch 138:  32%|███▏      | 100/313 [02:06<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00539, Train/loss_recog_step=0.633, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]Epoch 138:  32%|███▏      | 100/313 [02:06<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.00695, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000546, Train/loss_recog_step=0.641, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]Epoch 138:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00695, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000546, Train/loss_recog_step=0.641, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]Epoch 138:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]   Epoch 138:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]Epoch 138:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=0.635, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]Epoch 138:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=0.635, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]Epoch 138:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00635, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.635, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]Epoch 138:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00635, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.635, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]Epoch 138:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.620, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619] Epoch 138: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.620, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]Epoch 138: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=0.665, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.48it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.02it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.85it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.95it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184566, 0.187843, 0.189997, 0.204956
Valid average loss UNet                 (all)                : 0.767362

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.046524, 1.653114, 3.364166
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.449308, 2.543762, 2.997796
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.322191, 2.335745, 2.609371
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.299444, 2.459528, 3.391462
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.308358, 2.525722, 3.095337
Valid average loss all      (Triplet)                 : 0.304400

== Recognize ==
Valid average loss Recognize     : 0.687057
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 57.000000 %

== Valid average loss all : 0.311270

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.393065929412842 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.481897592544556 sec. =
Valid knn accuracy bass      : 34.07258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.734051942825317 sec. =
Valid knn accuracy piano     : 46.2890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.484307527542114 sec. =
Valid knn accuracy guitar    : 47.544642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.421833753585815 sec. =
Valid knn accuracy residuals : 65.45454545454545%

Valid knn accuracy average   : 55.10694890006557%

                                                                      [AEpoch 138: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00748, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.619]Epoch 138: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188733, 0.189024, 0.187934, 0.194430
Train average loss UNet                 (all)                : 0.760121

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001092, 1.976334, 4.072386
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003415, 2.456391, 4.277927
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002716, 2.491808, 4.277677
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002533, 2.475777, 4.430858
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001905, 2.563245, 4.567303
Train average loss all      (Triplet)                 : 0.002374

== Recognize ==
Train average loss Recognize     : 0.631516
Train average accuracy drums     : 73.729996 %
Train average accuracy bass      : 54.919998 %
Train average accuracy piano     : 54.520000 %
Train average accuracy guitar    : 54.814999 %
Train average accuracy residuals : 58.754997 %

== Train average loss all : 0.008689

Epoch 138:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]          Epoch 139:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]Epoch 139:  16%|█▌        | 50/313 [01:08<05:57,  0.73it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]Epoch 139:  16%|█▌        | 50/313 [01:08<05:57,  0.73it/s, v_num=0, Train/loss_all_step=0.0194, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=0.621, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]Epoch 139:  32%|███▏      | 100/313 [02:05<04:27,  0.80it/s, v_num=0, Train/loss_all_step=0.0194, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=0.621, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]Epoch 139:  32%|███▏      | 100/313 [02:05<04:27,  0.80it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]Epoch 139:  48%|████▊     | 150/313 [03:02<03:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]Epoch 139:  48%|████▊     | 150/313 [03:02<03:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0237, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=0.632, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]Epoch 139:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0237, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=0.632, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]Epoch 139:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]Epoch 139:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]Epoch 139:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00629, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.629, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]Epoch 139:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00629, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.629, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]Epoch 139:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.026, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0195, Train/loss_recog_step=0.647, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632] Epoch 139: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.026, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0195, Train/loss_recog_step=0.647, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]Epoch 139: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.602, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.687, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.45it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.27it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.16it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.57it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.82it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184713, 0.188035, 0.190228, 0.192190
Valid average loss UNet                 (all)                : 0.755166

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.034997, 1.738979, 3.537916
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.549978, 2.917687, 3.321235
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.307791, 2.476016, 2.955431
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.340598, 2.541721, 3.467186
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.321616, 2.773058, 3.276161
Valid average loss all      (Triplet)                 : 0.335493

== Recognize ==
Valid average loss Recognize     : 0.756464
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.343058

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.350654125213623 sec. =
Valid knn accuracy drums     : 81.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.568267107009888 sec. =
Valid knn accuracy bass      : 26.814516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.556862354278564 sec. =
Valid knn accuracy piano     : 46.484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.772793531417847 sec. =
Valid knn accuracy guitar    : 45.535714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.787395000457764 sec. =
Valid knn accuracy residuals : 65.45454545454545%

Valid knn accuracy average   : 53.205656260814926%

                                                                      [AEpoch 139: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=0.632]Epoch 139: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189439, 0.189748, 0.188638, 0.195445
Train average loss UNet                 (all)                : 0.763270

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000542, 1.981289, 4.086298
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002648, 2.431971, 4.252061
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002820, 2.484092, 4.258698
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002140, 2.474521, 4.409848
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001807, 2.553009, 4.506081
Train average loss all      (Triplet)                 : 0.002037

== Recognize ==
Train average loss Recognize     : 0.631756
Train average accuracy drums     : 73.369995 %
Train average accuracy bass      : 54.325001 %
Train average accuracy piano     : 53.960003 %
Train average accuracy guitar    : 54.579998 %
Train average accuracy residuals : 57.939999 %

== Train average loss all : 0.008354

Epoch 139:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]          Epoch 140:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]Epoch 140:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]Epoch 140:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000198, Train/loss_recog_step=0.632, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]Epoch 140:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000198, Train/loss_recog_step=0.632, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]Epoch 140:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00627, Train/loss_recog_step=0.608, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]  Epoch 140:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00627, Train/loss_recog_step=0.608, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]Epoch 140:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0204, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0141, Train/loss_recog_step=0.634, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632] Epoch 140:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0204, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0141, Train/loss_recog_step=0.634, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]Epoch 140:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]Epoch 140:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]Epoch 140:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.00685, Train/loss_recog_step=0.584, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]Epoch 140:  96%|█████████▌| 300/313 [05:59<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.00685, Train/loss_recog_step=0.584, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]Epoch 140:  96%|█████████▌| 300/313 [05:59<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00647, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=6.78e-5, Train/loss_recog_step=0.641, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]Epoch 140: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00647, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=6.78e-5, Train/loss_recog_step=0.641, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]Epoch 140: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.615, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.731, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.35it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.50it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.21it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.19it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.25it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184228, 0.187498, 0.189907, 0.187289
Valid average loss UNet                 (all)                : 0.748922

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.018742, 1.729721, 3.711758
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.483918, 2.564355, 2.844207
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.246536, 2.345547, 2.657311
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.301002, 2.406513, 3.262858
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.262468, 2.570073, 3.186141
Valid average loss all      (Triplet)                 : 0.295895

== Recognize ==
Valid average loss Recognize     : 0.745817
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.303353

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.814174890518188 sec. =
Valid knn accuracy drums     : 83.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.378633975982666 sec. =
Valid knn accuracy bass      : 32.056451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.41278862953186 sec. =
Valid knn accuracy piano     : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.900185823440552 sec. =
Valid knn accuracy guitar    : 53.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.168856382369995 sec. =
Valid knn accuracy residuals : 65.45454545454545%

Valid knn accuracy average   : 56.01811556255806%

                                                                      [AEpoch 140: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.615, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00835, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=0.632]Epoch 140: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.615, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188916, 0.189201, 0.188078, 0.194162
Train average loss UNet                 (all)                : 0.760357

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000507, 1.964996, 4.028711
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002184, 2.463534, 4.298626
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002540, 2.471124, 4.231889
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001597, 2.447411, 4.411910
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001645, 2.563789, 4.533308
Train average loss all      (Triplet)                 : 0.001688

== Recognize ==
Train average loss Recognize     : 0.619926
Train average accuracy drums     : 77.410004 %
Train average accuracy bass      : 55.519997 %
Train average accuracy piano     : 54.695000 %
Train average accuracy guitar    : 57.290001 %
Train average accuracy residuals : 59.245003 %

== Train average loss all : 0.007887

Epoch 140:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.615, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]          Epoch 141:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.615, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]Epoch 141:  16%|█▌        | 50/313 [01:11<06:14,  0.70it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.615, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]Epoch 141:  16%|█▌        | 50/313 [01:11<06:14,  0.70it/s, v_num=0, Train/loss_all_step=0.00949, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00286, Train/loss_recog_step=0.663, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]Epoch 141:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.00949, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00286, Train/loss_recog_step=0.663, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]Epoch 141:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0048, Train/loss_recog_step=0.598, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]  Epoch 141:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0048, Train/loss_recog_step=0.598, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]Epoch 141:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00454, Train/loss_recog_step=0.621, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]Epoch 141:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00454, Train/loss_recog_step=0.621, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]Epoch 141:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00722, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000911, Train/loss_recog_step=0.630, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]Epoch 141:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00722, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000911, Train/loss_recog_step=0.630, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]Epoch 141:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]   Epoch 141:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]Epoch 141:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620] Epoch 141: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]Epoch 141: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.60it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.80it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.93it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.86it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.62it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.68it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183299, 0.186630, 0.188631, 0.202904
Valid average loss UNet                 (all)                : 0.761464

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.051563, 1.743591, 3.430671
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.495433, 2.752906, 3.014760
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.289216, 2.502626, 2.794667
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.265674, 2.508658, 3.612537
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.306470, 2.810705, 3.450868
Valid average loss all      (Triplet)                 : 0.308363

== Recognize ==
Valid average loss Recognize     : 0.690348
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 43.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 56.500000 %

== Valid average loss all : 0.315266

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.423405885696411 sec. =
Valid knn accuracy drums     : 82.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.757426500320435 sec. =
Valid knn accuracy bass      : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.437303304672241 sec. =
Valid knn accuracy piano     : 49.609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.462862014770508 sec. =
Valid knn accuracy guitar    : 50.44642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.342796325683594 sec. =
Valid knn accuracy residuals : 66.81818181818183%

Valid knn accuracy average   : 57.353057947487294%

                                                                      [AEpoch 141: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=0.620]Epoch 141: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189197, 0.189497, 0.188380, 0.194174
Train average loss UNet                 (all)                : 0.761248

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000517, 2.008043, 4.183670
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002159, 2.473322, 4.317737
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002422, 2.470369, 4.262856
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001826, 2.493281, 4.497389
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003869, 2.635096, 4.620193
Train average loss all      (Triplet)                 : 0.002162

== Recognize ==
Train average loss Recognize     : 0.632415
Train average accuracy drums     : 72.719994 %
Train average accuracy bass      : 55.225002 %
Train average accuracy piano     : 54.709999 %
Train average accuracy guitar    : 55.779999 %
Train average accuracy residuals : 55.185001 %

== Train average loss all : 0.008486

Epoch 141:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]          Epoch 142:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]Epoch 142:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]Epoch 142:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]Epoch 142:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]Epoch 142:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.620, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632] Epoch 142:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.620, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]Epoch 142:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00697, Train/loss_recog_step=0.639, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]Epoch 142:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00697, Train/loss_recog_step=0.639, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]Epoch 142:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632] Epoch 142:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]Epoch 142:  80%|███████▉  | 250/313 [05:05<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.599, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]Epoch 142:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.599, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]Epoch 142:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00731, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000958, Train/loss_recog_step=0.636, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]Epoch 142: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00731, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000958, Train/loss_recog_step=0.636, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]Epoch 142: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.657, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.15it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.08it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.74it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.33it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.60it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185273, 0.188657, 0.190549, 0.202566
Valid average loss UNet                 (all)                : 0.767045

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.059055, 1.735068, 3.369383
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.434848, 2.723828, 3.081466
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.274543, 2.486122, 2.801929
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.324736, 2.538875, 3.485487
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.358349, 2.943218, 3.508767
Valid average loss all      (Triplet)                 : 0.307229

== Recognize ==
Valid average loss Recognize     : 0.751337
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 44.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.314743

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.621452808380127 sec. =
Valid knn accuracy drums     : 79.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.687696695327759 sec. =
Valid knn accuracy bass      : 38.306451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.64203929901123 sec. =
Valid knn accuracy piano     : 42.96875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.325764179229736 sec. =
Valid knn accuracy guitar    : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.2718825340271 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 54.639674709932414%

                                                                      [AEpoch 142: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00849, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=0.632]Epoch 142: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188914, 0.189202, 0.188091, 0.194541
Train average loss UNet                 (all)                : 0.760749

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000442, 1.903011, 4.013470
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003153, 2.377511, 4.057359
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001669, 2.358346, 4.062681
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001235, 2.357094, 4.226482
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002230, 2.523065, 4.478717
Train average loss all      (Triplet)                 : 0.001818

== Recognize ==
Train average loss Recognize     : 0.624337
Train average accuracy drums     : 76.574997 %
Train average accuracy bass      : 54.195000 %
Train average accuracy piano     : 54.665001 %
Train average accuracy guitar    : 57.099998 %
Train average accuracy residuals : 58.420002 %

== Train average loss all : 0.008061

Epoch 142:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]          Epoch 143:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]Epoch 143:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]Epoch 143:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]Epoch 143:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]Epoch 143:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]  Epoch 143:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]Epoch 143:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]Epoch 143:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]Epoch 143:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]Epoch 143:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]Epoch 143:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]Epoch 143:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]Epoch 143:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00507, Train/loss_recog_step=0.648, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]Epoch 143: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00507, Train/loss_recog_step=0.648, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]Epoch 143: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.658, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.53it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.97it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.88it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.67it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.69it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184471, 0.187755, 0.190215, 0.195205
Valid average loss UNet                 (all)                : 0.757647

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.057266, 1.727156, 3.525032
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.446035, 2.645208, 2.954983
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.362914, 2.544116, 2.627617
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.254385, 2.444134, 3.370173
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.265122, 2.714777, 3.444367
Valid average loss all      (Triplet)                 : 0.297610

== Recognize ==
Valid average loss Recognize     : 0.719792
Valid average accuracy drums     : 43.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.304808

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.398998022079468 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.758566617965698 sec. =
Valid knn accuracy bass      : 31.25%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.317468404769897 sec. =
Valid knn accuracy piano     : 42.578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.726375818252563 sec. =
Valid knn accuracy guitar    : 49.776785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.22527027130127 sec. =
Valid knn accuracy residuals : 68.63636363636364%

Valid knn accuracy average   : 55.36129834839074%

                                                                      [AEpoch 143: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00806, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=0.624]Epoch 143: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189430, 0.189729, 0.188611, 0.194901
Train average loss UNet                 (all)                : 0.762672

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000516, 1.941466, 4.096766
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002824, 2.439411, 4.191122
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002153, 2.441481, 4.170820
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002082, 2.475723, 4.399227
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001117, 2.553714, 4.557256
Train average loss all      (Triplet)                 : 0.001760

== Recognize ==
Train average loss Recognize     : 0.632936
Train average accuracy drums     : 75.690002 %
Train average accuracy bass      : 53.044998 %
Train average accuracy piano     : 54.215004 %
Train average accuracy guitar    : 54.320000 %
Train average accuracy residuals : 58.205002 %

== Train average loss all : 0.008090

Epoch 143:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]          Epoch 144:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]Epoch 144:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]Epoch 144:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00933, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00303, Train/loss_recog_step=0.630, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]Epoch 144:  32%|███▏      | 100/313 [02:07<04:31,  0.79it/s, v_num=0, Train/loss_all_step=0.00933, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00303, Train/loss_recog_step=0.630, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]Epoch 144:  32%|███▏      | 100/313 [02:07<04:31,  0.79it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]  Epoch 144:  48%|████▊     | 150/313 [03:05<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]Epoch 144:  48%|████▊     | 150/313 [03:05<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00453, Train/loss_recog_step=0.597, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]Epoch 144:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00453, Train/loss_recog_step=0.597, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]Epoch 144:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00668, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.668, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633] Epoch 144:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00668, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.668, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]Epoch 144:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]Epoch 144:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]Epoch 144:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]Epoch 144: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]Epoch 144: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.224, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=0.682, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.45it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.99it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.40it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184573, 0.187923, 0.189978, 0.204648
Valid average loss UNet                 (all)                : 0.767122

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060004, 1.653295, 3.161625
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.436081, 2.629808, 2.965305
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.326001, 2.460134, 2.707800
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.307165, 2.377194, 3.269557
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.318901, 2.696612, 3.254247
Valid average loss all      (Triplet)                 : 0.306276

== Recognize ==
Valid average loss Recognize     : 0.704601
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 42.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.313322

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.330574750900269 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.250170230865479 sec. =
Valid knn accuracy bass      : 32.86290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.81959867477417 sec. =
Valid knn accuracy piano     : 47.0703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.32075023651123 sec. =
Valid knn accuracy guitar    : 52.67857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.383052110671997 sec. =
Valid knn accuracy residuals : 70.22727272727273%

Valid knn accuracy average   : 57.00259458502577%

                                                                      [AEpoch 144: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.633]Epoch 144: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189135, 0.189417, 0.188316, 0.194764
Train average loss UNet                 (all)                : 0.761631

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000506, 1.904786, 3.966420
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002005, 2.387515, 4.160494
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001938, 2.390011, 4.147567
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001823, 2.400555, 4.302438
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001192, 2.501487, 4.441870
Train average loss all      (Triplet)                 : 0.001481

== Recognize ==
Train average loss Recognize     : 0.622483
Train average accuracy drums     : 78.320000 %
Train average accuracy bass      : 54.970001 %
Train average accuracy piano     : 54.860001 %
Train average accuracy guitar    : 56.424999 %
Train average accuracy residuals : 58.955002 %

== Train average loss all : 0.007706

Epoch 144:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]          Epoch 145:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]Epoch 145:  16%|█▌        | 50/313 [01:06<05:51,  0.75it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]Epoch 145:  16%|█▌        | 50/313 [01:06<05:51,  0.75it/s, v_num=0, Train/loss_all_step=0.0078, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00175, Train/loss_recog_step=0.605, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]Epoch 145:  32%|███▏      | 100/313 [02:06<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.0078, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00175, Train/loss_recog_step=0.605, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]Epoch 145:  32%|███▏      | 100/313 [02:06<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622] Epoch 145:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]Epoch 145:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.0091, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.00306, Train/loss_recog_step=0.603, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]Epoch 145:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0091, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.00306, Train/loss_recog_step=0.603, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]Epoch 145:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.669, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622] Epoch 145:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.669, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]Epoch 145:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]Epoch 145:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]Epoch 145:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]Epoch 145: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]Epoch 145: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=0.631, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.49it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.11it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.82it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.74it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.67it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185193, 0.188524, 0.190675, 0.195251
Valid average loss UNet                 (all)                : 0.759643

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.054713, 1.645254, 3.257509
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.445180, 2.528265, 2.761073
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.315652, 2.453134, 2.680253
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.396139, 2.450161, 3.246406
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.257320, 2.587152, 3.106841
Valid average loss all      (Triplet)                 : 0.316887

== Recognize ==
Valid average loss Recognize     : 0.705257
Valid average accuracy drums     : 58.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.323940

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.704206705093384 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.62619423866272 sec. =
Valid knn accuracy bass      : 29.838709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.48803186416626 sec. =
Valid knn accuracy piano     : 41.796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.351354837417603 sec. =
Valid knn accuracy guitar    : 50.22321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.156187534332275 sec. =
Valid knn accuracy residuals : 62.5%

Valid knn accuracy average   : 53.48045544480065%

                                                                      [AEpoch 145: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00771, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.622]Epoch 145: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188724, 0.189029, 0.187924, 0.195232
Train average loss UNet                 (all)                : 0.760909

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000196, 1.803410, 3.770496
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000912, 2.224516, 3.921255
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002640, 2.306282, 3.982393
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001864, 2.274608, 4.077047
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001332, 2.347989, 4.163663
Train average loss all      (Triplet)                 : 0.001348

== Recognize ==
Train average loss Recognize     : 0.615310
Train average accuracy drums     : 83.279999 %
Train average accuracy bass      : 57.974998 %
Train average accuracy piano     : 55.489998 %
Train average accuracy guitar    : 59.079998 %
Train average accuracy residuals : 62.164997 %

== Train average loss all : 0.007501

Epoch 145:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615]          Epoch 146:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615]Epoch 146:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.671, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615]Epoch 146:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.00831, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=0.619, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615]Epoch 146:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00831, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=0.619, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615]Epoch 146:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615]  Epoch 146:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615]Epoch 146:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00765, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=0.643, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615]Epoch 146:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00765, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=0.643, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615]Epoch 146:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00468, Train/loss_recog_step=0.622, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615] Epoch 146:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00468, Train/loss_recog_step=0.622, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615]Epoch 146:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.585, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615] Epoch 146:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.585, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615]Epoch 146:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615] Epoch 146: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0065, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.650, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615]Epoch 146: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.701, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.782, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.28it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.28it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.87it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183921, 0.187199, 0.189557, 0.202303
Valid average loss UNet                 (all)                : 0.762980

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.054736, 1.784818, 3.455168
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.472036, 2.698891, 3.039526
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.338529, 2.706693, 2.961075
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.426256, 2.647839, 3.603227
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.316944, 2.788948, 3.311539
Valid average loss all      (Triplet)                 : 0.340987

== Recognize ==
Valid average loss Recognize     : 0.682844
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.347815

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.396276712417603 sec. =
Valid knn accuracy drums     : 81.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.583133220672607 sec. =
Valid knn accuracy bass      : 35.28225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.62518835067749 sec. =
Valid knn accuracy piano     : 46.2890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.4771568775177 sec. =
Valid knn accuracy guitar    : 44.419642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.267157077789307 sec. =
Valid knn accuracy residuals : 63.40909090909091%

Valid knn accuracy average   : 54.0974021704978%

                                                                      [AEpoch 146: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.701, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.0075, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.615]Epoch 146: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.701, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188620, 0.188919, 0.187819, 0.194525
Train average loss UNet                 (all)                : 0.759884

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000287, 1.870429, 3.905936
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000904, 2.264953, 3.978801
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001565, 2.360132, 4.107363
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001951, 2.363494, 4.265656
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001191, 2.415606, 4.292440
Train average loss all      (Triplet)                 : 0.001238

== Recognize ==
Train average loss Recognize     : 0.610333
Train average accuracy drums     : 84.080002 %
Train average accuracy bass      : 59.394997 %
Train average accuracy piano     : 56.139999 %
Train average accuracy guitar    : 58.859997 %
Train average accuracy residuals : 62.274998 %

== Train average loss all : 0.007341

Epoch 146:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.701, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]          Epoch 147:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.701, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]Epoch 147:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.701, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]Epoch 147:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]Epoch 147:  32%|███▏      | 100/313 [02:11<04:40,  0.76it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]Epoch 147:  32%|███▏      | 100/313 [02:11<04:40,  0.76it/s, v_num=0, Train/loss_all_step=0.00961, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.568, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]Epoch 147:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00961, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.568, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]Epoch 147:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]    Epoch 147:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]Epoch 147:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]Epoch 147:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]Epoch 147:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.585, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]Epoch 147:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.585, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]Epoch 147:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]Epoch 147: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]Epoch 147: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.33it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.19it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.02it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:03<00:00,  2.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184554, 0.187928, 0.190033, 0.204335
Valid average loss UNet                 (all)                : 0.766850

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.058827, 1.758921, 3.461070
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.394482, 2.536522, 2.926719
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.347006, 2.485952, 2.715961
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.391579, 2.456249, 3.345646
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.312111, 2.691019, 3.296599
Valid average loss all      (Triplet)                 : 0.313984

== Recognize ==
Valid average loss Recognize     : 0.722708
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 40.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.321211

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.653977155685425 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.112061738967896 sec. =
Valid knn accuracy bass      : 32.86290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.609768867492676 sec. =
Valid knn accuracy piano     : 44.7265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.843246936798096 sec. =
Valid knn accuracy guitar    : 51.78571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.205392122268677 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 56.63788185210652%

                                                                      [AEpoch 147: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00734, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.610]Epoch 147: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188340, 0.188637, 0.187546, 0.194768
Train average loss UNet                 (all)                : 0.759290

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000465, 1.931235, 3.985952
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002801, 2.352472, 4.107647
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001757, 2.386300, 4.127940
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001344, 2.393993, 4.274697
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001089, 2.463825, 4.351875
Train average loss all      (Triplet)                 : 0.001555

== Recognize ==
Train average loss Recognize     : 0.613271
Train average accuracy drums     : 81.315002 %
Train average accuracy bass      : 57.814999 %
Train average accuracy piano     : 56.825001 %
Train average accuracy guitar    : 58.595001 %
Train average accuracy residuals : 62.094997 %

== Train average loss all : 0.007688

Epoch 147:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]          Epoch 148:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]Epoch 148:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]Epoch 148:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]Epoch 148:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]Epoch 148:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.586, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]Epoch 148:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.586, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]Epoch 148:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.00699, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.699, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]Epoch 148:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00699, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.699, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]Epoch 148:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.620, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613] Epoch 148:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.620, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]Epoch 148:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]Epoch 148:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]Epoch 148:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]Epoch 148: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]Epoch 148: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.46it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.05it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.22it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183806, 0.187117, 0.189292, 0.194105
Valid average loss UNet                 (all)                : 0.754320

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.056546, 1.797227, 3.428886
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.404196, 2.731603, 3.093021
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.324504, 2.786379, 3.146896
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.413031, 2.578181, 3.482072
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.312819, 2.953998, 3.384079
Valid average loss all      (Triplet)                 : 0.317495

== Recognize ==
Valid average loss Recognize     : 0.719117
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.324686

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.374077081680298 sec. =
Valid knn accuracy drums     : 86.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.734118461608887 sec. =
Valid knn accuracy bass      : 34.07258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.877751350402832 sec. =
Valid knn accuracy piano     : 44.921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.390074968338013 sec. =
Valid knn accuracy guitar    : 53.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.33120608329773 sec. =
Valid knn accuracy residuals : 66.13636363636364%

Valid knn accuracy average   : 57.00131913580808%

                                                                      [AEpoch 148: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00769, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.613]Epoch 148: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188457, 0.188757, 0.187658, 0.194633
Train average loss UNet                 (all)                : 0.759503

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000555, 2.006419, 4.194430
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002870, 2.490153, 4.317858
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002768, 2.503411, 4.292773
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001440, 2.496292, 4.515562
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002291, 2.633320, 4.595229
Train average loss all      (Triplet)                 : 0.001989

== Recognize ==
Train average loss Recognize     : 0.620631
Train average accuracy drums     : 77.195000 %
Train average accuracy bass      : 56.585003 %
Train average accuracy piano     : 55.984997 %
Train average accuracy guitar    : 57.274998 %
Train average accuracy residuals : 58.784996 %

== Train average loss all : 0.008195

Epoch 148:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621]          Epoch 149:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621]Epoch 149:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00683, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.683, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621]Epoch 149:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621]Epoch 149:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621]Epoch 149:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00731, Train/loss_recog_step=0.618, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621]Epoch 149:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00731, Train/loss_recog_step=0.618, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621]Epoch 149:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621] Epoch 149:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.654, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621]Epoch 149:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00708, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.708, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621]Epoch 149:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00708, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.708, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621]Epoch 149:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0096, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.00345, Train/loss_recog_step=0.615, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621]Epoch 149:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0096, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.00345, Train/loss_recog_step=0.615, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621]Epoch 149:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621] Epoch 149: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621]Epoch 149: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.600, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.40it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.23it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.93it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.57it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.66it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.13it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183128, 0.186409, 0.188405, 0.197081
Valid average loss UNet                 (all)                : 0.755022

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.052974, 1.786332, 3.670218
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.458039, 2.692235, 3.053069
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.271933, 2.487197, 2.833597
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.345152, 2.527651, 3.433537
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.258050, 2.924102, 3.456684
Valid average loss all      (Triplet)                 : 0.297563

== Recognize ==
Valid average loss Recognize     : 0.717564
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.304739

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.497467517852783 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.40864896774292 sec. =
Valid knn accuracy bass      : 34.07258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.757587432861328 sec. =
Valid knn accuracy piano     : 46.484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.450430154800415 sec. =
Valid knn accuracy guitar    : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.476226568222046 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 55.762823935356366%

                                                                      [AEpoch 149: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.600, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0082, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=0.621]Epoch 149: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.600, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188561, 0.188868, 0.187776, 0.194685
Train average loss UNet                 (all)                : 0.759890

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000611, 2.021989, 4.183982
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003250, 2.511039, 4.342548
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002905, 2.571828, 4.412930
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001098, 2.518509, 4.478751
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004242, 2.693682, 4.712611
Train average loss all      (Triplet)                 : 0.002352

== Recognize ==
Train average loss Recognize     : 0.631851
Train average accuracy drums     : 74.605003 %
Train average accuracy bass      : 53.985001 %
Train average accuracy piano     : 53.315002 %
Train average accuracy guitar    : 55.734997 %
Train average accuracy residuals : 57.779999 %

== Train average loss all : 0.008670

Epoch 149:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.600, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]          Epoch 150:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.600, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]Epoch 150:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.600, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]Epoch 150:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.00635, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.635, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]Epoch 150:  32%|███▏      | 100/313 [02:06<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.00635, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.635, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]Epoch 150:  32%|███▏      | 100/313 [02:06<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]Epoch 150:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]Epoch 150:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]Epoch 150:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]Epoch 150:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]Epoch 150:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.644, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]Epoch 150:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]Epoch 150:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]Epoch 150:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00727, Train/loss_recog_step=0.638, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]Epoch 150: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00727, Train/loss_recog_step=0.638, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]Epoch 150: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00713, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000741, Train/loss_recog_step=0.639, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.33it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.90it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.64it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.71it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183787, 0.187007, 0.189158, 0.206971
Valid average loss UNet                 (all)                : 0.766922

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.102462, 1.634997, 3.098483
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.317042, 2.310086, 2.664259
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.299207, 2.342863, 2.493578
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.267907, 2.160116, 2.981644
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.296541, 2.499381, 2.999921
Valid average loss all      (Triplet)                 : 0.263607

== Recognize ==
Valid average loss Recognize     : 0.716109
Valid average accuracy drums     : 56.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 39.000000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.270768

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.662072896957397 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.675769329071045 sec. =
Valid knn accuracy bass      : 35.685483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.840878963470459 sec. =
Valid knn accuracy piano     : 42.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.529942274093628 sec. =
Valid knn accuracy guitar    : 49.107142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.843668937683105 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 55.85649965392252%

                                                                      [AEpoch 150: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00713, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000741, Train/loss_recog_step=0.639, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00867, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.632]Epoch 150: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00713, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000741, Train/loss_recog_step=0.639, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188749, 0.189052, 0.187955, 0.194361
Train average loss UNet                 (all)                : 0.760118

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000296, 1.942011, 4.110207
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005175, 2.450086, 4.205409
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002948, 2.446887, 4.193738
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001735, 2.450745, 4.362998
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003288, 2.606581, 4.544240
Train average loss all      (Triplet)                 : 0.002686

== Recognize ==
Train average loss Recognize     : 0.624687
Train average accuracy drums     : 79.105003 %
Train average accuracy bass      : 54.709999 %
Train average accuracy piano     : 55.084999 %
Train average accuracy guitar    : 55.610001 %
Train average accuracy residuals : 57.974998 %

== Train average loss all : 0.008933

Epoch 150:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00713, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000741, Train/loss_recog_step=0.639, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]          Epoch 151:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00713, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000741, Train/loss_recog_step=0.639, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]Epoch 151:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.00713, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000741, Train/loss_recog_step=0.639, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]Epoch 151:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00401, Train/loss_recog_step=0.628, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]  Epoch 151:  32%|███▏      | 100/313 [02:07<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00401, Train/loss_recog_step=0.628, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]Epoch 151:  32%|███▏      | 100/313 [02:07<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625] Epoch 151:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]Epoch 151:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]Epoch 151:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]Epoch 151:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]Epoch 151:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]Epoch 151:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.593, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]Epoch 151:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.593, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]Epoch 151:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.607, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]Epoch 151: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.607, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]Epoch 151: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.702, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.36it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.45it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.48it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.71it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185081, 0.188380, 0.190622, 0.200216
Valid average loss UNet                 (all)                : 0.764299

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.041190, 1.755354, 3.624684
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.403231, 2.729064, 3.094910
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.369464, 2.701444, 2.896169
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.310429, 2.430743, 3.379711
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.419218, 3.001329, 3.259037
Valid average loss all      (Triplet)                 : 0.322303

== Recognize ==
Valid average loss Recognize     : 0.689881
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.329202

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.005695104598999 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.419049978256226 sec. =
Valid knn accuracy bass      : 37.29838709677419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.926553964614868 sec. =
Valid knn accuracy piano     : 44.53125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.575697898864746 sec. =
Valid knn accuracy guitar    : 47.098214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.673482656478882 sec. =
Valid knn accuracy residuals : 69.54545454545455%

Valid knn accuracy average   : 56.73813944645817%

                                                                      [AEpoch 151: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00893, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00269, Train/loss_recog_epoch=0.625]Epoch 151: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189009, 0.189313, 0.188196, 0.194205
Train average loss UNet                 (all)                : 0.760724

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000417, 1.972056, 4.083158
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003231, 2.419864, 4.205390
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002485, 2.446710, 4.181830
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001665, 2.430072, 4.333392
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001064, 2.560213, 4.579394
Train average loss all      (Triplet)                 : 0.001769

== Recognize ==
Train average loss Recognize     : 0.621212
Train average accuracy drums     : 78.214996 %
Train average accuracy bass      : 56.040001 %
Train average accuracy piano     : 54.590000 %
Train average accuracy guitar    : 56.545002 %
Train average accuracy residuals : 59.445000 %

== Train average loss all : 0.007981

Epoch 151:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]          Epoch 152:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]Epoch 152:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]Epoch 152:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]Epoch 152:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]Epoch 152:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00578, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.578, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]Epoch 152:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00578, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.578, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]Epoch 152:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00573, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.573, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]Epoch 152:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00573, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.573, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]Epoch 152:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000535, Train/loss_recog_step=0.603, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]Epoch 152:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000535, Train/loss_recog_step=0.603, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]Epoch 152:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]   Epoch 152:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]Epoch 152:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00641, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.641, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]Epoch 152: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00641, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.641, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]Epoch 152: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00625, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.625, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.237, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.50it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.83it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.15it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.98it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.85it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.11it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184955, 0.188246, 0.190590, 0.199692
Valid average loss UNet                 (all)                : 0.763483

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.068523, 1.673059, 3.307418
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.360060, 2.520173, 2.899873
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.304485, 2.522846, 2.712032
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.305989, 2.310287, 3.174517
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.367538, 2.701086, 3.027985
Valid average loss all      (Triplet)                 : 0.294667

== Recognize ==
Valid average loss Recognize     : 0.720401
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.301871

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.489668846130371 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.339226722717285 sec. =
Valid knn accuracy bass      : 31.653225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.200856924057007 sec. =
Valid knn accuracy piano     : 46.2890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.636856079101562 sec. =
Valid knn accuracy guitar    : 51.11607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.410973072052002 sec. =
Valid knn accuracy residuals : 69.0909090909091%

Valid knn accuracy average   : 56.41246246083861%

                                                                      [AEpoch 152: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00625, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.625, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00798, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.621]Epoch 152: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00625, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.625, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189202, 0.189511, 0.188392, 0.194880
Train average loss UNet                 (all)                : 0.761985

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000240, 1.949420, 4.072950
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000820, 2.393979, 4.239748
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001765, 2.461745, 4.261803
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001643, 2.436623, 4.360416
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001237, 2.574765, 4.590617
Train average loss all      (Triplet)                 : 0.001142

== Recognize ==
Train average loss Recognize     : 0.615059
Train average accuracy drums     : 79.404999 %
Train average accuracy bass      : 57.904999 %
Train average accuracy piano     : 55.924999 %
Train average accuracy guitar    : 57.360001 %
Train average accuracy residuals : 59.815002 %

== Train average loss all : 0.007293

Epoch 152:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00625, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.625, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]          Epoch 153:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00625, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.625, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]Epoch 153:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00625, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.625, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]Epoch 153:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00647, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.647, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]Epoch 153:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.00647, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.647, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]Epoch 153:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.606, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]Epoch 153:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.606, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]Epoch 153:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]Epoch 153:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]Epoch 153:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]Epoch 153:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]Epoch 153:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.591, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]Epoch 153:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.591, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]Epoch 153:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]Epoch 153: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]Epoch 153: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.302, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.43it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.07it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.33it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.68it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.91it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184589, 0.187904, 0.189995, 0.191665
Valid average loss UNet                 (all)                : 0.754153

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077097, 1.672156, 3.123588
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.402602, 2.561992, 2.907609
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.378873, 2.471542, 2.536711
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.326427, 2.287149, 3.082467
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.267370, 2.494254, 2.917760
Valid average loss all      (Triplet)                 : 0.305633

== Recognize ==
Valid average loss Recognize     : 0.712529
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.312758

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.032012939453125 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.699993371963501 sec. =
Valid knn accuracy bass      : 28.024193548387093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.629976034164429 sec. =
Valid knn accuracy piano     : 44.921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.917848348617554 sec. =
Valid knn accuracy guitar    : 55.80357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.395485401153564 sec. =
Valid knn accuracy residuals : 68.86363636363636%

Valid knn accuracy average   : 56.044394398553756%

                                                                      [AEpoch 153: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00729, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.615]Epoch 153: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189037, 0.189325, 0.188241, 0.194450
Train average loss UNet                 (all)                : 0.761053

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000525, 1.913522, 3.989341
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001125, 2.309764, 4.121404
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001411, 2.372032, 4.129852
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001531, 2.369664, 4.269352
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000607, 2.471024, 4.416240
Train average loss all      (Triplet)                 : 0.001009

== Recognize ==
Train average loss Recognize     : 0.608059
Train average accuracy drums     : 83.450005 %
Train average accuracy bass      : 59.654999 %
Train average accuracy piano     : 56.664997 %
Train average accuracy guitar    : 58.579998 %
Train average accuracy residuals : 62.344997 %

== Train average loss all : 0.007089

Epoch 153:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]          Epoch 154:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]Epoch 154:  16%|█▌        | 50/313 [01:08<06:02,  0.72it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]Epoch 154:  16%|█▌        | 50/313 [01:08<06:02,  0.72it/s, v_num=0, Train/loss_all_step=0.00587, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.587, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]Epoch 154:  32%|███▏      | 100/313 [02:07<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00587, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.587, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]Epoch 154:  32%|███▏      | 100/313 [02:07<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]Epoch 154:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]Epoch 154:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00805, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=0.601, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]Epoch 154:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00805, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=0.601, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]Epoch 154:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.690, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]   Epoch 154:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.690, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]Epoch 154:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.00644, Train/loss_recog_step=0.601, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]Epoch 154:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.00644, Train/loss_recog_step=0.601, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]Epoch 154:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608] Epoch 154: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]Epoch 154: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.25it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.42it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.31it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.21it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.59it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183870, 0.187169, 0.189108, 0.207773
Valid average loss UNet                 (all)                : 0.767920

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.084226, 1.663554, 3.088104
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.395242, 2.474036, 2.871571
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.498230, 2.705183, 2.695807
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.340259, 2.438260, 3.383405
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.372360, 2.577055, 3.058763
Valid average loss all      (Triplet)                 : 0.349792

== Recognize ==
Valid average loss Recognize     : 0.711751
Valid average accuracy drums     : 57.000000 %
Valid average accuracy bass      : 42.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.356910

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.561200618743896 sec. =
Valid knn accuracy drums     : 85.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.30104112625122 sec. =
Valid knn accuracy bass      : 26.61290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.801184177398682 sec. =
Valid knn accuracy piano     : 35.3515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.348510026931763 sec. =
Valid knn accuracy guitar    : 50.44642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.659290790557861 sec. =
Valid knn accuracy residuals : 72.04545454545455%

Valid knn accuracy average   : 54.02170455114661%

                                                                      [AEpoch 154: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00101, Train/loss_recog_epoch=0.608]Epoch 154: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188481, 0.188793, 0.187700, 0.194671
Train average loss UNet                 (all)                : 0.759645

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000355, 1.962243, 4.087657
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001506, 2.375037, 4.196887
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000930, 2.415865, 4.257910
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001560, 2.475705, 4.439298
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001679, 2.544412, 4.507723
Train average loss all      (Triplet)                 : 0.001176

== Recognize ==
Train average loss Recognize     : 0.612691
Train average accuracy drums     : 81.105003 %
Train average accuracy bass      : 58.995003 %
Train average accuracy piano     : 55.734997 %
Train average accuracy guitar    : 57.630001 %
Train average accuracy residuals : 61.914997 %

== Train average loss all : 0.007303

Epoch 154:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]          Epoch 155:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]Epoch 155:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]Epoch 155:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.00763, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=0.617, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]Epoch 155:  32%|███▏      | 100/313 [02:07<04:31,  0.79it/s, v_num=0, Train/loss_all_step=0.00763, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=0.617, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]Epoch 155:  32%|███▏      | 100/313 [02:07<04:31,  0.79it/s, v_num=0, Train/loss_all_step=0.0067, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000653, Train/loss_recog_step=0.605, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]Epoch 155:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.0067, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000653, Train/loss_recog_step=0.605, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]Epoch 155:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]  Epoch 155:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]Epoch 155:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0087, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=0.619, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]Epoch 155:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0087, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=0.619, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]Epoch 155:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613] Epoch 155:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]Epoch 155:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00717, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000844, Train/loss_recog_step=0.632, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]Epoch 155: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.00717, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000844, Train/loss_recog_step=0.632, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]Epoch 155: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.41it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.80it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.60it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.41it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.61it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184723, 0.188044, 0.190352, 0.204044
Valid average loss UNet                 (all)                : 0.767163

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.054697, 1.797104, 3.323512
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.498615, 2.618822, 2.922092
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.376256, 2.653941, 2.758598
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.332674, 2.635217, 3.703061
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.302140, 2.669909, 3.159183
Valid average loss all      (Triplet)                 : 0.342901

== Recognize ==
Valid average loss Recognize     : 0.698038
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 58.000000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.349882

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.43469500541687 sec. =
Valid knn accuracy drums     : 85.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.612540245056152 sec. =
Valid knn accuracy bass      : 32.25806451612903%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.976886987686157 sec. =
Valid knn accuracy piano     : 46.09375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.51546335220337 sec. =
Valid knn accuracy guitar    : 47.99107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.513053178787231 sec. =
Valid knn accuracy residuals : 72.95454545454545%

Valid knn accuracy average   : 56.98992106245788%

                                                                      [AEpoch 155: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=0.613]Epoch 155: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188455, 0.188755, 0.187662, 0.193819
Train average loss UNet                 (all)                : 0.758691

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000403, 2.014967, 4.083010
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002128, 2.462253, 4.284261
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002474, 2.547452, 4.398434
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001354, 2.592328, 4.608714
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001018, 2.578927, 4.576365
Train average loss all      (Triplet)                 : 0.001483

== Recognize ==
Train average loss Recognize     : 0.614289
Train average accuracy drums     : 80.830002 %
Train average accuracy bass      : 57.335003 %
Train average accuracy piano     : 55.524998 %
Train average accuracy guitar    : 58.200001 %
Train average accuracy residuals : 63.200005 %

== Train average loss all : 0.007626

Epoch 155:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]          Epoch 156:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]Epoch 156:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]Epoch 156:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00885, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00223, Train/loss_recog_step=0.662, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]Epoch 156:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00885, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00223, Train/loss_recog_step=0.662, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]Epoch 156:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]  Epoch 156:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]Epoch 156:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00422, Train/loss_recog_step=0.635, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]Epoch 156:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00422, Train/loss_recog_step=0.635, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]Epoch 156:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.690, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614] Epoch 156:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.690, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]Epoch 156:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00547, Train/loss_recog_step=0.613, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]Epoch 156:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00547, Train/loss_recog_step=0.613, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]Epoch 156:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00681, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.681, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614] Epoch 156: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00681, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.681, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]Epoch 156: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.697, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.647, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.698, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.25it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.24it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.36it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.28it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.06it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.68it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184617, 0.187990, 0.189981, 0.208440
Valid average loss UNet                 (all)                : 0.771028

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.044823, 1.830271, 3.372993
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.518980, 2.918377, 3.251709
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.407803, 2.787984, 2.844979
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.321232, 2.799217, 3.930800
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.410941, 2.980581, 3.485970
Valid average loss all      (Triplet)                 : 0.369673

== Recognize ==
Valid average loss Recognize     : 0.698520
Valid average accuracy drums     : 59.500004 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.376658

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.35670781135559 sec. =
Valid knn accuracy drums     : 85.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.697564363479614 sec. =
Valid knn accuracy bass      : 30.040322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.159542322158813 sec. =
Valid knn accuracy piano     : 44.921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.3022620677948 sec. =
Valid knn accuracy guitar    : 57.14285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.434742450714111 sec. =
Valid knn accuracy residuals : 69.0909090909091%

Valid knn accuracy average   : 57.239192762882276%

                                                                      [AEpoch 156: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.697, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=0.614]Epoch 156: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.697, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189199, 0.189516, 0.188392, 0.194669
Train average loss UNet                 (all)                : 0.761775

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000572, 2.111728, 4.323552
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002879, 2.584952, 4.475318
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002740, 2.653684, 4.562047
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002990, 2.700201, 4.841321
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002460, 2.740185, 4.869396
Train average loss all      (Triplet)                 : 0.002433

== Recognize ==
Train average loss Recognize     : 0.625355
Train average accuracy drums     : 76.660004 %
Train average accuracy bass      : 55.725002 %
Train average accuracy piano     : 53.719997 %
Train average accuracy guitar    : 56.054996 %
Train average accuracy residuals : 59.254997 %

== Train average loss all : 0.008687

Epoch 156:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.697, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]          Epoch 157:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.697, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]Epoch 157:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.697, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]Epoch 157:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=6.33e-5, Train/loss_recog_step=0.607, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]Epoch 157:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=6.33e-5, Train/loss_recog_step=0.607, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]Epoch 157:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00836, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=0.624, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]Epoch 157:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.00836, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=0.624, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]Epoch 157:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0066, Train/loss_recog_step=0.628, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]  Epoch 157:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0066, Train/loss_recog_step=0.628, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]Epoch 157:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]Epoch 157:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]Epoch 157:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00557, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=2.17e-5, Train/loss_recog_step=0.555, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]Epoch 157:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00557, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=2.17e-5, Train/loss_recog_step=0.555, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]Epoch 157:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]  Epoch 157: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]Epoch 157: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.669, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.55it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.21it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.09it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.57it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184879, 0.188262, 0.190453, 0.192148
Valid average loss UNet                 (all)                : 0.755743

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.058539, 1.968170, 3.862297
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.504620, 2.883046, 3.211984
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.362022, 2.836640, 3.189179
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.338074, 2.772901, 3.935120
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.323900, 2.820587, 3.519609
Valid average loss all      (Triplet)                 : 0.348696

== Recognize ==
Valid average loss Recognize     : 0.738521
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.356082

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.728142976760864 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.574241876602173 sec. =
Valid knn accuracy bass      : 26.411290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.597610473632812 sec. =
Valid knn accuracy piano     : 42.7734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.394800424575806 sec. =
Valid knn accuracy guitar    : 54.01785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.314413070678711 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 55.18399525395712%

                                                                      [AEpoch 157: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00869, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.625]Epoch 157: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189219, 0.189515, 0.188409, 0.194062
Train average loss UNet                 (all)                : 0.761204

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000793, 2.032668, 4.171161
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002004, 2.518461, 4.343122
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002448, 2.603017, 4.493013
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002296, 2.628479, 4.821928
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001656, 2.632664, 4.699352
Train average loss all      (Triplet)                 : 0.001838

== Recognize ==
Train average loss Recognize     : 0.617898
Train average accuracy drums     : 80.220001 %
Train average accuracy bass      : 57.325001 %
Train average accuracy piano     : 53.490002 %
Train average accuracy guitar    : 57.174999 %
Train average accuracy residuals : 61.320000 %

== Train average loss all : 0.008017

Epoch 157:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]          Epoch 158:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]Epoch 158:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.676, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]Epoch 158:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.638, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]Epoch 158:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.638, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]Epoch 158:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]Epoch 158:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]Epoch 158:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00662, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.662, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]Epoch 158:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00662, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.662, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]Epoch 158:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]Epoch 158:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]Epoch 158:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.610, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618] Epoch 158:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.610, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]Epoch 158:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00582, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.582, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]Epoch 158: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00582, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.582, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]Epoch 158: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.693, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.43it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.14it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.41it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.64it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183099, 0.186418, 0.188540, 0.197163
Valid average loss UNet                 (all)                : 0.755220

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061758, 1.808196, 3.721214
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.469468, 2.580937, 3.007104
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.309262, 2.648958, 3.023240
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.257166, 2.624592, 3.774824
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.320981, 2.919821, 3.571852
Valid average loss all      (Triplet)                 : 0.300871

== Recognize ==
Valid average loss Recognize     : 0.705545
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.307926

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.414563655853271 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.213373184204102 sec. =
Valid knn accuracy bass      : 34.07258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.506622076034546 sec. =
Valid knn accuracy piano     : 45.5078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.372933864593506 sec. =
Valid knn accuracy guitar    : 59.375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.933388948440552 sec. =
Valid knn accuracy residuals : 74.77272727272727%

Valid knn accuracy average   : 59.52823277922988%

                                                                      [AEpoch 158: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.693, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00802, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00184, Train/loss_recog_epoch=0.618]Epoch 158: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.693, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188715, 0.189006, 0.187907, 0.194280
Train average loss UNet                 (all)                : 0.759908

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000246, 2.024893, 4.317791
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001328, 2.472585, 4.303534
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003212, 2.575305, 4.494155
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001545, 2.592605, 4.702419
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000932, 2.637059, 4.724499
Train average loss all      (Triplet)                 : 0.001488

== Recognize ==
Train average loss Recognize     : 0.616426
Train average accuracy drums     : 80.620003 %
Train average accuracy bass      : 57.529999 %
Train average accuracy piano     : 54.439999 %
Train average accuracy guitar    : 57.415001 %
Train average accuracy residuals : 61.020000 %

== Train average loss all : 0.007652

Epoch 158:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.693, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]          Epoch 159:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.693, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]Epoch 159:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.00693, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.693, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]Epoch 159:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.00618, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.618, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]Epoch 159:  32%|███▏      | 100/313 [02:06<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.00618, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.618, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]Epoch 159:  32%|███▏      | 100/313 [02:06<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]Epoch 159:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]Epoch 159:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]  Epoch 159:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]Epoch 159:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00738, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000994, Train/loss_recog_step=0.638, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]Epoch 159:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00738, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000994, Train/loss_recog_step=0.638, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]Epoch 159:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00583, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.583, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]   Epoch 159:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00583, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.583, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]Epoch 159:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.677, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]Epoch 159: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.677, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]Epoch 159: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.655, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.706, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.47it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.03it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.81it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.82it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185292, 0.188611, 0.190981, 0.204221
Valid average loss UNet                 (all)                : 0.769105

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061543, 1.792471, 3.387812
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.477463, 2.595080, 2.917523
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.351549, 2.732105, 2.955231
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.258290, 2.585054, 3.658724
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.316173, 2.822443, 3.348933
Valid average loss all      (Triplet)                 : 0.307036

== Recognize ==
Valid average loss Recognize     : 0.701389
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.314050

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.381008863449097 sec. =
Valid knn accuracy drums     : 84.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.248956441879272 sec. =
Valid knn accuracy bass      : 31.85483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.511112451553345 sec. =
Valid knn accuracy piano     : 44.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.381910562515259 sec. =
Valid knn accuracy guitar    : 52.45535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.426448583602905 sec. =
Valid knn accuracy residuals : 71.81818181818181%

Valid knn accuracy average   : 57.010322273273715%

                                                                      [AEpoch 159: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.616]Epoch 159: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189122, 0.189412, 0.188305, 0.194662
Train average loss UNet                 (all)                : 0.761502

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000447, 2.076333, 4.498295
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001791, 2.536881, 4.444786
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000859, 2.616183, 4.621009
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001366, 2.664279, 4.861344
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000732, 2.743279, 4.911376
Train average loss all      (Triplet)                 : 0.001080

== Recognize ==
Train average loss Recognize     : 0.616311
Train average accuracy drums     : 81.029999 %
Train average accuracy bass      : 56.765003 %
Train average accuracy piano     : 55.589996 %
Train average accuracy guitar    : 56.914997 %
Train average accuracy residuals : 60.540001 %

== Train average loss all : 0.007243

Epoch 159:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]          Epoch 160:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]Epoch 160:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]Epoch 160:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.0087, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00265, Train/loss_recog_step=0.606, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]Epoch 160:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.0087, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00265, Train/loss_recog_step=0.606, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]Epoch 160:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616] Epoch 160:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]Epoch 160:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.677, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]Epoch 160:  64%|██████▍   | 200/313 [04:04<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.677, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]Epoch 160:  64%|██████▍   | 200/313 [04:04<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]Epoch 160:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]Epoch 160:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]Epoch 160:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]Epoch 160:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.636, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]Epoch 160: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.636, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]Epoch 160: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.621, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.307, Valid/loss_recog_epoch=0.701, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.35it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.33it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.45it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.07it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.70it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184891, 0.188218, 0.190677, 0.195927
Valid average loss UNet                 (all)                : 0.759712

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.039847, 1.629555, 3.202080
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.316632, 2.374193, 2.930649
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.494291, 2.673535, 2.610654
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.211720, 2.341148, 3.329542
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.308410, 2.705981, 3.067450
Valid average loss all      (Triplet)                 : 0.276652

== Recognize ==
Valid average loss Recognize     : 0.741813
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.284070

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.42786192893982 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.154102802276611 sec. =
Valid knn accuracy bass      : 22.983870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.57198977470398 sec. =
Valid knn accuracy piano     : 40.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.202996015548706 sec. =
Valid knn accuracy guitar    : 52.90178571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.272312641143799 sec. =
Valid knn accuracy residuals : 71.13636363636363%

Valid knn accuracy average   : 54.45569482454782%

                                                                      [AEpoch 160: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.621, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.616]Epoch 160: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.621, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189322, 0.189604, 0.188492, 0.194986
Train average loss UNet                 (all)                : 0.762403

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000726, 2.013923, 4.307289
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001654, 2.466218, 4.285233
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001420, 2.535211, 4.430964
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002403, 2.536814, 4.597473
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001617, 2.629848, 4.674361
Train average loss all      (Triplet)                 : 0.001537

== Recognize ==
Train average loss Recognize     : 0.611242
Train average accuracy drums     : 83.919998 %
Train average accuracy bass      : 57.764999 %
Train average accuracy piano     : 55.944996 %
Train average accuracy guitar    : 58.289997 %
Train average accuracy residuals : 62.994999 %

== Train average loss all : 0.007650

Epoch 160:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.621, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]          Epoch 161:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.621, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]Epoch 161:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.621, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]Epoch 161:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000252, Train/loss_recog_step=0.629, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]Epoch 161:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.00654, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000252, Train/loss_recog_step=0.629, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]Epoch 161:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.620, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]    Epoch 161:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.620, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]Epoch 161:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]Epoch 161:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]Epoch 161:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.661, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]Epoch 161:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.661, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]Epoch 161:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.581, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]Epoch 161:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.581, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]Epoch 161:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]Epoch 161: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]Epoch 161: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000339, Train/loss_recog_step=0.657, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.55it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.71it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.68it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185019, 0.188420, 0.190666, 0.196982
Valid average loss UNet                 (all)                : 0.761087

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.050865, 1.756742, 3.359599
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.453046, 2.534273, 2.912136
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.388110, 2.541170, 2.717173
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.235599, 2.462113, 3.373738
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.314494, 2.754729, 3.146278
Valid average loss all      (Triplet)                 : 0.300393

== Recognize ==
Valid average loss Recognize     : 0.717303
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 56.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.307566

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.40882658958435 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.353575229644775 sec. =
Valid knn accuracy bass      : 17.338709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.873600482940674 sec. =
Valid knn accuracy piano     : 42.96875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.328580856323242 sec. =
Valid knn accuracy guitar    : 56.02678571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.408185958862305 sec. =
Valid knn accuracy residuals : 69.31818181818183%

Valid knn accuracy average   : 53.826137615890424%

                                                                      [AEpoch 161: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000339, Train/loss_recog_step=0.657, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=0.611]Epoch 161: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000339, Train/loss_recog_step=0.657, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189151, 0.189471, 0.188341, 0.194961
Train average loss UNet                 (all)                : 0.761925

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000228, 2.001446, 4.275194
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002481, 2.457078, 4.265918
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001337, 2.499026, 4.373195
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001807, 2.498807, 4.540716
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001637, 2.640652, 4.658076
Train average loss all      (Triplet)                 : 0.001554

== Recognize ==
Train average loss Recognize     : 0.615021
Train average accuracy drums     : 82.534996 %
Train average accuracy bass      : 57.050003 %
Train average accuracy piano     : 55.309998 %
Train average accuracy guitar    : 57.560001 %
Train average accuracy residuals : 60.880001 %

== Train average loss all : 0.007705

Epoch 161:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000339, Train/loss_recog_step=0.657, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]          Epoch 162:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000339, Train/loss_recog_step=0.657, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]Epoch 162:  16%|█▌        | 50/313 [01:08<05:57,  0.73it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000339, Train/loss_recog_step=0.657, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]Epoch 162:  16%|█▌        | 50/313 [01:08<05:57,  0.73it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]   Epoch 162:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]Epoch 162:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00596, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.596, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]Epoch 162:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00596, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.596, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]Epoch 162:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]Epoch 162:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]Epoch 162:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]Epoch 162:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]Epoch 162:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.593, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]Epoch 162:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.593, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]Epoch 162:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00814, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00208, Train/loss_recog_step=0.606, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]Epoch 162: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00814, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00208, Train/loss_recog_step=0.606, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]Epoch 162: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.717, Valid/knn_avr=0.538, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.26it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.11it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:04<00:00,  1.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.06it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184344, 0.187633, 0.190163, 0.207634
Valid average loss UNet                 (all)                : 0.769774

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.038936, 1.829894, 3.629923
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.426557, 2.630774, 3.090827
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.479684, 2.832582, 2.931659
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.368567, 2.608511, 3.490003
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.318764, 2.800563, 3.351768
Valid average loss all      (Triplet)                 : 0.334833

== Recognize ==
Valid average loss Recognize     : 0.679681
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.341629

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.390650749206543 sec. =
Valid knn accuracy drums     : 85.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.289765119552612 sec. =
Valid knn accuracy bass      : 27.62096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.77281403541565 sec. =
Valid knn accuracy piano     : 44.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.36453628540039 sec. =
Valid knn accuracy guitar    : 56.02678571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.443225145339966 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 56.68613418926795%

                                                                      [AEpoch 162: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.615]Epoch 162: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189138, 0.189446, 0.188317, 0.194411
Train average loss UNet                 (all)                : 0.761311

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000280, 2.036076, 4.317935
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001852, 2.482843, 4.370379
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002091, 2.498603, 4.338156
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001762, 2.595651, 4.674673
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000606, 2.665517, 4.716231
Train average loss all      (Triplet)                 : 0.001303

== Recognize ==
Train average loss Recognize     : 0.613291
Train average accuracy drums     : 82.040001 %
Train average accuracy bass      : 57.059998 %
Train average accuracy piano     : 57.225002 %
Train average accuracy guitar    : 57.260002 %
Train average accuracy residuals : 61.099998 %

== Train average loss all : 0.007436

Epoch 162:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]          Epoch 163:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]Epoch 163:  16%|█▌        | 50/313 [01:08<06:02,  0.72it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]Epoch 163:  16%|█▌        | 50/313 [01:08<06:02,  0.72it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000382, Train/loss_recog_step=0.607, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]Epoch 163:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000382, Train/loss_recog_step=0.607, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]Epoch 163:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00055, Train/loss_recog_step=0.606, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613] Epoch 163:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00055, Train/loss_recog_step=0.606, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]Epoch 163:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.638, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]  Epoch 163:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.638, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]Epoch 163:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.689, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]Epoch 163:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.689, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]Epoch 163:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]Epoch 163:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]Epoch 163:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]Epoch 163: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]Epoch 163: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=0.626, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.335, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.55it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.70it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.68it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.62it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.82it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183803, 0.187095, 0.189244, 0.195338
Valid average loss UNet                 (all)                : 0.755481

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.050463, 1.749031, 3.505837
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.538571, 2.610195, 2.899485
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.440066, 2.648520, 2.624286
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.307125, 2.456324, 3.335113
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.263887, 2.554521, 3.208355
Valid average loss all      (Triplet)                 : 0.343697

== Recognize ==
Valid average loss Recognize     : 0.742314
Valid average accuracy drums     : 56.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.351120

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.280262231826782 sec. =
Valid knn accuracy drums     : 86.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.2872953414917 sec. =
Valid knn accuracy bass      : 25.403225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.695767879486084 sec. =
Valid knn accuracy piano     : 36.328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.44611668586731 sec. =
Valid knn accuracy guitar    : 43.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.869511365890503 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 51.94804881741681%

                                                                      [AEpoch 163: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=0.626, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=0.613]Epoch 163: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=0.626, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188507, 0.188801, 0.187725, 0.194800
Train average loss UNet                 (all)                : 0.759833

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000396, 2.038536, 4.316945
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002905, 2.558146, 4.433731
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002178, 2.552422, 4.425867
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001302, 2.584110, 4.659247
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001544, 2.588957, 4.567695
Train average loss all      (Triplet)                 : 0.001634

== Recognize ==
Train average loss Recognize     : 0.614110
Train average accuracy drums     : 82.630005 %
Train average accuracy bass      : 57.190002 %
Train average accuracy piano     : 56.220001 %
Train average accuracy guitar    : 56.465000 %
Train average accuracy residuals : 62.169998 %

== Train average loss all : 0.007775

Epoch 163:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=0.626, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]          Epoch 164:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=0.626, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]Epoch 164:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=0.626, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]Epoch 164:  16%|█▌        | 50/313 [01:07<05:57,  0.74it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614] Epoch 164:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]Epoch 164:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00305, Train/loss_recog_step=0.612, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]Epoch 164:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00305, Train/loss_recog_step=0.612, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]Epoch 164:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0064, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.640, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]   Epoch 164:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0064, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.640, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]Epoch 164:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000233, Train/loss_recog_step=0.603, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]Epoch 164:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000233, Train/loss_recog_step=0.603, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]Epoch 164:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]   Epoch 164:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]Epoch 164:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00674, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00013, Train/loss_recog_step=0.661, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]Epoch 164: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00674, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00013, Train/loss_recog_step=0.661, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]Epoch 164: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0085, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=0.707, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.263, Valid/loss_recog_step=0.806, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.519, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.24it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.95it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.06it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.98it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184017, 0.187355, 0.189629, 0.201156
Valid average loss UNet                 (all)                : 0.762156

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.042621, 1.891602, 3.829747
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.484979, 2.682739, 3.176648
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.401738, 2.841263, 3.027180
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.279954, 2.660899, 3.741272
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.344372, 2.904500, 3.425241
Valid average loss all      (Triplet)                 : 0.336906

== Recognize ==
Valid average loss Recognize     : 0.702590
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.343931

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.571118593215942 sec. =
Valid knn accuracy drums     : 87.17391304347825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.669621229171753 sec. =
Valid knn accuracy bass      : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.468544006347656 sec. =
Valid knn accuracy piano     : 45.5078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.439225435256958 sec. =
Valid knn accuracy guitar    : 51.11607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.728564977645874 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 55.714104848955394%

                                                                      [AEpoch 164: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0085, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=0.707, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00778, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=0.614]Epoch 164: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0085, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=0.707, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188804, 0.189131, 0.188013, 0.194398
Train average loss UNet                 (all)                : 0.760346

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000171, 2.073044, 4.425627
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001738, 2.536359, 4.417357
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001664, 2.563731, 4.463293
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002151, 2.633042, 4.712089
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001433, 2.650720, 4.706942
Train average loss all      (Triplet)                 : 0.001463

== Recognize ==
Train average loss Recognize     : 0.616712
Train average accuracy drums     : 82.134995 %
Train average accuracy bass      : 57.015003 %
Train average accuracy piano     : 54.410000 %
Train average accuracy guitar    : 57.470001 %
Train average accuracy residuals : 59.785004 %

== Train average loss all : 0.007630

Epoch 164:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0085, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=0.707, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]          Epoch 165:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0085, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=0.707, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]Epoch 165:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.0085, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=0.707, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]Epoch 165:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617] Epoch 165:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]Epoch 165:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.589, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]Epoch 165:  48%|████▊     | 150/313 [03:06<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.589, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]Epoch 165:  48%|████▊     | 150/313 [03:06<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617] Epoch 165:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]Epoch 165:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]Epoch 165:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]Epoch 165:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00572, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.572, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]Epoch 165:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00572, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.572, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]Epoch 165:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.591, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]Epoch 165: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.591, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]Epoch 165: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.38it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.48it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.50it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.90it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184526, 0.187827, 0.190215, 0.204100
Valid average loss UNet                 (all)                : 0.766669

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.079550, 1.657983, 3.099832
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.416052, 2.361061, 2.758270
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.313577, 2.494555, 2.646010
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.310351, 2.388655, 3.146378
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.256903, 2.406044, 2.977283
Valid average loss all      (Triplet)                 : 0.291242

== Recognize ==
Valid average loss Recognize     : 0.704606
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.298288

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.515520572662354 sec. =
Valid knn accuracy drums     : 85.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.032959699630737 sec. =
Valid knn accuracy bass      : 28.62903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.10835337638855 sec. =
Valid knn accuracy piano     : 46.484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.38241457939148 sec. =
Valid knn accuracy guitar    : 51.33928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.340698957443237 sec. =
Valid knn accuracy residuals : 70.22727272727273%

Valid knn accuracy average   : 56.46642792253329%

                                                                      [AEpoch 165: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=0.617]Epoch 165: 100%|██████████| 313/313 [07:37<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189130, 0.189423, 0.188308, 0.194777
Train average loss UNet                 (all)                : 0.761637

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000587, 2.108740, 4.531924
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002553, 2.541758, 4.445434
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001457, 2.577868, 4.470904
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001458, 2.621614, 4.714845
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001517, 2.677016, 4.713667
Train average loss all      (Triplet)                 : 0.001534

== Recognize ==
Train average loss Recognize     : 0.611721
Train average accuracy drums     : 81.485001 %
Train average accuracy bass      : 58.385002 %
Train average accuracy piano     : 56.825001 %
Train average accuracy guitar    : 58.910000 %
Train average accuracy residuals : 61.344997 %

== Train average loss all : 0.007652

Epoch 165:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]          Epoch 166:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]Epoch 166:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]Epoch 166:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.592, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]Epoch 166:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.592, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]Epoch 166:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00432, Train/loss_recog_step=0.595, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]Epoch 166:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00432, Train/loss_recog_step=0.595, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]Epoch 166:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=0.588, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]Epoch 166:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=0.588, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]Epoch 166:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612] Epoch 166:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]Epoch 166:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]Epoch 166:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]Epoch 166:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00431, Train/loss_recog_step=0.648, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]Epoch 166: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00431, Train/loss_recog_step=0.648, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]Epoch 166: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.13it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.49it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.65it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185090, 0.188428, 0.190689, 0.202840
Valid average loss UNet                 (all)                : 0.767048

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.100931, 1.724878, 3.181264
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.501693, 2.604513, 2.947168
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.351546, 2.652052, 2.852516
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.290391, 2.558099, 3.522112
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.283533, 2.653717, 3.200325
Valid average loss all      (Triplet)                 : 0.326848

== Recognize ==
Valid average loss Recognize     : 0.699089
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.333839

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.703906536102295 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.353145599365234 sec. =
Valid knn accuracy bass      : 27.419354838709676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.551828861236572 sec. =
Valid knn accuracy piano     : 49.609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.605003356933594 sec. =
Valid knn accuracy guitar    : 57.14285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.504595518112183 sec. =
Valid knn accuracy residuals : 65.22727272727272%

Valid knn accuracy average   : 56.966728463507046%

                                                                      [AEpoch 166: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00765, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.612]Epoch 166: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189110, 0.189418, 0.188306, 0.194568
Train average loss UNet                 (all)                : 0.761403

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000967, 2.082817, 4.274474
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001577, 2.614266, 4.555036
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002958, 2.652164, 4.577634
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001926, 2.669991, 4.809276
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001982, 2.686386, 4.719030
Train average loss all      (Triplet)                 : 0.001887

== Recognize ==
Train average loss Recognize     : 0.620047
Train average accuracy drums     : 79.409996 %
Train average accuracy bass      : 56.599998 %
Train average accuracy piano     : 55.005001 %
Train average accuracy guitar    : 55.935001 %
Train average accuracy residuals : 62.015003 %

== Train average loss all : 0.008088

Epoch 166:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]          Epoch 167:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]Epoch 167:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]Epoch 167:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]Epoch 167:  32%|███▏      | 100/313 [02:07<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]Epoch 167:  32%|███▏      | 100/313 [02:07<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]Epoch 167:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]Epoch 167:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00427, Train/loss_recog_step=0.578, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]Epoch 167:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00427, Train/loss_recog_step=0.578, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]Epoch 167:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00621, Train/loss_recog_step=0.635, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]Epoch 167:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00621, Train/loss_recog_step=0.635, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]Epoch 167:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0058, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.580, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]  Epoch 167:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0058, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.580, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]Epoch 167:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00641, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.641, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]Epoch 167: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00641, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.641, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]Epoch 167: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.567, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.28it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.15it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.90it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.71it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.84it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183448, 0.186780, 0.188825, 0.205339
Valid average loss UNet                 (all)                : 0.764392

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.072542, 1.792509, 3.457433
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.486103, 2.613678, 2.974852
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.318520, 2.506258, 2.785989
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.327911, 2.666825, 3.531630
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.241723, 2.519084, 3.252079
Valid average loss all      (Triplet)                 : 0.313273

== Recognize ==
Valid average loss Recognize     : 0.698608
Valid average accuracy drums     : 58.499996 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.320259

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.409768104553223 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.36082410812378 sec. =
Valid knn accuracy bass      : 28.830645161290324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.603112936019897 sec. =
Valid knn accuracy piano     : 45.1171875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.642983198165894 sec. =
Valid knn accuracy guitar    : 54.01785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.512169361114502 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 56.219620174268236%

                                                                      [AEpoch 167: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00809, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=0.620]Epoch 167: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189212, 0.189497, 0.188377, 0.194127
Train average loss UNet                 (all)                : 0.761213

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000484, 2.055478, 4.282360
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001747, 2.522217, 4.405806
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001642, 2.577542, 4.480390
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002428, 2.648744, 4.758088
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001489, 2.649616, 4.703410
Train average loss all      (Triplet)                 : 0.001534

== Recognize ==
Train average loss Recognize     : 0.612738
Train average accuracy drums     : 83.209999 %
Train average accuracy bass      : 57.869999 %
Train average accuracy piano     : 55.809998 %
Train average accuracy guitar    : 57.810001 %
Train average accuracy residuals : 62.814999 %

== Train average loss all : 0.007661

Epoch 167:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]          Epoch 168:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]Epoch 168:  16%|█▌        | 50/313 [01:08<06:02,  0.72it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]Epoch 168:  16%|█▌        | 50/313 [01:08<06:02,  0.72it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0044, Train/loss_recog_step=0.636, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]Epoch 168:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0044, Train/loss_recog_step=0.636, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]Epoch 168:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]Epoch 168:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]Epoch 168:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00647, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.647, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]Epoch 168:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00647, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.647, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]Epoch 168:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00775, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00177, Train/loss_recog_step=0.598, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]Epoch 168:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00775, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00177, Train/loss_recog_step=0.598, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]Epoch 168:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00554, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.554, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]  Epoch 168:  96%|█████████▌| 300/313 [05:59<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00554, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.554, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]Epoch 168:  96%|█████████▌| 300/313 [05:59<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00616, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.616, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]Epoch 168: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00616, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.616, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]Epoch 168: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.298, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.48it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.44it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.88it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.71it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.25it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.91it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183983, 0.187306, 0.189497, 0.199747
Valid average loss UNet                 (all)                : 0.760533

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.071668, 1.708579, 3.241901
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.489130, 2.496379, 2.864996
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.347610, 2.442332, 2.528561
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.284432, 2.405614, 3.439389
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.290606, 2.567363, 3.370756
Valid average loss all      (Triplet)                 : 0.321042

== Recognize ==
Valid average loss Recognize     : 0.711170
Valid average accuracy drums     : 57.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.328154

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.842599868774414 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.378198146820068 sec. =
Valid knn accuracy bass      : 23.588709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.653523683547974 sec. =
Valid knn accuracy piano     : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.127405881881714 sec. =
Valid knn accuracy guitar    : 52.45535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.261749982833862 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 55.75229162492485%

                                                                      [AEpoch 168: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00766, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=0.613]Epoch 168: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188668, 0.188982, 0.187896, 0.194009
Train average loss UNet                 (all)                : 0.759555

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000256, 2.075130, 4.332078
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001300, 2.544101, 4.489799
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001368, 2.556418, 4.465389
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001077, 2.628620, 4.790666
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001553, 2.650955, 4.753254
Train average loss all      (Triplet)                 : 0.001148

== Recognize ==
Train average loss Recognize     : 0.606148
Train average accuracy drums     : 84.824997 %
Train average accuracy bass      : 58.110001 %
Train average accuracy piano     : 57.130005 %
Train average accuracy guitar    : 59.249996 %
Train average accuracy residuals : 62.255001 %

== Train average loss all : 0.007210

Epoch 168:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]          Epoch 169:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]Epoch 169:  16%|█▌        | 50/313 [01:07<05:55,  0.74it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]Epoch 169:  16%|█▌        | 50/313 [01:07<05:55,  0.74it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.610, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606] Epoch 169:  32%|███▏      | 100/313 [02:06<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.610, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]Epoch 169:  32%|███▏      | 100/313 [02:06<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.606, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]Epoch 169:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.606, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]Epoch 169:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]Epoch 169:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]Epoch 169:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]Epoch 169:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.673, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]Epoch 169:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.599, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]Epoch 169:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.599, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]Epoch 169:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00976, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=0.608, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]Epoch 169: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00976, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=0.608, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]Epoch 169: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00749, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.749, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=0.694, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.33it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.24it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.24it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.00it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.42it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:03<00:00,  2.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184111, 0.187431, 0.189435, 0.207634
Valid average loss UNet                 (all)                : 0.768611

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091253, 1.854077, 3.403656
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.506540, 2.791532, 2.999587
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.378121, 2.687379, 2.792030
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.301046, 2.703225, 3.608494
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.314858, 2.699194, 3.311827
Valid average loss all      (Triplet)                 : 0.336742

== Recognize ==
Valid average loss Recognize     : 0.699852
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 42.500000 %
Valid average accuracy piano     : 57.500000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 58.000000 %

== Valid average loss all : 0.343741

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.951214790344238 sec. =
Valid knn accuracy drums     : 86.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.353362560272217 sec. =
Valid knn accuracy bass      : 21.572580645161292%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.564860820770264 sec. =
Valid knn accuracy piano     : 49.21875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.66224193572998 sec. =
Valid knn accuracy guitar    : 51.11607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.871445655822754 sec. =
Valid knn accuracy residuals : 68.18181818181817%

Valid knn accuracy average   : 55.40914839893627%

                                                                      [AEpoch 169: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00749, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.749, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00721, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.606]Epoch 169: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00749, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.749, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188963, 0.189234, 0.188143, 0.194499
Train average loss UNet                 (all)                : 0.760840

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000189, 2.022779, 4.238076
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001234, 2.507991, 4.451979
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002022, 2.561859, 4.450505
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001558, 2.620614, 4.692296
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001029, 2.655812, 4.740813
Train average loss all      (Triplet)                 : 0.001280

== Recognize ==
Train average loss Recognize     : 0.608283
Train average accuracy drums     : 85.099998 %
Train average accuracy bass      : 59.520000 %
Train average accuracy piano     : 56.660004 %
Train average accuracy guitar    : 58.534996 %
Train average accuracy residuals : 62.690002 %

== Train average loss all : 0.007363

Epoch 169:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00749, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.749, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]          Epoch 170:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00749, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.749, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]Epoch 170:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00749, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.749, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]Epoch 170:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00733, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00129, Train/loss_recog_step=0.604, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]Epoch 170:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.00733, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00129, Train/loss_recog_step=0.604, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]Epoch 170:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.00757, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00159, Train/loss_recog_step=0.599, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]Epoch 170:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00757, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00159, Train/loss_recog_step=0.599, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]Epoch 170:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.610, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]   Epoch 170:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.610, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]Epoch 170:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]Epoch 170:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.639, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]Epoch 170:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]Epoch 170:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]Epoch 170:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00749, Train/loss_recog_step=0.621, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]Epoch 170: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00749, Train/loss_recog_step=0.621, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]Epoch 170: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.562, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.645, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.337, Valid/loss_recog_epoch=0.700, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.31it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.06it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.92it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.66it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.53it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184191, 0.187574, 0.189507, 0.197220
Valid average loss UNet                 (all)                : 0.758491

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.095650, 1.591304, 2.964183
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.453746, 2.419629, 2.776036
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.267157, 2.244717, 2.504224
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.246185, 2.220230, 3.093182
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.262831, 2.378842, 2.925975
Valid average loss all      (Triplet)                 : 0.278755

== Recognize ==
Valid average loss Recognize     : 0.777583
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.286531

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.459777116775513 sec. =
Valid knn accuracy drums     : 81.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.736016035079956 sec. =
Valid knn accuracy bass      : 26.411290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.641878604888916 sec. =
Valid knn accuracy piano     : 48.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.405472993850708 sec. =
Valid knn accuracy guitar    : 55.35714285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.267876148223877 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 55.711147110253%

                                                                      [AEpoch 170: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.562, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=0.608]Epoch 170: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.562, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188697, 0.188999, 0.187911, 0.195034
Train average loss UNet                 (all)                : 0.760641

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000384, 2.064946, 4.351476
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002746, 2.634657, 4.563010
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002175, 2.574561, 4.490104
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000940, 2.615991, 4.718492
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000987, 2.647480, 4.738494
Train average loss all      (Triplet)                 : 0.001451

== Recognize ==
Train average loss Recognize     : 0.612915
Train average accuracy drums     : 83.464996 %
Train average accuracy bass      : 56.314999 %
Train average accuracy piano     : 56.440002 %
Train average accuracy guitar    : 57.810001 %
Train average accuracy residuals : 62.295002 %

== Train average loss all : 0.007580

Epoch 170:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.562, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]          Epoch 171:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.562, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]Epoch 171:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.562, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]Epoch 171:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.613, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]Epoch 171:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.613, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]Epoch 171:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.008, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=0.599, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]Epoch 171:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.008, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=0.599, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]Epoch 171:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00062, Train/loss_recog_step=0.610, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]Epoch 171:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00062, Train/loss_recog_step=0.610, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]Epoch 171:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]  Epoch 171:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]Epoch 171:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0074, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00161, Train/loss_recog_step=0.579, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]Epoch 171:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0074, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00161, Train/loss_recog_step=0.579, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]Epoch 171:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]  Epoch 171: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]Epoch 171: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.595, Valid/loss_all_step=0.167, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.778, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.03it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.27it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.08it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:03<00:00,  2.14it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184671, 0.188042, 0.190274, 0.192681
Valid average loss UNet                 (all)                : 0.755668

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.068459, 1.712851, 3.195751
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.423804, 2.410542, 2.719537
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.325188, 2.436096, 2.631722
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.297260, 2.315616, 3.296129
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.278881, 2.473760, 2.934550
Valid average loss all      (Triplet)                 : 0.291723

== Recognize ==
Valid average loss Recognize     : 0.729232
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.299015

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.315291166305542 sec. =
Valid knn accuracy drums     : 84.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.545105695724487 sec. =
Valid knn accuracy bass      : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.653605699539185 sec. =
Valid knn accuracy piano     : 48.2421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.255762100219727 sec. =
Valid knn accuracy guitar    : 57.8125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.446094036102295 sec. =
Valid knn accuracy residuals : 68.18181818181817%

Valid knn accuracy average   : 56.803822875494056%

                                                                      [AEpoch 171: 100%|██████████| 313/313 [07:50<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.595, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00758, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.613]Epoch 171: 100%|██████████| 313/313 [07:50<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.595, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188710, 0.189022, 0.187928, 0.194675
Train average loss UNet                 (all)                : 0.760335

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000590, 2.045713, 4.311321
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001428, 2.523437, 4.487859
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002011, 2.582374, 4.482582
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001448, 2.565390, 4.648078
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001143, 2.678029, 4.808027
Train average loss all      (Triplet)                 : 0.001363

== Recognize ==
Train average loss Recognize     : 0.609118
Train average accuracy drums     : 83.084999 %
Train average accuracy bass      : 58.714996 %
Train average accuracy piano     : 57.110001 %
Train average accuracy guitar    : 58.714996 %
Train average accuracy residuals : 62.959999 %

== Train average loss all : 0.007454

Epoch 171:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.595, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]          Epoch 172:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.595, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]Epoch 172:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.595, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]Epoch 172:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.00596, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.596, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]Epoch 172:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.00596, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.596, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]Epoch 172:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.0213, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=0.595, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]Epoch 172:  48%|████▊     | 150/313 [03:10<03:27,  0.79it/s, v_num=0, Train/loss_all_step=0.0213, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=0.595, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]Epoch 172:  48%|████▊     | 150/313 [03:10<03:27,  0.79it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609] Epoch 172:  64%|██████▍   | 200/313 [04:08<02:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]Epoch 172:  64%|██████▍   | 200/313 [04:08<02:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00398, Train/loss_recog_step=0.655, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]Epoch 172:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00398, Train/loss_recog_step=0.655, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]Epoch 172:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.592, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609] Epoch 172:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.592, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]Epoch 172:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000335, Train/loss_recog_step=0.638, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]Epoch 172: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000335, Train/loss_recog_step=0.638, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]Epoch 172: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00679, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.679, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.49it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.90it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.45it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182967, 0.186373, 0.188083, 0.200650
Valid average loss UNet                 (all)                : 0.758073

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.122261, 1.790447, 3.254281
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.471082, 2.551702, 2.778949
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.436595, 2.690894, 2.679039
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.367792, 2.478238, 3.302683
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.294713, 2.691883, 3.330265
Valid average loss all      (Triplet)                 : 0.345707

== Recognize ==
Valid average loss Recognize     : 0.737761
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.353084

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.418334245681763 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.359561204910278 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.82746171951294 sec. =
Valid knn accuracy piano     : 42.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.544444561004639 sec. =
Valid knn accuracy guitar    : 54.91071428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.408434867858887 sec. =
Valid knn accuracy residuals : 75.22727272727273%

Valid knn accuracy average   : 57.32764999726781%

                                                                      [AEpoch 172: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00679, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.679, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00745, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.609]Epoch 172: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00679, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.679, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188662, 0.188978, 0.187867, 0.194787
Train average loss UNet                 (all)                : 0.760293

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000255, 2.106528, 4.456654
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002793, 2.578713, 4.497400
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001632, 2.635777, 4.572811
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001213, 2.676531, 4.832758
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002244, 2.737976, 4.866672
Train average loss all      (Triplet)                 : 0.001753

== Recognize ==
Train average loss Recognize     : 0.613928
Train average accuracy drums     : 82.494995 %
Train average accuracy bass      : 56.945004 %
Train average accuracy piano     : 55.645000 %
Train average accuracy guitar    : 58.320000 %
Train average accuracy residuals : 62.554996 %

== Train average loss all : 0.007893

Epoch 172:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00679, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.679, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]          Epoch 173:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00679, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.679, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]Epoch 173:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00679, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.679, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]Epoch 173:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.0091, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00306, Train/loss_recog_step=0.604, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]Epoch 173:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.0091, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00306, Train/loss_recog_step=0.604, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]Epoch 173:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]   Epoch 173:  48%|████▊     | 150/313 [03:05<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]Epoch 173:  48%|████▊     | 150/313 [03:05<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.575, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]Epoch 173:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.575, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]Epoch 173:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614] Epoch 173:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]Epoch 173:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.585, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]Epoch 173:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.585, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]Epoch 173:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.00536, Train/loss_recog_step=0.592, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]Epoch 173: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.00536, Train/loss_recog_step=0.592, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]Epoch 173: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=0.638, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.738, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.36it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.24it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.23it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.65it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185310, 0.188683, 0.191039, 0.197925
Valid average loss UNet                 (all)                : 0.762956

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090217, 1.844245, 3.437696
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.384226, 2.547088, 3.038318
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.349465, 2.514315, 2.589872
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.347827, 2.523723, 3.597392
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.306698, 2.687672, 3.242909
Valid average loss all      (Triplet)                 : 0.296307

== Recognize ==
Valid average loss Recognize     : 0.742664
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 44.500000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.303733

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.924694299697876 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.304324388504028 sec. =
Valid knn accuracy bass      : 26.814516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.116856575012207 sec. =
Valid knn accuracy piano     : 48.828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.416721820831299 sec. =
Valid knn accuracy guitar    : 48.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.21614146232605 sec. =
Valid knn accuracy residuals : 72.95454545454545%

Valid knn accuracy average   : 56.18954601236771%

                                                                      [AEpoch 173: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=0.614]Epoch 173: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188800, 0.189102, 0.187994, 0.194430
Train average loss UNet                 (all)                : 0.760327

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000357, 2.137384, 4.509031
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003063, 2.629452, 4.658308
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001651, 2.637233, 4.606039
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001618, 2.701497, 4.889399
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002625, 2.757735, 4.866792
Train average loss all      (Triplet)                 : 0.001873

== Recognize ==
Train average loss Recognize     : 0.613062
Train average accuracy drums     : 82.550003 %
Train average accuracy bass      : 55.405003 %
Train average accuracy piano     : 56.634998 %
Train average accuracy guitar    : 59.084999 %
Train average accuracy residuals : 60.625000 %

== Train average loss all : 0.008004

Epoch 173:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]          Epoch 174:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]Epoch 174:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]Epoch 174:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]Epoch 174:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]Epoch 174:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0067, Train/loss_recog_step=0.570, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]Epoch 174:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0067, Train/loss_recog_step=0.570, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]Epoch 174:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613] Epoch 174:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]Epoch 174:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]Epoch 174:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]Epoch 174:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00582, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.582, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]Epoch 174:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00582, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.582, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]Epoch 174:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]Epoch 174: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]Epoch 174: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.674, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.562, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.31it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.93it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.84it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.67it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.68it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184165, 0.187446, 0.189893, 0.191081
Valid average loss UNet                 (all)                : 0.752585

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.089702, 1.784293, 3.302992
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.469566, 2.715162, 3.123148
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.307319, 2.478824, 2.721624
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.224567, 2.377871, 3.466256
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.281650, 2.649308, 3.333099
Valid average loss all      (Triplet)                 : 0.290202

== Recognize ==
Valid average loss Recognize     : 0.748748
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 42.500000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.297689

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.447949886322021 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.455726385116577 sec. =
Valid knn accuracy bass      : 27.21774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.608653545379639 sec. =
Valid knn accuracy piano     : 49.0234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.715644359588623 sec. =
Valid knn accuracy guitar    : 51.5625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.274922132492065 sec. =
Valid knn accuracy residuals : 68.4090909090909%

Valid knn accuracy average   : 55.6773366776106%

                                                                      [AEpoch 174: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.008, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=0.613]Epoch 174: 100%|██████████| 313/313 [07:38<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189133, 0.189438, 0.188307, 0.194201
Train average loss UNet                 (all)                : 0.761079

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000527, 2.043086, 4.305129
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001639, 2.551155, 4.535311
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001909, 2.521564, 4.444724
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001206, 2.624246, 4.729316
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001769, 2.664119, 4.775860
Train average loss all      (Triplet)                 : 0.001341

== Recognize ==
Train average loss Recognize     : 0.606003
Train average accuracy drums     : 85.430000 %
Train average accuracy bass      : 58.824997 %
Train average accuracy piano     : 58.635002 %
Train average accuracy guitar    : 59.079998 %
Train average accuracy residuals : 62.545002 %

== Train average loss all : 0.007401

Epoch 174:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]          Epoch 175:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]Epoch 175:  16%|█▌        | 50/313 [01:09<06:02,  0.72it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]Epoch 175:  16%|█▌        | 50/313 [01:09<06:02,  0.72it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.593, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]Epoch 175:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.593, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]Epoch 175:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0058, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.580, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606] Epoch 175:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0058, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.580, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]Epoch 175:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.620, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]Epoch 175:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.620, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]Epoch 175:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]Epoch 175:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.634, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]Epoch 175:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000348, Train/loss_recog_step=0.579, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]Epoch 175:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000348, Train/loss_recog_step=0.579, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]Epoch 175:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]   Epoch 175: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]Epoch 175: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00567, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.567, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.749, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.48it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.16it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.07it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.68it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.27it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183935, 0.187235, 0.189608, 0.201981
Valid average loss UNet                 (all)                : 0.762759

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.095951, 1.675909, 3.032736
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.441296, 2.462194, 2.783577
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.346466, 2.356984, 2.535661
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.270725, 2.225795, 3.215642
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.283304, 2.572909, 3.049921
Valid average loss all      (Triplet)                 : 0.302522

== Recognize ==
Valid average loss Recognize     : 0.664643
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 62.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.309168

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.785844564437866 sec. =
Valid knn accuracy drums     : 83.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.412492513656616 sec. =
Valid knn accuracy bass      : 25.403225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.649180889129639 sec. =
Valid knn accuracy piano     : 41.9921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.81688928604126 sec. =
Valid knn accuracy guitar    : 50.89285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.400088548660278 sec. =
Valid knn accuracy residuals : 71.13636363636363%

Valid knn accuracy average   : 54.624057251917094%

                                                                      [AEpoch 175: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00567, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.567, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.606]Epoch 175: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00567, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.567, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188944, 0.189265, 0.188144, 0.194709
Train average loss UNet                 (all)                : 0.761061

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000426, 1.978372, 4.099330
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000910, 2.489494, 4.471997
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002732, 2.502361, 4.420225
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001121, 2.549431, 4.619744
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001395, 2.607162, 4.677702
Train average loss all      (Triplet)                 : 0.001291

== Recognize ==
Train average loss Recognize     : 0.605585
Train average accuracy drums     : 85.505005 %
Train average accuracy bass      : 59.934998 %
Train average accuracy piano     : 56.849998 %
Train average accuracy guitar    : 59.189999 %
Train average accuracy residuals : 62.844997 %

== Train average loss all : 0.007347

Epoch 175:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00567, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.567, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]          Epoch 176:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00567, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.567, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]Epoch 176:  16%|█▌        | 50/313 [01:08<06:02,  0.72it/s, v_num=0, Train/loss_all_step=0.00567, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.567, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]Epoch 176:  16%|█▌        | 50/313 [01:08<06:02,  0.72it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]Epoch 176:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]Epoch 176:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]Epoch 176:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]Epoch 176:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.647, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606] Epoch 176:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.647, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]Epoch 176:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]Epoch 176:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]Epoch 176:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.593, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]Epoch 176:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.593, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]Epoch 176:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00483, Train/loss_recog_step=0.605, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]Epoch 176: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00483, Train/loss_recog_step=0.605, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]Epoch 176: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=0.629, Valid/loss_all_epoch=0.309, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.665, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.13it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.76it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.83it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185448, 0.188725, 0.191300, 0.203817
Valid average loss UNet                 (all)                : 0.769291

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.084434, 1.718857, 3.317005
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.441265, 2.512689, 2.895314
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.360198, 2.573262, 2.694075
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.237701, 2.245079, 3.355580
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.274115, 2.669125, 3.073075
Valid average loss all      (Triplet)                 : 0.285375

== Recognize ==
Valid average loss Recognize     : 0.713499
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.292510

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.424079418182373 sec. =
Valid knn accuracy drums     : 84.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.641979455947876 sec. =
Valid knn accuracy bass      : 32.45967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.614951372146606 sec. =
Valid knn accuracy piano     : 41.40625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.334201335906982 sec. =
Valid knn accuracy guitar    : 48.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.316332340240479 sec. =
Valid knn accuracy residuals : 71.13636363636363%

Valid knn accuracy average   : 55.64447995027413%

                                                                      [AEpoch 176: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00735, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=0.606]Epoch 176: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189062, 0.189373, 0.188257, 0.194537
Train average loss UNet                 (all)                : 0.761229

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000399, 2.125556, 4.496010
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002351, 2.621908, 4.621397
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001117, 2.669234, 4.711640
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001627, 2.682775, 4.849643
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000668, 2.759489, 4.970489
Train average loss all      (Triplet)                 : 0.001248

== Recognize ==
Train average loss Recognize     : 0.612997
Train average accuracy drums     : 81.504997 %
Train average accuracy bass      : 57.860001 %
Train average accuracy piano     : 55.000000 %
Train average accuracy guitar    : 57.760002 %
Train average accuracy residuals : 64.205002 %

== Train average loss all : 0.007378

Epoch 176:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]          Epoch 177:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]Epoch 177:  16%|█▌        | 50/313 [01:09<06:07,  0.71it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]Epoch 177:  16%|█▌        | 50/313 [01:09<06:07,  0.71it/s, v_num=0, Train/loss_all_step=0.00928, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0033, Train/loss_recog_step=0.598, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]Epoch 177:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00928, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0033, Train/loss_recog_step=0.598, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]Epoch 177:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00669, Train/loss_recog_step=0.607, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]Epoch 177:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00669, Train/loss_recog_step=0.607, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]Epoch 177:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.00557, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.557, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613] Epoch 177:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00557, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.557, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]Epoch 177:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]Epoch 177:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]Epoch 177:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]Epoch 177:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]Epoch 177:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00887, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00279, Train/loss_recog_step=0.608, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]Epoch 177: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00887, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00279, Train/loss_recog_step=0.608, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]Epoch 177: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.648, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.285, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.31it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.13it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.85it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.46it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.61it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184386, 0.187792, 0.189786, 0.203377
Valid average loss UNet                 (all)                : 0.765341

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.056373, 1.900003, 3.731848
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.476870, 2.805493, 3.218447
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.362366, 2.686925, 3.008371
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.333975, 2.616138, 3.628993
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.316231, 2.897845, 3.396321
Valid average loss all      (Triplet)                 : 0.322339

== Recognize ==
Valid average loss Recognize     : 0.688602
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 43.500000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.329225

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.503342628479004 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.654119968414307 sec. =
Valid knn accuracy bass      : 23.790322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.588622331619263 sec. =
Valid knn accuracy piano     : 46.6796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.382249355316162 sec. =
Valid knn accuracy guitar    : 53.79464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.345782279968262 sec. =
Valid knn accuracy residuals : 74.0909090909091%

Valid knn accuracy average   : 56.27980805791333%

                                                                      [AEpoch 177: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00738, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.613]Epoch 177: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189025, 0.189326, 0.188222, 0.194195
Train average loss UNet                 (all)                : 0.760768

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000563, 2.200511, 4.533418
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001786, 2.711505, 4.749650
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002581, 2.789662, 4.900963
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001436, 2.788648, 5.057869
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000695, 2.864314, 5.130194
Train average loss all      (Triplet)                 : 0.001432

== Recognize ==
Train average loss Recognize     : 0.612353
Train average accuracy drums     : 81.445000 %
Train average accuracy bass      : 57.764999 %
Train average accuracy piano     : 55.650002 %
Train average accuracy guitar    : 58.464996 %
Train average accuracy residuals : 62.774998 %

== Train average loss all : 0.007556

Epoch 177:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]          Epoch 178:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]Epoch 178:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]Epoch 178:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]Epoch 178:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]Epoch 178:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]Epoch 178:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]Epoch 178:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00764, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0016, Train/loss_recog_step=0.604, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]Epoch 178:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00764, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0016, Train/loss_recog_step=0.604, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]Epoch 178:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00878, Train/loss_recog_step=0.649, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]Epoch 178:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00878, Train/loss_recog_step=0.649, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]Epoch 178:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612] Epoch 178:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]Epoch 178:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]Epoch 178: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00623, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.623, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]Epoch 178: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.641, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.689, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.30it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.81it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.78it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.16it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.58it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.83it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183753, 0.187154, 0.189050, 0.204539
Valid average loss UNet                 (all)                : 0.764495

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091733, 1.771182, 3.359051
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.480929, 2.569312, 2.876285
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.334064, 2.475911, 2.724416
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.327535, 2.382918, 3.157057
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.295919, 2.741443, 3.221864
Valid average loss all      (Triplet)                 : 0.325819

== Recognize ==
Valid average loss Recognize     : 0.674631
Valid average accuracy drums     : 57.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.332565

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.351445436477661 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.823791027069092 sec. =
Valid knn accuracy bass      : 28.830645161290324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.90194296836853 sec. =
Valid knn accuracy piano     : 44.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.410026550292969 sec. =
Valid knn accuracy guitar    : 51.11607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.286375999450684 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 55.82142088714232%

                                                                      [AEpoch 178: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=0.612]Epoch 178: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188926, 0.189233, 0.188126, 0.194905
Train average loss UNet                 (all)                : 0.761190

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000420, 2.199569, 4.620954
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003109, 2.683915, 4.660231
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001795, 2.751974, 4.770612
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002125, 2.797959, 5.037094
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001005, 2.858080, 5.114145
Train average loss all      (Triplet)                 : 0.001728

== Recognize ==
Train average loss Recognize     : 0.612370
Train average accuracy drums     : 82.504997 %
Train average accuracy bass      : 58.219997 %
Train average accuracy piano     : 55.215000 %
Train average accuracy guitar    : 57.620003 %
Train average accuracy residuals : 62.339996 %

== Train average loss all : 0.007851

Epoch 178:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]          Epoch 179:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]Epoch 179:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]Epoch 179:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00845, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00245, Train/loss_recog_step=0.600, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]Epoch 179:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00845, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00245, Train/loss_recog_step=0.600, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]Epoch 179:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]  Epoch 179:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]Epoch 179:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0068, Train/loss_recog_step=0.600, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]Epoch 179:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0068, Train/loss_recog_step=0.600, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]Epoch 179:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]Epoch 179:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]Epoch 179:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.592, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]Epoch 179:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.592, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]Epoch 179:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00616, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.616, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]Epoch 179: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00616, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.616, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]Epoch 179: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.618, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.27it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.86it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.55it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.88it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183829, 0.187235, 0.189148, 0.196057
Valid average loss UNet                 (all)                : 0.756269

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.107108, 1.906958, 3.530504
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.534408, 2.855931, 3.353513
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.411883, 2.969768, 3.154976
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.386310, 2.663415, 3.572203
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.300261, 2.868258, 3.590816
Valid average loss all      (Triplet)                 : 0.370312

== Recognize ==
Valid average loss Recognize     : 0.745429
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.377766

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.932775497436523 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.314188003540039 sec. =
Valid knn accuracy bass      : 27.419354838709676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.552187204360962 sec. =
Valid knn accuracy piano     : 42.7734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.074334383010864 sec. =
Valid knn accuracy guitar    : 54.46428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.375001192092896 sec. =
Valid knn accuracy residuals : 68.4090909090909%

Valid knn accuracy average   : 55.221929444591176%

                                                                      [AEpoch 179: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=0.612]Epoch 179: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188445, 0.188750, 0.187650, 0.194720
Train average loss UNet                 (all)                : 0.759566

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000131, 2.165253, 4.522326
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001749, 2.742294, 4.804964
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001927, 2.736312, 4.716881
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001855, 2.815684, 5.024262
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001635, 2.850718, 5.034720
Train average loss all      (Triplet)                 : 0.001471

== Recognize ==
Train average loss Recognize     : 0.610125
Train average accuracy drums     : 83.794998 %
Train average accuracy bass      : 57.605000 %
Train average accuracy piano     : 55.594997 %
Train average accuracy guitar    : 59.275002 %
Train average accuracy residuals : 62.895000 %

== Train average loss all : 0.007572

Epoch 179:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]          Epoch 180:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]Epoch 180:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]Epoch 180:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.586, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]Epoch 180:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.586, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]Epoch 180:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610] Epoch 180:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]Epoch 180:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]Epoch 180:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]Epoch 180:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00496, Train/loss_recog_step=0.628, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]Epoch 180:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00496, Train/loss_recog_step=0.628, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]Epoch 180:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610] Epoch 180:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]Epoch 180:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]Epoch 180: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]Epoch 180: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.745, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.47it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.11it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.12it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:03<00:00,  2.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184724, 0.188004, 0.190511, 0.192345
Valid average loss UNet                 (all)                : 0.755584

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.096807, 1.848417, 3.588241
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.517436, 2.712025, 2.943068
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.343208, 2.618410, 2.761604
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.294755, 2.445882, 3.314178
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.263778, 2.689250, 3.313454
Valid average loss all      (Triplet)                 : 0.324345

== Recognize ==
Valid average loss Recognize     : 0.718587
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 57.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.331531

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.36335015296936 sec. =
Valid knn accuracy drums     : 87.17391304347825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.783307552337646 sec. =
Valid knn accuracy bass      : 33.064516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.58616590499878 sec. =
Valid knn accuracy piano     : 45.5078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.327292442321777 sec. =
Valid knn accuracy guitar    : 45.535714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.246371507644653 sec. =
Valid knn accuracy residuals : 63.86363636363637%

Valid knn accuracy average   : 55.02911846437224%

                                                                      [AEpoch 180: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00757, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=0.610]Epoch 180: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188574, 0.188878, 0.187775, 0.194608
Train average loss UNet                 (all)                : 0.759834

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000430, 2.197753, 4.581548
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001996, 2.710975, 4.820635
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002177, 2.805313, 4.821524
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001664, 2.744271, 4.946965
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002495, 2.883250, 5.075148
Train average loss all      (Triplet)                 : 0.001770

== Recognize ==
Train average loss Recognize     : 0.612176
Train average accuracy drums     : 82.540001 %
Train average accuracy bass      : 58.055000 %
Train average accuracy piano     : 55.010002 %
Train average accuracy guitar    : 59.549999 %
Train average accuracy residuals : 62.174999 %

== Train average loss all : 0.007892

Epoch 180:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]          Epoch 181:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]Epoch 181:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]Epoch 181:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]Epoch 181:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]Epoch 181:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=0.599, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]Epoch 181:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=0.599, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]Epoch 181:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00595, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.595, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612] Epoch 181:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00595, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.595, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]Epoch 181:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.655, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]Epoch 181:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00655, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.655, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]Epoch 181:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00572, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.572, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]Epoch 181:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00572, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.572, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]Epoch 181:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]Epoch 181: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]Epoch 181: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0243, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=0.601, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.779, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.81it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.80it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.70it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.83it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183152, 0.186575, 0.188326, 0.195053
Valid average loss UNet                 (all)                : 0.753106

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.074171, 1.809057, 3.289405
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.434126, 2.493387, 2.890414
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.299579, 2.560510, 2.808683
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.266973, 2.353977, 3.358351
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.300506, 2.602492, 2.989158
Valid average loss all      (Triplet)                 : 0.286158

== Recognize ==
Valid average loss Recognize     : 0.735586
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.293514

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.560461044311523 sec. =
Valid knn accuracy drums     : 78.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.708279132843018 sec. =
Valid knn accuracy bass      : 30.846774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.113373041152954 sec. =
Valid knn accuracy piano     : 39.0625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.325997829437256 sec. =
Valid knn accuracy guitar    : 51.78571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.284910202026367 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 53.25994631245333%

                                                                      [AEpoch 181: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0243, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=0.601, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00789, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.612]Epoch 181: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0243, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=0.601, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188818, 0.189127, 0.188007, 0.194130
Train average loss UNet                 (all)                : 0.760082

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001368, 2.224730, 4.516768
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001981, 2.707708, 4.776158
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001809, 2.766459, 4.815430
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000612, 2.741519, 4.957874
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002245, 2.892935, 5.110451
Train average loss all      (Triplet)                 : 0.001563

== Recognize ==
Train average loss Recognize     : 0.613566
Train average accuracy drums     : 80.365005 %
Train average accuracy bass      : 58.474998 %
Train average accuracy piano     : 56.070000 %
Train average accuracy guitar    : 58.490002 %
Train average accuracy residuals : 61.479996 %

== Train average loss all : 0.007699

Epoch 181:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0243, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=0.601, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]          Epoch 182:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0243, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=0.601, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]Epoch 182:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.0243, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=0.601, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]Epoch 182:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]Epoch 182:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]Epoch 182:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.585, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]Epoch 182:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.585, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]Epoch 182:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00956, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=0.623, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]Epoch 182:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00956, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=0.623, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]Epoch 182:  64%|██████▍   | 200/313 [04:02<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00714, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.714, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]  Epoch 182:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00714, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.714, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]Epoch 182:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.005, Train/loss_recog_step=0.566, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614] Epoch 182:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.005, Train/loss_recog_step=0.566, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]Epoch 182:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00855, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00231, Train/loss_recog_step=0.624, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]Epoch 182: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00855, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00231, Train/loss_recog_step=0.624, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]Epoch 182: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00565, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.565, Valid/loss_all_step=0.273, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=0.790, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.45it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.07it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.31it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.36it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.77it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183893, 0.187233, 0.189179, 0.202165
Valid average loss UNet                 (all)                : 0.762470

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.063130, 1.690968, 3.051863
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.477598, 2.538821, 2.872102
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.369734, 2.549606, 2.667591
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.285966, 2.425624, 3.311087
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.282443, 2.528248, 2.991930
Valid average loss all      (Triplet)                 : 0.313003

== Recognize ==
Valid average loss Recognize     : 0.741388
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.320417

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.089489221572876 sec. =
Valid knn accuracy drums     : 80.8695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.326231002807617 sec. =
Valid knn accuracy bass      : 27.62096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.628422737121582 sec. =
Valid knn accuracy piano     : 39.2578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.907266616821289 sec. =
Valid knn accuracy guitar    : 49.55357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.315191268920898 sec. =
Valid knn accuracy residuals : 71.36363636363636%

Valid knn accuracy average   : 53.73311065030691%

                                                                      [AEpoch 182: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00565, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.565, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=0.614]Epoch 182: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00565, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.565, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188917, 0.189226, 0.188116, 0.194687
Train average loss UNet                 (all)                : 0.760946

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000293, 2.229119, 4.575229
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002493, 2.720089, 4.827345
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001680, 2.719545, 4.697573
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002150, 2.715747, 4.856927
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002962, 2.832381, 4.970911
Train average loss all      (Triplet)                 : 0.002012

== Recognize ==
Train average loss Recognize     : 0.609683
Train average accuracy drums     : 83.530006 %
Train average accuracy bass      : 57.950001 %
Train average accuracy piano     : 57.389999 %
Train average accuracy guitar    : 59.710003 %
Train average accuracy residuals : 62.035000 %

== Train average loss all : 0.008109

Epoch 182:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00565, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.565, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]          Epoch 183:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00565, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.565, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]Epoch 183:  16%|█▌        | 50/313 [01:11<06:18,  0.70it/s, v_num=0, Train/loss_all_step=0.00565, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.565, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]Epoch 183:  16%|█▌        | 50/313 [01:11<06:18,  0.70it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]Epoch 183:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]Epoch 183:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00652, Train/loss_recog_step=0.586, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]Epoch 183:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00652, Train/loss_recog_step=0.586, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]Epoch 183:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610] Epoch 183:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]Epoch 183:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00498, Train/loss_recog_step=0.643, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]Epoch 183:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00498, Train/loss_recog_step=0.643, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]Epoch 183:  80%|███████▉  | 250/313 [05:05<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610] Epoch 183:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]Epoch 183:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]Epoch 183: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]Epoch 183: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00763, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.763, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.741, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.31it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.13it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.51it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.74it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183959, 0.187326, 0.189352, 0.193729
Valid average loss UNet                 (all)                : 0.754367

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.071559, 1.996385, 3.720155
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.530531, 2.921572, 3.449877
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.386684, 2.956085, 3.219714
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.334127, 2.893884, 3.725597
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.298451, 2.921829, 3.447994
Valid average loss all      (Triplet)                 : 0.350077

== Recognize ==
Valid average loss Recognize     : 0.735916
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.357436

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.651893138885498 sec. =
Valid knn accuracy drums     : 81.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.360496997833252 sec. =
Valid knn accuracy bass      : 29.233870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.45233702659607 sec. =
Valid knn accuracy piano     : 41.9921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.45845651626587 sec. =
Valid knn accuracy guitar    : 50.22321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.782793045043945 sec. =
Valid knn accuracy residuals : 72.27272727272728%

Valid knn accuracy average   : 55.135704353062785%

                                                                      [AEpoch 183: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00763, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.763, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00811, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.610]Epoch 183: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00763, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.763, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188499, 0.188791, 0.187698, 0.194691
Train average loss UNet                 (all)                : 0.759680

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000177, 2.154603, 4.402202
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001808, 2.692837, 4.807111
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001678, 2.728544, 4.750342
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001033, 2.717871, 4.885896
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000402, 2.832457, 5.084716
Train average loss all      (Triplet)                 : 0.001059

== Recognize ==
Train average loss Recognize     : 0.602941
Train average accuracy drums     : 86.415001 %
Train average accuracy bass      : 60.294998 %
Train average accuracy piano     : 56.255001 %
Train average accuracy guitar    : 60.425003 %
Train average accuracy residuals : 65.130005 %

== Train average loss all : 0.007089

Epoch 183:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00763, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.763, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]          Epoch 184:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00763, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.763, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]Epoch 184:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00763, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.763, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]Epoch 184:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]Epoch 184:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]Epoch 184:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]Epoch 184:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]Epoch 184:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00755, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0012, Train/loss_recog_step=0.634, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]Epoch 184:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00755, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0012, Train/loss_recog_step=0.634, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]Epoch 184:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603] Epoch 184:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]Epoch 184:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.586, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]Epoch 184:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.586, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]Epoch 184:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00978, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.590, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]Epoch 184: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00978, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.590, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]Epoch 184: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00754, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.754, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.829, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.736, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.26it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.60it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.58it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.71it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184182, 0.187465, 0.189876, 0.197083
Valid average loss UNet                 (all)                : 0.758606

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.066954, 1.834505, 3.618126
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.548910, 2.642392, 3.020619
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.354598, 2.704342, 2.924721
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.287798, 2.529763, 3.403386
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.354101, 2.813829, 3.065386
Valid average loss all      (Triplet)                 : 0.340936

== Recognize ==
Valid average loss Recognize     : 0.748069
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.348416

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.850374698638916 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.75200891494751 sec. =
Valid knn accuracy bass      : 32.86290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.06062650680542 sec. =
Valid knn accuracy piano     : 47.4609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.365014791488647 sec. =
Valid knn accuracy guitar    : 50.89285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.61136794090271 sec. =
Valid knn accuracy residuals : 69.0909090909091%

Valid knn accuracy average   : 56.84413008756671%

                                                                      [AEpoch 184: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00754, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.754, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=0.603]Epoch 184: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00754, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.754, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188919, 0.189211, 0.188088, 0.194138
Train average loss UNet                 (all)                : 0.760356

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000375, 2.218154, 4.640006
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001221, 2.715947, 4.862719
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001407, 2.788024, 4.866177
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000689, 2.764206, 5.021106
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000863, 2.872852, 5.134745
Train average loss all      (Triplet)                 : 0.000893

== Recognize ==
Train average loss Recognize     : 0.606444
Train average accuracy drums     : 83.760002 %
Train average accuracy bass      : 60.280003 %
Train average accuracy piano     : 57.185001 %
Train average accuracy guitar    : 59.310001 %
Train average accuracy residuals : 62.800003 %

== Train average loss all : 0.006958

Epoch 184:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00754, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.754, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]          Epoch 185:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00754, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.754, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]Epoch 185:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.00754, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.754, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]Epoch 185:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0067, Train/loss_recog_step=0.629, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606] Epoch 185:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0067, Train/loss_recog_step=0.629, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]Epoch 185:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=0.598, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]Epoch 185:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=0.598, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]Epoch 185:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00405, Train/loss_recog_step=0.678, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]Epoch 185:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00405, Train/loss_recog_step=0.678, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]Epoch 185:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00967, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00354, Train/loss_recog_step=0.613, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]Epoch 185:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00967, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00354, Train/loss_recog_step=0.613, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]Epoch 185:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.586, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]  Epoch 185:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.586, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]Epoch 185:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0094, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00351, Train/loss_recog_step=0.589, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]Epoch 185: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0094, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00351, Train/loss_recog_step=0.589, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]Epoch 185: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.706, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.47it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.14it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.89it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.95it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.19it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184255, 0.187639, 0.189857, 0.197654
Valid average loss UNet                 (all)                : 0.759405

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.063462, 1.855042, 3.487445
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.421496, 2.682943, 3.143305
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.334832, 2.790574, 2.939666
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.262098, 2.643000, 3.747638
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.297288, 2.935618, 3.339636
Valid average loss all      (Triplet)                 : 0.290160

== Recognize ==
Valid average loss Recognize     : 0.722339
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.297384

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.485869884490967 sec. =
Valid knn accuracy drums     : 82.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.401876449584961 sec. =
Valid knn accuracy bass      : 41.733870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.874773263931274 sec. =
Valid knn accuracy piano     : 44.7265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.726422786712646 sec. =
Valid knn accuracy guitar    : 45.75892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.80820608139038 sec. =
Valid knn accuracy residuals : 68.4090909090909%

Valid knn accuracy average   : 56.60395145921749%

                                                                      [AEpoch 185: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.000893, Train/loss_recog_epoch=0.606]Epoch 185: 100%|██████████| 313/313 [07:40<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189153, 0.189466, 0.188340, 0.194624
Train average loss UNet                 (all)                : 0.761583

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000348, 2.277926, 4.769722
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001605, 2.745810, 4.874685
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001729, 2.807791, 4.919531
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002258, 2.859461, 5.214373
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001552, 2.931758, 5.173546
Train average loss all      (Triplet)                 : 0.001449

== Recognize ==
Train average loss Recognize     : 0.607232
Train average accuracy drums     : 84.869995 %
Train average accuracy bass      : 59.920002 %
Train average accuracy piano     : 58.294998 %
Train average accuracy guitar    : 58.534996 %
Train average accuracy residuals : 63.580002 %

== Train average loss all : 0.007521

Epoch 185:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]          Epoch 186:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]Epoch 186:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00653, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.653, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]Epoch 186:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]Epoch 186:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.637, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]Epoch 186:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00595, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.595, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]Epoch 186:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00595, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.595, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]Epoch 186:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=6.77e-6, Train/loss_recog_step=0.632, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]Epoch 186:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=6.77e-6, Train/loss_recog_step=0.632, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]Epoch 186:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.659, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]   Epoch 186:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.659, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]Epoch 186:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.014, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00815, Train/loss_recog_step=0.590, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]Epoch 186:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.014, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00815, Train/loss_recog_step=0.590, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]Epoch 186:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]Epoch 186: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00633, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.633, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]Epoch 186: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.591, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.722, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.60it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.86it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.83it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.65it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184505, 0.187839, 0.189940, 0.187706
Valid average loss UNet                 (all)                : 0.749989

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.108449, 1.683186, 3.079676
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.384776, 2.256043, 2.651237
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.299655, 2.346349, 2.456348
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.208102, 2.141111, 3.077613
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.326729, 2.621463, 2.818842
Valid average loss all      (Triplet)                 : 0.270227

== Recognize ==
Valid average loss Recognize     : 0.771147
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.277938

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.357531785964966 sec. =
Valid knn accuracy drums     : 80.8695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.269024848937988 sec. =
Valid knn accuracy bass      : 35.08064516129033%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.257535219192505 sec. =
Valid knn accuracy piano     : 47.4609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.926170825958252 sec. =
Valid knn accuracy guitar    : 59.82142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.89314603805542 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 58.23742438093114%

                                                                      [AEpoch 186: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.00752, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=0.607]Epoch 186: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188697, 0.188997, 0.187883, 0.194098
Train average loss UNet                 (all)                : 0.759674

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000431, 2.223527, 4.590918
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001263, 2.701061, 4.802747
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002316, 2.782870, 4.826758
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001232, 2.782464, 5.031016
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003353, 2.937085, 5.177796
Train average loss all      (Triplet)                 : 0.001610

== Recognize ==
Train average loss Recognize     : 0.609157
Train average accuracy drums     : 83.025002 %
Train average accuracy bass      : 61.414997 %
Train average accuracy piano     : 57.345001 %
Train average accuracy guitar    : 59.084999 %
Train average accuracy residuals : 60.840000 %

== Train average loss all : 0.007702

Epoch 186:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609]          Epoch 187:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609]Epoch 187:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609]Epoch 187:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.657, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609]Epoch 187:  32%|███▏      | 100/313 [02:06<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.657, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609]Epoch 187:  32%|███▏      | 100/313 [02:06<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609]Epoch 187:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609]Epoch 187:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.605, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609] Epoch 187:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.605, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609]Epoch 187:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609]Epoch 187:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609]Epoch 187:  80%|███████▉  | 250/313 [05:01<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609]Epoch 187:  96%|█████████▌| 300/313 [05:59<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609]Epoch 187:  96%|█████████▌| 300/313 [05:59<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609]Epoch 187: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609]Epoch 187: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.278, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.270, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.582, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.55it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.63it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.42it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.15it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184715, 0.188080, 0.190103, 0.199655
Valid average loss UNet                 (all)                : 0.762554

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.094132, 1.683892, 3.000338
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.466546, 2.558622, 2.937837
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.287740, 2.645508, 2.829852
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.230597, 2.356860, 3.379536
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.316951, 2.794158, 3.013941
Valid average loss all      (Triplet)                 : 0.290825

== Recognize ==
Valid average loss Recognize     : 0.743975
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.298265

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.762635707855225 sec. =
Valid knn accuracy drums     : 79.13043478260869%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.64643383026123 sec. =
Valid knn accuracy bass      : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.950275421142578 sec. =
Valid knn accuracy piano     : 48.046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.181300640106201 sec. =
Valid knn accuracy guitar    : 57.58928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.207740068435669 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 58.044228190287974%

                                                                      [AEpoch 187: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0077, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=0.609]Epoch 187: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189483, 0.189791, 0.188666, 0.194381
Train average loss UNet                 (all)                : 0.762322

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000997, 2.167995, 4.468416
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001900, 2.675741, 4.659873
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003206, 2.784203, 4.853624
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000947, 2.745696, 5.021625
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001769, 2.934512, 5.195442
Train average loss all      (Triplet)                 : 0.001790

== Recognize ==
Train average loss Recognize     : 0.616585
Train average accuracy drums     : 83.945000 %
Train average accuracy bass      : 59.890003 %
Train average accuracy piano     : 57.570000 %
Train average accuracy guitar    : 58.320000 %
Train average accuracy residuals : 59.864998 %

== Train average loss all : 0.007956

Epoch 187:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]          Epoch 188:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]Epoch 188:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]Epoch 188:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]Epoch 188:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]Epoch 188:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00608, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.608, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]Epoch 188:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00608, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.608, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]Epoch 188:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]Epoch 188:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]Epoch 188:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00394, Train/loss_recog_step=0.612, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]Epoch 188:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00394, Train/loss_recog_step=0.612, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]Epoch 188:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000287, Train/loss_recog_step=0.610, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]Epoch 188:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000287, Train/loss_recog_step=0.610, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]Epoch 188:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00583, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.583, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]   Epoch 188: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00583, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.583, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]Epoch 188: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.179, Valid/loss_recog_step=0.767, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.45it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185228, 0.188499, 0.190899, 0.209066
Valid average loss UNet                 (all)                : 0.773692

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090827, 1.781012, 3.288037
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.427421, 2.506590, 2.871825
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.389185, 2.592681, 2.644414
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.280500, 2.428066, 3.331581
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.269857, 2.852427, 3.179657
Valid average loss all      (Triplet)                 : 0.296689

== Recognize ==
Valid average loss Recognize     : 0.717588
Valid average accuracy drums     : 57.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.303865

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.49506402015686 sec. =
Valid knn accuracy drums     : 80.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.47463607788086 sec. =
Valid knn accuracy bass      : 33.064516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.69580888748169 sec. =
Valid knn accuracy piano     : 49.8046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.818111419677734 sec. =
Valid knn accuracy guitar    : 53.34821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.392388105392456 sec. =
Valid knn accuracy residuals : 67.27272727272727%

Valid knn accuracy average   : 56.82846382010347%

                                                                      [AEpoch 188: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00796, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=0.617]Epoch 188: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189553, 0.189867, 0.188729, 0.193979
Train average loss UNet                 (all)                : 0.762128

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000522, 2.327169, 4.786150
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001538, 2.829655, 4.974432
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001981, 2.921468, 5.072209
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000556, 2.895617, 5.281042
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000758, 3.043233, 5.409268
Train average loss all      (Triplet)                 : 0.001082

== Recognize ==
Train average loss Recognize     : 0.609746
Train average accuracy drums     : 82.555000 %
Train average accuracy bass      : 58.960003 %
Train average accuracy piano     : 56.484997 %
Train average accuracy guitar    : 59.885002 %
Train average accuracy residuals : 61.435001 %

== Train average loss all : 0.007179

Epoch 188:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]          Epoch 189:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]Epoch 189:  16%|█▌        | 50/313 [01:06<05:48,  0.75it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]Epoch 189:  16%|█▌        | 50/313 [01:06<05:48,  0.75it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00582, Train/loss_recog_step=0.599, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]Epoch 189:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00582, Train/loss_recog_step=0.599, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]Epoch 189:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]  Epoch 189:  48%|████▊     | 150/313 [03:02<03:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]Epoch 189:  48%|████▊     | 150/313 [03:02<03:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00596, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000233, Train/loss_recog_step=0.573, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]Epoch 189:  64%|██████▍   | 200/313 [04:00<02:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00596, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000233, Train/loss_recog_step=0.573, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]Epoch 189:  64%|██████▍   | 200/313 [04:00<02:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]   Epoch 189:  80%|███████▉  | 250/313 [04:56<01:14,  0.84it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]Epoch 189:  80%|███████▉  | 250/313 [04:56<01:14,  0.84it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000809, Train/loss_recog_step=0.571, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]Epoch 189:  96%|█████████▌| 300/313 [05:55<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000809, Train/loss_recog_step=0.571, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]Epoch 189:  96%|█████████▌| 300/313 [05:55<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]   Epoch 189: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]Epoch 189: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.00887, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.658, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.141, Valid/loss_recog_step=0.770, Valid/loss_all_epoch=0.304, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.08it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.31it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.04it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.70it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184185, 0.187521, 0.189410, 0.203978
Valid average loss UNet                 (all)                : 0.765094

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099918, 2.206801, 3.977749
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.530030, 3.035118, 3.592224
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.477975, 3.080086, 3.246671
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.319246, 3.030091, 4.280773
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.424188, 3.234631, 3.507767
Valid average loss all      (Triplet)                 : 0.375704

== Recognize ==
Valid average loss Recognize     : 0.706559
Valid average accuracy drums     : 56.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.382770

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.874672174453735 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.348428726196289 sec. =
Valid knn accuracy bass      : 23.790322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.572091817855835 sec. =
Valid knn accuracy piano     : 48.2421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.802300214767456 sec. =
Valid knn accuracy guitar    : 56.25%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.40117073059082 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 55.925276719686345%

                                                                      [AEpoch 189: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00887, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.658, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.610]Epoch 189: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00887, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.658, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189736, 0.190032, 0.188904, 0.194865
Train average loss UNet                 (all)                : 0.763538

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000474, 2.279508, 4.720204
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002030, 2.742507, 4.867165
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001847, 2.784582, 4.881269
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001930, 2.827855, 5.100270
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000817, 2.904684, 5.174190
Train average loss all      (Triplet)                 : 0.001377

== Recognize ==
Train average loss Recognize     : 0.606104
Train average accuracy drums     : 83.165001 %
Train average accuracy bass      : 60.110004 %
Train average accuracy piano     : 57.724998 %
Train average accuracy guitar    : 60.364998 %
Train average accuracy residuals : 64.320000 %

== Train average loss all : 0.007438

Epoch 189:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00887, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.658, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606]          Epoch 190:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00887, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.658, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606]Epoch 190:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.00887, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.658, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606]Epoch 190:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.00629, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.629, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606]  Epoch 190:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00629, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.629, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606]Epoch 190:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00747, Train/loss_recog_step=0.600, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606]Epoch 190:  48%|████▊     | 150/313 [03:05<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00747, Train/loss_recog_step=0.600, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606]Epoch 190:  48%|████▊     | 150/313 [03:05<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606] Epoch 190:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606]Epoch 190:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606] Epoch 190:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606]Epoch 190:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606]Epoch 190:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606]Epoch 190:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606] Epoch 190: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.630, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606]Epoch 190: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00561, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.561, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.21it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.83it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.72it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.60it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183585, 0.186917, 0.189049, 0.197198
Valid average loss UNet                 (all)                : 0.756749

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.053596, 1.803271, 3.524993
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.398490, 2.594558, 3.035161
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.322949, 2.543349, 2.780172
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.307559, 2.468342, 3.402542
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.282383, 2.712373, 3.179702
Valid average loss all      (Triplet)                 : 0.282730

== Recognize ==
Valid average loss Recognize     : 0.689768
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.289628

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.50985598564148 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.798037767410278 sec. =
Valid knn accuracy bass      : 32.66129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.580820798873901 sec. =
Valid knn accuracy piano     : 46.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.455691814422607 sec. =
Valid knn accuracy guitar    : 55.58035714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.608905792236328 sec. =
Valid knn accuracy residuals : 68.4090909090909%

Valid knn accuracy average   : 57.48775637055792%

                                                                      [AEpoch 190: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00561, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.561, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00744, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=0.606]Epoch 190: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00561, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.561, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189119, 0.189414, 0.188290, 0.194569
Train average loss UNet                 (all)                : 0.761393

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000401, 2.238922, 4.761934
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003271, 2.788783, 4.878412
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002705, 2.831156, 4.902142
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001314, 2.840439, 5.143710
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000964, 2.894626, 5.153188
Train average loss all      (Triplet)                 : 0.001775

== Recognize ==
Train average loss Recognize     : 0.608151
Train average accuracy drums     : 84.525002 %
Train average accuracy bass      : 60.614998 %
Train average accuracy piano     : 54.830002 %
Train average accuracy guitar    : 59.654999 %
Train average accuracy residuals : 64.670006 %

== Train average loss all : 0.007856

Epoch 190:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00561, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.561, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]          Epoch 191:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00561, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.561, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]Epoch 191:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00561, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.561, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]Epoch 191:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]Epoch 191:  32%|███▏      | 100/313 [02:07<04:31,  0.79it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]Epoch 191:  32%|███▏      | 100/313 [02:07<04:31,  0.79it/s, v_num=0, Train/loss_all_step=0.0173, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.610, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]Epoch 191:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0173, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.610, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]Epoch 191:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]Epoch 191:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]Epoch 191:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]Epoch 191:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.626, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]Epoch 191:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000719, Train/loss_recog_step=0.603, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]Epoch 191:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000719, Train/loss_recog_step=0.603, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]Epoch 191:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00854, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=0.603, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608] Epoch 191: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00854, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=0.603, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]Epoch 191: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.159, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.690, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.21it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  2.89it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.21it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.77it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183910, 0.187187, 0.189413, 0.189572
Valid average loss UNet                 (all)                : 0.750082

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077107, 1.795986, 3.420470
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.452845, 2.671033, 3.049860
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.263712, 2.503306, 2.813696
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.326248, 2.495971, 3.305640
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.348365, 2.688890, 3.028575
Valid average loss all      (Triplet)                 : 0.309281

== Recognize ==
Valid average loss Recognize     : 0.785646
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 43.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.317137

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.899429559707642 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.506822347640991 sec. =
Valid knn accuracy bass      : 30.443548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.896365642547607 sec. =
Valid knn accuracy piano     : 43.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.326109409332275 sec. =
Valid knn accuracy guitar    : 55.35714285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.252695083618164 sec. =
Valid knn accuracy residuals : 63.63636363636363%

Valid knn accuracy average   : 55.3330631500337%

                                                                      [AEpoch 191: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00786, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=0.608]Epoch 191: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189162, 0.189461, 0.188337, 0.194872
Train average loss UNet                 (all)                : 0.761831

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000566, 2.283089, 4.795660
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001565, 2.821831, 5.004689
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001012, 2.888316, 5.050093
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002099, 2.885843, 5.210414
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000391, 2.976108, 5.313231
Train average loss all      (Triplet)                 : 0.001126

== Recognize ==
Train average loss Recognize     : 0.602077
Train average accuracy drums     : 86.215004 %
Train average accuracy bass      : 61.809998 %
Train average accuracy piano     : 56.695004 %
Train average accuracy guitar    : 60.880001 %
Train average accuracy residuals : 65.580002 %

== Train average loss all : 0.007147

Epoch 191:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]          Epoch 192:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]Epoch 192:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]Epoch 192:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.00844, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00219, Train/loss_recog_step=0.625, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]Epoch 192:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00844, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00219, Train/loss_recog_step=0.625, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]Epoch 192:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]  Epoch 192:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.678, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]Epoch 192:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.00578, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.578, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]Epoch 192:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00578, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.578, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]Epoch 192:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00825, Train/loss_recog_step=0.610, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]Epoch 192:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00825, Train/loss_recog_step=0.610, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]Epoch 192:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602] Epoch 192:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]Epoch 192:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]Epoch 192: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]Epoch 192: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.575, Valid/loss_all_step=0.197, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.750, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.95it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.71it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.69it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.65it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184718, 0.188085, 0.190208, 0.204393
Valid average loss UNet                 (all)                : 0.767404

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.093013, 1.630360, 3.161551
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.429934, 2.355129, 2.670226
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.273827, 2.352589, 2.543191
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.335285, 2.335099, 3.017796
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.338347, 2.647572, 2.981357
Valid average loss all      (Triplet)                 : 0.309013

== Recognize ==
Valid average loss Recognize     : 0.703044
Valid average accuracy drums     : 61.500000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 57.500000 %

== Valid average loss all : 0.316043

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.019445657730103 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.457080602645874 sec. =
Valid knn accuracy bass      : 29.435483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.89111852645874 sec. =
Valid knn accuracy piano     : 49.0234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.61774730682373 sec. =
Valid knn accuracy guitar    : 57.58928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.34232234954834 sec. =
Valid knn accuracy residuals : 66.13636363636364%

Valid knn accuracy average   : 57.13256631823646%

                                                                      [AEpoch 192: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.575, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00715, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.602]Epoch 192: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.575, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189084, 0.189411, 0.188285, 0.194388
Train average loss UNet                 (all)                : 0.761168

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000356, 2.356466, 4.958318
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002899, 2.869687, 5.025857
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002323, 2.985720, 5.200180
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002159, 2.975343, 5.315965
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000718, 3.023813, 5.365715
Train average loss all      (Triplet)                 : 0.001717

== Recognize ==
Train average loss Recognize     : 0.605713
Train average accuracy drums     : 84.074997 %
Train average accuracy bass      : 59.715004 %
Train average accuracy piano     : 56.950005 %
Train average accuracy guitar    : 59.350002 %
Train average accuracy residuals : 63.930000 %

== Train average loss all : 0.007774

Epoch 192:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.575, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]          Epoch 193:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.575, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]Epoch 193:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.575, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]Epoch 193:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]Epoch 193:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]Epoch 193:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.605, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]Epoch 193:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.605, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]Epoch 193:  48%|████▊     | 150/313 [03:06<03:22,  0.80it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00618, Train/loss_recog_step=0.653, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]Epoch 193:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00618, Train/loss_recog_step=0.653, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]Epoch 193:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606] Epoch 193:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]Epoch 193:  80%|███████▉  | 250/313 [05:00<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.592, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]Epoch 193:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.592, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]Epoch 193:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.008, Train/loss_recog_step=0.639, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606] Epoch 193: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.008, Train/loss_recog_step=0.639, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]Epoch 193: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=0.703, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.42it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.27it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.49it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.71it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.13it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183092, 0.186380, 0.188363, 0.203917
Valid average loss UNet                 (all)                : 0.761752

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.075778, 1.680725, 3.384050
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.503332, 2.469578, 2.726380
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.401004, 2.583770, 2.631536
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.344880, 2.324768, 3.063274
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.333657, 2.505011, 2.981727
Valid average loss all      (Triplet)                 : 0.352053

== Recognize ==
Valid average loss Recognize     : 0.715793
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 58.000000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.359211

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.560951709747314 sec. =
Valid knn accuracy drums     : 83.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.507102012634277 sec. =
Valid knn accuracy bass      : 26.209677419354836%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.15467095375061 sec. =
Valid knn accuracy piano     : 42.3828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.577952861785889 sec. =
Valid knn accuracy guitar    : 54.46428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.550475120544434 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 54.12716540340795%

                                                                      [AEpoch 193: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00777, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=0.606]Epoch 193: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189302, 0.189615, 0.188489, 0.195159
Train average loss UNet                 (all)                : 0.762564

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000454, 2.257751, 4.769361
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001918, 2.841215, 5.005903
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002540, 2.970853, 5.229376
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001433, 2.890101, 5.209943
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001160, 2.994241, 5.309108
Train average loss all      (Triplet)                 : 0.001551

== Recognize ==
Train average loss Recognize     : 0.611704
Train average accuracy drums     : 85.869995 %
Train average accuracy bass      : 58.139999 %
Train average accuracy piano     : 56.120003 %
Train average accuracy guitar    : 58.649998 %
Train average accuracy residuals : 62.435001 %

== Train average loss all : 0.007668

Epoch 193:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]          Epoch 194:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]Epoch 194:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]Epoch 194:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.593, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]Epoch 194:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.593, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]Epoch 194:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]  Epoch 194:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]Epoch 194:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00596, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.596, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]Epoch 194:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00596, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.596, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]Epoch 194:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]Epoch 194:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]Epoch 194:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00583, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.583, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]Epoch 194:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00583, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.583, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]Epoch 194:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]Epoch 194: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]Epoch 194: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.566, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.644, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.716, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.97it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.29it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.94it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.61it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184560, 0.187896, 0.190016, 0.201776
Valid average loss UNet                 (all)                : 0.764249

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099983, 1.891331, 3.765053
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.451024, 2.570989, 2.917904
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.351217, 2.572913, 2.774114
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.337615, 2.525858, 3.378735
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.385543, 2.711035, 3.152525
Valid average loss all      (Triplet)                 : 0.331442

== Recognize ==
Valid average loss Recognize     : 0.697366
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 58.000000 %

== Valid average loss all : 0.338416

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.412951707839966 sec. =
Valid knn accuracy drums     : 84.1304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.576077699661255 sec. =
Valid knn accuracy bass      : 35.88709677419355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.830954790115356 sec. =
Valid knn accuracy piano     : 44.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.32712173461914 sec. =
Valid knn accuracy guitar    : 55.58035714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.363488674163818 sec. =
Valid knn accuracy residuals : 68.63636363636364%

Valid knn accuracy average   : 57.67497546720462%

                                                                      [AEpoch 194: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.566, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00767, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=0.612]Epoch 194: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.566, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189207, 0.189506, 0.188393, 0.194103
Train average loss UNet                 (all)                : 0.761208

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000703, 2.293895, 4.985014
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001013, 2.744703, 4.875108
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001606, 2.882143, 5.066801
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001128, 2.806810, 5.092043
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000864, 2.897001, 5.137024
Train average loss all      (Triplet)                 : 0.001031

== Recognize ==
Train average loss Recognize     : 0.600765
Train average accuracy drums     : 85.865005 %
Train average accuracy bass      : 61.365002 %
Train average accuracy piano     : 57.660000 %
Train average accuracy guitar    : 61.139999 %
Train average accuracy residuals : 64.665001 %

== Train average loss all : 0.007039

Epoch 194:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.566, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]          Epoch 195:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.566, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]Epoch 195:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.566, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]Epoch 195:  16%|█▌        | 50/313 [01:08<06:01,  0.73it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]Epoch 195:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]Epoch 195:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.599, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]Epoch 195:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.599, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]Epoch 195:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]Epoch 195:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]Epoch 195:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]  Epoch 195:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]Epoch 195:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00555, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.555, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]Epoch 195:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00555, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.555, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]Epoch 195:  96%|█████████▌| 300/313 [06:03<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00854, Train/loss_recog_step=0.603, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]Epoch 195: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00854, Train/loss_recog_step=0.603, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]Epoch 195: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00737, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.697, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.35it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.13it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.51it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.42it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.61it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184071, 0.187415, 0.189725, 0.200838
Valid average loss UNet                 (all)                : 0.762049

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067151, 1.952261, 3.764437
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.543038, 2.933422, 3.417364
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.331281, 2.986441, 3.165077
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.392522, 2.890149, 3.789781
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.416268, 3.018243, 3.324481
Valid average loss all      (Triplet)                 : 0.370163

== Recognize ==
Valid average loss Recognize     : 0.712704
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.377290

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.579081058502197 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.41287636756897 sec. =
Valid knn accuracy bass      : 30.64516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.422401666641235 sec. =
Valid knn accuracy piano     : 47.65625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.45891261100769 sec. =
Valid knn accuracy guitar    : 50.44642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.787372350692749 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 55.71399484982058%

                                                                      [AEpoch 195: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00737, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.601]Epoch 195: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00737, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189266, 0.189563, 0.188460, 0.194453
Train average loss UNet                 (all)                : 0.761743

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000687, 2.376106, 5.107296
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001883, 2.834582, 5.021111
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001574, 2.988692, 5.222363
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001155, 2.943416, 5.346075
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000828, 3.016707, 5.299196
Train average loss all      (Triplet)                 : 0.001257

== Recognize ==
Train average loss Recognize     : 0.604102
Train average accuracy drums     : 84.199997 %
Train average accuracy bass      : 59.715004 %
Train average accuracy piano     : 57.680000 %
Train average accuracy guitar    : 59.329998 %
Train average accuracy residuals : 65.264999 %

== Train average loss all : 0.007298

Epoch 195:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00737, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]          Epoch 196:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00737, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]Epoch 196:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00737, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]Epoch 196:  16%|█▌        | 50/313 [01:08<06:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00522, Train/loss_recog_step=0.588, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]Epoch 196:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00522, Train/loss_recog_step=0.588, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]Epoch 196:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604] Epoch 196:  48%|████▊     | 150/313 [03:06<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]Epoch 196:  48%|████▊     | 150/313 [03:06<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000679, Train/loss_recog_step=0.592, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]Epoch 196:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000679, Train/loss_recog_step=0.592, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]Epoch 196:  64%|██████▍   | 200/313 [04:05<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0067, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.670, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]   Epoch 196:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0067, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.670, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]Epoch 196:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.009, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00288, Train/loss_recog_step=0.613, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]Epoch 196:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.009, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00288, Train/loss_recog_step=0.613, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]Epoch 196:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]Epoch 196: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.611, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]Epoch 196: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=0.576, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.713, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.58it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.15it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.92it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.66it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183274, 0.186646, 0.188542, 0.203857
Valid average loss UNet                 (all)                : 0.762319

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.053731, 1.990380, 4.001645
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.475707, 2.815309, 3.231572
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.316414, 2.890836, 3.202941
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.370060, 2.876100, 3.819799
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.331974, 3.131990, 3.635064
Valid average loss all      (Triplet)                 : 0.322119

== Recognize ==
Valid average loss Recognize     : 0.722548
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.329344

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.346216201782227 sec. =
Valid knn accuracy drums     : 85.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.924537420272827 sec. =
Valid knn accuracy bass      : 36.08870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.445822954177856 sec. =
Valid knn accuracy piano     : 48.828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.300285816192627 sec. =
Valid knn accuracy guitar    : 45.535714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.50572919845581 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 56.49960070171763%

                                                                      [AEpoch 196: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=0.604]Epoch 196: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189053, 0.189354, 0.188250, 0.194496
Train average loss UNet                 (all)                : 0.761153

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000645, 2.299399, 4.890596
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002527, 2.817472, 4.975055
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003449, 2.960129, 5.161994
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001638, 2.886961, 5.260574
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001310, 2.912779, 5.139993
Train average loss all      (Triplet)                 : 0.001812

== Recognize ==
Train average loss Recognize     : 0.609907
Train average accuracy drums     : 83.840004 %
Train average accuracy bass      : 58.899998 %
Train average accuracy piano     : 55.949997 %
Train average accuracy guitar    : 58.170002 %
Train average accuracy residuals : 63.655003 %

== Train average loss all : 0.007911

Epoch 196:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]          Epoch 197:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]Epoch 197:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]Epoch 197:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00504, Train/loss_recog_step=0.633, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]Epoch 197:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00504, Train/loss_recog_step=0.633, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]Epoch 197:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.592, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610] Epoch 197:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.592, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]Epoch 197:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00403, Train/loss_recog_step=0.621, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]Epoch 197:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00403, Train/loss_recog_step=0.621, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]Epoch 197:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610] Epoch 197:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.667, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]Epoch 197:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00608, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.608, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]Epoch 197:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00608, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.608, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]Epoch 197:  96%|█████████▌| 300/313 [06:00<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]  Epoch 197: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]Epoch 197: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.566, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.690, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.723, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.58it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.63it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.38it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.39it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.93it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183442, 0.186842, 0.188659, 0.193002
Valid average loss UNet                 (all)                : 0.751945

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.058715, 1.776732, 3.394565
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.418229, 2.492915, 2.850198
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.334126, 2.511890, 2.681453
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.334583, 2.602533, 3.433359
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.424554, 2.731842, 2.991558
Valid average loss all      (Triplet)                 : 0.319061

== Recognize ==
Valid average loss Recognize     : 0.718223
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 56.000000 %

== Valid average loss all : 0.326244

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.696455717086792 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.852498531341553 sec. =
Valid knn accuracy bass      : 33.266129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.540937662124634 sec. =
Valid knn accuracy piano     : 49.21875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.552853107452393 sec. =
Valid knn accuracy guitar    : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.348961114883423 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 56.19386315823027%

                                                                      [AEpoch 197: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.566, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00791, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=0.610]Epoch 197: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.566, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188804, 0.189116, 0.187995, 0.194227
Train average loss UNet                 (all)                : 0.760142

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000132, 2.281527, 4.859260
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001317, 2.842658, 5.062353
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002330, 2.931885, 5.082455
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001262, 2.916022, 5.265557
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001302, 3.000730, 5.340425
Train average loss all      (Triplet)                 : 0.001252

== Recognize ==
Train average loss Recognize     : 0.604714
Train average accuracy drums     : 86.110001 %
Train average accuracy bass      : 60.845001 %
Train average accuracy piano     : 56.680000 %
Train average accuracy guitar    : 58.354996 %
Train average accuracy residuals : 63.730003 %

== Train average loss all : 0.007299

Epoch 197:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.566, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]          Epoch 198:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.566, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]Epoch 198:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.566, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]Epoch 198:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00512, Train/loss_recog_step=0.584, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]Epoch 198:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00512, Train/loss_recog_step=0.584, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]Epoch 198:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.00757, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00173, Train/loss_recog_step=0.584, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]Epoch 198:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.00757, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00173, Train/loss_recog_step=0.584, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]Epoch 198:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]  Epoch 198:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00663, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.663, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]Epoch 198:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]Epoch 198:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.621, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]Epoch 198:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00576, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.576, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]Epoch 198:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00576, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.576, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]Epoch 198:  96%|█████████▌| 300/313 [06:01<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00596, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.596, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]Epoch 198: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00596, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.596, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]Epoch 198: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.718, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.17it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.15it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.15it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.35it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183711, 0.187082, 0.189213, 0.205741
Valid average loss UNet                 (all)                : 0.765748

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.055679, 1.932425, 3.543294
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.471084, 2.754263, 3.114349
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.438643, 2.872524, 2.831598
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.368184, 2.803661, 3.902699
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.429029, 2.869039, 3.372896
Valid average loss all      (Triplet)                 : 0.362024

== Recognize ==
Valid average loss Recognize     : 0.728034
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 44.500000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.369304

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.423847913742065 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.323067426681519 sec. =
Valid knn accuracy bass      : 31.653225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.90790057182312 sec. =
Valid knn accuracy piano     : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.27129578590393 sec. =
Valid knn accuracy guitar    : 55.80357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.466547727584839 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 57.96764403198485%

                                                                      [AEpoch 198: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0073, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.605]Epoch 198: 100%|██████████| 313/313 [07:39<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188730, 0.189024, 0.187920, 0.194185
Train average loss UNet                 (all)                : 0.759858

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000265, 2.284048, 4.821710
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001456, 2.822786, 5.059114
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001274, 2.900895, 5.084251
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001332, 2.923460, 5.315505
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001542, 2.968465, 5.302117
Train average loss all      (Triplet)                 : 0.001159

== Recognize ==
Train average loss Recognize     : 0.600579
Train average accuracy drums     : 85.680000 %
Train average accuracy bass      : 62.099998 %
Train average accuracy piano     : 58.875000 %
Train average accuracy guitar    : 58.775002 %
Train average accuracy residuals : 66.489998 %

== Train average loss all : 0.007165

Epoch 198:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]          Epoch 199:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]Epoch 199:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.665, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]Epoch 199:  16%|█▌        | 50/313 [01:09<06:04,  0.72it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.606, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]Epoch 199:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.606, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]Epoch 199:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.00748, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=0.584, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]Epoch 199:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.00748, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=0.584, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]Epoch 199:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]  Epoch 199:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]Epoch 199:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00879, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00239, Train/loss_recog_step=0.639, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]Epoch 199:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00879, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00239, Train/loss_recog_step=0.639, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]Epoch 199:  80%|███████▉  | 250/313 [04:59<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00556, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.556, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]  Epoch 199:  96%|█████████▌| 300/313 [05:57<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00556, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.556, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]Epoch 199:  96%|█████████▌| 300/313 [05:57<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000675, Train/loss_recog_step=0.603, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]Epoch 199: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000675, Train/loss_recog_step=0.603, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]Epoch 199: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.728, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.30it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.50it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.44it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.97it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.69it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185073, 0.188465, 0.190416, 0.192370
Valid average loss UNet                 (all)                : 0.756325

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.057259, 1.816360, 3.547178
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.428318, 2.441191, 2.758746
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.336812, 2.505062, 2.623519
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.310990, 2.429794, 3.380218
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.286747, 2.603019, 3.221083
Valid average loss all      (Triplet)                 : 0.290404

== Recognize ==
Valid average loss Recognize     : 0.766845
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 62.000000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.298072

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.74311113357544 sec. =
Valid knn accuracy drums     : 83.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.426997184753418 sec. =
Valid knn accuracy bass      : 33.266129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.446526288986206 sec. =
Valid knn accuracy piano     : 44.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.626189470291138 sec. =
Valid knn accuracy guitar    : 49.776785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.419500589370728 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 56.26674747500046%

                                                                      [AEpoch 199: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00717, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=0.601]Epoch 199: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188855, 0.189173, 0.188059, 0.193828
Train average loss UNet                 (all)                : 0.759915

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000732, 2.333808, 4.933428
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002157, 2.838220, 4.976048
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000861, 2.913642, 5.092136
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000913, 2.960679, 5.499743
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000865, 3.056337, 5.517159
Train average loss all      (Triplet)                 : 0.001085

== Recognize ==
Train average loss Recognize     : 0.597580
Train average accuracy drums     : 86.839996 %
Train average accuracy bass      : 62.290001 %
Train average accuracy piano     : 58.235001 %
Train average accuracy guitar    : 62.099998 %
Train average accuracy residuals : 65.625000 %

== Train average loss all : 0.007060

Epoch 199:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]          Epoch 200:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]Epoch 200:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00659, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.659, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]Epoch 200:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]Epoch 200:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]Epoch 200:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00576, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.576, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]Epoch 200:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.00576, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.576, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]Epoch 200:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00407, Train/loss_recog_step=0.707, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]Epoch 200:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00407, Train/loss_recog_step=0.707, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]Epoch 200:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00529, Train/loss_recog_step=0.602, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]Epoch 200:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00529, Train/loss_recog_step=0.602, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]Epoch 200:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00595, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.595, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598] Epoch 200:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00595, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.595, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]Epoch 200:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]Epoch 200: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]Epoch 200: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00571, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.571, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.807, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.48it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.14it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.74it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.26it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.91it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184140, 0.187361, 0.189781, 0.194683
Valid average loss UNet                 (all)                : 0.755966

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.057146, 1.636851, 3.199504
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.348704, 2.232242, 2.572591
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.271676, 2.345559, 2.496385
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.352844, 2.254225, 2.977837
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.326316, 2.473819, 2.760234
Valid average loss all      (Triplet)                 : 0.274896

== Recognize ==
Valid average loss Recognize     : 0.750945
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.282405

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.390063762664795 sec. =
Valid knn accuracy drums     : 86.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.246433973312378 sec. =
Valid knn accuracy bass      : 38.306451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.921477317810059 sec. =
Valid knn accuracy piano     : 43.359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.323730230331421 sec. =
Valid knn accuracy guitar    : 49.776785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.618703365325928 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 57.54741574607019%

                                                                      [AEpoch 200: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00571, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.571, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00706, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=0.598]Epoch 200: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00571, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.571, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189411, 0.189713, 0.188591, 0.194521
Train average loss UNet                 (all)                : 0.762237

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000448, 2.240104, 4.774898
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001537, 2.766674, 4.939786
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001959, 2.830527, 4.977291
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000713, 2.835369, 5.207238
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002325, 2.959441, 5.276140
Train average loss all      (Triplet)                 : 0.001399

== Recognize ==
Train average loss Recognize     : 0.600366
Train average accuracy drums     : 86.645004 %
Train average accuracy bass      : 62.110001 %
Train average accuracy piano     : 57.930000 %
Train average accuracy guitar    : 61.634998 %
Train average accuracy residuals : 65.004997 %

== Train average loss all : 0.007403

Epoch 200:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00571, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.571, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]          Epoch 201:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00571, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.571, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]Epoch 201:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.00571, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.571, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]Epoch 201:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]Epoch 201:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]Epoch 201:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.00571, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.571, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]Epoch 201:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00571, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.571, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]Epoch 201:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.631, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]Epoch 201:  64%|██████▍   | 200/313 [04:08<02:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.631, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]Epoch 201:  64%|██████▍   | 200/313 [04:08<02:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]Epoch 201:  80%|███████▉  | 250/313 [05:06<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.643, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]Epoch 201:  80%|███████▉  | 250/313 [05:06<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00076, Train/loss_recog_step=0.555, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]Epoch 201:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00076, Train/loss_recog_step=0.555, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]Epoch 201:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]  Epoch 201: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]Epoch 201: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.282, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.751, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.29it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.22it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.82it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.32it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183961, 0.187290, 0.189473, 0.197161
Valid average loss UNet                 (all)                : 0.757886

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.027374, 1.876127, 3.839113
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.506148, 2.624858, 2.843334
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.333546, 2.626595, 2.785643
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.355861, 2.748327, 3.580312
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.316101, 2.698498, 3.392242
Valid average loss all      (Triplet)                 : 0.323513

== Recognize ==
Valid average loss Recognize     : 0.760317
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 58.000000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.331116

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.95818305015564 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.554687976837158 sec. =
Valid knn accuracy bass      : 28.62903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.862589836120605 sec. =
Valid knn accuracy piano     : 46.2890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.284977674484253 sec. =
Valid knn accuracy guitar    : 51.33928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.785475254058838 sec. =
Valid knn accuracy residuals : 66.81818181818183%

Valid knn accuracy average   : 55.962938545062926%

                                                                      [AEpoch 201: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0074, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=0.600]Epoch 201: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189579, 0.189869, 0.188723, 0.194013
Train average loss UNet                 (all)                : 0.762185

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000707, 2.244073, 4.794860
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001319, 2.744583, 4.792393
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001096, 2.787234, 4.903513
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001147, 2.816455, 5.139605
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001582, 2.948601, 5.255471
Train average loss all      (Triplet)                 : 0.001146

== Recognize ==
Train average loss Recognize     : 0.599144
Train average accuracy drums     : 85.729996 %
Train average accuracy bass      : 62.139999 %
Train average accuracy piano     : 58.144997 %
Train average accuracy guitar    : 62.765003 %
Train average accuracy residuals : 65.240005 %

== Train average loss all : 0.007137

Epoch 201:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599]          Epoch 202:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599]Epoch 202:  16%|█▌        | 50/313 [01:07<05:55,  0.74it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599]Epoch 202:  16%|█▌        | 50/313 [01:07<05:55,  0.74it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599]Epoch 202:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599]Epoch 202:  32%|███▏      | 100/313 [02:06<04:29,  0.79it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00436, Train/loss_recog_step=0.587, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599]Epoch 202:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00436, Train/loss_recog_step=0.587, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599]Epoch 202:  48%|████▊     | 150/313 [03:03<03:19,  0.82it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.592, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599] Epoch 202:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.592, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599]Epoch 202:  64%|██████▍   | 200/313 [04:01<02:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599]Epoch 202:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599]Epoch 202:  80%|███████▉  | 250/313 [05:01<01:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00942, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=0.567, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599]Epoch 202:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00942, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=0.567, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599]Epoch 202:  96%|█████████▌| 300/313 [05:58<00:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.630, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599] Epoch 202: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.630, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599]Epoch 202: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.31it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.73it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.66it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.64it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184950, 0.188234, 0.190722, 0.200997
Valid average loss UNet                 (all)                : 0.764902

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.047416, 1.675839, 3.356961
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.437462, 2.429510, 2.591014
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.313871, 2.391929, 2.638658
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.341131, 2.456941, 3.324901
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.352244, 2.524149, 3.172368
Valid average loss all      (Triplet)                 : 0.309677

== Recognize ==
Valid average loss Recognize     : 0.710990
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.316787

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.451951742172241 sec. =
Valid knn accuracy drums     : 84.1304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.662055492401123 sec. =
Valid knn accuracy bass      : 35.685483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.498805046081543 sec. =
Valid knn accuracy piano     : 44.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.38332486152649 sec. =
Valid knn accuracy guitar    : 54.46428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.285816669464111 sec. =
Valid knn accuracy residuals : 63.63636363636363%

Valid knn accuracy average   : 56.41143860084515%

                                                                      [AEpoch 202: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00714, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00115, Train/loss_recog_epoch=0.599]Epoch 202: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189129, 0.189417, 0.188293, 0.194463
Train average loss UNet                 (all)                : 0.761302

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000269, 2.257627, 4.890414
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001412, 2.657888, 4.677795
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000837, 2.751794, 4.848186
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001377, 2.831945, 5.175572
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001137, 2.928704, 5.276971
Train average loss all      (Triplet)                 : 0.001033

== Recognize ==
Train average loss Recognize     : 0.596488
Train average accuracy drums     : 88.534996 %
Train average accuracy bass      : 64.334999 %
Train average accuracy piano     : 57.864998 %
Train average accuracy guitar    : 61.879997 %
Train average accuracy residuals : 64.880005 %

== Train average loss all : 0.006998

Epoch 202:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]          Epoch 203:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]Epoch 203:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.628, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]Epoch 203:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.589, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]Epoch 203:  32%|███▏      | 100/313 [02:05<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.589, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]Epoch 203:  32%|███▏      | 100/313 [02:05<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=0.578, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]Epoch 203:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=0.578, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]Epoch 203:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00741, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.741, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596] Epoch 203:  64%|██████▍   | 200/313 [04:04<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00741, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.741, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]Epoch 203:  64%|██████▍   | 200/313 [04:04<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00573, Train/loss_recog_step=0.616, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]Epoch 203:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00573, Train/loss_recog_step=0.616, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]Epoch 203:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596] Epoch 203:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]Epoch 203:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]Epoch 203: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]Epoch 203: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.636, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.310, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.564, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.43it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.99it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.29it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.48it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.30it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.63it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184468, 0.187732, 0.190124, 0.199844
Valid average loss UNet                 (all)                : 0.762168

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.032733, 1.841353, 3.686696
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.560246, 2.827035, 3.094256
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.348688, 2.764415, 3.092367
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.386424, 2.860931, 3.778412
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.373287, 2.829014, 3.514347
Valid average loss all      (Triplet)                 : 0.361664

== Recognize ==
Valid average loss Recognize     : 0.684494
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 57.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.368509

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.55551266670227 sec. =
Valid knn accuracy drums     : 81.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.249490022659302 sec. =
Valid knn accuracy bass      : 27.21774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.636085271835327 sec. =
Valid knn accuracy piano     : 50.78125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.614240407943726 sec. =
Valid knn accuracy guitar    : 47.32142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.421534538269043 sec. =
Valid knn accuracy residuals : 65.68181818181819%

Valid knn accuracy average   : 54.54827382470264%

                                                                      [AEpoch 203: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.007, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=0.596]Epoch 203: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188978, 0.189269, 0.188156, 0.194367
Train average loss UNet                 (all)                : 0.760771

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000194, 2.243079, 4.823836
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001347, 2.766108, 4.899173
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001326, 2.836923, 4.981226
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001457, 2.890716, 5.306777
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000839, 2.996691, 5.373666
Train average loss all      (Triplet)                 : 0.001096

== Recognize ==
Train average loss Recognize     : 0.599132
Train average accuracy drums     : 85.895004 %
Train average accuracy bass      : 63.225002 %
Train average accuracy piano     : 58.275002 %
Train average accuracy guitar    : 61.230000 %
Train average accuracy residuals : 64.784996 %

== Train average loss all : 0.007087

Epoch 203:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]          Epoch 204:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]Epoch 204:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]Epoch 204:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]Epoch 204:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.614, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]Epoch 204:  32%|███▏      | 100/313 [02:08<04:32,  0.78it/s, v_num=0, Train/loss_all_step=0.00961, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=0.593, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]Epoch 204:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.00961, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=0.593, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]Epoch 204:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.0058, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.580, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]   Epoch 204:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.0058, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.580, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]Epoch 204:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.691, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]Epoch 204:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.691, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]Epoch 204:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.00739, Train/loss_recog_step=0.596, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]Epoch 204:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.00739, Train/loss_recog_step=0.596, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]Epoch 204:  96%|█████████▌| 300/313 [06:04<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599] Epoch 204: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]Epoch 204: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00705, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.705, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.622, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.684, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.42it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.88it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.88it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.81it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.55it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.82it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184891, 0.188187, 0.190574, 0.199702
Valid average loss UNet                 (all)                : 0.763354

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.059307, 1.972192, 3.766945
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.497189, 2.797476, 3.155813
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.295559, 2.667359, 3.136764
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.393225, 2.921747, 3.949390
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.304234, 2.925331, 3.740812
Valid average loss all      (Triplet)                 : 0.328655

== Recognize ==
Valid average loss Recognize     : 0.704429
Valid average accuracy drums     : 57.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.335699

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.487457752227783 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.193998336791992 sec. =
Valid knn accuracy bass      : 30.241935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.550549983978271 sec. =
Valid knn accuracy piano     : 43.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.313169956207275 sec. =
Valid knn accuracy guitar    : 49.776785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.609654903411865 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 54.73398139378153%

                                                                      [AEpoch 204: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00705, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.705, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00709, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=0.599]Epoch 204: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00705, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.705, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189232, 0.189531, 0.188414, 0.194799
Train average loss UNet                 (all)                : 0.761976

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000243, 2.253277, 4.851028
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002235, 2.758082, 4.809158
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002403, 2.851340, 5.008748
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002101, 2.921534, 5.280519
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001493, 2.966944, 5.284241
Train average loss all      (Triplet)                 : 0.001637

== Recognize ==
Train average loss Recognize     : 0.598907
Train average accuracy drums     : 87.379997 %
Train average accuracy bass      : 62.884998 %
Train average accuracy piano     : 56.935001 %
Train average accuracy guitar    : 59.555000 %
Train average accuracy residuals : 65.110001 %

== Train average loss all : 0.007626

Epoch 204:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00705, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.705, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]          Epoch 205:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00705, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.705, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]Epoch 205:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.00705, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.705, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]Epoch 205:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.00899, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00297, Train/loss_recog_step=0.602, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]Epoch 205:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00899, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00297, Train/loss_recog_step=0.602, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]Epoch 205:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00525, Train/loss_recog_step=0.583, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599] Epoch 205:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00525, Train/loss_recog_step=0.583, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]Epoch 205:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00765, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00173, Train/loss_recog_step=0.592, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]Epoch 205:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00765, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00173, Train/loss_recog_step=0.592, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]Epoch 205:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]  Epoch 205:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]Epoch 205:  80%|███████▉  | 250/313 [05:04<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.562, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]Epoch 205:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.562, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]Epoch 205:  96%|█████████▌| 300/313 [06:02<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0079, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=0.600, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]Epoch 205: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0079, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=0.600, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]Epoch 205: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.631, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.224, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.11it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.68it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.07it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.66it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.45it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184445, 0.187858, 0.190043, 0.206725
Valid average loss UNet                 (all)                : 0.769071

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.056607, 1.645479, 3.208172
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.354844, 2.162017, 2.499499
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.302395, 2.327115, 2.439734
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.327936, 2.326471, 3.088365
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.305637, 2.373476, 2.675787
Valid average loss all      (Triplet)                 : 0.268085

== Recognize ==
Valid average loss Recognize     : 0.704594
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 57.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.275131

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.556607961654663 sec. =
Valid knn accuracy drums     : 86.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.90521502494812 sec. =
Valid knn accuracy bass      : 30.040322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.326790809631348 sec. =
Valid knn accuracy piano     : 41.2109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.1394362449646 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.284744501113892 sec. =
Valid knn accuracy residuals : 65.22727272727272%

Valid knn accuracy average   : 54.55657612680097%

                                                                      [AEpoch 205: 100%|██████████| 313/313 [08:04<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.631, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=0.599]Epoch 205: 100%|██████████| 313/313 [08:04<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.631, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189472, 0.189760, 0.188644, 0.194141
Train average loss UNet                 (all)                : 0.762016

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000688, 2.297651, 4.802405
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003283, 2.843748, 4.932741
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001345, 2.903065, 5.058027
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001025, 2.977830, 5.410480
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001406, 3.039711, 5.423905
Train average loss all      (Triplet)                 : 0.001603

== Recognize ==
Train average loss Recognize     : 0.601834
Train average accuracy drums     : 86.315002 %
Train average accuracy bass      : 61.704998 %
Train average accuracy piano     : 58.584999 %
Train average accuracy guitar    : 61.360001 %
Train average accuracy residuals : 63.209999 %

== Train average loss all : 0.007621

Epoch 205:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.631, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]          Epoch 206:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.631, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]Epoch 206:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.631, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]Epoch 206:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.599, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]Epoch 206:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.599, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]Epoch 206:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602] Epoch 206:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]Epoch 206:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.0205, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0143, Train/loss_recog_step=0.619, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]Epoch 206:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.0205, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0143, Train/loss_recog_step=0.619, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]Epoch 206:  64%|██████▍   | 200/313 [04:08<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]Epoch 206:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]Epoch 206:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00557, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.557, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]Epoch 206:  96%|█████████▌| 300/313 [06:08<00:15,  0.81it/s, v_num=0, Train/loss_all_step=0.00557, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.557, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]Epoch 206:  96%|█████████▌| 300/313 [06:08<00:15,  0.81it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]Epoch 206: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]Epoch 206: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.606, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.159, Valid/loss_recog_step=0.677, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.705, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.45it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.05it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.51it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.59it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.45it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.87it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184234, 0.187614, 0.189649, 0.199274
Valid average loss UNet                 (all)                : 0.760771

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.030176, 1.718406, 3.370843
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.440032, 2.467314, 2.747109
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.301804, 2.434065, 2.665249
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.305506, 2.485684, 3.341259
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.287269, 2.603481, 2.924355
Valid average loss all      (Triplet)                 : 0.286383

== Recognize ==
Valid average loss Recognize     : 0.710585
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 58.000000 %

== Valid average loss all : 0.293489

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.738375902175903 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.382332801818848 sec. =
Valid knn accuracy bass      : 32.86290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.352956533432007 sec. =
Valid knn accuracy piano     : 45.703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.469574689865112 sec. =
Valid knn accuracy guitar    : 52.90178571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.299705743789673 sec. =
Valid knn accuracy residuals : 69.0909090909091%

Valid knn accuracy average   : 57.02478808446112%

                                                                      [AEpoch 206: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.606, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00762, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0016, Train/loss_recog_epoch=0.602]Epoch 206: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.606, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189250, 0.189557, 0.188427, 0.193572
Train average loss UNet                 (all)                : 0.760806

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000138, 2.263192, 4.808333
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002850, 2.780759, 4.879437
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001665, 2.846848, 5.038307
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001708, 2.930804, 5.330259
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000983, 3.003655, 5.352338
Train average loss all      (Triplet)                 : 0.001418

== Recognize ==
Train average loss Recognize     : 0.599458
Train average accuracy drums     : 88.010002 %
Train average accuracy bass      : 62.174999 %
Train average accuracy piano     : 57.830002 %
Train average accuracy guitar    : 61.524998 %
Train average accuracy residuals : 65.520004 %

== Train average loss all : 0.007412

Epoch 206:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.606, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]          Epoch 207:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.606, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]Epoch 207:  16%|█▌        | 50/313 [01:13<06:25,  0.68it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.606, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]Epoch 207:  16%|█▌        | 50/313 [01:13<06:25,  0.68it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]Epoch 207:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]Epoch 207:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]Epoch 207:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]Epoch 207:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]Epoch 207:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]Epoch 207:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00629, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.629, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]Epoch 207:  80%|███████▉  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00629, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.629, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]Epoch 207:  80%|███████▉  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.585, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]Epoch 207:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.585, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]Epoch 207:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]Epoch 207: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]Epoch 207: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00748, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.748, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.731, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.711, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.58it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.15it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.15it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.24it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183143, 0.186583, 0.188467, 0.199469
Valid average loss UNet                 (all)                : 0.757663

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.053227, 2.000775, 3.790273
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.504124, 3.055813, 3.427402
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.280882, 2.762104, 3.163508
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.314763, 2.945267, 4.009942
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.394460, 2.937490, 3.323792
Valid average loss all      (Triplet)                 : 0.328363

== Recognize ==
Valid average loss Recognize     : 0.719033
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.335553

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.653338193893433 sec. =
Valid knn accuracy drums     : 88.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.09788465499878 sec. =
Valid knn accuracy bass      : 33.66935483870967%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.435462236404419 sec. =
Valid knn accuracy piano     : 43.359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.413747310638428 sec. =
Valid knn accuracy guitar    : 52.00892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.205824851989746 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 56.68500203775888%

                                                                      [AEpoch 207: 100%|██████████| 313/313 [08:03<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00748, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.748, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00741, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=0.599]Epoch 207: 100%|██████████| 313/313 [08:03<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00748, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.748, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189117, 0.189409, 0.188280, 0.194934
Train average loss UNet                 (all)                : 0.761740

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000666, 2.279078, 4.771966
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001758, 2.811417, 4.949804
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001575, 2.838601, 5.036769
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000409, 2.899011, 5.317999
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001096, 2.993336, 5.339564
Train average loss all      (Triplet)                 : 0.001131

== Recognize ==
Train average loss Recognize     : 0.605081
Train average accuracy drums     : 85.009995 %
Train average accuracy bass      : 59.980000 %
Train average accuracy piano     : 57.535000 %
Train average accuracy guitar    : 60.105003 %
Train average accuracy residuals : 64.974998 %

== Train average loss all : 0.007182

Epoch 207:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00748, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.748, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]          Epoch 208:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00748, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.748, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]Epoch 208:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00748, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.748, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]Epoch 208:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.00911, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00302, Train/loss_recog_step=0.609, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]Epoch 208:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00911, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00302, Train/loss_recog_step=0.609, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]Epoch 208:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.586, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]  Epoch 208:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.586, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]Epoch 208:  48%|████▊     | 150/313 [03:04<03:20,  0.81it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]Epoch 208:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00652, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.652, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]Epoch 208:  64%|██████▍   | 200/313 [04:04<02:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.589, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]Epoch 208:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.589, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]Epoch 208:  80%|███████▉  | 250/313 [05:02<01:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.578, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]Epoch 208:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.578, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]Epoch 208:  96%|█████████▌| 300/313 [06:05<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]  Epoch 208: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]Epoch 208: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.670, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.719, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.31it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.15it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.01it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.13it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.82it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184472, 0.187904, 0.190004, 0.199950
Valid average loss UNet                 (all)                : 0.762330

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061081, 2.045244, 3.885042
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.538641, 2.879241, 3.268357
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.263825, 2.835801, 3.064871
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.310945, 2.851351, 3.878448
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.417583, 2.878942, 3.368935
Valid average loss all      (Triplet)                 : 0.342015

== Recognize ==
Valid average loss Recognize     : 0.682470
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.348840

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.684455394744873 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.330780267715454 sec. =
Valid knn accuracy bass      : 34.475806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.933111667633057 sec. =
Valid knn accuracy piano     : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.731289625167847 sec. =
Valid knn accuracy guitar    : 47.767857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.362404584884644 sec. =
Valid knn accuracy residuals : 66.81818181818183%

Valid knn accuracy average   : 53.83410821296517%

                                                                      [AEpoch 208: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00718, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=0.605]Epoch 208: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188657, 0.188956, 0.187850, 0.194119
Train average loss UNet                 (all)                : 0.759581

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000383, 2.363865, 4.985307
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001550, 2.892530, 5.102782
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001503, 2.931715, 5.168164
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001196, 2.987162, 5.448924
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002453, 3.087000, 5.462395
Train average loss all      (Triplet)                 : 0.001358

== Recognize ==
Train average loss Recognize     : 0.605749
Train average accuracy drums     : 85.184998 %
Train average accuracy bass      : 62.169998 %
Train average accuracy piano     : 58.424995 %
Train average accuracy guitar    : 57.690002 %
Train average accuracy residuals : 63.335003 %

== Train average loss all : 0.007415

Epoch 208:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]          Epoch 209:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]Epoch 209:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.672, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]Epoch 209:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.599, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]Epoch 209:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.599, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]Epoch 209:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.591, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]Epoch 209:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.591, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]Epoch 209:  48%|████▊     | 150/313 [03:09<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]Epoch 209:  64%|██████▍   | 200/313 [04:09<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]Epoch 209:  64%|██████▍   | 200/313 [04:09<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.612, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]Epoch 209:  80%|███████▉  | 250/313 [05:11<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.612, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]Epoch 209:  80%|███████▉  | 250/313 [05:11<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00836, Train/loss_recog_step=0.599, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]Epoch 209:  96%|█████████▌| 300/313 [06:13<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00836, Train/loss_recog_step=0.599, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]Epoch 209:  96%|█████████▌| 300/313 [06:13<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606] Epoch 209: 100%|██████████| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]Epoch 209: 100%|██████████| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0055, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.550, Valid/loss_all_step=0.275, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.682, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.17it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.14it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.30it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.55it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183882, 0.187188, 0.189578, 0.199186
Valid average loss UNet                 (all)                : 0.759834

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.072917, 1.665953, 3.266299
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.399902, 2.367075, 2.612968
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.292000, 2.322754, 2.481892
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.277499, 2.309516, 3.011720
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.325105, 2.345237, 2.798393
Valid average loss all      (Triplet)                 : 0.287387

== Recognize ==
Valid average loss Recognize     : 0.675677
Valid average accuracy drums     : 56.500000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.294143

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.06677770614624 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.430588006973267 sec. =
Valid knn accuracy bass      : 31.048387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.591699600219727 sec. =
Valid knn accuracy piano     : 40.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.730198383331299 sec. =
Valid knn accuracy guitar    : 48.660714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.8407621383667 sec. =
Valid knn accuracy residuals : 64.0909090909091%

Valid knn accuracy average   : 53.40674122511431%

                                                                      [AEpoch 209: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.0055, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.550, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.606]Epoch 209: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.0055, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.550, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189336, 0.189624, 0.188498, 0.194240
Train average loss UNet                 (all)                : 0.761698

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000316, 2.325265, 4.800145
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001865, 2.878662, 5.045778
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001978, 2.938243, 5.171670
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001175, 3.038972, 5.524331
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001245, 3.038817, 5.419490
Train average loss all      (Triplet)                 : 0.001322

== Recognize ==
Train average loss Recognize     : 0.603800
Train average accuracy drums     : 88.180000 %
Train average accuracy bass      : 61.820000 %
Train average accuracy piano     : 56.919998 %
Train average accuracy guitar    : 59.399998 %
Train average accuracy residuals : 65.785004 %

== Train average loss all : 0.007360

Epoch 209:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0055, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.550, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]          Epoch 210:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0055, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.550, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]Epoch 210:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.0055, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.550, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]Epoch 210:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00571, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.571, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]Epoch 210:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00571, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.571, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]Epoch 210:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.585, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]Epoch 210:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.585, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]Epoch 210:  48%|████▊     | 150/313 [03:08<03:25,  0.79it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]Epoch 210:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.658, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]Epoch 210:  64%|██████▍   | 200/313 [04:05<02:18,  0.81it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]Epoch 210:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00602, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.602, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]Epoch 210:  80%|███████▉  | 250/313 [05:07<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]Epoch 210:  96%|█████████▌| 300/313 [06:09<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]Epoch 210:  96%|█████████▌| 300/313 [06:09<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]Epoch 210: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.632, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]Epoch 210: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.640, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.287, Valid/loss_recog_epoch=0.676, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.36it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.20it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.83it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.69it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.17it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183833, 0.187263, 0.189119, 0.202097
Valid average loss UNet                 (all)                : 0.762313

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.044229, 1.934654, 3.810144
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.468860, 2.841802, 3.013442
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.231524, 2.701885, 3.097733
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.281439, 2.712279, 3.632152
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.370951, 2.955006, 3.348823
Valid average loss all      (Triplet)                 : 0.300948

== Recognize ==
Valid average loss Recognize     : 0.734307
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.308291

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.408514499664307 sec. =
Valid knn accuracy drums     : 86.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.548758268356323 sec. =
Valid knn accuracy bass      : 34.07258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.412100076675415 sec. =
Valid knn accuracy piano     : 46.2890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.3944571018219 sec. =
Valid knn accuracy guitar    : 50.44642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.638454675674438 sec. =
Valid knn accuracy residuals : 64.54545454545455%

Valid knn accuracy average   : 56.331574817626276%

                                                                      [AEpoch 210: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.604]Epoch 210: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189068, 0.189366, 0.188252, 0.193956
Train average loss UNet                 (all)                : 0.760642

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000341, 2.361939, 4.984832
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001556, 2.931686, 5.104518
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001798, 2.950752, 5.200284
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001234, 3.007127, 5.447103
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001745, 3.090014, 5.532231
Train average loss all      (Triplet)                 : 0.001339

== Recognize ==
Train average loss Recognize     : 0.598798
Train average accuracy drums     : 89.604996 %
Train average accuracy bass      : 61.524998 %
Train average accuracy piano     : 60.065002 %
Train average accuracy guitar    : 61.285000 %
Train average accuracy residuals : 67.199997 %

== Train average loss all : 0.007327

Epoch 210:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]          Epoch 211:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]Epoch 211:  16%|█▌        | 50/313 [01:10<06:12,  0.71it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]Epoch 211:  16%|█▌        | 50/313 [01:10<06:12,  0.71it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00434, Train/loss_recog_step=0.624, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]Epoch 211:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00434, Train/loss_recog_step=0.624, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]Epoch 211:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]   Epoch 211:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]Epoch 211:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.0071, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.710, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]Epoch 211:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.0071, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.710, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]Epoch 211:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]Epoch 211:  80%|███████▉  | 250/313 [05:06<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]Epoch 211:  80%|███████▉  | 250/313 [05:06<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]Epoch 211:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00597, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.597, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]Epoch 211:  96%|█████████▌| 300/313 [06:06<00:15,  0.82it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]Epoch 211: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]Epoch 211: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.234, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.78it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.02it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.78it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.90it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184535, 0.187900, 0.190163, 0.201042
Valid average loss UNet                 (all)                : 0.763641

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060981, 1.990555, 3.637695
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.411881, 2.892380, 3.256087
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.251275, 2.750313, 3.193987
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.299343, 2.729115, 3.783221
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.371578, 3.042279, 3.670067
Valid average loss all      (Triplet)                 : 0.291399

== Recognize ==
Valid average loss Recognize     : 0.688085
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 39.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.298280

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.351058006286621 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.304768562316895 sec. =
Valid knn accuracy bass      : 29.838709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.873394012451172 sec. =
Valid knn accuracy piano     : 42.578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.506657361984253 sec. =
Valid knn accuracy guitar    : 48.660714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.35355520248413 sec. =
Valid knn accuracy residuals : 70.0%

Valid knn accuracy average   : 54.82420544480065%

                                                                      [AEpoch 211: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00733, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.599]Epoch 211: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189612, 0.189934, 0.188800, 0.194442
Train average loss UNet                 (all)                : 0.762788

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000239, 2.336797, 4.852185
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002161, 2.944400, 5.150931
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001115, 2.955789, 5.189793
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001197, 3.016782, 5.447512
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001869, 3.126950, 5.632675
Train average loss all      (Triplet)                 : 0.001363

== Recognize ==
Train average loss Recognize     : 0.599570
Train average accuracy drums     : 88.305000 %
Train average accuracy bass      : 60.965000 %
Train average accuracy piano     : 58.735001 %
Train average accuracy guitar    : 60.549999 %
Train average accuracy residuals : 64.750000 %

== Train average loss all : 0.007358

Epoch 211:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]          Epoch 212:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]Epoch 212:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]Epoch 212:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]Epoch 212:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]Epoch 212:  32%|███▏      | 100/313 [02:07<04:31,  0.78it/s, v_num=0, Train/loss_all_step=0.00576, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.576, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]Epoch 212:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.00576, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.576, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]Epoch 212:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.0057, Train/loss_recog_step=0.594, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]Epoch 212:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.0057, Train/loss_recog_step=0.594, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]Epoch 212:  64%|██████▍   | 200/313 [04:03<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.687, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]Epoch 212:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.687, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]Epoch 212:  80%|███████▉  | 250/313 [05:03<01:16,  0.82it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]Epoch 212:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]Epoch 212:  96%|█████████▌| 300/313 [06:03<00:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00944, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00317, Train/loss_recog_step=0.627, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]Epoch 212: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00944, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00317, Train/loss_recog_step=0.627, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]Epoch 212: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.656, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.688, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.48it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.67it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.53it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.69it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.70it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183774, 0.187183, 0.189172, 0.196087
Valid average loss UNet                 (all)                : 0.756216

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073553, 1.903561, 3.516262
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.394854, 2.745612, 3.187311
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.233115, 2.573207, 3.055032
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.298608, 2.649711, 3.651582
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.345157, 2.765175, 3.261491
Valid average loss all      (Triplet)                 : 0.281432

== Recognize ==
Valid average loss Recognize     : 0.681326
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.288245

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.329950332641602 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.29014801979065 sec. =
Valid knn accuracy bass      : 36.08870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.792884111404419 sec. =
Valid knn accuracy piano     : 41.796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.360344409942627 sec. =
Valid knn accuracy guitar    : 53.125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.24784255027771 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 56.2199034967487%

                                                                      [AEpoch 212: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00136, Train/loss_recog_epoch=0.600]Epoch 212: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189186, 0.189485, 0.188362, 0.195003
Train average loss UNet                 (all)                : 0.762037

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000285, 2.368237, 4.904556
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002346, 3.086279, 5.413094
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001224, 3.045566, 5.335937
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001934, 3.131838, 5.640996
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000624, 3.175648, 5.770070
Train average loss all      (Triplet)                 : 0.001323

== Recognize ==
Train average loss Recognize     : 0.613434
Train average accuracy drums     : 86.545006 %
Train average accuracy bass      : 57.335003 %
Train average accuracy piano     : 56.314999 %
Train average accuracy guitar    : 58.770000 %
Train average accuracy residuals : 62.089996 %

== Train average loss all : 0.007457

Epoch 212:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]          Epoch 213:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]Epoch 213:  16%|█▌        | 50/313 [01:16<06:42,  0.65it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]Epoch 213:  16%|█▌        | 50/313 [01:16<06:42,  0.65it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]Epoch 213:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]Epoch 213:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]Epoch 213:  48%|████▊     | 150/313 [03:21<03:39,  0.74it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.613, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]Epoch 213:  48%|████▊     | 150/313 [03:21<03:39,  0.74it/s, v_num=0, Train/loss_all_step=0.00734, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.734, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]Epoch 213:  64%|██████▍   | 200/313 [04:25<02:30,  0.75it/s, v_num=0, Train/loss_all_step=0.00734, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.734, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]Epoch 213:  64%|██████▍   | 200/313 [04:25<02:30,  0.75it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]Epoch 213:  80%|███████▉  | 250/313 [05:28<01:22,  0.76it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]Epoch 213:  80%|███████▉  | 250/313 [05:28<01:22,  0.76it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00149, Train/loss_recog_step=0.554, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]Epoch 213:  96%|█████████▌| 300/313 [06:29<00:16,  0.77it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00149, Train/loss_recog_step=0.554, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]Epoch 213:  96%|█████████▌| 300/313 [06:29<00:16,  0.77it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]  Epoch 213: 100%|██████████| 313/313 [06:41<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.612, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]Epoch 213: 100%|██████████| 313/313 [06:41<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=0.676, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.681, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.40it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.69it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.80it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.93it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.37it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184686, 0.188080, 0.189962, 0.200604
Valid average loss UNet                 (all)                : 0.763333

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.036289, 1.857920, 3.548267
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.374205, 2.719673, 3.101320
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.316357, 2.673191, 2.858444
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.317932, 2.614878, 3.310984
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.358159, 2.783912, 3.435489
Valid average loss all      (Triplet)                 : 0.290622

== Recognize ==
Valid average loss Recognize     : 0.729080
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.297913

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.520324468612671 sec. =
Valid knn accuracy drums     : 83.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.345747709274292 sec. =
Valid knn accuracy bass      : 35.28225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.530405759811401 sec. =
Valid knn accuracy piano     : 38.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.580867767333984 sec. =
Valid knn accuracy guitar    : 54.91071428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.293395280838013 sec. =
Valid knn accuracy residuals : 69.31818181818183%

Valid knn accuracy average   : 56.37573626846506%

                                                                      [AEpoch 213: 100%|██████████| 313/313 [08:07<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00746, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=0.613]Epoch 213: 100%|██████████| 313/313 [08:07<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188976, 0.189260, 0.188159, 0.194254
Train average loss UNet                 (all)                : 0.760650

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000493, 2.335769, 4.903430
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002065, 2.971777, 5.184467
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001085, 2.992295, 5.237649
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001136, 3.038101, 5.489374
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001468, 3.111524, 5.601950
Train average loss all      (Triplet)                 : 0.001350

== Recognize ==
Train average loss Recognize     : 0.595938
Train average accuracy drums     : 88.720001 %
Train average accuracy bass      : 63.055004 %
Train average accuracy piano     : 59.355003 %
Train average accuracy guitar    : 61.009998 %
Train average accuracy residuals : 66.790001 %

== Train average loss all : 0.007309

Epoch 213:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]          Epoch 214:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]Epoch 214:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]Epoch 214:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]Epoch 214:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]Epoch 214:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]  Epoch 214:  48%|████▊     | 150/313 [03:14<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]Epoch 214:  48%|████▊     | 150/313 [03:14<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.00746, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.746, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]Epoch 214:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.00746, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.746, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]Epoch 214:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=0.629, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]Epoch 214:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=0.629, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]Epoch 214:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.00726, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00119, Train/loss_recog_step=0.607, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]Epoch 214:  96%|█████████▌| 300/313 [06:19<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00726, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00119, Train/loss_recog_step=0.607, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]Epoch 214:  96%|█████████▌| 300/313 [06:19<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.593, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]  Epoch 214: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.593, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]Epoch 214: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.200, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.298, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.13it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.83it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.67it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.64it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.70it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184346, 0.187663, 0.189929, 0.198448
Valid average loss UNet                 (all)                : 0.760386

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.053822, 1.815762, 3.609224
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.406122, 2.783251, 3.115867
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.289805, 2.640880, 2.834761
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.340568, 2.750727, 3.669990
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.369096, 2.597020, 3.292965
Valid average loss all      (Triplet)                 : 0.291783

== Recognize ==
Valid average loss Recognize     : 0.734052
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.299124

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.372319221496582 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.367361307144165 sec. =
Valid knn accuracy bass      : 30.040322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.503112077713013 sec. =
Valid knn accuracy piano     : 45.703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.702655553817749 sec. =
Valid knn accuracy guitar    : 50.66964285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.325931310653687 sec. =
Valid knn accuracy residuals : 70.0%

Valid knn accuracy average   : 55.28261808755761%

                                                                      [AEpoch 214: 100%|██████████| 313/313 [08:06<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00731, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=0.596]Epoch 214: 100%|██████████| 313/313 [08:06<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189119, 0.189435, 0.188308, 0.194597
Train average loss UNet                 (all)                : 0.761459

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000297, 2.465712, 5.205561
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001833, 3.029058, 5.292550
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001556, 3.035359, 5.299444
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001621, 3.172638, 5.767764
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001168, 3.253211, 5.894836
Train average loss all      (Triplet)                 : 0.001343

== Recognize ==
Train average loss Recognize     : 0.607244
Train average accuracy drums     : 85.709999 %
Train average accuracy bass      : 60.600002 %
Train average accuracy piano     : 58.399998 %
Train average accuracy guitar    : 59.009998 %
Train average accuracy residuals : 63.910000 %

== Train average loss all : 0.007415

Epoch 214:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]          Epoch 215:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]Epoch 215:  16%|█▌        | 50/313 [01:14<06:29,  0.67it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]Epoch 215:  16%|█▌        | 50/313 [01:14<06:29,  0.67it/s, v_num=0, Train/loss_all_step=0.0087, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00258, Train/loss_recog_step=0.612, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]Epoch 215:  32%|███▏      | 100/313 [02:15<04:47,  0.74it/s, v_num=0, Train/loss_all_step=0.0087, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00258, Train/loss_recog_step=0.612, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]Epoch 215:  32%|███▏      | 100/313 [02:15<04:47,  0.74it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607] Epoch 215:  48%|████▊     | 150/313 [03:16<03:33,  0.76it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]Epoch 215:  48%|████▊     | 150/313 [03:16<03:33,  0.76it/s, v_num=0, Train/loss_all_step=0.00755, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.755, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]Epoch 215:  64%|██████▍   | 200/313 [04:19<02:26,  0.77it/s, v_num=0, Train/loss_all_step=0.00755, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.755, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]Epoch 215:  64%|██████▍   | 200/313 [04:19<02:26,  0.77it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]Epoch 215:  80%|███████▉  | 250/313 [05:23<01:21,  0.77it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]Epoch 215:  80%|███████▉  | 250/313 [05:23<01:21,  0.77it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]Epoch 215:  96%|█████████▌| 300/313 [06:28<00:16,  0.77it/s, v_num=0, Train/loss_all_step=0.00588, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.588, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]Epoch 215:  96%|█████████▌| 300/313 [06:28<00:16,  0.77it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]Epoch 215: 100%|██████████| 313/313 [06:41<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.622, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]Epoch 215: 100%|██████████| 313/313 [06:41<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.15it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.80it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.67it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.60it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185336, 0.188712, 0.190847, 0.199718
Valid average loss UNet                 (all)                : 0.764614

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070577, 1.727651, 3.452625
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.330813, 2.457987, 2.838500
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.267992, 2.411484, 2.681366
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.309905, 2.455799, 3.238798
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.363935, 2.587592, 3.319075
Valid average loss all      (Triplet)                 : 0.266960

== Recognize ==
Valid average loss Recognize     : 0.694183
Valid average accuracy drums     : 56.000000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.273902

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.324872493743896 sec. =
Valid knn accuracy drums     : 85.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.578070878982544 sec. =
Valid knn accuracy bass      : 25.403225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.43146538734436 sec. =
Valid knn accuracy piano     : 42.7734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.435737609863281 sec. =
Valid knn accuracy guitar    : 59.15178571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.383591890335083 sec. =
Valid knn accuracy residuals : 69.0909090909091%

Valid knn accuracy average   : 56.457784665807544%

                                                                      [AEpoch 215: 100%|██████████| 313/313 [08:07<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00742, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=0.607]Epoch 215: 100%|██████████| 313/313 [08:08<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188999, 0.189287, 0.188188, 0.194013
Train average loss UNet                 (all)                : 0.760487

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000468, 2.464964, 5.191872
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000608, 3.029143, 5.367613
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003043, 3.101350, 5.408549
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001523, 3.186666, 5.757041
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002228, 3.245067, 5.826139
Train average loss all      (Triplet)                 : 0.001494

== Recognize ==
Train average loss Recognize     : 0.613914
Train average accuracy drums     : 81.674995 %
Train average accuracy bass      : 61.215000 %
Train average accuracy piano     : 55.685001 %
Train average accuracy guitar    : 58.074997 %
Train average accuracy residuals : 62.945004 %

== Train average loss all : 0.007633

Epoch 215:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]          Epoch 216:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]Epoch 216:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]Epoch 216:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]Epoch 216:  32%|███▏      | 100/313 [02:13<04:45,  0.75it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]Epoch 216:  32%|███▏      | 100/313 [02:13<04:45,  0.75it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.606, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]Epoch 216:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.606, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]Epoch 216:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]Epoch 216:  64%|██████▍   | 200/313 [04:16<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]Epoch 216:  64%|██████▍   | 200/313 [04:16<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]Epoch 216:  80%|███████▉  | 250/313 [05:18<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.627, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]Epoch 216:  80%|███████▉  | 250/313 [05:18<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]Epoch 216:  96%|█████████▌| 300/313 [06:21<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00584, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.584, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]Epoch 216:  96%|█████████▌| 300/313 [06:21<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.0058, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.580, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614] Epoch 216: 100%|██████████| 313/313 [06:34<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.0058, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.580, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]Epoch 216: 100%|██████████| 313/313 [06:34<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.0876, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.0805, Valid/loss_recog_step=0.711, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.45it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.23it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.80it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.44it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184088, 0.187462, 0.189271, 0.203752
Valid average loss UNet                 (all)                : 0.764571

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.075047, 1.837945, 3.749846
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.381280, 2.654802, 3.072503
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.326052, 2.541156, 2.858045
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.306166, 2.632630, 3.478777
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.337207, 2.592115, 3.309786
Valid average loss all      (Triplet)                 : 0.288442

== Recognize ==
Valid average loss Recognize     : 0.678964
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.295232

= T-SNE...
T-SNE was finished!
= T-SNE time is 16.033207893371582 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.242163896560669 sec. =
Valid knn accuracy bass      : 31.85483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.360479593276978 sec. =
Valid knn accuracy piano     : 40.4296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.208562850952148 sec. =
Valid knn accuracy guitar    : 50.89285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.474548578262329 sec. =
Valid knn accuracy residuals : 70.68181818181817%

Valid knn accuracy average   : 55.55444900252272%

                                                                      [AEpoch 216: 100%|██████████| 313/313 [08:27<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00763, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=0.614]  Epoch 216: 100%|██████████| 313/313 [08:27<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189308, 0.189600, 0.188464, 0.194421
Train average loss UNet                 (all)                : 0.761793

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000449, 2.478377, 5.304252
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001234, 2.950552, 5.191817
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002135, 3.042371, 5.306899
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000770, 3.080309, 5.565115
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001420, 3.185209, 5.679100
Train average loss all      (Triplet)                 : 0.001238

== Recognize ==
Train average loss Recognize     : 0.603385
Train average accuracy drums     : 86.290001 %
Train average accuracy bass      : 62.024998 %
Train average accuracy piano     : 56.164997 %
Train average accuracy guitar    : 59.210003 %
Train average accuracy residuals : 64.880005 %

== Train average loss all : 0.007272

Epoch 216:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]          Epoch 217:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]Epoch 217:  16%|█▌        | 50/313 [01:11<06:15,  0.70it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.660, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]Epoch 217:  16%|█▌        | 50/313 [01:11<06:15,  0.70it/s, v_num=0, Train/loss_all_step=0.00647, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000472, Train/loss_recog_step=0.600, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]Epoch 217:  32%|███▏      | 100/313 [02:13<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.00647, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000472, Train/loss_recog_step=0.600, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]Epoch 217:  32%|███▏      | 100/313 [02:13<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.00915, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.0029, Train/loss_recog_step=0.625, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]  Epoch 217:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.00915, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.0029, Train/loss_recog_step=0.625, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]Epoch 217:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.00578, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.578, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603] Epoch 217:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.00578, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.578, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]Epoch 217:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.00785, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=0.631, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]Epoch 217:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00785, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=0.631, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]Epoch 217:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00558, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.558, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]  Epoch 217:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00558, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.558, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]Epoch 217:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]Epoch 217: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]Epoch 217: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.603, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.679, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.03it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.78it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.07it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184289, 0.187685, 0.189704, 0.196836
Valid average loss UNet                 (all)                : 0.758514

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.052721, 1.858088, 3.758100
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.460502, 2.678020, 2.927524
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.270528, 2.464313, 2.797586
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.308820, 2.533933, 3.540923
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.324453, 2.715672, 3.282475
Valid average loss all      (Triplet)                 : 0.303817

== Recognize ==
Valid average loss Recognize     : 0.759828
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.311416

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.543202877044678 sec. =
Valid knn accuracy drums     : 80.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.635475397109985 sec. =
Valid knn accuracy bass      : 32.25806451612903%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.582458972930908 sec. =
Valid knn accuracy piano     : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.502136707305908 sec. =
Valid knn accuracy guitar    : 48.660714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.198765993118286 sec. =
Valid knn accuracy residuals : 71.13636363636363%

Valid knn accuracy average   : 55.60396327025009%

                                                                      [AEpoch 217: 100%|██████████| 313/313 [08:03<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00727, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=0.603]Epoch 217: 100%|██████████| 313/313 [08:03<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188858, 0.189151, 0.188065, 0.194381
Train average loss UNet                 (all)                : 0.760454

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001058, 2.397839, 5.114469
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001654, 2.867948, 5.107034
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000826, 2.910040, 5.124266
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002412, 3.019227, 5.438431
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000840, 3.067857, 5.477165
Train average loss all      (Triplet)                 : 0.001253

== Recognize ==
Train average loss Recognize     : 0.598462
Train average accuracy drums     : 86.395004 %
Train average accuracy bass      : 63.220001 %
Train average accuracy piano     : 59.630001 %
Train average accuracy guitar    : 60.184998 %
Train average accuracy residuals : 65.750000 %

== Train average loss all : 0.007238

Epoch 217:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]          Epoch 218:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]Epoch 218:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]Epoch 218:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]Epoch 218:  32%|███▏      | 100/313 [02:15<04:47,  0.74it/s, v_num=0, Train/loss_all_step=0.00579, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.579, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]Epoch 218:  32%|███▏      | 100/313 [02:15<04:47,  0.74it/s, v_num=0, Train/loss_all_step=0.00927, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00364, Train/loss_recog_step=0.563, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]Epoch 218:  48%|████▊     | 150/313 [03:16<03:33,  0.77it/s, v_num=0, Train/loss_all_step=0.00927, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00364, Train/loss_recog_step=0.563, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]Epoch 218:  48%|████▊     | 150/313 [03:16<03:33,  0.77it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]  Epoch 218:  64%|██████▍   | 200/313 [04:18<02:26,  0.77it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.601, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]Epoch 218:  64%|██████▍   | 200/313 [04:18<02:26,  0.77it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.589, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]Epoch 218:  80%|███████▉  | 250/313 [05:20<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.00589, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.589, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]Epoch 218:  80%|███████▉  | 250/313 [05:20<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.00938, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=0.570, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]Epoch 218:  96%|█████████▌| 300/313 [06:23<00:16,  0.78it/s, v_num=0, Train/loss_all_step=0.00938, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=0.570, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]Epoch 218:  96%|█████████▌| 300/313 [06:23<00:16,  0.78it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]  Epoch 218: 100%|██████████| 313/313 [06:36<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.00605, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.605, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]Epoch 218: 100%|██████████| 313/313 [06:36<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.253, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.311, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.304, Valid/loss_recog_epoch=0.760, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.35it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.78it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.81it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.77it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184042, 0.187416, 0.189308, 0.193108
Valid average loss UNet                 (all)                : 0.753873

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087777, 1.646771, 3.158443
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.342470, 2.365882, 2.583723
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.282105, 2.347751, 2.554905
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.251426, 2.179260, 3.004084
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.282004, 2.379605, 2.930133
Valid average loss all      (Triplet)                 : 0.253529

== Recognize ==
Valid average loss Recognize     : 0.758370
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.261113

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.334712266921997 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.553553581237793 sec. =
Valid knn accuracy bass      : 27.82258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.672915697097778 sec. =
Valid knn accuracy piano     : 41.9921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.34260106086731 sec. =
Valid knn accuracy guitar    : 50.89285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.26708984375 sec. =
Valid knn accuracy residuals : 71.36363636363636%

Valid knn accuracy average   : 55.45773059120054%

                                                                      [AEpoch 218: 100%|██████████| 313/313 [08:09<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00724, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=0.598]Epoch 218: 100%|██████████| 313/313 [08:09<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188489, 0.188792, 0.187690, 0.194454
Train average loss UNet                 (all)                : 0.759425

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000128, 2.296945, 4.959266
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001141, 2.779168, 4.900630
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000978, 2.811030, 4.937422
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001350, 2.925637, 5.295697
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001636, 2.952180, 5.311131
Train average loss all      (Triplet)                 : 0.001074

== Recognize ==
Train average loss Recognize     : 0.593839
Train average accuracy drums     : 89.090004 %
Train average accuracy bass      : 64.850006 %
Train average accuracy piano     : 60.500000 %
Train average accuracy guitar    : 60.290001 %
Train average accuracy residuals : 68.544998 %

== Train average loss all : 0.007012

Epoch 218:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]          Epoch 219:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]Epoch 219:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]Epoch 219:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00695, Train/loss_recog_step=0.609, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]Epoch 219:  32%|███▏      | 100/313 [02:15<04:48,  0.74it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00695, Train/loss_recog_step=0.609, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]Epoch 219:  32%|███▏      | 100/313 [02:15<04:48,  0.74it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]Epoch 219:  48%|████▊     | 150/313 [03:18<03:36,  0.75it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.609, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]Epoch 219:  48%|████▊     | 150/313 [03:18<03:36,  0.75it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.643, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594] Epoch 219:  64%|██████▍   | 200/313 [04:20<02:27,  0.77it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.643, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]Epoch 219:  64%|██████▍   | 200/313 [04:20<02:27,  0.77it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]Epoch 219:  80%|███████▉  | 250/313 [05:22<01:21,  0.78it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.646, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]Epoch 219:  80%|███████▉  | 250/313 [05:22<01:21,  0.78it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]Epoch 219:  96%|█████████▌| 300/313 [06:25<00:16,  0.78it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.604, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]Epoch 219:  96%|█████████▌| 300/313 [06:25<00:16,  0.78it/s, v_num=0, Train/loss_all_step=0.00595, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.595, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]Epoch 219: 100%|██████████| 313/313 [06:37<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.00595, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.595, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]Epoch 219: 100%|██████████| 313/313 [06:37<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.00737, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.254, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.25it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.98it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.79it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.62it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.45it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184861, 0.188315, 0.189979, 0.199143
Valid average loss UNet                 (all)                : 0.762299

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.084981, 2.092214, 4.015025
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.364760, 2.848697, 3.223892
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.217057, 2.738164, 3.204643
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.280282, 2.917348, 3.950026
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.369997, 2.978391, 3.631258
Valid average loss all      (Triplet)                 : 0.264083

== Recognize ==
Valid average loss Recognize     : 0.744499
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.271528

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.498323202133179 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.442611932754517 sec. =
Valid knn accuracy bass      : 32.25806451612903%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.877615213394165 sec. =
Valid knn accuracy piano     : 47.65625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.454402923583984 sec. =
Valid knn accuracy guitar    : 49.330357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.37372899055481 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 55.6928078495838%

                                                                      [AEpoch 219: 100%|██████████| 313/313 [08:10<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00737, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00701, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=0.594]Epoch 219: 100%|██████████| 313/313 [08:10<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00737, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188878, 0.189214, 0.188104, 0.194698
Train average loss UNet                 (all)                : 0.760894

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000704, 2.483803, 5.225468
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001423, 2.992122, 5.293665
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000530, 3.031988, 5.375803
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000602, 3.143843, 5.695069
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000773, 3.171938, 5.681322
Train average loss all      (Triplet)                 : 0.000876

== Recognize ==
Train average loss Recognize     : 0.601380
Train average accuracy drums     : 86.635002 %
Train average accuracy bass      : 61.559998 %
Train average accuracy piano     : 58.569996 %
Train average accuracy guitar    : 59.815002 %
Train average accuracy residuals : 65.270004 %

== Train average loss all : 0.006890

Epoch 219:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00737, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]          Epoch 220:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00737, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]Epoch 220:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.00737, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]Epoch 220:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00485, Train/loss_recog_step=0.626, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]Epoch 220:  32%|███▏      | 100/313 [02:10<04:38,  0.77it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00485, Train/loss_recog_step=0.626, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]Epoch 220:  32%|███▏      | 100/313 [02:10<04:38,  0.77it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601] Epoch 220:  48%|████▊     | 150/313 [03:11<03:27,  0.78it/s, v_num=0, Train/loss_all_step=0.00577, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.577, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]Epoch 220:  48%|████▊     | 150/313 [03:11<03:27,  0.78it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]Epoch 220:  64%|██████▍   | 200/313 [04:10<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.675, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]Epoch 220:  64%|██████▍   | 200/313 [04:10<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]Epoch 220:  80%|███████▉  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.594, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]Epoch 220:  80%|███████▉  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.00573, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.573, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]Epoch 220:  96%|█████████▌| 300/313 [06:17<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00573, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.573, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]Epoch 220:  96%|█████████▌| 300/313 [06:17<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]Epoch 220: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.617, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]Epoch 220: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0056, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.560, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.272, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.264, Valid/loss_recog_epoch=0.744, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.11it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.85it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.07it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.59it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.70it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183951, 0.187298, 0.189348, 0.203387
Valid average loss UNet                 (all)                : 0.763985

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.079480, 1.927163, 3.967396
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.448720, 2.639027, 2.917032
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.212170, 2.526943, 2.967026
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.304388, 2.700333, 3.635926
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.328077, 2.717377, 3.352164
Valid average loss all      (Triplet)                 : 0.285791

== Recognize ==
Valid average loss Recognize     : 0.704443
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.292836

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.710592031478882 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.972234725952148 sec. =
Valid knn accuracy bass      : 21.572580645161292%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.885769367218018 sec. =
Valid knn accuracy piano     : 41.2109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.539427757263184 sec. =
Valid knn accuracy guitar    : 39.955357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.344276428222656 sec. =
Valid knn accuracy residuals : 65.0%

Valid knn accuracy average   : 50.46081853586456%

                                                                      [AEpoch 220: 100%|██████████| 313/313 [08:07<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.0056, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.560, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00689, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000876, Train/loss_recog_epoch=0.601]Epoch 220: 100%|██████████| 313/313 [08:07<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.0056, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.560, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188845, 0.189161, 0.188073, 0.194687
Train average loss UNet                 (all)                : 0.760766

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000323, 2.403719, 5.128372
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001507, 2.935044, 5.100441
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001244, 2.987300, 5.277668
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001555, 3.073882, 5.545137
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000716, 3.071197, 5.543045
Train average loss all      (Triplet)                 : 0.001145

== Recognize ==
Train average loss Recognize     : 0.596288
Train average accuracy drums     : 88.985001 %
Train average accuracy bass      : 62.285000 %
Train average accuracy piano     : 60.399998 %
Train average accuracy guitar    : 61.290001 %
Train average accuracy residuals : 68.915001 %

== Train average loss all : 0.007108

Epoch 220:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0056, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.560, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596]          Epoch 221:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0056, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.560, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596]Epoch 221:  16%|█▌        | 50/313 [01:14<06:30,  0.67it/s, v_num=0, Train/loss_all_step=0.0056, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.560, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596]Epoch 221:  16%|█▌        | 50/313 [01:14<06:30,  0.67it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00576, Train/loss_recog_step=0.596, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596]Epoch 221:  32%|███▏      | 100/313 [02:14<04:47,  0.74it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00576, Train/loss_recog_step=0.596, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596]Epoch 221:  32%|███▏      | 100/313 [02:14<04:47,  0.74it/s, v_num=0, Train/loss_all_step=0.00724, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00157, Train/loss_recog_step=0.567, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596]Epoch 221:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.00724, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00157, Train/loss_recog_step=0.567, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596]Epoch 221:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00759, Train/loss_recog_step=0.672, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596] Epoch 221:  64%|██████▍   | 200/313 [04:17<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00759, Train/loss_recog_step=0.672, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596]Epoch 221:  64%|██████▍   | 200/313 [04:17<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.638, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596] Epoch 221:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.638, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596]Epoch 221:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596]Epoch 221:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.569, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596]Epoch 221:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.0077, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.644, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596]Epoch 221: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0077, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.644, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596]Epoch 221: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.293, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.505, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.37it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.14it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.30it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185068, 0.188503, 0.190276, 0.206131
Valid average loss UNet                 (all)                : 0.769978

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077714, 2.000445, 3.854543
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.438884, 3.098474, 3.533988
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.355039, 2.916458, 3.109896
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.276078, 2.983570, 4.089860
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.336185, 2.974595, 3.667000
Valid average loss all      (Triplet)                 : 0.299599

== Recognize ==
Valid average loss Recognize     : 0.733783
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 57.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.306937

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.368858575820923 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.515197038650513 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.702928066253662 sec. =
Valid knn accuracy piano     : 42.7734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.553824663162231 sec. =
Valid knn accuracy guitar    : 38.169642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.262113809585571 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 52.22310542499227%

                                                                      [AEpoch 221: 100%|██████████| 313/313 [08:07<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00711, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00114, Train/loss_recog_epoch=0.596]Epoch 221: 100%|██████████| 313/313 [08:07<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188914, 0.189220, 0.188126, 0.194806
Train average loss UNet                 (all)                : 0.761066

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000341, 2.440739, 5.298872
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001322, 2.938277, 5.125595
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003381, 3.048163, 5.298388
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001732, 3.114615, 5.599952
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001485, 3.103384, 5.628629
Train average loss all      (Triplet)                 : 0.001665

== Recognize ==
Train average loss Recognize     : 0.601912
Train average accuracy drums     : 85.930000 %
Train average accuracy bass      : 61.849998 %
Train average accuracy piano     : 58.754997 %
Train average accuracy guitar    : 60.290001 %
Train average accuracy residuals : 65.790001 %

== Train average loss all : 0.007684

Epoch 221:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]          Epoch 222:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]Epoch 222:  16%|█▌        | 50/313 [01:12<06:22,  0.69it/s, v_num=0, Train/loss_all_step=0.00645, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.645, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]Epoch 222:  16%|█▌        | 50/313 [01:12<06:22,  0.69it/s, v_num=0, Train/loss_all_step=0.0189, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.585, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602] Epoch 222:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.0189, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.585, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]Epoch 222:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.00699, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.556, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]Epoch 222:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.00699, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.556, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]Epoch 222:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.593, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]  Epoch 222:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.593, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]Epoch 222:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]Epoch 222:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00619, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.619, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]Epoch 222:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00807, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.00249, Train/loss_recog_step=0.558, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]Epoch 222:  96%|█████████▌| 300/313 [06:17<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00807, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.00249, Train/loss_recog_step=0.558, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]Epoch 222:  96%|█████████▌| 300/313 [06:17<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]  Epoch 222: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.624, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]Epoch 222: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00902, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.581, Valid/loss_all_step=0.117, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.736, Valid/loss_all_epoch=0.307, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.734, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.45it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.03it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.46it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183250, 0.186707, 0.188376, 0.205233
Valid average loss UNet                 (all)                : 0.763565

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091417, 1.853670, 3.733393
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.397718, 2.473337, 2.946026
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.257054, 2.483871, 2.759324
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.257419, 2.687764, 3.588467
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.385479, 2.823295, 3.277248
Valid average loss all      (Triplet)                 : 0.281608

== Recognize ==
Valid average loss Recognize     : 0.683332
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.288441

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.38473629951477 sec. =
Valid knn accuracy drums     : 86.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.389342069625854 sec. =
Valid knn accuracy bass      : 32.25806451612903%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.811199426651001 sec. =
Valid knn accuracy piano     : 42.3828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.268287420272827 sec. =
Valid knn accuracy guitar    : 45.535714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.27373194694519 sec. =
Valid knn accuracy residuals : 66.13636363636364%

Valid knn accuracy average   : 54.52346055285877%

                                                                      [AEpoch 222: 100%|██████████| 313/313 [08:00<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00902, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.581, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00768, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=0.602]Epoch 222: 100%|██████████| 313/313 [08:00<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.00902, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.581, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188824, 0.189126, 0.188019, 0.193611
Train average loss UNet                 (all)                : 0.759580

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000406, 2.400491, 5.080167
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002669, 2.970698, 5.151927
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002592, 3.085953, 5.385929
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002256, 3.147116, 5.677580
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001700, 3.141224, 5.701673
Train average loss all      (Triplet)                 : 0.001898

== Recognize ==
Train average loss Recognize     : 0.603131
Train average accuracy drums     : 87.300003 %
Train average accuracy bass      : 59.815002 %
Train average accuracy piano     : 58.044998 %
Train average accuracy guitar    : 59.810001 %
Train average accuracy residuals : 65.004997 %

== Train average loss all : 0.007929

Epoch 222:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00902, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.581, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]          Epoch 223:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00902, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.581, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]Epoch 223:  16%|█▌        | 50/313 [01:13<06:28,  0.68it/s, v_num=0, Train/loss_all_step=0.00902, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.581, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]Epoch 223:  16%|█▌        | 50/313 [01:13<06:28,  0.68it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]  Epoch 223:  32%|███▏      | 100/313 [02:14<04:45,  0.75it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.598, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]Epoch 223:  32%|███▏      | 100/313 [02:14<04:45,  0.75it/s, v_num=0, Train/loss_all_step=0.00572, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.572, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]Epoch 223:  48%|████▊     | 150/313 [03:13<03:30,  0.78it/s, v_num=0, Train/loss_all_step=0.00572, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.572, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]Epoch 223:  48%|████▊     | 150/313 [03:13<03:30,  0.78it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0006, Train/loss_recog_step=0.578, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]Epoch 223:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0006, Train/loss_recog_step=0.578, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]Epoch 223:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.00787, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.002, Train/loss_recog_step=0.587, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603] Epoch 223:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00787, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.002, Train/loss_recog_step=0.587, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]Epoch 223:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]  Epoch 223:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.600, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]Epoch 223:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]Epoch 223: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00603, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.603, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]Epoch 223: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.158, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.605, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.07it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.55it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.17it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184201, 0.187643, 0.189459, 0.195902
Valid average loss UNet                 (all)                : 0.757206

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.112640, 1.864596, 3.706595
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.347622, 2.489579, 2.998427
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.311614, 2.658144, 2.861871
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.256515, 2.612631, 3.346859
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.305827, 2.642963, 3.219759
Valid average loss all      (Triplet)                 : 0.275463

== Recognize ==
Valid average loss Recognize     : 0.743129
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.282895

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.498696327209473 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.339018106460571 sec. =
Valid knn accuracy bass      : 24.193548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.921234607696533 sec. =
Valid knn accuracy piano     : 39.453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.498012065887451 sec. =
Valid knn accuracy guitar    : 45.982142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.2835853099823 sec. =
Valid knn accuracy residuals : 72.5%

Valid knn accuracy average   : 53.29532846623923%

                                                                      [AEpoch 223: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00793, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=0.603]Epoch 223: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189139, 0.189455, 0.188350, 0.194075
Train average loss UNet                 (all)                : 0.761019

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000068, 2.468115, 5.364901
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001164, 2.999920, 5.262435
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001462, 3.104479, 5.457877
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001043, 3.110277, 5.673404
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000911, 3.133507, 5.688062
Train average loss all      (Triplet)                 : 0.000917

== Recognize ==
Train average loss Recognize     : 0.593671
Train average accuracy drums     : 88.180000 %
Train average accuracy bass      : 62.035000 %
Train average accuracy piano     : 58.485001 %
Train average accuracy guitar    : 62.860001 %
Train average accuracy residuals : 67.154999 %

== Train average loss all : 0.006853

Epoch 223:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]          Epoch 224:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]Epoch 224:  16%|█▌        | 50/313 [01:11<06:17,  0.70it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.648, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]Epoch 224:  16%|█▌        | 50/313 [01:11<06:17,  0.70it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.566, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]Epoch 224:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.00566, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.566, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]Epoch 224:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.00565, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.565, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]Epoch 224:  48%|████▊     | 150/313 [03:11<03:27,  0.78it/s, v_num=0, Train/loss_all_step=0.00565, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.565, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]Epoch 224:  48%|████▊     | 150/313 [03:11<03:27,  0.78it/s, v_num=0, Train/loss_all_step=0.00684, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.684, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]Epoch 224:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.00684, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.684, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]Epoch 224:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=0.627, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]Epoch 224:  80%|███████▉  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=0.627, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]Epoch 224:  80%|███████▉  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00535, Train/loss_recog_step=0.559, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]Epoch 224:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00535, Train/loss_recog_step=0.559, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]Epoch 224:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.00582, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.582, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594] Epoch 224: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00582, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.582, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]Epoch 224: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00561, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.561, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.176, Valid/loss_recog_step=0.762, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=0.743, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.11it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.69it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.72it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.56it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184650, 0.188101, 0.190002, 0.201700
Valid average loss UNet                 (all)                : 0.764452

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.103031, 1.783224, 3.610155
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.434009, 2.359433, 2.713197
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.207698, 2.289011, 2.619236
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.284373, 2.375768, 3.110564
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.300223, 2.414892, 2.886064
Valid average loss all      (Triplet)                 : 0.287786

== Recognize ==
Valid average loss Recognize     : 0.693494
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.294721

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.757722616195679 sec. =
Valid knn accuracy drums     : 83.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.524197101593018 sec. =
Valid knn accuracy bass      : 28.024193548387093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.785762310028076 sec. =
Valid knn accuracy piano     : 38.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.554843664169312 sec. =
Valid knn accuracy guitar    : 51.11607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.568706274032593 sec. =
Valid knn accuracy residuals : 70.0%

Valid knn accuracy average   : 54.30155843017431%

                                                                      [AEpoch 224: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00561, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.561, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00685, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.000917, Train/loss_recog_epoch=0.594]Epoch 224: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.00561, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.561, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189191, 0.189496, 0.188385, 0.194590
Train average loss UNet                 (all)                : 0.761662

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000306, 2.521444, 5.536522
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000882, 2.973083, 5.260524
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000899, 3.102027, 5.476648
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000409, 3.096884, 5.684859
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000633, 3.124074, 5.643118
Train average loss all      (Triplet)                 : 0.000636

== Recognize ==
Train average loss Recognize     : 0.590863
Train average accuracy drums     : 88.074997 %
Train average accuracy bass      : 64.224998 %
Train average accuracy piano     : 59.864998 %
Train average accuracy guitar    : 62.405003 %
Train average accuracy residuals : 69.650002 %

== Train average loss all : 0.006544

Epoch 224:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00561, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.561, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]          Epoch 225:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00561, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.561, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]Epoch 225:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.00561, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.561, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]Epoch 225:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000562, Train/loss_recog_step=0.587, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]Epoch 225:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.00643, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000562, Train/loss_recog_step=0.587, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]Epoch 225:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]    Epoch 225:  48%|████▊     | 150/313 [03:10<03:27,  0.79it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.590, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]Epoch 225:  48%|████▊     | 150/313 [03:10<03:27,  0.79it/s, v_num=0, Train/loss_all_step=0.0217, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.592, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]Epoch 225:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.0217, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.592, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]Epoch 225:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]Epoch 225:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.642, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]Epoch 225:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.00557, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.557, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]Epoch 225:  96%|█████████▌| 300/313 [06:17<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00557, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.557, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]Epoch 225:  96%|█████████▌| 300/313 [06:17<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]Epoch 225: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.607, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]Epoch 225: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.586, Valid/loss_all_step=0.262, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.256, Valid/loss_recog_step=0.619, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.07it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.82it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.66it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185434, 0.188777, 0.191142, 0.194525
Valid average loss UNet                 (all)                : 0.759878

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.137115, 1.903555, 3.627520
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.375887, 2.620203, 3.017877
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.249030, 2.464683, 2.932137
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.303336, 2.560036, 3.434872
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.304164, 2.757739, 3.186969
Valid average loss all      (Triplet)                 : 0.281339

== Recognize ==
Valid average loss Recognize     : 0.756635
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.288905

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.911162376403809 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.9030282497406 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.446088790893555 sec. =
Valid knn accuracy piano     : 38.28125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.43710708618164 sec. =
Valid knn accuracy guitar    : 45.982142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.381136417388916 sec. =
Valid knn accuracy residuals : 72.95454545454545%

Valid knn accuracy average   : 54.17570547439937%

                                                                      [AEpoch 225: 100%|██████████| 313/313 [08:08<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.586, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00654, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.000636, Train/loss_recog_epoch=0.591]Epoch 225: 100%|██████████| 313/313 [08:08<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.586, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00662, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00069, Train/loss_recog_epoch=0.593] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189177, 0.189493, 0.188379, 0.194179
Train average loss UNet                 (all)                : 0.761228

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000262, 2.545134, 5.543863
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001119, 3.030852, 5.284672
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000560, 3.122533, 5.547691
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000188, 3.129956, 5.781542
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001133, 3.183985, 5.719686
Train average loss all      (Triplet)                 : 0.000690

== Recognize ==
Train average loss Recognize     : 0.593405
Train average accuracy drums     : 87.805000 %
Train average accuracy bass      : 62.115002 %
Train average accuracy piano     : 60.025002 %
Train average accuracy guitar    : 62.314999 %
Train average accuracy residuals : 65.110001 %

== Train average loss all : 0.006624

Epoch 225: 100%|██████████| 313/313 [08:09<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.586, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.289, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00662, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00069, Train/loss_recog_epoch=0.593]
[2023-11-14 14:24:56,869][source.train][INFO] - [rank: 0] Starting testing!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0: 100%|██████████| 16/16 [00:24<00:00,  0.64it/s]Testing DataLoader 0:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 1: 100%|██████████| 15/15 [00:09<00:00,  1.55it/s]Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 2:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 2: 100%|██████████| 15/15 [00:04<00:00,  3.18it/s]Testing DataLoader 2:   0%|          | 0/13 [00:00<?, ?it/s]         Testing DataLoader 3:   0%|          | 0/13 [00:00<?, ?it/s]Testing DataLoader 3: 100%|██████████| 13/13 [00:03<00:00,  3.60it/s]Testing DataLoader 3:   0%|          | 0/14 [00:00<?, ?it/s]         Testing DataLoader 4:   0%|          | 0/14 [00:00<?, ?it/s]Testing DataLoader 4: 100%|██████████| 14/14 [00:04<00:00,  3.49it/s]Testing DataLoader 4:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 5:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 5: 100%|██████████| 15/15 [00:05<00:00,  3.00it/s]
Test average accuracy drums     :  49.200001 %
Test average accuracy bass      :  52.899998 %
Test average accuracy piano     :  50.800003 %
Test average accuracy guitar    :  54.500000 %
Test average accuracy residuals :  53.600002 %
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.57511258125305 sec. =
Test knn accuracy drums     : 91.92139737991266%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.937952995300293 sec. =
Test knn accuracy bass      : 33.111849390919154%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.29835796356201 sec. =
Test knn accuracy piano     : 30.29197080291971%
= T-SNE...
T-SNE was finished!
= T-SNE time is 21.18094539642334 sec. =
Test knn accuracy guitar    : 28.39366515837104%
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.36771512031555 sec. =
Test knn accuracy residuals : 60.92572658772875%

Test knn accuracy average   : 48.92892186397025%
Testing DataLoader 5: 100%|██████████| 15/15 [02:00<00:00,  0.12it/s]
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 0    ┃   DataLoader 1    ┃   DataLoader 2   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.48928922414779… │ 0.48928922414779… │ 0.4892892241477… │
│   Test/knn_bass   │ 0.33111849427223… │ 0.33111849427223… │ 0.3311184942722… │
│  Test/knn_drums   │ 0.91921395063400… │ 0.91921395063400… │ 0.9192139506340… │
│  Test/knn_guitar  │ 0.28393664956092… │ 0.28393664956092… │ 0.2839366495609… │
│  Test/knn_piano   │ 0.30291971564292… │ 0.30291971564292… │ 0.3029197156429… │
│ Test/knn_residua… │ 0.60925728082656… │ 0.60925728082656… │ 0.6092572808265… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 3    ┃   DataLoader 4    ┃   DataLoader 5   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.48928922414779… │ 0.48928922414779… │ 0.4892892241477… │
│   Test/knn_bass   │ 0.33111849427223… │ 0.33111849427223… │ 0.3311184942722… │
│  Test/knn_drums   │ 0.91921395063400… │ 0.91921395063400… │ 0.9192139506340… │
│  Test/knn_guitar  │ 0.28393664956092… │ 0.28393664956092… │ 0.2839366495609… │
│  Test/knn_piano   │ 0.30291971564292… │ 0.30291971564292… │ 0.3029197156429… │
│ Test/knn_residua… │ 0.60925728082656… │ 0.60925728082656… │ 0.6092572808265… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
[2023-11-14 14:28:20,249][source.train][INFO] - [rank: 0] Best ckpt path: /nas02/homes/imamura23-1000067/outputs/triplet_with_unet/runs/2023-11-13/08-55-06/checkpoints/epoch_125.ckpt
[2023-11-14 14:28:20,251][utils.utils][INFO] - [rank: 0] Output dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023-11-13/08-55-06
[2023-11-14 14:28:20,253][utils.utils][INFO] - [rank: 0] Metric name is None! Skipping metric value retrieval...

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Time taken to study : 29:33:13

All prosess was Done!
