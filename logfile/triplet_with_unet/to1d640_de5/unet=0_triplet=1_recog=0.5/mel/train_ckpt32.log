
=== Using cuda(utils.func). ===

[2023-11-07 11:35:21,642][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-07 11:35:21,650][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 5.0e-05                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0.5                                                       
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640                         
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: true                                                             
│         n_mels: 259                                                           
│       ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-11
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 5.0e-05                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0.5                                                       
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/knn_avr                                                
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: 5                                                         
│         mode: max                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/knn_avr                                                
│         min_delta: 0.0                                                        
│         patience: 50                                                          
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 400                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 400                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       load_using_librosa: false                                               
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_psd_train: 3                                                    
│       seconds_psd_valid: 10                                                   
│       seconds_psd_test: 10                                                    
│       offset_psd_train: 1.5                                                   
│       offset_psd_valid: 5.0                                                   
│       offset_psd_test: 10.0                                                   
│       seconds_triplet_train: 3                                                
│       seconds_triplet_valid: 3                                                
│       offset_triplet_train: 1.5                                               
│       offset_triplet_valid: 1.5                                               
│       seconds_c32_train: 3                                                    
│       seconds_c32_valid: 10                                                   
│       seconds_c32_test: 10                                                    
│       offset_c32_train: 1.5                                                   
│       offset_c32_valid: 5.0                                                   
│       offset_c32_test: 10.0                                                   
│       sr: 44100                                                               
│       mel: true                                                               
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640                             
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       lr: 5.0e-05                                                             
│       monitor_es: Valid/knn_avr                                               
│       monitor_mode_es: max                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 0                                                            
│       recog_rate: 0.5                                                         
│       test_psd_mine: false                                                    
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-07 11:35:21,738][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-07 11:35:21,761][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-07 11:35:25,419][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmps20pyqzn
[2023-11-07 11:35:25,419][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmps20pyqzn/_remote_module_non_scriptable.py
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=3200, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-07 11:35:28,452][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-07 11:35:28,452][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-07 11:35:28,459][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-07 11:35:28,461][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-07 11:35:28,461][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-07 11:35:28,461][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-07 11:35:28,518][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-07 11:35:28,842][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-07 11:35:29,101][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.6466665267944336 sec. *
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:08<00:00,  0.25it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 1: 100%|██████████| 2/2 [00:00<00:00,  2.94it/s]Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 2: 100%|██████████| 2/2 [00:01<00:00,  1.43it/s]Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 3: 100%|██████████| 2/2 [00:00<00:00,  3.07it/s]Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 4: 100%|██████████| 2/2 [00:00<00:00,  3.55it/s]Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 5:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 5: 100%|██████████| 2/2 [00:00<00:00,  2.05it/s]

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205168, 0.203525, 0.199812, 0.223086
Valid average loss UNet                 (all)                : 0.831591

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.145224, 0.148164, 0.204438
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.202464, 0.123606, 0.121142
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.179554, 0.267933, 0.298727
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.132605, 0.247405, 0.331506
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.121394, 0.396797, 0.496432
Valid average loss all      (Triplet)                 : 0.154880

== Recognize ==
Valid average loss Recognize     : 0.778709
Valid average accuracy drums     : 52.343750 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 50.781250 %
Valid average accuracy guitar    : 51.562500 %
Valid average accuracy residuals : 51.562500 %

== Valid average loss all : 0.544235

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.9435811042785645 sec. =
Valid knn accuracy drums     : 90.625%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.407649517059326 sec. =
Valid knn accuracy bass      : 53.90625%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.5502066612243652 sec. =
Valid knn accuracy piano     : 83.59375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.298387289047241 sec. =
Valid knn accuracy guitar    : 64.84375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.534193515777588 sec. =
Valid knn accuracy residuals : 100.0%

Valid knn accuracy average   : 78.59375%
                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [01:17<06:48,  0.64it/s]Epoch 0:  16%|█▌        | 50/313 [01:17<06:48,  0.64it/s, v_num=0, Train/loss_all_step=0.418, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.564]Epoch 0:  32%|███▏      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.418, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.564]Epoch 0:  32%|███▏      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=0.528]Epoch 0:  48%|████▊     | 150/313 [03:23<03:41,  0.74it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=0.528]Epoch 0:  48%|████▊     | 150/313 [03:23<03:41,  0.74it/s, v_num=0, Train/loss_all_step=0.346, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.484]Epoch 0:  64%|██████▍   | 200/313 [04:24<02:29,  0.76it/s, v_num=0, Train/loss_all_step=0.346, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.484]Epoch 0:  64%|██████▍   | 200/313 [04:24<02:29,  0.76it/s, v_num=0, Train/loss_all_step=0.342, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.468]Epoch 0:  80%|███████▉  | 250/313 [05:23<01:21,  0.77it/s, v_num=0, Train/loss_all_step=0.342, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.468]Epoch 0:  80%|███████▉  | 250/313 [05:23<01:21,  0.77it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.450]Epoch 0:  96%|█████████▌| 300/313 [06:23<00:16,  0.78it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.450]Epoch 0:  96%|█████████▌| 300/313 [06:23<00:16,  0.78it/s, v_num=0, Train/loss_all_step=0.372, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.437]Epoch 0: 100%|██████████| 313/313 [06:38<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.372, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.437]Epoch 0: 100%|██████████| 313/313 [06:38<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.488]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.26it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.99it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.98it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.60it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.61it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196397, 0.198754, 0.195811, 0.226713
Valid average loss UNet                 (all)                : 0.817676

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.037730, 0.589485, 1.095334
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.175267, 0.606829, 0.715992
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.142721, 0.762615, 0.891536
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.070183, 0.799896, 1.239180
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.087863, 0.987294, 1.288855
Valid average loss all      (Triplet)                 : 0.098745

== Recognize ==
Valid average loss Recognize     : 0.466721
Valid average accuracy drums     : 92.000000 %
Valid average accuracy bass      : 95.000000 %
Valid average accuracy piano     : 93.000000 %
Valid average accuracy guitar    : 91.000000 %
Valid average accuracy residuals : 97.000000 %

== Valid average loss all : 0.332105

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.762208461761475 sec. =
Valid knn accuracy drums     : 88.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.653390169143677 sec. =
Valid knn accuracy bass      : 50.60483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.561270475387573 sec. =
Valid knn accuracy piano     : 66.6015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.529428482055664 sec. =
Valid knn accuracy guitar    : 71.42857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.608092308044434 sec. =
Valid knn accuracy residuals : 91.5909090909091%

Valid knn accuracy average   : 73.6538719980055%

                                                                      [AEpoch 0: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.488, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737]Epoch 0: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.488, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198992, 0.199461, 0.199444, 0.218848
Train average loss UNet                 (all)                : 0.816744

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.054557, 0.483221, 0.903316
Train average loss bass     (Triplet, dist_p, dist_n) : 0.165034, 0.516599, 0.614058
Train average loss piano    (Triplet, dist_p, dist_n) : 0.160036, 0.713559, 0.841810
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.134874, 0.705896, 0.913113
Train average loss residuals(Triplet, dist_p, dist_n) : 0.115383, 0.950782, 1.261743
Train average loss all      (Triplet)                 : 0.126884

== Recognize ==
Train average loss Recognize     : 0.496738
Train average accuracy drums     : 87.044998 %
Train average accuracy bass      : 79.889999 %
Train average accuracy piano     : 83.104996 %
Train average accuracy guitar    : 83.919998 %
Train average accuracy residuals : 91.790001 %

== Train average loss all : 0.375252

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.488, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.488, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]Epoch 1:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.488, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]Epoch 1:  16%|█▌        | 50/313 [01:07<05:56,  0.74it/s, v_num=0, Train/loss_all_step=0.304, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0833, Train/loss_recog_step=0.442, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]Epoch 1:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.304, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0833, Train/loss_recog_step=0.442, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]Epoch 1:  32%|███▏      | 100/313 [02:07<04:30,  0.79it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0787, Train/loss_recog_step=0.436, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]Epoch 1:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0787, Train/loss_recog_step=0.436, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]Epoch 1:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.294, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.0762, Train/loss_recog_step=0.435, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]Epoch 1:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.294, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.0762, Train/loss_recog_step=0.435, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]Epoch 1:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.0746, Train/loss_recog_step=0.453, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]Epoch 1:  80%|███████▉  | 250/313 [05:14<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.0746, Train/loss_recog_step=0.453, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]Epoch 1:  80%|███████▉  | 250/313 [05:14<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.296, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.380, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497] Epoch 1:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.296, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.380, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]Epoch 1:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.443, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]Epoch 1: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.443, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]Epoch 1: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.305, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0717, Train/loss_recog_step=0.467, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.0491, Valid/loss_recog_step=0.473, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.0987, Valid/loss_recog_epoch=0.467, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.27it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.59it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  2.89it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.47it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.27it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196463, 0.198780, 0.195927, 0.224319
Valid average loss UNet                 (all)                : 0.815490

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.038958, 0.676649, 1.360366
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.175730, 0.711626, 0.840965
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.149783, 0.884796, 1.032255
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.073962, 0.895983, 1.396096
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.092032, 1.111780, 1.444462
Valid average loss all      (Triplet)                 : 0.101013

== Recognize ==
Valid average loss Recognize     : 0.468538
Valid average accuracy drums     : 97.000000 %
Valid average accuracy bass      : 91.500000 %
Valid average accuracy piano     : 91.500000 %
Valid average accuracy guitar    : 92.000000 %
Valid average accuracy residuals : 95.000000 %

== Valid average loss all : 0.335282

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.777339220046997 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.520926475524902 sec. =
Valid knn accuracy bass      : 47.58064516129033%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.640316486358643 sec. =
Valid knn accuracy piano     : 68.9453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.389652967453003 sec. =
Valid knn accuracy guitar    : 74.55357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5921242237091064 sec. =
Valid knn accuracy residuals : 90.45454545454545%

Valid knn accuracy average   : 73.65464099583797%

                                                                      [AEpoch 1: 100%|██████████| 313/313 [07:58<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.305, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0717, Train/loss_recog_step=0.467, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=0.497] Epoch 1: 100%|██████████| 313/313 [07:58<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.305, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0717, Train/loss_recog_step=0.467, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.199074, 0.199554, 0.199528, 0.218468
Train average loss UNet                 (all)                : 0.816624

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.034140, 0.627843, 1.297592
Train average loss bass     (Triplet, dist_p, dist_n) : 0.123098, 0.654218, 0.854201
Train average loss piano    (Triplet, dist_p, dist_n) : 0.107147, 0.823411, 1.060769
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.087151, 0.829511, 1.164331
Train average loss residuals(Triplet, dist_p, dist_n) : 0.076775, 1.098370, 1.539326
Train average loss all      (Triplet)                 : 0.086637

== Recognize ==
Train average loss Recognize     : 0.437887
Train average accuracy drums     : 98.035004 %
Train average accuracy bass      : 91.849998 %
Train average accuracy piano     : 87.690002 %
Train average accuracy guitar    : 88.845001 %
Train average accuracy residuals : 95.485001 %

== Train average loss all : 0.305580

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.305, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0717, Train/loss_recog_step=0.467, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.305, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0717, Train/loss_recog_step=0.467, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]Epoch 2:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.305, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0717, Train/loss_recog_step=0.467, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]Epoch 2:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.271, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0462, Train/loss_recog_step=0.449, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]Epoch 2:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.271, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0462, Train/loss_recog_step=0.449, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]Epoch 2:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.277, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0574, Train/loss_recog_step=0.439, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]Epoch 2:  48%|████▊     | 150/313 [03:17<03:34,  0.76it/s, v_num=0, Train/loss_all_step=0.277, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0574, Train/loss_recog_step=0.439, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]Epoch 2:  48%|████▊     | 150/313 [03:17<03:34,  0.76it/s, v_num=0, Train/loss_all_step=0.264, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.0435, Train/loss_recog_step=0.442, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]Epoch 2:  64%|██████▍   | 200/313 [04:22<02:28,  0.76it/s, v_num=0, Train/loss_all_step=0.264, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.0435, Train/loss_recog_step=0.442, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]Epoch 2:  64%|██████▍   | 200/313 [04:22<02:28,  0.76it/s, v_num=0, Train/loss_all_step=0.256, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.0432, Train/loss_recog_step=0.426, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]Epoch 2:  80%|███████▉  | 250/313 [05:24<01:21,  0.77it/s, v_num=0, Train/loss_all_step=0.256, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.0432, Train/loss_recog_step=0.426, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]Epoch 2:  80%|███████▉  | 250/313 [05:24<01:21,  0.77it/s, v_num=0, Train/loss_all_step=0.272, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.075, Train/loss_recog_step=0.395, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438] Epoch 2:  96%|█████████▌| 300/313 [06:27<00:16,  0.78it/s, v_num=0, Train/loss_all_step=0.272, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.075, Train/loss_recog_step=0.395, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]Epoch 2:  96%|█████████▌| 300/313 [06:27<00:16,  0.77it/s, v_num=0, Train/loss_all_step=0.270, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.0683, Train/loss_recog_step=0.403, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]Epoch 2: 100%|██████████| 313/313 [06:39<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.270, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.0683, Train/loss_recog_step=0.403, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]Epoch 2: 100%|██████████| 313/313 [06:39<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0222, Train/loss_recog_step=0.448, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.0552, Valid/loss_recog_step=0.476, Valid/loss_all_epoch=0.335, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.101, Valid/loss_recog_epoch=0.469, Valid/knn_avr=0.737, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.58it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.70it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.29it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.29it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.34it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196470, 0.198760, 0.195934, 0.216831
Valid average loss UNet                 (all)                : 0.807995

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.040266, 0.772254, 1.542771
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.190304, 0.804767, 0.914352
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.163827, 1.025999, 1.171615
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.075899, 1.020234, 1.571556
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.120849, 1.249616, 1.562323
Valid average loss all      (Triplet)                 : 0.111135

== Recognize ==
Valid average loss Recognize     : 0.456258
Valid average accuracy drums     : 99.500000 %
Valid average accuracy bass      : 94.500000 %
Valid average accuracy piano     : 94.000000 %
Valid average accuracy guitar    : 94.000000 %
Valid average accuracy residuals : 93.500000 %

== Valid average loss all : 0.339263

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.703059911727905 sec. =
Valid knn accuracy drums     : 87.82608695652175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.605593919754028 sec. =
Valid knn accuracy bass      : 47.58064516129033%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.634296178817749 sec. =
Valid knn accuracy piano     : 71.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.417773723602295 sec. =
Valid knn accuracy guitar    : 72.09821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.729953765869141 sec. =
Valid knn accuracy residuals : 90.22727272727272%

Valid knn accuracy average   : 73.92144382615982%

                                                                      [AEpoch 2: 100%|██████████| 313/313 [08:00<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0222, Train/loss_recog_step=0.448, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.306, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0866, Train/loss_recog_epoch=0.438]Epoch 2: 100%|██████████| 313/313 [08:00<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0222, Train/loss_recog_step=0.448, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.199065, 0.199530, 0.199516, 0.218618
Train average loss UNet                 (all)                : 0.816730

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.024500, 0.728534, 1.528885
Train average loss bass     (Triplet, dist_p, dist_n) : 0.090778, 0.733569, 1.000647
Train average loss piano    (Triplet, dist_p, dist_n) : 0.067706, 0.916025, 1.240148
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.053805, 0.922739, 1.339737
Train average loss residuals(Triplet, dist_p, dist_n) : 0.049577, 1.210154, 1.735243
Train average loss all      (Triplet)                 : 0.058107

== Recognize ==
Train average loss Recognize     : 0.427078
Train average accuracy drums     : 98.185005 %
Train average accuracy bass      : 92.084999 %
Train average accuracy piano     : 88.985001 %
Train average accuracy guitar    : 89.700005 %
Train average accuracy residuals : 95.840004 %

== Train average loss all : 0.271646

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0222, Train/loss_recog_step=0.448, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0222, Train/loss_recog_step=0.448, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]Epoch 3:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0222, Train/loss_recog_step=0.448, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]Epoch 3:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.242, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0243, Train/loss_recog_step=0.436, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]Epoch 3:  32%|███▏      | 100/313 [02:05<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.242, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0243, Train/loss_recog_step=0.436, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]Epoch 3:  32%|███▏      | 100/313 [02:05<04:28,  0.79it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0362, Train/loss_recog_step=0.420, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]Epoch 3:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0362, Train/loss_recog_step=0.420, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]Epoch 3:  48%|████▊     | 150/313 [03:05<03:21,  0.81it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.863, Train/loss_triplet_all_step=0.0259, Train/loss_recog_step=0.441, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]Epoch 3:  64%|██████▍   | 200/313 [04:09<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.863, Train/loss_triplet_all_step=0.0259, Train/loss_recog_step=0.441, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]Epoch 3:  64%|██████▍   | 200/313 [04:09<02:20,  0.80it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.425, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]Epoch 3:  80%|███████▉  | 250/313 [05:10<01:18,  0.81it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.425, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]Epoch 3:  80%|███████▉  | 250/313 [05:10<01:18,  0.81it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0379, Train/loss_recog_step=0.389, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427] Epoch 3:  96%|█████████▌| 300/313 [06:10<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0379, Train/loss_recog_step=0.389, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]Epoch 3:  96%|█████████▌| 300/313 [06:10<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.248, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0385, Train/loss_recog_step=0.419, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]Epoch 3: 100%|██████████| 313/313 [06:23<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.248, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0385, Train/loss_recog_step=0.419, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]Epoch 3: 100%|██████████| 313/313 [06:23<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0016, Train/loss_recog_step=0.448, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.0788, Valid/loss_recog_step=0.464, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.111, Valid/loss_recog_epoch=0.456, Valid/knn_avr=0.739, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.37it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.08it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.09it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.66it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  2.66it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196379, 0.198725, 0.195851, 0.225736
Valid average loss UNet                 (all)                : 0.816691

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.049764, 0.840688, 1.682327
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.201313, 0.897124, 1.000650
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.201423, 1.148514, 1.265004
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.083659, 1.154851, 1.735750
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.104150, 1.339877, 1.698981
Valid average loss all      (Triplet)                 : 0.122015

== Recognize ==
Valid average loss Recognize     : 0.449701
Valid average accuracy drums     : 99.000000 %
Valid average accuracy bass      : 90.500000 %
Valid average accuracy piano     : 94.000000 %
Valid average accuracy guitar    : 94.000000 %
Valid average accuracy residuals : 95.000000 %

== Valid average loss all : 0.346865

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.07681655883789 sec. =
Valid knn accuracy drums     : 88.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.794147968292236 sec. =
Valid knn accuracy bass      : 47.17741935483871%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.994543552398682 sec. =
Valid knn accuracy piano     : 72.65625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.377476930618286 sec. =
Valid knn accuracy guitar    : 73.21428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.345486640930176 sec. =
Valid knn accuracy residuals : 89.31818181818181%

Valid knn accuracy average   : 74.12540129050473%

                                                                      [AEpoch 3: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0016, Train/loss_recog_step=0.448, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0581, Train/loss_recog_epoch=0.427]Epoch 3: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0016, Train/loss_recog_step=0.448, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.199035, 0.199508, 0.199486, 0.218934
Train average loss UNet                 (all)                : 0.816963

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.015731, 0.804322, 1.705058
Train average loss bass     (Triplet, dist_p, dist_n) : 0.063139, 0.796990, 1.121506
Train average loss piano    (Triplet, dist_p, dist_n) : 0.038784, 1.003386, 1.396943
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.030367, 1.009995, 1.498352
Train average loss residuals(Triplet, dist_p, dist_n) : 0.029465, 1.302668, 1.888766
Train average loss all      (Triplet)                 : 0.036213

== Recognize ==
Train average loss Recognize     : 0.419044
Train average accuracy drums     : 98.169998 %
Train average accuracy bass      : 92.220001 %
Train average accuracy piano     : 88.445000 %
Train average accuracy guitar    : 90.305000 %
Train average accuracy residuals : 95.784996 %

== Train average loss all : 0.245736

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0016, Train/loss_recog_step=0.448, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0016, Train/loss_recog_step=0.448, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]Epoch 4:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0016, Train/loss_recog_step=0.448, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]Epoch 4:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.443, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]Epoch 4:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.443, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]Epoch 4:  32%|███▏      | 100/313 [02:09<04:35,  0.77it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.410, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]Epoch 4:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.410, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]Epoch 4:  48%|████▊     | 150/313 [03:07<03:23,  0.80it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=0.411, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]Epoch 4:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=0.411, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]Epoch 4:  64%|██████▍   | 200/313 [04:07<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.402, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]Epoch 4:  80%|███████▉  | 250/313 [05:09<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.402, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]Epoch 4:  80%|███████▉  | 250/313 [05:09<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0313, Train/loss_recog_step=0.369, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]Epoch 4:  96%|█████████▌| 300/313 [06:09<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0313, Train/loss_recog_step=0.369, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]Epoch 4:  96%|█████████▌| 300/313 [06:09<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.401, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]Epoch 4: 100%|██████████| 313/313 [06:23<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.401, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]Epoch 4: 100%|██████████| 313/313 [06:23<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.437, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.0865, Valid/loss_recog_step=0.451, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.122, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.741, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.34it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.47it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.34it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196011, 0.198464, 0.195437, 0.220463
Valid average loss UNet                 (all)                : 0.810376

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.059328, 0.902519, 1.796798
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.197922, 0.958161, 1.110699
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.172624, 1.230204, 1.395918
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.074817, 1.232611, 1.844976
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.105128, 1.428575, 1.836550
Valid average loss all      (Triplet)                 : 0.118548

== Recognize ==
Valid average loss Recognize     : 0.449652
Valid average accuracy drums     : 98.000000 %
Valid average accuracy bass      : 93.500000 %
Valid average accuracy piano     : 91.000000 %
Valid average accuracy guitar    : 91.000000 %
Valid average accuracy residuals : 94.000000 %

== Valid average loss all : 0.343374

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.357768058776855 sec. =
Valid knn accuracy drums     : 88.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.448325872421265 sec. =
Valid knn accuracy bass      : 44.354838709677416%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.660353660583496 sec. =
Valid knn accuracy piano     : 74.8046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.495561122894287 sec. =
Valid knn accuracy guitar    : 73.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.365548610687256 sec. =
Valid knn accuracy residuals : 89.0909090909091%

Valid knn accuracy average   : 74.03323923403035%

                                                                      [AEpoch 4: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.437, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.246, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.419] Epoch 4: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.437, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198993, 0.199460, 0.199449, 0.218554
Train average loss UNet                 (all)                : 0.816455

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.010299, 0.857179, 1.830345
Train average loss bass     (Triplet, dist_p, dist_n) : 0.042022, 0.846229, 1.221430
Train average loss piano    (Triplet, dist_p, dist_n) : 0.020631, 1.062840, 1.519580
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.018095, 1.074926, 1.620429
Train average loss residuals(Triplet, dist_p, dist_n) : 0.017134, 1.370374, 2.014517
Train average loss all      (Triplet)                 : 0.022188

== Recognize ==
Train average loss Recognize     : 0.410674
Train average accuracy drums     : 98.299995 %
Train average accuracy bass      : 91.945000 %
Train average accuracy piano     : 88.314995 %
Train average accuracy guitar    : 89.990005 %
Train average accuracy residuals : 95.560005 %

== Train average loss all : 0.227525

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.437, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.437, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]Epoch 5:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.437, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]Epoch 5:  16%|█▌        | 50/313 [01:08<05:58,  0.73it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=0.420, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411] Epoch 5:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=0.420, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]Epoch 5:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.413, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]Epoch 5:  48%|████▊     | 150/313 [03:10<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.413, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]Epoch 5:  48%|████▊     | 150/313 [03:10<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.00596, Train/loss_recog_step=0.417, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]Epoch 5:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.00596, Train/loss_recog_step=0.417, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]Epoch 5:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=0.407, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]Epoch 5:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=0.407, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]Epoch 5:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=0.365, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411] Epoch 5:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=0.365, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]Epoch 5:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=0.389, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]Epoch 5: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=0.389, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]Epoch 5: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000511, Train/loss_recog_step=0.459, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.470, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.119, Valid/loss_recog_epoch=0.450, Valid/knn_avr=0.740, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.62it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.37it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.26it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196292, 0.198721, 0.195759, 0.223798
Valid average loss UNet                 (all)                : 0.814570

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.051034, 0.944890, 1.874520
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.214630, 0.960784, 1.062984
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.208110, 1.335211, 1.476619
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.092447, 1.245733, 1.874708
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.114812, 1.356017, 1.747206
Valid average loss all      (Triplet)                 : 0.134804

== Recognize ==
Valid average loss Recognize     : 0.439857
Valid average accuracy drums     : 98.500000 %
Valid average accuracy bass      : 93.500000 %
Valid average accuracy piano     : 85.500000 %
Valid average accuracy guitar    : 90.500000 %
Valid average accuracy residuals : 95.000000 %

== Valid average loss all : 0.354732

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.458395957946777 sec. =
Valid knn accuracy drums     : 88.91304347826086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.385776996612549 sec. =
Valid knn accuracy bass      : 45.766129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.874900102615356 sec. =
Valid knn accuracy piano     : 66.40625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.50387716293335 sec. =
Valid knn accuracy guitar    : 72.32142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.418605327606201 sec. =
Valid knn accuracy residuals : 89.0909090909091%

Valid knn accuracy average   : 72.49955203457132%

                                                                      [AEpoch 5: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000511, Train/loss_recog_step=0.459, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.228, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=0.411]Epoch 5: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000511, Train/loss_recog_step=0.459, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198932, 0.199408, 0.199390, 0.218911
Train average loss UNet                 (all)                : 0.816640

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007269, 0.895442, 1.929282
Train average loss bass     (Triplet, dist_p, dist_n) : 0.029208, 0.879920, 1.292538
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012400, 1.105219, 1.603473
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011005, 1.113653, 1.708230
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010430, 1.425726, 2.112618
Train average loss all      (Triplet)                 : 0.014409

== Recognize ==
Train average loss Recognize     : 0.401734
Train average accuracy drums     : 98.345001 %
Train average accuracy bass      : 91.769997 %
Train average accuracy piano     : 88.360001 %
Train average accuracy guitar    : 90.834999 %
Train average accuracy residuals : 95.445000 %

== Train average loss all : 0.215276

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000511, Train/loss_recog_step=0.459, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000511, Train/loss_recog_step=0.459, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]Epoch 6:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000511, Train/loss_recog_step=0.459, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]Epoch 6:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0048, Train/loss_recog_step=0.424, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]  Epoch 6:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0048, Train/loss_recog_step=0.424, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]Epoch 6:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00647, Train/loss_recog_step=0.371, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]Epoch 6:  48%|████▊     | 150/313 [03:13<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00647, Train/loss_recog_step=0.371, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]Epoch 6:  48%|████▊     | 150/313 [03:13<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.00462, Train/loss_recog_step=0.396, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]Epoch 6:  64%|██████▍   | 200/313 [04:16<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.00462, Train/loss_recog_step=0.396, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]Epoch 6:  64%|██████▍   | 200/313 [04:16<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00877, Train/loss_recog_step=0.380, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]Epoch 6:  80%|███████▉  | 250/313 [05:18<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00877, Train/loss_recog_step=0.380, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]Epoch 6:  80%|███████▉  | 250/313 [05:18<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=0.350, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402] Epoch 6:  96%|█████████▌| 300/313 [06:19<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=0.350, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]Epoch 6:  96%|█████████▌| 300/313 [06:19<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=0.382, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]Epoch 6: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=0.382, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]Epoch 6: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.419, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.467, Valid/loss_all_epoch=0.355, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=0.440, Valid/knn_avr=0.725, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.29it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.27it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.60it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.98it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196048, 0.198426, 0.195484, 0.220784
Valid average loss UNet                 (all)                : 0.810741

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.045806, 0.971102, 1.958069
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.248670, 1.066127, 1.187039
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.210464, 1.312196, 1.440917
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.099541, 1.304494, 1.969402
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.073169, 1.494092, 1.964507
Valid average loss all      (Triplet)                 : 0.132320

== Recognize ==
Valid average loss Recognize     : 0.423774
Valid average accuracy drums     : 98.500000 %
Valid average accuracy bass      : 92.000000 %
Valid average accuracy piano     : 89.500000 %
Valid average accuracy guitar    : 93.000000 %
Valid average accuracy residuals : 96.500000 %

== Valid average loss all : 0.344207

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.611910581588745 sec. =
Valid knn accuracy drums     : 88.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.455307722091675 sec. =
Valid knn accuracy bass      : 50.201612903225815%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.563504934310913 sec. =
Valid knn accuracy piano     : 69.7265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.282453298568726 sec. =
Valid knn accuracy guitar    : 72.54464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.87637734413147 sec. =
Valid knn accuracy residuals : 86.81818181818181%

Valid knn accuracy average   : 73.59733045049272%

                                                                      [AEpoch 6: 100%|██████████| 313/313 [08:01<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.419, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=0.402]Epoch 6: 100%|██████████| 313/313 [08:01<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.419, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198950, 0.199415, 0.199401, 0.218520
Train average loss UNet                 (all)                : 0.816286

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005396, 0.928384, 2.014597
Train average loss bass     (Triplet, dist_p, dist_n) : 0.019309, 0.926568, 1.387636
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007980, 1.144352, 1.683000
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007683, 1.143364, 1.777761
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007336, 1.471275, 2.207369
Train average loss all      (Triplet)                 : 0.009825

== Recognize ==
Train average loss Recognize     : 0.392125
Train average accuracy drums     : 98.294998 %
Train average accuracy bass      : 92.345001 %
Train average accuracy piano     : 88.760002 %
Train average accuracy guitar    : 90.485001 %
Train average accuracy residuals : 95.775002 %

== Train average loss all : 0.205887

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.419, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.419, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]Epoch 7:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.419, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]Epoch 7:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00325, Train/loss_recog_step=0.416, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]Epoch 7:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00325, Train/loss_recog_step=0.416, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]Epoch 7:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.00672, Train/loss_recog_step=0.396, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]Epoch 7:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.00672, Train/loss_recog_step=0.396, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]Epoch 7:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=0.409, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]Epoch 7:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=0.409, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]Epoch 7:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000652, Train/loss_recog_step=0.415, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]Epoch 7:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000652, Train/loss_recog_step=0.415, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]Epoch 7:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00566, Train/loss_recog_step=0.342, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392] Epoch 7:  96%|█████████▌| 300/313 [06:17<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00566, Train/loss_recog_step=0.342, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]Epoch 7:  96%|█████████▌| 300/313 [06:17<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00493, Train/loss_recog_step=0.355, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]Epoch 7: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00493, Train/loss_recog_step=0.355, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]Epoch 7: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=0.367, Valid/loss_all_step=0.310, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.0955, Valid/loss_recog_step=0.429, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.424, Valid/knn_avr=0.736, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.29it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.62it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.09it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.12it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.13it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195770, 0.198163, 0.195191, 0.233050
Valid average loss UNet                 (all)                : 0.822174

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062696, 1.036546, 2.034966
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.233460, 1.069285, 1.246151
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.204115, 1.296968, 1.471613
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.099847, 1.309970, 1.983139
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.064876, 1.478071, 2.002604
Valid average loss all      (Triplet)                 : 0.128789

== Recognize ==
Valid average loss Recognize     : 0.422609
Valid average accuracy drums     : 97.000000 %
Valid average accuracy bass      : 93.500000 %
Valid average accuracy piano     : 89.500000 %
Valid average accuracy guitar    : 93.000000 %
Valid average accuracy residuals : 94.000000 %

== Valid average loss all : 0.340093

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.037145614624023 sec. =
Valid knn accuracy drums     : 87.39130434782608%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.380958795547485 sec. =
Valid knn accuracy bass      : 49.79838709677419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.655168056488037 sec. =
Valid knn accuracy piano     : 68.359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.38743782043457 sec. =
Valid knn accuracy guitar    : 74.33035714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.721424579620361 sec. =
Valid knn accuracy residuals : 91.36363636363637%

Valid knn accuracy average   : 74.24861199021875%

                                                                      [AEpoch 7: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=0.367, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00982, Train/loss_recog_epoch=0.392]Epoch 7: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=0.367, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198927, 0.199398, 0.199380, 0.218755
Train average loss UNet                 (all)                : 0.816460

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004520, 0.939984, 2.075837
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014271, 0.949910, 1.443946
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005845, 1.155819, 1.720835
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006685, 1.163114, 1.825589
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005716, 1.498368, 2.268090
Train average loss all      (Triplet)                 : 0.007625

== Recognize ==
Train average loss Recognize     : 0.385183
Train average accuracy drums     : 98.315002 %
Train average accuracy bass      : 92.259995 %
Train average accuracy piano     : 88.650002 %
Train average accuracy guitar    : 90.605003 %
Train average accuracy residuals : 95.854996 %

== Train average loss all : 0.200217

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=0.367, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=0.367, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]Epoch 8:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=0.367, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]Epoch 8:  16%|█▌        | 50/313 [01:09<06:07,  0.72it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00257, Train/loss_recog_step=0.403, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]Epoch 8:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00257, Train/loss_recog_step=0.403, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]Epoch 8:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00259, Train/loss_recog_step=0.392, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]Epoch 8:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00259, Train/loss_recog_step=0.392, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]Epoch 8:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.00348, Train/loss_recog_step=0.375, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]Epoch 8:  64%|██████▍   | 200/313 [04:19<02:26,  0.77it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.00348, Train/loss_recog_step=0.375, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]Epoch 8:  64%|██████▍   | 200/313 [04:19<02:26,  0.77it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00523, Train/loss_recog_step=0.381, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]Epoch 8:  80%|███████▉  | 250/313 [05:20<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00523, Train/loss_recog_step=0.381, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]Epoch 8:  80%|███████▉  | 250/313 [05:20<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.349, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]Epoch 8:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.349, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]Epoch 8:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0127, Train/loss_recog_step=0.353, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385] Epoch 8: 100%|██████████| 313/313 [06:34<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0127, Train/loss_recog_step=0.353, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]Epoch 8: 100%|██████████| 313/313 [06:34<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.436, Valid/loss_all_step=0.287, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0714, Valid/loss_recog_step=0.432, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=0.423, Valid/knn_avr=0.742, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.23it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.07it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.83it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.70it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195823, 0.198265, 0.195274, 0.216939
Valid average loss UNet                 (all)                : 0.806301

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.054528, 0.986034, 2.003605
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.233705, 1.120858, 1.297489
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.181007, 1.339918, 1.550328
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.091937, 1.302240, 2.035177
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.131836, 1.534925, 1.985554
Valid average loss all      (Triplet)                 : 0.132575

== Recognize ==
Valid average loss Recognize     : 0.403133
Valid average accuracy drums     : 99.000000 %
Valid average accuracy bass      : 92.000000 %
Valid average accuracy piano     : 92.500000 %
Valid average accuracy guitar    : 94.500000 %
Valid average accuracy residuals : 96.000000 %

== Valid average loss all : 0.334141

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.30674433708191 sec. =
Valid knn accuracy drums     : 88.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.497936487197876 sec. =
Valid knn accuracy bass      : 49.79838709677419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.584515571594238 sec. =
Valid knn accuracy piano     : 65.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.380804061889648 sec. =
Valid knn accuracy guitar    : 70.75892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6297242641448975 sec. =
Valid knn accuracy residuals : 87.5%

Valid knn accuracy average   : 72.34515878581446%

                                                                      [AEpoch 8: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.436, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00762, Train/loss_recog_epoch=0.385]Epoch 8: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.436, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198875, 0.199344, 0.199326, 0.219346
Train average loss UNet                 (all)                : 0.816891

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004729, 0.946825, 2.128361
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011767, 0.975103, 1.493016
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006369, 1.188423, 1.783783
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004954, 1.168090, 1.856705
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004857, 1.506617, 2.299438
Train average loss all      (Triplet)                 : 0.006689

== Recognize ==
Train average loss Recognize     : 0.376458
Train average accuracy drums     : 98.535004 %
Train average accuracy bass      : 92.580002 %
Train average accuracy piano     : 89.084999 %
Train average accuracy guitar    : 91.000000 %
Train average accuracy residuals : 96.060005 %

== Train average loss all : 0.194918

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.436, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.436, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376]Epoch 9:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.436, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376]Epoch 9:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00557, Train/loss_recog_step=0.394, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376]Epoch 9:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00557, Train/loss_recog_step=0.394, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376]Epoch 9:  32%|███▏      | 100/313 [02:10<04:37,  0.77it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.00638, Train/loss_recog_step=0.378, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376]Epoch 9:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.00638, Train/loss_recog_step=0.378, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376]Epoch 9:  48%|████▊     | 150/313 [03:08<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.00683, Train/loss_recog_step=0.386, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376]Epoch 9:  64%|██████▍   | 200/313 [04:11<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.00683, Train/loss_recog_step=0.386, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376]Epoch 9:  64%|██████▍   | 200/313 [04:11<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000762, Train/loss_recog_step=0.364, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376]Epoch 9:  80%|███████▉  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000762, Train/loss_recog_step=0.364, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376]Epoch 9:  80%|███████▉  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00599, Train/loss_recog_step=0.343, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376] Epoch 9:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00599, Train/loss_recog_step=0.343, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376]Epoch 9:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.348, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376] Epoch 9: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.348, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376]Epoch 9: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=3.55e-5, Train/loss_recog_step=0.400, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.0869, Valid/loss_recog_step=0.397, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=0.403, Valid/knn_avr=0.723, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.29it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.78it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.14it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.30it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.05it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195915, 0.198352, 0.195355, 0.222352
Valid average loss UNet                 (all)                : 0.811973

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067754, 1.097080, 2.198692
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.258036, 1.142969, 1.298866
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.202548, 1.424167, 1.591222
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.071001, 1.279982, 2.094245
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.107493, 1.433630, 1.894102
Valid average loss all      (Triplet)                 : 0.142683

== Recognize ==
Valid average loss Recognize     : 0.401509
Valid average accuracy drums     : 99.000000 %
Valid average accuracy bass      : 96.000000 %
Valid average accuracy piano     : 88.500000 %
Valid average accuracy guitar    : 89.500000 %
Valid average accuracy residuals : 98.000000 %

== Valid average loss all : 0.343438

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.476654052734375 sec. =
Valid knn accuracy drums     : 87.60869565217392%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.649228572845459 sec. =
Valid knn accuracy bass      : 46.16935483870967%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.526732444763184 sec. =
Valid knn accuracy piano     : 64.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.449075222015381 sec. =
Valid knn accuracy guitar    : 73.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.69098973274231 sec. =
Valid knn accuracy residuals : 87.5%

Valid knn accuracy average   : 71.87279759817672%

                                                                      [AEpoch 9: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=3.55e-5, Train/loss_recog_step=0.400, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=0.376] Epoch 9: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=3.55e-5, Train/loss_recog_step=0.400, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198816, 0.199301, 0.199287, 0.218685
Train average loss UNet                 (all)                : 0.816089

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003521, 0.965769, 2.169093
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010472, 1.004975, 1.552570
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004829, 1.192548, 1.806413
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004704, 1.176933, 1.887785
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005181, 1.522841, 2.343521
Train average loss all      (Triplet)                 : 0.005887

== Recognize ==
Train average loss Recognize     : 0.369085
Train average accuracy drums     : 98.529999 %
Train average accuracy bass      : 92.459999 %
Train average accuracy piano     : 89.570000 %
Train average accuracy guitar    : 91.355003 %
Train average accuracy residuals : 95.915001 %

== Train average loss all : 0.190430

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=3.55e-5, Train/loss_recog_step=0.400, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=3.55e-5, Train/loss_recog_step=0.400, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]Epoch 10:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=3.55e-5, Train/loss_recog_step=0.400, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]Epoch 10:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00851, Train/loss_recog_step=0.378, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]Epoch 10:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00851, Train/loss_recog_step=0.378, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]Epoch 10:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00433, Train/loss_recog_step=0.380, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]Epoch 10:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00433, Train/loss_recog_step=0.380, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]Epoch 10:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=0.374, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369] Epoch 10:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=0.374, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]Epoch 10:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=0.355, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]Epoch 10:  80%|███████▉  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=0.355, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]Epoch 10:  80%|███████▉  | 250/313 [05:13<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0079, Train/loss_recog_step=0.334, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369] Epoch 10:  96%|█████████▌| 300/313 [06:13<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0079, Train/loss_recog_step=0.334, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]Epoch 10:  96%|█████████▌| 300/313 [06:13<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0147, Train/loss_recog_step=0.379, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]Epoch 10: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0147, Train/loss_recog_step=0.379, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]Epoch 10: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=0.384, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=0.406, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=0.402, Valid/knn_avr=0.719, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.90it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.06it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.70it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  2.87it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.45it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195738, 0.198137, 0.195141, 0.231235
Valid average loss UNet                 (all)                : 0.820251

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.051251, 1.000594, 2.085880
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.265566, 1.223156, 1.421822
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.184565, 1.337675, 1.557972
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.101069, 1.303209, 2.087224
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.077729, 1.413740, 1.923322
Valid average loss all      (Triplet)                 : 0.136966

== Recognize ==
Valid average loss Recognize     : 0.392439
Valid average accuracy drums     : 97.500000 %
Valid average accuracy bass      : 96.000000 %
Valid average accuracy piano     : 89.500000 %
Valid average accuracy guitar    : 93.000000 %
Valid average accuracy residuals : 96.500000 %

== Valid average loss all : 0.333185

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.564576625823975 sec. =
Valid knn accuracy drums     : 88.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.370635509490967 sec. =
Valid knn accuracy bass      : 44.153225806451616%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.819209098815918 sec. =
Valid knn accuracy piano     : 67.3828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.490015506744385 sec. =
Valid knn accuracy guitar    : 73.88392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.333491563796997 sec. =
Valid knn accuracy residuals : 88.4090909090909%

Valid knn accuracy average   : 72.46146373130726%

                                                                      [AEpoch 10: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=0.384, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.369]Epoch 10: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=0.384, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198719, 0.199187, 0.199164, 0.218941
Train average loss UNet                 (all)                : 0.816012

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003744, 0.978984, 2.228871
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008921, 1.031626, 1.614825
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005129, 1.202934, 1.846096
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005231, 1.186810, 1.929208
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005198, 1.532619, 2.376508
Train average loss all      (Triplet)                 : 0.005701

== Recognize ==
Train average loss Recognize     : 0.363256
Train average accuracy drums     : 98.895004 %
Train average accuracy bass      : 92.695000 %
Train average accuracy piano     : 89.690002 %
Train average accuracy guitar    : 90.625000 %
Train average accuracy residuals : 96.020004 %

== Train average loss all : 0.187329

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=0.384, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=0.384, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363]Epoch 11:  16%|█▌        | 50/313 [01:11<06:15,  0.70it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=0.384, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363]Epoch 11:  16%|█▌        | 50/313 [01:11<06:15,  0.70it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00293, Train/loss_recog_step=0.382, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363]Epoch 11:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00293, Train/loss_recog_step=0.382, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363]Epoch 11:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=0.392, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363] Epoch 11:  48%|████▊     | 150/313 [03:14<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=0.392, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363]Epoch 11:  48%|████▊     | 150/313 [03:14<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.00287, Train/loss_recog_step=0.378, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363]Epoch 11:  64%|██████▍   | 200/313 [04:16<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.00287, Train/loss_recog_step=0.378, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363]Epoch 11:  64%|██████▍   | 200/313 [04:16<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.348, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363]  Epoch 11:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.348, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363]Epoch 11:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00551, Train/loss_recog_step=0.324, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363]Epoch 11:  96%|█████████▌| 300/313 [06:17<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00551, Train/loss_recog_step=0.324, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363]Epoch 11:  96%|█████████▌| 300/313 [06:17<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=0.323, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363] Epoch 11: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=0.323, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363]Epoch 11: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00181, Train/loss_recog_step=0.384, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0961, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.392, Valid/knn_avr=0.725, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.45it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.50it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.67it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.19it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.08it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.83it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195651, 0.198056, 0.195054, 0.221495
Valid average loss UNet                 (all)                : 0.810256

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067574, 1.096875, 2.324616
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.291290, 1.212623, 1.405351
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.204723, 1.339267, 1.554456
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.103526, 1.355939, 2.207828
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.084743, 1.599204, 2.128135
Valid average loss all      (Triplet)                 : 0.146981

== Recognize ==
Valid average loss Recognize     : 0.395748
Valid average accuracy drums     : 99.500000 %
Valid average accuracy bass      : 94.000000 %
Valid average accuracy piano     : 95.000000 %
Valid average accuracy guitar    : 92.000000 %
Valid average accuracy residuals : 88.500000 %

== Valid average loss all : 0.344854

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.539150476455688 sec. =
Valid knn accuracy drums     : 87.82608695652175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.426088571548462 sec. =
Valid knn accuracy bass      : 41.935483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.72786259651184 sec. =
Valid knn accuracy piano     : 66.6015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.7158074378967285 sec. =
Valid knn accuracy guitar    : 72.99107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.335679769515991 sec. =
Valid knn accuracy residuals : 88.4090909090909%

Valid knn accuracy average   : 71.55265913303037%

                                                                      [AEpoch 11: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00181, Train/loss_recog_step=0.384, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0057, Train/loss_recog_epoch=0.363]Epoch 11: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00181, Train/loss_recog_step=0.384, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198702, 0.199181, 0.199160, 0.219227
Train average loss UNet                 (all)                : 0.816270

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003403, 0.991058, 2.278179
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008142, 1.039130, 1.637586
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005681, 1.208656, 1.857833
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004507, 1.201445, 1.962766
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004529, 1.533814, 2.392724
Train average loss all      (Triplet)                 : 0.005313

== Recognize ==
Train average loss Recognize     : 0.356767
Train average accuracy drums     : 98.879997 %
Train average accuracy bass      : 92.849998 %
Train average accuracy piano     : 89.544998 %
Train average accuracy guitar    : 91.485001 %
Train average accuracy residuals : 96.034996 %

== Train average loss all : 0.183697

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00181, Train/loss_recog_step=0.384, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00181, Train/loss_recog_step=0.384, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]Epoch 12:  16%|█▌        | 50/313 [01:14<06:30,  0.67it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00181, Train/loss_recog_step=0.384, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]Epoch 12:  16%|█▌        | 50/313 [01:14<06:30,  0.67it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00179, Train/loss_recog_step=0.382, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]Epoch 12:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00179, Train/loss_recog_step=0.382, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]Epoch 12:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=0.359, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]Epoch 12:  48%|████▊     | 150/313 [03:16<03:33,  0.76it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=0.359, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]Epoch 12:  48%|████▊     | 150/313 [03:16<03:33,  0.76it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00363, Train/loss_recog_step=0.359, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]Epoch 12:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00363, Train/loss_recog_step=0.359, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]Epoch 12:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00278, Train/loss_recog_step=0.362, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]Epoch 12:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00278, Train/loss_recog_step=0.362, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]Epoch 12:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00167, Train/loss_recog_step=0.328, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]Epoch 12:  96%|█████████▌| 300/313 [06:17<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00167, Train/loss_recog_step=0.328, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]Epoch 12:  96%|█████████▌| 300/313 [06:17<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00401, Train/loss_recog_step=0.307, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]Epoch 12: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00401, Train/loss_recog_step=0.307, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]Epoch 12: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.356, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0726, Valid/loss_recog_step=0.396, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=0.396, Valid/knn_avr=0.716, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.37it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.40it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.16it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195694, 0.198137, 0.195087, 0.227609
Valid average loss UNet                 (all)                : 0.816527

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070617, 1.106669, 2.332413
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.241645, 1.198672, 1.416960
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.220866, 1.427579, 1.596645
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.097589, 1.291436, 2.170218
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.117444, 1.550985, 2.076228
Valid average loss all      (Triplet)                 : 0.147901

== Recognize ==
Valid average loss Recognize     : 0.376528
Valid average accuracy drums     : 96.500000 %
Valid average accuracy bass      : 94.000000 %
Valid average accuracy piano     : 91.000000 %
Valid average accuracy guitar    : 91.000000 %
Valid average accuracy residuals : 94.500000 %

== Valid average loss all : 0.336165

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.483653783798218 sec. =
Valid knn accuracy drums     : 87.60869565217392%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.619234085083008 sec. =
Valid knn accuracy bass      : 41.53225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.596256017684937 sec. =
Valid knn accuracy piano     : 64.2578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.525758504867554 sec. =
Valid knn accuracy guitar    : 75.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6130781173706055 sec. =
Valid knn accuracy residuals : 87.5%

Valid knn accuracy average   : 71.17975324333801%

                                                                      [AEpoch 12: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.356, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00531, Train/loss_recog_epoch=0.357] Epoch 12: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.356, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198683, 0.199156, 0.199136, 0.218850
Train average loss UNet                 (all)                : 0.815825

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003365, 1.006651, 2.333233
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007372, 1.062606, 1.689668
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004712, 1.219005, 1.896371
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003670, 1.206967, 1.997997
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003829, 1.522189, 2.388406
Train average loss all      (Triplet)                 : 0.004678

== Recognize ==
Train average loss Recognize     : 0.351569
Train average accuracy drums     : 98.879997 %
Train average accuracy bass      : 92.709999 %
Train average accuracy piano     : 89.744995 %
Train average accuracy guitar    : 91.495003 %
Train average accuracy residuals : 96.010002 %

== Train average loss all : 0.180462

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.356, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.356, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]Epoch 13:  16%|█▌        | 50/313 [01:12<06:19,  0.69it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.356, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]Epoch 13:  16%|█▌        | 50/313 [01:12<06:19,  0.69it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000924, Train/loss_recog_step=0.384, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]Epoch 13:  32%|███▏      | 100/313 [02:12<04:42,  0.76it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000924, Train/loss_recog_step=0.384, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]Epoch 13:  32%|███▏      | 100/313 [02:12<04:42,  0.76it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.343, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]   Epoch 13:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.343, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]Epoch 13:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.00173, Train/loss_recog_step=0.370, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]Epoch 13:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.00173, Train/loss_recog_step=0.370, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]Epoch 13:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=0.369, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]Epoch 13:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=0.369, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]Epoch 13:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00511, Train/loss_recog_step=0.312, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]Epoch 13:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00511, Train/loss_recog_step=0.312, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]Epoch 13:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00617, Train/loss_recog_step=0.321, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]Epoch 13: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00617, Train/loss_recog_step=0.321, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]Epoch 13: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.390, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=0.366, Valid/loss_all_epoch=0.336, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.377, Valid/knn_avr=0.712, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.28it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.99it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.13it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.64it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.67it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195583, 0.197960, 0.195076, 0.220533
Valid average loss UNet                 (all)                : 0.809152

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.051689, 1.050073, 2.447853
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.318164, 1.305854, 1.460791
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.176458, 1.395918, 1.650872
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.106103, 1.363012, 2.211568
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.109824, 1.557448, 2.075585
Valid average loss all      (Triplet)                 : 0.150221

== Recognize ==
Valid average loss Recognize     : 0.379366
Valid average accuracy drums     : 99.500000 %
Valid average accuracy bass      : 93.000000 %
Valid average accuracy piano     : 91.500000 %
Valid average accuracy guitar    : 88.000000 %
Valid average accuracy residuals : 93.000000 %

== Valid average loss all : 0.339904

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.22416067123413 sec. =
Valid knn accuracy drums     : 89.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.651479482650757 sec. =
Valid knn accuracy bass      : 44.153225806451616%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.642467737197876 sec. =
Valid knn accuracy piano     : 64.453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.443545818328857 sec. =
Valid knn accuracy guitar    : 73.66071428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.395701885223389 sec. =
Valid knn accuracy residuals : 86.13636363636363%

Valid knn accuracy average   : 71.63720748483634%

                                                                      [AEpoch 13: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.390, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00468, Train/loss_recog_epoch=0.352]Epoch 13: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.390, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198692, 0.199173, 0.199155, 0.218646
Train average loss UNet                 (all)                : 0.815666

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003673, 1.014574, 2.378662
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006912, 1.075913, 1.722713
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005205, 1.235086, 1.933369
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004623, 1.196533, 1.990522
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004148, 1.538201, 2.425853
Train average loss all      (Triplet)                 : 0.004931

== Recognize ==
Train average loss Recognize     : 0.345843
Train average accuracy drums     : 98.809998 %
Train average accuracy bass      : 92.965004 %
Train average accuracy piano     : 89.900002 %
Train average accuracy guitar    : 91.369995 %
Train average accuracy residuals : 96.074997 %

== Train average loss all : 0.177852

Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.390, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]          Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.390, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]Epoch 14:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.390, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]Epoch 14:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00686, Train/loss_recog_step=0.363, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]Epoch 14:  32%|███▏      | 100/313 [02:11<04:40,  0.76it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00686, Train/loss_recog_step=0.363, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]Epoch 14:  32%|███▏      | 100/313 [02:11<04:40,  0.76it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.358, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346] Epoch 14:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.358, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]Epoch 14:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.374, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346] Epoch 14:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.374, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]Epoch 14:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000606, Train/loss_recog_step=0.336, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]Epoch 14:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000606, Train/loss_recog_step=0.336, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]Epoch 14:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.304, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]  Epoch 14:  96%|█████████▌| 300/313 [06:18<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.304, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]Epoch 14:  96%|█████████▌| 300/313 [06:18<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.317, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]Epoch 14: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.317, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]Epoch 14: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00613, Train/loss_recog_step=0.379, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0729, Valid/loss_recog_step=0.383, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.379, Valid/knn_avr=0.716, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.27it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.23it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.24it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195401, 0.197768, 0.194833, 0.231001
Valid average loss UNet                 (all)                : 0.819003

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.068645, 1.126732, 2.306839
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.303812, 1.352968, 1.564995
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.188159, 1.310551, 1.567195
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.105551, 1.436221, 2.245098
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.148771, 1.743481, 2.268799
Valid average loss all      (Triplet)                 : 0.156518

== Recognize ==
Valid average loss Recognize     : 0.377644
Valid average accuracy drums     : 98.000000 %
Valid average accuracy bass      : 95.000000 %
Valid average accuracy piano     : 92.500000 %
Valid average accuracy guitar    : 84.000000 %
Valid average accuracy residuals : 93.500000 %

== Valid average loss all : 0.345340

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.508951902389526 sec. =
Valid knn accuracy drums     : 87.39130434782608%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.458896398544312 sec. =
Valid knn accuracy bass      : 41.53225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.876303672790527 sec. =
Valid knn accuracy piano     : 66.40625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.428520441055298 sec. =
Valid knn accuracy guitar    : 73.88392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.322831869125366 sec. =
Valid knn accuracy residuals : 86.81818181818181%

Valid knn accuracy average   : 71.20638456039052%

                                                                      [AEpoch 14: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00613, Train/loss_recog_step=0.379, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00493, Train/loss_recog_epoch=0.346]Epoch 14: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00613, Train/loss_recog_step=0.379, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198653, 0.199129, 0.199108, 0.219019
Train average loss UNet                 (all)                : 0.815909

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003586, 1.035477, 2.450383
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006377, 1.083553, 1.745426
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004849, 1.246284, 1.965769
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004310, 1.202735, 2.018303
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003888, 1.546529, 2.453183
Train average loss all      (Triplet)                 : 0.004638

== Recognize ==
Train average loss Recognize     : 0.341648
Train average accuracy drums     : 98.949997 %
Train average accuracy bass      : 93.029999 %
Train average accuracy piano     : 89.889999 %
Train average accuracy guitar    : 91.404999 %
Train average accuracy residuals : 96.195000 %

== Train average loss all : 0.175461

Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00613, Train/loss_recog_step=0.379, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]          Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00613, Train/loss_recog_step=0.379, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]Epoch 15:  16%|█▌        | 50/313 [01:13<06:25,  0.68it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00613, Train/loss_recog_step=0.379, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]Epoch 15:  16%|█▌        | 50/313 [01:13<06:25,  0.68it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.351, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]  Epoch 15:  32%|███▏      | 100/313 [02:15<04:49,  0.74it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.351, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]Epoch 15:  32%|███▏      | 100/313 [02:15<04:49,  0.74it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00209, Train/loss_recog_step=0.340, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]Epoch 15:  48%|████▊     | 150/313 [03:17<03:34,  0.76it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00209, Train/loss_recog_step=0.340, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]Epoch 15:  48%|████▊     | 150/313 [03:17<03:34,  0.76it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00112, Train/loss_recog_step=0.341, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]Epoch 15:  64%|██████▍   | 200/313 [04:18<02:25,  0.77it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00112, Train/loss_recog_step=0.341, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]Epoch 15:  64%|██████▍   | 200/313 [04:18<02:25,  0.77it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00613, Train/loss_recog_step=0.349, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]Epoch 15:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00613, Train/loss_recog_step=0.349, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]Epoch 15:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00353, Train/loss_recog_step=0.305, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]Epoch 15:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00353, Train/loss_recog_step=0.305, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]Epoch 15:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00427, Train/loss_recog_step=0.326, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]Epoch 15: 100%|██████████| 313/313 [06:33<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00427, Train/loss_recog_step=0.326, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342]Epoch 15: 100%|██████████| 313/313 [06:33<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.363, Valid/loss_all_step=0.256, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0864, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.378, Valid/knn_avr=0.712, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.25it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.79it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.43it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.34it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.51it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195636, 0.197946, 0.195121, 0.218522
Valid average loss UNet                 (all)                : 0.807226

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.094706, 1.200890, 2.478939
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.356584, 1.380897, 1.559456
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.200452, 1.339162, 1.611273
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.125300, 1.394164, 2.241810
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.121441, 1.632326, 2.149298
Valid average loss all      (Triplet)                 : 0.172935

== Recognize ==
Valid average loss Recognize     : 0.360405
Valid average accuracy drums     : 97.500000 %
Valid average accuracy bass      : 93.500000 %
Valid average accuracy piano     : 96.000000 %
Valid average accuracy guitar    : 93.000000 %
Valid average accuracy residuals : 94.500000 %

== Valid average loss all : 0.353138

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.394062280654907 sec. =
Valid knn accuracy drums     : 89.13043478260869%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.765952587127686 sec. =
Valid knn accuracy bass      : 46.37096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.617889404296875 sec. =
Valid knn accuracy piano     : 65.8203125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.7206807136535645 sec. =
Valid knn accuracy guitar    : 70.53571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.404118537902832 sec. =
Valid knn accuracy residuals : 86.13636363636363%

Valid knn accuracy average   : 71.59875858932442%

                                                                      [AEpoch 15: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.363, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00464, Train/loss_recog_epoch=0.342] Epoch 15: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.363, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198612, 0.199091, 0.199072, 0.218125
Train average loss UNet                 (all)                : 0.814900

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002725, 1.046076, 2.490835
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007823, 1.107668, 1.785776
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005602, 1.243237, 1.975495
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004053, 1.219972, 2.057397
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003374, 1.543396, 2.462864
Train average loss all      (Triplet)                 : 0.004846

== Recognize ==
Train average loss Recognize     : 0.337078
Train average accuracy drums     : 98.900002 %
Train average accuracy bass      : 93.080002 %
Train average accuracy piano     : 89.514999 %
Train average accuracy guitar    : 91.659996 %
Train average accuracy residuals : 96.315002 %

== Train average loss all : 0.173385

Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.363, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]          Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.363, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]Epoch 16:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.363, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]Epoch 16:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0074, Train/loss_recog_step=0.378, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]Epoch 16:  32%|███▏      | 100/313 [02:13<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0074, Train/loss_recog_step=0.378, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]Epoch 16:  32%|███▏      | 100/313 [02:13<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.332, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337] Epoch 16:  48%|████▊     | 150/313 [03:15<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.332, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]Epoch 16:  48%|████▊     | 150/313 [03:15<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.338, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]Epoch 16:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.338, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]Epoch 16:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00621, Train/loss_recog_step=0.311, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]Epoch 16:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00621, Train/loss_recog_step=0.311, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]Epoch 16:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.00268, Train/loss_recog_step=0.305, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]Epoch 16:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.00268, Train/loss_recog_step=0.305, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]Epoch 16:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.00565, Train/loss_recog_step=0.314, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]Epoch 16: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.00565, Train/loss_recog_step=0.314, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]Epoch 16: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000164, Train/loss_recog_step=0.388, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.081, Valid/loss_recog_step=0.336, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.716, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.06it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.88it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.81it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.41it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195328, 0.197803, 0.194695, 0.219068
Valid average loss UNet                 (all)                : 0.806894

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.075888, 1.092395, 2.364720
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.336021, 1.476269, 1.735427
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.204872, 1.362790, 1.683970
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.105284, 1.410368, 2.366385
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.117797, 1.661998, 2.240037
Valid average loss all      (Triplet)                 : 0.161665

== Recognize ==
Valid average loss Recognize     : 0.359816
Valid average accuracy drums     : 97.000000 %
Valid average accuracy bass      : 95.500000 %
Valid average accuracy piano     : 95.000000 %
Valid average accuracy guitar    : 92.000000 %
Valid average accuracy residuals : 93.000000 %

== Valid average loss all : 0.341573

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.807274103164673 sec. =
Valid knn accuracy drums     : 85.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.691164016723633 sec. =
Valid knn accuracy bass      : 47.58064516129033%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.622435808181763 sec. =
Valid knn accuracy piano     : 66.2109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.190789222717285 sec. =
Valid knn accuracy guitar    : 72.76785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.303663730621338 sec. =
Valid knn accuracy residuals : 85.0%

Valid knn accuracy average   : 71.3118879608295%

                                                                      [AEpoch 16: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000164, Train/loss_recog_step=0.388, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00485, Train/loss_recog_epoch=0.337]Epoch 16: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000164, Train/loss_recog_step=0.388, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198512, 0.198984, 0.198970, 0.218682
Train average loss UNet                 (all)                : 0.815148

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002376, 1.034160, 2.486924
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007158, 1.105243, 1.796832
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003781, 1.239591, 1.986571
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003962, 1.212053, 2.064181
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003247, 1.544728, 2.474623
Train average loss all      (Triplet)                 : 0.004118

== Recognize ==
Train average loss Recognize     : 0.330983
Train average accuracy drums     : 99.040001 %
Train average accuracy bass      : 93.480003 %
Train average accuracy piano     : 89.754997 %
Train average accuracy guitar    : 91.729996 %
Train average accuracy residuals : 96.279999 %

== Train average loss all : 0.169609

Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000164, Train/loss_recog_step=0.388, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]          Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000164, Train/loss_recog_step=0.388, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]Epoch 17:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000164, Train/loss_recog_step=0.388, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]Epoch 17:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.000132, Train/loss_recog_step=0.359, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]Epoch 17:  32%|███▏      | 100/313 [02:11<04:40,  0.76it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.000132, Train/loss_recog_step=0.359, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]Epoch 17:  32%|███▏      | 100/313 [02:11<04:40,  0.76it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0015, Train/loss_recog_step=0.344, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]  Epoch 17:  48%|████▊     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0015, Train/loss_recog_step=0.344, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]Epoch 17:  48%|████▊     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=0.328, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]Epoch 17:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=0.328, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]Epoch 17:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00013, Train/loss_recog_step=0.324, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]Epoch 17:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00013, Train/loss_recog_step=0.324, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]Epoch 17:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00359, Train/loss_recog_step=0.286, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]Epoch 17:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00359, Train/loss_recog_step=0.286, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]Epoch 17:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.305, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]Epoch 17: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.305, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]Epoch 17: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.00232, Train/loss_recog_step=0.380, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.0644, Valid/loss_recog_step=0.330, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.360, Valid/knn_avr=0.713, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.26it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.78it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.81it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.16it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.98it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195302, 0.197705, 0.194767, 0.219958
Valid average loss UNet                 (all)                : 0.807732

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077201, 1.091480, 2.474225
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.337197, 1.385883, 1.575457
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.210546, 1.384761, 1.634592
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.094291, 1.341265, 2.265774
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.121449, 1.632470, 2.289847
Valid average loss all      (Triplet)                 : 0.161960

== Recognize ==
Valid average loss Recognize     : 0.370001
Valid average accuracy drums     : 97.500000 %
Valid average accuracy bass      : 91.500000 %
Valid average accuracy piano     : 94.000000 %
Valid average accuracy guitar    : 90.500000 %
Valid average accuracy residuals : 92.500000 %

== Valid average loss all : 0.346961

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.616014242172241 sec. =
Valid knn accuracy drums     : 86.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.713841915130615 sec. =
Valid knn accuracy bass      : 39.91935483870967%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.624167442321777 sec. =
Valid knn accuracy piano     : 63.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.876222372055054 sec. =
Valid knn accuracy guitar    : 74.77678571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.539155960083008 sec. =
Valid knn accuracy residuals : 87.04545454545455%

Valid knn accuracy average   : 70.38704184577695%

                                                                      [AEpoch 17: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.00232, Train/loss_recog_step=0.380, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00412, Train/loss_recog_epoch=0.331]Epoch 17: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.00232, Train/loss_recog_step=0.380, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198526, 0.199010, 0.198986, 0.219241
Train average loss UNet                 (all)                : 0.815762

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003038, 1.044346, 2.498992
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005794, 1.110909, 1.818567
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004656, 1.241176, 1.995523
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003678, 1.219980, 2.098120
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003249, 1.551462, 2.497614
Train average loss all      (Triplet)                 : 0.004191

== Recognize ==
Train average loss Recognize     : 0.326179
Train average accuracy drums     : 99.059998 %
Train average accuracy bass      : 93.669998 %
Train average accuracy piano     : 90.205002 %
Train average accuracy guitar    : 91.750000 %
Train average accuracy residuals : 96.345001 %

== Train average loss all : 0.167281

Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.00232, Train/loss_recog_step=0.380, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326]          Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.00232, Train/loss_recog_step=0.380, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326]Epoch 18:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.00232, Train/loss_recog_step=0.380, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326]Epoch 18:  16%|█▌        | 50/313 [01:09<06:06,  0.72it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00341, Train/loss_recog_step=0.356, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326]Epoch 18:  32%|███▏      | 100/313 [02:10<04:38,  0.76it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00341, Train/loss_recog_step=0.356, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326]Epoch 18:  32%|███▏      | 100/313 [02:10<04:38,  0.76it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000938, Train/loss_recog_step=0.315, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326]Epoch 18:  48%|████▊     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000938, Train/loss_recog_step=0.315, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326]Epoch 18:  48%|████▊     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.00185, Train/loss_recog_step=0.321, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326] Epoch 18:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.00185, Train/loss_recog_step=0.321, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326]Epoch 18:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00132, Train/loss_recog_step=0.305, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326]Epoch 18:  80%|███████▉  | 250/313 [05:14<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00132, Train/loss_recog_step=0.305, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326]Epoch 18:  80%|███████▉  | 250/313 [05:14<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=2.95e-6, Train/loss_recog_step=0.283, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326]Epoch 18:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=2.95e-6, Train/loss_recog_step=0.283, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326]Epoch 18:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.307, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326] Epoch 18: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.307, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326]Epoch 18: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.325, Valid/loss_all_step=0.254, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.0643, Valid/loss_recog_step=0.380, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.370, Valid/knn_avr=0.704, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.18it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.22it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.32it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.26it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.34it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195450, 0.197882, 0.194874, 0.215804
Valid average loss UNet                 (all)                : 0.804010

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.121594, 1.198393, 2.536292
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.384332, 1.444337, 1.720826
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.181194, 1.387920, 1.724396
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.113429, 1.463920, 2.455741
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.128621, 1.634275, 2.244879
Valid average loss all      (Triplet)                 : 0.184090

== Recognize ==
Valid average loss Recognize     : 0.357486
Valid average accuracy drums     : 97.500000 %
Valid average accuracy bass      : 95.000000 %
Valid average accuracy piano     : 96.000000 %
Valid average accuracy guitar    : 90.000000 %
Valid average accuracy residuals : 92.500000 %

== Valid average loss all : 0.362833

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.438013553619385 sec. =
Valid knn accuracy drums     : 88.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.155169248580933 sec. =
Valid knn accuracy bass      : 39.516129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.73549485206604 sec. =
Valid knn accuracy piano     : 67.578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.872865676879883 sec. =
Valid knn accuracy guitar    : 72.09821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.02307391166687 sec. =
Valid knn accuracy residuals : 85.68181818181819%

Valid knn accuracy average   : 70.58355295213202%

                                                                      [AEpoch 18: 100%|██████████| 313/313 [07:58<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.325, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.326]Epoch 18: 100%|██████████| 313/313 [07:58<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.325, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198511, 0.198998, 0.198978, 0.219187
Train average loss UNet                 (all)                : 0.815673

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002543, 1.056433, 2.546021
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005925, 1.090869, 1.804620
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004249, 1.260766, 2.029182
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003494, 1.218596, 2.117210
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003239, 1.536214, 2.483871
Train average loss all      (Triplet)                 : 0.004011

== Recognize ==
Train average loss Recognize     : 0.321921
Train average accuracy drums     : 99.010002 %
Train average accuracy bass      : 93.559998 %
Train average accuracy piano     : 90.385002 %
Train average accuracy guitar    : 92.095001 %
Train average accuracy residuals : 96.480003 %

== Train average loss all : 0.164972

Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.325, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]          Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.325, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]Epoch 19:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.325, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]Epoch 19:  16%|█▌        | 50/313 [01:10<06:09,  0.71it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00354, Train/loss_recog_step=0.341, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]Epoch 19:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00354, Train/loss_recog_step=0.341, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]Epoch 19:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00632, Train/loss_recog_step=0.331, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]Epoch 19:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00632, Train/loss_recog_step=0.331, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]Epoch 19:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.863, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=0.339, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]Epoch 19:  64%|██████▍   | 200/313 [04:16<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.863, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=0.339, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]Epoch 19:  64%|██████▍   | 200/313 [04:16<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000857, Train/loss_recog_step=0.319, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]Epoch 19:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000857, Train/loss_recog_step=0.319, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]Epoch 19:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.286, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]   Epoch 19:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.286, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]Epoch 19:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0028, Train/loss_recog_step=0.276, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]Epoch 19: 100%|██████████| 313/313 [06:33<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0028, Train/loss_recog_step=0.276, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]Epoch 19: 100%|██████████| 313/313 [06:33<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00677, Train/loss_recog_step=0.302, Valid/loss_all_step=0.259, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=0.353, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.706, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.36it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.00it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.20it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.71it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.58it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195471, 0.197919, 0.194947, 0.214263
Valid average loss UNet                 (all)                : 0.802602

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077408, 1.121264, 2.426695
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.322116, 1.416693, 1.686243
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.199436, 1.522037, 1.773576
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.099576, 1.415672, 2.515663
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.139298, 1.562897, 2.093953
Valid average loss all      (Triplet)                 : 0.169338

== Recognize ==
Valid average loss Recognize     : 0.354998
Valid average accuracy drums     : 99.000000 %
Valid average accuracy bass      : 93.500000 %
Valid average accuracy piano     : 88.500000 %
Valid average accuracy guitar    : 88.500000 %
Valid average accuracy residuals : 93.000000 %

== Valid average loss all : 0.346837

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.46143364906311 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.134827136993408 sec. =
Valid knn accuracy bass      : 46.57258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.677046775817871 sec. =
Valid knn accuracy piano     : 61.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.291030883789062 sec. =
Valid knn accuracy guitar    : 73.88392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.868515253067017 sec. =
Valid knn accuracy residuals : 85.9090909090909%

Valid knn accuracy average   : 70.84750861209267%

                                                                      [AEpoch 19: 100%|██████████| 313/313 [08:01<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00677, Train/loss_recog_step=0.302, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.322] Epoch 19: 100%|██████████| 313/313 [08:01<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00677, Train/loss_recog_step=0.302, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198482, 0.198968, 0.198948, 0.218986
Train average loss UNet                 (all)                : 0.815384

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002497, 1.035345, 2.506558
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005737, 1.135669, 1.874060
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004480, 1.254471, 2.036008
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003717, 1.208939, 2.104740
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003189, 1.548346, 2.504078
Train average loss all      (Triplet)                 : 0.003944

== Recognize ==
Train average loss Recognize     : 0.316307
Train average accuracy drums     : 99.005005 %
Train average accuracy bass      : 93.794998 %
Train average accuracy piano     : 90.154999 %
Train average accuracy guitar    : 91.705002 %
Train average accuracy residuals : 96.445000 %

== Train average loss all : 0.162098

Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00677, Train/loss_recog_step=0.302, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]          Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00677, Train/loss_recog_step=0.302, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]Epoch 20:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00677, Train/loss_recog_step=0.302, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]Epoch 20:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00933, Train/loss_recog_step=0.336, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]Epoch 20:  32%|███▏      | 100/313 [02:12<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00933, Train/loss_recog_step=0.336, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]Epoch 20:  32%|███▏      | 100/313 [02:12<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00025, Train/loss_recog_step=0.335, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]Epoch 20:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00025, Train/loss_recog_step=0.335, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]Epoch 20:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.000451, Train/loss_recog_step=0.316, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]Epoch 20:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.000451, Train/loss_recog_step=0.316, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]Epoch 20:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00215, Train/loss_recog_step=0.315, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316] Epoch 20:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00215, Train/loss_recog_step=0.315, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]Epoch 20:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.269, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]Epoch 20:  96%|█████████▌| 300/313 [06:19<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.269, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]Epoch 20:  96%|█████████▌| 300/313 [06:19<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=0.299, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]Epoch 20: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=0.299, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]Epoch 20: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.339, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.723, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=0.334, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.355, Valid/knn_avr=0.708, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.33it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.74it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.89it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.09it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.58it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195653, 0.197984, 0.195150, 0.224353
Valid average loss UNet                 (all)                : 0.813139

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.071336, 1.171528, 2.499267
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.379078, 1.433776, 1.714116
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.241953, 1.404562, 1.654708
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.151897, 1.446017, 2.375325
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.176938, 1.734533, 2.221559
Valid average loss all      (Triplet)                 : 0.202280

== Recognize ==
Valid average loss Recognize     : 0.356543
Valid average accuracy drums     : 99.000000 %
Valid average accuracy bass      : 96.000000 %
Valid average accuracy piano     : 95.500000 %
Valid average accuracy guitar    : 95.500000 %
Valid average accuracy residuals : 92.500000 %

== Valid average loss all : 0.380552

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.585764408111572 sec. =
Valid knn accuracy drums     : 88.91304347826086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.120147228240967 sec. =
Valid knn accuracy bass      : 39.11290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.473674297332764 sec. =
Valid knn accuracy piano     : 66.2109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.446730613708496 sec. =
Valid knn accuracy guitar    : 69.41964285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.173045873641968 sec. =
Valid knn accuracy residuals : 84.0909090909091%

Valid knn accuracy average   : 69.54948723042385%

                                                                      [AEpoch 20: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.339, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00394, Train/loss_recog_epoch=0.316]Epoch 20: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.339, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198508, 0.198981, 0.198966, 0.217706
Train average loss UNet                 (all)                : 0.814161

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003473, 1.045032, 2.515530
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006281, 1.152857, 1.919396
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004505, 1.260984, 2.052093
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003447, 1.220570, 2.138635
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003112, 1.542988, 2.520574
Train average loss all      (Triplet)                 : 0.004193

== Recognize ==
Train average loss Recognize     : 0.311376
Train average accuracy drums     : 99.010002 %
Train average accuracy bass      : 93.945000 %
Train average accuracy piano     : 90.570000 %
Train average accuracy guitar    : 91.845001 %
Train average accuracy residuals : 96.595001 %

== Train average loss all : 0.159881

Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.339, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]          Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.339, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]Epoch 21:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.339, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]Epoch 21:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00549, Train/loss_recog_step=0.331, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]Epoch 21:  32%|███▏      | 100/313 [02:14<04:47,  0.74it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00549, Train/loss_recog_step=0.331, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]Epoch 21:  32%|███▏      | 100/313 [02:14<04:47,  0.74it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00493, Train/loss_recog_step=0.344, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]Epoch 21:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00493, Train/loss_recog_step=0.344, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]Epoch 21:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.328, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]  Epoch 21:  64%|██████▍   | 200/313 [04:14<02:23,  0.78it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.328, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]Epoch 21:  64%|██████▍   | 200/313 [04:14<02:23,  0.78it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.340, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]Epoch 21:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.340, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]Epoch 21:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=0.272, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]Epoch 21:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=0.272, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]Epoch 21:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.301, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311] Epoch 21: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.301, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]Epoch 21: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00568, Train/loss_recog_step=0.330, Valid/loss_all_step=0.341, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.394, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.357, Valid/knn_avr=0.695, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.13it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.71it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.82it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.16it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.70it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195169, 0.197732, 0.194591, 0.220181
Valid average loss UNet                 (all)                : 0.807674

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.054047, 1.138682, 2.482868
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.324522, 1.364128, 1.566191
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.221094, 1.495665, 1.752532
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.121367, 1.414526, 2.453099
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.143859, 1.423847, 1.936652
Valid average loss all      (Triplet)                 : 0.174983

== Recognize ==
Valid average loss Recognize     : 0.348720
Valid average accuracy drums     : 98.500000 %
Valid average accuracy bass      : 91.500000 %
Valid average accuracy piano     : 91.500000 %
Valid average accuracy guitar    : 93.500000 %
Valid average accuracy residuals : 94.000000 %

== Valid average loss all : 0.349343

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.339579820632935 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.482985973358154 sec. =
Valid knn accuracy bass      : 43.95161290322581%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.382283449172974 sec. =
Valid knn accuracy piano     : 59.1796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.623618841171265 sec. =
Valid knn accuracy guitar    : 77.67857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.120041847229004 sec. =
Valid knn accuracy residuals : 85.9090909090909%

Valid knn accuracy average   : 70.56118385252546%

                                                                      [AEpoch 21: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00568, Train/loss_recog_step=0.330, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.160, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00419, Train/loss_recog_epoch=0.311]Epoch 21: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00568, Train/loss_recog_step=0.330, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198529, 0.199006, 0.198984, 0.218974
Train average loss UNet                 (all)                : 0.815492

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002404, 1.031577, 2.527091
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006554, 1.135611, 1.897997
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003658, 1.254339, 2.054740
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002659, 1.201399, 2.116427
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003779, 1.523514, 2.495578
Train average loss all      (Triplet)                 : 0.003844

== Recognize ==
Train average loss Recognize     : 0.309297
Train average accuracy drums     : 99.110001 %
Train average accuracy bass      : 93.754997 %
Train average accuracy piano     : 90.270004 %
Train average accuracy guitar    : 92.005005 %
Train average accuracy residuals : 96.235001 %

== Train average loss all : 0.158492

Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00568, Train/loss_recog_step=0.330, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]          Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00568, Train/loss_recog_step=0.330, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]Epoch 22:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00568, Train/loss_recog_step=0.330, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]Epoch 22:  16%|█▌        | 50/313 [01:09<06:05,  0.72it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=5.26e-5, Train/loss_recog_step=0.347, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]Epoch 22:  32%|███▏      | 100/313 [02:10<04:38,  0.76it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=5.26e-5, Train/loss_recog_step=0.347, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]Epoch 22:  32%|███▏      | 100/313 [02:10<04:38,  0.76it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00177, Train/loss_recog_step=0.311, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]Epoch 22:  48%|████▊     | 150/313 [03:12<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00177, Train/loss_recog_step=0.311, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]Epoch 22:  48%|████▊     | 150/313 [03:12<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.00255, Train/loss_recog_step=0.311, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]Epoch 22:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.00255, Train/loss_recog_step=0.311, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]Epoch 22:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000558, Train/loss_recog_step=0.309, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]Epoch 22:  80%|███████▉  | 250/313 [05:13<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000558, Train/loss_recog_step=0.309, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]Epoch 22:  80%|███████▉  | 250/313 [05:13<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00807, Train/loss_recog_step=0.260, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309] Epoch 22:  96%|█████████▌| 300/313 [06:17<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00807, Train/loss_recog_step=0.260, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]Epoch 22:  96%|█████████▌| 300/313 [06:17<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=1.92e-5, Train/loss_recog_step=0.266, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]Epoch 22: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=1.92e-5, Train/loss_recog_step=0.266, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]Epoch 22: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.272, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=0.319, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.175, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.706, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.38it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.35it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.63it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195346, 0.197747, 0.194808, 0.215243
Valid average loss UNet                 (all)                : 0.803144

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.132041, 1.370832, 2.676478
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.366201, 1.396164, 1.642485
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.204335, 1.517728, 1.764772
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.131890, 1.374460, 2.436535
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.111728, 1.490532, 2.068295
Valid average loss all      (Triplet)                 : 0.190458

== Recognize ==
Valid average loss Recognize     : 0.357607
Valid average accuracy drums     : 97.500000 %
Valid average accuracy bass      : 94.500000 %
Valid average accuracy piano     : 87.500000 %
Valid average accuracy guitar    : 90.000000 %
Valid average accuracy residuals : 93.000000 %

== Valid average loss all : 0.369261

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.311883211135864 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.693677186965942 sec. =
Valid knn accuracy bass      : 46.16935483870967%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.591546535491943 sec. =
Valid knn accuracy piano     : 60.3515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.35665249824524 sec. =
Valid knn accuracy guitar    : 70.08928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.286821365356445 sec. =
Valid knn accuracy residuals : 83.86363636363636%

Valid knn accuracy average   : 68.70346353550026%

                                                                      [AEpoch 22: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.272, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.309]Epoch 22: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.272, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198431, 0.198920, 0.198895, 0.219772
Train average loss UNet                 (all)                : 0.816018

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003168, 1.053950, 2.583815
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006668, 1.170221, 1.954722
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004024, 1.272741, 2.085872
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003345, 1.232559, 2.184400
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002766, 1.550895, 2.550323
Train average loss all      (Triplet)                 : 0.004053

== Recognize ==
Train average loss Recognize     : 0.305778
Train average accuracy drums     : 99.190002 %
Train average accuracy bass      : 93.989998 %
Train average accuracy piano     : 90.940002 %
Train average accuracy guitar    : 92.259995 %
Train average accuracy residuals : 96.350006 %

== Train average loss all : 0.156942

Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.272, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]          Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.272, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]Epoch 23:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.272, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]Epoch 23:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=0.343, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]Epoch 23:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=0.343, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]Epoch 23:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000345, Train/loss_recog_step=0.306, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]Epoch 23:  48%|████▊     | 150/313 [03:13<03:30,  0.78it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000345, Train/loss_recog_step=0.306, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]Epoch 23:  48%|████▊     | 150/313 [03:13<03:30,  0.78it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.301, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]   Epoch 23:  64%|██████▍   | 200/313 [04:17<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.301, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]Epoch 23:  64%|██████▍   | 200/313 [04:17<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.00163, Train/loss_recog_step=0.307, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]Epoch 23:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.00163, Train/loss_recog_step=0.307, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]Epoch 23:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00356, Train/loss_recog_step=0.266, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]Epoch 23:  96%|█████████▌| 300/313 [06:18<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00356, Train/loss_recog_step=0.266, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]Epoch 23:  96%|█████████▌| 300/313 [06:18<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00245, Train/loss_recog_step=0.284, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]Epoch 23: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00245, Train/loss_recog_step=0.284, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]Epoch 23: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.321, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.376, Valid/loss_all_epoch=0.369, Valid/loss_unet_all_epoch=0.803, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.358, Valid/knn_avr=0.687, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.30it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.83it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.03it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.25it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.42it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195371, 0.197801, 0.194833, 0.219750
Valid average loss UNet                 (all)                : 0.807756

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067576, 1.081232, 2.515122
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.303966, 1.361539, 1.618640
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.275221, 1.597555, 1.773604
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.130020, 1.371673, 2.384423
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.127465, 1.477178, 2.029520
Valid average loss all      (Triplet)                 : 0.187683

== Recognize ==
Valid average loss Recognize     : 0.333597
Valid average accuracy drums     : 98.500000 %
Valid average accuracy bass      : 97.000000 %
Valid average accuracy piano     : 89.500000 %
Valid average accuracy guitar    : 93.000000 %
Valid average accuracy residuals : 97.000000 %

== Valid average loss all : 0.354481

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.182116508483887 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.11784029006958 sec. =
Valid knn accuracy bass      : 44.354838709677416%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.68052077293396 sec. =
Valid knn accuracy piano     : 61.5234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.15470027923584 sec. =
Valid knn accuracy guitar    : 70.75892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.19458270072937 sec. =
Valid knn accuracy residuals : 85.68181818181819%

Valid knn accuracy average   : 69.68119589693266%

                                                                      [AEpoch 23: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.321, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00405, Train/loss_recog_epoch=0.306]Epoch 23: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.321, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198462, 0.198953, 0.198924, 0.218332
Train average loss UNet                 (all)                : 0.814672

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002557, 1.007146, 2.489917
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005541, 1.167077, 1.964993
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003746, 1.269195, 2.094783
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003411, 1.222126, 2.176966
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003071, 1.533687, 2.536942
Train average loss all      (Triplet)                 : 0.003708

== Recognize ==
Train average loss Recognize     : 0.300448
Train average accuracy drums     : 99.225006 %
Train average accuracy bass      : 93.870003 %
Train average accuracy piano     : 90.934998 %
Train average accuracy guitar    : 92.185005 %
Train average accuracy residuals : 96.590004 %

== Train average loss all : 0.153932

Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.321, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]          Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.321, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]Epoch 24:  16%|█▌        | 50/313 [01:11<06:18,  0.69it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.321, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]Epoch 24:  16%|█▌        | 50/313 [01:11<06:18,  0.69it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00462, Train/loss_recog_step=0.332, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]Epoch 24:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00462, Train/loss_recog_step=0.332, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]Epoch 24:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00477, Train/loss_recog_step=0.336, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]Epoch 24:  48%|████▊     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00477, Train/loss_recog_step=0.336, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]Epoch 24:  48%|████▊     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.000913, Train/loss_recog_step=0.339, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]Epoch 24:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.000913, Train/loss_recog_step=0.339, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]Epoch 24:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.302, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]   Epoch 24:  80%|███████▉  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.302, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]Epoch 24:  80%|███████▉  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00215, Train/loss_recog_step=0.257, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]Epoch 24:  96%|█████████▌| 300/313 [06:13<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00215, Train/loss_recog_step=0.257, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]Epoch 24:  96%|█████████▌| 300/313 [06:13<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000611, Train/loss_recog_step=0.269, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]Epoch 24: 100%|██████████| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000611, Train/loss_recog_step=0.269, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]Epoch 24: 100%|██████████| 313/313 [06:26<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.277, Valid/loss_all_step=0.323, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=0.317, Valid/loss_all_epoch=0.354, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.697, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.12it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.20it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.79it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.67it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195321, 0.197741, 0.194797, 0.218179
Valid average loss UNet                 (all)                : 0.806037

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.095825, 1.252581, 2.504748
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.393035, 1.558222, 1.813588
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.300343, 1.555776, 1.813280
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.122500, 1.479862, 2.594522
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.195389, 1.720202, 2.331443
Valid average loss all      (Triplet)                 : 0.233543

== Recognize ==
Valid average loss Recognize     : 0.334275
Valid average accuracy drums     : 99.000000 %
Valid average accuracy bass      : 93.500000 %
Valid average accuracy piano     : 93.000000 %
Valid average accuracy guitar    : 89.500000 %
Valid average accuracy residuals : 97.000000 %

== Valid average loss all : 0.400680

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.232969045639038 sec. =
Valid knn accuracy drums     : 83.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.39901089668274 sec. =
Valid knn accuracy bass      : 43.145161290322584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.335980415344238 sec. =
Valid knn accuracy piano     : 59.1796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.207399606704712 sec. =
Valid knn accuracy guitar    : 72.32142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.220124006271362 sec. =
Valid knn accuracy residuals : 86.13636363636363%

Valid knn accuracy average   : 68.89565863440556%

                                                                      [AEpoch 24: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.277, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.300]Epoch 24: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.277, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198477, 0.198955, 0.198931, 0.218817
Train average loss UNet                 (all)                : 0.815180

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002242, 1.008500, 2.503685
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003913, 1.159801, 1.971859
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004179, 1.274500, 2.116474
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003831, 1.224978, 2.178977
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002487, 1.538745, 2.554275
Train average loss all      (Triplet)                 : 0.003336

== Recognize ==
Train average loss Recognize     : 0.298850
Train average accuracy drums     : 99.070000 %
Train average accuracy bass      : 94.014999 %
Train average accuracy piano     : 90.474998 %
Train average accuracy guitar    : 92.040001 %
Train average accuracy residuals : 96.195000 %

== Train average loss all : 0.152761

Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.277, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]          Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.277, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]Epoch 25:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.277, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]Epoch 25:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=4.1e-5, Train/loss_recog_step=0.320, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]Epoch 25:  32%|███▏      | 100/313 [02:14<04:45,  0.75it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=4.1e-5, Train/loss_recog_step=0.320, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]Epoch 25:  32%|███▏      | 100/313 [02:14<04:45,  0.75it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.00118, Train/loss_recog_step=0.310, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]Epoch 25:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.00118, Train/loss_recog_step=0.310, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]Epoch 25:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.868, Train/loss_triplet_all_step=0.000566, Train/loss_recog_step=0.363, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]Epoch 25:  64%|██████▍   | 200/313 [04:19<02:26,  0.77it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.868, Train/loss_triplet_all_step=0.000566, Train/loss_recog_step=0.363, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]Epoch 25:  64%|██████▍   | 200/313 [04:19<02:26,  0.77it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00521, Train/loss_recog_step=0.304, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299] Epoch 25:  80%|███████▉  | 250/313 [05:20<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00521, Train/loss_recog_step=0.304, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]Epoch 25:  80%|███████▉  | 250/313 [05:20<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00707, Train/loss_recog_step=0.233, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]Epoch 25:  96%|█████████▌| 300/313 [06:22<00:16,  0.78it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00707, Train/loss_recog_step=0.233, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]Epoch 25:  96%|█████████▌| 300/313 [06:22<00:16,  0.78it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.265, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]Epoch 25: 100%|██████████| 313/313 [06:35<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.265, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]Epoch 25: 100%|██████████| 313/313 [06:35<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=0.302, Valid/loss_all_step=0.354, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.328, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.85it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.64it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195480, 0.197901, 0.194981, 0.220805
Valid average loss UNet                 (all)                : 0.809167

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.104807, 1.247608, 2.524688
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.344022, 1.279410, 1.499134
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.353427, 1.676427, 1.808129
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.157734, 1.397965, 2.439416
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.188610, 1.456334, 2.056937
Valid average loss all      (Triplet)                 : 0.255882

== Recognize ==
Valid average loss Recognize     : 0.334427
Valid average accuracy drums     : 95.000000 %
Valid average accuracy bass      : 96.000000 %
Valid average accuracy piano     : 88.000000 %
Valid average accuracy guitar    : 93.000000 %
Valid average accuracy residuals : 96.500000 %

== Valid average loss all : 0.423095

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.622540950775146 sec. =
Valid knn accuracy drums     : 84.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.385584354400635 sec. =
Valid knn accuracy bass      : 45.96774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.521892309188843 sec. =
Valid knn accuracy piano     : 57.8125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.869497776031494 sec. =
Valid knn accuracy guitar    : 72.76785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.859904527664185 sec. =
Valid knn accuracy residuals : 83.4090909090909%

Valid knn accuracy average   : 68.94795973661681%

                                                                      [AEpoch 25: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=0.302, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=0.299]Epoch 25: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=0.302, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198469, 0.198956, 0.198934, 0.218899
Train average loss UNet                 (all)                : 0.815258

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003000, 0.989946, 2.490953
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004916, 1.147414, 1.954715
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003847, 1.272302, 2.113383
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002709, 1.227062, 2.200577
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003402, 1.520750, 2.527850
Train average loss all      (Triplet)                 : 0.003613

== Recognize ==
Train average loss Recognize     : 0.293969
Train average accuracy drums     : 99.165001 %
Train average accuracy bass      : 94.424995 %
Train average accuracy piano     : 90.385002 %
Train average accuracy guitar    : 92.400002 %
Train average accuracy residuals : 96.695000 %

== Train average loss all : 0.150597

Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=0.302, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]          Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=0.302, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]Epoch 26:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=0.302, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]Epoch 26:  16%|█▌        | 50/313 [01:10<06:08,  0.71it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00349, Train/loss_recog_step=0.343, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]Epoch 26:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00349, Train/loss_recog_step=0.343, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]Epoch 26:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00191, Train/loss_recog_step=0.281, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]Epoch 26:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00191, Train/loss_recog_step=0.281, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]Epoch 26:  48%|████▊     | 150/313 [03:09<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=0.292, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]Epoch 26:  64%|██████▍   | 200/313 [04:11<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=0.292, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]Epoch 26:  64%|██████▍   | 200/313 [04:11<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00255, Train/loss_recog_step=0.313, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]Epoch 26:  80%|███████▉  | 250/313 [05:11<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00255, Train/loss_recog_step=0.313, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]Epoch 26:  80%|███████▉  | 250/313 [05:11<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00376, Train/loss_recog_step=0.245, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]Epoch 26:  96%|█████████▌| 300/313 [06:11<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00376, Train/loss_recog_step=0.245, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]Epoch 26:  96%|█████████▌| 300/313 [06:11<00:16,  0.81it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.278, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]  Epoch 26: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.278, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]Epoch 26: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=0.319, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=0.308, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.256, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.689, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.22it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.91it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.74it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195520, 0.197794, 0.195076, 0.234443
Valid average loss UNet                 (all)                : 0.822833

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.102446, 1.255664, 2.722437
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.341078, 1.485763, 1.776759
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.288878, 1.506032, 1.736815
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.122826, 1.390120, 2.444121
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.163043, 1.659891, 2.182385
Valid average loss all      (Triplet)                 : 0.206852

== Recognize ==
Valid average loss Recognize     : 0.342062
Valid average accuracy drums     : 97.500000 %
Valid average accuracy bass      : 94.500000 %
Valid average accuracy piano     : 92.000000 %
Valid average accuracy guitar    : 90.500000 %
Valid average accuracy residuals : 95.500000 %

== Valid average loss all : 0.377883

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.374347448348999 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.333789825439453 sec. =
Valid knn accuracy bass      : 43.346774193548384%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.297749042510986 sec. =
Valid knn accuracy piano     : 64.2578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.386638879776001 sec. =
Valid knn accuracy guitar    : 73.88392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.237419128417969 sec. =
Valid knn accuracy residuals : 83.18181818181817%

Valid knn accuracy average   : 69.80363190675034%

                                                                      [AEpoch 26: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=0.319, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.294]Epoch 26: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=0.319, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198489, 0.198969, 0.198946, 0.218842
Train average loss UNet                 (all)                : 0.815246

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002447, 1.014964, 2.529458
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006327, 1.164686, 1.976023
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002949, 1.286613, 2.156005
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004022, 1.234208, 2.225394
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003008, 1.531987, 2.560746
Train average loss all      (Triplet)                 : 0.003776

== Recognize ==
Train average loss Recognize     : 0.291675
Train average accuracy drums     : 99.220001 %
Train average accuracy bass      : 94.514999 %
Train average accuracy piano     : 90.684998 %
Train average accuracy guitar    : 92.279999 %
Train average accuracy residuals : 96.445000 %

== Train average loss all : 0.149613

Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=0.319, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]          Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=0.319, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]Epoch 27:  16%|█▌        | 50/313 [01:11<06:13,  0.70it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=0.319, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]Epoch 27:  16%|█▌        | 50/313 [01:11<06:13,  0.70it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.310, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]Epoch 27:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.310, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]Epoch 27:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.306, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]  Epoch 27:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.306, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]Epoch 27:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.00425, Train/loss_recog_step=0.287, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]Epoch 27:  64%|██████▍   | 200/313 [04:16<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.00425, Train/loss_recog_step=0.287, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]Epoch 27:  64%|██████▍   | 200/313 [04:16<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000605, Train/loss_recog_step=0.275, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]Epoch 27:  80%|███████▉  | 250/313 [05:18<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000605, Train/loss_recog_step=0.275, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]Epoch 27:  80%|███████▉  | 250/313 [05:18<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.245, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292] Epoch 27:  96%|█████████▌| 300/313 [06:19<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.245, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]Epoch 27:  96%|█████████▌| 300/313 [06:19<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00961, Train/loss_recog_step=0.267, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]Epoch 27: 100%|██████████| 313/313 [06:34<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00961, Train/loss_recog_step=0.267, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]Epoch 27: 100%|██████████| 313/313 [06:34<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.311, Valid/loss_all_step=0.306, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.354, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.342, Valid/knn_avr=0.698, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.39it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.99it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.28it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195226, 0.197623, 0.194713, 0.225982
Valid average loss UNet                 (all)                : 0.813544

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.069892, 1.137372, 2.640815
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.386353, 1.385933, 1.590711
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.241733, 1.626521, 1.846293
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.097254, 1.354919, 2.496794
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.184008, 1.655194, 2.226182
Valid average loss all      (Triplet)                 : 0.199743

== Recognize ==
Valid average loss Recognize     : 0.344607
Valid average accuracy drums     : 98.000000 %
Valid average accuracy bass      : 96.000000 %
Valid average accuracy piano     : 84.500000 %
Valid average accuracy guitar    : 93.000000 %
Valid average accuracy residuals : 92.000000 %

== Valid average loss all : 0.372046

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.471045732498169 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.213557243347168 sec. =
Valid knn accuracy bass      : 41.33064516129033%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.520411968231201 sec. =
Valid knn accuracy piano     : 62.6953125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.493172407150269 sec. =
Valid knn accuracy guitar    : 76.33928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.906171798706055 sec. =
Valid knn accuracy residuals : 82.04545454545455%

Valid knn accuracy average   : 69.52561784507567%

                                                                      [AEpoch 27: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.311, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00378, Train/loss_recog_epoch=0.292]Epoch 27: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.311, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198402, 0.198886, 0.198858, 0.218697
Train average loss UNet                 (all)                : 0.814843

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002346, 1.012562, 2.545806
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005525, 1.178779, 2.012428
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004283, 1.286159, 2.152646
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002981, 1.246434, 2.257975
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002892, 1.541386, 2.582999
Train average loss all      (Triplet)                 : 0.003692

== Recognize ==
Train average loss Recognize     : 0.287031
Train average accuracy drums     : 99.255005 %
Train average accuracy bass      : 94.470001 %
Train average accuracy piano     : 90.690002 %
Train average accuracy guitar    : 92.699997 %
Train average accuracy residuals : 96.380005 %

== Train average loss all : 0.147208

Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.311, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]          Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.311, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]Epoch 28:  16%|█▌        | 50/313 [01:11<06:14,  0.70it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.311, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]Epoch 28:  16%|█▌        | 50/313 [01:11<06:14,  0.70it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.291, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]Epoch 28:  32%|███▏      | 100/313 [02:16<04:50,  0.73it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.291, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]Epoch 28:  32%|███▏      | 100/313 [02:16<04:50,  0.73it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.296, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]Epoch 28:  48%|████▊     | 150/313 [03:16<03:33,  0.76it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.296, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]Epoch 28:  48%|████▊     | 150/313 [03:16<03:33,  0.76it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=0.307, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]Epoch 28:  64%|██████▍   | 200/313 [04:17<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=0.307, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]Epoch 28:  64%|██████▍   | 200/313 [04:17<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000514, Train/loss_recog_step=0.323, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]Epoch 28:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000514, Train/loss_recog_step=0.323, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]Epoch 28:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00141, Train/loss_recog_step=0.236, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287] Epoch 28:  96%|█████████▌| 300/313 [06:18<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00141, Train/loss_recog_step=0.236, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]Epoch 28:  96%|█████████▌| 300/313 [06:18<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.239, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287] Epoch 28: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.239, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]Epoch 28: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=0.308, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=0.356, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.695, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.27it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.59it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.88it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.70it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.47it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195328, 0.197777, 0.194805, 0.221266
Valid average loss UNet                 (all)                : 0.809175

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083846, 1.091890, 2.520929
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.400131, 1.525252, 1.855484
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.302469, 1.629477, 1.821649
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.134876, 1.419513, 2.556762
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.181244, 1.544397, 2.123535
Valid average loss all      (Triplet)                 : 0.219836

== Recognize ==
Valid average loss Recognize     : 0.335028
Valid average accuracy drums     : 97.000000 %
Valid average accuracy bass      : 94.000000 %
Valid average accuracy piano     : 94.500000 %
Valid average accuracy guitar    : 94.500000 %
Valid average accuracy residuals : 94.500000 %

== Valid average loss all : 0.387350

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.580195188522339 sec. =
Valid knn accuracy drums     : 84.1304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.408926248550415 sec. =
Valid knn accuracy bass      : 42.54032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.492331743240356 sec. =
Valid knn accuracy piano     : 62.6953125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.527865648269653 sec. =
Valid knn accuracy guitar    : 72.54464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.178972721099854 sec. =
Valid knn accuracy residuals : 83.4090909090909%

Valid knn accuracy average   : 69.06396072589752%

                                                                      [AEpoch 28: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=0.308, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00369, Train/loss_recog_epoch=0.287]Epoch 28: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=0.308, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198408, 0.198895, 0.198878, 0.218737
Train average loss UNet                 (all)                : 0.814918

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001916, 0.986391, 2.484405
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004382, 1.150560, 1.986155
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003359, 1.284328, 2.155609
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003159, 1.246001, 2.283413
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002488, 1.535234, 2.597738
Train average loss all      (Triplet)                 : 0.003074

== Recognize ==
Train average loss Recognize     : 0.284944
Train average accuracy drums     : 99.119995 %
Train average accuracy bass      : 94.284996 %
Train average accuracy piano     : 90.535004 %
Train average accuracy guitar    : 92.119995 %
Train average accuracy residuals : 96.570000 %

== Train average loss all : 0.145546

Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=0.308, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]          Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=0.308, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]Epoch 29:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=0.308, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]Epoch 29:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00441, Train/loss_recog_step=0.301, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]Epoch 29:  32%|███▏      | 100/313 [02:15<04:48,  0.74it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00441, Train/loss_recog_step=0.301, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]Epoch 29:  32%|███▏      | 100/313 [02:15<04:48,  0.74it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000572, Train/loss_recog_step=0.284, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]Epoch 29:  48%|████▊     | 150/313 [03:17<03:34,  0.76it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000572, Train/loss_recog_step=0.284, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]Epoch 29:  48%|████▊     | 150/313 [03:17<03:34,  0.76it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=0.285, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285] Epoch 29:  64%|██████▍   | 200/313 [04:19<02:26,  0.77it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=0.285, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]Epoch 29:  64%|██████▍   | 200/313 [04:19<02:26,  0.77it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.257, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]  Epoch 29:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.257, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]Epoch 29:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00423, Train/loss_recog_step=0.229, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]Epoch 29:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00423, Train/loss_recog_step=0.229, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]Epoch 29:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00398, Train/loss_recog_step=0.253, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]Epoch 29: 100%|██████████| 313/313 [06:34<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00398, Train/loss_recog_step=0.253, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]Epoch 29: 100%|██████████| 313/313 [06:34<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00756, Train/loss_recog_step=0.305, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=0.340, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.335, Valid/knn_avr=0.691, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.26it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.44it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.56it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.67it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195269, 0.197647, 0.194758, 0.223214
Valid average loss UNet                 (all)                : 0.810888

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.111859, 1.298930, 2.559736
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.492826, 1.616141, 1.896833
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.284442, 1.424626, 1.746092
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.123560, 1.405038, 2.448313
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.243421, 1.875022, 2.419321
Valid average loss all      (Triplet)                 : 0.242894

== Recognize ==
Valid average loss Recognize     : 0.318080
Valid average accuracy drums     : 99.000000 %
Valid average accuracy bass      : 98.000000 %
Valid average accuracy piano     : 93.500000 %
Valid average accuracy guitar    : 93.000000 %
Valid average accuracy residuals : 95.000000 %

== Valid average loss all : 0.401934

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.545158863067627 sec. =
Valid knn accuracy drums     : 82.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.127776861190796 sec. =
Valid knn accuracy bass      : 42.74193548387097%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.534358024597168 sec. =
Valid knn accuracy piano     : 61.328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.335012435913086 sec. =
Valid knn accuracy guitar    : 71.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.985408306121826 sec. =
Valid knn accuracy residuals : 83.4090909090909%

Valid knn accuracy average   : 68.43604766989672%

                                                                      [AEpoch 29: 100%|██████████| 313/313 [08:04<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00756, Train/loss_recog_step=0.305, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00307, Train/loss_recog_epoch=0.285]Epoch 29: 100%|██████████| 313/313 [08:04<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00756, Train/loss_recog_step=0.305, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198430, 0.198905, 0.198884, 0.219324
Train average loss UNet                 (all)                : 0.815543

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001934, 0.965678, 2.430902
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004930, 1.170121, 2.007098
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003934, 1.289977, 2.181466
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002546, 1.235338, 2.263093
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003126, 1.545201, 2.602292
Train average loss all      (Triplet)                 : 0.003346

== Recognize ==
Train average loss Recognize     : 0.283018
Train average accuracy drums     : 99.119995 %
Train average accuracy bass      : 94.279999 %
Train average accuracy piano     : 90.699997 %
Train average accuracy guitar    : 92.610001 %
Train average accuracy residuals : 96.440002 %

== Train average loss all : 0.144855

Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00756, Train/loss_recog_step=0.305, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]          Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00756, Train/loss_recog_step=0.305, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]Epoch 30:  16%|█▌        | 50/313 [01:12<06:23,  0.68it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00756, Train/loss_recog_step=0.305, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]Epoch 30:  16%|█▌        | 50/313 [01:12<06:23,  0.68it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=9.34e-5, Train/loss_recog_step=0.307, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]Epoch 30:  32%|███▏      | 100/313 [02:14<04:47,  0.74it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=9.34e-5, Train/loss_recog_step=0.307, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]Epoch 30:  32%|███▏      | 100/313 [02:14<04:47,  0.74it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.002, Train/loss_recog_step=0.283, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]  Epoch 30:  48%|████▊     | 150/313 [03:17<03:34,  0.76it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.002, Train/loss_recog_step=0.283, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]Epoch 30:  48%|████▊     | 150/313 [03:17<03:34,  0.76it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.287, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]Epoch 30:  64%|██████▍   | 200/313 [04:19<02:26,  0.77it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.287, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]Epoch 30:  64%|██████▍   | 200/313 [04:19<02:26,  0.77it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.279, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]Epoch 30:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.279, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]Epoch 30:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000107, Train/loss_recog_step=0.237, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]Epoch 30:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000107, Train/loss_recog_step=0.237, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]Epoch 30:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000463, Train/loss_recog_step=0.249, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]Epoch 30: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000463, Train/loss_recog_step=0.249, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283]Epoch 30: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00275, Train/loss_recog_step=0.318, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.0699, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.318, Valid/knn_avr=0.684, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.24it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.86it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.82it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.59it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.28it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195282, 0.197634, 0.194775, 0.227236
Valid average loss UNet                 (all)                : 0.814927

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.103529, 1.251672, 2.631159
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.395555, 1.540355, 1.778958
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.303685, 1.604876, 1.897895
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.142492, 1.493513, 2.600539
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.246209, 1.861298, 2.415291
Valid average loss all      (Triplet)                 : 0.237648

== Recognize ==
Valid average loss Recognize     : 0.317314
Valid average accuracy drums     : 98.000000 %
Valid average accuracy bass      : 95.500000 %
Valid average accuracy piano     : 93.000000 %
Valid average accuracy guitar    : 94.500000 %
Valid average accuracy residuals : 93.500000 %

== Valid average loss all : 0.396305

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.27928352355957 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.223169326782227 sec. =
Valid knn accuracy bass      : 40.32258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.771893739700317 sec. =
Valid knn accuracy piano     : 61.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.306777000427246 sec. =
Valid knn accuracy guitar    : 70.75892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.158036708831787 sec. =
Valid knn accuracy residuals : 82.95454545454545%

Valid knn accuracy average   : 67.64246908640096%

                                                                      [AEpoch 30: 100%|██████████| 313/313 [08:02<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00275, Train/loss_recog_step=0.318, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=0.283] Epoch 30: 100%|██████████| 313/313 [08:02<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00275, Train/loss_recog_step=0.318, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198375, 0.198852, 0.198822, 0.218986
Train average loss UNet                 (all)                : 0.815035

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001775, 0.950570, 2.457579
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004868, 1.162944, 1.997748
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004086, 1.301009, 2.191091
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002965, 1.237635, 2.268184
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003085, 1.538702, 2.610586
Train average loss all      (Triplet)                 : 0.003384

== Recognize ==
Train average loss Recognize     : 0.279264
Train average accuracy drums     : 99.180000 %
Train average accuracy bass      : 94.274994 %
Train average accuracy piano     : 90.684998 %
Train average accuracy guitar    : 92.229996 %
Train average accuracy residuals : 96.559998 %

== Train average loss all : 0.143016

Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00275, Train/loss_recog_step=0.318, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]          Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00275, Train/loss_recog_step=0.318, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]Epoch 31:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00275, Train/loss_recog_step=0.318, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]Epoch 31:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000537, Train/loss_recog_step=0.327, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]Epoch 31:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000537, Train/loss_recog_step=0.327, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]Epoch 31:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.00178, Train/loss_recog_step=0.309, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279] Epoch 31:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.00178, Train/loss_recog_step=0.309, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]Epoch 31:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.291, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]  Epoch 31:  64%|██████▍   | 200/313 [04:16<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.291, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]Epoch 31:  64%|██████▍   | 200/313 [04:16<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00422, Train/loss_recog_step=0.265, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]Epoch 31:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00422, Train/loss_recog_step=0.265, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]Epoch 31:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00594, Train/loss_recog_step=0.210, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]Epoch 31:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00594, Train/loss_recog_step=0.210, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]Epoch 31:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.255, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]  Epoch 31: 100%|██████████| 313/313 [06:34<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.255, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]Epoch 31: 100%|██████████| 313/313 [06:34<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00445, Train/loss_recog_step=0.317, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.279, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.238, Valid/loss_recog_epoch=0.317, Valid/knn_avr=0.676, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.36it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.32it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.14it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.03it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195270, 0.197697, 0.194752, 0.227475
Valid average loss UNet                 (all)                : 0.815195

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.072779, 1.025856, 2.248418
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.297953, 1.317429, 1.619194
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.323593, 1.686013, 1.836394
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.138180, 1.461002, 2.611256
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.190039, 1.485883, 2.068056
Valid average loss all      (Triplet)                 : 0.213078

== Recognize ==
Valid average loss Recognize     : 0.348578
Valid average accuracy drums     : 99.500000 %
Valid average accuracy bass      : 96.500000 %
Valid average accuracy piano     : 91.000000 %
Valid average accuracy guitar    : 88.000000 %
Valid average accuracy residuals : 93.500000 %

== Valid average loss all : 0.387367

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.466559171676636 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.14927053451538 sec. =
Valid knn accuracy bass      : 50.60483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.68352198600769 sec. =
Valid knn accuracy piano     : 63.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.289514541625977 sec. =
Valid knn accuracy guitar    : 72.32142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.150197267532349 sec. =
Valid knn accuracy residuals : 82.95454545454545%

Valid knn accuracy average   : 70.5192331993042%

                                                                      [AEpoch 31: 100%|██████████| 313/313 [08:02<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00445, Train/loss_recog_step=0.317, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=0.279]Epoch 31: 100%|██████████| 313/313 [08:02<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00445, Train/loss_recog_step=0.317, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198374, 0.198860, 0.198840, 0.217620
Train average loss UNet                 (all)                : 0.813694

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001842, 0.956723, 2.433957
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005042, 1.168344, 2.010015
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004077, 1.286781, 2.184520
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002126, 1.247718, 2.286157
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002920, 1.525225, 2.595837
Train average loss all      (Triplet)                 : 0.003264

== Recognize ==
Train average loss Recognize     : 0.273170
Train average accuracy drums     : 99.169998 %
Train average accuracy bass      : 94.544998 %
Train average accuracy piano     : 90.785004 %
Train average accuracy guitar    : 92.430000 %
Train average accuracy residuals : 96.470001 %

== Train average loss all : 0.139848

Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00445, Train/loss_recog_step=0.317, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]          Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00445, Train/loss_recog_step=0.317, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]Epoch 32:  16%|█▌        | 50/313 [01:11<06:15,  0.70it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00445, Train/loss_recog_step=0.317, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]Epoch 32:  16%|█▌        | 50/313 [01:11<06:15,  0.70it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=0.315, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]Epoch 32:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=0.315, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]Epoch 32:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00741, Train/loss_recog_step=0.299, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]Epoch 32:  48%|████▊     | 150/313 [03:16<03:33,  0.76it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00741, Train/loss_recog_step=0.299, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]Epoch 32:  48%|████▊     | 150/313 [03:16<03:33,  0.76it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=0.271, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]Epoch 32:  64%|██████▍   | 200/313 [04:17<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=0.271, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]Epoch 32:  64%|██████▍   | 200/313 [04:17<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.296, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]  Epoch 32:  80%|███████▉  | 250/313 [05:21<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.296, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]Epoch 32:  80%|███████▉  | 250/313 [05:21<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.218, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]Epoch 32:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.218, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]Epoch 32:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0177, Train/loss_recog_step=0.257, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]Epoch 32: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0177, Train/loss_recog_step=0.257, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]Epoch 32: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=0.351, Valid/loss_all_step=0.347, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.360, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.349, Valid/knn_avr=0.705, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.37it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.01it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.79it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.64it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195262, 0.197609, 0.194770, 0.223090
Valid average loss UNet                 (all)                : 0.810731

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.063732, 1.128360, 2.437387
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.378787, 1.503128, 1.806685
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.306944, 1.590788, 1.862153
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.127617, 1.439311, 2.613844
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.197755, 1.522158, 2.126364
Valid average loss all      (Triplet)                 : 0.218185

== Recognize ==
Valid average loss Recognize     : 0.310487
Valid average accuracy drums     : 98.500000 %
Valid average accuracy bass      : 97.500000 %
Valid average accuracy piano     : 92.000000 %
Valid average accuracy guitar    : 93.000000 %
Valid average accuracy residuals : 93.500000 %

== Valid average loss all : 0.373429

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.227533340454102 sec. =
Valid knn accuracy drums     : 81.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.215563774108887 sec. =
Valid knn accuracy bass      : 46.774193548387096%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.439082860946655 sec. =
Valid knn accuracy piano     : 57.421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.510245084762573 sec. =
Valid knn accuracy guitar    : 74.77678571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.207440614700317 sec. =
Valid knn accuracy residuals : 82.72727272727273%

Valid knn accuracy average   : 68.68785148494563%

                                                                      [AEpoch 32: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=0.351, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00326, Train/loss_recog_epoch=0.273]Epoch 32: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=0.351, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198338, 0.198827, 0.198799, 0.219477
Train average loss UNet                 (all)                : 0.815440

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001945, 0.933954, 2.378004
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004258, 1.170691, 2.023898
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003158, 1.287216, 2.201324
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004755, 1.243091, 2.279297
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002321, 1.525429, 2.605747
Train average loss all      (Triplet)                 : 0.003308

== Recognize ==
Train average loss Recognize     : 0.273499
Train average accuracy drums     : 99.220001 %
Train average accuracy bass      : 94.790001 %
Train average accuracy piano     : 91.105003 %
Train average accuracy guitar    : 92.180000 %
Train average accuracy residuals : 96.459999 %

== Train average loss all : 0.140057

Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=0.351, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]          Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=0.351, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]Epoch 33:  16%|█▌        | 50/313 [01:13<06:25,  0.68it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=0.351, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]Epoch 33:  16%|█▌        | 50/313 [01:13<06:25,  0.68it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00323, Train/loss_recog_step=0.295, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]Epoch 33:  32%|███▏      | 100/313 [02:14<04:45,  0.74it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00323, Train/loss_recog_step=0.295, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]Epoch 33:  32%|███▏      | 100/313 [02:14<04:45,  0.74it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.281, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]  Epoch 33:  48%|████▊     | 150/313 [03:12<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.281, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]Epoch 33:  48%|████▊     | 150/313 [03:12<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.266, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]Epoch 33:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.266, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]Epoch 33:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00262, Train/loss_recog_step=0.275, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]Epoch 33:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00262, Train/loss_recog_step=0.275, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]Epoch 33:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.223, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]  Epoch 33:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.223, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]Epoch 33:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=0.226, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]Epoch 33: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=0.226, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]Epoch 33: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.315, Valid/loss_all_step=0.284, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.278, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.687, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.33it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.66it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.03it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.39it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.24it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195303, 0.197687, 0.194813, 0.213944
Valid average loss UNet                 (all)                : 0.801746

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065845, 1.069239, 2.373917
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.378345, 1.574316, 1.978193
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.300035, 1.515257, 1.821785
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.171755, 1.514272, 2.581489
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.234714, 1.847884, 2.362456
Valid average loss all      (Triplet)                 : 0.229070

== Recognize ==
Valid average loss Recognize     : 0.333406
Valid average accuracy drums     : 98.500000 %
Valid average accuracy bass      : 93.000000 %
Valid average accuracy piano     : 95.500000 %
Valid average accuracy guitar    : 91.000000 %
Valid average accuracy residuals : 94.500000 %

== Valid average loss all : 0.395773

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.694920063018799 sec. =
Valid knn accuracy drums     : 80.43478260869566%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.243948698043823 sec. =
Valid knn accuracy bass      : 43.145161290322584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.51277470588684 sec. =
Valid knn accuracy piano     : 60.3515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.556061267852783 sec. =
Valid knn accuracy guitar    : 68.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.232774496078491 sec. =
Valid knn accuracy residuals : 82.5%

Valid knn accuracy average   : 67.03630127980364%

                                                                      [AEpoch 33: 100%|██████████| 313/313 [07:57<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.315, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=0.273]Epoch 33: 100%|██████████| 313/313 [07:57<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.315, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198371, 0.198846, 0.198817, 0.218021
Train average loss UNet                 (all)                : 0.814056

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001997, 0.933770, 2.391866
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005038, 1.168182, 2.017470
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003402, 1.307394, 2.233010
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003430, 1.264163, 2.326522
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002585, 1.526350, 2.605762
Train average loss all      (Triplet)                 : 0.003304

== Recognize ==
Train average loss Recognize     : 0.269668
Train average accuracy drums     : 99.185005 %
Train average accuracy bass      : 94.644997 %
Train average accuracy piano     : 91.135002 %
Train average accuracy guitar    : 92.629997 %
Train average accuracy residuals : 96.514999 %

== Train average loss all : 0.138138

Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.315, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]          Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.315, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]Epoch 34:  16%|█▌        | 50/313 [01:11<06:15,  0.70it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.315, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]Epoch 34:  16%|█▌        | 50/313 [01:11<06:15,  0.70it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.317, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]Epoch 34:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.317, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]Epoch 34:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.268, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]Epoch 34:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.268, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]Epoch 34:  48%|████▊     | 150/313 [03:14<03:31,  0.77it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.00199, Train/loss_recog_step=0.306, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]Epoch 34:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.00199, Train/loss_recog_step=0.306, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]Epoch 34:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00844, Train/loss_recog_step=0.283, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]Epoch 34:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00844, Train/loss_recog_step=0.283, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]Epoch 34:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00788, Train/loss_recog_step=0.204, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]Epoch 34:  96%|█████████▌| 300/313 [06:18<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00788, Train/loss_recog_step=0.204, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]Epoch 34:  96%|█████████▌| 300/313 [06:18<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.00145, Train/loss_recog_step=0.235, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]Epoch 34: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.00145, Train/loss_recog_step=0.235, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]Epoch 34: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.252, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=0.320, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.333, Valid/knn_avr=0.670, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.28it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.06it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.80it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.60it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.74it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195345, 0.197673, 0.194899, 0.219274
Valid average loss UNet                 (all)                : 0.807192

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.081921, 1.139349, 2.465100
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.321781, 1.341122, 1.618457
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.325440, 1.617821, 1.832307
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.126497, 1.456797, 2.646095
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.213076, 1.631048, 2.216835
Valid average loss all      (Triplet)                 : 0.212692

== Recognize ==
Valid average loss Recognize     : 0.323728
Valid average accuracy drums     : 98.000000 %
Valid average accuracy bass      : 96.500000 %
Valid average accuracy piano     : 90.500000 %
Valid average accuracy guitar    : 94.000000 %
Valid average accuracy residuals : 96.000000 %

== Valid average loss all : 0.374556

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.367470264434814 sec. =
Valid knn accuracy drums     : 79.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.577589750289917 sec. =
Valid knn accuracy bass      : 44.354838709677416%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.500791549682617 sec. =
Valid knn accuracy piano     : 64.453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.143207311630249 sec. =
Valid knn accuracy guitar    : 76.78571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.72472858428955 sec. =
Valid knn accuracy residuals : 80.22727272727272%

Valid knn accuracy average   : 69.0337553619242%

                                                                      [AEpoch 34: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.252, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.138, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.270]Epoch 34: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.252, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198370, 0.198864, 0.198837, 0.218231
Train average loss UNet                 (all)                : 0.814302

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001709, 0.946436, 2.419359
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004450, 1.175422, 2.040410
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003947, 1.295782, 2.233950
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002839, 1.269846, 2.354357
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003340, 1.540372, 2.636901
Train average loss all      (Triplet)                 : 0.003236

== Recognize ==
Train average loss Recognize     : 0.267269
Train average accuracy drums     : 99.295006 %
Train average accuracy bass      : 94.774994 %
Train average accuracy piano     : 90.729996 %
Train average accuracy guitar    : 92.415001 %
Train average accuracy residuals : 96.739998 %

== Train average loss all : 0.136870

Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.252, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]          Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.252, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]Epoch 35:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.252, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]Epoch 35:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.305, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]Epoch 35:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.305, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]Epoch 35:  32%|███▏      | 100/313 [02:13<04:44,  0.75it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.273, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]Epoch 35:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.273, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]Epoch 35:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.279, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267] Epoch 35:  64%|██████▍   | 200/313 [04:16<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.279, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]Epoch 35:  64%|██████▍   | 200/313 [04:16<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0024, Train/loss_recog_step=0.264, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]Epoch 35:  80%|███████▉  | 250/313 [05:18<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0024, Train/loss_recog_step=0.264, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]Epoch 35:  80%|███████▉  | 250/313 [05:18<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00262, Train/loss_recog_step=0.215, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]Epoch 35:  96%|█████████▌| 300/313 [06:23<00:16,  0.78it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00262, Train/loss_recog_step=0.215, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]Epoch 35:  96%|█████████▌| 300/313 [06:23<00:16,  0.78it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.00329, Train/loss_recog_step=0.233, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]Epoch 35: 100%|██████████| 313/313 [06:37<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.00329, Train/loss_recog_step=0.233, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]Epoch 35: 100%|██████████| 313/313 [06:37<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=0.290, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.321, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.324, Valid/knn_avr=0.690, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.36it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.22it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.90it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.81it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.68it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195164, 0.197466, 0.194702, 0.229346
Valid average loss UNet                 (all)                : 0.816678

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091502, 1.120494, 2.353847
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.459288, 1.539129, 1.815134
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.274490, 1.378819, 1.729759
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.144488, 1.380529, 2.443268
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.285503, 1.845769, 2.423594
Valid average loss all      (Triplet)                 : 0.254592

== Recognize ==
Valid average loss Recognize     : 0.327991
Valid average accuracy drums     : 99.000000 %
Valid average accuracy bass      : 93.500000 %
Valid average accuracy piano     : 94.500000 %
Valid average accuracy guitar    : 91.500000 %
Valid average accuracy residuals : 92.500000 %

== Valid average loss all : 0.418588

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.019720792770386 sec. =
Valid knn accuracy drums     : 80.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.260977745056152 sec. =
Valid knn accuracy bass      : 43.145161290322584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.423826456069946 sec. =
Valid knn accuracy piano     : 62.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.1795015335083 sec. =
Valid knn accuracy guitar    : 66.74107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.108533382415771 sec. =
Valid knn accuracy residuals : 83.4090909090909%

Valid knn accuracy average   : 67.20254298646655%

                                                                      [AEpoch 35: 100%|██████████| 313/313 [08:04<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=0.290, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00324, Train/loss_recog_epoch=0.267]Epoch 35: 100%|██████████| 313/313 [08:04<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=0.290, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198420, 0.198908, 0.198885, 0.218553
Train average loss UNet                 (all)                : 0.814766

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001447, 0.951310, 2.412125
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003743, 1.187955, 2.071542
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003110, 1.328300, 2.291949
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002568, 1.278059, 2.383641
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002557, 1.561703, 2.676017
Train average loss all      (Triplet)                 : 0.002725

== Recognize ==
Train average loss Recognize     : 0.263699
Train average accuracy drums     : 99.349998 %
Train average accuracy bass      : 95.014999 %
Train average accuracy piano     : 90.520004 %
Train average accuracy guitar    : 92.445000 %
Train average accuracy residuals : 96.550003 %

== Train average loss all : 0.134575

Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=0.290, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]          Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=0.290, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]Epoch 36:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=0.290, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]Epoch 36:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00166, Train/loss_recog_step=0.297, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]Epoch 36:  32%|███▏      | 100/313 [02:13<04:45,  0.75it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00166, Train/loss_recog_step=0.297, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]Epoch 36:  32%|███▏      | 100/313 [02:13<04:45,  0.75it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00174, Train/loss_recog_step=0.274, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]Epoch 36:  48%|████▊     | 150/313 [03:13<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00174, Train/loss_recog_step=0.274, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]Epoch 36:  48%|████▊     | 150/313 [03:13<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.00486, Train/loss_recog_step=0.307, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]Epoch 36:  64%|██████▍   | 200/313 [04:16<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.00486, Train/loss_recog_step=0.307, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]Epoch 36:  64%|██████▍   | 200/313 [04:16<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.250, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]  Epoch 36:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.250, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]Epoch 36:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=0.226, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]Epoch 36:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=0.226, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]Epoch 36:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00442, Train/loss_recog_step=0.230, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]Epoch 36: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00442, Train/loss_recog_step=0.230, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]Epoch 36: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000192, Train/loss_recog_step=0.264, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=0.325, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.328, Valid/knn_avr=0.672, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.38it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.04it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195146, 0.197501, 0.194679, 0.232086
Valid average loss UNet                 (all)                : 0.819412

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.108101, 1.098648, 2.408755
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.401006, 1.497444, 1.804826
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.305486, 1.639417, 1.955678
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.190250, 1.533834, 2.672643
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.232537, 1.612376, 2.212934
Valid average loss all      (Triplet)                 : 0.251337

== Recognize ==
Valid average loss Recognize     : 0.344957
Valid average accuracy drums     : 98.500000 %
Valid average accuracy bass      : 94.000000 %
Valid average accuracy piano     : 87.000000 %
Valid average accuracy guitar    : 91.000000 %
Valid average accuracy residuals : 94.500000 %

== Valid average loss all : 0.423815

= T-SNE...
T-SNE was finished!
= T-SNE time is 91.29634308815002 sec. =
Valid knn accuracy drums     : 80.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.662497520446777 sec. =
Valid knn accuracy bass      : 47.37903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.45949673652649 sec. =
Valid knn accuracy piano     : 60.15625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.280661821365356 sec. =
Valid knn accuracy guitar    : 72.09821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.160874605178833 sec. =
Valid knn accuracy residuals : 80.9090909090909%

Valid knn accuracy average   : 68.23895227318263%

                                                                      [AEpoch 36: 100%|██████████| 313/313 [09:16<00:00,  0.56it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000192, Train/loss_recog_step=0.264, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=0.264]Epoch 36: 100%|██████████| 313/313 [09:16<00:00,  0.56it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000192, Train/loss_recog_step=0.264, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198337, 0.198837, 0.198805, 0.218376
Train average loss UNet                 (all)                : 0.814355

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002074, 0.932348, 2.391715
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004812, 1.169013, 2.045135
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004564, 1.333399, 2.287601
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002985, 1.293005, 2.424851
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002100, 1.558995, 2.682438
Train average loss all      (Triplet)                 : 0.003375

== Recognize ==
Train average loss Recognize     : 0.262933
Train average accuracy drums     : 99.089996 %
Train average accuracy bass      : 94.980003 %
Train average accuracy piano     : 90.750000 %
Train average accuracy guitar    : 92.769997 %
Train average accuracy residuals : 96.415001 %

== Train average loss all : 0.134841

Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000192, Train/loss_recog_step=0.264, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]          Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000192, Train/loss_recog_step=0.264, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]Epoch 37:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000192, Train/loss_recog_step=0.264, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]Epoch 37:  16%|█▌        | 50/313 [01:09<06:03,  0.72it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.310, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]   Epoch 37:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.310, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]Epoch 37:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.291, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]Epoch 37:  48%|████▊     | 150/313 [03:10<03:27,  0.79it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.291, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]Epoch 37:  48%|████▊     | 150/313 [03:10<03:27,  0.79it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.274, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]Epoch 37:  64%|██████▍   | 200/313 [04:11<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.274, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]Epoch 37:  64%|██████▍   | 200/313 [04:11<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00512, Train/loss_recog_step=0.274, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]Epoch 37:  80%|███████▉  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00512, Train/loss_recog_step=0.274, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]Epoch 37:  80%|███████▉  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=0.199, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]Epoch 37:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=0.199, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]Epoch 37:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=9.03e-5, Train/loss_recog_step=0.229, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]Epoch 37: 100%|██████████| 313/313 [06:28<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=9.03e-5, Train/loss_recog_step=0.229, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]Epoch 37: 100%|██████████| 313/313 [06:28<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00296, Train/loss_recog_step=0.293, Valid/loss_all_step=0.337, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.385, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.345, Valid/knn_avr=0.682, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.42it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.09it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.77it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195140, 0.197510, 0.194668, 0.227079
Valid average loss UNet                 (all)                : 0.814397

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.108684, 1.187985, 2.513093
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.418395, 1.504155, 1.770151
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.255407, 1.567971, 1.861899
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.125731, 1.507582, 2.826921
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.252692, 1.584751, 2.233531
Valid average loss all      (Triplet)                 : 0.234867

== Recognize ==
Valid average loss Recognize     : 0.329063
Valid average accuracy drums     : 99.000000 %
Valid average accuracy bass      : 94.500000 %
Valid average accuracy piano     : 93.000000 %
Valid average accuracy guitar    : 87.000000 %
Valid average accuracy residuals : 93.500000 %

== Valid average loss all : 0.399399

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.33597445487976 sec. =
Valid knn accuracy drums     : 78.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.18682074546814 sec. =
Valid knn accuracy bass      : 45.766129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.82446813583374 sec. =
Valid knn accuracy piano     : 60.546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.355611085891724 sec. =
Valid knn accuracy guitar    : 72.09821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.156893968582153 sec. =
Valid knn accuracy residuals : 80.22727272727272%

Valid knn accuracy average   : 67.5103069047012%

                                                                      [AEpoch 37: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00296, Train/loss_recog_step=0.293, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.263]Epoch 37: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00296, Train/loss_recog_step=0.293, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198354, 0.198839, 0.198813, 0.219096
Train average loss UNet                 (all)                : 0.815102

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002320, 0.913265, 2.369807
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004320, 1.173030, 2.057883
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002628, 1.333963, 2.317387
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003392, 1.285971, 2.425916
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002841, 1.546578, 2.676115
Train average loss all      (Triplet)                 : 0.003194

== Recognize ==
Train average loss Recognize     : 0.261221
Train average accuracy drums     : 99.180000 %
Train average accuracy bass      : 94.889999 %
Train average accuracy piano     : 90.979996 %
Train average accuracy guitar    : 92.690002 %
Train average accuracy residuals : 96.695000 %

== Train average loss all : 0.133804

Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00296, Train/loss_recog_step=0.293, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]          Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00296, Train/loss_recog_step=0.293, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]Epoch 38:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00296, Train/loss_recog_step=0.293, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]Epoch 38:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000608, Train/loss_recog_step=0.289, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]Epoch 38:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000608, Train/loss_recog_step=0.289, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]Epoch 38:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00705, Train/loss_recog_step=0.273, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261] Epoch 38:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00705, Train/loss_recog_step=0.273, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]Epoch 38:  48%|████▊     | 150/313 [03:13<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.000541, Train/loss_recog_step=0.277, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]Epoch 38:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.000541, Train/loss_recog_step=0.277, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]Epoch 38:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00175, Train/loss_recog_step=0.303, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261] Epoch 38:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00175, Train/loss_recog_step=0.303, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]Epoch 38:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00986, Train/loss_recog_step=0.213, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]Epoch 38:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00986, Train/loss_recog_step=0.213, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]Epoch 38:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00958, Train/loss_recog_step=0.247, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]Epoch 38: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00958, Train/loss_recog_step=0.247, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]Epoch 38: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.312, Valid/loss_all_step=0.260, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.108, Valid/loss_recog_step=0.305, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.21it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.86it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.63it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.24it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.82it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195462, 0.197765, 0.195015, 0.213550
Valid average loss UNet                 (all)                : 0.801792

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.103794, 0.985196, 2.199569
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.400443, 1.514196, 1.796423
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.327369, 1.642094, 1.922424
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.146610, 1.509873, 2.618021
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.239583, 1.547961, 2.170453
Valid average loss all      (Triplet)                 : 0.252781

== Recognize ==
Valid average loss Recognize     : 0.328588
Valid average accuracy drums     : 98.500000 %
Valid average accuracy bass      : 94.500000 %
Valid average accuracy piano     : 90.000000 %
Valid average accuracy guitar    : 90.500000 %
Valid average accuracy residuals : 95.500000 %

== Valid average loss all : 0.417076

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.308722734451294 sec. =
Valid knn accuracy drums     : 81.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.480923175811768 sec. =
Valid knn accuracy bass      : 44.354838709677416%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.361663818359375 sec. =
Valid knn accuracy piano     : 59.1796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.315742015838623 sec. =
Valid knn accuracy guitar    : 71.65178571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.724071025848389 sec. =
Valid knn accuracy residuals : 81.13636363636364%

Valid knn accuracy average   : 67.48192641641319%

                                                                      [AEpoch 38: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.312, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=0.261]Epoch 38: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.312, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198293, 0.198788, 0.198743, 0.219376
Train average loss UNet                 (all)                : 0.815199

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001542, 0.918207, 2.370809
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004520, 1.189333, 2.096581
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002995, 1.337796, 2.328574
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003500, 1.315945, 2.472184
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002911, 1.540375, 2.683949
Train average loss all      (Triplet)                 : 0.003169

== Recognize ==
Train average loss Recognize     : 0.261182
Train average accuracy drums     : 99.339996 %
Train average accuracy bass      : 94.610001 %
Train average accuracy piano     : 90.889999 %
Train average accuracy guitar    : 92.375000 %
Train average accuracy residuals : 96.644997 %

== Train average loss all : 0.133760

Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.312, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]          Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.312, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]Epoch 39:  16%|█▌        | 50/313 [01:11<06:14,  0.70it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.312, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]Epoch 39:  16%|█▌        | 50/313 [01:11<06:14,  0.70it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00963, Train/loss_recog_step=0.303, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]Epoch 39:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00963, Train/loss_recog_step=0.303, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]Epoch 39:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000267, Train/loss_recog_step=0.285, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]Epoch 39:  48%|████▊     | 150/313 [03:11<03:27,  0.78it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000267, Train/loss_recog_step=0.285, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]Epoch 39:  48%|████▊     | 150/313 [03:11<03:27,  0.78it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=3.72e-5, Train/loss_recog_step=0.252, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261] Epoch 39:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=3.72e-5, Train/loss_recog_step=0.252, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]Epoch 39:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00473, Train/loss_recog_step=0.266, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]Epoch 39:  80%|███████▉  | 250/313 [05:14<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00473, Train/loss_recog_step=0.266, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]Epoch 39:  80%|███████▉  | 250/313 [05:14<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.0986, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=7.81e-5, Train/loss_recog_step=0.197, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]Epoch 39:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0986, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=7.81e-5, Train/loss_recog_step=0.197, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]Epoch 39:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=0.236, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261] Epoch 39: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=0.236, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]Epoch 39: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.298, Valid/loss_all_step=0.349, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.327, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.329, Valid/knn_avr=0.675, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.12it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.68it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195261, 0.197524, 0.194797, 0.227238
Valid average loss UNet                 (all)                : 0.814819

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.109489, 1.043424, 2.171281
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.619403, 1.843244, 2.191499
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.323394, 1.499130, 1.849574
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.181485, 1.633941, 2.711259
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.334969, 1.951992, 2.657614
Valid average loss all      (Triplet)                 : 0.302128

== Recognize ==
Valid average loss Recognize     : 0.326684
Valid average accuracy drums     : 99.000000 %
Valid average accuracy bass      : 94.000000 %
Valid average accuracy piano     : 95.500000 %
Valid average accuracy guitar    : 89.000000 %
Valid average accuracy residuals : 91.000000 %

== Valid average loss all : 0.465470

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.425407886505127 sec. =
Valid knn accuracy drums     : 78.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.358291864395142 sec. =
Valid knn accuracy bass      : 37.70161290322581%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.271932363510132 sec. =
Valid knn accuracy piano     : 58.0078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.143063068389893 sec. =
Valid knn accuracy guitar    : 71.20535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.989749431610107 sec. =
Valid knn accuracy residuals : 80.68181818181817%

Valid knn accuracy average   : 65.25845058036283%

                                                                      [AEpoch 39: 100%|██████████| 313/313 [08:09<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.298, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=0.261]Epoch 39: 100%|██████████| 313/313 [08:09<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.298, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198350, 0.198830, 0.198817, 0.219086
Train average loss UNet                 (all)                : 0.815082

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001216, 0.904328, 2.362883
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003558, 1.190003, 2.108997
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003626, 1.337778, 2.344142
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003043, 1.299310, 2.455177
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001946, 1.530817, 2.664134
Train average loss all      (Triplet)                 : 0.002696

== Recognize ==
Train average loss Recognize     : 0.256029
Train average accuracy drums     : 99.135002 %
Train average accuracy bass      : 95.060005 %
Train average accuracy piano     : 90.915001 %
Train average accuracy guitar    : 92.195000 %
Train average accuracy residuals : 96.699997 %

== Train average loss all : 0.130710

Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.298, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]          Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.298, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]Epoch 40:  16%|█▌        | 50/313 [01:10<06:12,  0.71it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.298, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]Epoch 40:  16%|█▌        | 50/313 [01:10<06:12,  0.71it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.304, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]Epoch 40:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.304, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]Epoch 40:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.265, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]Epoch 40:  48%|████▊     | 150/313 [03:10<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.265, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]Epoch 40:  48%|████▊     | 150/313 [03:10<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.000771, Train/loss_recog_step=0.246, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]Epoch 40:  64%|██████▍   | 200/313 [04:11<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.000771, Train/loss_recog_step=0.246, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]Epoch 40:  64%|██████▍   | 200/313 [04:11<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=0.272, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256] Epoch 40:  80%|███████▉  | 250/313 [05:11<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=0.272, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]Epoch 40:  80%|███████▉  | 250/313 [05:11<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.198, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]  Epoch 40:  96%|█████████▌| 300/313 [06:12<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.198, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]Epoch 40:  96%|█████████▌| 300/313 [06:12<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.227, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]Epoch 40: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.227, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]Epoch 40: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.253, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.075, Valid/loss_recog_step=0.306, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.327, Valid/knn_avr=0.653, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.04it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195292, 0.197646, 0.194843, 0.223107
Valid average loss UNet                 (all)                : 0.810888

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.175258, 1.461880, 2.635060
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.502615, 1.696840, 2.072685
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.361418, 1.641214, 1.946968
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.163020, 1.540853, 2.778457
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.337718, 1.791404, 2.410407
Valid average loss all      (Triplet)                 : 0.312988

== Recognize ==
Valid average loss Recognize     : 0.310070
Valid average accuracy drums     : 97.000000 %
Valid average accuracy bass      : 96.500000 %
Valid average accuracy piano     : 92.000000 %
Valid average accuracy guitar    : 92.000000 %
Valid average accuracy residuals : 93.500000 %

== Valid average loss all : 0.468023

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.495949029922485 sec. =
Valid knn accuracy drums     : 78.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.049896478652954 sec. =
Valid knn accuracy bass      : 43.346774193548384%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.661720752716064 sec. =
Valid knn accuracy piano     : 56.4453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.275704860687256 sec. =
Valid knn accuracy guitar    : 70.53571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.177898168563843 sec. =
Valid knn accuracy residuals : 80.22727272727272%

Valid knn accuracy average   : 65.89362343695926%

                                                                      [AEpoch 40: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.253, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=0.256]Epoch 40: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.253, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198323, 0.198818, 0.198790, 0.219153
Train average loss UNet                 (all)                : 0.815084

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002284, 0.919387, 2.406357
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003548, 1.170289, 2.071142
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004443, 1.310878, 2.292622
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002830, 1.313975, 2.473412
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003149, 1.561545, 2.715672
Train average loss all      (Triplet)                 : 0.003212

== Recognize ==
Train average loss Recognize     : 0.254575
Train average accuracy drums     : 99.279999 %
Train average accuracy bass      : 95.000000 %
Train average accuracy piano     : 91.114998 %
Train average accuracy guitar    : 92.439995 %
Train average accuracy residuals : 96.660004 %

== Train average loss all : 0.130499

Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.253, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]          Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.253, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]Epoch 41:  16%|█▌        | 50/313 [01:11<06:13,  0.70it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.253, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]Epoch 41:  16%|█▌        | 50/313 [01:11<06:13,  0.70it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00968, Train/loss_recog_step=0.291, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]Epoch 41:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00968, Train/loss_recog_step=0.291, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]Epoch 41:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000898, Train/loss_recog_step=0.272, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]Epoch 41:  48%|████▊     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000898, Train/loss_recog_step=0.272, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]Epoch 41:  48%|████▊     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.00104, Train/loss_recog_step=0.262, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255] Epoch 41:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.00104, Train/loss_recog_step=0.262, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]Epoch 41:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.254, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]  Epoch 41:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.254, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]Epoch 41:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.211, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]Epoch 41:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.211, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]Epoch 41:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00494, Train/loss_recog_step=0.199, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]Epoch 41: 100%|██████████| 313/313 [06:28<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00494, Train/loss_recog_step=0.199, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]Epoch 41: 100%|██████████| 313/313 [06:28<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.280, Valid/loss_all_step=0.277, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.282, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.310, Valid/knn_avr=0.659, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.33it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.51it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.94it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195457, 0.197710, 0.195031, 0.224996
Valid average loss UNet                 (all)                : 0.813193

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.102159, 0.988771, 2.149883
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.380932, 1.487265, 1.801710
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.407571, 1.747153, 1.852809
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.162525, 1.462058, 2.638619
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.292267, 1.588996, 2.308594
Valid average loss all      (Triplet)                 : 0.290691

== Recognize ==
Valid average loss Recognize     : 0.334033
Valid average accuracy drums     : 98.500000 %
Valid average accuracy bass      : 95.000000 %
Valid average accuracy piano     : 85.000000 %
Valid average accuracy guitar    : 91.000000 %
Valid average accuracy residuals : 93.500000 %

== Valid average loss all : 0.457708

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.399954080581665 sec. =
Valid knn accuracy drums     : 78.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.956936597824097 sec. =
Valid knn accuracy bass      : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.531700372695923 sec. =
Valid knn accuracy piano     : 56.25%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.255796909332275 sec. =
Valid knn accuracy guitar    : 72.54464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.835251808166504 sec. =
Valid knn accuracy residuals : 79.31818181818183%

Valid knn accuracy average   : 67.23126058723885%

                                                                      [AEpoch 41: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.280, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00321, Train/loss_recog_epoch=0.255]Epoch 41: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.280, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198401, 0.198886, 0.198844, 0.218903
Train average loss UNet                 (all)                : 0.815034

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000991, 0.908280, 2.395637
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003859, 1.203985, 2.121487
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003576, 1.346033, 2.347856
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003251, 1.303565, 2.489850
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002990, 1.541932, 2.684806
Train average loss all      (Triplet)                 : 0.003030

== Recognize ==
Train average loss Recognize     : 0.253810
Train average accuracy drums     : 99.105003 %
Train average accuracy bass      : 95.020004 %
Train average accuracy piano     : 91.014999 %
Train average accuracy guitar    : 92.889999 %
Train average accuracy residuals : 96.485001 %

== Train average loss all : 0.129935

Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.280, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]          Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.280, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]Epoch 42:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.280, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]Epoch 42:  16%|█▌        | 50/313 [01:10<06:10,  0.71it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00813, Train/loss_recog_step=0.295, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]Epoch 42:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00813, Train/loss_recog_step=0.295, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]Epoch 42:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00521, Train/loss_recog_step=0.265, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]Epoch 42:  48%|████▊     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00521, Train/loss_recog_step=0.265, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]Epoch 42:  48%|████▊     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.00369, Train/loss_recog_step=0.224, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]Epoch 42:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.00369, Train/loss_recog_step=0.224, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]Epoch 42:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00366, Train/loss_recog_step=0.250, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]Epoch 42:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00366, Train/loss_recog_step=0.250, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]Epoch 42:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=0.202, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]Epoch 42:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=0.202, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]Epoch 42:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.222, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254] Epoch 42: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.222, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]Epoch 42: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.256, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=0.355, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.334, Valid/knn_avr=0.672, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.48it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.10it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.91it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.63it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195473, 0.197690, 0.195078, 0.220223
Valid average loss UNet                 (all)                : 0.808465

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.163245, 1.267519, 2.479507
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.444220, 1.546999, 1.781063
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.362165, 1.679765, 1.915821
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.201941, 1.529866, 2.741359
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.272694, 1.650644, 2.348323
Valid average loss all      (Triplet)                 : 0.300203

== Recognize ==
Valid average loss Recognize     : 0.323219
Valid average accuracy drums     : 99.000000 %
Valid average accuracy bass      : 96.500000 %
Valid average accuracy piano     : 92.500000 %
Valid average accuracy guitar    : 90.000000 %
Valid average accuracy residuals : 97.000000 %

== Valid average loss all : 0.461812

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.809107542037964 sec. =
Valid knn accuracy drums     : 76.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.423226356506348 sec. =
Valid knn accuracy bass      : 48.185483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.438886404037476 sec. =
Valid knn accuracy piano     : 60.7421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.246482610702515 sec. =
Valid knn accuracy guitar    : 65.17857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.213152885437012 sec. =
Valid knn accuracy residuals : 81.13636363636364%

Valid knn accuracy average   : 66.35286911326752%

                                                                      [AEpoch 42: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.256, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=0.254]Epoch 42: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.256, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198414, 0.198902, 0.198871, 0.218367
Train average loss UNet                 (all)                : 0.814555

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001856, 0.899286, 2.373283
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004161, 1.192310, 2.115831
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003386, 1.359992, 2.377149
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003056, 1.319652, 2.533109
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001671, 1.565272, 2.746561
Train average loss all      (Triplet)                 : 0.002843

== Recognize ==
Train average loss Recognize     : 0.249210
Train average accuracy drums     : 99.150002 %
Train average accuracy bass      : 95.250000 %
Train average accuracy piano     : 91.105003 %
Train average accuracy guitar    : 92.805000 %
Train average accuracy residuals : 96.690002 %

== Train average loss all : 0.127448

Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.256, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]          Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.256, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]Epoch 43:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.256, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]Epoch 43:  16%|█▌        | 50/313 [01:08<06:02,  0.73it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0088, Train/loss_recog_step=0.312, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]Epoch 43:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0088, Train/loss_recog_step=0.312, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]Epoch 43:  32%|███▏      | 100/313 [02:08<04:34,  0.78it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00306, Train/loss_recog_step=0.245, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]Epoch 43:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00306, Train/loss_recog_step=0.245, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]Epoch 43:  48%|████▊     | 150/313 [03:07<03:24,  0.80it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.880, Train/loss_triplet_all_step=0.000978, Train/loss_recog_step=0.321, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]Epoch 43:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.880, Train/loss_triplet_all_step=0.000978, Train/loss_recog_step=0.321, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]Epoch 43:  64%|██████▍   | 200/313 [04:06<02:19,  0.81it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.259, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249] Epoch 43:  80%|███████▉  | 250/313 [05:06<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.259, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]Epoch 43:  80%|███████▉  | 250/313 [05:06<01:17,  0.82it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000318, Train/loss_recog_step=0.201, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]Epoch 43:  96%|█████████▌| 300/313 [06:08<00:15,  0.81it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000318, Train/loss_recog_step=0.201, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]Epoch 43:  96%|█████████▌| 300/313 [06:08<00:15,  0.81it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.218, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]   Epoch 43: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.218, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]Epoch 43: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=0.264, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.337, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.323, Valid/knn_avr=0.664, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.36it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195340, 0.197641, 0.194896, 0.228877
Valid average loss UNet                 (all)                : 0.816755

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.133786, 1.123498, 2.319054
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.437240, 1.508071, 1.740113
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.416870, 1.823218, 1.998995
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.148463, 1.455329, 2.649438
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.274208, 1.573819, 2.235139
Valid average loss all      (Triplet)                 : 0.300037

== Recognize ==
Valid average loss Recognize     : 0.329828
Valid average accuracy drums     : 99.000000 %
Valid average accuracy bass      : 96.000000 %
Valid average accuracy piano     : 83.000000 %
Valid average accuracy guitar    : 89.500000 %
Valid average accuracy residuals : 96.000000 %

== Valid average loss all : 0.464951

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.500514030456543 sec. =
Valid knn accuracy drums     : 77.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.222647190093994 sec. =
Valid knn accuracy bass      : 46.16935483870967%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.16313624382019 sec. =
Valid knn accuracy piano     : 58.203125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.264877319335938 sec. =
Valid knn accuracy guitar    : 68.08035714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.676918983459473 sec. =
Valid knn accuracy residuals : 80.22727272727272%

Valid knn accuracy average   : 65.97080455046355%

                                                                      [AEpoch 43: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=0.264, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00284, Train/loss_recog_epoch=0.249]Epoch 43: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=0.264, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198369, 0.198848, 0.198819, 0.218074
Train average loss UNet                 (all)                : 0.814109

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000832, 0.866483, 2.275763
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003803, 1.194637, 2.132308
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003085, 1.351779, 2.373760
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002997, 1.336356, 2.578024
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002778, 1.561042, 2.734647
Train average loss all      (Triplet)                 : 0.002750

== Recognize ==
Train average loss Recognize     : 0.245551
Train average accuracy drums     : 99.255005 %
Train average accuracy bass      : 95.310005 %
Train average accuracy piano     : 91.089996 %
Train average accuracy guitar    : 92.750000 %
Train average accuracy residuals : 96.760002 %

== Train average loss all : 0.125526

Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=0.264, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]          Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=0.264, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]Epoch 44:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=0.264, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]Epoch 44:  16%|█▌        | 50/313 [01:11<06:16,  0.70it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.287, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]Epoch 44:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.287, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]Epoch 44:  32%|███▏      | 100/313 [02:11<04:39,  0.76it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.232, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]  Epoch 44:  48%|████▊     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.232, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]Epoch 44:  48%|████▊     | 150/313 [03:11<03:28,  0.78it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=7.53e-5, Train/loss_recog_step=0.320, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]Epoch 44:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=7.53e-5, Train/loss_recog_step=0.320, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]Epoch 44:  64%|██████▍   | 200/313 [04:12<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.244, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]  Epoch 44:  80%|███████▉  | 250/313 [05:14<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.244, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]Epoch 44:  80%|███████▉  | 250/313 [05:14<01:19,  0.80it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.189, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]Epoch 44:  96%|█████████▌| 300/313 [06:18<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.189, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]Epoch 44:  96%|█████████▌| 300/313 [06:18<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00428, Train/loss_recog_step=0.245, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]Epoch 44: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00428, Train/loss_recog_step=0.245, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]Epoch 44: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.268, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=0.338, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=0.330, Valid/knn_avr=0.660, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.45it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.63it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.60it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195153, 0.197470, 0.194699, 0.224082
Valid average loss UNet                 (all)                : 0.811404

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.186540, 1.258391, 2.550307
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.578614, 1.743660, 2.022196
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.336800, 1.630047, 1.855086
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.132512, 1.455892, 2.875846
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.346408, 1.903693, 2.605043
Valid average loss all      (Triplet)                 : 0.327812

== Recognize ==
Valid average loss Recognize     : 0.303238
Valid average accuracy drums     : 98.000000 %
Valid average accuracy bass      : 96.000000 %
Valid average accuracy piano     : 91.000000 %
Valid average accuracy guitar    : 91.000000 %
Valid average accuracy residuals : 94.500000 %

== Valid average loss all : 0.479431

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.353416919708252 sec. =
Valid knn accuracy drums     : 75.65217391304347%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.349735975265503 sec. =
Valid knn accuracy bass      : 43.54838709677419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.501566171646118 sec. =
Valid knn accuracy piano     : 58.7890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.245884418487549 sec. =
Valid knn accuracy guitar    : 68.52678571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.102661609649658 sec. =
Valid knn accuracy residuals : 80.0%

Valid knn accuracy average   : 65.30328184482069%

                                                                      [AEpoch 44: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.268, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=0.246]Epoch 44: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.268, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198273, 0.198762, 0.198740, 0.219341
Train average loss UNet                 (all)                : 0.815117

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001110, 0.895577, 2.314630
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003825, 1.182593, 2.110843
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003157, 1.337748, 2.357407
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002607, 1.326662, 2.545391
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001882, 1.559215, 2.743881
Train average loss all      (Triplet)                 : 0.002582

== Recognize ==
Train average loss Recognize     : 0.246207
Train average accuracy drums     : 99.245003 %
Train average accuracy bass      : 95.330002 %
Train average accuracy piano     : 91.019997 %
Train average accuracy guitar    : 92.565002 %
Train average accuracy residuals : 96.860001 %

== Train average loss all : 0.125685

Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.268, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]          Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.268, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]Epoch 45:  16%|█▌        | 50/313 [01:12<06:18,  0.69it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.268, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]Epoch 45:  16%|█▌        | 50/313 [01:12<06:18,  0.69it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.267, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]Epoch 45:  32%|███▏      | 100/313 [02:14<04:45,  0.75it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.267, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]Epoch 45:  32%|███▏      | 100/313 [02:14<04:45,  0.75it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00289, Train/loss_recog_step=0.239, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]Epoch 45:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00289, Train/loss_recog_step=0.239, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]Epoch 45:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00478, Train/loss_recog_step=0.249, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]Epoch 45:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00478, Train/loss_recog_step=0.249, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]Epoch 45:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.266, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]  Epoch 45:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.266, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]Epoch 45:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00528, Train/loss_recog_step=0.191, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]Epoch 45:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00528, Train/loss_recog_step=0.191, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]Epoch 45:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.002, Train/loss_recog_step=0.218, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]  Epoch 45: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.002, Train/loss_recog_step=0.218, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]Epoch 45: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=0.229, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=0.287, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.303, Valid/knn_avr=0.653, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.26it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.02it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.13it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.30it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.66it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195158, 0.197457, 0.194706, 0.221444
Valid average loss UNet                 (all)                : 0.808764

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.166193, 1.234959, 2.511638
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.580963, 1.701615, 2.019950
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.294947, 1.564876, 1.977097
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.169461, 1.541266, 2.840845
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.344764, 1.974541, 2.584713
Valid average loss all      (Triplet)                 : 0.312568

== Recognize ==
Valid average loss Recognize     : 0.299090
Valid average accuracy drums     : 98.500000 %
Valid average accuracy bass      : 96.000000 %
Valid average accuracy piano     : 93.500000 %
Valid average accuracy guitar    : 95.000000 %
Valid average accuracy residuals : 95.000000 %

== Valid average loss all : 0.462114

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.15755558013916 sec. =
Valid knn accuracy drums     : 77.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.170960903167725 sec. =
Valid knn accuracy bass      : 41.733870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.251396179199219 sec. =
Valid knn accuracy piano     : 58.3984375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.517184734344482 sec. =
Valid knn accuracy guitar    : 66.29464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.317894697189331 sec. =
Valid knn accuracy residuals : 80.45454545454545%

Valid knn accuracy average   : 64.8110819645817%

                                                                      [AEpoch 45: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=0.229, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00258, Train/loss_recog_epoch=0.246]Epoch 45: 100%|██████████| 313/313 [07:59<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=0.229, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198297, 0.198780, 0.198765, 0.218564
Train average loss UNet                 (all)                : 0.814405

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001458, 0.877134, 2.286492
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003970, 1.173949, 2.074292
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003126, 1.351552, 2.387789
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002627, 1.358785, 2.587314
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002960, 1.565176, 2.749406
Train average loss all      (Triplet)                 : 0.002764

== Recognize ==
Train average loss Recognize     : 0.242270
Train average accuracy drums     : 99.165001 %
Train average accuracy bass      : 95.264999 %
Train average accuracy piano     : 91.135002 %
Train average accuracy guitar    : 92.519997 %
Train average accuracy residuals : 96.940002 %

== Train average loss all : 0.123899

Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=0.229, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242]          Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=0.229, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242]Epoch 46:  16%|█▌        | 50/313 [01:11<06:14,  0.70it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=0.229, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242]Epoch 46:  16%|█▌        | 50/313 [01:11<06:14,  0.70it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.304, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242] Epoch 46:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.304, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242]Epoch 46:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00083, Train/loss_recog_step=0.261, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242]Epoch 46:  48%|████▊     | 150/313 [03:13<03:30,  0.78it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00083, Train/loss_recog_step=0.261, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242]Epoch 46:  48%|████▊     | 150/313 [03:13<03:30,  0.78it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.862, Train/loss_triplet_all_step=0.00517, Train/loss_recog_step=0.287, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242]Epoch 46:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.862, Train/loss_triplet_all_step=0.00517, Train/loss_recog_step=0.287, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242]Epoch 46:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00171, Train/loss_recog_step=0.242, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242]Epoch 46:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00171, Train/loss_recog_step=0.242, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242]Epoch 46:  80%|███████▉  | 250/313 [05:16<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.0995, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00271, Train/loss_recog_step=0.194, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242]Epoch 46:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.0995, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00271, Train/loss_recog_step=0.194, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242]Epoch 46:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00163, Train/loss_recog_step=0.219, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242] Epoch 46: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00163, Train/loss_recog_step=0.219, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242]Epoch 46: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.229, Valid/loss_all_step=0.241, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.0923, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.299, Valid/knn_avr=0.648, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.36it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.41it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.65it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195255, 0.197622, 0.194799, 0.217380
Valid average loss UNet                 (all)                : 0.805056

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.230573, 1.388171, 2.642919
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.448509, 1.518918, 1.898174
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.345912, 1.680624, 1.920312
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.155699, 1.521874, 2.892370
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.328509, 1.760125, 2.310729
Valid average loss all      (Triplet)                 : 0.310586

== Recognize ==
Valid average loss Recognize     : 0.311065
Valid average accuracy drums     : 100.000000 %
Valid average accuracy bass      : 94.500000 %
Valid average accuracy piano     : 88.500000 %
Valid average accuracy guitar    : 92.000000 %
Valid average accuracy residuals : 93.500000 %

== Valid average loss all : 0.466118

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.327922105789185 sec. =
Valid knn accuracy drums     : 72.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.98208999633789 sec. =
Valid knn accuracy bass      : 42.943548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.467752933502197 sec. =
Valid knn accuracy piano     : 56.8359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.664064884185791 sec. =
Valid knn accuracy guitar    : 67.85714285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.077999591827393 sec. =
Valid knn accuracy residuals : 79.31818181818183%

Valid knn accuracy average   : 63.95617950378863%

                                                                      [AEpoch 46: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.229, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.242] Epoch 46: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.229, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198280, 0.198771, 0.198741, 0.218873
Train average loss UNet                 (all)                : 0.814665

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001366, 0.843034, 2.265175
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002595, 1.160248, 2.071656
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003943, 1.336483, 2.359596
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002272, 1.339345, 2.584835
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002304, 1.557977, 2.756727
Train average loss all      (Triplet)                 : 0.002492

== Recognize ==
Train average loss Recognize     : 0.241669
Train average accuracy drums     : 99.299995 %
Train average accuracy bass      : 95.320000 %
Train average accuracy piano     : 91.285004 %
Train average accuracy guitar    : 92.695000 %
Train average accuracy residuals : 96.849998 %

== Train average loss all : 0.123327

Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.229, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]          Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.229, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]Epoch 47:  16%|█▌        | 50/313 [01:08<06:02,  0.72it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.229, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]Epoch 47:  16%|█▌        | 50/313 [01:08<06:02,  0.72it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00108, Train/loss_recog_step=0.272, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]Epoch 47:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00108, Train/loss_recog_step=0.272, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]Epoch 47:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.237, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]  Epoch 47:  48%|████▊     | 150/313 [03:10<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.237, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]Epoch 47:  48%|████▊     | 150/313 [03:10<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00475, Train/loss_recog_step=0.236, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]Epoch 47:  64%|██████▍   | 200/313 [04:11<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00475, Train/loss_recog_step=0.236, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]Epoch 47:  64%|██████▍   | 200/313 [04:11<02:22,  0.79it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.223, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]Epoch 47:  80%|███████▉  | 250/313 [05:13<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.223, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]Epoch 47:  80%|███████▉  | 250/313 [05:13<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.0956, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00237, Train/loss_recog_step=0.186, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]Epoch 47:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0956, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00237, Train/loss_recog_step=0.186, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]Epoch 47:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00454, Train/loss_recog_step=0.223, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242] Epoch 47: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00454, Train/loss_recog_step=0.223, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]Epoch 47: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.285, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.285, Valid/loss_all_epoch=0.466, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=0.311, Valid/knn_avr=0.640, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.45it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.51it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.30it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.59it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195476, 0.197724, 0.195082, 0.225853
Valid average loss UNet                 (all)                : 0.814136

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.147597, 1.313914, 2.393555
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.466591, 1.606511, 1.979062
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.345936, 1.653296, 1.965189
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.177229, 1.525105, 2.797418
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.313400, 1.688624, 2.269587
Valid average loss all      (Triplet)                 : 0.295835

== Recognize ==
Valid average loss Recognize     : 0.316298
Valid average accuracy drums     : 99.500000 %
Valid average accuracy bass      : 93.500000 %
Valid average accuracy piano     : 93.000000 %
Valid average accuracy guitar    : 90.000000 %
Valid average accuracy residuals : 98.000000 %

== Valid average loss all : 0.453984

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.71354079246521 sec. =
Valid knn accuracy drums     : 74.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.253059387207031 sec. =
Valid knn accuracy bass      : 40.725806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.903035163879395 sec. =
Valid knn accuracy piano     : 59.9609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.696558237075806 sec. =
Valid knn accuracy guitar    : 64.95535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.104564189910889 sec. =
Valid knn accuracy residuals : 79.31818181818183%

Valid knn accuracy average   : 63.9485783216608%

                                                                      [AEpoch 47: 100%|██████████| 313/313 [08:08<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.285, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=0.242]Epoch 47: 100%|██████████| 313/313 [08:08<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.285, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198339, 0.198815, 0.198794, 0.218735
Train average loss UNet                 (all)                : 0.814682

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000823, 0.872976, 2.323226
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004472, 1.199654, 2.124501
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003639, 1.369811, 2.428849
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002743, 1.362353, 2.634388
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003910, 1.604606, 2.830351
Train average loss all      (Triplet)                 : 0.003145

== Recognize ==
Train average loss Recognize     : 0.239791
Train average accuracy drums     : 99.175003 %
Train average accuracy bass      : 95.490005 %
Train average accuracy piano     : 91.224998 %
Train average accuracy guitar    : 93.059998 %
Train average accuracy residuals : 96.714996 %

== Train average loss all : 0.123041

Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.285, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]          Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.285, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]Epoch 48:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.285, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]Epoch 48:  16%|█▌        | 50/313 [01:10<06:11,  0.71it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.000512, Train/loss_recog_step=0.268, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]Epoch 48:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.000512, Train/loss_recog_step=0.268, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]Epoch 48:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00496, Train/loss_recog_step=0.243, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240] Epoch 48:  48%|████▊     | 150/313 [03:14<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00496, Train/loss_recog_step=0.243, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]Epoch 48:  48%|████▊     | 150/313 [03:14<03:30,  0.77it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.213, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]  Epoch 48:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.213, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]Epoch 48:  64%|██████▍   | 200/313 [04:13<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0048, Train/loss_recog_step=0.259, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]Epoch 48:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0048, Train/loss_recog_step=0.259, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]Epoch 48:  80%|███████▉  | 250/313 [05:14<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.000663, Train/loss_recog_step=0.200, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]Epoch 48:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.000663, Train/loss_recog_step=0.200, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]Epoch 48:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0965, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.193, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]  Epoch 48: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0965, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.193, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]Epoch 48: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=0.254, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.454, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.316, Valid/knn_avr=0.639, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.49it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.95it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.83it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.67it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.43it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195101, 0.197408, 0.194671, 0.221520
Valid average loss UNet                 (all)                : 0.808701

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.149112, 1.096180, 2.291538
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.651268, 1.865850, 2.197062
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.331508, 1.496091, 1.847112
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.174074, 1.627647, 3.007918
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.413757, 2.126667, 2.939578
Valid average loss all      (Triplet)                 : 0.343784

== Recognize ==
Valid average loss Recognize     : 0.301254
Valid average accuracy drums     : 98.500000 %
Valid average accuracy bass      : 94.500000 %
Valid average accuracy piano     : 92.000000 %
Valid average accuracy guitar    : 94.500000 %
Valid average accuracy residuals : 95.500000 %

== Valid average loss all : 0.494411

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.6398024559021 sec. =
Valid knn accuracy drums     : 75.8695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.504885196685791 sec. =
Valid knn accuracy bass      : 41.935483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.419968605041504 sec. =
Valid knn accuracy piano     : 54.1015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.303563117980957 sec. =
Valid knn accuracy guitar    : 67.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.131670475006104 sec. =
Valid knn accuracy residuals : 81.36363636363636%

Valid knn accuracy average   : 64.09154959039908%

                                                                      [AEpoch 48: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=0.254, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=0.240]Epoch 48: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=0.254, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198369, 0.198858, 0.198820, 0.218887
Train average loss UNet                 (all)                : 0.814934

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001807, 0.880993, 2.305909
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004035, 1.213926, 2.157465
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003398, 1.337999, 2.395704
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002406, 1.369505, 2.656301
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002604, 1.597617, 2.838090
Train average loss all      (Triplet)                 : 0.002864

== Recognize ==
Train average loss Recognize     : 0.238250
Train average accuracy drums     : 99.205002 %
Train average accuracy bass      : 95.525002 %
Train average accuracy piano     : 91.439995 %
Train average accuracy guitar    : 92.760002 %
Train average accuracy residuals : 96.750000 %

== Train average loss all : 0.121989

Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=0.254, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]          Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=0.254, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]Epoch 49:  16%|█▌        | 50/313 [01:11<06:15,  0.70it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=0.254, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]Epoch 49:  16%|█▌        | 50/313 [01:11<06:15,  0.70it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000566, Train/loss_recog_step=0.295, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]Epoch 49:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000566, Train/loss_recog_step=0.295, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]Epoch 49:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.232, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238] Epoch 49:  48%|████▊     | 150/313 [03:13<03:30,  0.78it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.232, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]Epoch 49:  48%|████▊     | 150/313 [03:13<03:30,  0.78it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.261, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]  Epoch 49:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.261, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]Epoch 49:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=0.256, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]Epoch 49:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=0.256, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]Epoch 49:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.211, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]  Epoch 49:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.211, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]Epoch 49:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00357, Train/loss_recog_step=0.211, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]Epoch 49: 100%|██████████| 313/313 [06:28<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00357, Train/loss_recog_step=0.211, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]Epoch 49: 100%|██████████| 313/313 [06:28<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=0.242, Valid/loss_all_step=0.215, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.066, Valid/loss_recog_step=0.297, Valid/loss_all_epoch=0.494, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.301, Valid/knn_avr=0.641, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.66it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.80it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.66it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195227, 0.197465, 0.194827, 0.222776
Valid average loss UNet                 (all)                : 0.810295

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.170969, 1.172164, 2.313418
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.768285, 2.000906, 2.322183
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.436697, 1.631567, 2.003208
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.247858, 1.769502, 3.117361
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.461262, 2.087238, 2.771219
Valid average loss all      (Triplet)                 : 0.428048

== Recognize ==
Valid average loss Recognize     : 0.291384
Valid average accuracy drums     : 99.500000 %
Valid average accuracy bass      : 95.500000 %
Valid average accuracy piano     : 94.000000 %
Valid average accuracy guitar    : 93.500000 %
Valid average accuracy residuals : 91.500000 %

== Valid average loss all : 0.573740

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.340097904205322 sec. =
Valid knn accuracy drums     : 73.91304347826086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.611456871032715 sec. =
Valid knn accuracy bass      : 42.13709677419355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.100468397140503 sec. =
Valid knn accuracy piano     : 57.421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.187314748764038 sec. =
Valid knn accuracy guitar    : 67.63392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.201727390289307 sec. =
Valid knn accuracy residuals : 78.86363636363637%

Valid knn accuracy average   : 63.99391603750387%

                                                                      [AEpoch 49: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=0.242, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00286, Train/loss_recog_epoch=0.238]Epoch 49: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=0.242, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198325, 0.198822, 0.198781, 0.219004
Train average loss UNet                 (all)                : 0.814933

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002364, 0.868714, 2.287863
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002729, 1.209285, 2.170531
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002924, 1.345962, 2.394204
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002399, 1.383751, 2.687875
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001894, 1.610350, 2.862749
Train average loss all      (Triplet)                 : 0.002440

== Recognize ==
Train average loss Recognize     : 0.236198
Train average accuracy drums     : 99.379997 %
Train average accuracy bass      : 95.510002 %
Train average accuracy piano     : 91.519997 %
Train average accuracy guitar    : 93.035004 %
Train average accuracy residuals : 96.660004 %

== Train average loss all : 0.120539

Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=0.242, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]          Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=0.242, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]Epoch 50:  16%|█▌        | 50/313 [01:10<06:13,  0.70it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=0.242, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]Epoch 50:  16%|█▌        | 50/313 [01:10<06:13,  0.70it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.303, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]  Epoch 50:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.303, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]Epoch 50:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.237, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]Epoch 50:  48%|████▊     | 150/313 [03:10<03:27,  0.79it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.237, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]Epoch 50:  48%|████▊     | 150/313 [03:10<03:27,  0.79it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.0039, Train/loss_recog_step=0.247, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]Epoch 50:  64%|██████▍   | 200/313 [04:10<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.0039, Train/loss_recog_step=0.247, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]Epoch 50:  64%|██████▍   | 200/313 [04:10<02:21,  0.80it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.258, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]Epoch 50:  80%|███████▉  | 250/313 [05:11<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.258, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]Epoch 50:  80%|███████▉  | 250/313 [05:11<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=0.171, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]Epoch 50:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=0.171, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]Epoch 50:  96%|█████████▌| 300/313 [06:15<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.220, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]Epoch 50: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.220, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]Epoch 50: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.283, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.263, Valid/loss_all_epoch=0.574, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.291, Valid/knn_avr=0.640, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.26it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.82it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  2.94it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.71it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.34it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195359, 0.197603, 0.194970, 0.227331
Valid average loss UNet                 (all)                : 0.815264

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.150879, 1.216685, 2.622662
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.643459, 1.846619, 2.121185
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.435413, 1.790632, 2.044718
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.197131, 1.708797, 3.156068
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.393191, 1.834870, 2.534326
Valid average loss all      (Triplet)                 : 0.367830

== Recognize ==
Valid average loss Recognize     : 0.298002
Valid average accuracy drums     : 99.500000 %
Valid average accuracy bass      : 97.500000 %
Valid average accuracy piano     : 89.500000 %
Valid average accuracy guitar    : 89.000000 %
Valid average accuracy residuals : 96.000000 %

== Valid average loss all : 0.516831

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.64826774597168 sec. =
Valid knn accuracy drums     : 76.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.164258480072021 sec. =
Valid knn accuracy bass      : 44.153225806451616%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.436848878860474 sec. =
Valid knn accuracy piano     : 58.7890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.571361064910889 sec. =
Valid knn accuracy guitar    : 66.51785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.327570915222168 sec. =
Valid knn accuracy residuals : 77.04545454545455%

Valid knn accuracy average   : 64.51851130330049%

                                                                      [AEpoch 50: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.283, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=0.236]Epoch 50: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.283, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198349, 0.198844, 0.198819, 0.219331
Train average loss UNet                 (all)                : 0.815343

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001787, 0.868867, 2.309466
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002585, 1.206826, 2.172926
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002989, 1.349288, 2.411254
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002307, 1.397537, 2.728397
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002289, 1.610416, 2.860865
Train average loss all      (Triplet)                 : 0.002461

== Recognize ==
Train average loss Recognize     : 0.235282
Train average accuracy drums     : 99.235001 %
Train average accuracy bass      : 95.584999 %
Train average accuracy piano     : 91.184998 %
Train average accuracy guitar    : 92.970001 %
Train average accuracy residuals : 96.775002 %

== Train average loss all : 0.120101

Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.283, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]          Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.283, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]Epoch 51:  16%|█▌        | 50/313 [01:12<06:21,  0.69it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.283, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]Epoch 51:  16%|█▌        | 50/313 [01:12<06:21,  0.69it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000334, Train/loss_recog_step=0.267, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]Epoch 51:  32%|███▏      | 100/313 [02:11<04:40,  0.76it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000334, Train/loss_recog_step=0.267, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]Epoch 51:  32%|███▏      | 100/313 [02:11<04:40,  0.76it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.241, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]   Epoch 51:  48%|████▊     | 150/313 [03:13<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.241, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]Epoch 51:  48%|████▊     | 150/313 [03:13<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.00208, Train/loss_recog_step=0.240, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]Epoch 51:  64%|██████▍   | 200/313 [04:14<02:23,  0.78it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.00208, Train/loss_recog_step=0.240, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]Epoch 51:  64%|██████▍   | 200/313 [04:14<02:23,  0.78it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.214, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]  Epoch 51:  80%|███████▉  | 250/313 [05:13<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.214, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]Epoch 51:  80%|███████▉  | 250/313 [05:13<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.0879, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.176, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]Epoch 51:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0879, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.176, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]Epoch 51:  96%|█████████▌| 300/313 [06:14<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.203, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235] Epoch 51: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.203, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]Epoch 51: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.245, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.299, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.645, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.31it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.80it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.79it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.98it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.62it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195278, 0.197565, 0.194859, 0.230815
Valid average loss UNet                 (all)                : 0.818517

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.239973, 1.456231, 2.656964
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.591985, 1.828010, 2.270370
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.480008, 1.861222, 2.050629
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.210890, 1.620144, 3.043590
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.340422, 1.741423, 2.423710
Valid average loss all      (Triplet)                 : 0.398190

== Recognize ==
Valid average loss Recognize     : 0.306919
Valid average accuracy drums     : 100.000000 %
Valid average accuracy bass      : 94.000000 %
Valid average accuracy piano     : 85.000000 %
Valid average accuracy guitar    : 95.000000 %
Valid average accuracy residuals : 95.500000 %

== Valid average loss all : 0.551650

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.293717384338379 sec. =
Valid knn accuracy drums     : 73.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.93979787826538 sec. =
Valid knn accuracy bass      : 36.49193548387097%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.905239582061768 sec. =
Valid knn accuracy piano     : 56.8359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.33689546585083 sec. =
Valid knn accuracy guitar    : 68.52678571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.472843408584595 sec. =
Valid knn accuracy residuals : 79.54545454545455%

Valid knn accuracy average   : 62.888718300896166%

                                                                      [AEpoch 51: 100%|██████████| 313/313 [08:00<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.245, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=0.235]Epoch 51: 100%|██████████| 313/313 [08:00<00:00,  0.65it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.245, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198312, 0.198802, 0.198782, 0.219108
Train average loss UNet                 (all)                : 0.815004

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000926, 0.868271, 2.306989
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004127, 1.216098, 2.191840
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002981, 1.368687, 2.450525
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003186, 1.432178, 2.790612
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003021, 1.660170, 2.966239
Train average loss all      (Triplet)                 : 0.002924

== Recognize ==
Train average loss Recognize     : 0.232326
Train average accuracy drums     : 99.335007 %
Train average accuracy bass      : 95.654999 %
Train average accuracy piano     : 91.825005 %
Train average accuracy guitar    : 92.570000 %
Train average accuracy residuals : 96.860001 %

== Train average loss all : 0.119087

Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.245, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]          Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.245, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]Epoch 52:  16%|█▌        | 50/313 [01:11<06:18,  0.69it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.245, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]Epoch 52:  16%|█▌        | 50/313 [01:11<06:18,  0.69it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=0.273, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]Epoch 52:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=0.273, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]Epoch 52:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=0.229, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]Epoch 52:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=0.229, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]Epoch 52:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.00292, Train/loss_recog_step=0.277, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]Epoch 52:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.00292, Train/loss_recog_step=0.277, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]Epoch 52:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.221, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]  Epoch 52:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.221, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]Epoch 52:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.0914, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.183, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]Epoch 52:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0914, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.183, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]Epoch 52:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00731, Train/loss_recog_step=0.197, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]Epoch 52: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00731, Train/loss_recog_step=0.197, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]Epoch 52: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.226, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.312, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.629, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.22it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.85it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.80it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.16it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195141, 0.197479, 0.194677, 0.223105
Valid average loss UNet                 (all)                : 0.810403

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.167321, 1.341522, 2.593826
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.759764, 2.086548, 2.570076
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.391402, 1.647920, 1.855116
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.278014, 1.807198, 3.291056
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.473287, 2.062844, 2.846039
Valid average loss all      (Triplet)                 : 0.438138

== Recognize ==
Valid average loss Recognize     : 0.301859
Valid average accuracy drums     : 99.500000 %
Valid average accuracy bass      : 95.500000 %
Valid average accuracy piano     : 90.500000 %
Valid average accuracy guitar    : 91.500000 %
Valid average accuracy residuals : 94.500000 %

== Valid average loss all : 0.589067

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.310364007949829 sec. =
Valid knn accuracy drums     : 74.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.625542402267456 sec. =
Valid knn accuracy bass      : 40.725806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.88282585144043 sec. =
Valid knn accuracy piano     : 59.1796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.271116018295288 sec. =
Valid knn accuracy guitar    : 66.07142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.246454238891602 sec. =
Valid knn accuracy residuals : 77.27272727272727%

Valid knn accuracy average   : 63.51949517654505%

                                                                      [AEpoch 52: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.226, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.119, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.232]Epoch 52: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.226, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198291, 0.198780, 0.198752, 0.219611
Train average loss UNet                 (all)                : 0.815434

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001346, 0.904131, 2.410244
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005256, 1.214522, 2.182457
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002885, 1.379213, 2.472668
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002828, 1.431252, 2.791574
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002520, 1.648077, 2.956778
Train average loss all      (Triplet)                 : 0.002879

== Recognize ==
Train average loss Recognize     : 0.233704
Train average accuracy drums     : 99.295006 %
Train average accuracy bass      : 95.670006 %
Train average accuracy piano     : 91.419998 %
Train average accuracy guitar    : 92.755005 %
Train average accuracy residuals : 96.595001 %

== Train average loss all : 0.119731

Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.226, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]          Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.226, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]Epoch 53:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.226, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]Epoch 53:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=0.252, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]Epoch 53:  32%|███▏      | 100/313 [02:14<04:47,  0.74it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=0.252, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]Epoch 53:  32%|███▏      | 100/313 [02:14<04:47,  0.74it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.240, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]Epoch 53:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.240, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]Epoch 53:  48%|████▊     | 150/313 [03:15<03:32,  0.77it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.00807, Train/loss_recog_step=0.228, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]Epoch 53:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.00807, Train/loss_recog_step=0.228, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]Epoch 53:  64%|██████▍   | 200/313 [04:15<02:24,  0.78it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.214, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]  Epoch 53:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.214, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]Epoch 53:  80%|███████▉  | 250/313 [05:17<01:20,  0.79it/s, v_num=0, Train/loss_all_step=0.0848, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000315, Train/loss_recog_step=0.169, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]Epoch 53:  96%|█████████▌| 300/313 [06:17<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.0848, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000315, Train/loss_recog_step=0.169, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]Epoch 53:  96%|█████████▌| 300/313 [06:17<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00157, Train/loss_recog_step=0.209, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]  Epoch 53: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00157, Train/loss_recog_step=0.209, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]Epoch 53: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0293, Train/loss_recog_step=0.214, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.259, Valid/loss_recog_step=0.288, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=0.302, Valid/knn_avr=0.635, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.23it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.80it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.91it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.79it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195027, 0.197323, 0.194591, 0.224188
Valid average loss UNet                 (all)                : 0.811129

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.084157, 1.178420, 2.469977
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.614048, 1.876099, 2.330317
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.381631, 1.601276, 1.907003
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.207880, 1.716199, 3.066147
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.518681, 2.174762, 2.966895
Valid average loss all      (Triplet)                 : 0.378872

== Recognize ==
Valid average loss Recognize     : 0.287035
Valid average accuracy drums     : 100.000000 %
Valid average accuracy bass      : 95.500000 %
Valid average accuracy piano     : 94.500000 %
Valid average accuracy guitar    : 93.000000 %
Valid average accuracy residuals : 93.000000 %

== Valid average loss all : 0.522390

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.414733409881592 sec. =
Valid knn accuracy drums     : 76.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.41374135017395 sec. =
Valid knn accuracy bass      : 40.725806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.54935598373413 sec. =
Valid knn accuracy piano     : 57.421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.445515394210815 sec. =
Valid knn accuracy guitar    : 63.16964285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.19111180305481 sec. =
Valid knn accuracy residuals : 77.95454545454545%

Valid knn accuracy average   : 63.24567830048633%

                                                                      [AEpoch 53: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0293, Train/loss_recog_step=0.214, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=0.234]Epoch 53: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0293, Train/loss_recog_step=0.214, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198274, 0.198763, 0.198733, 0.218709
Train average loss UNet                 (all)                : 0.814480

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002010, 0.874195, 2.330795
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003550, 1.234616, 2.226072
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004135, 1.415300, 2.513440
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003162, 1.454533, 2.818018
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001833, 1.639383, 2.944241
Train average loss all      (Triplet)                 : 0.002917

== Recognize ==
Train average loss Recognize     : 0.229822
Train average accuracy drums     : 99.235001 %
Train average accuracy bass      : 95.564995 %
Train average accuracy piano     : 91.570000 %
Train average accuracy guitar    : 93.365005 %
Train average accuracy residuals : 96.790001 %

== Train average loss all : 0.117827

Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0293, Train/loss_recog_step=0.214, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]          Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0293, Train/loss_recog_step=0.214, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]Epoch 54:  16%|█▌        | 50/313 [01:12<06:22,  0.69it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0293, Train/loss_recog_step=0.214, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]Epoch 54:  16%|█▌        | 50/313 [01:12<06:22,  0.69it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=5.17e-5, Train/loss_recog_step=0.262, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]Epoch 54:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=5.17e-5, Train/loss_recog_step=0.262, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]Epoch 54:  32%|███▏      | 100/313 [02:12<04:41,  0.76it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00238, Train/loss_recog_step=0.249, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]Epoch 54:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00238, Train/loss_recog_step=0.249, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]Epoch 54:  48%|████▊     | 150/313 [03:12<03:29,  0.78it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=0.204, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]Epoch 54:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=0.204, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]Epoch 54:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=0.218, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]Epoch 54:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=0.218, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]Epoch 54:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.0887, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0014, Train/loss_recog_step=0.175, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]Epoch 54:  96%|█████████▌| 300/313 [06:17<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.0887, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0014, Train/loss_recog_step=0.175, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]Epoch 54:  96%|█████████▌| 300/313 [06:17<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00447, Train/loss_recog_step=0.232, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]Epoch 54: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00447, Train/loss_recog_step=0.232, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]Epoch 54: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.257, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.158, Valid/loss_recog_step=0.248, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.287, Valid/knn_avr=0.632, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  4.00it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.61it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.40it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195293, 0.197651, 0.194829, 0.223721
Valid average loss UNet                 (all)                : 0.811493

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.106604, 1.012049, 2.178175
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.394423, 1.464685, 1.814891
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.571397, 1.955199, 1.892231
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.190886, 1.602854, 2.983284
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.371232, 1.489997, 2.113412
Valid average loss all      (Triplet)                 : 0.364714

== Recognize ==
Valid average loss Recognize     : 0.314614
Valid average accuracy drums     : 98.000000 %
Valid average accuracy bass      : 91.500000 %
Valid average accuracy piano     : 88.000000 %
Valid average accuracy guitar    : 91.000000 %
Valid average accuracy residuals : 93.500000 %

== Valid average loss all : 0.522021

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.431005954742432 sec. =
Valid knn accuracy drums     : 78.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.11928653717041 sec. =
Valid knn accuracy bass      : 39.71774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.823761224746704 sec. =
Valid knn accuracy piano     : 52.734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.340465784072876 sec. =
Valid knn accuracy guitar    : 64.95535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.039621829986572 sec. =
Valid knn accuracy residuals : 77.95454545454545%

Valid knn accuracy average   : 62.72457781962076%

                                                                      [AEpoch 54: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.257, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.230]Epoch 54: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.257, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198239, 0.198726, 0.198700, 0.218873
Train average loss UNet                 (all)                : 0.814538

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001139, 0.884317, 2.366384
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002378, 1.235070, 2.245917
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002404, 1.406332, 2.522918
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002034, 1.457500, 2.844589
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001823, 1.620606, 2.917957
Train average loss all      (Triplet)                 : 0.001932

== Recognize ==
Train average loss Recognize     : 0.226804
Train average accuracy drums     : 99.355003 %
Train average accuracy bass      : 95.639999 %
Train average accuracy piano     : 91.680000 %
Train average accuracy guitar    : 93.150002 %
Train average accuracy residuals : 96.800003 %

== Train average loss all : 0.115334

Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.257, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]          Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.257, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]Epoch 55:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.257, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]Epoch 55:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00362, Train/loss_recog_step=0.255, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]Epoch 55:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00362, Train/loss_recog_step=0.255, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]Epoch 55:  32%|███▏      | 100/313 [02:08<04:33,  0.78it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.00158, Train/loss_recog_step=0.236, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]Epoch 55:  48%|████▊     | 150/313 [03:11<03:27,  0.78it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.00158, Train/loss_recog_step=0.236, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]Epoch 55:  48%|████▊     | 150/313 [03:11<03:27,  0.78it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=0.250, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]Epoch 55:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=0.250, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]Epoch 55:  64%|██████▍   | 200/313 [04:14<02:23,  0.79it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.205, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]  Epoch 55:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.205, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]Epoch 55:  80%|███████▉  | 250/313 [05:15<01:19,  0.79it/s, v_num=0, Train/loss_all_step=0.0901, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.180, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]Epoch 55:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0901, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.180, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]Epoch 55:  96%|█████████▌| 300/313 [06:16<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.211, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227] Epoch 55: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.211, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]Epoch 55: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.255, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.314, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.315, Valid/knn_avr=0.627, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.84it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.79it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.43it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.46it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195225, 0.197512, 0.194779, 0.207051
Valid average loss UNet                 (all)                : 0.794567

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.097767, 1.044021, 2.230720
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.460898, 1.548862, 1.926340
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.415582, 1.814581, 2.012568
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.263826, 1.794547, 3.209729
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.482582, 1.849464, 2.467826
Valid average loss all      (Triplet)                 : 0.360416

== Recognize ==
Valid average loss Recognize     : 0.306850
Valid average accuracy drums     : 97.500000 %
Valid average accuracy bass      : 95.500000 %
Valid average accuracy piano     : 91.000000 %
Valid average accuracy guitar    : 94.000000 %
Valid average accuracy residuals : 91.000000 %

== Valid average loss all : 0.513841

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.33332109451294 sec. =
Valid knn accuracy drums     : 75.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.085051536560059 sec. =
Valid knn accuracy bass      : 41.53225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.476442337036133 sec. =
Valid knn accuracy piano     : 57.8125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.633308410644531 sec. =
Valid knn accuracy guitar    : 65.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.095803499221802 sec. =
Valid knn accuracy residuals : 78.18181818181819%

Valid knn accuracy average   : 63.67379351013642%

                                                                      [AEpoch 55: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.255, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=0.227]Epoch 55: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.255, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198240, 0.198733, 0.198699, 0.218533
Train average loss UNet                 (all)                : 0.814204

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001768, 0.891746, 2.360460
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004161, 1.230888, 2.233606
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002917, 1.394328, 2.497128
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003916, 1.461151, 2.844243
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002688, 1.603568, 2.871049
Train average loss all      (Triplet)                 : 0.003099

== Recognize ==
Train average loss Recognize     : 0.229194
Train average accuracy drums     : 99.285004 %
Train average accuracy bass      : 95.680000 %
Train average accuracy piano     : 91.939995 %
Train average accuracy guitar    : 92.820000 %
Train average accuracy residuals : 96.614998 %

== Train average loss all : 0.117696

Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.255, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]          Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.255, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]Epoch 56:  16%|█▌        | 50/313 [01:11<06:17,  0.70it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.255, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]Epoch 56:  16%|█▌        | 50/313 [01:11<06:17,  0.70it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=0.281, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]Epoch 56:  32%|███▏      | 100/313 [02:13<04:45,  0.75it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=0.281, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]Epoch 56:  32%|███▏      | 100/313 [02:13<04:45,  0.75it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.250, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]  Epoch 56:  48%|████▊     | 150/313 [03:16<03:33,  0.76it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.250, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]Epoch 56:  48%|████▊     | 150/313 [03:16<03:33,  0.76it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.00684, Train/loss_recog_step=0.254, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]Epoch 56:  64%|██████▍   | 200/313 [04:17<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.00684, Train/loss_recog_step=0.254, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]Epoch 56:  64%|██████▍   | 200/313 [04:17<02:25,  0.78it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.258, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]  Epoch 56:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.258, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]Epoch 56:  80%|███████▉  | 250/313 [05:19<01:20,  0.78it/s, v_num=0, Train/loss_all_step=0.0863, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00555, Train/loss_recog_step=0.161, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]Epoch 56:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.0863, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00555, Train/loss_recog_step=0.161, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]Epoch 56:  96%|█████████▌| 300/313 [06:20<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00892, Train/loss_recog_step=0.194, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229] Epoch 56: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00892, Train/loss_recog_step=0.194, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]Epoch 56: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00317, Train/loss_recog_step=0.226, Valid/loss_all_step=0.307, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.290, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.795, Valid/loss_triplet_all_epoch=0.360, Valid/loss_recog_epoch=0.307, Valid/knn_avr=0.637, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.45it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.15it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.63it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:02<00:00,  3.47it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195321, 0.197597, 0.194903, 0.209884
Valid average loss UNet                 (all)                : 0.797705

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.239912, 1.535411, 2.691849
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.468794, 1.588583, 1.869470
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.448994, 1.963691, 2.149425
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.214103, 1.764337, 3.237011
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.377261, 1.658635, 2.357222
Valid average loss all      (Triplet)                 : 0.381745

== Recognize ==
Valid average loss Recognize     : 0.307645
Valid average accuracy drums     : 98.500000 %
Valid average accuracy bass      : 98.000000 %
Valid average accuracy piano     : 83.500000 %
Valid average accuracy guitar    : 93.500000 %
Valid average accuracy residuals : 97.000000 %

== Valid average loss all : 0.535568

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.01981520652771 sec. =
Valid knn accuracy drums     : 76.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.98486065864563 sec. =
Valid knn accuracy bass      : 47.983870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.477334976196289 sec. =
Valid knn accuracy piano     : 57.2265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.345340728759766 sec. =
Valid knn accuracy guitar    : 66.51785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.237356185913086 sec. =
Valid knn accuracy residuals : 78.63636363636364%

Valid knn accuracy average   : 65.29032215374035%

                                                                      [AEpoch 56: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00317, Train/loss_recog_step=0.226, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.229]Epoch 56: 100%|██████████| 313/313 [07:56<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00317, Train/loss_recog_step=0.226, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198345, 0.198831, 0.198797, 0.218924
Train average loss UNet                 (all)                : 0.814897

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000955, 0.869065, 2.328321
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002288, 1.221231, 2.218644
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004005, 1.415672, 2.535596
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002135, 1.467932, 2.877256
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002822, 1.637733, 2.919947
Train average loss all      (Triplet)                 : 0.002453

== Recognize ==
Train average loss Recognize     : 0.224949
Train average accuracy drums     : 99.404999 %
Train average accuracy bass      : 95.635002 %
Train average accuracy piano     : 91.900002 %
Train average accuracy guitar    : 92.909996 %
Train average accuracy residuals : 96.974998 %

== Train average loss all : 0.114928

Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00317, Train/loss_recog_step=0.226, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]          Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00317, Train/loss_recog_step=0.226, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]Epoch 57:  16%|█▌        | 50/313 [01:12<06:18,  0.69it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00317, Train/loss_recog_step=0.226, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]Epoch 57:  16%|█▌        | 50/313 [01:12<06:18,  0.69it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.0065, Train/loss_recog_step=0.284, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225] Epoch 57:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.0065, Train/loss_recog_step=0.284, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]Epoch 57:  32%|███▏      | 100/313 [02:12<04:42,  0.75it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00638, Train/loss_recog_step=0.243, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]Epoch 57:  48%|████▊     | 150/313 [03:10<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00638, Train/loss_recog_step=0.243, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]Epoch 57:  48%|████▊     | 150/313 [03:10<03:26,  0.79it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.210, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]  Epoch 57:  64%|██████▍   | 200/313 [04:11<02:22,  0.80it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.210, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]Epoch 57:  64%|██████▍   | 200/313 [04:11<02:22,  0.80it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.216, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]Epoch 57:  80%|███████▉  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.216, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]Epoch 57:  80%|███████▉  | 250/313 [05:12<01:18,  0.80it/s, v_num=0, Train/loss_all_step=0.0931, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00277, Train/loss_recog_step=0.181, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]Epoch 57:  96%|█████████▌| 300/313 [06:13<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.0931, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00277, Train/loss_recog_step=0.181, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]Epoch 57:  96%|█████████▌| 300/313 [06:13<00:16,  0.80it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.200, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]   Epoch 57: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.200, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]Epoch 57: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.227, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.298, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.308, Valid/knn_avr=0.653, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.34it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:02<00:00,  3.43it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.59it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195017, 0.197365, 0.194568, 0.224651
Valid average loss UNet                 (all)                : 0.811601

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.202533, 1.451997, 2.679892
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.650565, 1.846475, 2.259579
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.394506, 1.819182, 2.054880
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.253258, 1.707283, 3.125270
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.397051, 1.732505, 2.425944
Valid average loss all      (Triplet)                 : 0.388550

== Recognize ==
Valid average loss Recognize     : 0.298034
Valid average accuracy drums     : 99.000000 %
Valid average accuracy bass      : 97.500000 %
Valid average accuracy piano     : 86.000000 %
Valid average accuracy guitar    : 92.000000 %
Valid average accuracy residuals : 93.000000 %

== Valid average loss all : 0.537567

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.743278980255127 sec. =
Valid knn accuracy drums     : 75.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.08433198928833 sec. =
Valid knn accuracy bass      : 42.943548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.57574200630188 sec. =
Valid knn accuracy piano     : 54.296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.579453706741333 sec. =
Valid knn accuracy guitar    : 66.51785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.136253595352173 sec. =
Valid knn accuracy residuals : 78.4090909090909%

Valid knn accuracy average   : 63.47695254867853%

                                                                      [AEpoch 57: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.227, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.294, Valid/loss_all_epoch=0.538, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.635, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=0.225]Epoch 57: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.227, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.294, Valid/loss_all_epoch=0.538, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.635, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.225]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198252, 0.198742, 0.198713, 0.217817
Train average loss UNet                 (all)                : 0.813524

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000646, 0.886687, 2.371713
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003532, 1.237305, 2.244900
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003004, 1.413879, 2.549560
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002582, 1.496506, 2.937462
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002050, 1.708322, 3.048505
Train average loss all      (Triplet)                 : 0.002355

== Recognize ==
Train average loss Recognize     : 0.224735
Train average accuracy drums     : 99.260002 %
Train average accuracy bass      : 95.660004 %
Train average accuracy piano     : 91.495003 %
Train average accuracy guitar    : 92.959999 %
Train average accuracy residuals : 96.770004 %

== Train average loss all : 0.114722

Epoch 57: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.227, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.294, Valid/loss_all_epoch=0.538, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.298, Valid/knn_avr=0.635, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.814, Train/loss_triplet_all_epoch=0.00235, Train/loss_recog_epoch=0.225]
[2023-11-07 19:17:07,571][source.train][INFO] - [rank: 0] Starting testing!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0: 100%|██████████| 16/16 [00:10<00:00,  1.58it/s]Testing DataLoader 0:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 1: 100%|██████████| 15/15 [00:09<00:00,  1.54it/s]Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 2:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 2: 100%|██████████| 15/15 [00:04<00:00,  3.19it/s]Testing DataLoader 2:   0%|          | 0/13 [00:00<?, ?it/s]         Testing DataLoader 3:   0%|          | 0/13 [00:00<?, ?it/s]Testing DataLoader 3: 100%|██████████| 13/13 [00:03<00:00,  3.63it/s]Testing DataLoader 3:   0%|          | 0/14 [00:00<?, ?it/s]         Testing DataLoader 4:   0%|          | 0/14 [00:00<?, ?it/s]Testing DataLoader 4: 100%|██████████| 14/14 [00:04<00:00,  3.06it/s]Testing DataLoader 4:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 5:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 5: 100%|██████████| 15/15 [00:04<00:00,  3.74it/s]
Test average accuracy drums     :  97.799995 %
Test average accuracy bass      :  93.500000 %
Test average accuracy piano     :  86.299995 %
Test average accuracy guitar    :  87.099998 %
Test average accuracy residuals :  94.800003 %
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.533788442611694 sec. =
Test knn accuracy drums     : 93.88646288209607%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.65946340560913 sec. =
Test knn accuracy bass      : 58.139534883720934%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.79485273361206 sec. =
Test knn accuracy piano     : 52.311435523114355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.744635105133057 sec. =
Test knn accuracy guitar    : 50.678733031674206%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.28675675392151 sec. =
Test knn accuracy residuals : 85.14531754574811%

Test knn accuracy average   : 68.03229677327074%
Testing DataLoader 5: 100%|██████████| 15/15 [01:49<00:00,  0.14it/s]
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 0    ┃   DataLoader 1    ┃   DataLoader 2   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.68032294511795… │ 0.68032294511795… │ 0.6803229451179… │
│   Test/knn_bass   │ 0.58139532804489… │ 0.58139532804489… │ 0.5813953280448… │
│  Test/knn_drums   │ 0.93886464834213… │ 0.93886464834213… │ 0.9388646483421… │
│  Test/knn_guitar  │ 0.50678735971450… │ 0.50678735971450… │ 0.5067873597145… │
│  Test/knn_piano   │ 0.52311438322067… │ 0.52311438322067… │ 0.5231143832206… │
│ Test/knn_residua… │ 0.85145318508148… │ 0.85145318508148… │ 0.8514531850814… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 3    ┃   DataLoader 4    ┃   DataLoader 5   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.68032294511795… │ 0.68032294511795… │ 0.6803229451179… │
│   Test/knn_bass   │ 0.58139532804489… │ 0.58139532804489… │ 0.5813953280448… │
│  Test/knn_drums   │ 0.93886464834213… │ 0.93886464834213… │ 0.9388646483421… │
│  Test/knn_guitar  │ 0.50678735971450… │ 0.50678735971450… │ 0.5067873597145… │
│  Test/knn_piano   │ 0.52311438322067… │ 0.52311438322067… │ 0.5231143832206… │
│ Test/knn_residua… │ 0.85145318508148… │ 0.85145318508148… │ 0.8514531850814… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
[2023-11-07 19:20:06,740][source.train][INFO] - [rank: 0] Best ckpt path: /nas02/homes/imamura23-1000067/outputs/triplet_with_unet/runs/2023-11-07/11-35-21/checkpoints/epoch_007.ckpt
[2023-11-07 19:20:06,744][utils.utils][INFO] - [rank: 0] Output dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023-11-07/11-35-21
[2023-11-07 19:20:06,747][utils.utils][INFO] - [rank: 0] Metric name is None! Skipping metric value retrieval...

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Time taken to study : 07:44:45

All prosess was Done!
