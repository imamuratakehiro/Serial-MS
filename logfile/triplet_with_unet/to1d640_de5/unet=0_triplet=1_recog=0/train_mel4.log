
=== Using cuda(utils.func). ===

[2023-11-05 23:14:21,339][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-05 23:14:21,345][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         train_dirname: 3s_on1.5                                               
│         test_dirname: 3s_on1.5                                                
│         load_using_librosa: true                                              
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_train: 3                                                      
│         seconds_test: 3                                                       
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 5.0e-05                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640                         
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: true                                                             
│         n_mels: 259                                                           
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         train_dirname: 3s_on1.5                                               
│         test_dirname: 3s_on1.5                                                
│         load_using_librosa: true                                              
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_train: 3                                                      
│         seconds_test: 3                                                       
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 5.0e-05                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/knn_avr                                                
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: 1                                                         
│         mode: max                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/knn_avr                                                
│         min_delta: 0.0                                                        
│         patience: 50                                                          
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 400                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 400                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       train_dirname: 3s_on1.5                                                 
│       test_dirname: 3s_on1.5                                                  
│       load_using_librosa: true                                                
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_train: 3                                                        
│       seconds_test: 3                                                         
│       sr: 44100                                                               
│       mel: true                                                               
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640                             
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       lr: 5.0e-05                                                             
│       monitor_es: Valid/knn_avr                                               
│       monitor_mode_es: max                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 0                                                            
│       recog_rate: 0                                                           
│       test_psd_mine: false                                                    
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-05 23:14:21,426][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-05 23:14:21,443][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-05 23:14:25,612][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp1s3ubrw5
[2023-11-05 23:14:25,612][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp1s3ubrw5/_remote_module_non_scriptable.py
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=3200, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-05 23:14:26,740][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-05 23:14:26,740][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-05 23:14:26,754][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-05 23:14:26,757][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-05 23:14:26,757][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-05 23:14:26,757][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-05 23:14:26,815][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-05 23:14:27,118][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-05 23:14:27,426][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
The length of seg for train is 3s.
The length of seg for valid and test is 3s.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.6384212970733643 sec. *
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:08<00:00,  0.23it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 1: 100%|██████████| 2/2 [00:00<00:00,  6.61it/s]Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 2: 100%|██████████| 2/2 [00:00<00:00,  9.47it/s]Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 3: 100%|██████████| 2/2 [00:00<00:00, 10.71it/s]Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 4: 100%|██████████| 2/2 [00:00<00:00,  3.52it/s]Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 5:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 5: 100%|██████████| 2/2 [00:00<00:00,  9.96it/s]

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204925, 0.207115, 0.194367, 0.194799
Valid average loss UNet                 (all)                : 0.801206

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.200023, 0.001225, 0.001202
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.200130, 0.001264, 0.001134
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.199797, 0.001086, 0.001288
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.199948, 0.001255, 0.001307
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.200024, 0.001190, 0.001166
Valid average loss all      (Triplet)                 : 0.200007

== Recognize ==
Valid average loss Recognize     : 1.130508
Valid average accuracy drums     : 45.312500 %
Valid average accuracy bass      : 57.812500 %
Valid average accuracy piano     : 52.343750 %
Valid average accuracy guitar    : 49.218750 %
Valid average accuracy residuals : 53.125000 %

== Valid average loss all : 0.200007

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 3.541729688644409 sec. =
Valid knn accuracy drums     : 35.9375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.924182176589966 sec. =
Valid knn accuracy bass      : 22.65625%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 3.0784318447113037 sec. =
Valid knn accuracy piano     : 19.53125%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.9212257862091064 sec. =
Valid knn accuracy guitar    : 39.84375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.9127187728881836 sec. =
Valid knn accuracy residuals : 89.0625%

Valid knn accuracy average   : 41.40625%
                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [01:23<07:20,  0.60it/s]Epoch 0:  16%|█▌        | 50/313 [01:23<07:20,  0.60it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=1.110]Epoch 0:  32%|███▏      | 100/313 [02:27<05:15,  0.68it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=1.110]Epoch 0:  32%|███▏      | 100/313 [02:27<05:15,  0.68it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=1.070]Epoch 0:  48%|████▊     | 150/313 [03:31<03:50,  0.71it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=1.070]Epoch 0:  48%|████▊     | 150/313 [03:31<03:50,  0.71it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.867, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.040]Epoch 0:  64%|██████▍   | 200/313 [04:36<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.867, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.040]Epoch 0:  64%|██████▍   | 200/313 [04:36<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.877, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.120]Epoch 0:  80%|███████▉  | 250/313 [05:41<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.877, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.120]Epoch 0:  80%|███████▉  | 250/313 [05:41<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=1.120]Epoch 0:  96%|█████████▌| 300/313 [06:47<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=1.120]Epoch 0:  96%|█████████▌| 300/313 [06:47<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=1.050]Epoch 0: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=1.050]Epoch 0: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.76it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 10.92it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  7.91it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.27it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.46it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.208634, 0.208956, 0.217763, 0.212498
Valid average loss UNet                 (all)                : 0.847851

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.131818, 0.144767, 0.276315
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.177785, 0.164616, 0.137682
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.201451, 0.221655, 0.232407
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.202512, 0.195093, 0.203873
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.115603, 0.229626, 0.346598
Valid average loss all      (Triplet)                 : 0.178858

== Recognize ==
Valid average loss Recognize     : 1.103859
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.178858

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.306364059448242 sec. =
Valid knn accuracy drums     : 45.869565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.725041627883911 sec. =
Valid knn accuracy bass      : 26.008064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.005943059921265 sec. =
Valid knn accuracy piano     : 36.5234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.087177515029907 sec. =
Valid knn accuracy guitar    : 36.830357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.575413227081299 sec. =
Valid knn accuracy residuals : 69.54545454545455%

Valid knn accuracy average   : 42.9553757843664%

                                                                      [AEpoch 0: 100%|██████████| 313/313 [08:18<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=1.210, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430]Epoch 0: 100%|██████████| 313/313 [08:18<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=1.210, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.209695, 0.211049, 0.213293, 0.212650
Train average loss UNet                 (all)                : 0.846687

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.142177, 0.318653, 0.496839
Train average loss bass     (Triplet, dist_p, dist_n) : 0.232131, 0.300828, 0.282831
Train average loss piano    (Triplet, dist_p, dist_n) : 0.214310, 0.324681, 0.330715
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.215863, 0.300838, 0.301782
Train average loss residuals(Triplet, dist_p, dist_n) : 0.179122, 0.350220, 0.409847
Train average loss all      (Triplet)                 : 0.197715

== Recognize ==
Train average loss Recognize     : 1.087793
Train average accuracy drums     : 50.465000 %
Train average accuracy bass      : 49.540001 %
Train average accuracy piano     : 49.810001 %
Train average accuracy guitar    : 49.910000 %
Train average accuracy residuals : 49.715000 %

== Train average loss all : 0.197715

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=1.210, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=1.210, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]Epoch 1:  16%|█▌        | 50/313 [01:13<06:28,  0.68it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=1.210, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]Epoch 1:  16%|█▌        | 50/313 [01:13<06:28,  0.68it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.150, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]Epoch 1:  32%|███▏      | 100/313 [02:20<04:59,  0.71it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.150, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]Epoch 1:  32%|███▏      | 100/313 [02:20<04:59,  0.71it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=1.090, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]Epoch 1:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=1.090, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]Epoch 1:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.176, Train/loss_recog_step=1.160, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]Epoch 1:  64%|██████▍   | 200/313 [04:33<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.176, Train/loss_recog_step=1.160, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]Epoch 1:  64%|██████▍   | 200/313 [04:33<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.871, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=1.120, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]Epoch 1:  80%|███████▉  | 250/313 [05:41<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.871, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=1.120, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]Epoch 1:  80%|███████▉  | 250/313 [05:41<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.240, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]Epoch 1:  96%|█████████▌| 300/313 [06:46<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.240, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]Epoch 1:  96%|█████████▌| 300/313 [06:46<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.178, Train/loss_recog_step=1.300, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]Epoch 1: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.178, Train/loss_recog_step=1.300, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]Epoch 1: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.160, Valid/loss_all_step=0.175, Valid/loss_unet_all_step=0.856, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.430, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.33it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.67it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.81it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  9.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.208036, 0.208646, 0.216837, 0.193933
Valid average loss UNet                 (all)                : 0.827452

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.156657, 0.148350, 0.357515
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.158786, 0.080111, 0.071390
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.181239, 0.195746, 0.225460
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.183977, 0.144200, 0.160574
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.162078, 0.304119, 0.368018
Valid average loss all      (Triplet)                 : 0.177133

== Recognize ==
Valid average loss Recognize     : 1.269693
Valid average accuracy drums     : 44.000000 %
Valid average accuracy bass      : 43.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 58.499996 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.177133

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.293726682662964 sec. =
Valid knn accuracy drums     : 53.2608695652174%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.001058578491211 sec. =
Valid knn accuracy bass      : 16.93548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.256614685058594 sec. =
Valid knn accuracy piano     : 28.7109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.085745334625244 sec. =
Valid knn accuracy guitar    : 32.142857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.554242134094238 sec. =
Valid knn accuracy residuals : 58.63636363636363%

Valid knn accuracy average   : 37.93730234308118%

                                                                      [AEpoch 1: 100%|██████████| 313/313 [08:17<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.160, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.198, Train/loss_recog_epoch=1.090]Epoch 1: 100%|██████████| 313/313 [08:17<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.160, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.209935, 0.211250, 0.213494, 0.210716
Train average loss UNet                 (all)                : 0.845396

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.098823, 0.176019, 0.451412
Train average loss bass     (Triplet, dist_p, dist_n) : 0.206621, 0.126114, 0.122318
Train average loss piano    (Triplet, dist_p, dist_n) : 0.188982, 0.182952, 0.204635
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.202749, 0.153408, 0.155075
Train average loss residuals(Triplet, dist_p, dist_n) : 0.156261, 0.247355, 0.329566
Train average loss all      (Triplet)                 : 0.171968

== Recognize ==
Train average loss Recognize     : 1.155106
Train average accuracy drums     : 49.654999 %
Train average accuracy bass      : 50.260002 %
Train average accuracy piano     : 49.535000 %
Train average accuracy guitar    : 49.820000 %
Train average accuracy residuals : 49.880001 %

== Train average loss all : 0.171968

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.160, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.160, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]Epoch 2:  16%|█▌        | 50/313 [01:14<06:29,  0.67it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.160, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]Epoch 2:  16%|█▌        | 50/313 [01:14<06:29,  0.67it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.150, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]Epoch 2:  32%|███▏      | 100/313 [02:20<04:59,  0.71it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.150, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]Epoch 2:  32%|███▏      | 100/313 [02:20<04:59,  0.71it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=1.190, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]Epoch 2:  48%|████▊     | 150/313 [03:26<03:44,  0.73it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=1.190, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]Epoch 2:  48%|████▊     | 150/313 [03:26<03:44,  0.73it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.863, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=1.260, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]Epoch 2:  64%|██████▍   | 200/313 [04:33<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.863, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=1.260, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]Epoch 2:  64%|██████▍   | 200/313 [04:33<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.881, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=1.280, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]Epoch 2:  80%|███████▉  | 250/313 [05:41<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.881, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=1.280, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]Epoch 2:  80%|███████▉  | 250/313 [05:41<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.290, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]Epoch 2:  96%|█████████▌| 300/313 [06:48<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.290, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]Epoch 2:  96%|█████████▌| 300/313 [06:48<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.290, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]Epoch 2: 100%|██████████| 313/313 [07:03<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.290, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]Epoch 2: 100%|██████████| 313/313 [07:03<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=1.250, Valid/loss_all_step=0.193, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.379, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.61it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 10.95it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.34it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.55it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  7.27it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.209991, 0.210221, 0.219193, 0.208398
Valid average loss UNet                 (all)                : 0.847803

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.125904, 0.122456, 0.327945
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.151206, 0.061904, 0.060698
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.227674, 0.279130, 0.267540
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.136536, 0.189726, 0.310163
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.145009, 0.291711, 0.372990
Valid average loss all      (Triplet)                 : 0.170688

== Recognize ==
Valid average loss Recognize     : 1.178092
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.170688

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.095815658569336 sec. =
Valid knn accuracy drums     : 55.434782608695656%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.921181201934814 sec. =
Valid knn accuracy bass      : 10.080645161290322%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.91967487335205 sec. =
Valid knn accuracy piano     : 32.03125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.863051414489746 sec. =
Valid knn accuracy guitar    : 39.285714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.652724504470825 sec. =
Valid knn accuracy residuals : 57.04545454545455%

Valid knn accuracy average   : 38.775569320230964%

                                                                      [AEpoch 2: 100%|██████████| 313/313 [08:17<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=1.250, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.160]Epoch 2: 100%|██████████| 313/313 [08:17<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=1.250, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.210102, 0.211423, 0.213630, 0.210702
Train average loss UNet                 (all)                : 0.845858

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.091405, 0.168333, 0.477753
Train average loss bass     (Triplet, dist_p, dist_n) : 0.207077, 0.110101, 0.105217
Train average loss piano    (Triplet, dist_p, dist_n) : 0.185823, 0.181167, 0.205195
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.194496, 0.159229, 0.169870
Train average loss residuals(Triplet, dist_p, dist_n) : 0.147728, 0.245595, 0.342528
Train average loss all      (Triplet)                 : 0.166686

== Recognize ==
Train average loss Recognize     : 1.221077
Train average accuracy drums     : 50.134998 %
Train average accuracy bass      : 49.360001 %
Train average accuracy piano     : 50.145000 %
Train average accuracy guitar    : 49.434998 %
Train average accuracy residuals : 49.834999 %

== Train average loss all : 0.166686

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=1.250, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=1.250, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]Epoch 3:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=1.250, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]Epoch 3:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=1.300, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]Epoch 3:  32%|███▏      | 100/313 [02:20<04:59,  0.71it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=1.300, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]Epoch 3:  32%|███▏      | 100/313 [02:20<04:59,  0.71it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.310, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]Epoch 3:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.310, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]Epoch 3:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=1.230, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]Epoch 3:  64%|██████▍   | 200/313 [04:36<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=1.230, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]Epoch 3:  64%|██████▍   | 200/313 [04:36<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.889, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.210, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]Epoch 3:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.889, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.210, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]Epoch 3:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.240, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]Epoch 3:  96%|█████████▌| 300/313 [06:50<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.240, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]Epoch 3:  96%|█████████▌| 300/313 [06:50<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=1.110, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]Epoch 3: 100%|██████████| 313/313 [07:04<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=1.110, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]Epoch 3: 100%|██████████| 313/313 [07:04<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.110, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.847, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.171, Valid/loss_unet_all_epoch=0.848, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.388, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  8.91it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.73it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.66it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.86it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.34it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.208510, 0.209046, 0.217590, 0.207948
Valid average loss UNet                 (all)                : 0.843094

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.095085, 0.094356, 0.331540
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.147493, 0.064624, 0.067573
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.193090, 0.232904, 0.251979
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.157634, 0.194991, 0.243906
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.118657, 0.309161, 0.426503
Valid average loss all      (Triplet)                 : 0.156444

== Recognize ==
Valid average loss Recognize     : 1.028970
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 60.000004 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.156444

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.918251991271973 sec. =
Valid knn accuracy drums     : 61.30434782608696%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.033653020858765 sec. =
Valid knn accuracy bass      : 12.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.806482315063477 sec. =
Valid knn accuracy piano     : 32.421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.915712356567383 sec. =
Valid knn accuracy guitar    : 32.142857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.889978170394897 sec. =
Valid knn accuracy residuals : 61.36363636363637%

Valid knn accuracy average   : 39.946543266516095%

                                                                      [AEpoch 3: 100%|██████████| 313/313 [08:20<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.110, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.167, Train/loss_recog_epoch=1.220]Epoch 3: 100%|██████████| 313/313 [08:20<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.110, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.210321, 0.211636, 0.213876, 0.211335
Train average loss UNet                 (all)                : 0.847168

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.091980, 0.158043, 0.456287
Train average loss bass     (Triplet, dist_p, dist_n) : 0.204703, 0.115891, 0.113493
Train average loss piano    (Triplet, dist_p, dist_n) : 0.180422, 0.184607, 0.215552
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.182753, 0.180374, 0.206579
Train average loss residuals(Triplet, dist_p, dist_n) : 0.145169, 0.251357, 0.356226
Train average loss all      (Triplet)                 : 0.162336

== Recognize ==
Train average loss Recognize     : 1.226939
Train average accuracy drums     : 50.035000 %
Train average accuracy bass      : 50.384998 %
Train average accuracy piano     : 49.524998 %
Train average accuracy guitar    : 49.880001 %
Train average accuracy residuals : 49.770000 %

== Train average loss all : 0.162336

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.110, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.110, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]Epoch 4:  16%|█▌        | 50/313 [01:12<06:19,  0.69it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.110, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]Epoch 4:  16%|█▌        | 50/313 [01:12<06:19,  0.69it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=1.270, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]Epoch 4:  32%|███▏      | 100/313 [02:20<04:58,  0.71it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=1.270, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]Epoch 4:  32%|███▏      | 100/313 [02:20<04:58,  0.71it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=1.250, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]Epoch 4:  48%|████▊     | 150/313 [03:25<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=1.250, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]Epoch 4:  48%|████▊     | 150/313 [03:25<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=1.240, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]Epoch 4:  64%|██████▍   | 200/313 [04:33<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=1.240, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]Epoch 4:  64%|██████▍   | 200/313 [04:33<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.881, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.130, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]Epoch 4:  80%|███████▉  | 250/313 [05:41<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.881, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.130, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]Epoch 4:  80%|███████▉  | 250/313 [05:41<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.140, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]Epoch 4:  96%|█████████▌| 300/313 [06:47<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.140, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]Epoch 4:  96%|█████████▌| 300/313 [06:47<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.130, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]Epoch 4: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.130, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]Epoch 4: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.180, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=0.735, Valid/loss_all_epoch=0.156, Valid/loss_unet_all_epoch=0.843, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.399, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  7.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.73it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.92it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.10it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  7.70it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.208240, 0.208658, 0.217043, 0.205932
Valid average loss UNet                 (all)                : 0.839873

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.136195, 0.137333, 0.336354
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.157304, 0.082762, 0.075458
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.202446, 0.256911, 0.275214
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.156857, 0.231697, 0.298081
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.136605, 0.303901, 0.400466
Valid average loss all      (Triplet)                 : 0.169779

== Recognize ==
Valid average loss Recognize     : 1.154651
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.169779

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.23553466796875 sec. =
Valid knn accuracy drums     : 64.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.526670932769775 sec. =
Valid knn accuracy bass      : 19.758064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.786719560623169 sec. =
Valid knn accuracy piano     : 25.5859375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.507365942001343 sec. =
Valid knn accuracy guitar    : 37.05357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.118607997894287 sec. =
Valid knn accuracy residuals : 65.68181818181819%

Valid knn accuracy average   : 42.48544354269504%

                                                                      [AEpoch 4: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.180, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.230]Epoch 4: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.180, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.209892, 0.211200, 0.213461, 0.212506
Train average loss UNet                 (all)                : 0.847060

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.084435, 0.158920, 0.473775
Train average loss bass     (Triplet, dist_p, dist_n) : 0.205403, 0.106027, 0.101564
Train average loss piano    (Triplet, dist_p, dist_n) : 0.176871, 0.188226, 0.224658
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.178466, 0.202377, 0.239846
Train average loss residuals(Triplet, dist_p, dist_n) : 0.140291, 0.254121, 0.368419
Train average loss all      (Triplet)                 : 0.158426

== Recognize ==
Train average loss Recognize     : 1.218274
Train average accuracy drums     : 50.375004 %
Train average accuracy bass      : 49.639999 %
Train average accuracy piano     : 49.875000 %
Train average accuracy guitar    : 50.285000 %
Train average accuracy residuals : 50.340004 %

== Train average loss all : 0.158426

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.180, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.180, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]Epoch 5:  16%|█▌        | 50/313 [01:13<06:25,  0.68it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.180, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]Epoch 5:  16%|█▌        | 50/313 [01:13<06:25,  0.68it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.390, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]Epoch 5:  32%|███▏      | 100/313 [02:19<04:56,  0.72it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.390, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]Epoch 5:  32%|███▏      | 100/313 [02:19<04:56,  0.72it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.330, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]Epoch 5:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.330, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]Epoch 5:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=1.320, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]Epoch 5:  64%|██████▍   | 200/313 [04:35<02:35,  0.73it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=1.320, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]Epoch 5:  64%|██████▍   | 200/313 [04:35<02:35,  0.73it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.888, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.190, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]Epoch 5:  80%|███████▉  | 250/313 [05:41<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.888, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.190, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]Epoch 5:  80%|███████▉  | 250/313 [05:41<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.320, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]Epoch 5:  96%|█████████▌| 300/313 [06:47<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.320, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]Epoch 5:  96%|█████████▌| 300/313 [06:47<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.190, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]Epoch 5: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.190, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]Epoch 5: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.220, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.845, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.425, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.79it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.23it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.28it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.94it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.85it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.207986, 0.208151, 0.216760, 0.207457
Valid average loss UNet                 (all)                : 0.840353

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.112606, 0.169062, 0.427824
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.148347, 0.078194, 0.079856
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.192313, 0.334240, 0.391803
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.159464, 0.215917, 0.272433
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.138679, 0.390617, 0.528212
Valid average loss all      (Triplet)                 : 0.164366

== Recognize ==
Valid average loss Recognize     : 1.243897
Valid average accuracy drums     : 57.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.164366

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.227598667144775 sec. =
Valid knn accuracy drums     : 64.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.353530168533325 sec. =
Valid knn accuracy bass      : 26.008064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.717452764511108 sec. =
Valid knn accuracy piano     : 27.34375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.272719383239746 sec. =
Valid knn accuracy guitar    : 42.63392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.649659872055054 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 45.01730672027831%

                                                                      [AEpoch 5: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.220, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.158, Train/loss_unet_all_epoch=0.847, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=1.220]Epoch 5: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.220, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.209556, 0.210889, 0.213128, 0.212265
Train average loss UNet                 (all)                : 0.845839

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.074884, 0.185408, 0.515002
Train average loss bass     (Triplet, dist_p, dist_n) : 0.204141, 0.128064, 0.127216
Train average loss piano    (Triplet, dist_p, dist_n) : 0.177046, 0.199469, 0.237699
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.174853, 0.208221, 0.252983
Train average loss residuals(Triplet, dist_p, dist_n) : 0.137761, 0.267747, 0.387763
Train average loss all      (Triplet)                 : 0.155201

== Recognize ==
Train average loss Recognize     : 1.278308
Train average accuracy drums     : 49.380001 %
Train average accuracy bass      : 49.810001 %
Train average accuracy piano     : 49.915001 %
Train average accuracy guitar    : 49.814999 %
Train average accuracy residuals : 50.110001 %

== Train average loss all : 0.155201

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.220, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.220, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]Epoch 6:  16%|█▌        | 50/313 [01:14<06:32,  0.67it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.220, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]Epoch 6:  16%|█▌        | 50/313 [01:14<06:32,  0.67it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.450, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]Epoch 6:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.450, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]Epoch 6:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.870, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.500, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]Epoch 6:  48%|████▊     | 150/313 [03:22<03:40,  0.74it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.870, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.500, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]Epoch 6:  48%|████▊     | 150/313 [03:22<03:40,  0.74it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.460, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]Epoch 6:  64%|██████▍   | 200/313 [04:28<02:31,  0.74it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.460, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]Epoch 6:  64%|██████▍   | 200/313 [04:28<02:31,  0.74it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.480, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]Epoch 6:  80%|███████▉  | 250/313 [05:35<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.480, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]Epoch 6:  80%|███████▉  | 250/313 [05:35<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.340, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]Epoch 6:  96%|█████████▌| 300/313 [06:42<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.340, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]Epoch 6:  96%|█████████▌| 300/313 [06:42<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.270, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]Epoch 6: 100%|██████████| 313/313 [06:58<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.270, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]Epoch 6: 100%|██████████| 313/313 [06:58<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.470, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.819, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.840, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.450, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.75it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.05it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  7.70it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.43it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.66it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206948, 0.207143, 0.215829, 0.197460
Valid average loss UNet                 (all)                : 0.827381

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.131152, 0.148344, 0.384866
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.154062, 0.091116, 0.087451
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.183985, 0.262156, 0.293596
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.124413, 0.199225, 0.291359
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.149871, 0.316658, 0.390134
Valid average loss all      (Triplet)                 : 0.150706

== Recognize ==
Valid average loss Recognize     : 1.347117
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.150706

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.184077501296997 sec. =
Valid knn accuracy drums     : 64.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.214999914169312 sec. =
Valid knn accuracy bass      : 15.32258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.928953886032104 sec. =
Valid knn accuracy piano     : 32.6171875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.232449054718018 sec. =
Valid knn accuracy guitar    : 38.169642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.21449589729309 sec. =
Valid knn accuracy residuals : 65.0%

Valid knn accuracy average   : 43.17840393959127%

                                                                      [AEpoch 6: 100%|██████████| 313/313 [08:17<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.470, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.155, Train/loss_unet_all_epoch=0.846, Train/loss_triplet_all_epoch=0.155, Train/loss_recog_epoch=1.280]Epoch 6: 100%|██████████| 313/313 [08:17<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.470, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.209519, 0.210800, 0.213078, 0.211492
Train average loss UNet                 (all)                : 0.844889

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.071441, 0.194317, 0.534357
Train average loss bass     (Triplet, dist_p, dist_n) : 0.203873, 0.118162, 0.116351
Train average loss piano    (Triplet, dist_p, dist_n) : 0.174699, 0.195094, 0.236427
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.170023, 0.204253, 0.256053
Train average loss residuals(Triplet, dist_p, dist_n) : 0.133488, 0.278247, 0.410223
Train average loss all      (Triplet)                 : 0.152360

== Recognize ==
Train average loss Recognize     : 1.370205
Train average accuracy drums     : 50.105000 %
Train average accuracy bass      : 49.665001 %
Train average accuracy piano     : 50.419998 %
Train average accuracy guitar    : 49.689999 %
Train average accuracy residuals : 50.475002 %

== Train average loss all : 0.152360

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.470, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.470, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]Epoch 7:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.470, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]Epoch 7:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=1.380, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]Epoch 7:  32%|███▏      | 100/313 [02:19<04:56,  0.72it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=1.380, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]Epoch 7:  32%|███▏      | 100/313 [02:19<04:56,  0.72it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.460, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]Epoch 7:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.460, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]Epoch 7:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.450, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]Epoch 7:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.450, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]Epoch 7:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.881, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.340, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]Epoch 7:  80%|███████▉  | 250/313 [05:37<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.881, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.340, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]Epoch 7:  80%|███████▉  | 250/313 [05:37<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=1.570, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]Epoch 7:  96%|█████████▌| 300/313 [06:43<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=1.570, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]Epoch 7:  96%|█████████▌| 300/313 [06:43<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.450, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]Epoch 7: 100%|██████████| 313/313 [06:58<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.450, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]Epoch 7: 100%|██████████| 313/313 [06:58<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.500, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.432, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.80it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.67it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.43it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 11.62it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.28it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.45it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206384, 0.206437, 0.215362, 0.202650
Valid average loss UNet                 (all)                : 0.830832

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.114038, 0.166612, 0.450321
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.150927, 0.079736, 0.078809
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.168668, 0.264893, 0.328983
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.162655, 0.220270, 0.264808
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.135974, 0.354308, 0.458082
Valid average loss all      (Triplet)                 : 0.158652

== Recognize ==
Valid average loss Recognize     : 1.450950
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.158652

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.953961372375488 sec. =
Valid knn accuracy drums     : 66.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.635437965393066 sec. =
Valid knn accuracy bass      : 19.35483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.679155111312866 sec. =
Valid knn accuracy piano     : 34.765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.448006391525269 sec. =
Valid knn accuracy guitar    : 43.526785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.483820676803589 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 45.74091233538552%

                                                                      [AEpoch 7: 100%|██████████| 313/313 [08:14<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.500, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.152, Train/loss_unet_all_epoch=0.845, Train/loss_triplet_all_epoch=0.152, Train/loss_recog_epoch=1.370]Epoch 7: 100%|██████████| 313/313 [08:15<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.500, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.209119, 0.210416, 0.212680, 0.211653
Train average loss UNet                 (all)                : 0.843868

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.069580, 0.199259, 0.557446
Train average loss bass     (Triplet, dist_p, dist_n) : 0.200059, 0.135984, 0.140787
Train average loss piano    (Triplet, dist_p, dist_n) : 0.171082, 0.208300, 0.254781
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.167845, 0.213476, 0.267391
Train average loss residuals(Triplet, dist_p, dist_n) : 0.128124, 0.281228, 0.421862
Train average loss all      (Triplet)                 : 0.148795

== Recognize ==
Train average loss Recognize     : 1.426888
Train average accuracy drums     : 49.950001 %
Train average accuracy bass      : 49.430000 %
Train average accuracy piano     : 49.939999 %
Train average accuracy guitar    : 49.314999 %
Train average accuracy residuals : 49.880001 %

== Train average loss all : 0.148795

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.500, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.500, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]Epoch 8:  16%|█▌        | 50/313 [01:12<06:19,  0.69it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.500, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]Epoch 8:  16%|█▌        | 50/313 [01:12<06:19,  0.69it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.280, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]Epoch 8:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.280, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]Epoch 8:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.867, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.240, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]Epoch 8:  48%|████▊     | 150/313 [03:22<03:40,  0.74it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.867, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.240, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]Epoch 8:  48%|████▊     | 150/313 [03:22<03:40,  0.74it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.340, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]Epoch 8:  64%|██████▍   | 200/313 [04:27<02:31,  0.75it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.340, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]Epoch 8:  64%|██████▍   | 200/313 [04:27<02:31,  0.75it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.490, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]Epoch 8:  80%|███████▉  | 250/313 [05:30<01:23,  0.76it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.490, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]Epoch 8:  80%|███████▉  | 250/313 [05:30<01:23,  0.76it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.560, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]Epoch 8:  96%|█████████▌| 300/313 [06:34<00:17,  0.76it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.560, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]Epoch 8:  96%|█████████▌| 300/313 [06:34<00:17,  0.76it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.370, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]Epoch 8: 100%|██████████| 313/313 [06:49<00:00,  0.77it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.370, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]Epoch 8: 100%|██████████| 313/313 [06:49<00:00,  0.77it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.480, Valid/loss_all_step=0.151, Valid/loss_unet_all_step=0.827, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.457, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.23it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00,  8.88it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  7.67it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.02it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204975, 0.205295, 0.213997, 0.203962
Valid average loss UNet                 (all)                : 0.828229

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.114139, 0.202516, 0.506222
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.155246, 0.100756, 0.095720
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.142249, 0.266699, 0.348860
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.170081, 0.221232, 0.270977
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.139036, 0.386226, 0.488894
Valid average loss all      (Triplet)                 : 0.151613

== Recognize ==
Valid average loss Recognize     : 1.497374
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 41.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 44.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.151613

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.545686483383179 sec. =
Valid knn accuracy drums     : 68.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.482444286346436 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.055667161941528 sec. =
Valid knn accuracy piano     : 36.71875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.043265581130981 sec. =
Valid knn accuracy guitar    : 32.142857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.30944299697876 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 44.63101708074534%

                                                                      [AEpoch 8: 100%|██████████| 313/313 [08:10<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.480, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.430]Epoch 8: 100%|██████████| 313/313 [08:10<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.480, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.209309, 0.210621, 0.212885, 0.211215
Train average loss UNet                 (all)                : 0.844030

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.067077, 0.203311, 0.572875
Train average loss bass     (Triplet, dist_p, dist_n) : 0.199583, 0.146047, 0.150943
Train average loss piano    (Triplet, dist_p, dist_n) : 0.167345, 0.225321, 0.279704
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.164740, 0.234876, 0.299351
Train average loss residuals(Triplet, dist_p, dist_n) : 0.126064, 0.296130, 0.442000
Train average loss all      (Triplet)                 : 0.146468

== Recognize ==
Train average loss Recognize     : 1.412467
Train average accuracy drums     : 50.655003 %
Train average accuracy bass      : 50.370003 %
Train average accuracy piano     : 50.494999 %
Train average accuracy guitar    : 49.939999 %
Train average accuracy residuals : 49.974998 %

== Train average loss all : 0.146468

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.480, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.480, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]Epoch 9:  16%|█▌        | 50/313 [01:12<06:21,  0.69it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.480, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]Epoch 9:  16%|█▌        | 50/313 [01:12<06:21,  0.69it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.340, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]Epoch 9:  32%|███▏      | 100/313 [02:15<04:49,  0.74it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.340, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]Epoch 9:  32%|███▏      | 100/313 [02:15<04:49,  0.74it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.863, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.380, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]Epoch 9:  48%|████▊     | 150/313 [03:21<03:38,  0.74it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.863, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.380, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]Epoch 9:  48%|████▊     | 150/313 [03:21<03:38,  0.74it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.540, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]Epoch 9:  64%|██████▍   | 200/313 [04:25<02:30,  0.75it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.540, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]Epoch 9:  64%|██████▍   | 200/313 [04:25<02:30,  0.75it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=1.290, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]Epoch 9:  80%|███████▉  | 250/313 [05:34<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=1.290, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]Epoch 9:  80%|███████▉  | 250/313 [05:34<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.480, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]Epoch 9:  96%|█████████▌| 300/313 [06:39<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.480, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]Epoch 9:  96%|█████████▌| 300/313 [06:39<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.170, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]Epoch 9: 100%|██████████| 313/313 [06:53<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.170, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]Epoch 9: 100%|██████████| 313/313 [06:53<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.590, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.446, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 10.43it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.07it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.87it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.14it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206594, 0.206590, 0.215410, 0.192555
Valid average loss UNet                 (all)                : 0.821149

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.133833, 0.168220, 0.393867
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.143300, 0.087250, 0.093950
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.143029, 0.282547, 0.358356
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.144969, 0.217354, 0.294433
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.161713, 0.425201, 0.499542
Valid average loss all      (Triplet)                 : 0.145477

== Recognize ==
Valid average loss Recognize     : 1.407913
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.145477

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.791208744049072 sec. =
Valid knn accuracy drums     : 72.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.50841474533081 sec. =
Valid knn accuracy bass      : 18.346774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.234226942062378 sec. =
Valid knn accuracy piano     : 31.0546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.77915358543396 sec. =
Valid knn accuracy guitar    : 35.49107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.124793529510498 sec. =
Valid knn accuracy residuals : 62.5%

Valid knn accuracy average   : 43.91328923311962%

                                                                      [AEpoch 9: 100%|██████████| 313/313 [08:07<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.590, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.410]Epoch 9: 100%|██████████| 313/313 [08:07<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.590, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208703, 0.210001, 0.212274, 0.210974
Train average loss UNet                 (all)                : 0.841952

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.066276, 0.218119, 0.612749
Train average loss bass     (Triplet, dist_p, dist_n) : 0.196885, 0.151448, 0.161383
Train average loss piano    (Triplet, dist_p, dist_n) : 0.165592, 0.230606, 0.287623
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.159814, 0.231960, 0.302977
Train average loss residuals(Triplet, dist_p, dist_n) : 0.120696, 0.307051, 0.464299
Train average loss all      (Triplet)                 : 0.143421

== Recognize ==
Train average loss Recognize     : 1.416554
Train average accuracy drums     : 50.344997 %
Train average accuracy bass      : 49.380001 %
Train average accuracy piano     : 49.549999 %
Train average accuracy guitar    : 49.759998 %
Train average accuracy residuals : 49.695000 %

== Train average loss all : 0.143421

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.590, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.590, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]Epoch 10:  16%|█▌        | 50/313 [01:12<06:21,  0.69it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.590, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]Epoch 10:  16%|█▌        | 50/313 [01:12<06:21,  0.69it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.520, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]Epoch 10:  32%|███▏      | 100/313 [02:17<04:53,  0.73it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.520, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]Epoch 10:  32%|███▏      | 100/313 [02:17<04:53,  0.73it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=1.540, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]Epoch 10:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=1.540, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]Epoch 10:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.550, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]Epoch 10:  64%|██████▍   | 200/313 [04:29<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.550, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]Epoch 10:  64%|██████▍   | 200/313 [04:29<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.875, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.420, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]Epoch 10:  80%|███████▉  | 250/313 [05:34<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.875, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.420, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]Epoch 10:  80%|███████▉  | 250/313 [05:34<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.460, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]Epoch 10:  96%|█████████▌| 300/313 [06:38<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.460, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]Epoch 10:  96%|█████████▌| 300/313 [06:38<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=1.350, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]Epoch 10: 100%|██████████| 313/313 [06:53<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=1.350, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]Epoch 10: 100%|██████████| 313/313 [06:53<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.220, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.145, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.439, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.62it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  8.81it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.14it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 11.01it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  7.98it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  7.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206717, 0.206673, 0.215504, 0.207412
Valid average loss UNet                 (all)                : 0.836306

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.122866, 0.236012, 0.574671
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.144866, 0.141126, 0.149160
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.178277, 0.313085, 0.358222
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.141244, 0.243984, 0.325180
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.165496, 0.453607, 0.524849
Valid average loss all      (Triplet)                 : 0.154055

== Recognize ==
Valid average loss Recognize     : 1.370469
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.154055

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.934089660644531 sec. =
Valid knn accuracy drums     : 74.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.627707719802856 sec. =
Valid knn accuracy bass      : 17.338709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.858601093292236 sec. =
Valid knn accuracy piano     : 24.0234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.529946088790894 sec. =
Valid knn accuracy guitar    : 35.714285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.579063653945923 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 43.466669977550495%

                                                                      [AEpoch 10: 100%|██████████| 313/313 [08:11<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.220, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.420]Epoch 10: 100%|██████████| 313/313 [08:11<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.220, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208554, 0.209837, 0.212137, 0.210623
Train average loss UNet                 (all)                : 0.841151

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.063033, 0.217896, 0.618366
Train average loss bass     (Triplet, dist_p, dist_n) : 0.194715, 0.156585, 0.169309
Train average loss piano    (Triplet, dist_p, dist_n) : 0.164214, 0.238186, 0.299889
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.157081, 0.240311, 0.318244
Train average loss residuals(Triplet, dist_p, dist_n) : 0.114438, 0.322603, 0.491231
Train average loss all      (Triplet)                 : 0.140360

== Recognize ==
Train average loss Recognize     : 1.455691
Train average accuracy drums     : 50.269997 %
Train average accuracy bass      : 50.475002 %
Train average accuracy piano     : 49.880001 %
Train average accuracy guitar    : 50.075001 %
Train average accuracy residuals : 50.120003 %

== Train average loss all : 0.140360

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.220, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.220, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]Epoch 11:  16%|█▌        | 50/313 [01:13<06:28,  0.68it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.220, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]Epoch 11:  16%|█▌        | 50/313 [01:13<06:28,  0.68it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.420, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]Epoch 11:  32%|███▏      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.420, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]Epoch 11:  32%|███▏      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.460, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]Epoch 11:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.460, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]Epoch 11:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.350, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]Epoch 11:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.350, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]Epoch 11:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.440, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]Epoch 11:  80%|███████▉  | 250/313 [05:37<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.440, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]Epoch 11:  80%|███████▉  | 250/313 [05:37<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.510, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]Epoch 11:  96%|█████████▌| 300/313 [06:41<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.510, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]Epoch 11:  96%|█████████▌| 300/313 [06:41<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=1.380, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]Epoch 11: 100%|██████████| 313/313 [06:56<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=1.380, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]Epoch 11: 100%|██████████| 313/313 [06:56<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.430, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.435, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.62it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.78it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.94it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  9.43it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 11.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205943, 0.206275, 0.214849, 0.198792
Valid average loss UNet                 (all)                : 0.825859

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.134714, 0.233885, 0.497292
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.128853, 0.139249, 0.164636
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.173184, 0.301273, 0.353384
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.164696, 0.236867, 0.285603
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.172970, 0.421382, 0.495951
Valid average loss all      (Triplet)                 : 0.154013

== Recognize ==
Valid average loss Recognize     : 1.369166
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.154013

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.608097791671753 sec. =
Valid knn accuracy drums     : 76.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.715156316757202 sec. =
Valid knn accuracy bass      : 19.35483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.954401969909668 sec. =
Valid knn accuracy piano     : 21.6796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.689225912094116 sec. =
Valid knn accuracy guitar    : 33.705357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.582679510116577 sec. =
Valid knn accuracy residuals : 67.27272727272727%

Valid knn accuracy average   : 43.706869951139325%

                                                                      [AEpoch 11: 100%|██████████| 313/313 [08:14<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.430, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.460]Epoch 11: 100%|██████████| 313/313 [08:14<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.430, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208410, 0.209697, 0.212010, 0.211319
Train average loss UNet                 (all)                : 0.841435

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.061250, 0.226009, 0.637585
Train average loss bass     (Triplet, dist_p, dist_n) : 0.191394, 0.166014, 0.184694
Train average loss piano    (Triplet, dist_p, dist_n) : 0.159000, 0.245514, 0.312483
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.153724, 0.253699, 0.337411
Train average loss residuals(Triplet, dist_p, dist_n) : 0.112325, 0.343794, 0.523334
Train average loss all      (Triplet)                 : 0.137123

== Recognize ==
Train average loss Recognize     : 1.448405
Train average accuracy drums     : 49.639999 %
Train average accuracy bass      : 49.610001 %
Train average accuracy piano     : 49.919998 %
Train average accuracy guitar    : 50.094997 %
Train average accuracy residuals : 50.489998 %

== Train average loss all : 0.137123

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.430, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.430, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]Epoch 12:  16%|█▌        | 50/313 [01:12<06:22,  0.69it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.430, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]Epoch 12:  16%|█▌        | 50/313 [01:12<06:22,  0.69it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.510, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]Epoch 12:  32%|███▏      | 100/313 [02:17<04:52,  0.73it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.510, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]Epoch 12:  32%|███▏      | 100/313 [02:17<04:52,  0.73it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.480, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]Epoch 12:  48%|████▊     | 150/313 [03:22<03:40,  0.74it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.480, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]Epoch 12:  48%|████▊     | 150/313 [03:22<03:40,  0.74it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=1.380, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]Epoch 12:  64%|██████▍   | 200/313 [04:29<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=1.380, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]Epoch 12:  64%|██████▍   | 200/313 [04:29<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.870, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.430, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]Epoch 12:  80%|███████▉  | 250/313 [05:33<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.870, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.430, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]Epoch 12:  80%|███████▉  | 250/313 [05:33<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.440, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]Epoch 12:  96%|█████████▌| 300/313 [06:39<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.440, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]Epoch 12:  96%|█████████▌| 300/313 [06:39<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=1.340, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]Epoch 12: 100%|██████████| 313/313 [06:53<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=1.340, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]Epoch 12: 100%|██████████| 313/313 [06:53<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.510, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.437, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  8.51it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.57it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 11.17it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.95it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.203106, 0.203489, 0.211625, 0.200426
Valid average loss UNet                 (all)                : 0.818646

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.143763, 0.266412, 0.534901
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.137389, 0.143025, 0.164407
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.201847, 0.382280, 0.410317
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.162250, 0.301256, 0.372263
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.133852, 0.490490, 0.641658
Valid average loss all      (Triplet)                 : 0.162703

== Recognize ==
Valid average loss Recognize     : 1.455359
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.162703

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.285027265548706 sec. =
Valid knn accuracy drums     : 76.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.79111361503601 sec. =
Valid knn accuracy bass      : 13.709677419354838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.194491624832153 sec. =
Valid knn accuracy piano     : 27.1484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.462287664413452 sec. =
Valid knn accuracy guitar    : 32.142857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.159976243972778 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 44.03892959030801%

                                                                      [AEpoch 12: 100%|██████████| 313/313 [08:12<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.510, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=1.450]Epoch 12: 100%|██████████| 313/313 [08:12<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.510, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207759, 0.209065, 0.211377, 0.210245
Train average loss UNet                 (all)                : 0.838447

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.058005, 0.233532, 0.672871
Train average loss bass     (Triplet, dist_p, dist_n) : 0.185683, 0.173806, 0.199595
Train average loss piano    (Triplet, dist_p, dist_n) : 0.156468, 0.262196, 0.338589
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.145709, 0.267111, 0.364396
Train average loss residuals(Triplet, dist_p, dist_n) : 0.107438, 0.353095, 0.544600
Train average loss all      (Triplet)                 : 0.132269

== Recognize ==
Train average loss Recognize     : 1.470348
Train average accuracy drums     : 49.169998 %
Train average accuracy bass      : 49.735001 %
Train average accuracy piano     : 49.485001 %
Train average accuracy guitar    : 50.005001 %
Train average accuracy residuals : 50.405003 %

== Train average loss all : 0.132269

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.510, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.510, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]Epoch 13:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.510, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]Epoch 13:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.470, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]Epoch 13:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.470, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]Epoch 13:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.370, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]Epoch 13:  48%|████▊     | 150/313 [03:22<03:40,  0.74it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.370, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]Epoch 13:  48%|████▊     | 150/313 [03:22<03:40,  0.74it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.510, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]Epoch 13:  64%|██████▍   | 200/313 [04:27<02:31,  0.75it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.510, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]Epoch 13:  64%|██████▍   | 200/313 [04:27<02:31,  0.75it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.460, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]Epoch 13:  80%|███████▉  | 250/313 [05:32<01:23,  0.75it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.460, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]Epoch 13:  80%|███████▉  | 250/313 [05:32<01:23,  0.75it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.450, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]Epoch 13:  96%|█████████▌| 300/313 [06:37<00:17,  0.76it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.450, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]Epoch 13:  96%|█████████▌| 300/313 [06:37<00:17,  0.76it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.410, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]Epoch 13: 100%|██████████| 313/313 [06:51<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.410, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]Epoch 13: 100%|██████████| 313/313 [06:51<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.530, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.65it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.63it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.55it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 11.27it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  7.11it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204998, 0.205280, 0.213872, 0.202808
Valid average loss UNet                 (all)                : 0.826957

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090319, 0.239442, 0.589294
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.133778, 0.144541, 0.173199
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.169325, 0.372104, 0.440327
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.175392, 0.323103, 0.397200
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.165417, 0.528213, 0.642036
Valid average loss all      (Triplet)                 : 0.155232

== Recognize ==
Valid average loss Recognize     : 1.343022
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 43.500000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.155232

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.72464632987976 sec. =
Valid knn accuracy drums     : 68.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.319257736206055 sec. =
Valid knn accuracy bass      : 20.766129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.419181823730469 sec. =
Valid knn accuracy piano     : 28.3203125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.58426022529602 sec. =
Valid knn accuracy guitar    : 27.67857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.067468166351318 sec. =
Valid knn accuracy residuals : 75.22727272727273%

Valid knn accuracy average   : 44.094109311533494%

                                                                      [AEpoch 13: 100%|██████████| 313/313 [08:08<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.530, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.470]Epoch 13: 100%|██████████| 313/313 [08:08<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.530, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207728, 0.209007, 0.211291, 0.210765
Train average loss UNet                 (all)                : 0.838791

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.055497, 0.240576, 0.692539
Train average loss bass     (Triplet, dist_p, dist_n) : 0.182039, 0.184868, 0.216704
Train average loss piano    (Triplet, dist_p, dist_n) : 0.150782, 0.277423, 0.364570
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.143952, 0.285329, 0.390114
Train average loss residuals(Triplet, dist_p, dist_n) : 0.103971, 0.370630, 0.575930
Train average loss all      (Triplet)                 : 0.128849

== Recognize ==
Train average loss Recognize     : 1.453719
Train average accuracy drums     : 50.459999 %
Train average accuracy bass      : 50.125004 %
Train average accuracy piano     : 49.630001 %
Train average accuracy guitar    : 49.930000 %
Train average accuracy residuals : 50.024998 %

== Train average loss all : 0.128849

Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.530, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]          Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.530, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]Epoch 14:  16%|█▌        | 50/313 [01:14<06:33,  0.67it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.530, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]Epoch 14:  16%|█▌        | 50/313 [01:14<06:33,  0.67it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.430, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]Epoch 14:  32%|███▏      | 100/313 [02:18<04:56,  0.72it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.430, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]Epoch 14:  32%|███▏      | 100/313 [02:18<04:56,  0.72it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.530, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]Epoch 14:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.530, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]Epoch 14:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.089, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.089, Train/loss_recog_step=1.580, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]Epoch 14:  64%|██████▍   | 200/313 [04:30<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.089, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.089, Train/loss_recog_step=1.580, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]Epoch 14:  64%|██████▍   | 200/313 [04:30<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.883, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.310, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]Epoch 14:  80%|███████▉  | 250/313 [05:35<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.883, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.310, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]Epoch 14:  80%|███████▉  | 250/313 [05:35<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.500, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]Epoch 14:  96%|█████████▌| 300/313 [06:41<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.500, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]Epoch 14:  96%|█████████▌| 300/313 [06:41<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=1.460, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]Epoch 14: 100%|██████████| 313/313 [06:56<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=1.460, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]Epoch 14: 100%|██████████| 313/313 [06:56<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.440, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.441, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.67it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 10.10it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.60it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.34it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.53it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  8.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.203467, 0.203490, 0.212151, 0.197448
Valid average loss UNet                 (all)                : 0.816556

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070623, 0.243735, 0.579068
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.134734, 0.168081, 0.191099
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.182663, 0.405063, 0.459813
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.170582, 0.361041, 0.440610
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.177195, 0.520761, 0.605356
Valid average loss all      (Triplet)                 : 0.153832

== Recognize ==
Valid average loss Recognize     : 1.547891
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.153832

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.757826805114746 sec. =
Valid knn accuracy drums     : 69.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.60175371170044 sec. =
Valid knn accuracy bass      : 16.93548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.468875885009766 sec. =
Valid knn accuracy piano     : 30.2734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.758415699005127 sec. =
Valid knn accuracy guitar    : 36.38392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.08620548248291 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 44.58615892128559%

                                                                      [AEpoch 14: 100%|██████████| 313/313 [08:17<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.440, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.129, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.450]Epoch 14: 100%|██████████| 313/313 [08:17<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.440, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208008, 0.209294, 0.211590, 0.210515
Train average loss UNet                 (all)                : 0.839406

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.055095, 0.253458, 0.716583
Train average loss bass     (Triplet, dist_p, dist_n) : 0.179470, 0.191741, 0.228025
Train average loss piano    (Triplet, dist_p, dist_n) : 0.147979, 0.294583, 0.389175
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.138743, 0.292666, 0.407895
Train average loss residuals(Triplet, dist_p, dist_n) : 0.100152, 0.382354, 0.594056
Train average loss all      (Triplet)                 : 0.125791

== Recognize ==
Train average loss Recognize     : 1.476300
Train average accuracy drums     : 49.654999 %
Train average accuracy bass      : 49.599998 %
Train average accuracy piano     : 50.424999 %
Train average accuracy guitar    : 49.730000 %
Train average accuracy residuals : 50.019997 %

== Train average loss all : 0.125791

Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.440, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]          Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.440, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]Epoch 15:  16%|█▌        | 50/313 [01:15<06:37,  0.66it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.440, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]Epoch 15:  16%|█▌        | 50/313 [01:15<06:37,  0.66it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.300, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]Epoch 15:  32%|███▏      | 100/313 [02:19<04:57,  0.72it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.300, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]Epoch 15:  32%|███▏      | 100/313 [02:19<04:57,  0.71it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.560, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]Epoch 15:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.560, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]Epoch 15:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.0788, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0788, Train/loss_recog_step=1.430, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]Epoch 15:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.0788, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0788, Train/loss_recog_step=1.430, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]Epoch 15:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.879, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.410, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]  Epoch 15:  80%|███████▉  | 250/313 [05:36<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.879, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.410, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]Epoch 15:  80%|███████▉  | 250/313 [05:36<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.460, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]Epoch 15:  96%|█████████▌| 300/313 [06:42<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.460, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]Epoch 15:  96%|█████████▌| 300/313 [06:42<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=1.390, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]Epoch 15: 100%|██████████| 313/313 [06:56<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=1.390, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]Epoch 15: 100%|██████████| 313/313 [06:56<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.760, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.446, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.65it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.57it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.78it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 11.40it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.52it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.94it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.203372, 0.203632, 0.212040, 0.196278
Valid average loss UNet                 (all)                : 0.815322

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083338, 0.263335, 0.587756
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.124161, 0.171458, 0.220691
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.189600, 0.444076, 0.499595
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.167651, 0.360505, 0.453491
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.212118, 0.570778, 0.618581
Valid average loss all      (Triplet)                 : 0.160654

== Recognize ==
Valid average loss Recognize     : 1.503411
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 44.500000 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.160654

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.430454015731812 sec. =
Valid knn accuracy drums     : 77.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.699768543243408 sec. =
Valid knn accuracy bass      : 14.919354838709678%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.706559658050537 sec. =
Valid knn accuracy piano     : 29.4921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.495627641677856 sec. =
Valid knn accuracy guitar    : 37.05357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.328678131103516 sec. =
Valid knn accuracy residuals : 68.4090909090909%

Valid knn accuracy average   : 45.54005832657875%

                                                                      [AEpoch 15: 100%|██████████| 313/313 [08:16<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.760, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.126, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.480]Epoch 15: 100%|██████████| 313/313 [08:16<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.760, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207596, 0.208874, 0.211183, 0.209846
Train average loss UNet                 (all)                : 0.837499

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.052219, 0.258551, 0.736003
Train average loss bass     (Triplet, dist_p, dist_n) : 0.176485, 0.194975, 0.235990
Train average loss piano    (Triplet, dist_p, dist_n) : 0.143197, 0.306136, 0.408618
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.135955, 0.300267, 0.422716
Train average loss residuals(Triplet, dist_p, dist_n) : 0.097235, 0.398353, 0.622006
Train average loss all      (Triplet)                 : 0.122620

== Recognize ==
Train average loss Recognize     : 1.511036
Train average accuracy drums     : 50.195004 %
Train average accuracy bass      : 50.160004 %
Train average accuracy piano     : 50.309998 %
Train average accuracy guitar    : 49.904999 %
Train average accuracy residuals : 50.585003 %

== Train average loss all : 0.122620

Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.760, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]          Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.760, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]Epoch 16:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.760, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]Epoch 16:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=1.510, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]Epoch 16:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=1.510, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]Epoch 16:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.550, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]Epoch 16:  48%|████▊     | 150/313 [03:23<03:41,  0.74it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.550, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]Epoch 16:  48%|████▊     | 150/313 [03:23<03:41,  0.74it/s, v_num=0, Train/loss_all_step=0.089, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.089, Train/loss_recog_step=1.540, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]Epoch 16:  64%|██████▍   | 200/313 [04:28<02:31,  0.74it/s, v_num=0, Train/loss_all_step=0.089, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.089, Train/loss_recog_step=1.540, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]Epoch 16:  64%|██████▍   | 200/313 [04:28<02:31,  0.74it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.877, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=1.550, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]Epoch 16:  80%|███████▉  | 250/313 [05:31<01:23,  0.75it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.877, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=1.550, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]Epoch 16:  80%|███████▉  | 250/313 [05:31<01:23,  0.75it/s, v_num=0, Train/loss_all_step=0.0947, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0947, Train/loss_recog_step=1.490, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]Epoch 16:  96%|█████████▌| 300/313 [06:36<00:17,  0.76it/s, v_num=0, Train/loss_all_step=0.0947, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0947, Train/loss_recog_step=1.490, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]Epoch 16:  96%|█████████▌| 300/313 [06:36<00:17,  0.76it/s, v_num=0, Train/loss_all_step=0.0941, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0941, Train/loss_recog_step=1.640, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]Epoch 16: 100%|██████████| 313/313 [06:50<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.0941, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0941, Train/loss_recog_step=1.640, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]Epoch 16: 100%|██████████| 313/313 [06:50<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.380, Valid/loss_all_step=0.165, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.500, Valid/knn_avr=0.455, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.46it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00,  8.96it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00,  9.21it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.06it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.203625, 0.203599, 0.212104, 0.200155
Valid average loss UNet                 (all)                : 0.819483

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090000, 0.257167, 0.606543
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.136995, 0.201409, 0.236325
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.193470, 0.499587, 0.537475
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.165957, 0.383595, 0.474495
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.131876, 0.554816, 0.695007
Valid average loss all      (Triplet)                 : 0.152990

== Recognize ==
Valid average loss Recognize     : 1.427964
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 43.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.152990

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.116344451904297 sec. =
Valid knn accuracy drums     : 79.13043478260869%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.517264366149902 sec. =
Valid knn accuracy bass      : 15.725806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.116094827651978 sec. =
Valid knn accuracy piano     : 34.9609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.72415280342102 sec. =
Valid knn accuracy guitar    : 31.026785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.200906991958618 sec. =
Valid knn accuracy residuals : 72.5%

Valid knn accuracy average   : 46.66879288970146%

                                                                      [AEpoch 16: 100%|██████████| 313/313 [08:09<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.380, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.123, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.123, Train/loss_recog_epoch=1.510]Epoch 16: 100%|██████████| 313/313 [08:09<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.380, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207542, 0.208847, 0.211133, 0.210368
Train average loss UNet                 (all)                : 0.837890

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.049685, 0.270511, 0.775408
Train average loss bass     (Triplet, dist_p, dist_n) : 0.173785, 0.202450, 0.246721
Train average loss piano    (Triplet, dist_p, dist_n) : 0.138903, 0.319143, 0.431428
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.129787, 0.313143, 0.449836
Train average loss residuals(Triplet, dist_p, dist_n) : 0.092157, 0.405238, 0.638901
Train average loss all      (Triplet)                 : 0.118427

== Recognize ==
Train average loss Recognize     : 1.562865
Train average accuracy drums     : 49.674999 %
Train average accuracy bass      : 50.145000 %
Train average accuracy piano     : 50.480003 %
Train average accuracy guitar    : 49.334999 %
Train average accuracy residuals : 49.869999 %

== Train average loss all : 0.118427

Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.380, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]          Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.380, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]Epoch 17:  16%|█▌        | 50/313 [01:13<06:27,  0.68it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.380, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]Epoch 17:  16%|█▌        | 50/313 [01:13<06:27,  0.68it/s, v_num=0, Train/loss_all_step=0.0975, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0975, Train/loss_recog_step=1.510, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]Epoch 17:  32%|███▏      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.0975, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0975, Train/loss_recog_step=1.510, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]Epoch 17:  32%|███▏      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.570, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]  Epoch 17:  48%|████▊     | 150/313 [03:26<03:44,  0.73it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.570, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]Epoch 17:  48%|████▊     | 150/313 [03:26<03:44,  0.73it/s, v_num=0, Train/loss_all_step=0.0886, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0886, Train/loss_recog_step=1.600, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]Epoch 17:  64%|██████▍   | 200/313 [04:34<02:35,  0.73it/s, v_num=0, Train/loss_all_step=0.0886, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0886, Train/loss_recog_step=1.600, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]Epoch 17:  64%|██████▍   | 200/313 [04:34<02:35,  0.73it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=1.640, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]  Epoch 17:  80%|███████▉  | 250/313 [05:40<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=1.640, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]Epoch 17:  80%|███████▉  | 250/313 [05:40<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.550, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]Epoch 17:  96%|█████████▌| 300/313 [06:45<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.550, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]Epoch 17:  96%|█████████▌| 300/313 [06:45<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0989, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0989, Train/loss_recog_step=1.510, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]Epoch 17: 100%|██████████| 313/313 [07:00<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0989, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0989, Train/loss_recog_step=1.510, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]Epoch 17: 100%|██████████| 313/313 [07:00<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0995, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0995, Train/loss_recog_step=1.470, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.467, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.68it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 10.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00,  9.50it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.94it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204553, 0.204586, 0.213480, 0.209960
Valid average loss UNet                 (all)                : 0.832579

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062167, 0.234278, 0.617479
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.129239, 0.180218, 0.225719
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.185836, 0.495749, 0.587242
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.198688, 0.391215, 0.451786
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.158595, 0.576222, 0.685296
Valid average loss all      (Triplet)                 : 0.161745

== Recognize ==
Valid average loss Recognize     : 1.426699
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 59.500004 %

== Valid average loss all : 0.161745

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.412243366241455 sec. =
Valid knn accuracy drums     : 75.43478260869566%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.310595035552979 sec. =
Valid knn accuracy bass      : 18.14516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.171785831451416 sec. =
Valid knn accuracy piano     : 29.6875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.294138431549072 sec. =
Valid knn accuracy guitar    : 38.169642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.468426704406738 sec. =
Valid knn accuracy residuals : 64.54545454545455%

Valid knn accuracy average   : 45.19650826032313%

                                                                      [AEpoch 17: 100%|██████████| 313/313 [08:17<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0995, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0995, Train/loss_recog_step=1.470, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=1.560]Epoch 17: 100%|██████████| 313/313 [08:17<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0995, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0995, Train/loss_recog_step=1.470, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207671, 0.208961, 0.211276, 0.210550
Train average loss UNet                 (all)                : 0.838459

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.048473, 0.285248, 0.807519
Train average loss bass     (Triplet, dist_p, dist_n) : 0.174299, 0.215624, 0.261894
Train average loss piano    (Triplet, dist_p, dist_n) : 0.135702, 0.344948, 0.468727
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.125736, 0.332337, 0.478803
Train average loss residuals(Triplet, dist_p, dist_n) : 0.089606, 0.435644, 0.687143
Train average loss all      (Triplet)                 : 0.116281

== Recognize ==
Train average loss Recognize     : 1.567398
Train average accuracy drums     : 50.234997 %
Train average accuracy bass      : 49.939999 %
Train average accuracy piano     : 49.965000 %
Train average accuracy guitar    : 50.040001 %
Train average accuracy residuals : 50.155003 %

== Train average loss all : 0.116281

Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0995, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0995, Train/loss_recog_step=1.470, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]          Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0995, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0995, Train/loss_recog_step=1.470, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]Epoch 18:  16%|█▌        | 50/313 [01:14<06:34,  0.67it/s, v_num=0, Train/loss_all_step=0.0995, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0995, Train/loss_recog_step=1.470, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]Epoch 18:  16%|█▌        | 50/313 [01:14<06:34,  0.67it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=1.540, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]  Epoch 18:  32%|███▏      | 100/313 [02:21<05:00,  0.71it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=1.540, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]Epoch 18:  32%|███▏      | 100/313 [02:21<05:00,  0.71it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=1.650, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]Epoch 18:  48%|████▊     | 150/313 [03:25<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=1.650, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]Epoch 18:  48%|████▊     | 150/313 [03:25<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.0849, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0849, Train/loss_recog_step=1.680, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]Epoch 18:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.0849, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0849, Train/loss_recog_step=1.680, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]Epoch 18:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.091, Train/loss_unet_all_step=0.877, Train/loss_triplet_all_step=0.091, Train/loss_recog_step=1.650, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]  Epoch 18:  80%|███████▉  | 250/313 [05:37<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.091, Train/loss_unet_all_step=0.877, Train/loss_triplet_all_step=0.091, Train/loss_recog_step=1.650, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]Epoch 18:  80%|███████▉  | 250/313 [05:37<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.780, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]Epoch 18:  96%|█████████▌| 300/313 [06:41<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.780, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]Epoch 18:  96%|█████████▌| 300/313 [06:41<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=1.730, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]Epoch 18: 100%|██████████| 313/313 [06:55<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=1.730, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]Epoch 18: 100%|██████████| 313/313 [06:55<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0988, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0988, Train/loss_recog_step=1.520, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.810, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.430, Valid/knn_avr=0.452, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.16it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00,  9.25it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00,  8.36it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  9.18it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  8.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204371, 0.204403, 0.212999, 0.196204
Valid average loss UNet                 (all)                : 0.817976

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091425, 0.297612, 0.642069
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.124621, 0.163384, 0.202660
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.219229, 0.553561, 0.559840
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.201586, 0.432563, 0.478677
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.152036, 0.600733, 0.718032
Valid average loss all      (Triplet)                 : 0.167729

== Recognize ==
Valid average loss Recognize     : 1.634765
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.167729

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.749098300933838 sec. =
Valid knn accuracy drums     : 72.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.700295686721802 sec. =
Valid knn accuracy bass      : 15.524193548387096%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.477906465530396 sec. =
Valid knn accuracy piano     : 29.8828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.597407817840576 sec. =
Valid knn accuracy guitar    : 37.05357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.355661153793335 sec. =
Valid knn accuracy residuals : 65.68181818181819%

Valid knn accuracy average   : 44.193696523059685%

                                                                      [AEpoch 18: 100%|██████████| 313/313 [08:09<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.0988, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0988, Train/loss_recog_step=1.520, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.116, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=1.570]Epoch 18: 100%|██████████| 313/313 [08:09<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.0988, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0988, Train/loss_recog_step=1.520, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207672, 0.208990, 0.211288, 0.210769
Train average loss UNet                 (all)                : 0.838719

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.047577, 0.290096, 0.814334
Train average loss bass     (Triplet, dist_p, dist_n) : 0.170730, 0.219334, 0.270606
Train average loss piano    (Triplet, dist_p, dist_n) : 0.129438, 0.353574, 0.489592
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.123341, 0.341302, 0.495103
Train average loss residuals(Triplet, dist_p, dist_n) : 0.084099, 0.453918, 0.723021
Train average loss all      (Triplet)                 : 0.112908

== Recognize ==
Train average loss Recognize     : 1.561953
Train average accuracy drums     : 50.529999 %
Train average accuracy bass      : 50.209999 %
Train average accuracy piano     : 50.459999 %
Train average accuracy guitar    : 50.220001 %
Train average accuracy residuals : 49.884998 %

== Train average loss all : 0.112908

Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0988, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0988, Train/loss_recog_step=1.520, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]          Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0988, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0988, Train/loss_recog_step=1.520, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]Epoch 19:  16%|█▌        | 50/313 [01:14<06:30,  0.67it/s, v_num=0, Train/loss_all_step=0.0988, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0988, Train/loss_recog_step=1.520, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]Epoch 19:  16%|█▌        | 50/313 [01:14<06:30,  0.67it/s, v_num=0, Train/loss_all_step=0.0939, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0939, Train/loss_recog_step=1.550, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]Epoch 19:  32%|███▏      | 100/313 [02:19<04:56,  0.72it/s, v_num=0, Train/loss_all_step=0.0939, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0939, Train/loss_recog_step=1.550, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]Epoch 19:  32%|███▏      | 100/313 [02:19<04:56,  0.72it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.600, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]  Epoch 19:  48%|████▊     | 150/313 [03:25<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.600, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]Epoch 19:  48%|████▊     | 150/313 [03:25<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.0876, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0876, Train/loss_recog_step=1.550, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]Epoch 19:  64%|██████▍   | 200/313 [04:30<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.0876, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0876, Train/loss_recog_step=1.550, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]Epoch 19:  64%|██████▍   | 200/313 [04:30<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.081, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.081, Train/loss_recog_step=1.550, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]  Epoch 19:  80%|███████▉  | 250/313 [05:35<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.081, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.081, Train/loss_recog_step=1.550, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]Epoch 19:  80%|███████▉  | 250/313 [05:35<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.099, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.099, Train/loss_recog_step=1.600, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]Epoch 19:  96%|█████████▌| 300/313 [06:38<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.099, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.099, Train/loss_recog_step=1.600, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]Epoch 19:  96%|█████████▌| 300/313 [06:38<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.530, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]Epoch 19: 100%|██████████| 313/313 [06:53<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.530, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]Epoch 19: 100%|██████████| 313/313 [06:53<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.0672, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0672, Train/loss_recog_step=1.710, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.756, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.442, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.93it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.91it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  7.65it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.19it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.203890, 0.204007, 0.212435, 0.197806
Valid average loss UNet                 (all)                : 0.818137

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.123834, 0.303076, 0.595593
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.132422, 0.194861, 0.240013
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.254452, 0.591224, 0.582378
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.171041, 0.411145, 0.493123
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.149244, 0.602724, 0.728171
Valid average loss all      (Triplet)                 : 0.176602

== Recognize ==
Valid average loss Recognize     : 1.665116
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 44.000000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.176602

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.548154354095459 sec. =
Valid knn accuracy drums     : 69.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.948913097381592 sec. =
Valid knn accuracy bass      : 19.959677419354836%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.671659469604492 sec. =
Valid knn accuracy piano     : 31.0546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.047369241714478 sec. =
Valid knn accuracy guitar    : 37.276785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.795404434204102 sec. =
Valid knn accuracy residuals : 66.13636363636364%

Valid knn accuracy average   : 44.755068071392145%

                                                                      [AEpoch 19: 100%|██████████| 313/313 [08:09<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.0672, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0672, Train/loss_recog_step=1.710, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=1.560]Epoch 19: 100%|██████████| 313/313 [08:09<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.0672, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0672, Train/loss_recog_step=1.710, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207524, 0.208801, 0.211140, 0.211298
Train average loss UNet                 (all)                : 0.838763

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.046219, 0.302190, 0.843885
Train average loss bass     (Triplet, dist_p, dist_n) : 0.169229, 0.231713, 0.283917
Train average loss piano    (Triplet, dist_p, dist_n) : 0.126172, 0.367986, 0.512578
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.119030, 0.353253, 0.519400
Train average loss residuals(Triplet, dist_p, dist_n) : 0.082979, 0.463381, 0.739670
Train average loss all      (Triplet)                 : 0.110577

== Recognize ==
Train average loss Recognize     : 1.567101
Train average accuracy drums     : 50.535000 %
Train average accuracy bass      : 51.139999 %
Train average accuracy piano     : 50.910004 %
Train average accuracy guitar    : 49.509998 %
Train average accuracy residuals : 49.485001 %

== Train average loss all : 0.110577

Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0672, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0672, Train/loss_recog_step=1.710, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]          Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0672, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0672, Train/loss_recog_step=1.710, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]Epoch 20:  16%|█▌        | 50/313 [01:14<06:32,  0.67it/s, v_num=0, Train/loss_all_step=0.0672, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0672, Train/loss_recog_step=1.710, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]Epoch 20:  16%|█▌        | 50/313 [01:14<06:32,  0.67it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.570, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]  Epoch 20:  32%|███▏      | 100/313 [02:20<04:58,  0.71it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.570, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]Epoch 20:  32%|███▏      | 100/313 [02:20<04:58,  0.71it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.480, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]Epoch 20:  48%|████▊     | 150/313 [03:25<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.480, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]Epoch 20:  48%|████▊     | 150/313 [03:25<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.0915, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.0915, Train/loss_recog_step=1.680, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]Epoch 20:  64%|██████▍   | 200/313 [04:33<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.0915, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.0915, Train/loss_recog_step=1.680, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]Epoch 20:  64%|██████▍   | 200/313 [04:33<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.0959, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.0959, Train/loss_recog_step=1.660, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]Epoch 20:  80%|███████▉  | 250/313 [05:40<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.0959, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.0959, Train/loss_recog_step=1.660, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]Epoch 20:  80%|███████▉  | 250/313 [05:40<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.0864, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0864, Train/loss_recog_step=1.700, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]Epoch 20:  96%|█████████▌| 300/313 [06:45<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0864, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0864, Train/loss_recog_step=1.700, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]Epoch 20:  96%|█████████▌| 300/313 [06:45<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.098, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.098, Train/loss_recog_step=1.430, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]  Epoch 20: 100%|██████████| 313/313 [07:00<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.098, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.098, Train/loss_recog_step=1.430, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]Epoch 20: 100%|██████████| 313/313 [07:00<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0591, Train/loss_recog_step=1.320, Valid/loss_all_step=0.211, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.670, Valid/knn_avr=0.448, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 10.94it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.42it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 11.28it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.44it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204511, 0.204636, 0.213212, 0.197335
Valid average loss UNet                 (all)                : 0.819694

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.112939, 0.305476, 0.632468
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.130761, 0.173112, 0.201030
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.232267, 0.542715, 0.535790
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.162722, 0.408269, 0.499226
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.158478, 0.572125, 0.675057
Valid average loss all      (Triplet)                 : 0.165410

== Recognize ==
Valid average loss Recognize     : 1.521588
Valid average accuracy drums     : 56.000000 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.165410

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.08620572090149 sec. =
Valid knn accuracy drums     : 73.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.603474855422974 sec. =
Valid knn accuracy bass      : 20.56451612903226%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.150830268859863 sec. =
Valid knn accuracy piano     : 28.90625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.49180817604065 sec. =
Valid knn accuracy guitar    : 42.63392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.481632947921753 sec. =
Valid knn accuracy residuals : 59.31818181818181%

Valid knn accuracy average   : 44.98022747764157%

                                                                      [AEpoch 20: 100%|██████████| 313/313 [08:20<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0591, Train/loss_recog_step=1.320, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.111, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.570]Epoch 20: 100%|██████████| 313/313 [08:20<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0591, Train/loss_recog_step=1.320, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207284, 0.208574, 0.210927, 0.211344
Train average loss UNet                 (all)                : 0.838129

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.043010, 0.316108, 0.868106
Train average loss bass     (Triplet, dist_p, dist_n) : 0.168787, 0.249764, 0.305982
Train average loss piano    (Triplet, dist_p, dist_n) : 0.122508, 0.389512, 0.544611
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.112267, 0.371981, 0.557249
Train average loss residuals(Triplet, dist_p, dist_n) : 0.076921, 0.486308, 0.783644
Train average loss all      (Triplet)                 : 0.106398

== Recognize ==
Train average loss Recognize     : 1.600076
Train average accuracy drums     : 50.435001 %
Train average accuracy bass      : 50.040001 %
Train average accuracy piano     : 50.655003 %
Train average accuracy guitar    : 50.125004 %
Train average accuracy residuals : 50.150002 %

== Train average loss all : 0.106398

Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0591, Train/loss_recog_step=1.320, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]          Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0591, Train/loss_recog_step=1.320, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]Epoch 21:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0591, Train/loss_recog_step=1.320, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]Epoch 21:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.0988, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0988, Train/loss_recog_step=1.610, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]Epoch 21:  32%|███▏      | 100/313 [02:17<04:53,  0.73it/s, v_num=0, Train/loss_all_step=0.0988, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0988, Train/loss_recog_step=1.610, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]Epoch 21:  32%|███▏      | 100/313 [02:17<04:53,  0.73it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=1.690, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]  Epoch 21:  48%|████▊     | 150/313 [03:23<03:40,  0.74it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=1.690, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]Epoch 21:  48%|████▊     | 150/313 [03:23<03:40,  0.74it/s, v_num=0, Train/loss_all_step=0.0809, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.0809, Train/loss_recog_step=1.490, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]Epoch 21:  64%|██████▍   | 200/313 [04:28<02:31,  0.74it/s, v_num=0, Train/loss_all_step=0.0809, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.0809, Train/loss_recog_step=1.490, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]Epoch 21:  64%|██████▍   | 200/313 [04:28<02:31,  0.74it/s, v_num=0, Train/loss_all_step=0.0874, Train/loss_unet_all_step=0.871, Train/loss_triplet_all_step=0.0874, Train/loss_recog_step=1.710, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]Epoch 21:  80%|███████▉  | 250/313 [05:34<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.0874, Train/loss_unet_all_step=0.871, Train/loss_triplet_all_step=0.0874, Train/loss_recog_step=1.710, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]Epoch 21:  80%|███████▉  | 250/313 [05:34<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.0816, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0816, Train/loss_recog_step=1.440, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]Epoch 21:  96%|█████████▌| 300/313 [06:37<00:17,  0.76it/s, v_num=0, Train/loss_all_step=0.0816, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0816, Train/loss_recog_step=1.440, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]Epoch 21:  96%|█████████▌| 300/313 [06:37<00:17,  0.76it/s, v_num=0, Train/loss_all_step=0.0954, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0954, Train/loss_recog_step=1.610, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]Epoch 21: 100%|██████████| 313/313 [06:52<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.0954, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0954, Train/loss_recog_step=1.610, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]Epoch 21: 100%|██████████| 313/313 [06:52<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.0721, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0721, Train/loss_recog_step=1.740, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.450, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.62it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.94it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.70it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.56it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.46it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205260, 0.205080, 0.213690, 0.200537
Valid average loss UNet                 (all)                : 0.824567

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.144880, 0.343256, 0.618279
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.127372, 0.179885, 0.213098
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.221600, 0.568679, 0.570571
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.140582, 0.389181, 0.494474
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.155706, 0.642696, 0.805495
Valid average loss all      (Triplet)                 : 0.160336

== Recognize ==
Valid average loss Recognize     : 1.628013
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.160336

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.962435722351074 sec. =
Valid knn accuracy drums     : 71.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.663135528564453 sec. =
Valid knn accuracy bass      : 18.951612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.88595461845398 sec. =
Valid knn accuracy piano     : 35.15625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.721466779708862 sec. =
Valid knn accuracy guitar    : 33.482142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.72268295288086 sec. =
Valid knn accuracy residuals : 58.409090909090914%

Valid knn accuracy average   : 43.46068889910931%

                                                                      [AEpoch 21: 100%|██████████| 313/313 [08:09<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.0721, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0721, Train/loss_recog_step=1.740, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.600]Epoch 21: 100%|██████████| 313/313 [08:09<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.0721, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0721, Train/loss_recog_step=1.740, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207407, 0.208685, 0.211028, 0.209703
Train average loss UNet                 (all)                : 0.836823

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.041689, 0.332711, 0.906612
Train average loss bass     (Triplet, dist_p, dist_n) : 0.165658, 0.263323, 0.325551
Train average loss piano    (Triplet, dist_p, dist_n) : 0.118531, 0.409157, 0.577455
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.109141, 0.381502, 0.571740
Train average loss residuals(Triplet, dist_p, dist_n) : 0.073975, 0.510880, 0.828222
Train average loss all      (Triplet)                 : 0.103375

== Recognize ==
Train average loss Recognize     : 1.598542
Train average accuracy drums     : 49.720001 %
Train average accuracy bass      : 49.505001 %
Train average accuracy piano     : 49.720001 %
Train average accuracy guitar    : 50.174999 %
Train average accuracy residuals : 49.939999 %

== Train average loss all : 0.103375

Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0721, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0721, Train/loss_recog_step=1.740, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]          Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0721, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0721, Train/loss_recog_step=1.740, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]Epoch 22:  16%|█▌        | 50/313 [01:15<06:36,  0.66it/s, v_num=0, Train/loss_all_step=0.0721, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0721, Train/loss_recog_step=1.740, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]Epoch 22:  16%|█▌        | 50/313 [01:15<06:36,  0.66it/s, v_num=0, Train/loss_all_step=0.0853, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0853, Train/loss_recog_step=1.690, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]Epoch 22:  32%|███▏      | 100/313 [02:20<04:59,  0.71it/s, v_num=0, Train/loss_all_step=0.0853, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0853, Train/loss_recog_step=1.690, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]Epoch 22:  32%|███▏      | 100/313 [02:20<04:59,  0.71it/s, v_num=0, Train/loss_all_step=0.0999, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.0999, Train/loss_recog_step=1.620, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]Epoch 22:  48%|████▊     | 150/313 [03:28<03:46,  0.72it/s, v_num=0, Train/loss_all_step=0.0999, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.0999, Train/loss_recog_step=1.620, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]Epoch 22:  48%|████▊     | 150/313 [03:28<03:46,  0.72it/s, v_num=0, Train/loss_all_step=0.0812, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0812, Train/loss_recog_step=1.520, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]Epoch 22:  64%|██████▍   | 200/313 [04:35<02:35,  0.73it/s, v_num=0, Train/loss_all_step=0.0812, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0812, Train/loss_recog_step=1.520, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]Epoch 22:  64%|██████▍   | 200/313 [04:35<02:35,  0.73it/s, v_num=0, Train/loss_all_step=0.0784, Train/loss_unet_all_step=0.874, Train/loss_triplet_all_step=0.0784, Train/loss_recog_step=1.690, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]Epoch 22:  80%|███████▉  | 250/313 [05:41<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.0784, Train/loss_unet_all_step=0.874, Train/loss_triplet_all_step=0.0784, Train/loss_recog_step=1.690, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]Epoch 22:  80%|███████▉  | 250/313 [05:41<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.097, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.097, Train/loss_recog_step=1.540, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]  Epoch 22:  96%|█████████▌| 300/313 [06:46<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.097, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.097, Train/loss_recog_step=1.540, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]Epoch 22:  96%|█████████▌| 300/313 [06:46<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0909, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0909, Train/loss_recog_step=1.680, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]Epoch 22: 100%|██████████| 313/313 [07:00<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0909, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0909, Train/loss_recog_step=1.680, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]Epoch 22: 100%|██████████| 313/313 [07:00<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0489, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0489, Train/loss_recog_step=1.650, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.920, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.435, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.07it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.47it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00,  8.82it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  9.94it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.59it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204403, 0.204342, 0.212902, 0.202283
Valid average loss UNet                 (all)                : 0.823929

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.132987, 0.382673, 0.732043
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.144402, 0.217774, 0.236758
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.265070, 0.677844, 0.649745
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.136372, 0.444602, 0.572525
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.218461, 0.704414, 0.766150
Valid average loss all      (Triplet)                 : 0.176545

== Recognize ==
Valid average loss Recognize     : 1.566457
Valid average accuracy drums     : 43.500000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.176545

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.92528748512268 sec. =
Valid knn accuracy drums     : 77.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.486913681030273 sec. =
Valid knn accuracy bass      : 23.588709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.845611333847046 sec. =
Valid knn accuracy piano     : 29.8828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.780685186386108 sec. =
Valid knn accuracy guitar    : 38.392857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.734483480453491 sec. =
Valid knn accuracy residuals : 57.49999999999999%

Valid knn accuracy average   : 45.30765847275095%

                                                                      [AEpoch 22: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0489, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0489, Train/loss_recog_step=1.650, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.103, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=1.600]Epoch 22: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0489, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0489, Train/loss_recog_step=1.650, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207534, 0.208797, 0.211156, 0.209898
Train average loss UNet                 (all)                : 0.837385

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.041197, 0.354177, 0.947855
Train average loss bass     (Triplet, dist_p, dist_n) : 0.161552, 0.279179, 0.348031
Train average loss piano    (Triplet, dist_p, dist_n) : 0.110589, 0.435904, 0.624343
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.104926, 0.399100, 0.602014
Train average loss residuals(Triplet, dist_p, dist_n) : 0.070795, 0.542068, 0.882947
Train average loss all      (Triplet)                 : 0.099481

== Recognize ==
Train average loss Recognize     : 1.603220
Train average accuracy drums     : 49.759998 %
Train average accuracy bass      : 50.400002 %
Train average accuracy piano     : 49.785000 %
Train average accuracy guitar    : 50.005001 %
Train average accuracy residuals : 50.015003 %

== Train average loss all : 0.099481

Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0489, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0489, Train/loss_recog_step=1.650, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]          Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0489, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0489, Train/loss_recog_step=1.650, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]Epoch 23:  16%|█▌        | 50/313 [01:10<06:12,  0.71it/s, v_num=0, Train/loss_all_step=0.0489, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0489, Train/loss_recog_step=1.650, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]Epoch 23:  16%|█▌        | 50/313 [01:10<06:12,  0.71it/s, v_num=0, Train/loss_all_step=0.0685, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0685, Train/loss_recog_step=1.730, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]Epoch 23:  32%|███▏      | 100/313 [02:14<04:46,  0.74it/s, v_num=0, Train/loss_all_step=0.0685, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0685, Train/loss_recog_step=1.730, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]Epoch 23:  32%|███▏      | 100/313 [02:14<04:46,  0.74it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.570, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]  Epoch 23:  48%|████▊     | 150/313 [03:19<03:36,  0.75it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.570, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]Epoch 23:  48%|████▊     | 150/313 [03:19<03:36,  0.75it/s, v_num=0, Train/loss_all_step=0.0759, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.0759, Train/loss_recog_step=1.650, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]Epoch 23:  64%|██████▍   | 200/313 [04:27<02:31,  0.75it/s, v_num=0, Train/loss_all_step=0.0759, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.0759, Train/loss_recog_step=1.650, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]Epoch 23:  64%|██████▍   | 200/313 [04:27<02:31,  0.75it/s, v_num=0, Train/loss_all_step=0.081, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.081, Train/loss_recog_step=1.650, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]  Epoch 23:  80%|███████▉  | 250/313 [05:33<01:23,  0.75it/s, v_num=0, Train/loss_all_step=0.081, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.081, Train/loss_recog_step=1.650, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]Epoch 23:  80%|███████▉  | 250/313 [05:33<01:23,  0.75it/s, v_num=0, Train/loss_all_step=0.0911, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0911, Train/loss_recog_step=1.600, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]Epoch 23:  96%|█████████▌| 300/313 [06:38<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.0911, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0911, Train/loss_recog_step=1.600, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]Epoch 23:  96%|█████████▌| 300/313 [06:38<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.0927, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0927, Train/loss_recog_step=1.750, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]Epoch 23: 100%|██████████| 313/313 [06:52<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.0927, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0927, Train/loss_recog_step=1.750, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]Epoch 23: 100%|██████████| 313/313 [06:52<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0573, Train/loss_recog_step=1.530, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.56it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.23it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.78it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00,  9.56it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  9.56it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.74it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205198, 0.204993, 0.213628, 0.205321
Valid average loss UNet                 (all)                : 0.829140

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.169556, 0.379136, 0.680061
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.131147, 0.200594, 0.230013
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.268469, 0.683567, 0.658959
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.155992, 0.427951, 0.540674
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.177335, 0.656342, 0.762487
Valid average loss all      (Triplet)                 : 0.181913

== Recognize ==
Valid average loss Recognize     : 1.604355
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.181913

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.745132684707642 sec. =
Valid knn accuracy drums     : 70.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.676278829574585 sec. =
Valid knn accuracy bass      : 25.60483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.04448652267456 sec. =
Valid knn accuracy piano     : 33.59375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.171937704086304 sec. =
Valid knn accuracy guitar    : 35.714285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.78937840461731 sec. =
Valid knn accuracy residuals : 62.5%

Valid knn accuracy average   : 45.65648792827089%

                                                                      [AEpoch 23: 100%|██████████| 313/313 [08:07<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0573, Train/loss_recog_step=1.530, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0995, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.600]Epoch 23: 100%|██████████| 313/313 [08:07<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0573, Train/loss_recog_step=1.530, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207473, 0.208734, 0.211086, 0.210127
Train average loss UNet                 (all)                : 0.837421

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.037406, 0.377700, 1.012325
Train average loss bass     (Triplet, dist_p, dist_n) : 0.157861, 0.294342, 0.370198
Train average loss piano    (Triplet, dist_p, dist_n) : 0.105327, 0.465339, 0.669523
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.098768, 0.432070, 0.659780
Train average loss residuals(Triplet, dist_p, dist_n) : 0.067793, 0.561941, 0.918891
Train average loss all      (Triplet)                 : 0.095094

== Recognize ==
Train average loss Recognize     : 1.612413
Train average accuracy drums     : 51.080002 %
Train average accuracy bass      : 50.355000 %
Train average accuracy piano     : 49.834999 %
Train average accuracy guitar    : 49.454998 %
Train average accuracy residuals : 49.419998 %

== Train average loss all : 0.095094

Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0573, Train/loss_recog_step=1.530, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]          Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0573, Train/loss_recog_step=1.530, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]Epoch 24:  16%|█▌        | 50/313 [01:13<06:25,  0.68it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0573, Train/loss_recog_step=1.530, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]Epoch 24:  16%|█▌        | 50/313 [01:13<06:25,  0.68it/s, v_num=0, Train/loss_all_step=0.0695, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0695, Train/loss_recog_step=1.590, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]Epoch 24:  32%|███▏      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.0695, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0695, Train/loss_recog_step=1.590, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]Epoch 24:  32%|███▏      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=1.750, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]  Epoch 24:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=1.750, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]Epoch 24:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.0825, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0825, Train/loss_recog_step=1.620, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]Epoch 24:  64%|██████▍   | 200/313 [04:33<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.0825, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0825, Train/loss_recog_step=1.620, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]Epoch 24:  64%|██████▍   | 200/313 [04:33<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.860, Train/loss_triplet_all_step=0.0655, Train/loss_recog_step=1.660, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]Epoch 24:  80%|███████▉  | 250/313 [05:38<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.860, Train/loss_triplet_all_step=0.0655, Train/loss_recog_step=1.660, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]Epoch 24:  80%|███████▉  | 250/313 [05:38<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0583, Train/loss_recog_step=1.620, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]Epoch 24:  96%|█████████▌| 300/313 [06:45<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0583, Train/loss_recog_step=1.620, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]Epoch 24:  96%|█████████▌| 300/313 [06:45<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0732, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0732, Train/loss_recog_step=1.450, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]Epoch 24: 100%|██████████| 313/313 [06:59<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0732, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0732, Train/loss_recog_step=1.450, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]Epoch 24: 100%|██████████| 313/313 [06:59<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.064, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.064, Train/loss_recog_step=1.550, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.457, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.75it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.74it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00,  8.16it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  8.46it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206411, 0.206332, 0.215123, 0.198513
Valid average loss UNet                 (all)                : 0.826379

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.147537, 0.422072, 0.791430
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.138757, 0.239954, 0.265359
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.312131, 0.764919, 0.699495
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.121120, 0.436376, 0.620069
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.176162, 0.679689, 0.797801
Valid average loss all      (Triplet)                 : 0.176685

== Recognize ==
Valid average loss Recognize     : 1.571886
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.176685

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.523024320602417 sec. =
Valid knn accuracy drums     : 72.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.341882705688477 sec. =
Valid knn accuracy bass      : 23.588709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.771652460098267 sec. =
Valid knn accuracy piano     : 33.59375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.713741779327393 sec. =
Valid knn accuracy guitar    : 37.94642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.178418397903442 sec. =
Valid knn accuracy residuals : 62.272727272727266%

Valid knn accuracy average   : 45.91510571301069%

                                                                      [AEpoch 24: 100%|██████████| 313/313 [08:18<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.064, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.064, Train/loss_recog_step=1.550, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0951, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0951, Train/loss_recog_epoch=1.610]Epoch 24: 100%|██████████| 313/313 [08:18<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.064, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.064, Train/loss_recog_step=1.550, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207560, 0.208832, 0.211156, 0.209802
Train average loss UNet                 (all)                : 0.837349

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.033057, 0.395947, 1.052996
Train average loss bass     (Triplet, dist_p, dist_n) : 0.152537, 0.311378, 0.397658
Train average loss piano    (Triplet, dist_p, dist_n) : 0.100485, 0.479734, 0.700080
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.094519, 0.450516, 0.697294
Train average loss residuals(Triplet, dist_p, dist_n) : 0.063853, 0.575620, 0.949392
Train average loss all      (Triplet)                 : 0.090432

== Recognize ==
Train average loss Recognize     : 1.597847
Train average accuracy drums     : 49.399998 %
Train average accuracy bass      : 49.715000 %
Train average accuracy piano     : 49.465000 %
Train average accuracy guitar    : 50.520004 %
Train average accuracy residuals : 50.300003 %

== Train average loss all : 0.090432

Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.064, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.064, Train/loss_recog_step=1.550, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]          Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.064, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.064, Train/loss_recog_step=1.550, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]Epoch 25:  16%|█▌        | 50/313 [01:13<06:24,  0.68it/s, v_num=0, Train/loss_all_step=0.064, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.064, Train/loss_recog_step=1.550, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]Epoch 25:  16%|█▌        | 50/313 [01:13<06:24,  0.68it/s, v_num=0, Train/loss_all_step=0.070, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.070, Train/loss_recog_step=1.460, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]Epoch 25:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.070, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.070, Train/loss_recog_step=1.460, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]Epoch 25:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.0921, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.0921, Train/loss_recog_step=1.520, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]Epoch 25:  48%|████▊     | 150/313 [03:25<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.0921, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.0921, Train/loss_recog_step=1.520, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]Epoch 25:  48%|████▊     | 150/313 [03:25<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.0666, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.0666, Train/loss_recog_step=1.460, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]Epoch 25:  64%|██████▍   | 200/313 [04:30<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.0666, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.0666, Train/loss_recog_step=1.460, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]Epoch 25:  64%|██████▍   | 200/313 [04:30<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.0762, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.0762, Train/loss_recog_step=1.470, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]Epoch 25:  80%|███████▉  | 250/313 [05:35<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.0762, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.0762, Train/loss_recog_step=1.470, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]Epoch 25:  80%|███████▉  | 250/313 [05:35<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.0652, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0652, Train/loss_recog_step=1.520, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]Epoch 25:  96%|█████████▌| 300/313 [06:40<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.0652, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0652, Train/loss_recog_step=1.520, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]Epoch 25:  96%|█████████▌| 300/313 [06:40<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.0825, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0825, Train/loss_recog_step=1.560, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]Epoch 25: 100%|██████████| 313/313 [06:55<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0825, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0825, Train/loss_recog_step=1.560, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]Epoch 25: 100%|██████████| 313/313 [06:55<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0663, Train/loss_recog_step=1.520, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.570, Valid/knn_avr=0.459, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 10.00it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00,  9.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00,  8.16it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  9.51it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206296, 0.206220, 0.215093, 0.204649
Valid average loss UNet                 (all)                : 0.832258

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.104431, 0.417450, 0.841226
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.132157, 0.256013, 0.291244
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.330727, 0.808037, 0.736415
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.151933, 0.520768, 0.712074
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.146588, 0.805499, 0.987665
Valid average loss all      (Triplet)                 : 0.181016

== Recognize ==
Valid average loss Recognize     : 1.601735
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.181016

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.59525990486145 sec. =
Valid knn accuracy drums     : 68.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.454556465148926 sec. =
Valid knn accuracy bass      : 21.16935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.424423456192017 sec. =
Valid knn accuracy piano     : 31.4453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.768911123275757 sec. =
Valid knn accuracy guitar    : 40.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.208216190338135 sec. =
Valid knn accuracy residuals : 60.45454545454545%

Valid knn accuracy average   : 44.347538210824936%

                                                                      [AEpoch 25: 100%|██████████| 313/313 [08:13<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0663, Train/loss_recog_step=1.520, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0904, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.0904, Train/loss_recog_epoch=1.600]Epoch 25: 100%|██████████| 313/313 [08:13<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0663, Train/loss_recog_step=1.520, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207856, 0.209130, 0.211481, 0.210471
Train average loss UNet                 (all)                : 0.838938

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.033615, 0.429471, 1.140240
Train average loss bass     (Triplet, dist_p, dist_n) : 0.146103, 0.320655, 0.418199
Train average loss piano    (Triplet, dist_p, dist_n) : 0.094567, 0.507454, 0.746535
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.088859, 0.467216, 0.729518
Train average loss residuals(Triplet, dist_p, dist_n) : 0.060110, 0.610550, 1.007743
Train average loss all      (Triplet)                 : 0.086251

== Recognize ==
Train average loss Recognize     : 1.583486
Train average accuracy drums     : 49.970001 %
Train average accuracy bass      : 50.480003 %
Train average accuracy piano     : 49.450001 %
Train average accuracy guitar    : 50.125004 %
Train average accuracy residuals : 49.939999 %

== Train average loss all : 0.086251

Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0663, Train/loss_recog_step=1.520, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]          Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0663, Train/loss_recog_step=1.520, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]Epoch 26:  16%|█▌        | 50/313 [01:14<06:29,  0.67it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0663, Train/loss_recog_step=1.520, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]Epoch 26:  16%|█▌        | 50/313 [01:14<06:29,  0.67it/s, v_num=0, Train/loss_all_step=0.052, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.052, Train/loss_recog_step=1.490, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]  Epoch 26:  32%|███▏      | 100/313 [02:19<04:57,  0.72it/s, v_num=0, Train/loss_all_step=0.052, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.052, Train/loss_recog_step=1.490, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]Epoch 26:  32%|███▏      | 100/313 [02:19<04:57,  0.72it/s, v_num=0, Train/loss_all_step=0.0815, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.0815, Train/loss_recog_step=1.630, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]Epoch 26:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.0815, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.0815, Train/loss_recog_step=1.630, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]Epoch 26:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.0612, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0612, Train/loss_recog_step=1.580, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]Epoch 26:  64%|██████▍   | 200/313 [04:28<02:31,  0.74it/s, v_num=0, Train/loss_all_step=0.0612, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0612, Train/loss_recog_step=1.580, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]Epoch 26:  64%|██████▍   | 200/313 [04:28<02:31,  0.74it/s, v_num=0, Train/loss_all_step=0.0682, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.0682, Train/loss_recog_step=1.660, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]Epoch 26:  80%|███████▉  | 250/313 [05:35<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.0682, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.0682, Train/loss_recog_step=1.660, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]Epoch 26:  80%|███████▉  | 250/313 [05:35<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.0732, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0732, Train/loss_recog_step=1.710, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]Epoch 26:  96%|█████████▌| 300/313 [06:39<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.0732, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0732, Train/loss_recog_step=1.710, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]Epoch 26:  96%|█████████▌| 300/313 [06:39<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.0716, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0716, Train/loss_recog_step=1.710, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]Epoch 26: 100%|██████████| 313/313 [06:54<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.0716, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0716, Train/loss_recog_step=1.710, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]Epoch 26: 100%|██████████| 313/313 [06:54<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0675, Train/loss_recog_step=1.750, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.181, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.48it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.22it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.26it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00,  8.99it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  8.08it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206509, 0.206616, 0.215152, 0.215800
Valid average loss UNet                 (all)                : 0.844077

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091566, 0.407821, 0.860555
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.159579, 0.276129, 0.282749
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.374616, 0.894385, 0.787626
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.200985, 0.572809, 0.676585
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.214605, 0.792334, 0.906200
Valid average loss all      (Triplet)                 : 0.217994

== Recognize ==
Valid average loss Recognize     : 1.469997
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.217994

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.570316791534424 sec. =
Valid knn accuracy drums     : 70.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.341562509536743 sec. =
Valid knn accuracy bass      : 20.967741935483872%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.561474561691284 sec. =
Valid knn accuracy piano     : 32.8125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.978921890258789 sec. =
Valid knn accuracy guitar    : 41.964285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.179314851760864 sec. =
Valid knn accuracy residuals : 59.54545454545455%

Valid knn accuracy average   : 45.23190948252308%

                                                                      [AEpoch 26: 100%|██████████| 313/313 [08:13<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0675, Train/loss_recog_step=1.750, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0863, Train/loss_recog_epoch=1.580]Epoch 26: 100%|██████████| 313/313 [08:13<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0675, Train/loss_recog_step=1.750, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207784, 0.209046, 0.211373, 0.210022
Train average loss UNet                 (all)                : 0.838225

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.030672, 0.452620, 1.172938
Train average loss bass     (Triplet, dist_p, dist_n) : 0.141493, 0.342914, 0.448589
Train average loss piano    (Triplet, dist_p, dist_n) : 0.086866, 0.549629, 0.817637
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.085119, 0.501865, 0.789166
Train average loss residuals(Triplet, dist_p, dist_n) : 0.055874, 0.647243, 1.076148
Train average loss all      (Triplet)                 : 0.081635

== Recognize ==
Train average loss Recognize     : 1.601170
Train average accuracy drums     : 50.160004 %
Train average accuracy bass      : 50.024998 %
Train average accuracy piano     : 49.645000 %
Train average accuracy guitar    : 50.290001 %
Train average accuracy residuals : 49.454998 %

== Train average loss all : 0.081635

Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0675, Train/loss_recog_step=1.750, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]          Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0675, Train/loss_recog_step=1.750, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]Epoch 27:  16%|█▌        | 50/313 [01:16<06:41,  0.66it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0675, Train/loss_recog_step=1.750, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]Epoch 27:  16%|█▌        | 50/313 [01:16<06:41,  0.66it/s, v_num=0, Train/loss_all_step=0.0511, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0511, Train/loss_recog_step=1.550, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]Epoch 27:  32%|███▏      | 100/313 [02:23<05:05,  0.70it/s, v_num=0, Train/loss_all_step=0.0511, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0511, Train/loss_recog_step=1.550, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]Epoch 27:  32%|███▏      | 100/313 [02:23<05:05,  0.70it/s, v_num=0, Train/loss_all_step=0.0726, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0726, Train/loss_recog_step=1.670, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]Epoch 27:  48%|████▊     | 150/313 [03:28<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.0726, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0726, Train/loss_recog_step=1.670, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]Epoch 27:  48%|████▊     | 150/313 [03:28<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.0872, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.0872, Train/loss_recog_step=1.370, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]Epoch 27:  64%|██████▍   | 200/313 [04:35<02:35,  0.73it/s, v_num=0, Train/loss_all_step=0.0872, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.0872, Train/loss_recog_step=1.370, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]Epoch 27:  64%|██████▍   | 200/313 [04:35<02:35,  0.73it/s, v_num=0, Train/loss_all_step=0.0682, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.0682, Train/loss_recog_step=1.640, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]Epoch 27:  80%|███████▉  | 250/313 [05:39<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.0682, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.0682, Train/loss_recog_step=1.640, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]Epoch 27:  80%|███████▉  | 250/313 [05:39<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.0534, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.0534, Train/loss_recog_step=1.630, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]Epoch 27:  96%|█████████▌| 300/313 [06:45<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0534, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.0534, Train/loss_recog_step=1.630, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]Epoch 27:  96%|█████████▌| 300/313 [06:45<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0655, Train/loss_recog_step=1.600, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]Epoch 27: 100%|██████████| 313/313 [07:00<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0655, Train/loss_recog_step=1.600, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]Epoch 27: 100%|██████████| 313/313 [07:00<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0499, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0499, Train/loss_recog_step=1.840, Valid/loss_all_step=0.246, Valid/loss_unet_all_step=0.834, Valid/loss_triplet_all_step=0.246, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.218, Valid/loss_unet_all_epoch=0.844, Valid/loss_triplet_all_epoch=0.218, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.83it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.79it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  7.54it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00,  8.07it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  9.16it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  7.93it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206035, 0.206111, 0.214764, 0.204833
Valid average loss UNet                 (all)                : 0.831743

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.063983, 0.407511, 0.884136
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.147940, 0.299308, 0.331032
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.374649, 0.911599, 0.811176
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.175458, 0.610412, 0.798808
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.183172, 0.833496, 1.026712
Valid average loss all      (Triplet)                 : 0.204157

== Recognize ==
Valid average loss Recognize     : 1.560127
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 41.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.204157

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.09071969985962 sec. =
Valid knn accuracy drums     : 68.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.7761709690094 sec. =
Valid knn accuracy bass      : 20.967741935483872%
= T-SNE...
T-SNE was finished!
= T-SNE time is 29.982352018356323 sec. =
Valid knn accuracy piano     : 32.2265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.621631383895874 sec. =
Valid knn accuracy guitar    : 40.401785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.234038829803467 sec. =
Valid knn accuracy residuals : 60.45454545454545%

Valid knn accuracy average   : 44.462301033906485%

                                                                      [AEpoch 27: 100%|██████████| 313/313 [08:40<00:00,  0.60it/s, v_num=0, Train/loss_all_step=0.0499, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0499, Train/loss_recog_step=1.840, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0816, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0816, Train/loss_recog_epoch=1.600]Epoch 27: 100%|██████████| 313/313 [08:40<00:00,  0.60it/s, v_num=0, Train/loss_all_step=0.0499, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0499, Train/loss_recog_step=1.840, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207761, 0.209004, 0.211351, 0.210262
Train average loss UNet                 (all)                : 0.838377

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.031051, 0.466033, 1.190224
Train average loss bass     (Triplet, dist_p, dist_n) : 0.139062, 0.354228, 0.467913
Train average loss piano    (Triplet, dist_p, dist_n) : 0.085175, 0.563599, 0.840158
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.078568, 0.514375, 0.816916
Train average loss residuals(Triplet, dist_p, dist_n) : 0.052987, 0.647539, 1.082721
Train average loss all      (Triplet)                 : 0.078855

== Recognize ==
Train average loss Recognize     : 1.612643
Train average accuracy drums     : 49.965000 %
Train average accuracy bass      : 50.160004 %
Train average accuracy piano     : 49.939999 %
Train average accuracy guitar    : 49.820000 %
Train average accuracy residuals : 50.160004 %

== Train average loss all : 0.078855

Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0499, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0499, Train/loss_recog_step=1.840, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]          Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0499, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0499, Train/loss_recog_step=1.840, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]Epoch 28:  16%|█▌        | 50/313 [01:13<06:28,  0.68it/s, v_num=0, Train/loss_all_step=0.0499, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0499, Train/loss_recog_step=1.840, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]Epoch 28:  16%|█▌        | 50/313 [01:13<06:28,  0.68it/s, v_num=0, Train/loss_all_step=0.0735, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0735, Train/loss_recog_step=1.560, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]Epoch 28:  32%|███▏      | 100/313 [02:19<04:57,  0.72it/s, v_num=0, Train/loss_all_step=0.0735, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0735, Train/loss_recog_step=1.560, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]Epoch 28:  32%|███▏      | 100/313 [02:19<04:57,  0.72it/s, v_num=0, Train/loss_all_step=0.0666, Train/loss_unet_all_step=0.863, Train/loss_triplet_all_step=0.0666, Train/loss_recog_step=1.560, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]Epoch 28:  48%|████▊     | 150/313 [03:24<03:41,  0.73it/s, v_num=0, Train/loss_all_step=0.0666, Train/loss_unet_all_step=0.863, Train/loss_triplet_all_step=0.0666, Train/loss_recog_step=1.560, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]Epoch 28:  48%|████▊     | 150/313 [03:24<03:41,  0.73it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.066, Train/loss_recog_step=1.700, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]  Epoch 28:  64%|██████▍   | 200/313 [04:30<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.066, Train/loss_recog_step=1.700, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]Epoch 28:  64%|██████▍   | 200/313 [04:30<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.0598, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.0598, Train/loss_recog_step=1.700, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]Epoch 28:  80%|███████▉  | 250/313 [05:35<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.0598, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.0598, Train/loss_recog_step=1.700, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]Epoch 28:  80%|███████▉  | 250/313 [05:35<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.0639, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0639, Train/loss_recog_step=1.610, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]Epoch 28:  96%|█████████▌| 300/313 [06:40<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.0639, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0639, Train/loss_recog_step=1.610, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]Epoch 28:  96%|█████████▌| 300/313 [06:40<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.0704, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0704, Train/loss_recog_step=1.720, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]Epoch 28: 100%|██████████| 313/313 [06:55<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0704, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0704, Train/loss_recog_step=1.720, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]Epoch 28: 100%|██████████| 313/313 [06:55<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0532, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0532, Train/loss_recog_step=1.970, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.65it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.75it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.79it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.94it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 11.49it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.31it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206250, 0.206457, 0.215079, 0.201229
Valid average loss UNet                 (all)                : 0.829015

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.078223, 0.432267, 0.797744
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.123595, 0.317812, 0.374752
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.420687, 1.016352, 0.877948
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.152724, 0.566839, 0.747699
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.233411, 0.948596, 1.112401
Valid average loss all      (Triplet)                 : 0.229269

== Recognize ==
Valid average loss Recognize     : 1.759277
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 44.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.229269

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.36258840560913 sec. =
Valid knn accuracy drums     : 61.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.878267049789429 sec. =
Valid knn accuracy bass      : 22.58064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.611521482467651 sec. =
Valid knn accuracy piano     : 30.6640625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.005597352981567 sec. =
Valid knn accuracy guitar    : 33.482142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.604151248931885 sec. =
Valid knn accuracy residuals : 62.5%

Valid knn accuracy average   : 42.06276140803446%

                                                                      [AEpoch 28: 100%|██████████| 313/313 [08:16<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0532, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0532, Train/loss_recog_step=1.970, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0789, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0789, Train/loss_recog_epoch=1.610]Epoch 28: 100%|██████████| 313/313 [08:16<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0532, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0532, Train/loss_recog_step=1.970, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207609, 0.208885, 0.211245, 0.210584
Train average loss UNet                 (all)                : 0.838323

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.030409, 0.488142, 1.229631
Train average loss bass     (Triplet, dist_p, dist_n) : 0.134404, 0.371855, 0.494832
Train average loss piano    (Triplet, dist_p, dist_n) : 0.082450, 0.593757, 0.886319
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.073858, 0.547311, 0.882565
Train average loss residuals(Triplet, dist_p, dist_n) : 0.050015, 0.693632, 1.154409
Train average loss all      (Triplet)                 : 0.075942

== Recognize ==
Train average loss Recognize     : 1.609432
Train average accuracy drums     : 50.129997 %
Train average accuracy bass      : 49.985001 %
Train average accuracy piano     : 50.150002 %
Train average accuracy guitar    : 50.615002 %
Train average accuracy residuals : 50.070000 %

== Train average loss all : 0.075942

Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0532, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0532, Train/loss_recog_step=1.970, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]          Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0532, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0532, Train/loss_recog_step=1.970, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]Epoch 29:  16%|█▌        | 50/313 [01:13<06:24,  0.68it/s, v_num=0, Train/loss_all_step=0.0532, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0532, Train/loss_recog_step=1.970, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]Epoch 29:  16%|█▌        | 50/313 [01:13<06:24,  0.68it/s, v_num=0, Train/loss_all_step=0.0423, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0423, Train/loss_recog_step=1.470, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]Epoch 29:  32%|███▏      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.0423, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0423, Train/loss_recog_step=1.470, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]Epoch 29:  32%|███▏      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.0637, Train/loss_recog_step=1.500, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]Epoch 29:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.0637, Train/loss_recog_step=1.500, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]Epoch 29:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.065, Train/loss_recog_step=1.620, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]  Epoch 29:  64%|██████▍   | 200/313 [04:29<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.065, Train/loss_recog_step=1.620, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]Epoch 29:  64%|██████▍   | 200/313 [04:29<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.876, Train/loss_triplet_all_step=0.0729, Train/loss_recog_step=1.720, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]Epoch 29:  80%|███████▉  | 250/313 [05:35<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.876, Train/loss_triplet_all_step=0.0729, Train/loss_recog_step=1.720, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]Epoch 29:  80%|███████▉  | 250/313 [05:35<01:24,  0.75it/s, v_num=0, Train/loss_all_step=0.0518, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0518, Train/loss_recog_step=1.600, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]Epoch 29:  96%|█████████▌| 300/313 [06:41<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.0518, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0518, Train/loss_recog_step=1.600, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]Epoch 29:  96%|█████████▌| 300/313 [06:41<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.0666, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0666, Train/loss_recog_step=1.590, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]Epoch 29: 100%|██████████| 313/313 [06:56<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0666, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0666, Train/loss_recog_step=1.590, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]Epoch 29: 100%|██████████| 313/313 [06:56<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0268, Train/loss_recog_step=1.600, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.421, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.75it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  8.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  7.98it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00,  8.57it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.97it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206433, 0.206548, 0.215429, 0.208250
Valid average loss UNet                 (all)                : 0.836660

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.053908, 0.451571, 0.878118
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.134102, 0.321820, 0.359186
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.299172, 0.895546, 0.900199
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.134178, 0.558691, 0.895158
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.186701, 0.878077, 1.080174
Valid average loss all      (Triplet)                 : 0.180120

== Recognize ==
Valid average loss Recognize     : 1.522718
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.180120

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.698044300079346 sec. =
Valid knn accuracy drums     : 63.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.452280282974243 sec. =
Valid knn accuracy bass      : 20.56451612903226%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.608356952667236 sec. =
Valid knn accuracy piano     : 34.375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.622456789016724 sec. =
Valid knn accuracy guitar    : 29.6875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.600556373596191 sec. =
Valid knn accuracy residuals : 61.13636363636363%

Valid knn accuracy average   : 41.80484986612266%

                                                                      [AEpoch 29: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0268, Train/loss_recog_step=1.600, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0759, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0759, Train/loss_recog_epoch=1.610]Epoch 29: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0268, Train/loss_recog_step=1.600, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207922, 0.209155, 0.211493, 0.211606
Train average loss UNet                 (all)                : 0.840177

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.028232, 0.515343, 1.302044
Train average loss bass     (Triplet, dist_p, dist_n) : 0.128800, 0.388673, 0.521501
Train average loss piano    (Triplet, dist_p, dist_n) : 0.078469, 0.626976, 0.942086
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.071123, 0.571664, 0.920667
Train average loss residuals(Triplet, dist_p, dist_n) : 0.046567, 0.726208, 1.224389
Train average loss all      (Triplet)                 : 0.072230

== Recognize ==
Train average loss Recognize     : 1.642892
Train average accuracy drums     : 49.825001 %
Train average accuracy bass      : 49.880001 %
Train average accuracy piano     : 49.775002 %
Train average accuracy guitar    : 50.120003 %
Train average accuracy residuals : 50.309998 %

== Train average loss all : 0.072230

Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0268, Train/loss_recog_step=1.600, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]          Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0268, Train/loss_recog_step=1.600, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]Epoch 30:  16%|█▌        | 50/313 [01:12<06:22,  0.69it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0268, Train/loss_recog_step=1.600, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]Epoch 30:  16%|█▌        | 50/313 [01:12<06:22,  0.69it/s, v_num=0, Train/loss_all_step=0.051, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.051, Train/loss_recog_step=1.680, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]  Epoch 30:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.051, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.051, Train/loss_recog_step=1.680, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]Epoch 30:  32%|███▏      | 100/313 [02:18<04:54,  0.72it/s, v_num=0, Train/loss_all_step=0.0471, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.0471, Train/loss_recog_step=1.620, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]Epoch 30:  48%|████▊     | 150/313 [03:23<03:41,  0.74it/s, v_num=0, Train/loss_all_step=0.0471, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.0471, Train/loss_recog_step=1.620, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]Epoch 30:  48%|████▊     | 150/313 [03:23<03:41,  0.74it/s, v_num=0, Train/loss_all_step=0.0421, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0421, Train/loss_recog_step=1.460, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]Epoch 30:  64%|██████▍   | 200/313 [04:30<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.0421, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0421, Train/loss_recog_step=1.460, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]Epoch 30:  64%|██████▍   | 200/313 [04:30<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.0725, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.0725, Train/loss_recog_step=1.570, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]Epoch 30:  80%|███████▉  | 250/313 [05:37<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.0725, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.0725, Train/loss_recog_step=1.570, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]Epoch 30:  80%|███████▉  | 250/313 [05:37<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.0641, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0641, Train/loss_recog_step=1.770, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]Epoch 30:  96%|█████████▌| 300/313 [06:43<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0641, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0641, Train/loss_recog_step=1.770, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]Epoch 30:  96%|█████████▌| 300/313 [06:43<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0803, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0803, Train/loss_recog_step=1.640, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]Epoch 30: 100%|██████████| 313/313 [06:58<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0803, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0803, Train/loss_recog_step=1.640, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]Epoch 30: 100%|██████████| 313/313 [06:58<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0465, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0465, Train/loss_recog_step=1.730, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.817, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.520, Valid/knn_avr=0.418, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 12.81it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00,  9.54it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.03it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  9.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  7.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.207042, 0.207211, 0.215922, 0.208164
Valid average loss UNet                 (all)                : 0.838337

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.066319, 0.475290, 0.866014
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.140716, 0.365169, 0.406559
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.350702, 0.986715, 0.931280
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.143979, 0.638348, 0.933278
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.199515, 0.976031, 1.195509
Valid average loss all      (Triplet)                 : 0.203212

== Recognize ==
Valid average loss Recognize     : 1.485644
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 58.999996 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.203212

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.611442565917969 sec. =
Valid knn accuracy drums     : 62.60869565217392%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.366126537322998 sec. =
Valid knn accuracy bass      : 22.983870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.620555400848389 sec. =
Valid knn accuracy piano     : 31.25%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.870150804519653 sec. =
Valid knn accuracy guitar    : 37.276785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.189788341522217 sec. =
Valid knn accuracy residuals : 62.272727272727266%

Valid knn accuracy average   : 43.278415921385765%

                                                                      [AEpoch 30: 100%|██████████| 313/313 [08:17<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0465, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0465, Train/loss_recog_step=1.730, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0722, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0722, Train/loss_recog_epoch=1.640]Epoch 30: 100%|██████████| 313/313 [08:17<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0465, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0465, Train/loss_recog_step=1.730, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207909, 0.209162, 0.211528, 0.211124
Train average loss UNet                 (all)                : 0.839723

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.026292, 0.536829, 1.339321
Train average loss bass     (Triplet, dist_p, dist_n) : 0.122082, 0.404950, 0.552525
Train average loss piano    (Triplet, dist_p, dist_n) : 0.069961, 0.646172, 0.983174
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.063207, 0.592178, 0.971638
Train average loss residuals(Triplet, dist_p, dist_n) : 0.040069, 0.748403, 1.271197
Train average loss all      (Triplet)                 : 0.065766

== Recognize ==
Train average loss Recognize     : 1.622067
Train average accuracy drums     : 49.689999 %
Train average accuracy bass      : 50.180000 %
Train average accuracy piano     : 49.805000 %
Train average accuracy guitar    : 49.660000 %
Train average accuracy residuals : 50.064999 %

== Train average loss all : 0.065766

Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0465, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0465, Train/loss_recog_step=1.730, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]          Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0465, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0465, Train/loss_recog_step=1.730, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]Epoch 31:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.0465, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0465, Train/loss_recog_step=1.730, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]Epoch 31:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.059, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.059, Train/loss_recog_step=1.540, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]  Epoch 31:  32%|███▏      | 100/313 [02:20<05:00,  0.71it/s, v_num=0, Train/loss_all_step=0.059, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.059, Train/loss_recog_step=1.540, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]Epoch 31:  32%|███▏      | 100/313 [02:20<05:00,  0.71it/s, v_num=0, Train/loss_all_step=0.050, Train/loss_unet_all_step=0.871, Train/loss_triplet_all_step=0.050, Train/loss_recog_step=1.740, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]Epoch 31:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.050, Train/loss_unet_all_step=0.871, Train/loss_triplet_all_step=0.050, Train/loss_recog_step=1.740, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]Epoch 31:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.045, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.045, Train/loss_recog_step=1.540, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]Epoch 31:  64%|██████▍   | 200/313 [04:33<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.045, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.045, Train/loss_recog_step=1.540, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]Epoch 31:  64%|██████▍   | 200/313 [04:33<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.0437, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0437, Train/loss_recog_step=1.830, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]Epoch 31:  80%|███████▉  | 250/313 [05:40<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.0437, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0437, Train/loss_recog_step=1.830, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]Epoch 31:  80%|███████▉  | 250/313 [05:40<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.0533, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0533, Train/loss_recog_step=1.690, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]Epoch 31:  96%|█████████▌| 300/313 [06:44<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0533, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0533, Train/loss_recog_step=1.690, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]Epoch 31:  96%|█████████▌| 300/313 [06:44<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0485, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0485, Train/loss_recog_step=1.700, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]Epoch 31: 100%|██████████| 313/313 [07:00<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0485, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0485, Train/loss_recog_step=1.700, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]Epoch 31: 100%|██████████| 313/313 [07:00<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0338, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0338, Train/loss_recog_step=1.650, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.811, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.433, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.09it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.29it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.43it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.21it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  8.14it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.207148, 0.207157, 0.216240, 0.202614
Valid average loss UNet                 (all)                : 0.833159

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.063185, 0.508743, 1.030310
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.159284, 0.390235, 0.411593
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.355057, 0.990077, 0.939259
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.116202, 0.622784, 0.985333
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.242701, 1.017836, 1.163346
Valid average loss all      (Triplet)                 : 0.207924

== Recognize ==
Valid average loss Recognize     : 1.620985
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.207924

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.545823812484741 sec. =
Valid knn accuracy drums     : 62.82608695652174%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.41936707496643 sec. =
Valid knn accuracy bass      : 23.790322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.05653166770935 sec. =
Valid knn accuracy piano     : 29.1015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.460193157196045 sec. =
Valid knn accuracy guitar    : 38.392857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.238129615783691 sec. =
Valid knn accuracy residuals : 59.31818181818181%

Valid knn accuracy average   : 42.685802199641174%

                                                                      [AEpoch 31: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0338, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0338, Train/loss_recog_step=1.650, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0658, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0658, Train/loss_recog_epoch=1.620]Epoch 31: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0338, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0338, Train/loss_recog_step=1.650, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208088, 0.209333, 0.211694, 0.210135
Train average loss UNet                 (all)                : 0.839250

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.023879, 0.561629, 1.407203
Train average loss bass     (Triplet, dist_p, dist_n) : 0.117812, 0.426196, 0.585178
Train average loss piano    (Triplet, dist_p, dist_n) : 0.066118, 0.685816, 1.051576
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.061584, 0.625737, 1.021211
Train average loss residuals(Triplet, dist_p, dist_n) : 0.037642, 0.788716, 1.343763
Train average loss all      (Triplet)                 : 0.062766

== Recognize ==
Train average loss Recognize     : 1.628307
Train average accuracy drums     : 49.369999 %
Train average accuracy bass      : 49.619999 %
Train average accuracy piano     : 49.334999 %
Train average accuracy guitar    : 50.059998 %
Train average accuracy residuals : 49.524998 %

== Train average loss all : 0.062766

Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0338, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0338, Train/loss_recog_step=1.650, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]          Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0338, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0338, Train/loss_recog_step=1.650, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]Epoch 32:  16%|█▌        | 50/313 [01:15<06:35,  0.66it/s, v_num=0, Train/loss_all_step=0.0338, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0338, Train/loss_recog_step=1.650, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]Epoch 32:  16%|█▌        | 50/313 [01:15<06:35,  0.66it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0618, Train/loss_recog_step=1.640, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]Epoch 32:  32%|███▏      | 100/313 [02:21<05:00,  0.71it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0618, Train/loss_recog_step=1.640, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]Epoch 32:  32%|███▏      | 100/313 [02:21<05:00,  0.71it/s, v_num=0, Train/loss_all_step=0.0578, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.0578, Train/loss_recog_step=1.500, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]Epoch 32:  48%|████▊     | 150/313 [03:28<03:46,  0.72it/s, v_num=0, Train/loss_all_step=0.0578, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.0578, Train/loss_recog_step=1.500, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]Epoch 32:  48%|████▊     | 150/313 [03:28<03:46,  0.72it/s, v_num=0, Train/loss_all_step=0.0494, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.0494, Train/loss_recog_step=1.430, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]Epoch 32:  64%|██████▍   | 200/313 [04:34<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.0494, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.0494, Train/loss_recog_step=1.430, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]Epoch 32:  64%|██████▍   | 200/313 [04:34<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.053, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.053, Train/loss_recog_step=1.680, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]  Epoch 32:  80%|███████▉  | 250/313 [05:40<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.053, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.053, Train/loss_recog_step=1.680, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]Epoch 32:  80%|███████▉  | 250/313 [05:40<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.0612, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0612, Train/loss_recog_step=1.800, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]Epoch 32:  96%|█████████▌| 300/313 [06:46<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0612, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0612, Train/loss_recog_step=1.800, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]Epoch 32:  96%|█████████▌| 300/313 [06:46<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.061, Train/loss_recog_step=1.450, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]  Epoch 32: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.061, Train/loss_recog_step=1.450, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]Epoch 32: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00592, Train/loss_recog_step=1.640, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=1.680, Valid/loss_all_epoch=0.208, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.427, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.93it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.59it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.21it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.79it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.06it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 11.07it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.207669, 0.207924, 0.216784, 0.188920
Valid average loss UNet                 (all)                : 0.821298

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.104313, 0.499233, 0.907610
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.148952, 0.395571, 0.426223
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.365052, 1.050341, 0.991616
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.129593, 0.630417, 1.026014
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.333183, 1.111162, 1.189094
Valid average loss all      (Triplet)                 : 0.236377

== Recognize ==
Valid average loss Recognize     : 1.921851
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.236377

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.86636471748352 sec. =
Valid knn accuracy drums     : 68.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.443914890289307 sec. =
Valid knn accuracy bass      : 24.596774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.130229711532593 sec. =
Valid knn accuracy piano     : 30.2734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.461995363235474 sec. =
Valid knn accuracy guitar    : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.838815927505493 sec. =
Valid knn accuracy residuals : 57.27272727272727%

Valid knn accuracy average   : 43.66771822803774%

                                                                      [AEpoch 32: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00592, Train/loss_recog_step=1.640, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0628, Train/loss_unet_all_epoch=0.839, Train/loss_triplet_all_epoch=0.0628, Train/loss_recog_epoch=1.630]Epoch 32: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00592, Train/loss_recog_step=1.640, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207935, 0.209173, 0.211557, 0.211047
Train average loss UNet                 (all)                : 0.839711

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.021115, 0.580514, 1.433115
Train average loss bass     (Triplet, dist_p, dist_n) : 0.117589, 0.452839, 0.618853
Train average loss piano    (Triplet, dist_p, dist_n) : 0.060884, 0.725752, 1.122708
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.060661, 0.669996, 1.086578
Train average loss residuals(Triplet, dist_p, dist_n) : 0.033899, 0.837252, 1.428568
Train average loss all      (Triplet)                 : 0.060161

== Recognize ==
Train average loss Recognize     : 1.633653
Train average accuracy drums     : 49.880001 %
Train average accuracy bass      : 50.105000 %
Train average accuracy piano     : 49.955002 %
Train average accuracy guitar    : 49.884998 %
Train average accuracy residuals : 50.685001 %

== Train average loss all : 0.060161

Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00592, Train/loss_recog_step=1.640, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]          Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00592, Train/loss_recog_step=1.640, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]Epoch 33:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00592, Train/loss_recog_step=1.640, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]Epoch 33:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.0597, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0597, Train/loss_recog_step=1.590, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]  Epoch 33:  32%|███▏      | 100/313 [02:22<05:04,  0.70it/s, v_num=0, Train/loss_all_step=0.0597, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0597, Train/loss_recog_step=1.590, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]Epoch 33:  32%|███▏      | 100/313 [02:22<05:04,  0.70it/s, v_num=0, Train/loss_all_step=0.0528, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.0528, Train/loss_recog_step=1.520, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]Epoch 33:  48%|████▊     | 150/313 [03:30<03:48,  0.71it/s, v_num=0, Train/loss_all_step=0.0528, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.0528, Train/loss_recog_step=1.520, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]Epoch 33:  48%|████▊     | 150/313 [03:30<03:48,  0.71it/s, v_num=0, Train/loss_all_step=0.0418, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.0418, Train/loss_recog_step=1.560, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]Epoch 33:  64%|██████▍   | 200/313 [04:37<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.0418, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.0418, Train/loss_recog_step=1.560, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]Epoch 33:  64%|██████▍   | 200/313 [04:37<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.0386, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.0386, Train/loss_recog_step=1.710, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]Epoch 33:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.0386, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.0386, Train/loss_recog_step=1.710, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]Epoch 33:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.0409, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0409, Train/loss_recog_step=1.610, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]Epoch 33:  96%|█████████▌| 300/313 [06:51<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.0409, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0409, Train/loss_recog_step=1.610, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]Epoch 33:  96%|█████████▌| 300/313 [06:51<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.0649, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0649, Train/loss_recog_step=1.740, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]Epoch 33: 100%|██████████| 313/313 [07:05<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0649, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0649, Train/loss_recog_step=1.740, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]Epoch 33: 100%|██████████| 313/313 [07:05<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=1.520, Valid/loss_all_step=0.332, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.332, Valid/loss_recog_step=2.480, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.437, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 10.80it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.36it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 11.46it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  9.44it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.207134, 0.207151, 0.216241, 0.203996
Valid average loss UNet                 (all)                : 0.834523

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.088329, 0.598951, 1.094844
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.151520, 0.415603, 0.457549
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.368991, 1.135741, 1.105223
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.131988, 0.729189, 1.088190
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.326457, 1.289298, 1.438068
Valid average loss all      (Triplet)                 : 0.244324

== Recognize ==
Valid average loss Recognize     : 1.587687
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.244324

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.109969854354858 sec. =
Valid knn accuracy drums     : 64.13043478260869%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.366024732589722 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.037872552871704 sec. =
Valid knn accuracy piano     : 30.46875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.308731317520142 sec. =
Valid knn accuracy guitar    : 41.964285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.749347448348999 sec. =
Valid knn accuracy residuals : 62.04545454545455%

Valid knn accuracy average   : 43.471785008469794%

                                                                      [AEpoch 33: 100%|██████████| 313/313 [08:25<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=1.520, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0602, Train/loss_recog_epoch=1.630]Epoch 33: 100%|██████████| 313/313 [08:25<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=1.520, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.207975, 0.209226, 0.211601, 0.210909
Train average loss UNet                 (all)                : 0.839711

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.021768, 0.650448, 1.598691
Train average loss bass     (Triplet, dist_p, dist_n) : 0.107829, 0.482104, 0.673564
Train average loss piano    (Triplet, dist_p, dist_n) : 0.052125, 0.779305, 1.221773
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.054461, 0.724359, 1.183466
Train average loss residuals(Triplet, dist_p, dist_n) : 0.033221, 0.917400, 1.558517
Train average loss all      (Triplet)                 : 0.055164

== Recognize ==
Train average loss Recognize     : 1.648152
Train average accuracy drums     : 50.075001 %
Train average accuracy bass      : 49.935001 %
Train average accuracy piano     : 50.320000 %
Train average accuracy guitar    : 49.845001 %
Train average accuracy residuals : 49.235001 %

== Train average loss all : 0.055164

Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=1.520, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]          Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=1.520, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]Epoch 34:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=1.520, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]Epoch 34:  16%|█▌        | 50/313 [01:13<06:26,  0.68it/s, v_num=0, Train/loss_all_step=0.0542, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.0542, Train/loss_recog_step=1.410, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]Epoch 34:  32%|███▏      | 100/313 [02:19<04:57,  0.72it/s, v_num=0, Train/loss_all_step=0.0542, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.0542, Train/loss_recog_step=1.410, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]Epoch 34:  32%|███▏      | 100/313 [02:19<04:57,  0.72it/s, v_num=0, Train/loss_all_step=0.0547, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.0547, Train/loss_recog_step=1.660, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]Epoch 34:  48%|████▊     | 150/313 [03:26<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.0547, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.0547, Train/loss_recog_step=1.660, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]Epoch 34:  48%|████▊     | 150/313 [03:26<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.0619, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.0619, Train/loss_recog_step=1.560, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]Epoch 34:  64%|██████▍   | 200/313 [04:32<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.0619, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.0619, Train/loss_recog_step=1.560, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]Epoch 34:  64%|██████▍   | 200/313 [04:32<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.0509, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.0509, Train/loss_recog_step=1.810, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]Epoch 34:  80%|███████▉  | 250/313 [05:40<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.0509, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.0509, Train/loss_recog_step=1.810, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]Epoch 34:  80%|███████▉  | 250/313 [05:40<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.0588, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0588, Train/loss_recog_step=1.610, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]Epoch 34:  96%|█████████▌| 300/313 [06:47<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0588, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0588, Train/loss_recog_step=1.610, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]Epoch 34:  96%|█████████▌| 300/313 [06:47<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0454, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.0454, Train/loss_recog_step=1.480, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]Epoch 34: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0454, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.0454, Train/loss_recog_step=1.480, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]Epoch 34: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.00778, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.00778, Train/loss_recog_step=1.420, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.359, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.94it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 10.96it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00,  8.06it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  7.50it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.02it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.07it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205516, 0.205775, 0.214275, 0.197990
Valid average loss UNet                 (all)                : 0.823556

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.109689, 0.611553, 1.096349
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.140152, 0.426770, 0.488628
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.412529, 1.148753, 1.051471
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.155030, 0.750308, 1.208085
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.401376, 1.376275, 1.403971
Valid average loss all      (Triplet)                 : 0.275152

== Recognize ==
Valid average loss Recognize     : 1.553921
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 43.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.275152

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.489813804626465 sec. =
Valid knn accuracy drums     : 63.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.415937900543213 sec. =
Valid knn accuracy bass      : 21.16935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.226263046264648 sec. =
Valid knn accuracy piano     : 32.2265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.414531230926514 sec. =
Valid knn accuracy guitar    : 41.07142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.321268320083618 sec. =
Valid knn accuracy residuals : 61.81818181818181%

Valid knn accuracy average   : 43.95275771957706%

                                                                      [AEpoch 34: 100%|██████████| 313/313 [08:20<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.00778, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.00778, Train/loss_recog_step=1.420, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0552, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0552, Train/loss_recog_epoch=1.650]Epoch 34: 100%|██████████| 313/313 [08:20<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.00778, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.00778, Train/loss_recog_step=1.420, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208166, 0.209415, 0.211783, 0.211198
Train average loss UNet                 (all)                : 0.840561

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.020641, 0.664431, 1.625284
Train average loss bass     (Triplet, dist_p, dist_n) : 0.102433, 0.501827, 0.707645
Train average loss piano    (Triplet, dist_p, dist_n) : 0.052085, 0.798367, 1.256265
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.051783, 0.748179, 1.224849
Train average loss residuals(Triplet, dist_p, dist_n) : 0.030428, 0.952280, 1.612397
Train average loss all      (Triplet)                 : 0.052816

== Recognize ==
Train average loss Recognize     : 1.621163
Train average accuracy drums     : 50.765003 %
Train average accuracy bass      : 50.805004 %
Train average accuracy piano     : 50.045002 %
Train average accuracy guitar    : 50.059998 %
Train average accuracy residuals : 49.889999 %

== Train average loss all : 0.052816

Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00778, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.00778, Train/loss_recog_step=1.420, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]          Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00778, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.00778, Train/loss_recog_step=1.420, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]Epoch 35:  16%|█▌        | 50/313 [01:14<06:29,  0.67it/s, v_num=0, Train/loss_all_step=0.00778, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.00778, Train/loss_recog_step=1.420, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]Epoch 35:  16%|█▌        | 50/313 [01:14<06:29,  0.67it/s, v_num=0, Train/loss_all_step=0.0884, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0884, Train/loss_recog_step=1.690, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]  Epoch 35:  32%|███▏      | 100/313 [02:20<04:59,  0.71it/s, v_num=0, Train/loss_all_step=0.0884, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0884, Train/loss_recog_step=1.690, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]Epoch 35:  32%|███▏      | 100/313 [02:20<04:59,  0.71it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=1.600, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]Epoch 35:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=1.600, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]Epoch 35:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.0369, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0369, Train/loss_recog_step=1.670, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]Epoch 35:  64%|██████▍   | 200/313 [04:34<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.0369, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0369, Train/loss_recog_step=1.670, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]Epoch 35:  64%|██████▍   | 200/313 [04:34<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.037, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.037, Train/loss_recog_step=1.660, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]  Epoch 35:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.037, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.037, Train/loss_recog_step=1.660, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]Epoch 35:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.0412, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0412, Train/loss_recog_step=1.730, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]Epoch 35:  96%|█████████▌| 300/313 [06:50<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.0412, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0412, Train/loss_recog_step=1.730, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]Epoch 35:  96%|█████████▌| 300/313 [06:50<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0618, Train/loss_recog_step=1.680, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]Epoch 35: 100%|██████████| 313/313 [07:04<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0618, Train/loss_recog_step=1.680, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]Epoch 35: 100%|██████████| 313/313 [07:04<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0208, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=1.740, Valid/loss_all_step=0.460, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.275, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.275, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.92it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.35it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.69it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  7.64it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.61it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206215, 0.206334, 0.215203, 0.214454
Valid average loss UNet                 (all)                : 0.842206

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.105483, 0.668145, 1.140893
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.145555, 0.483565, 0.530912
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.383560, 1.246881, 1.173980
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.154386, 0.828413, 1.328308
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.284707, 1.391487, 1.577217
Valid average loss all      (Triplet)                 : 0.250955

== Recognize ==
Valid average loss Recognize     : 1.638466
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 44.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.250955

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.237660884857178 sec. =
Valid knn accuracy drums     : 64.13043478260869%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.175763607025146 sec. =
Valid knn accuracy bass      : 19.959677419354836%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.607987642288208 sec. =
Valid knn accuracy piano     : 26.5625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.574844121932983 sec. =
Valid knn accuracy guitar    : 40.401785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.267834424972534 sec. =
Valid knn accuracy residuals : 59.09090909090909%

Valid knn accuracy average   : 42.02906140143167%

                                                                      [AEpoch 35: 100%|██████████| 313/313 [08:26<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0208, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=1.740, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0528, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0528, Train/loss_recog_epoch=1.620]Epoch 35: 100%|██████████| 313/313 [08:26<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0208, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=1.740, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208297, 0.209546, 0.211902, 0.210713
Train average loss UNet                 (all)                : 0.840457

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.020384, 0.704225, 1.729855
Train average loss bass     (Triplet, dist_p, dist_n) : 0.093889, 0.546470, 0.784512
Train average loss piano    (Triplet, dist_p, dist_n) : 0.045817, 0.856766, 1.362829
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.047759, 0.799095, 1.322913
Train average loss residuals(Triplet, dist_p, dist_n) : 0.028602, 1.017089, 1.733232
Train average loss all      (Triplet)                 : 0.048278

== Recognize ==
Train average loss Recognize     : 1.651750
Train average accuracy drums     : 50.300003 %
Train average accuracy bass      : 49.965000 %
Train average accuracy piano     : 50.125004 %
Train average accuracy guitar    : 50.089996 %
Train average accuracy residuals : 49.509998 %

== Train average loss all : 0.048278

Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0208, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=1.740, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]          Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0208, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=1.740, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]Epoch 36:  16%|█▌        | 50/313 [01:15<06:39,  0.66it/s, v_num=0, Train/loss_all_step=0.0208, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=1.740, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]Epoch 36:  16%|█▌        | 50/313 [01:15<06:39,  0.66it/s, v_num=0, Train/loss_all_step=0.0449, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.0449, Train/loss_recog_step=1.670, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]Epoch 36:  32%|███▏      | 100/313 [02:20<04:59,  0.71it/s, v_num=0, Train/loss_all_step=0.0449, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.0449, Train/loss_recog_step=1.670, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]Epoch 36:  32%|███▏      | 100/313 [02:20<04:59,  0.71it/s, v_num=0, Train/loss_all_step=0.0322, Train/loss_unet_all_step=0.867, Train/loss_triplet_all_step=0.0322, Train/loss_recog_step=1.580, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]Epoch 36:  48%|████▊     | 150/313 [03:26<03:44,  0.73it/s, v_num=0, Train/loss_all_step=0.0322, Train/loss_unet_all_step=0.867, Train/loss_triplet_all_step=0.0322, Train/loss_recog_step=1.580, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]Epoch 36:  48%|████▊     | 150/313 [03:26<03:44,  0.73it/s, v_num=0, Train/loss_all_step=0.0401, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0401, Train/loss_recog_step=1.550, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]Epoch 36:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.0401, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0401, Train/loss_recog_step=1.550, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]Epoch 36:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.0325, Train/loss_unet_all_step=0.862, Train/loss_triplet_all_step=0.0325, Train/loss_recog_step=1.620, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]Epoch 36:  80%|███████▉  | 250/313 [05:38<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.0325, Train/loss_unet_all_step=0.862, Train/loss_triplet_all_step=0.0325, Train/loss_recog_step=1.620, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]Epoch 36:  80%|███████▉  | 250/313 [05:38<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.0239, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=1.690, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]Epoch 36:  96%|█████████▌| 300/313 [06:44<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0239, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=1.690, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]Epoch 36:  96%|█████████▌| 300/313 [06:44<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0428, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0428, Train/loss_recog_step=1.640, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]Epoch 36: 100%|██████████| 313/313 [06:59<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0428, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0428, Train/loss_recog_step=1.640, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]Epoch 36: 100%|██████████| 313/313 [06:59<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.000515, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000515, Train/loss_recog_step=1.790, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.842, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.420, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.92it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.41it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.73it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00,  8.18it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.63it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  8.27it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206316, 0.206523, 0.215350, 0.195369
Valid average loss UNet                 (all)                : 0.823557

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.135417, 0.821444, 1.394740
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.118334, 0.471246, 0.571188
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.403344, 1.237123, 1.194570
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.138575, 0.850852, 1.386180
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.257682, 1.342421, 1.540429
Valid average loss all      (Triplet)                 : 0.250527

== Recognize ==
Valid average loss Recognize     : 1.683006
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.250527

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.632067441940308 sec. =
Valid knn accuracy drums     : 63.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.471948146820068 sec. =
Valid knn accuracy bass      : 24.193548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.292048931121826 sec. =
Valid knn accuracy piano     : 28.515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.77842092514038 sec. =
Valid knn accuracy guitar    : 47.544642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.283709049224854 sec. =
Valid knn accuracy residuals : 61.81818181818181%

Valid knn accuracy average   : 45.110051786397335%

                                                                      [AEpoch 36: 100%|██████████| 313/313 [08:20<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.000515, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000515, Train/loss_recog_step=1.790, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0483, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0483, Train/loss_recog_epoch=1.650]Epoch 36: 100%|██████████| 313/313 [08:20<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.000515, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000515, Train/loss_recog_step=1.790, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208593, 0.209847, 0.212188, 0.211422
Train average loss UNet                 (all)                : 0.842049

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.018986, 0.725339, 1.790322
Train average loss bass     (Triplet, dist_p, dist_n) : 0.087703, 0.582748, 0.841581
Train average loss piano    (Triplet, dist_p, dist_n) : 0.043963, 0.896288, 1.424148
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.045353, 0.846679, 1.405910
Train average loss residuals(Triplet, dist_p, dist_n) : 0.025386, 1.035380, 1.767468
Train average loss all      (Triplet)                 : 0.045419

== Recognize ==
Train average loss Recognize     : 1.667194
Train average accuracy drums     : 50.410004 %
Train average accuracy bass      : 49.739998 %
Train average accuracy piano     : 49.759998 %
Train average accuracy guitar    : 50.379997 %
Train average accuracy residuals : 50.459999 %

== Train average loss all : 0.045419

Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000515, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000515, Train/loss_recog_step=1.790, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]          Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000515, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000515, Train/loss_recog_step=1.790, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]Epoch 37:  16%|█▌        | 50/313 [01:14<06:33,  0.67it/s, v_num=0, Train/loss_all_step=0.000515, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000515, Train/loss_recog_step=1.790, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]Epoch 37:  16%|█▌        | 50/313 [01:14<06:33,  0.67it/s, v_num=0, Train/loss_all_step=0.0377, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0377, Train/loss_recog_step=1.750, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]    Epoch 37:  32%|███▏      | 100/313 [02:22<05:02,  0.70it/s, v_num=0, Train/loss_all_step=0.0377, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0377, Train/loss_recog_step=1.750, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]Epoch 37:  32%|███▏      | 100/313 [02:22<05:02,  0.70it/s, v_num=0, Train/loss_all_step=0.0467, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.0467, Train/loss_recog_step=1.760, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]Epoch 37:  48%|████▊     | 150/313 [03:28<03:46,  0.72it/s, v_num=0, Train/loss_all_step=0.0467, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.0467, Train/loss_recog_step=1.760, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]Epoch 37:  48%|████▊     | 150/313 [03:28<03:46,  0.72it/s, v_num=0, Train/loss_all_step=0.0376, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.0376, Train/loss_recog_step=1.730, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]Epoch 37:  64%|██████▍   | 200/313 [04:32<02:33,  0.73it/s, v_num=0, Train/loss_all_step=0.0376, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.0376, Train/loss_recog_step=1.730, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]Epoch 37:  64%|██████▍   | 200/313 [04:32<02:33,  0.73it/s, v_num=0, Train/loss_all_step=0.0282, Train/loss_unet_all_step=0.860, Train/loss_triplet_all_step=0.0282, Train/loss_recog_step=1.680, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]Epoch 37:  80%|███████▉  | 250/313 [05:38<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.0282, Train/loss_unet_all_step=0.860, Train/loss_triplet_all_step=0.0282, Train/loss_recog_step=1.680, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]Epoch 37:  80%|███████▉  | 250/313 [05:38<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.025, Train/loss_recog_step=1.560, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]  Epoch 37:  96%|█████████▌| 300/313 [06:48<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.025, Train/loss_recog_step=1.560, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]Epoch 37:  96%|█████████▌| 300/313 [06:48<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.0375, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0375, Train/loss_recog_step=1.790, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]Epoch 37: 100%|██████████| 313/313 [07:02<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0375, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0375, Train/loss_recog_step=1.790, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]Epoch 37: 100%|██████████| 313/313 [07:02<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0097, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0097, Train/loss_recog_step=1.910, Valid/loss_all_step=0.334, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.334, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.45it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.35it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.20it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 11.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.81it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.66it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205963, 0.205974, 0.214916, 0.210891
Valid average loss UNet                 (all)                : 0.837743

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.137286, 0.692099, 1.171587
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.163541, 0.556693, 0.616285
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.355725, 1.264047, 1.250144
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.149828, 0.836878, 1.305705
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.340251, 1.488963, 1.655423
Valid average loss all      (Triplet)                 : 0.244049

== Recognize ==
Valid average loss Recognize     : 1.663949
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 43.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.244049

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.775185346603394 sec. =
Valid knn accuracy drums     : 65.43478260869566%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.457932710647583 sec. =
Valid knn accuracy bass      : 24.193548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.392825365066528 sec. =
Valid knn accuracy piano     : 30.078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.619859218597412 sec. =
Valid knn accuracy guitar    : 41.294642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.260180711746216 sec. =
Valid knn accuracy residuals : 59.09090909090909%

Valid knn accuracy average   : 44.018401588768874%

                                                                      [AEpoch 37: 100%|██████████| 313/313 [08:23<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0097, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0097, Train/loss_recog_step=1.910, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0454, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0454, Train/loss_recog_epoch=1.670]Epoch 37: 100%|██████████| 313/313 [08:23<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0097, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0097, Train/loss_recog_step=1.910, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208518, 0.209768, 0.212136, 0.211846
Train average loss UNet                 (all)                : 0.842268

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.018178, 0.762656, 1.867544
Train average loss bass     (Triplet, dist_p, dist_n) : 0.080648, 0.613974, 0.897376
Train average loss piano    (Triplet, dist_p, dist_n) : 0.041353, 0.925458, 1.489981
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.042400, 0.868445, 1.447365
Train average loss residuals(Triplet, dist_p, dist_n) : 0.023623, 1.057638, 1.811890
Train average loss all      (Triplet)                 : 0.042073

== Recognize ==
Train average loss Recognize     : 1.679375
Train average accuracy drums     : 50.075001 %
Train average accuracy bass      : 50.195004 %
Train average accuracy piano     : 49.274998 %
Train average accuracy guitar    : 50.204998 %
Train average accuracy residuals : 50.365002 %

== Train average loss all : 0.042073

Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0097, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0097, Train/loss_recog_step=1.910, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]          Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0097, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0097, Train/loss_recog_step=1.910, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]Epoch 38:  16%|█▌        | 50/313 [01:18<06:52,  0.64it/s, v_num=0, Train/loss_all_step=0.0097, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0097, Train/loss_recog_step=1.910, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]Epoch 38:  16%|█▌        | 50/313 [01:18<06:52,  0.64it/s, v_num=0, Train/loss_all_step=0.0298, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0298, Train/loss_recog_step=1.700, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]Epoch 38:  32%|███▏      | 100/313 [02:22<05:02,  0.70it/s, v_num=0, Train/loss_all_step=0.0298, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0298, Train/loss_recog_step=1.700, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]Epoch 38:  32%|███▏      | 100/313 [02:22<05:02,  0.70it/s, v_num=0, Train/loss_all_step=0.0462, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.0462, Train/loss_recog_step=1.750, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]Epoch 38:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.0462, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.0462, Train/loss_recog_step=1.750, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]Epoch 38:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.0307, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.0307, Train/loss_recog_step=1.720, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]Epoch 38:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.0307, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.0307, Train/loss_recog_step=1.720, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]Epoch 38:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.0303, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.0303, Train/loss_recog_step=1.750, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]Epoch 38:  80%|███████▉  | 250/313 [05:36<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.0303, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.0303, Train/loss_recog_step=1.750, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]Epoch 38:  80%|███████▉  | 250/313 [05:36<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0299, Train/loss_recog_step=1.740, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]Epoch 38:  96%|█████████▌| 300/313 [06:42<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0299, Train/loss_recog_step=1.740, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]Epoch 38:  96%|█████████▌| 300/313 [06:42<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.0436, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0436, Train/loss_recog_step=1.610, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]Epoch 38: 100%|██████████| 313/313 [06:57<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0436, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0436, Train/loss_recog_step=1.610, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]Epoch 38: 100%|██████████| 313/313 [06:57<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.000968, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000968, Train/loss_recog_step=2.130, Valid/loss_all_step=0.229, Valid/loss_unet_all_step=0.822, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.838, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.97it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.57it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.43it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00,  8.68it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  8.89it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.89it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205891, 0.205937, 0.214880, 0.190665
Valid average loss UNet                 (all)                : 0.817374

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.149347, 0.754394, 1.294470
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.146228, 0.544505, 0.616015
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.391161, 1.350353, 1.307008
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.140666, 0.862559, 1.397961
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.270004, 1.442931, 1.728541
Valid average loss all      (Triplet)                 : 0.242672

== Recognize ==
Valid average loss Recognize     : 1.800577
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.242672

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.657637119293213 sec. =
Valid knn accuracy drums     : 64.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.597089290618896 sec. =
Valid knn accuracy bass      : 22.379032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.754006147384644 sec. =
Valid knn accuracy piano     : 30.2734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.569889545440674 sec. =
Valid knn accuracy guitar    : 40.401785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.184146642684937 sec. =
Valid knn accuracy residuals : 63.63636363636363%

Valid knn accuracy average   : 44.20768903913408%

                                                                      [AEpoch 38: 100%|██████████| 313/313 [08:15<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.000968, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000968, Train/loss_recog_step=2.130, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0421, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0421, Train/loss_recog_epoch=1.680]Epoch 38: 100%|██████████| 313/313 [08:15<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.000968, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000968, Train/loss_recog_step=2.130, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208413, 0.209692, 0.212045, 0.211668
Train average loss UNet                 (all)                : 0.841818

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.016160, 0.816054, 1.968389
Train average loss bass     (Triplet, dist_p, dist_n) : 0.070147, 0.648812, 0.975220
Train average loss piano    (Triplet, dist_p, dist_n) : 0.040162, 0.987048, 1.589655
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.035154, 0.914394, 1.556273
Train average loss residuals(Triplet, dist_p, dist_n) : 0.022980, 1.136214, 1.935663
Train average loss all      (Triplet)                 : 0.037676

== Recognize ==
Train average loss Recognize     : 1.704182
Train average accuracy drums     : 50.105000 %
Train average accuracy bass      : 49.930000 %
Train average accuracy piano     : 49.695000 %
Train average accuracy guitar    : 50.435001 %
Train average accuracy residuals : 50.335003 %

== Train average loss all : 0.037676

Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000968, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000968, Train/loss_recog_step=2.130, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]          Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000968, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000968, Train/loss_recog_step=2.130, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]Epoch 39:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.000968, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000968, Train/loss_recog_step=2.130, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]Epoch 39:  16%|█▌        | 50/313 [01:12<06:20,  0.69it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00673, Train/loss_recog_step=1.690, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]  Epoch 39:  32%|███▏      | 100/313 [02:16<04:50,  0.73it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00673, Train/loss_recog_step=1.690, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]Epoch 39:  32%|███▏      | 100/313 [02:16<04:50,  0.73it/s, v_num=0, Train/loss_all_step=0.0323, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.0323, Train/loss_recog_step=1.750, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]  Epoch 39:  48%|████▊     | 150/313 [03:22<03:39,  0.74it/s, v_num=0, Train/loss_all_step=0.0323, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.0323, Train/loss_recog_step=1.750, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]Epoch 39:  48%|████▊     | 150/313 [03:22<03:39,  0.74it/s, v_num=0, Train/loss_all_step=0.0205, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0205, Train/loss_recog_step=1.670, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]Epoch 39:  64%|██████▍   | 200/313 [04:28<02:31,  0.75it/s, v_num=0, Train/loss_all_step=0.0205, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0205, Train/loss_recog_step=1.670, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]Epoch 39:  64%|██████▍   | 200/313 [04:28<02:31,  0.75it/s, v_num=0, Train/loss_all_step=0.0359, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.0359, Train/loss_recog_step=1.700, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]Epoch 39:  80%|███████▉  | 250/313 [05:32<01:23,  0.75it/s, v_num=0, Train/loss_all_step=0.0359, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.0359, Train/loss_recog_step=1.700, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]Epoch 39:  80%|███████▉  | 250/313 [05:32<01:23,  0.75it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=1.750, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]Epoch 39:  96%|█████████▌| 300/313 [06:39<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=1.750, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]Epoch 39:  96%|█████████▌| 300/313 [06:39<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.0438, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0438, Train/loss_recog_step=1.750, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]Epoch 39: 100%|██████████| 313/313 [06:53<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.0438, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0438, Train/loss_recog_step=1.750, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]Epoch 39: 100%|██████████| 313/313 [06:53<00:00,  0.76it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0059, Train/loss_recog_step=1.730, Valid/loss_all_step=0.251, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.251, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.62it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.38it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  7.49it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00,  8.49it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  9.38it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 11.87it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205085, 0.205284, 0.213978, 0.202032
Valid average loss UNet                 (all)                : 0.826378

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.147964, 0.856830, 1.503525
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.130754, 0.574897, 0.697877
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.269465, 1.377619, 1.433076
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.173810, 0.880934, 1.475225
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.205812, 1.296005, 1.617056
Valid average loss all      (Triplet)                 : 0.186009

== Recognize ==
Valid average loss Recognize     : 1.630248
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.186009

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.655665636062622 sec. =
Valid knn accuracy drums     : 71.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.69795846939087 sec. =
Valid knn accuracy bass      : 24.798387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.81507921218872 sec. =
Valid knn accuracy piano     : 35.546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.707828521728516 sec. =
Valid knn accuracy guitar    : 37.723214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.508102416992188 sec. =
Valid knn accuracy residuals : 61.59090909090909%

Valid knn accuracy average   : 46.19274665989691%

                                                                      [AEpoch 39: 100%|██████████| 313/313 [08:12<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0059, Train/loss_recog_step=1.730, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0377, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0377, Train/loss_recog_epoch=1.700]Epoch 39: 100%|██████████| 313/313 [08:12<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0059, Train/loss_recog_step=1.730, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208353, 0.209616, 0.211970, 0.210780
Train average loss UNet                 (all)                : 0.840719

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.015372, 0.882699, 2.169968
Train average loss bass     (Triplet, dist_p, dist_n) : 0.062712, 0.695940, 1.048773
Train average loss piano    (Triplet, dist_p, dist_n) : 0.034910, 1.046119, 1.686865
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.031788, 0.955483, 1.625069
Train average loss residuals(Triplet, dist_p, dist_n) : 0.023696, 1.184396, 2.028281
Train average loss all      (Triplet)                 : 0.034179

== Recognize ==
Train average loss Recognize     : 1.728710
Train average accuracy drums     : 49.935001 %
Train average accuracy bass      : 49.889999 %
Train average accuracy piano     : 49.399998 %
Train average accuracy guitar    : 49.900002 %
Train average accuracy residuals : 49.434998 %

== Train average loss all : 0.034179

Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0059, Train/loss_recog_step=1.730, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]          Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0059, Train/loss_recog_step=1.730, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]Epoch 40:  16%|█▌        | 50/313 [01:14<06:29,  0.67it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0059, Train/loss_recog_step=1.730, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]Epoch 40:  16%|█▌        | 50/313 [01:14<06:29,  0.67it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=1.580, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]Epoch 40:  32%|███▏      | 100/313 [02:21<05:01,  0.71it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=1.580, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]Epoch 40:  32%|███▏      | 100/313 [02:21<05:01,  0.71it/s, v_num=0, Train/loss_all_step=0.0362, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.0362, Train/loss_recog_step=1.650, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]Epoch 40:  48%|████▊     | 150/313 [03:26<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.0362, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.0362, Train/loss_recog_step=1.650, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]Epoch 40:  48%|████▊     | 150/313 [03:26<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.0386, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0386, Train/loss_recog_step=1.800, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]Epoch 40:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.0386, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0386, Train/loss_recog_step=1.800, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]Epoch 40:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.0286, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=1.780, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]Epoch 40:  80%|███████▉  | 250/313 [05:37<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.0286, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=1.780, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]Epoch 40:  80%|███████▉  | 250/313 [05:37<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0268, Train/loss_recog_step=1.840, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]Epoch 40:  96%|█████████▌| 300/313 [06:44<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0268, Train/loss_recog_step=1.840, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]Epoch 40:  96%|█████████▌| 300/313 [06:44<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.057, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.057, Train/loss_recog_step=1.660, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]  Epoch 40: 100%|██████████| 313/313 [06:58<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.057, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.057, Train/loss_recog_step=1.660, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]Epoch 40: 100%|██████████| 313/313 [06:58<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.730, Valid/loss_all_step=0.107, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=1.630, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.53it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.65it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.85it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 12.39it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.53it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205016, 0.205150, 0.214098, 0.202016
Valid average loss UNet                 (all)                : 0.826281

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.156756, 0.911915, 1.609375
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.145963, 0.658893, 0.791967
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.422091, 1.621181, 1.588463
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.142062, 0.999098, 1.569049
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.287294, 1.574407, 1.846054
Valid average loss all      (Triplet)                 : 0.260812

== Recognize ==
Valid average loss Recognize     : 1.618452
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.260812

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.52126669883728 sec. =
Valid knn accuracy drums     : 71.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.432265043258667 sec. =
Valid knn accuracy bass      : 18.548387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.044270038604736 sec. =
Valid knn accuracy piano     : 30.2734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.35258960723877 sec. =
Valid knn accuracy guitar    : 43.080357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.19268536567688 sec. =
Valid knn accuracy residuals : 59.54545454545455%

Valid knn accuracy average   : 44.506918561365005%

                                                                      [AEpoch 40: 100%|██████████| 313/313 [08:17<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.730, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0342, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0342, Train/loss_recog_epoch=1.730]Epoch 40: 100%|██████████| 313/313 [08:17<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.730, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208371, 0.209641, 0.211991, 0.210769
Train average loss UNet                 (all)                : 0.840773

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.015613, 0.889569, 2.124082
Train average loss bass     (Triplet, dist_p, dist_n) : 0.061171, 0.728350, 1.099919
Train average loss piano    (Triplet, dist_p, dist_n) : 0.035585, 1.085640, 1.763448
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.033739, 0.999279, 1.682966
Train average loss residuals(Triplet, dist_p, dist_n) : 0.018627, 1.205562, 2.091547
Train average loss all      (Triplet)                 : 0.033221

== Recognize ==
Train average loss Recognize     : 1.713935
Train average accuracy drums     : 50.010002 %
Train average accuracy bass      : 50.820000 %
Train average accuracy piano     : 50.314999 %
Train average accuracy guitar    : 49.669998 %
Train average accuracy residuals : 49.939999 %

== Train average loss all : 0.033221

Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.730, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]          Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.730, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]Epoch 41:  16%|█▌        | 50/313 [01:15<06:35,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.730, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]Epoch 41:  16%|█▌        | 50/313 [01:15<06:35,  0.66it/s, v_num=0, Train/loss_all_step=0.0261, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0261, Train/loss_recog_step=1.800, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]Epoch 41:  32%|███▏      | 100/313 [02:19<04:57,  0.72it/s, v_num=0, Train/loss_all_step=0.0261, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0261, Train/loss_recog_step=1.800, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]Epoch 41:  32%|███▏      | 100/313 [02:19<04:57,  0.72it/s, v_num=0, Train/loss_all_step=0.0212, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0212, Train/loss_recog_step=1.890, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]Epoch 41:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.0212, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0212, Train/loss_recog_step=1.890, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]Epoch 41:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=1.640, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]Epoch 41:  64%|██████▍   | 200/313 [04:30<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=1.640, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]Epoch 41:  64%|██████▍   | 200/313 [04:30<02:32,  0.74it/s, v_num=0, Train/loss_all_step=0.0265, Train/loss_unet_all_step=0.877, Train/loss_triplet_all_step=0.0265, Train/loss_recog_step=1.610, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]Epoch 41:  80%|███████▉  | 250/313 [05:36<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.0265, Train/loss_unet_all_step=0.877, Train/loss_triplet_all_step=0.0265, Train/loss_recog_step=1.610, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]Epoch 41:  80%|███████▉  | 250/313 [05:36<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.0253, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0253, Train/loss_recog_step=1.530, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]Epoch 41:  96%|█████████▌| 300/313 [06:43<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0253, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0253, Train/loss_recog_step=1.530, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]Epoch 41:  96%|█████████▌| 300/313 [06:43<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0227, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0227, Train/loss_recog_step=1.720, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]Epoch 41: 100%|██████████| 313/313 [06:57<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0227, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0227, Train/loss_recog_step=1.720, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]Epoch 41: 100%|██████████| 313/313 [06:57<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=1.800, Valid/loss_all_step=0.330, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=1.620, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.91it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 13.02it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 12.18it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00,  8.92it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.08it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204445, 0.204543, 0.213184, 0.193761
Valid average loss UNet                 (all)                : 0.815934

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.185759, 0.874553, 1.488938
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.145665, 0.651716, 0.781587
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.381755, 1.531099, 1.516472
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.133939, 1.001789, 1.589284
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.289946, 1.522644, 1.754363
Valid average loss all      (Triplet)                 : 0.250156

== Recognize ==
Valid average loss Recognize     : 1.853272
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 44.500000 %
Valid average accuracy residuals : 43.000000 %

== Valid average loss all : 0.250156

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.416251420974731 sec. =
Valid knn accuracy drums     : 64.56521739130436%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.51660966873169 sec. =
Valid knn accuracy bass      : 23.588709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.486350059509277 sec. =
Valid knn accuracy piano     : 32.2265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.729015111923218 sec. =
Valid knn accuracy guitar    : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.077656269073486 sec. =
Valid knn accuracy residuals : 61.81818181818181%

Valid knn accuracy average   : 43.939734277381106%

                                                                      [AEpoch 41: 100%|██████████| 313/313 [08:14<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=1.800, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0332, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0332, Train/loss_recog_epoch=1.710]Epoch 41: 100%|██████████| 313/313 [08:14<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=1.800, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208554, 0.209818, 0.212130, 0.210988
Train average loss UNet                 (all)                : 0.841491

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.013015, 0.948214, 2.268632
Train average loss bass     (Triplet, dist_p, dist_n) : 0.056159, 0.768573, 1.171327
Train average loss piano    (Triplet, dist_p, dist_n) : 0.029070, 1.116899, 1.837237
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.028669, 1.044627, 1.776826
Train average loss residuals(Triplet, dist_p, dist_n) : 0.016415, 1.287453, 2.222992
Train average loss all      (Triplet)                 : 0.029147

== Recognize ==
Train average loss Recognize     : 1.728757
Train average accuracy drums     : 49.704998 %
Train average accuracy bass      : 49.349998 %
Train average accuracy piano     : 49.770000 %
Train average accuracy guitar    : 50.005001 %
Train average accuracy residuals : 50.120003 %

== Train average loss all : 0.029147

Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=1.800, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]          Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=1.800, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]Epoch 42:  16%|█▌        | 50/313 [01:18<06:51,  0.64it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=1.800, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]Epoch 42:  16%|█▌        | 50/313 [01:18<06:51,  0.64it/s, v_num=0, Train/loss_all_step=0.0448, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0448, Train/loss_recog_step=1.700, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]Epoch 42:  32%|███▏      | 100/313 [02:24<05:08,  0.69it/s, v_num=0, Train/loss_all_step=0.0448, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0448, Train/loss_recog_step=1.700, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]Epoch 42:  32%|███▏      | 100/313 [02:24<05:08,  0.69it/s, v_num=0, Train/loss_all_step=0.029, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=1.700, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]  Epoch 42:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.029, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=1.700, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]Epoch 42:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.014, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.014, Train/loss_recog_step=1.840, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]Epoch 42:  64%|██████▍   | 200/313 [04:37<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.014, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.014, Train/loss_recog_step=1.840, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]Epoch 42:  64%|██████▍   | 200/313 [04:37<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.0241, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.0241, Train/loss_recog_step=1.680, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]Epoch 42:  80%|███████▉  | 250/313 [05:42<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.0241, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.0241, Train/loss_recog_step=1.680, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]Epoch 42:  80%|███████▉  | 250/313 [05:42<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.0202, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0202, Train/loss_recog_step=1.840, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]Epoch 42:  96%|█████████▌| 300/313 [06:47<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0202, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0202, Train/loss_recog_step=1.840, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]Epoch 42:  96%|█████████▌| 300/313 [06:47<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0415, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.0415, Train/loss_recog_step=1.690, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]Epoch 42: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0415, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.0415, Train/loss_recog_step=1.690, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]Epoch 42: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0072, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0072, Train/loss_recog_step=1.580, Valid/loss_all_step=0.328, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.250, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.250, Valid/loss_recog_epoch=1.850, Valid/knn_avr=0.439, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.70it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.28it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.81it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  9.18it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.36it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205246, 0.205266, 0.214071, 0.200940
Valid average loss UNet                 (all)                : 0.825524

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.264648, 1.039603, 1.611770
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.158563, 0.646759, 0.769266
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.429140, 1.550660, 1.550034
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.151088, 1.040680, 1.633950
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.276705, 1.525324, 1.825822
Valid average loss all      (Triplet)                 : 0.279821

== Recognize ==
Valid average loss Recognize     : 1.783600
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.279821

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.35368537902832 sec. =
Valid knn accuracy drums     : 67.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.383447408676147 sec. =
Valid knn accuracy bass      : 22.983870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.090489149093628 sec. =
Valid knn accuracy piano     : 28.515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.426896810531616 sec. =
Valid knn accuracy guitar    : 39.0625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.215091466903687 sec. =
Valid knn accuracy residuals : 62.272727272727266%

Valid knn accuracy average   : 44.00172725678949%

                                                                      [AEpoch 42: 100%|██████████| 313/313 [08:20<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0072, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0072, Train/loss_recog_step=1.580, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0291, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0291, Train/loss_recog_epoch=1.730]Epoch 42: 100%|██████████| 313/313 [08:20<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0072, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0072, Train/loss_recog_step=1.580, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208654, 0.209927, 0.212253, 0.211179
Train average loss UNet                 (all)                : 0.842014

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.012907, 0.970680, 2.326977
Train average loss bass     (Triplet, dist_p, dist_n) : 0.049497, 0.815118, 1.262932
Train average loss piano    (Triplet, dist_p, dist_n) : 0.028660, 1.142474, 1.891206
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.029271, 1.080320, 1.860950
Train average loss residuals(Triplet, dist_p, dist_n) : 0.016548, 1.345228, 2.342742
Train average loss all      (Triplet)                 : 0.027656

== Recognize ==
Train average loss Recognize     : 1.733168
Train average accuracy drums     : 49.419998 %
Train average accuracy bass      : 50.405003 %
Train average accuracy piano     : 50.110001 %
Train average accuracy guitar    : 49.564999 %
Train average accuracy residuals : 50.440002 %

== Train average loss all : 0.027656

Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0072, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0072, Train/loss_recog_step=1.580, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]          Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0072, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0072, Train/loss_recog_step=1.580, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]Epoch 43:  16%|█▌        | 50/313 [01:15<06:34,  0.67it/s, v_num=0, Train/loss_all_step=0.0072, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0072, Train/loss_recog_step=1.580, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]Epoch 43:  16%|█▌        | 50/313 [01:15<06:34,  0.67it/s, v_num=0, Train/loss_all_step=0.0362, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0362, Train/loss_recog_step=1.550, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]Epoch 43:  32%|███▏      | 100/313 [02:21<05:01,  0.71it/s, v_num=0, Train/loss_all_step=0.0362, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0362, Train/loss_recog_step=1.550, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]Epoch 43:  32%|███▏      | 100/313 [02:21<05:01,  0.71it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.0147, Train/loss_recog_step=1.630, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]Epoch 43:  48%|████▊     | 150/313 [03:31<03:50,  0.71it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.0147, Train/loss_recog_step=1.630, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]Epoch 43:  48%|████▊     | 150/313 [03:31<03:50,  0.71it/s, v_num=0, Train/loss_all_step=0.0242, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.0242, Train/loss_recog_step=1.650, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]Epoch 43:  64%|██████▍   | 200/313 [04:36<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.0242, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.0242, Train/loss_recog_step=1.650, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]Epoch 43:  64%|██████▍   | 200/313 [04:36<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.0239, Train/loss_unet_all_step=0.868, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=1.600, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]Epoch 43:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.0239, Train/loss_unet_all_step=0.868, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=1.600, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]Epoch 43:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.0253, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0253, Train/loss_recog_step=1.740, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]Epoch 43:  96%|█████████▌| 300/313 [06:47<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0253, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0253, Train/loss_recog_step=1.740, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]Epoch 43:  96%|█████████▌| 300/313 [06:47<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=1.670, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]Epoch 43: 100%|██████████| 313/313 [07:02<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=1.670, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]Epoch 43: 100%|██████████| 313/313 [07:02<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0299, Train/loss_recog_step=1.620, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.850, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.76it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.11it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.28it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.45it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  8.13it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.203383, 0.203369, 0.212094, 0.203495
Valid average loss UNet                 (all)                : 0.822341

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.234685, 1.156253, 1.802779
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.159998, 0.738014, 0.876636
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.350475, 1.729689, 1.780703
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.129670, 1.145327, 1.851633
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.430577, 1.774178, 1.893233
Valid average loss all      (Triplet)                 : 0.273359

== Recognize ==
Valid average loss Recognize     : 1.699503
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.273359

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.018285512924194 sec. =
Valid knn accuracy drums     : 69.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.821057319641113 sec. =
Valid knn accuracy bass      : 21.774193548387096%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.459245920181274 sec. =
Valid knn accuracy piano     : 31.640625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.444805145263672 sec. =
Valid knn accuracy guitar    : 39.50892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.203848123550415 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 45.317951004990796%

                                                                      [AEpoch 43: 100%|██████████| 313/313 [08:24<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0299, Train/loss_recog_step=1.620, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0277, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0277, Train/loss_recog_epoch=1.730]Epoch 43: 100%|██████████| 313/313 [08:24<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0299, Train/loss_recog_step=1.620, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208531, 0.209782, 0.212094, 0.211050
Train average loss UNet                 (all)                : 0.841458

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.010579, 0.981683, 2.329707
Train average loss bass     (Triplet, dist_p, dist_n) : 0.045083, 0.840476, 1.318037
Train average loss piano    (Triplet, dist_p, dist_n) : 0.024424, 1.198112, 1.975341
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.026682, 1.119332, 1.932767
Train average loss residuals(Triplet, dist_p, dist_n) : 0.018590, 1.389182, 2.425982
Train average loss all      (Triplet)                 : 0.025486

== Recognize ==
Train average loss Recognize     : 1.718320
Train average accuracy drums     : 50.295002 %
Train average accuracy bass      : 49.974998 %
Train average accuracy piano     : 50.050003 %
Train average accuracy guitar    : 50.424999 %
Train average accuracy residuals : 50.134998 %

== Train average loss all : 0.025486

Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0299, Train/loss_recog_step=1.620, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]          Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0299, Train/loss_recog_step=1.620, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]Epoch 44:  16%|█▌        | 50/313 [01:13<06:27,  0.68it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0299, Train/loss_recog_step=1.620, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]Epoch 44:  16%|█▌        | 50/313 [01:13<06:27,  0.68it/s, v_num=0, Train/loss_all_step=0.027, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.027, Train/loss_recog_step=1.630, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]  Epoch 44:  32%|███▏      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.027, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.027, Train/loss_recog_step=1.630, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]Epoch 44:  32%|███▏      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.0248, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.0248, Train/loss_recog_step=1.760, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]Epoch 44:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.0248, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.0248, Train/loss_recog_step=1.760, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]Epoch 44:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=1.730, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]Epoch 44:  64%|██████▍   | 200/313 [04:35<02:35,  0.72it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=1.730, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]Epoch 44:  64%|██████▍   | 200/313 [04:35<02:35,  0.72it/s, v_num=0, Train/loss_all_step=0.0189, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.0189, Train/loss_recog_step=1.750, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]Epoch 44:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.0189, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.0189, Train/loss_recog_step=1.750, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]Epoch 44:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=1.640, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]Epoch 44:  96%|█████████▌| 300/313 [06:54<00:17,  0.72it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=1.640, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]Epoch 44:  96%|█████████▌| 300/313 [06:54<00:17,  0.72it/s, v_num=0, Train/loss_all_step=0.0248, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0248, Train/loss_recog_step=1.620, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]Epoch 44: 100%|██████████| 313/313 [07:09<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0248, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0248, Train/loss_recog_step=1.620, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]Epoch 44: 100%|██████████| 313/313 [07:09<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00851, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00851, Train/loss_recog_step=1.540, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.816, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.620, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.273, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.453, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  7.09it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.99it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.97it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204380, 0.204255, 0.213234, 0.202761
Valid average loss UNet                 (all)                : 0.824629

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.295554, 1.129291, 1.789328
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.169156, 0.763500, 0.865232
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.298113, 1.682194, 1.828360
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.173256, 1.175794, 1.792494
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.288799, 1.718312, 1.987861
Valid average loss all      (Triplet)                 : 0.258699

== Recognize ==
Valid average loss Recognize     : 1.758035
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 44.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.258699

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.974029064178467 sec. =
Valid knn accuracy drums     : 66.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.415152549743652 sec. =
Valid knn accuracy bass      : 21.572580645161292%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.016723394393921 sec. =
Valid knn accuracy piano     : 32.421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.103731632232666 sec. =
Valid knn accuracy guitar    : 37.723214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.58218264579773 sec. =
Valid knn accuracy residuals : 58.86363636363636%

Valid knn accuracy average   : 43.50756560672847%

                                                                      [AEpoch 44: 100%|██████████| 313/313 [08:26<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.00851, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00851, Train/loss_recog_step=1.540, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0255, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0255, Train/loss_recog_epoch=1.720]Epoch 44: 100%|██████████| 313/313 [08:26<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.00851, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00851, Train/loss_recog_step=1.540, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208406, 0.209658, 0.211976, 0.210228
Train average loss UNet                 (all)                : 0.840268

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.010809, 1.024292, 2.425423
Train average loss bass     (Triplet, dist_p, dist_n) : 0.042337, 0.878974, 1.383652
Train average loss piano    (Triplet, dist_p, dist_n) : 0.023189, 1.236114, 2.060018
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.025687, 1.160106, 1.995182
Train average loss residuals(Triplet, dist_p, dist_n) : 0.016072, 1.416410, 2.475060
Train average loss all      (Triplet)                 : 0.024169

== Recognize ==
Train average loss Recognize     : 1.761791
Train average accuracy drums     : 50.260002 %
Train average accuracy bass      : 50.089996 %
Train average accuracy piano     : 49.395000 %
Train average accuracy guitar    : 49.865002 %
Train average accuracy residuals : 50.040001 %

== Train average loss all : 0.024169

Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00851, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00851, Train/loss_recog_step=1.540, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]          Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00851, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00851, Train/loss_recog_step=1.540, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]Epoch 45:  16%|█▌        | 50/313 [01:15<06:37,  0.66it/s, v_num=0, Train/loss_all_step=0.00851, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00851, Train/loss_recog_step=1.540, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]Epoch 45:  16%|█▌        | 50/313 [01:15<06:37,  0.66it/s, v_num=0, Train/loss_all_step=0.0273, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0273, Train/loss_recog_step=1.850, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]  Epoch 45:  32%|███▏      | 100/313 [02:23<05:06,  0.70it/s, v_num=0, Train/loss_all_step=0.0273, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0273, Train/loss_recog_step=1.850, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]Epoch 45:  32%|███▏      | 100/313 [02:23<05:06,  0.70it/s, v_num=0, Train/loss_all_step=0.0256, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=1.840, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]Epoch 45:  48%|████▊     | 150/313 [03:30<03:49,  0.71it/s, v_num=0, Train/loss_all_step=0.0256, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=1.840, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]Epoch 45:  48%|████▊     | 150/313 [03:30<03:49,  0.71it/s, v_num=0, Train/loss_all_step=0.0347, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.0347, Train/loss_recog_step=1.730, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]Epoch 45:  64%|██████▍   | 200/313 [04:37<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.0347, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.0347, Train/loss_recog_step=1.730, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]Epoch 45:  64%|██████▍   | 200/313 [04:37<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=1.770, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]Epoch 45:  80%|███████▉  | 250/313 [05:46<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=1.770, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]Epoch 45:  80%|███████▉  | 250/313 [05:46<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00688, Train/loss_recog_step=1.870, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]Epoch 45:  96%|█████████▌| 300/313 [06:53<00:17,  0.72it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00688, Train/loss_recog_step=1.870, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]Epoch 45:  96%|█████████▌| 300/313 [06:53<00:17,  0.72it/s, v_num=0, Train/loss_all_step=0.0239, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=1.860, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]  Epoch 45: 100%|██████████| 313/313 [07:08<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0239, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=1.860, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]Epoch 45: 100%|██████████| 313/313 [07:08<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=1.660, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.51it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.41it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 11.05it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 11.12it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 11.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204855, 0.204896, 0.213725, 0.201432
Valid average loss UNet                 (all)                : 0.824907

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.218609, 1.152500, 1.864568
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.189979, 0.787923, 0.892143
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.383097, 1.871310, 1.897475
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.158284, 1.251348, 1.842944
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.436574, 1.701431, 1.752842
Valid average loss all      (Triplet)                 : 0.293589

== Recognize ==
Valid average loss Recognize     : 1.724043
Valid average accuracy drums     : 61.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.293589

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.87888240814209 sec. =
Valid knn accuracy drums     : 65.8695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.869066953659058 sec. =
Valid knn accuracy bass      : 22.379032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.395489692687988 sec. =
Valid knn accuracy piano     : 32.6171875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.951826572418213 sec. =
Valid knn accuracy guitar    : 39.285714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.797632455825806 sec. =
Valid knn accuracy residuals : 63.18181818181819%

Valid knn accuracy average   : 44.666663488597656%

                                                                      [AEpoch 45: 100%|██████████| 313/313 [08:22<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=1.660, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=1.760]Epoch 45: 100%|██████████| 313/313 [08:22<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=1.660, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208460, 0.209729, 0.212046, 0.210845
Train average loss UNet                 (all)                : 0.841080

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.010984, 1.050417, 2.524493
Train average loss bass     (Triplet, dist_p, dist_n) : 0.039269, 0.909588, 1.447353
Train average loss piano    (Triplet, dist_p, dist_n) : 0.024753, 1.257582, 2.092831
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.022940, 1.160262, 2.016544
Train average loss residuals(Triplet, dist_p, dist_n) : 0.014044, 1.423016, 2.509898
Train average loss all      (Triplet)                 : 0.022780

== Recognize ==
Train average loss Recognize     : 1.772105
Train average accuracy drums     : 49.860001 %
Train average accuracy bass      : 49.950001 %
Train average accuracy piano     : 49.514999 %
Train average accuracy guitar    : 49.410000 %
Train average accuracy residuals : 50.395000 %

== Train average loss all : 0.022780

Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=1.660, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]          Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=1.660, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]Epoch 46:  16%|█▌        | 50/313 [01:16<06:42,  0.65it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=1.660, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]Epoch 46:  16%|█▌        | 50/313 [01:16<06:42,  0.65it/s, v_num=0, Train/loss_all_step=0.0175, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=1.800, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]Epoch 46:  32%|███▏      | 100/313 [02:25<05:09,  0.69it/s, v_num=0, Train/loss_all_step=0.0175, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=1.800, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]Epoch 46:  32%|███▏      | 100/313 [02:25<05:09,  0.69it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.890, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]Epoch 46:  48%|████▊     | 150/313 [03:32<03:51,  0.71it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.890, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]Epoch 46:  48%|████▊     | 150/313 [03:32<03:51,  0.71it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=1.680, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]Epoch 46:  64%|██████▍   | 200/313 [04:37<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=1.680, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]Epoch 46:  64%|██████▍   | 200/313 [04:37<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.0259, Train/loss_unet_all_step=0.874, Train/loss_triplet_all_step=0.0259, Train/loss_recog_step=1.760, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]Epoch 46:  80%|███████▉  | 250/313 [05:47<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.0259, Train/loss_unet_all_step=0.874, Train/loss_triplet_all_step=0.0259, Train/loss_recog_step=1.760, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]Epoch 46:  80%|███████▉  | 250/313 [05:47<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.00799, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00799, Train/loss_recog_step=1.850, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]Epoch 46:  96%|█████████▌| 300/313 [06:55<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.00799, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00799, Train/loss_recog_step=1.850, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]Epoch 46:  96%|█████████▌| 300/313 [06:55<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=1.650, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]  Epoch 46: 100%|██████████| 313/313 [07:12<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=1.650, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]Epoch 46: 100%|██████████| 313/313 [07:12<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=1.780, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.68it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.56it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.61it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  7.11it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  7.85it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  7.42it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204295, 0.204388, 0.212788, 0.204868
Valid average loss UNet                 (all)                : 0.826340

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.284249, 1.282033, 2.001589
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.185449, 0.802161, 0.973535
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.417638, 1.959726, 1.955248
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.209137, 1.300124, 1.814618
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.246886, 1.635921, 2.046341
Valid average loss all      (Triplet)                 : 0.295473

== Recognize ==
Valid average loss Recognize     : 1.746322
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 54.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.295473

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.547252893447876 sec. =
Valid knn accuracy drums     : 65.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.018272876739502 sec. =
Valid knn accuracy bass      : 19.758064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.033159255981445 sec. =
Valid knn accuracy piano     : 36.5234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.770113945007324 sec. =
Valid knn accuracy guitar    : 41.517857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.694324254989624 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 45.423508195433605%

                                                                      [AEpoch 46: 100%|██████████| 313/313 [08:28<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=1.780, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0228, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0228, Train/loss_recog_epoch=1.770]Epoch 46: 100%|██████████| 313/313 [08:28<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=1.780, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208633, 0.209880, 0.212198, 0.210616
Train average loss UNet                 (all)                : 0.841327

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.008163, 1.066353, 2.633473
Train average loss bass     (Triplet, dist_p, dist_n) : 0.035596, 0.941177, 1.515261
Train average loss piano    (Triplet, dist_p, dist_n) : 0.021417, 1.248194, 2.081811
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.022350, 1.174120, 2.060818
Train average loss residuals(Triplet, dist_p, dist_n) : 0.014385, 1.414717, 2.485691
Train average loss all      (Triplet)                 : 0.020653

== Recognize ==
Train average loss Recognize     : 1.762124
Train average accuracy drums     : 49.825001 %
Train average accuracy bass      : 49.450001 %
Train average accuracy piano     : 49.489998 %
Train average accuracy guitar    : 50.320000 %
Train average accuracy residuals : 49.785000 %

== Train average loss all : 0.020653

Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=1.780, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]          Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=1.780, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]Epoch 47:  16%|█▌        | 50/313 [01:14<06:29,  0.67it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=1.780, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]Epoch 47:  16%|█▌        | 50/313 [01:14<06:29,  0.67it/s, v_num=0, Train/loss_all_step=0.0259, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0259, Train/loss_recog_step=1.780, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]Epoch 47:  32%|███▏      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.0259, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0259, Train/loss_recog_step=1.780, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]Epoch 47:  32%|███▏      | 100/313 [02:18<04:55,  0.72it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=1.780, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]Epoch 47:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=1.780, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]Epoch 47:  48%|████▊     | 150/313 [03:24<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0229, Train/loss_recog_step=1.710, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]Epoch 47:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0229, Train/loss_recog_step=1.710, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]Epoch 47:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=1.790, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]Epoch 47:  80%|███████▉  | 250/313 [05:37<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=1.790, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]Epoch 47:  80%|███████▉  | 250/313 [05:37<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=1.810, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]  Epoch 47:  96%|█████████▌| 300/313 [06:44<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=1.810, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]Epoch 47:  96%|█████████▌| 300/313 [06:44<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0291, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0291, Train/loss_recog_step=1.920, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]Epoch 47: 100%|██████████| 313/313 [06:59<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0291, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0291, Train/loss_recog_step=1.920, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]Epoch 47: 100%|██████████| 313/313 [06:59<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.000252, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000252, Train/loss_recog_step=1.820, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.814, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.97it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 12.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.72it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  7.82it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 11.09it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204552, 0.204488, 0.213045, 0.194755
Valid average loss UNet                 (all)                : 0.816840

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.246921, 1.270721, 2.071853
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.191186, 0.787370, 0.959546
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.456752, 1.990199, 1.958657
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.207160, 1.249551, 1.918370
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.413667, 1.741492, 1.820744
Valid average loss all      (Triplet)                 : 0.327382

== Recognize ==
Valid average loss Recognize     : 1.922669
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 54.500000 %
Valid average accuracy piano     : 41.500000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.327382

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.3012855052948 sec. =
Valid knn accuracy drums     : 66.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.77433705329895 sec. =
Valid knn accuracy bass      : 21.975806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.394550561904907 sec. =
Valid knn accuracy piano     : 36.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.104965686798096 sec. =
Valid knn accuracy guitar    : 41.294642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.750060081481934 sec. =
Valid knn accuracy residuals : 57.72727272727273%

Valid knn accuracy average   : 44.73045473329266%

                                                                      [AEpoch 47: 100%|██████████| 313/313 [08:14<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.000252, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000252, Train/loss_recog_step=1.820, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0207, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0207, Train/loss_recog_epoch=1.760]Epoch 47: 100%|██████████| 313/313 [08:14<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.000252, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000252, Train/loss_recog_step=1.820, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.209011, 0.210252, 0.212560, 0.210110
Train average loss UNet                 (all)                : 0.841933

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.009100, 1.135388, 2.741738
Train average loss bass     (Triplet, dist_p, dist_n) : 0.031612, 0.984888, 1.589938
Train average loss piano    (Triplet, dist_p, dist_n) : 0.020635, 1.303474, 2.188671
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.021836, 1.233172, 2.135667
Train average loss residuals(Triplet, dist_p, dist_n) : 0.013796, 1.479013, 2.597379
Train average loss all      (Triplet)                 : 0.019733

== Recognize ==
Train average loss Recognize     : 1.738093
Train average accuracy drums     : 50.070000 %
Train average accuracy bass      : 49.825001 %
Train average accuracy piano     : 49.514999 %
Train average accuracy guitar    : 49.990002 %
Train average accuracy residuals : 49.739998 %

== Train average loss all : 0.019733

Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000252, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000252, Train/loss_recog_step=1.820, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]          Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000252, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000252, Train/loss_recog_step=1.820, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]Epoch 48:  16%|█▌        | 50/313 [01:14<06:32,  0.67it/s, v_num=0, Train/loss_all_step=0.000252, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000252, Train/loss_recog_step=1.820, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]Epoch 48:  16%|█▌        | 50/313 [01:14<06:32,  0.67it/s, v_num=0, Train/loss_all_step=0.0254, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0254, Train/loss_recog_step=1.850, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]    Epoch 48:  32%|███▏      | 100/313 [02:22<05:04,  0.70it/s, v_num=0, Train/loss_all_step=0.0254, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0254, Train/loss_recog_step=1.850, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]Epoch 48:  32%|███▏      | 100/313 [02:22<05:04,  0.70it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=1.550, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]Epoch 48:  48%|████▊     | 150/313 [03:33<03:52,  0.70it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=1.550, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]Epoch 48:  48%|████▊     | 150/313 [03:33<03:52,  0.70it/s, v_num=0, Train/loss_all_step=0.0185, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.0185, Train/loss_recog_step=1.650, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]Epoch 48:  64%|██████▍   | 200/313 [04:39<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.0185, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.0185, Train/loss_recog_step=1.650, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]Epoch 48:  64%|██████▍   | 200/313 [04:39<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.0236, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.0236, Train/loss_recog_step=1.700, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]Epoch 48:  80%|███████▉  | 250/313 [05:45<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.0236, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.0236, Train/loss_recog_step=1.700, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]Epoch 48:  80%|███████▉  | 250/313 [05:45<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=1.530, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]Epoch 48:  96%|█████████▌| 300/313 [06:54<00:17,  0.72it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=1.530, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]Epoch 48:  96%|█████████▌| 300/313 [06:54<00:17,  0.72it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0128, Train/loss_recog_step=1.690, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]Epoch 48: 100%|██████████| 313/313 [07:08<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0128, Train/loss_recog_step=1.690, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]Epoch 48: 100%|██████████| 313/313 [07:08<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00979, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00979, Train/loss_recog_step=1.700, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=2.290, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.75it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 10.94it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.96it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.09it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  9.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 12.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204656, 0.204709, 0.213218, 0.206478
Valid average loss UNet                 (all)                : 0.829060

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.085504, 1.165595, 2.080760
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.196017, 0.811597, 1.022539
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.475882, 1.969147, 1.901348
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.168295, 1.199020, 1.864977
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.330846, 1.853882, 2.076739
Valid average loss all      (Triplet)                 : 0.290564

== Recognize ==
Valid average loss Recognize     : 1.652513
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.290564

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.357223510742188 sec. =
Valid knn accuracy drums     : 57.826086956521735%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.160324573516846 sec. =
Valid knn accuracy bass      : 19.758064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.058175325393677 sec. =
Valid knn accuracy piano     : 33.7890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.861716032028198 sec. =
Valid knn accuracy guitar    : 41.07142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.652926683425903 sec. =
Valid knn accuracy residuals : 59.31818181818181%

Valid knn accuracy average   : 42.352564872452234%

                                                                      [AEpoch 48: 100%|██████████| 313/313 [08:25<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.00979, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00979, Train/loss_recog_step=1.700, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=1.740]Epoch 48: 100%|██████████| 313/313 [08:25<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.00979, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00979, Train/loss_recog_step=1.700, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208669, 0.209916, 0.212232, 0.210452
Train average loss UNet                 (all)                : 0.841269

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.009800, 1.142702, 2.701308
Train average loss bass     (Triplet, dist_p, dist_n) : 0.028984, 0.996708, 1.628922
Train average loss piano    (Triplet, dist_p, dist_n) : 0.020040, 1.329175, 2.238667
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.020713, 1.254269, 2.174574
Train average loss residuals(Triplet, dist_p, dist_n) : 0.015113, 1.493737, 2.615931
Train average loss all      (Triplet)                 : 0.019097

== Recognize ==
Train average loss Recognize     : 1.732978
Train average accuracy drums     : 49.860001 %
Train average accuracy bass      : 50.190002 %
Train average accuracy piano     : 50.570000 %
Train average accuracy guitar    : 49.485001 %
Train average accuracy residuals : 50.075001 %

== Train average loss all : 0.019097

Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00979, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00979, Train/loss_recog_step=1.700, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]          Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00979, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00979, Train/loss_recog_step=1.700, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]Epoch 49:  16%|█▌        | 50/313 [01:16<06:40,  0.66it/s, v_num=0, Train/loss_all_step=0.00979, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00979, Train/loss_recog_step=1.700, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]Epoch 49:  16%|█▌        | 50/313 [01:16<06:40,  0.66it/s, v_num=0, Train/loss_all_step=0.0089, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0089, Train/loss_recog_step=1.830, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]  Epoch 49:  32%|███▏      | 100/313 [02:22<05:03,  0.70it/s, v_num=0, Train/loss_all_step=0.0089, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0089, Train/loss_recog_step=1.830, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]Epoch 49:  32%|███▏      | 100/313 [02:22<05:03,  0.70it/s, v_num=0, Train/loss_all_step=0.0265, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.0265, Train/loss_recog_step=1.910, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]Epoch 49:  48%|████▊     | 150/313 [03:28<03:46,  0.72it/s, v_num=0, Train/loss_all_step=0.0265, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.0265, Train/loss_recog_step=1.910, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]Epoch 49:  48%|████▊     | 150/313 [03:28<03:46,  0.72it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=1.860, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]Epoch 49:  64%|██████▍   | 200/313 [04:35<02:35,  0.72it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=1.860, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]Epoch 49:  64%|██████▍   | 200/313 [04:35<02:35,  0.72it/s, v_num=0, Train/loss_all_step=0.0368, Train/loss_unet_all_step=0.878, Train/loss_triplet_all_step=0.0368, Train/loss_recog_step=1.740, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]Epoch 49:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.0368, Train/loss_unet_all_step=0.878, Train/loss_triplet_all_step=0.0368, Train/loss_recog_step=1.740, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]Epoch 49:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.640, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]Epoch 49:  96%|█████████▌| 300/313 [06:50<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.640, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]Epoch 49:  96%|█████████▌| 300/313 [06:50<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.0373, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0373, Train/loss_recog_step=1.730, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]  Epoch 49: 100%|██████████| 313/313 [07:06<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0373, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0373, Train/loss_recog_step=1.730, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]Epoch 49: 100%|██████████| 313/313 [07:06<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.850, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=1.650, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.63it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.83it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.64it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.51it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.203683, 0.203689, 0.212152, 0.211530
Valid average loss UNet                 (all)                : 0.831054

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.271364, 1.327290, 2.088938
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.165827, 0.901795, 1.096494
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.535180, 2.054981, 1.913002
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.147836, 1.355268, 2.056318
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.341364, 1.988232, 2.233806
Valid average loss all      (Triplet)                 : 0.342004

== Recognize ==
Valid average loss Recognize     : 1.678766
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 41.500000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.342004

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.498106956481934 sec. =
Valid knn accuracy drums     : 68.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.736879348754883 sec. =
Valid knn accuracy bass      : 19.959677419354836%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.999463081359863 sec. =
Valid knn accuracy piano     : 35.546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.866145372390747 sec. =
Valid knn accuracy guitar    : 37.276785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.074376344680786 sec. =
Valid knn accuracy residuals : 60.909090909090914%

Valid knn accuracy average   : 44.43413798245934%

                                                                      [AEpoch 49: 100%|██████████| 313/313 [08:24<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.850, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.0191, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=1.730]Epoch 49: 100%|██████████| 313/313 [08:24<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.850, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208970, 0.210226, 0.212526, 0.211519
Train average loss UNet                 (all)                : 0.843241

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.008813, 1.195997, 2.861612
Train average loss bass     (Triplet, dist_p, dist_n) : 0.026059, 1.070348, 1.741354
Train average loss piano    (Triplet, dist_p, dist_n) : 0.020805, 1.374292, 2.291537
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.017404, 1.292883, 2.243559
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011242, 1.535936, 2.725810
Train average loss all      (Triplet)                 : 0.016985

== Recognize ==
Train average loss Recognize     : 1.744836
Train average accuracy drums     : 49.674999 %
Train average accuracy bass      : 50.215000 %
Train average accuracy piano     : 50.520004 %
Train average accuracy guitar    : 49.895000 %
Train average accuracy residuals : 49.990002 %

== Train average loss all : 0.016985

Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.850, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]          Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.850, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]Epoch 50:  16%|█▌        | 50/313 [01:15<06:39,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.850, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]Epoch 50:  16%|█▌        | 50/313 [01:15<06:39,  0.66it/s, v_num=0, Train/loss_all_step=0.0309, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=1.750, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]Epoch 50:  32%|███▏      | 100/313 [02:24<05:07,  0.69it/s, v_num=0, Train/loss_all_step=0.0309, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=1.750, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]Epoch 50:  32%|███▏      | 100/313 [02:24<05:07,  0.69it/s, v_num=0, Train/loss_all_step=0.0301, Train/loss_unet_all_step=0.868, Train/loss_triplet_all_step=0.0301, Train/loss_recog_step=1.530, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]Epoch 50:  48%|████▊     | 150/313 [03:32<03:51,  0.71it/s, v_num=0, Train/loss_all_step=0.0301, Train/loss_unet_all_step=0.868, Train/loss_triplet_all_step=0.0301, Train/loss_recog_step=1.530, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]Epoch 50:  48%|████▊     | 150/313 [03:32<03:51,  0.71it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=1.750, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]Epoch 50:  64%|██████▍   | 200/313 [04:38<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=1.750, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]Epoch 50:  64%|██████▍   | 200/313 [04:38<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.0189, Train/loss_unet_all_step=0.877, Train/loss_triplet_all_step=0.0189, Train/loss_recog_step=1.740, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]Epoch 50:  80%|███████▉  | 250/313 [05:46<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.0189, Train/loss_unet_all_step=0.877, Train/loss_triplet_all_step=0.0189, Train/loss_recog_step=1.740, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]Epoch 50:  80%|███████▉  | 250/313 [05:46<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.0158, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=1.790, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]Epoch 50:  96%|█████████▌| 300/313 [06:54<00:17,  0.72it/s, v_num=0, Train/loss_all_step=0.0158, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=1.790, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]Epoch 50:  96%|█████████▌| 300/313 [06:54<00:17,  0.72it/s, v_num=0, Train/loss_all_step=0.00287, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00287, Train/loss_recog_step=1.870, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]Epoch 50: 100%|██████████| 313/313 [07:09<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00287, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00287, Train/loss_recog_step=1.870, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]Epoch 50: 100%|██████████| 313/313 [07:09<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.780, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.808, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=1.680, Valid/knn_avr=0.444, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 10.57it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.35it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.01it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.52it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.69it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204622, 0.204748, 0.213197, 0.196990
Valid average loss UNet                 (all)                : 0.819558

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.108982, 1.219674, 2.480214
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.200301, 1.000766, 1.164300
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.429908, 2.154757, 2.167084
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.165331, 1.457316, 2.178772
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.318824, 1.975177, 2.386759
Valid average loss all      (Triplet)                 : 0.279817

== Recognize ==
Valid average loss Recognize     : 1.719018
Valid average accuracy drums     : 57.500000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.279817

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.643944263458252 sec. =
Valid knn accuracy drums     : 61.95652173913043%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.907220840454102 sec. =
Valid knn accuracy bass      : 19.153225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.089407205581665 sec. =
Valid knn accuracy piano     : 38.4765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.956737041473389 sec. =
Valid knn accuracy guitar    : 39.285714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.14194655418396 sec. =
Valid knn accuracy residuals : 62.5%

Valid knn accuracy average   : 44.27440486625926%

                                                                      [AEpoch 50: 100%|██████████| 313/313 [08:26<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.780, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.017, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=1.740]Epoch 50: 100%|██████████| 313/313 [08:26<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.780, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208806, 0.210040, 0.212364, 0.211792
Train average loss UNet                 (all)                : 0.843001

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.009877, 1.214601, 2.883503
Train average loss bass     (Triplet, dist_p, dist_n) : 0.027723, 1.091198, 1.783216
Train average loss piano    (Triplet, dist_p, dist_n) : 0.016632, 1.382747, 2.348824
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.017091, 1.307746, 2.292506
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009408, 1.557320, 2.795979
Train average loss all      (Triplet)                 : 0.016428

== Recognize ==
Train average loss Recognize     : 1.763252
Train average accuracy drums     : 49.404999 %
Train average accuracy bass      : 49.715000 %
Train average accuracy piano     : 50.484997 %
Train average accuracy guitar    : 49.910000 %
Train average accuracy residuals : 50.260002 %

== Train average loss all : 0.016428

Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.780, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]          Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.780, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]Epoch 51:  16%|█▌        | 50/313 [01:17<06:49,  0.64it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.780, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]Epoch 51:  16%|█▌        | 50/313 [01:17<06:49,  0.64it/s, v_num=0, Train/loss_all_step=0.0328, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0328, Train/loss_recog_step=1.750, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]Epoch 51:  32%|███▏      | 100/313 [02:24<05:07,  0.69it/s, v_num=0, Train/loss_all_step=0.0328, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0328, Train/loss_recog_step=1.750, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]Epoch 51:  32%|███▏      | 100/313 [02:24<05:07,  0.69it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=1.810, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]Epoch 51:  48%|████▊     | 150/313 [03:31<03:49,  0.71it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=1.810, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]Epoch 51:  48%|████▊     | 150/313 [03:31<03:49,  0.71it/s, v_num=0, Train/loss_all_step=0.00187, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.00187, Train/loss_recog_step=1.870, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]Epoch 51:  64%|██████▍   | 200/313 [04:38<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.00187, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.00187, Train/loss_recog_step=1.870, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]Epoch 51:  64%|██████▍   | 200/313 [04:38<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=1.950, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]  Epoch 51:  80%|███████▉  | 250/313 [05:44<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=1.950, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]Epoch 51:  80%|███████▉  | 250/313 [05:44<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=1.730, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]Epoch 51:  96%|█████████▌| 300/313 [06:52<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=1.730, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]Epoch 51:  96%|█████████▌| 300/313 [06:52<00:17,  0.73it/s, v_num=0, Train/loss_all_step=5.07e-5, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=5.07e-5, Train/loss_recog_step=1.790, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]Epoch 51: 100%|██████████| 313/313 [07:07<00:00,  0.73it/s, v_num=0, Train/loss_all_step=5.07e-5, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=5.07e-5, Train/loss_recog_step=1.790, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]Epoch 51: 100%|██████████| 313/313 [07:07<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.910, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=1.830, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=1.720, Valid/knn_avr=0.443, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.68it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 12.26it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.94it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.00it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.53it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.63it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205625, 0.205791, 0.214143, 0.207619
Valid average loss UNet                 (all)                : 0.833178

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.157114, 1.339538, 2.564529
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.210393, 0.931424, 1.130924
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.454601, 2.129315, 2.063436
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.155827, 1.414729, 2.191739
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.217417, 1.780773, 2.363716
Valid average loss all      (Triplet)                 : 0.281462

== Recognize ==
Valid average loss Recognize     : 1.759184
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 44.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.281462

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.417978763580322 sec. =
Valid knn accuracy drums     : 70.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.796018600463867 sec. =
Valid knn accuracy bass      : 15.725806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.070969581604004 sec. =
Valid knn accuracy piano     : 36.328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.413794040679932 sec. =
Valid knn accuracy guitar    : 41.964285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.831756353378296 sec. =
Valid knn accuracy residuals : 61.36363636363637%

Valid knn accuracy average   : 45.20680548851569%

                                                                      [AEpoch 51: 100%|██████████| 313/313 [08:28<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.910, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0164, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0164, Train/loss_recog_epoch=1.760]Epoch 51: 100%|██████████| 313/313 [08:28<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.910, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.209072, 0.210318, 0.212634, 0.210911
Train average loss UNet                 (all)                : 0.842934

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007505, 1.237195, 2.968282
Train average loss bass     (Triplet, dist_p, dist_n) : 0.023425, 1.093311, 1.817123
Train average loss piano    (Triplet, dist_p, dist_n) : 0.017940, 1.377002, 2.330490
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.016440, 1.297636, 2.282119
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009475, 1.558562, 2.789092
Train average loss all      (Triplet)                 : 0.015081

== Recognize ==
Train average loss Recognize     : 1.758533
Train average accuracy drums     : 49.294998 %
Train average accuracy bass      : 49.785000 %
Train average accuracy piano     : 50.314999 %
Train average accuracy guitar    : 50.320000 %
Train average accuracy residuals : 50.370003 %

== Train average loss all : 0.015081

Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.910, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]          Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.910, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]Epoch 52:  16%|█▌        | 50/313 [01:15<06:37,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.910, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]Epoch 52:  16%|█▌        | 50/313 [01:15<06:37,  0.66it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00352, Train/loss_recog_step=1.700, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]Epoch 52:  32%|███▏      | 100/313 [02:22<05:02,  0.70it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00352, Train/loss_recog_step=1.700, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]Epoch 52:  32%|███▏      | 100/313 [02:22<05:02,  0.70it/s, v_num=0, Train/loss_all_step=0.0203, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=1.780, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]  Epoch 52:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.0203, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=1.780, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]Epoch 52:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.00462, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.00462, Train/loss_recog_step=1.730, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]Epoch 52:  64%|██████▍   | 200/313 [04:40<02:38,  0.71it/s, v_num=0, Train/loss_all_step=0.00462, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.00462, Train/loss_recog_step=1.730, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]Epoch 52:  64%|██████▍   | 200/313 [04:40<02:38,  0.71it/s, v_num=0, Train/loss_all_step=0.00524, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.00524, Train/loss_recog_step=1.690, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]Epoch 52:  80%|███████▉  | 250/313 [05:50<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.00524, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.00524, Train/loss_recog_step=1.690, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]Epoch 52:  80%|███████▉  | 250/313 [05:50<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.880, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]    Epoch 52:  96%|█████████▌| 300/313 [06:55<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.880, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]Epoch 52:  96%|█████████▌| 300/313 [06:55<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.0365, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0365, Train/loss_recog_step=1.660, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]Epoch 52: 100%|██████████| 313/313 [07:12<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.0365, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0365, Train/loss_recog_step=1.660, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]Epoch 52: 100%|██████████| 313/313 [07:12<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.00948, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00948, Train/loss_recog_step=2.030, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.823, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=1.760, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 10.82it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.33it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 12.82it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  9.40it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 11.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205327, 0.205390, 0.213685, 0.196823
Valid average loss UNet                 (all)                : 0.821225

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.144023, 1.344060, 2.388990
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.208040, 0.982978, 1.152174
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.507268, 2.309787, 2.352500
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.250660, 1.613448, 2.224627
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.280368, 2.010316, 2.406172
Valid average loss all      (Triplet)                 : 0.325574

== Recognize ==
Valid average loss Recognize     : 1.774508
Valid average accuracy drums     : 41.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.325574

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.14096450805664 sec. =
Valid knn accuracy drums     : 61.95652173913043%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.895811080932617 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.072902202606201 sec. =
Valid knn accuracy piano     : 36.5234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.812658309936523 sec. =
Valid knn accuracy guitar    : 41.07142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.366961479187012 sec. =
Valid knn accuracy residuals : 58.86363636363636%

Valid knn accuracy average   : 43.43300483483906%

                                                                      [AEpoch 52: 100%|██████████| 313/313 [08:31<00:00,  0.61it/s, v_num=0, Train/loss_all_step=0.00948, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00948, Train/loss_recog_step=2.030, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.760]Epoch 52: 100%|██████████| 313/313 [08:31<00:00,  0.61it/s, v_num=0, Train/loss_all_step=0.00948, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00948, Train/loss_recog_step=2.030, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208934, 0.210194, 0.212529, 0.212123
Train average loss UNet                 (all)                : 0.843779

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007878, 1.270087, 3.071095
Train average loss bass     (Triplet, dist_p, dist_n) : 0.022363, 1.123597, 1.864983
Train average loss piano    (Triplet, dist_p, dist_n) : 0.014693, 1.447881, 2.458416
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.018217, 1.368987, 2.383843
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011431, 1.597254, 2.825757
Train average loss all      (Triplet)                 : 0.014961

== Recognize ==
Train average loss Recognize     : 1.758542
Train average accuracy drums     : 49.634998 %
Train average accuracy bass      : 49.974998 %
Train average accuracy piano     : 49.884998 %
Train average accuracy guitar    : 50.250000 %
Train average accuracy residuals : 50.019997 %

== Train average loss all : 0.014961

Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00948, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00948, Train/loss_recog_step=2.030, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]          Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00948, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00948, Train/loss_recog_step=2.030, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]Epoch 53:  16%|█▌        | 50/313 [01:15<06:39,  0.66it/s, v_num=0, Train/loss_all_step=0.00948, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00948, Train/loss_recog_step=2.030, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]Epoch 53:  16%|█▌        | 50/313 [01:15<06:39,  0.66it/s, v_num=0, Train/loss_all_step=0.023, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.023, Train/loss_recog_step=1.830, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]    Epoch 53:  32%|███▏      | 100/313 [02:22<05:03,  0.70it/s, v_num=0, Train/loss_all_step=0.023, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.023, Train/loss_recog_step=1.830, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]Epoch 53:  32%|███▏      | 100/313 [02:22<05:03,  0.70it/s, v_num=0, Train/loss_all_step=0.00986, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.00986, Train/loss_recog_step=1.720, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]Epoch 53:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.00986, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.00986, Train/loss_recog_step=1.720, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]Epoch 53:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=1.720, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]  Epoch 53:  64%|██████▍   | 200/313 [04:35<02:35,  0.73it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=1.720, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]Epoch 53:  64%|██████▍   | 200/313 [04:35<02:35,  0.73it/s, v_num=0, Train/loss_all_step=0.00799, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.00799, Train/loss_recog_step=1.780, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]Epoch 53:  80%|███████▉  | 250/313 [05:45<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.00799, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.00799, Train/loss_recog_step=1.780, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]Epoch 53:  80%|███████▉  | 250/313 [05:45<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.00439, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.00439, Train/loss_recog_step=1.600, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]Epoch 53:  96%|█████████▌| 300/313 [06:51<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.00439, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.00439, Train/loss_recog_step=1.600, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]Epoch 53:  96%|█████████▌| 300/313 [06:51<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=1.860, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]  Epoch 53: 100%|██████████| 313/313 [07:05<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=1.860, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]Epoch 53: 100%|██████████| 313/313 [07:05<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.00783, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=1.950, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.89it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.59it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.30it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.35it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205631, 0.205642, 0.213905, 0.206174
Valid average loss UNet                 (all)                : 0.831351

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.140612, 1.349148, 2.304535
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.227217, 0.998386, 1.159702
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.458832, 2.169170, 2.183895
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.224963, 1.493204, 2.123742
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.301305, 1.983431, 2.333064
Valid average loss all      (Triplet)                 : 0.299347

== Recognize ==
Valid average loss Recognize     : 1.601402
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.299347

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.649873971939087 sec. =
Valid knn accuracy drums     : 61.30434782608696%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.201009750366211 sec. =
Valid knn accuracy bass      : 18.951612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.142089605331421 sec. =
Valid knn accuracy piano     : 32.421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.763283014297485 sec. =
Valid knn accuracy guitar    : 43.526785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.725315570831299 sec. =
Valid knn accuracy residuals : 62.95454545454545%

Valid knn accuracy average   : 43.83183337962879%

                                                                      [AEpoch 53: 100%|██████████| 313/313 [08:24<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.00783, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=1.950, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.844, Train/loss_triplet_all_epoch=0.015, Train/loss_recog_epoch=1.760]Epoch 53: 100%|██████████| 313/313 [08:24<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.00783, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=1.950, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208633, 0.209898, 0.212206, 0.210959
Train average loss UNet                 (all)                : 0.841697

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007990, 1.270483, 3.086795
Train average loss bass     (Triplet, dist_p, dist_n) : 0.021052, 1.151124, 1.907110
Train average loss piano    (Triplet, dist_p, dist_n) : 0.015678, 1.441260, 2.434338
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.015485, 1.372523, 2.394589
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010553, 1.606607, 2.862988
Train average loss all      (Triplet)                 : 0.014268

== Recognize ==
Train average loss Recognize     : 1.778013
Train average accuracy drums     : 50.500000 %
Train average accuracy bass      : 49.919998 %
Train average accuracy piano     : 49.244999 %
Train average accuracy guitar    : 50.085003 %
Train average accuracy residuals : 49.810001 %

== Train average loss all : 0.014268

Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00783, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=1.950, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]          Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00783, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=1.950, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]Epoch 54:  16%|█▌        | 50/313 [01:15<06:38,  0.66it/s, v_num=0, Train/loss_all_step=0.00783, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=1.950, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]Epoch 54:  16%|█▌        | 50/313 [01:15<06:38,  0.66it/s, v_num=0, Train/loss_all_step=0.0295, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0295, Train/loss_recog_step=1.710, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]  Epoch 54:  32%|███▏      | 100/313 [02:21<05:02,  0.70it/s, v_num=0, Train/loss_all_step=0.0295, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0295, Train/loss_recog_step=1.710, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]Epoch 54:  32%|███▏      | 100/313 [02:21<05:02,  0.70it/s, v_num=0, Train/loss_all_step=0.0355, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.0355, Train/loss_recog_step=1.740, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]Epoch 54:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.0355, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.0355, Train/loss_recog_step=1.740, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]Epoch 54:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.0293, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.0293, Train/loss_recog_step=1.870, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]Epoch 54:  64%|██████▍   | 200/313 [04:37<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.0293, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.0293, Train/loss_recog_step=1.870, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]Epoch 54:  64%|██████▍   | 200/313 [04:37<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.879, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=1.690, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]Epoch 54:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.879, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=1.690, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]Epoch 54:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=1.800, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]Epoch 54:  96%|█████████▌| 300/313 [06:50<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=1.800, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]Epoch 54:  96%|█████████▌| 300/313 [06:50<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.0155, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0155, Train/loss_recog_step=1.900, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]Epoch 54: 100%|██████████| 313/313 [07:04<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0155, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0155, Train/loss_recog_step=1.900, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]Epoch 54: 100%|██████████| 313/313 [07:04<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.000893, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000893, Train/loss_recog_step=1.930, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.438, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.92it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.12it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.90it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.70it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.52it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205602, 0.205641, 0.214052, 0.193964
Valid average loss UNet                 (all)                : 0.819259

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.176062, 1.365245, 2.204828
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.266627, 1.075003, 1.224881
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.612236, 2.252883, 2.113417
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.194761, 1.430944, 2.190557
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.273188, 1.866674, 2.303467
Valid average loss all      (Triplet)                 : 0.365866

== Recognize ==
Valid average loss Recognize     : 1.878746
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.365866

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.620043754577637 sec. =
Valid knn accuracy drums     : 62.82608695652174%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.062232255935669 sec. =
Valid knn accuracy bass      : 14.919354838709678%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.226030588150024 sec. =
Valid knn accuracy piano     : 36.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.454585075378418 sec. =
Valid knn accuracy guitar    : 42.857142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.115975618362427 sec. =
Valid knn accuracy residuals : 55.22727272727273%

Valid knn accuracy average   : 42.392533975929396%

                                                                      [AEpoch 54: 100%|██████████| 313/313 [08:27<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000893, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000893, Train/loss_recog_step=1.930, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.780]Epoch 54: 100%|██████████| 313/313 [08:27<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000893, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000893, Train/loss_recog_step=1.930, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208517, 0.209772, 0.212103, 0.210415
Train average loss UNet                 (all)                : 0.840808

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007962, 1.272102, 3.045546
Train average loss bass     (Triplet, dist_p, dist_n) : 0.019724, 1.174278, 1.969965
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013964, 1.428269, 2.428244
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.015084, 1.369656, 2.411743
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008207, 1.586016, 2.866319
Train average loss all      (Triplet)                 : 0.013143

== Recognize ==
Train average loss Recognize     : 1.817050
Train average accuracy drums     : 49.965000 %
Train average accuracy bass      : 50.295002 %
Train average accuracy piano     : 49.649998 %
Train average accuracy guitar    : 49.919998 %
Train average accuracy residuals : 49.849998 %

== Train average loss all : 0.013143

Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000893, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000893, Train/loss_recog_step=1.930, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]          Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000893, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000893, Train/loss_recog_step=1.930, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]Epoch 55:  16%|█▌        | 50/313 [01:12<06:21,  0.69it/s, v_num=0, Train/loss_all_step=0.000893, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000893, Train/loss_recog_step=1.930, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]Epoch 55:  16%|█▌        | 50/313 [01:12<06:21,  0.69it/s, v_num=0, Train/loss_all_step=0.0361, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0361, Train/loss_recog_step=1.700, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]    Epoch 55:  32%|███▏      | 100/313 [02:19<04:56,  0.72it/s, v_num=0, Train/loss_all_step=0.0361, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0361, Train/loss_recog_step=1.700, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]Epoch 55:  32%|███▏      | 100/313 [02:19<04:56,  0.72it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.780, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]Epoch 55:  48%|████▊     | 150/313 [03:25<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.780, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]Epoch 55:  48%|████▊     | 150/313 [03:25<03:42,  0.73it/s, v_num=0, Train/loss_all_step=0.00226, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.00226, Train/loss_recog_step=1.880, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]Epoch 55:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.00226, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.00226, Train/loss_recog_step=1.880, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]Epoch 55:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.0034, Train/loss_recog_step=1.700, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]  Epoch 55:  80%|███████▉  | 250/313 [05:39<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.0034, Train/loss_recog_step=1.700, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]Epoch 55:  80%|███████▉  | 250/313 [05:39<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.00263, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00263, Train/loss_recog_step=1.930, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]Epoch 55:  96%|█████████▌| 300/313 [06:49<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.00263, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00263, Train/loss_recog_step=1.930, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]Epoch 55:  96%|█████████▌| 300/313 [06:49<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=1.850, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]  Epoch 55: 100%|██████████| 313/313 [07:04<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=1.850, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]Epoch 55: 100%|██████████| 313/313 [07:04<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.710, Valid/loss_all_step=0.502, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.502, Valid/loss_recog_step=2.180, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=1.880, Valid/knn_avr=0.424, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.64it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 10.86it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.25it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 12.28it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.19it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 11.11it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205495, 0.205622, 0.213828, 0.210608
Valid average loss UNet                 (all)                : 0.835554

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.185630, 1.336154, 2.223460
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.240027, 0.988608, 1.112949
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.482119, 2.175659, 2.125229
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.248938, 1.403107, 2.091989
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.219453, 1.768533, 2.534876
Valid average loss all      (Triplet)                 : 0.296199

== Recognize ==
Valid average loss Recognize     : 1.704283
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 44.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.296199

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.523158311843872 sec. =
Valid knn accuracy drums     : 63.04347826086957%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.685802221298218 sec. =
Valid knn accuracy bass      : 22.983870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.107037782669067 sec. =
Valid knn accuracy piano     : 29.1015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.916796922683716 sec. =
Valid knn accuracy guitar    : 42.857142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.037870168685913 sec. =
Valid knn accuracy residuals : 65.0%

Valid knn accuracy average   : 44.59721091715087%

                                                                      [AEpoch 55: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.710, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0131, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0131, Train/loss_recog_epoch=1.820]Epoch 55: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.710, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208699, 0.209956, 0.212259, 0.210578
Train average loss UNet                 (all)                : 0.841492

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006769, 1.299068, 3.157112
Train average loss bass     (Triplet, dist_p, dist_n) : 0.018658, 1.221046, 2.048942
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013684, 1.509995, 2.598058
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.013214, 1.425050, 2.520185
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007398, 1.677222, 3.011586
Train average loss all      (Triplet)                 : 0.012081

== Recognize ==
Train average loss Recognize     : 1.821768
Train average accuracy drums     : 50.070000 %
Train average accuracy bass      : 50.199997 %
Train average accuracy piano     : 49.555000 %
Train average accuracy guitar    : 49.895000 %
Train average accuracy residuals : 50.215000 %

== Train average loss all : 0.012081

Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.710, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]          Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.710, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]Epoch 56:  16%|█▌        | 50/313 [01:13<06:27,  0.68it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.710, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]Epoch 56:  16%|█▌        | 50/313 [01:13<06:27,  0.68it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=1.880, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]Epoch 56:  32%|███▏      | 100/313 [02:19<04:56,  0.72it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=1.880, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]Epoch 56:  32%|███▏      | 100/313 [02:19<04:56,  0.72it/s, v_num=0, Train/loss_all_step=0.00499, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00499, Train/loss_recog_step=1.880, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]Epoch 56:  48%|████▊     | 150/313 [03:26<03:44,  0.73it/s, v_num=0, Train/loss_all_step=0.00499, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00499, Train/loss_recog_step=1.880, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]Epoch 56:  48%|████▊     | 150/313 [03:26<03:44,  0.73it/s, v_num=0, Train/loss_all_step=0.0302, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.0302, Train/loss_recog_step=1.590, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]  Epoch 56:  64%|██████▍   | 200/313 [04:34<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.0302, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.0302, Train/loss_recog_step=1.590, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]Epoch 56:  64%|██████▍   | 200/313 [04:34<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.863, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=1.990, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]Epoch 56:  80%|███████▉  | 250/313 [05:40<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.863, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=1.990, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]Epoch 56:  80%|███████▉  | 250/313 [05:40<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.00891, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.00891, Train/loss_recog_step=1.870, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]Epoch 56:  96%|█████████▌| 300/313 [06:48<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.00891, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.00891, Train/loss_recog_step=1.870, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]Epoch 56:  96%|█████████▌| 300/313 [06:48<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0193, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=1.910, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]  Epoch 56: 100%|██████████| 313/313 [07:04<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0193, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=1.910, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]Epoch 56: 100%|██████████| 313/313 [07:04<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.950, Valid/loss_all_step=0.299, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.836, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.61it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.75it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.26it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.68it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.51it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.89it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.207054, 0.207068, 0.215830, 0.194273
Valid average loss UNet                 (all)                : 0.824225

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.212180, 1.375958, 2.181207
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.256958, 1.024077, 1.188949
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.474212, 2.095275, 2.125954
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.151157, 1.516153, 2.257769
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.284744, 1.771068, 2.055799
Valid average loss all      (Triplet)                 : 0.322771

== Recognize ==
Valid average loss Recognize     : 1.871036
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.322771

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.930076837539673 sec. =
Valid knn accuracy drums     : 65.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.837202310562134 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.547549962997437 sec. =
Valid knn accuracy piano     : 35.9375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.86711597442627 sec. =
Valid knn accuracy guitar    : 43.526785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.025424718856812 sec. =
Valid knn accuracy residuals : 60.45454545454545%

Valid knn accuracy average   : 44.73376623376623%

                                                                      [AEpoch 56: 100%|██████████| 313/313 [08:22<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.950, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.820]Epoch 56: 100%|██████████| 313/313 [08:22<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.950, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208430, 0.209689, 0.212019, 0.210835
Train average loss UNet                 (all)                : 0.840972

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007824, 1.306640, 3.135147
Train average loss bass     (Triplet, dist_p, dist_n) : 0.016675, 1.199618, 2.054009
Train average loss piano    (Triplet, dist_p, dist_n) : 0.015887, 1.488575, 2.528896
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011776, 1.405257, 2.486513
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010694, 1.645424, 2.948858
Train average loss all      (Triplet)                 : 0.012481

== Recognize ==
Train average loss Recognize     : 1.850501
Train average accuracy drums     : 49.720001 %
Train average accuracy bass      : 49.970001 %
Train average accuracy piano     : 49.715000 %
Train average accuracy guitar    : 49.480000 %
Train average accuracy residuals : 50.215000 %

== Train average loss all : 0.012481

Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.950, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]          Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.950, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]Epoch 57:  16%|█▌        | 50/313 [01:12<06:19,  0.69it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.950, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]Epoch 57:  16%|█▌        | 50/313 [01:12<06:19,  0.69it/s, v_num=0, Train/loss_all_step=0.00438, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=1.950, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]Epoch 57:  32%|███▏      | 100/313 [02:19<04:57,  0.72it/s, v_num=0, Train/loss_all_step=0.00438, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=1.950, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]Epoch 57:  32%|███▏      | 100/313 [02:19<04:57,  0.72it/s, v_num=0, Train/loss_all_step=0.00883, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.00883, Train/loss_recog_step=1.970, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]Epoch 57:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.00883, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.00883, Train/loss_recog_step=1.970, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]Epoch 57:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=1.690, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]  Epoch 57:  64%|██████▍   | 200/313 [04:34<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=1.690, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]Epoch 57:  64%|██████▍   | 200/313 [04:34<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.871, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=1.750, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]Epoch 57:  80%|███████▉  | 250/313 [05:40<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.871, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=1.750, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]Epoch 57:  80%|███████▉  | 250/313 [05:40<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.0209, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0209, Train/loss_recog_step=1.720, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]Epoch 57:  96%|█████████▌| 300/313 [06:48<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0209, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0209, Train/loss_recog_step=1.720, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]Epoch 57:  96%|█████████▌| 300/313 [06:48<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=1.810, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]Epoch 57: 100%|██████████| 313/313 [07:02<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=1.810, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]Epoch 57: 100%|██████████| 313/313 [07:02<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.630, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.990, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.447, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.79it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  7.05it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.13it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.60it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.11it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.66it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206580, 0.206542, 0.215292, 0.200540
Valid average loss UNet                 (all)                : 0.828955

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.254447, 1.311365, 2.245370
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.216506, 0.972933, 1.157441
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.407165, 2.128546, 2.299017
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.199587, 1.489383, 2.050744
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.326345, 1.846039, 2.121534
Valid average loss all      (Triplet)                 : 0.316461

== Recognize ==
Valid average loss Recognize     : 1.818946
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 44.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.316461

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.20326280593872 sec. =
Valid knn accuracy drums     : 69.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.925514221191406 sec. =
Valid knn accuracy bass      : 18.951612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.085555791854858 sec. =
Valid knn accuracy piano     : 39.2578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.872599601745605 sec. =
Valid knn accuracy guitar    : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.026825428009033 sec. =
Valid knn accuracy residuals : 62.272727272727266%

Valid knn accuracy average   : 45.50947401345148%

                                                                      [AEpoch 57: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.630, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0125, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=1.850]Epoch 57: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.630, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208637, 0.209889, 0.212205, 0.211194
Train average loss UNet                 (all)                : 0.841925

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003887, 1.298573, 3.170740
Train average loss bass     (Triplet, dist_p, dist_n) : 0.017467, 1.195342, 2.045846
Train average loss piano    (Triplet, dist_p, dist_n) : 0.014433, 1.470701, 2.537958
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012424, 1.416462, 2.536409
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009911, 1.643098, 2.941855
Train average loss all      (Triplet)                 : 0.011750

== Recognize ==
Train average loss Recognize     : 1.857202
Train average accuracy drums     : 49.814999 %
Train average accuracy bass      : 49.595001 %
Train average accuracy piano     : 49.520000 %
Train average accuracy guitar    : 49.904999 %
Train average accuracy residuals : 49.829998 %

== Train average loss all : 0.011750

Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.630, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]          Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.630, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]Epoch 58:  16%|█▌        | 50/313 [01:15<06:37,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.630, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]Epoch 58:  16%|█▌        | 50/313 [01:15<06:37,  0.66it/s, v_num=0, Train/loss_all_step=0.0169, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=1.980, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]Epoch 58:  32%|███▏      | 100/313 [02:22<05:02,  0.70it/s, v_num=0, Train/loss_all_step=0.0169, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=1.980, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]Epoch 58:  32%|███▏      | 100/313 [02:22<05:02,  0.70it/s, v_num=0, Train/loss_all_step=0.00794, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00794, Train/loss_recog_step=1.720, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]Epoch 58:  48%|████▊     | 150/313 [03:30<03:48,  0.71it/s, v_num=0, Train/loss_all_step=0.00794, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00794, Train/loss_recog_step=1.720, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]Epoch 58:  48%|████▊     | 150/313 [03:30<03:48,  0.71it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.0034, Train/loss_recog_step=1.730, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]  Epoch 58:  64%|██████▍   | 200/313 [04:38<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.0034, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.0034, Train/loss_recog_step=1.730, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]Epoch 58:  64%|██████▍   | 200/313 [04:38<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.878, Train/loss_triplet_all_step=0.00677, Train/loss_recog_step=1.810, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]Epoch 58:  80%|███████▉  | 250/313 [05:47<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.878, Train/loss_triplet_all_step=0.00677, Train/loss_recog_step=1.810, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]Epoch 58:  80%|███████▉  | 250/313 [05:48<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=1.880, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]  Epoch 58:  96%|█████████▌| 300/313 [06:55<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=1.880, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]Epoch 58:  96%|█████████▌| 300/313 [06:55<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=1.760, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]Epoch 58: 100%|██████████| 313/313 [07:09<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=1.760, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]Epoch 58: 100%|██████████| 313/313 [07:09<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.940, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.451, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.455, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.91it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 12.80it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.12it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.58it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.60it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 11.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206514, 0.206562, 0.214985, 0.196863
Valid average loss UNet                 (all)                : 0.824923

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.155605, 1.493375, 2.547357
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.203205, 1.065911, 1.275158
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.587516, 2.459978, 2.409809
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.219859, 1.624404, 2.302997
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.319216, 1.974742, 2.338979
Valid average loss all      (Triplet)                 : 0.356728

== Recognize ==
Valid average loss Recognize     : 2.019929
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 54.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 42.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.356728

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.620904207229614 sec. =
Valid knn accuracy drums     : 65.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.045993328094482 sec. =
Valid knn accuracy bass      : 19.556451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.008426904678345 sec. =
Valid knn accuracy piano     : 40.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.982134103775024 sec. =
Valid knn accuracy guitar    : 41.07142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.899902105331421 sec. =
Valid knn accuracy residuals : 59.31818181818181%

Valid knn accuracy average   : 45.157690661372285%

                                                                      [AEpoch 58: 100%|██████████| 313/313 [08:26<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.940, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0117, Train/loss_recog_epoch=1.860]Epoch 58: 100%|██████████| 313/313 [08:26<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.940, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208614, 0.209883, 0.212213, 0.210964
Train average loss UNet                 (all)                : 0.841673

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005340, 1.369035, 3.329879
Train average loss bass     (Triplet, dist_p, dist_n) : 0.016090, 1.234754, 2.121337
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012923, 1.534273, 2.626744
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012950, 1.432065, 2.554639
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008680, 1.668744, 2.985284
Train average loss all      (Triplet)                 : 0.011354

== Recognize ==
Train average loss Recognize     : 1.835243
Train average accuracy drums     : 50.255001 %
Train average accuracy bass      : 49.955002 %
Train average accuracy piano     : 49.770000 %
Train average accuracy guitar    : 50.220001 %
Train average accuracy residuals : 49.595001 %

== Train average loss all : 0.011354

Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.940, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]          Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.940, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]Epoch 59:  16%|█▌        | 50/313 [01:15<06:37,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.940, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]Epoch 59:  16%|█▌        | 50/313 [01:15<06:37,  0.66it/s, v_num=0, Train/loss_all_step=0.0306, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0306, Train/loss_recog_step=1.830, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]Epoch 59:  32%|███▏      | 100/313 [02:21<05:00,  0.71it/s, v_num=0, Train/loss_all_step=0.0306, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0306, Train/loss_recog_step=1.830, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]Epoch 59:  32%|███▏      | 100/313 [02:21<05:00,  0.71it/s, v_num=0, Train/loss_all_step=0.0186, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=1.940, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]Epoch 59:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.0186, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=1.940, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]Epoch 59:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.00172, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=1.750, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]Epoch 59:  64%|██████▍   | 200/313 [04:35<02:35,  0.73it/s, v_num=0, Train/loss_all_step=0.00172, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=1.750, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]Epoch 59:  64%|██████▍   | 200/313 [04:35<02:35,  0.73it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=1.880, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]  Epoch 59:  80%|███████▉  | 250/313 [05:41<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=1.880, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]Epoch 59:  80%|███████▉  | 250/313 [05:41<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=1.810, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]Epoch 59:  96%|█████████▌| 300/313 [06:44<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=1.810, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]Epoch 59:  96%|█████████▌| 300/313 [06:44<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=1.840, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]Epoch 59: 100%|██████████| 313/313 [06:59<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=1.840, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]Epoch 59: 100%|██████████| 313/313 [06:59<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.00854, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00854, Train/loss_recog_step=1.980, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.508, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.357, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.357, Valid/loss_recog_epoch=2.020, Valid/knn_avr=0.452, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.65it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 10.84it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.27it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00,  9.51it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.57it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.98it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.207180, 0.207122, 0.215976, 0.189848
Valid average loss UNet                 (all)                : 0.820126

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.105172, 1.431800, 2.728088
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.260416, 1.113699, 1.224759
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.436351, 2.498325, 2.553992
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.247836, 1.680044, 2.367307
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.267349, 1.989813, 2.614669
Valid average loss all      (Triplet)                 : 0.307790

== Recognize ==
Valid average loss Recognize     : 1.982188
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.307790

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.345285415649414 sec. =
Valid knn accuracy drums     : 65.65217391304347%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.338367223739624 sec. =
Valid knn accuracy bass      : 20.161290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.362592935562134 sec. =
Valid knn accuracy piano     : 36.328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.042158842086792 sec. =
Valid knn accuracy guitar    : 42.63392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.99802541732788 sec. =
Valid knn accuracy residuals : 62.272727272727266%

Valid knn accuracy average   : 45.40964901595599%

                                                                      [AEpoch 59: 100%|██████████| 313/313 [08:18<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.00854, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00854, Train/loss_recog_step=1.980, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=1.840]Epoch 59: 100%|██████████| 313/313 [08:18<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.00854, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00854, Train/loss_recog_step=1.980, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208394, 0.209652, 0.211957, 0.210696
Train average loss UNet                 (all)                : 0.840698

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005333, 1.422057, 3.473531
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014991, 1.225775, 2.111120
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013457, 1.550330, 2.676178
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009736, 1.450588, 2.579150
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008411, 1.691739, 3.028719
Train average loss all      (Triplet)                 : 0.010669

== Recognize ==
Train average loss Recognize     : 1.845763
Train average accuracy drums     : 50.255001 %
Train average accuracy bass      : 49.639999 %
Train average accuracy piano     : 50.510002 %
Train average accuracy guitar    : 49.619999 %
Train average accuracy residuals : 49.709999 %

== Train average loss all : 0.010669

Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00854, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00854, Train/loss_recog_step=1.980, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]          Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00854, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00854, Train/loss_recog_step=1.980, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]Epoch 60:  16%|█▌        | 50/313 [01:15<06:36,  0.66it/s, v_num=0, Train/loss_all_step=0.00854, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00854, Train/loss_recog_step=1.980, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]Epoch 60:  16%|█▌        | 50/313 [01:15<06:36,  0.66it/s, v_num=0, Train/loss_all_step=0.00228, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=1.710, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]Epoch 60:  32%|███▏      | 100/313 [02:22<05:02,  0.70it/s, v_num=0, Train/loss_all_step=0.00228, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=1.710, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]Epoch 60:  32%|███▏      | 100/313 [02:22<05:02,  0.70it/s, v_num=0, Train/loss_all_step=0.0203, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=1.910, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]  Epoch 60:  48%|████▊     | 150/313 [03:31<03:49,  0.71it/s, v_num=0, Train/loss_all_step=0.0203, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=1.910, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]Epoch 60:  48%|████▊     | 150/313 [03:31<03:49,  0.71it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.00459, Train/loss_recog_step=1.720, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]Epoch 60:  64%|██████▍   | 200/313 [04:38<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.00459, Train/loss_recog_step=1.720, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]Epoch 60:  64%|██████▍   | 200/313 [04:38<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.000782, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.000782, Train/loss_recog_step=1.900, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]Epoch 60:  80%|███████▉  | 250/313 [05:45<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.000782, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.000782, Train/loss_recog_step=1.900, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]Epoch 60:  80%|███████▉  | 250/313 [05:45<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=1.690, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]  Epoch 60:  96%|█████████▌| 300/313 [06:52<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=1.690, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]Epoch 60:  96%|█████████▌| 300/313 [06:52<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.00832, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00832, Train/loss_recog_step=1.660, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]Epoch 60: 100%|██████████| 313/313 [07:06<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00832, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00832, Train/loss_recog_step=1.660, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]Epoch 60: 100%|██████████| 313/313 [07:06<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00581, Train/loss_recog_step=2.050, Valid/loss_all_step=0.358, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.358, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.454, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.75it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.30it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.68it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 11.20it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  9.05it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.61it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.207477, 0.207480, 0.216251, 0.206139
Valid average loss UNet                 (all)                : 0.837346

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.251506, 1.577460, 2.558606
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.198000, 1.041132, 1.257883
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.569554, 2.556954, 2.501723
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.275466, 1.638388, 2.428833
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.391478, 2.271174, 2.548889
Valid average loss all      (Triplet)                 : 0.391143

== Recognize ==
Valid average loss Recognize     : 1.981882
Valid average accuracy drums     : 44.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 44.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.391143

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.351175546646118 sec. =
Valid knn accuracy drums     : 66.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.820060968399048 sec. =
Valid knn accuracy bass      : 19.758064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.142403602600098 sec. =
Valid knn accuracy piano     : 37.890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.120262384414673 sec. =
Valid knn accuracy guitar    : 37.05357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.014973878860474 sec. =
Valid knn accuracy residuals : 60.909090909090914%

Valid knn accuracy average   : 44.513574718584366%

                                                                      [AEpoch 60: 100%|██████████| 313/313 [08:23<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00581, Train/loss_recog_step=2.050, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.850]Epoch 60: 100%|██████████| 313/313 [08:23<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00581, Train/loss_recog_step=2.050, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208705, 0.209998, 0.212283, 0.211978
Train average loss UNet                 (all)                : 0.842965

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006026, 1.439849, 3.564743
Train average loss bass     (Triplet, dist_p, dist_n) : 0.015666, 1.289176, 2.199894
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009496, 1.550556, 2.714966
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011283, 1.483955, 2.662559
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010041, 1.738097, 3.113647
Train average loss all      (Triplet)                 : 0.010727

== Recognize ==
Train average loss Recognize     : 1.843054
Train average accuracy drums     : 49.825001 %
Train average accuracy bass      : 50.105000 %
Train average accuracy piano     : 50.449997 %
Train average accuracy guitar    : 49.930000 %
Train average accuracy residuals : 50.244999 %

== Train average loss all : 0.010727

Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00581, Train/loss_recog_step=2.050, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]          Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00581, Train/loss_recog_step=2.050, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]Epoch 61:  16%|█▌        | 50/313 [01:14<06:33,  0.67it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00581, Train/loss_recog_step=2.050, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]Epoch 61:  16%|█▌        | 50/313 [01:14<06:33,  0.67it/s, v_num=0, Train/loss_all_step=0.0405, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0405, Train/loss_recog_step=1.840, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]  Epoch 61:  32%|███▏      | 100/313 [02:20<05:00,  0.71it/s, v_num=0, Train/loss_all_step=0.0405, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0405, Train/loss_recog_step=1.840, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]Epoch 61:  32%|███▏      | 100/313 [02:20<05:00,  0.71it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.00581, Train/loss_recog_step=2.020, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]Epoch 61:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.00581, Train/loss_recog_step=2.020, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]Epoch 61:  48%|████▊     | 150/313 [03:27<03:45,  0.72it/s, v_num=0, Train/loss_all_step=0.00839, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00839, Train/loss_recog_step=1.880, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]Epoch 61:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.00839, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00839, Train/loss_recog_step=1.880, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]Epoch 61:  64%|██████▍   | 200/313 [04:31<02:33,  0.74it/s, v_num=0, Train/loss_all_step=0.045, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.045, Train/loss_recog_step=2.000, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]    Epoch 61:  80%|███████▉  | 250/313 [05:40<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.045, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.045, Train/loss_recog_step=2.000, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]Epoch 61:  80%|███████▉  | 250/313 [05:40<01:25,  0.73it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=1.690, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]Epoch 61:  96%|█████████▌| 300/313 [06:47<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=1.690, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]Epoch 61:  96%|█████████▌| 300/313 [06:47<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0194, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=1.980, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]Epoch 61: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0194, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=1.980, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]Epoch 61: 100%|██████████| 313/313 [07:01<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=1.940, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.839, Valid/loss_triplet_all_step=0.625, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.837, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.445, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.94it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.21it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 12.43it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 11.45it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  8.96it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 11.63it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206310, 0.206196, 0.215030, 0.217294
Valid average loss UNet                 (all)                : 0.844830

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.114839, 1.313460, 2.315510
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.211272, 1.027176, 1.212700
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.559164, 2.177958, 2.039469
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.231185, 1.481291, 2.196501
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.242560, 1.776349, 2.290337
Valid average loss all      (Triplet)                 : 0.338864

== Recognize ==
Valid average loss Recognize     : 1.664891
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 57.500000 %
Valid average accuracy residuals : 56.500000 %

== Valid average loss all : 0.338864

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.36706829071045 sec. =
Valid knn accuracy drums     : 68.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.705624341964722 sec. =
Valid knn accuracy bass      : 24.798387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.483814716339111 sec. =
Valid knn accuracy piano     : 32.6171875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.97514033317566 sec. =
Valid knn accuracy guitar    : 38.839285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.739660501480103 sec. =
Valid knn accuracy residuals : 57.72727272727273%

Valid knn accuracy average   : 44.5790353033187%

                                                                      [AEpoch 61: 100%|██████████| 313/313 [08:16<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=1.940, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0107, Train/loss_unet_all_epoch=0.843, Train/loss_triplet_all_epoch=0.0107, Train/loss_recog_epoch=1.840]Epoch 61: 100%|██████████| 313/313 [08:16<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=1.940, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208606, 0.209897, 0.212201, 0.210770
Train average loss UNet                 (all)                : 0.841475

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007617, 1.392152, 3.345140
Train average loss bass     (Triplet, dist_p, dist_n) : 0.015849, 1.223760, 2.102898
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012290, 1.477889, 2.548524
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012447, 1.441839, 2.581735
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007695, 1.679654, 3.033196
Train average loss all      (Triplet)                 : 0.011277

== Recognize ==
Train average loss Recognize     : 1.842042
Train average accuracy drums     : 50.070000 %
Train average accuracy bass      : 49.625000 %
Train average accuracy piano     : 49.180000 %
Train average accuracy guitar    : 49.549999 %
Train average accuracy residuals : 50.190002 %

== Train average loss all : 0.011277

Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=1.940, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]          Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=1.940, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]Epoch 62:  16%|█▌        | 50/313 [01:15<06:35,  0.66it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=1.940, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]Epoch 62:  16%|█▌        | 50/313 [01:15<06:35,  0.66it/s, v_num=0, Train/loss_all_step=0.0314, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0314, Train/loss_recog_step=1.810, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]Epoch 62:  32%|███▏      | 100/313 [02:21<05:01,  0.71it/s, v_num=0, Train/loss_all_step=0.0314, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0314, Train/loss_recog_step=1.810, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]Epoch 62:  32%|███▏      | 100/313 [02:21<05:01,  0.71it/s, v_num=0, Train/loss_all_step=0.00189, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.00189, Train/loss_recog_step=1.730, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]Epoch 62:  48%|████▊     | 150/313 [03:31<03:49,  0.71it/s, v_num=0, Train/loss_all_step=0.00189, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.00189, Train/loss_recog_step=1.730, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]Epoch 62:  48%|████▊     | 150/313 [03:31<03:49,  0.71it/s, v_num=0, Train/loss_all_step=0.00146, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=1.900, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]Epoch 62:  64%|██████▍   | 200/313 [04:38<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.00146, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=1.900, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]Epoch 62:  64%|██████▍   | 200/313 [04:38<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.0261, Train/loss_unet_all_step=0.867, Train/loss_triplet_all_step=0.0261, Train/loss_recog_step=1.840, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]  Epoch 62:  80%|███████▉  | 250/313 [05:45<01:26,  0.72it/s, v_num=0, Train/loss_all_step=0.0261, Train/loss_unet_all_step=0.867, Train/loss_triplet_all_step=0.0261, Train/loss_recog_step=1.840, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]Epoch 62:  80%|███████▉  | 250/313 [05:45<01:26,  0.72it/s, v_num=0, Train/loss_all_step=0.00563, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.00563, Train/loss_recog_step=2.040, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]Epoch 62:  96%|█████████▌| 300/313 [06:52<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.00563, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.00563, Train/loss_recog_step=2.040, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]Epoch 62:  96%|█████████▌| 300/313 [06:52<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.0031, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0031, Train/loss_recog_step=1.690, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]  Epoch 62: 100%|██████████| 313/313 [07:06<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.0031, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0031, Train/loss_recog_step=1.690, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]Epoch 62: 100%|██████████| 313/313 [07:06<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.660, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.832, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.845, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=1.660, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.93it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.78it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.33it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 11.42it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.32it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00,  9.02it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.206277, 0.206351, 0.215352, 0.203161
Valid average loss UNet                 (all)                : 0.831141

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.274624, 1.513799, 2.208527
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.223378, 1.141022, 1.310881
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.433996, 2.615583, 2.735316
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.178659, 1.796700, 2.685949
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.266731, 1.976587, 2.844517
Valid average loss all      (Triplet)                 : 0.318288

== Recognize ==
Valid average loss Recognize     : 1.942034
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.318288

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.527303218841553 sec. =
Valid knn accuracy drums     : 60.652173913043484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.760898113250732 sec. =
Valid knn accuracy bass      : 20.161290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.452848434448242 sec. =
Valid knn accuracy piano     : 35.15625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.939897775650024 sec. =
Valid knn accuracy guitar    : 41.74107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.77086591720581 sec. =
Valid knn accuracy residuals : 59.54545454545455%

Valid knn accuracy average   : 43.45124804193002%

                                                                      [AEpoch 62: 100%|██████████| 313/313 [08:21<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.660, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.0113, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.0113, Train/loss_recog_epoch=1.840]Epoch 62: 100%|██████████| 313/313 [08:21<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.660, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208201, 0.209468, 0.211807, 0.210281
Train average loss UNet                 (all)                : 0.839758

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005163, 1.371909, 3.291048
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011657, 1.278637, 2.201112
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011776, 1.561014, 2.723897
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009612, 1.486820, 2.677911
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007591, 1.743058, 3.152385
Train average loss all      (Triplet)                 : 0.009244

== Recognize ==
Train average loss Recognize     : 1.838045
Train average accuracy drums     : 49.514999 %
Train average accuracy bass      : 50.325001 %
Train average accuracy piano     : 49.814999 %
Train average accuracy guitar    : 50.500000 %
Train average accuracy residuals : 49.105000 %

== Train average loss all : 0.009244

Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.660, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]          Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.660, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]Epoch 63:  16%|█▌        | 50/313 [01:17<06:48,  0.64it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.660, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]Epoch 63:  16%|█▌        | 50/313 [01:17<06:48,  0.64it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=2.060, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]Epoch 63:  32%|███▏      | 100/313 [02:22<05:03,  0.70it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=2.060, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]Epoch 63:  32%|███▏      | 100/313 [02:22<05:03,  0.70it/s, v_num=0, Train/loss_all_step=8.47e-5, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=8.47e-5, Train/loss_recog_step=1.850, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]Epoch 63:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=8.47e-5, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=8.47e-5, Train/loss_recog_step=1.850, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]Epoch 63:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00634, Train/loss_recog_step=1.910, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]Epoch 63:  64%|██████▍   | 200/313 [04:36<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00634, Train/loss_recog_step=1.910, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]Epoch 63:  64%|██████▍   | 200/313 [04:36<02:36,  0.72it/s, v_num=0, Train/loss_all_step=0.00226, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.00226, Train/loss_recog_step=1.860, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]Epoch 63:  80%|███████▉  | 250/313 [05:44<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.00226, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.00226, Train/loss_recog_step=1.860, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]Epoch 63:  80%|███████▉  | 250/313 [05:44<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.00572, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=1.900, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]Epoch 63:  96%|█████████▌| 300/313 [06:51<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.00572, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=1.900, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]Epoch 63:  96%|█████████▌| 300/313 [06:51<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.810, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]    Epoch 63: 100%|██████████| 313/313 [07:06<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.810, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]Epoch 63: 100%|██████████| 313/313 [07:06<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.880, Valid/loss_all_step=0.427, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.435, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.91it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  8.59it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.93it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 11.44it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.60it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205841, 0.206063, 0.214778, 0.195718
Valid average loss UNet                 (all)                : 0.822401

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.159710, 1.365594, 2.452383
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.291163, 1.194686, 1.360781
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.439857, 2.420284, 2.504845
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.242221, 1.741982, 2.448103
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.268435, 2.159963, 2.753190
Valid average loss all      (Triplet)                 : 0.330673

== Recognize ==
Valid average loss Recognize     : 1.840056
Valid average accuracy drums     : 60.000004 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 44.000000 %

== Valid average loss all : 0.330673

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.92850136756897 sec. =
Valid knn accuracy drums     : 64.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.729321479797363 sec. =
Valid knn accuracy bass      : 20.766129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.786411762237549 sec. =
Valid knn accuracy piano     : 33.0078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.11571216583252 sec. =
Valid knn accuracy guitar    : 45.982142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.991576194763184 sec. =
Valid knn accuracy residuals : 61.81818181818181%

Valid knn accuracy average   : 45.27137498064698%

                                                                      [AEpoch 63: 100%|██████████| 313/313 [08:23<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.880, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00924, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00924, Train/loss_recog_epoch=1.840]Epoch 63: 100%|██████████| 313/313 [08:23<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.880, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208608, 0.209893, 0.212190, 0.211041
Train average loss UNet                 (all)                : 0.841732

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005637, 1.378728, 3.390529
Train average loss bass     (Triplet, dist_p, dist_n) : 0.013091, 1.267318, 2.204378
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011456, 1.556319, 2.730973
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009407, 1.481428, 2.655815
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007741, 1.703575, 3.082485
Train average loss all      (Triplet)                 : 0.009485

== Recognize ==
Train average loss Recognize     : 1.839623
Train average accuracy drums     : 50.594997 %
Train average accuracy bass      : 50.274998 %
Train average accuracy piano     : 49.880001 %
Train average accuracy guitar    : 49.865002 %
Train average accuracy residuals : 49.994999 %

== Train average loss all : 0.009485

Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.880, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]          Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.880, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]Epoch 64:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.880, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]Epoch 64:  16%|█▌        | 50/313 [01:12<06:23,  0.69it/s, v_num=0, Train/loss_all_step=0.00102, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00102, Train/loss_recog_step=1.730, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]Epoch 64:  32%|███▏      | 100/313 [02:19<04:57,  0.72it/s, v_num=0, Train/loss_all_step=0.00102, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00102, Train/loss_recog_step=1.730, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]Epoch 64:  32%|███▏      | 100/313 [02:19<04:57,  0.72it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.862, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=1.810, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]  Epoch 64:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.862, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=1.810, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]Epoch 64:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.00388, Train/loss_recog_step=1.880, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]Epoch 64:  64%|██████▍   | 200/313 [04:39<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.00388, Train/loss_recog_step=1.880, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]Epoch 64:  64%|██████▍   | 200/313 [04:39<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.0177, Train/loss_unet_all_step=0.871, Train/loss_triplet_all_step=0.0177, Train/loss_recog_step=1.810, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]  Epoch 64:  80%|███████▉  | 250/313 [05:48<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.0177, Train/loss_unet_all_step=0.871, Train/loss_triplet_all_step=0.0177, Train/loss_recog_step=1.810, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]Epoch 64:  80%|███████▉  | 250/313 [05:48<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.970, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]Epoch 64:  96%|█████████▌| 300/313 [06:56<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.970, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]Epoch 64:  96%|█████████▌| 300/313 [06:56<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.00898, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00898, Train/loss_recog_step=1.980, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]Epoch 64: 100%|██████████| 313/313 [07:10<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.00898, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00898, Train/loss_recog_step=1.980, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]Epoch 64: 100%|██████████| 313/313 [07:10<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.680, Valid/loss_all_step=0.371, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.371, Valid/loss_recog_step=1.770, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.453, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.67it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.97it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.41it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 10.97it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.58it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.73it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204891, 0.205047, 0.213706, 0.201669
Valid average loss UNet                 (all)                : 0.825313

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.375993, 1.599140, 2.409698
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.236642, 1.148612, 1.363225
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.510280, 2.371603, 2.453116
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.240861, 1.758356, 2.562008
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.256544, 2.102971, 2.509166
Valid average loss all      (Triplet)                 : 0.364989

== Recognize ==
Valid average loss Recognize     : 1.820914
Valid average accuracy drums     : 58.999996 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.364989

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.554722547531128 sec. =
Valid knn accuracy drums     : 67.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.181164503097534 sec. =
Valid knn accuracy bass      : 23.588709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.202317237854004 sec. =
Valid knn accuracy piano     : 34.765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.09757399559021 sec. =
Valid knn accuracy guitar    : 45.535714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.372379779815674 sec. =
Valid knn accuracy residuals : 55.68181818181818%

Valid knn accuracy average   : 45.43611255942515%

                                                                      [AEpoch 64: 100%|██████████| 313/313 [08:27<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.680, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00949, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00949, Train/loss_recog_epoch=1.840]Epoch 64: 100%|██████████| 313/313 [08:27<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.680, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208109, 0.209374, 0.211721, 0.210459
Train average loss UNet                 (all)                : 0.839662

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004778, 1.392839, 3.352687
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014685, 1.315691, 2.251754
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009794, 1.570664, 2.755637
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010910, 1.533423, 2.744493
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007152, 1.759921, 3.207137
Train average loss all      (Triplet)                 : 0.009570

== Recognize ==
Train average loss Recognize     : 1.859842
Train average accuracy drums     : 49.970001 %
Train average accuracy bass      : 49.494999 %
Train average accuracy piano     : 49.720001 %
Train average accuracy guitar    : 50.080002 %
Train average accuracy residuals : 50.325001 %

== Train average loss all : 0.009570

Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.680, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]          Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.680, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]Epoch 65:  16%|█▌        | 50/313 [01:12<06:22,  0.69it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.680, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]Epoch 65:  16%|█▌        | 50/313 [01:12<06:22,  0.69it/s, v_num=0, Train/loss_all_step=0.0236, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0236, Train/loss_recog_step=1.880, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]Epoch 65:  32%|███▏      | 100/313 [02:16<04:51,  0.73it/s, v_num=0, Train/loss_all_step=0.0236, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0236, Train/loss_recog_step=1.880, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]Epoch 65:  32%|███▏      | 100/313 [02:16<04:51,  0.73it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=1.760, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]Epoch 65:  48%|████▊     | 150/313 [03:25<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=1.760, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]Epoch 65:  48%|████▊     | 150/313 [03:25<03:43,  0.73it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=1.810, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]Epoch 65:  64%|██████▍   | 200/313 [04:32<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=1.810, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]Epoch 65:  64%|██████▍   | 200/313 [04:32<02:34,  0.73it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.871, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=1.830, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]Epoch 65:  80%|███████▉  | 250/313 [05:39<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.871, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=1.830, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]Epoch 65:  80%|███████▉  | 250/313 [05:39<01:25,  0.74it/s, v_num=0, Train/loss_all_step=0.00123, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=1.640, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]Epoch 65:  96%|█████████▌| 300/313 [06:45<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.00123, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=1.640, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]Epoch 65:  96%|█████████▌| 300/313 [06:45<00:17,  0.74it/s, v_num=0, Train/loss_all_step=0.0028, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0028, Train/loss_recog_step=1.720, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]  Epoch 65: 100%|██████████| 313/313 [06:59<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.0028, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0028, Train/loss_recog_step=1.720, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]Epoch 65: 100%|██████████| 313/313 [06:59<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.00256, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00256, Train/loss_recog_step=2.000, Valid/loss_all_step=0.657, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.657, Valid/loss_recog_step=1.750, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.454, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.21it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.06it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  7.49it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 10.61it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.63it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205180, 0.205065, 0.213840, 0.204307
Valid average loss UNet                 (all)                : 0.828392

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.236240, 1.593326, 2.630193
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.267223, 1.259166, 1.363367
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.379360, 2.260012, 2.449172
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.216021, 1.756213, 2.561615
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.345584, 2.013141, 2.307124
Valid average loss all      (Triplet)                 : 0.322549

== Recognize ==
Valid average loss Recognize     : 1.801940
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 43.500000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.322549

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.274898290634155 sec. =
Valid knn accuracy drums     : 66.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.012804985046387 sec. =
Valid knn accuracy bass      : 22.177419354838708%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.955891609191895 sec. =
Valid knn accuracy piano     : 37.6953125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.10599160194397 sec. =
Valid knn accuracy guitar    : 37.05357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.012381792068481 sec. =
Valid knn accuracy residuals : 65.45454545454545%

Valid knn accuracy average   : 45.86747409541721%

                                                                      [AEpoch 65: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.00256, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00256, Train/loss_recog_step=2.000, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.00957, Train/loss_unet_all_epoch=0.840, Train/loss_triplet_all_epoch=0.00957, Train/loss_recog_epoch=1.860]Epoch 65: 100%|██████████| 313/313 [08:19<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.00256, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00256, Train/loss_recog_step=2.000, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]    

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208475, 0.209746, 0.212068, 0.211002
Train average loss UNet                 (all)                : 0.841291

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003968, 1.392509, 3.427763
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012344, 1.301687, 2.255046
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010452, 1.608037, 2.821333
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011419, 1.532554, 2.740747
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006727, 1.766506, 3.235347
Train average loss all      (Triplet)                 : 0.008998

== Recognize ==
Train average loss Recognize     : 1.829389
Train average accuracy drums     : 49.614998 %
Train average accuracy bass      : 49.924999 %
Train average accuracy piano     : 49.755001 %
Train average accuracy guitar    : 49.480000 %
Train average accuracy residuals : 49.939999 %

== Train average loss all : 0.008998

Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00256, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00256, Train/loss_recog_step=2.000, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]          Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00256, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00256, Train/loss_recog_step=2.000, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]Epoch 66:  16%|█▌        | 50/313 [01:13<06:29,  0.68it/s, v_num=0, Train/loss_all_step=0.00256, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00256, Train/loss_recog_step=2.000, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]Epoch 66:  16%|█▌        | 50/313 [01:13<06:29,  0.68it/s, v_num=0, Train/loss_all_step=0.0261, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0261, Train/loss_recog_step=1.730, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]  Epoch 66:  32%|███▏      | 100/313 [02:19<04:57,  0.72it/s, v_num=0, Train/loss_all_step=0.0261, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0261, Train/loss_recog_step=1.730, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]Epoch 66:  32%|███▏      | 100/313 [02:19<04:57,  0.72it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=1.870, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]Epoch 66:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=1.870, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]Epoch 66:  48%|████▊     | 150/313 [03:29<03:47,  0.72it/s, v_num=0, Train/loss_all_step=0.0042, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.0042, Train/loss_recog_step=1.860, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]Epoch 66:  64%|██████▍   | 200/313 [04:34<02:35,  0.73it/s, v_num=0, Train/loss_all_step=0.0042, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.0042, Train/loss_recog_step=1.860, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]Epoch 66:  64%|██████▍   | 200/313 [04:34<02:35,  0.73it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.00698, Train/loss_recog_step=1.790, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]Epoch 66:  80%|███████▉  | 250/313 [05:45<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.00698, Train/loss_recog_step=1.790, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]Epoch 66:  80%|███████▉  | 250/313 [05:45<01:27,  0.72it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00332, Train/loss_recog_step=1.690, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]Epoch 66:  96%|█████████▌| 300/313 [06:50<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00332, Train/loss_recog_step=1.690, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]Epoch 66:  96%|█████████▌| 300/313 [06:50<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00609, Train/loss_recog_step=1.970, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]Epoch 66: 100%|██████████| 313/313 [07:04<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.00609, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00609, Train/loss_recog_step=1.970, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]Epoch 66: 100%|██████████| 313/313 [07:04<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.0214, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0214, Train/loss_recog_step=1.820, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.377, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.459, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.66it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00,  9.70it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.88it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 11.20it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  7.72it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.20it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.204998, 0.205103, 0.213753, 0.203824
Valid average loss UNet                 (all)                : 0.827679

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.356877, 1.428233, 2.207524
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.219018, 1.175596, 1.342183
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.347640, 2.337448, 2.547037
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.254195, 1.622350, 2.248502
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.281422, 1.913213, 2.517666
Valid average loss all      (Triplet)                 : 0.325002

== Recognize ==
Valid average loss Recognize     : 1.768567
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.325002

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.234338760375977 sec. =
Valid knn accuracy drums     : 68.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.79939866065979 sec. =
Valid knn accuracy bass      : 20.362903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.664037227630615 sec. =
Valid knn accuracy piano     : 35.3515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.976537942886353 sec. =
Valid knn accuracy guitar    : 39.955357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.17934799194336 sec. =
Valid knn accuracy residuals : 57.72727272727273%

Valid knn accuracy average   : 44.33159303223074%

                                                                      [AEpoch 66: 100%|██████████| 313/313 [08:24<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0214, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0214, Train/loss_recog_step=1.820, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.443, Train/loss_all_epoch=0.009, Train/loss_unet_all_epoch=0.841, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.830]Epoch 66: 100%|██████████| 313/313 [08:24<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0214, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0214, Train/loss_recog_step=1.820, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00963, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00963, Train/loss_recog_epoch=1.830]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.208792, 0.210057, 0.212369, 0.210624
Train average loss UNet                 (all)                : 0.841842

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005140, 1.420798, 3.474175
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012563, 1.332563, 2.311117
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013011, 1.604449, 2.795862
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009826, 1.519081, 2.752338
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008198, 1.798768, 3.264291
Train average loss all      (Triplet)                 : 0.009626

== Recognize ==
Train average loss Recognize     : 1.831915
Train average accuracy drums     : 49.994999 %
Train average accuracy bass      : 50.129997 %
Train average accuracy piano     : 49.865002 %
Train average accuracy guitar    : 50.094997 %
Train average accuracy residuals : 49.834999 %

== Train average loss all : 0.009626

Epoch 66: 100%|██████████| 313/313 [08:24<00:00,  0.62it/s, v_num=0, Train/loss_all_step=0.0214, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0214, Train/loss_recog_step=1.820, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.443, Train/loss_all_epoch=0.00963, Train/loss_unet_all_epoch=0.842, Train/loss_triplet_all_epoch=0.00963, Train/loss_recog_epoch=1.830]
[2023-11-06 08:33:00,665][source.train][INFO] - [rank: 0] Starting testing!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
The length of seg for train is 3s.
The length of seg for valid and test is 3s.
----------------------------------------
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0: 100%|██████████| 16/16 [00:02<00:00,  5.80it/s]Testing DataLoader 0:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 1: 100%|██████████| 15/15 [00:01<00:00,  8.13it/s]Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 2:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 2: 100%|██████████| 15/15 [00:01<00:00, 11.01it/s]Testing DataLoader 2:   0%|          | 0/13 [00:00<?, ?it/s]         Testing DataLoader 3:   0%|          | 0/13 [00:00<?, ?it/s]Testing DataLoader 3: 100%|██████████| 13/13 [00:01<00:00,  8.50it/s]Testing DataLoader 3:   0%|          | 0/14 [00:00<?, ?it/s]         Testing DataLoader 4:   0%|          | 0/14 [00:00<?, ?it/s]Testing DataLoader 4: 100%|██████████| 14/14 [00:02<00:00,  6.20it/s]Testing DataLoader 4:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 5:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 5: 100%|██████████| 15/15 [00:01<00:00, 10.92it/s]
Test average accuracy drums     :  51.300003 %
Test average accuracy bass      :  54.599998 %
Test average accuracy piano     :  49.500000 %
Test average accuracy guitar    :  49.200001 %
Test average accuracy residuals :  51.000000 %
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.768272161483765 sec. =
Test knn accuracy drums     : 48.68995633187773%
= T-SNE...
T-SNE was finished!
= T-SNE time is 20.699793100357056 sec. =
Test knn accuracy bass      : 12.29235880398671%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.496246099472046 sec. =
Test knn accuracy piano     : 25.91240875912409%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.675930976867676 sec. =
Test knn accuracy guitar    : 17.647058823529413%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.81894874572754 sec. =
Test knn accuracy residuals : 39.07427341227126%

Test knn accuracy average   : 28.72321122615784%
Testing DataLoader 5: 100%|██████████| 15/15 [01:54<00:00,  0.13it/s]
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 0    ┃   DataLoader 1    ┃   DataLoader 2   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.28723210096359… │ 0.28723210096359… │ 0.2872321009635… │
│   Test/knn_bass   │ 0.12292359024286… │ 0.12292359024286… │ 0.1229235902428… │
│  Test/knn_drums   │ 0.48689955472946… │ 0.48689955472946… │ 0.4868995547294… │
│  Test/knn_guitar  │ 0.17647059261798… │ 0.17647059261798… │ 0.1764705926179… │
│  Test/knn_piano   │ 0.25912410020828… │ 0.25912410020828… │ 0.2591241002082… │
│ Test/knn_residua… │ 0.39074274897575… │ 0.39074274897575… │ 0.3907427489757… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 3    ┃   DataLoader 4    ┃   DataLoader 5   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.28723210096359… │ 0.28723210096359… │ 0.2872321009635… │
│   Test/knn_bass   │ 0.12292359024286… │ 0.12292359024286… │ 0.1229235902428… │
│  Test/knn_drums   │ 0.48689955472946… │ 0.48689955472946… │ 0.4868995547294… │
│  Test/knn_guitar  │ 0.17647059261798… │ 0.17647059261798… │ 0.1764705926179… │
│  Test/knn_piano   │ 0.25912410020828… │ 0.25912410020828… │ 0.2591241002082… │
│ Test/knn_residua… │ 0.39074274897575… │ 0.39074274897575… │ 0.3907427489757… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
[2023-11-06 08:35:18,973][source.train][INFO] - [rank: 0] Best ckpt path: /nas02/homes/imamura23-1000067/outputs/triplet_with_unet/runs/2023-11-05/23-14-21/checkpoints/epoch_016.ckpt
[2023-11-06 08:35:18,974][utils.utils][INFO] - [rank: 0] Output dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023-11-05/23-14-21
[2023-11-06 08:35:18,976][utils.utils][INFO] - [rank: 0] Metric name is None! Skipping metric value retrieval...

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Time taken to study : 09:20:57

All prosess was Done!
