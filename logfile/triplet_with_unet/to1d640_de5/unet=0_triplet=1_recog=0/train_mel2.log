
=== Using cuda(utils.func). ===


=== Using cuda(utils.logger). ===

[2023-11-05 06:21:20,965][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-05 06:21:20,970][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 100                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         train_dirname: 3s_on1.5                                               
│         test_dirname: 3s_on1.5                                                
│         load_using_librosa: true                                              
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_train: 3                                                      
│         seconds_test: 3                                                       
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 5.0e-05                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640                         
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: true                                                             
│         n_mels: 259                                                           
│       cfg:                                                                    
│         n_epoch: 100                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         train_dirname: 3s_on1.5                                               
│         test_dirname: 3s_on1.5                                                
│         load_using_librosa: true                                              
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_train: 3                                                      
│         seconds_test: 3                                                       
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 5.0e-05                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/knn_avr                                                
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: 1                                                         
│         mode: max                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/knn_avr                                                
│         min_delta: 0.0                                                        
│         patience: 10                                                          
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 100                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 100                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       train_dirname: 3s_on1.5                                                 
│       test_dirname: 3s_on1.5                                                  
│       load_using_librosa: true                                                
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_train: 3                                                        
│       seconds_test: 3                                                         
│       sr: 44100                                                               
│       mel: true                                                               
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640                             
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       lr: 5.0e-05                                                             
│       monitor_es: Valid/knn_avr                                               
│       monitor_mode_es: max                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 0                                                            
│       recog_rate: 0                                                           
│       test_psd_mine: false                                                    
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-05 06:21:21,036][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-05 06:21:21,051][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-05 06:21:24,526][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpnyol0twd
[2023-11-05 06:21:24,526][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpnyol0twd/_remote_module_non_scriptable.py
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=3200, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-05 06:21:25,386][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-05 06:21:25,387][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-05 06:21:25,392][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-05 06:21:25,393][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-05 06:21:25,394][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-05 06:21:25,394][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-05 06:21:25,435][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-05 06:21:25,677][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-05 06:21:25,885][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
The length of seg for train is 3s.
The length of seg for valid and test is 3s.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.534538745880127 sec. *
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:06<00:00,  0.29it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 1: 100%|██████████| 2/2 [00:00<00:00, 15.65it/s]Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 2: 100%|██████████| 2/2 [00:00<00:00, 16.67it/s]Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 3: 100%|██████████| 2/2 [00:00<00:00, 17.50it/s]Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 4: 100%|██████████| 2/2 [00:00<00:00, 13.39it/s]Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 5:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 5: 100%|██████████| 2/2 [00:00<00:00, 15.53it/s]

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.173977, 0.173563, 0.168840, 0.178714
Valid average loss UNet                 (all)                : 0.695094

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.200138, 0.001897, 0.001759
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.200210, 0.002075, 0.001864
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.199779, 0.001725, 0.001946
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.199696, 0.001977, 0.002281
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.200053, 0.002078, 0.002025
Valid average loss all      (Triplet)                 : 0.200014

== Recognize ==
Valid average loss Recognize     : 1.127969
Valid average accuracy drums     : 50.781250 %
Valid average accuracy bass      : 46.875000 %
Valid average accuracy piano     : 60.156250 %
Valid average accuracy guitar    : 51.562500 %
Valid average accuracy residuals : 46.875000 %

== Valid average loss all : 0.200014

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.5007152557373047 sec. =
Valid knn accuracy drums     : 35.15625%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.1672372817993164 sec. =
Valid knn accuracy bass      : 17.96875%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.321284770965576 sec. =
Valid knn accuracy piano     : 20.3125%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.092405319213867 sec. =
Valid knn accuracy guitar    : 44.53125%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.0750412940979004 sec. =
Valid knn accuracy residuals : 85.15625%

Valid knn accuracy average   : 40.625%
                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [00:52<04:34,  0.96it/s]Epoch 0:  16%|█▌        | 50/313 [00:52<04:34,  0.96it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.218, Train/loss_recog_step=1.190]Epoch 0:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.218, Train/loss_recog_step=1.190]Epoch 0:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.728, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=1.060]Epoch 0:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.728, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=1.060]Epoch 0:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.724, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.070]Epoch 0:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.724, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.070]Epoch 0:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.220]Epoch 0:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.220]Epoch 0:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=0.999]Epoch 0:  96%|█████████▌| 300/313 [04:08<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=0.999]Epoch 0:  96%|█████████▌| 300/313 [04:08<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.725, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=1.070]Epoch 0: 100%|██████████| 313/313 [04:16<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.725, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=1.070]Epoch 0: 100%|██████████| 313/313 [04:16<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 19.62it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 18.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 18.50it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.29it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 17.36it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.177451, 0.177320, 0.183128, 0.173688
Valid average loss UNet                 (all)                : 0.711586

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.180999, 0.247169, 0.386866
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.155542, 0.108846, 0.104330
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.252327, 0.340870, 0.305954
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.173381, 0.219194, 0.249222
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.183278, 0.403345, 0.439621
Valid average loss all      (Triplet)                 : 0.203486

== Recognize ==
Valid average loss Recognize     : 1.165545
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.203486

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.997091293334961 sec. =
Valid knn accuracy drums     : 48.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.450036287307739 sec. =
Valid knn accuracy bass      : 18.14516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.747852802276611 sec. =
Valid knn accuracy piano     : 19.921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.662628412246704 sec. =
Valid knn accuracy guitar    : 26.785714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.331170320510864 sec. =
Valid knn accuracy residuals : 54.090909090909086%

Valid knn accuracy average   : 33.571340629041366%

                                                                      [AEpoch 0: 100%|██████████| 313/313 [05:11<00:00,  1.00it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=1.220, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336]Epoch 0: 100%|██████████| 313/313 [05:11<00:00,  1.00it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=1.220, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.182130, 0.181022, 0.182965, 0.184567
Train average loss UNet                 (all)                : 0.730684

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.155370, 0.359961, 0.511029
Train average loss bass     (Triplet, dist_p, dist_n) : 0.228743, 0.317550, 0.299549
Train average loss piano    (Triplet, dist_p, dist_n) : 0.213624, 0.348353, 0.352312
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.216626, 0.340291, 0.342295
Train average loss residuals(Triplet, dist_p, dist_n) : 0.177242, 0.395065, 0.465257
Train average loss all      (Triplet)                 : 0.198907

== Recognize ==
Train average loss Recognize     : 1.113756
Train average accuracy drums     : 49.540001 %
Train average accuracy bass      : 50.594997 %
Train average accuracy piano     : 50.260002 %
Train average accuracy guitar    : 49.529999 %
Train average accuracy residuals : 50.335003 %

== Train average loss all : 0.198907

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=1.220, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=1.220, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]Epoch 1:  16%|█▌        | 50/313 [00:42<03:45,  1.16it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=1.220, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]Epoch 1:  16%|█▌        | 50/313 [00:42<03:45,  1.16it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.725, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=1.280, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]Epoch 1:  32%|███▏      | 100/313 [01:21<02:53,  1.23it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.725, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=1.280, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]Epoch 1:  32%|███▏      | 100/313 [01:21<02:53,  1.23it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.270, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]Epoch 1:  48%|████▊     | 150/313 [01:58<02:08,  1.26it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.270, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]Epoch 1:  48%|████▊     | 150/313 [01:58<02:08,  1.26it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=1.140, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]Epoch 1:  64%|██████▍   | 200/313 [02:36<01:28,  1.28it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=1.140, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]Epoch 1:  64%|██████▍   | 200/313 [02:36<01:28,  1.28it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.300, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]Epoch 1:  80%|███████▉  | 250/313 [03:15<00:49,  1.28it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.300, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]Epoch 1:  80%|███████▉  | 250/313 [03:15<00:49,  1.28it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.702, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=1.220, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]Epoch 1:  96%|█████████▌| 300/313 [03:53<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.702, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=1.220, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]Epoch 1:  96%|█████████▌| 300/313 [03:53<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.200, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]Epoch 1: 100%|██████████| 313/313 [04:01<00:00,  1.29it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.200, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]Epoch 1: 100%|██████████| 313/313 [04:01<00:00,  1.29it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.200, Train/loss_recog_step=1.180, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.706, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.336, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 19.51it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 16.43it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 18.80it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 15.64it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 17.41it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.176840, 0.176738, 0.182653, 0.178764
Valid average loss UNet                 (all)                : 0.714996

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.131333, 0.125482, 0.281990
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.159608, 0.129495, 0.123772
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.210677, 0.281101, 0.285006
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.167422, 0.205488, 0.244719
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.181757, 0.366730, 0.411084
Valid average loss all      (Triplet)                 : 0.184813

== Recognize ==
Valid average loss Recognize     : 1.158502
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.184813

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.8354172706604 sec. =
Valid knn accuracy drums     : 58.47826086956521%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3563268184661865 sec. =
Valid knn accuracy bass      : 25.806451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.911951303482056 sec. =
Valid knn accuracy piano     : 33.59375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.671999454498291 sec. =
Valid knn accuracy guitar    : 39.732142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.282341003417969 sec. =
Valid knn accuracy residuals : 59.31818181818181%

Valid knn accuracy average   : 43.385757431558616%

                                                                      [AEpoch 1: 100%|██████████| 313/313 [04:56<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.200, Train/loss_recog_step=1.180, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.199, Train/loss_recog_epoch=1.110]Epoch 1: 100%|██████████| 313/313 [04:56<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.200, Train/loss_recog_step=1.180, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.181529, 0.180433, 0.182366, 0.184760
Train average loss UNet                 (all)                : 0.729089

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.113429, 0.199064, 0.425245
Train average loss bass     (Triplet, dist_p, dist_n) : 0.208990, 0.169614, 0.162427
Train average loss piano    (Triplet, dist_p, dist_n) : 0.192289, 0.215252, 0.231958
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.204109, 0.198929, 0.198229
Train average loss residuals(Triplet, dist_p, dist_n) : 0.155006, 0.284782, 0.372551
Train average loss all      (Triplet)                 : 0.175819

== Recognize ==
Train average loss Recognize     : 1.211534
Train average accuracy drums     : 50.134998 %
Train average accuracy bass      : 50.250000 %
Train average accuracy piano     : 49.865002 %
Train average accuracy guitar    : 49.564999 %
Train average accuracy residuals : 50.320000 %

== Train average loss all : 0.175819

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.200, Train/loss_recog_step=1.180, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.200, Train/loss_recog_step=1.180, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]Epoch 2:  16%|█▌        | 50/313 [00:42<03:44,  1.17it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.200, Train/loss_recog_step=1.180, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]Epoch 2:  16%|█▌        | 50/313 [00:42<03:44,  1.17it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.724, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.170, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]Epoch 2:  32%|███▏      | 100/313 [01:20<02:51,  1.24it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.724, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.170, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]Epoch 2:  32%|███▏      | 100/313 [01:20<02:51,  1.24it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=1.160, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]Epoch 2:  48%|████▊     | 150/313 [01:57<02:08,  1.27it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=1.160, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]Epoch 2:  48%|████▊     | 150/313 [01:57<02:08,  1.27it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.330, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]Epoch 2:  64%|██████▍   | 200/313 [02:37<01:29,  1.27it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.330, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]Epoch 2:  64%|██████▍   | 200/313 [02:37<01:29,  1.27it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.280, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]Epoch 2:  80%|███████▉  | 250/313 [03:16<00:49,  1.27it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.280, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]Epoch 2:  80%|███████▉  | 250/313 [03:16<00:49,  1.27it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.701, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.310, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]Epoch 2:  96%|█████████▌| 300/313 [03:54<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.701, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.310, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]Epoch 2:  96%|█████████▌| 300/313 [03:54<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.080, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]Epoch 2: 100%|██████████| 313/313 [04:02<00:00,  1.29it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.080, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]Epoch 2: 100%|██████████| 313/313 [04:02<00:00,  1.29it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.260, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.688, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.715, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.434, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.01it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 18.29it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 13.03it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 18.57it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 16.04it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 17.31it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.176877, 0.176592, 0.182877, 0.170546
Valid average loss UNet                 (all)                : 0.706891

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.088613, 0.153494, 0.505960
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.144710, 0.105920, 0.112260
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.204858, 0.241969, 0.251226
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.178814, 0.178019, 0.204560
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.205372, 0.294693, 0.309955
Valid average loss all      (Triplet)                 : 0.179622

== Recognize ==
Valid average loss Recognize     : 1.272571
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 43.500000 %
Valid average accuracy piano     : 56.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.179622

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.861178874969482 sec. =
Valid knn accuracy drums     : 54.347826086956516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.463420629501343 sec. =
Valid knn accuracy bass      : 20.362903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.7184858322143555 sec. =
Valid knn accuracy piano     : 34.765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.530237674713135 sec. =
Valid knn accuracy guitar    : 25.223214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.395673036575317 sec. =
Valid knn accuracy residuals : 58.18181818181818%

Valid knn accuracy average   : 38.57627735605909%

                                                                      [AEpoch 2: 100%|██████████| 313/313 [04:56<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.260, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=1.210]Epoch 2: 100%|██████████| 313/313 [04:56<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.260, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.180829, 0.179766, 0.181729, 0.184835
Train average loss UNet                 (all)                : 0.727158

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.103733, 0.185656, 0.449037
Train average loss bass     (Triplet, dist_p, dist_n) : 0.208450, 0.158154, 0.151394
Train average loss piano    (Triplet, dist_p, dist_n) : 0.186191, 0.208348, 0.234486
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.199055, 0.188891, 0.193794
Train average loss residuals(Triplet, dist_p, dist_n) : 0.151624, 0.270308, 0.361999
Train average loss all      (Triplet)                 : 0.170973

== Recognize ==
Train average loss Recognize     : 1.254681
Train average accuracy drums     : 49.849998 %
Train average accuracy bass      : 49.805000 %
Train average accuracy piano     : 49.720001 %
Train average accuracy guitar    : 49.410000 %
Train average accuracy residuals : 50.844997 %

== Train average loss all : 0.170973

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.260, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.260, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]Epoch 3:  16%|█▌        | 50/313 [00:42<03:45,  1.16it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.260, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]Epoch 3:  16%|█▌        | 50/313 [00:42<03:45,  1.16it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=1.420, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]Epoch 3:  32%|███▏      | 100/313 [01:21<02:53,  1.23it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=1.420, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]Epoch 3:  32%|███▏      | 100/313 [01:21<02:53,  1.23it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.440, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]Epoch 3:  48%|████▊     | 150/313 [01:59<02:09,  1.26it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.440, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]Epoch 3:  48%|████▊     | 150/313 [01:59<02:09,  1.26it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.733, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.460, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]Epoch 3:  64%|██████▍   | 200/313 [02:37<01:28,  1.27it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.733, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.460, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]Epoch 3:  64%|██████▍   | 200/313 [02:37<01:28,  1.27it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.340, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]Epoch 3:  80%|███████▉  | 250/313 [03:15<00:49,  1.28it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.340, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]Epoch 3:  80%|███████▉  | 250/313 [03:15<00:49,  1.28it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=1.310, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]Epoch 3:  96%|█████████▌| 300/313 [03:53<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=1.310, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]Epoch 3:  96%|█████████▌| 300/313 [03:53<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.708, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.200, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]Epoch 3: 100%|██████████| 313/313 [04:01<00:00,  1.29it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.708, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.200, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]Epoch 3: 100%|██████████| 313/313 [04:01<00:00,  1.29it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=1.180, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.386, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 19.37it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 17.61it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 12.45it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.80it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 17.34it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.177460, 0.177103, 0.183670, 0.169257
Valid average loss UNet                 (all)                : 0.707490

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077204, 0.228049, 0.669942
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.161989, 0.145079, 0.136902
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.200646, 0.242837, 0.249923
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.159912, 0.224489, 0.274186
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.243423, 0.423810, 0.398846
Valid average loss all      (Triplet)                 : 0.176156

== Recognize ==
Valid average loss Recognize     : 1.164249
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.176156

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.785890102386475 sec. =
Valid knn accuracy drums     : 54.347826086956516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.4427900314331055 sec. =
Valid knn accuracy bass      : 13.306451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.419910192489624 sec. =
Valid knn accuracy piano     : 29.296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.584287643432617 sec. =
Valid knn accuracy guitar    : 32.142857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.608226776123047 sec. =
Valid knn accuracy residuals : 57.04545454545455%

Valid knn accuracy average   : 37.22789287763429%

                                                                      [AEpoch 3: 100%|██████████| 313/313 [04:56<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=1.180, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.171, Train/loss_recog_epoch=1.250]Epoch 3: 100%|██████████| 313/313 [04:56<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=1.180, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.181156, 0.180097, 0.182037, 0.184960
Train average loss UNet                 (all)                : 0.728251

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.092470, 0.164864, 0.450871
Train average loss bass     (Triplet, dist_p, dist_n) : 0.201217, 0.163813, 0.165091
Train average loss piano    (Triplet, dist_p, dist_n) : 0.186626, 0.207942, 0.231362
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.194115, 0.187008, 0.197856
Train average loss residuals(Triplet, dist_p, dist_n) : 0.145848, 0.275977, 0.378327
Train average loss all      (Triplet)                 : 0.165400

== Recognize ==
Train average loss Recognize     : 1.339020
Train average accuracy drums     : 50.234997 %
Train average accuracy bass      : 50.019997 %
Train average accuracy piano     : 49.590000 %
Train average accuracy guitar    : 49.790001 %
Train average accuracy residuals : 50.125004 %

== Train average loss all : 0.165400

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=1.180, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=1.180, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]Epoch 4:  16%|█▌        | 50/313 [00:43<03:49,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=1.180, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]Epoch 4:  16%|█▌        | 50/313 [00:43<03:49,  1.14it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.180, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]Epoch 4:  32%|███▏      | 100/313 [01:22<02:55,  1.21it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.180, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]Epoch 4:  32%|███▏      | 100/313 [01:22<02:55,  1.21it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.260, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]Epoch 4:  48%|████▊     | 150/313 [02:02<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.260, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]Epoch 4:  48%|████▊     | 150/313 [02:02<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.727, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.420, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]Epoch 4:  64%|██████▍   | 200/313 [02:40<01:30,  1.24it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.727, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.420, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]Epoch 4:  64%|██████▍   | 200/313 [02:40<01:30,  1.24it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=1.590, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]Epoch 4:  80%|███████▉  | 250/313 [03:19<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=1.590, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]Epoch 4:  80%|███████▉  | 250/313 [03:19<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.510, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]Epoch 4:  96%|█████████▌| 300/313 [03:58<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.510, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]Epoch 4:  96%|█████████▌| 300/313 [03:58<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.710, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=1.260, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]Epoch 4: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.710, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=1.260, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]Epoch 4: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.330, Valid/loss_all_step=0.144, Valid/loss_unet_all_step=0.665, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 18.41it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 16.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 17.85it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.28it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 17.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.176504, 0.176180, 0.182666, 0.168864
Valid average loss UNet                 (all)                : 0.704214

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.066509, 0.188482, 0.609071
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.134419, 0.131569, 0.153874
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.185061, 0.220241, 0.239381
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.181462, 0.198635, 0.221369
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.145787, 0.365615, 0.463106
Valid average loss all      (Triplet)                 : 0.158576

== Recognize ==
Valid average loss Recognize     : 1.458086
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.158576

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.054193019866943 sec. =
Valid knn accuracy drums     : 56.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.636895418167114 sec. =
Valid knn accuracy bass      : 19.35483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6946892738342285 sec. =
Valid knn accuracy piano     : 28.125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.484431028366089 sec. =
Valid knn accuracy guitar    : 30.357142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.725931644439697 sec. =
Valid knn accuracy residuals : 61.13636363636363%

Valid knn accuracy average   : 39.09901686672374%

                                                                      [AEpoch 4: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.330, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.340]Epoch 4: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.330, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.181103, 0.180036, 0.181963, 0.184333
Train average loss UNet                 (all)                : 0.727436

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.090359, 0.181445, 0.506146
Train average loss bass     (Triplet, dist_p, dist_n) : 0.197287, 0.171739, 0.178676
Train average loss piano    (Triplet, dist_p, dist_n) : 0.182567, 0.213833, 0.243979
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.193080, 0.200329, 0.213788
Train average loss residuals(Triplet, dist_p, dist_n) : 0.140512, 0.293129, 0.409220
Train average loss all      (Triplet)                 : 0.161897

== Recognize ==
Train average loss Recognize     : 1.333738
Train average accuracy drums     : 49.254997 %
Train average accuracy bass      : 50.199997 %
Train average accuracy piano     : 49.739998 %
Train average accuracy guitar    : 50.524998 %
Train average accuracy residuals : 50.050003 %

== Train average loss all : 0.161897

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.330, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.330, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]Epoch 5:  16%|█▌        | 50/313 [00:44<03:53,  1.13it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.330, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]Epoch 5:  16%|█▌        | 50/313 [00:44<03:53,  1.13it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=1.260, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]Epoch 5:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=1.260, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]Epoch 5:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.400, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]Epoch 5:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.400, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]Epoch 5:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.280, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]Epoch 5:  64%|██████▍   | 200/313 [02:41<01:31,  1.24it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.280, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]Epoch 5:  64%|██████▍   | 200/313 [02:41<01:31,  1.24it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.410, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]Epoch 5:  80%|███████▉  | 250/313 [03:20<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.410, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]Epoch 5:  80%|███████▉  | 250/313 [03:20<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.699, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.650, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]Epoch 5:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.699, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.650, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]Epoch 5:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.703, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=1.350, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]Epoch 5: 100%|██████████| 313/313 [04:07<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.703, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=1.350, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]Epoch 5: 100%|██████████| 313/313 [04:07<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.350, Valid/loss_all_step=0.128, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.704, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.391, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.55it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 17.38it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 17.65it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 18.37it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 18.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.174489, 0.174471, 0.180402, 0.167036
Valid average loss UNet                 (all)                : 0.696398

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101978, 0.170471, 0.487995
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.149808, 0.147100, 0.155041
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.199400, 0.280545, 0.290831
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.163300, 0.270888, 0.339679
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.168678, 0.437096, 0.500935
Valid average loss all      (Triplet)                 : 0.169258

== Recognize ==
Valid average loss Recognize     : 1.366177
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.169258

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.073168516159058 sec. =
Valid knn accuracy drums     : 56.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.210626602172852 sec. =
Valid knn accuracy bass      : 21.774193548387096%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.631649971008301 sec. =
Valid knn accuracy piano     : 32.03125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.523539304733276 sec. =
Valid knn accuracy guitar    : 38.392857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.3278303146362305 sec. =
Valid knn accuracy residuals : 55.22727272727273%

Valid knn accuracy average   : 40.745984248920784%

                                                                      [AEpoch 5: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.350, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.162, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.330]Epoch 5: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.350, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.180160, 0.179131, 0.181080, 0.185069
Train average loss UNet                 (all)                : 0.725440

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.082115, 0.192774, 0.523956
Train average loss bass     (Triplet, dist_p, dist_n) : 0.195763, 0.188849, 0.199595
Train average loss piano    (Triplet, dist_p, dist_n) : 0.179067, 0.236812, 0.272150
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.185112, 0.216232, 0.240389
Train average loss residuals(Triplet, dist_p, dist_n) : 0.138068, 0.303677, 0.423472
Train average loss all      (Triplet)                 : 0.157266

== Recognize ==
Train average loss Recognize     : 1.409420
Train average accuracy drums     : 50.145000 %
Train average accuracy bass      : 49.564999 %
Train average accuracy piano     : 50.150002 %
Train average accuracy guitar    : 49.985001 %
Train average accuracy residuals : 49.720001 %

== Train average loss all : 0.157266

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.350, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.350, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]Epoch 6:  16%|█▌        | 50/313 [00:44<03:53,  1.13it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.350, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]Epoch 6:  16%|█▌        | 50/313 [00:44<03:53,  1.13it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=1.360, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]Epoch 6:  32%|███▏      | 100/313 [01:23<02:58,  1.20it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=1.360, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]Epoch 6:  32%|███▏      | 100/313 [01:23<02:58,  1.20it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=1.550, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]Epoch 6:  48%|████▊     | 150/313 [02:02<02:13,  1.23it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=1.550, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]Epoch 6:  48%|████▊     | 150/313 [02:02<02:13,  1.23it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.600, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]Epoch 6:  64%|██████▍   | 200/313 [02:41<01:31,  1.24it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.600, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]Epoch 6:  64%|██████▍   | 200/313 [02:41<01:31,  1.24it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.500, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]Epoch 6:  80%|███████▉  | 250/313 [03:20<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.500, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]Epoch 6:  80%|███████▉  | 250/313 [03:20<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.699, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.720, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]Epoch 6:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.699, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.720, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]Epoch 6:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.580, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]Epoch 6: 100%|██████████| 313/313 [04:07<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.580, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]Epoch 6: 100%|██████████| 313/313 [04:07<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.660, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.651, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.407, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 16.34it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 19.35it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 17.67it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 16.91it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 17.93it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175407, 0.174957, 0.181779, 0.165797
Valid average loss UNet                 (all)                : 0.697940

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.057886, 0.245859, 0.694272
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.130606, 0.162149, 0.194744
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.143538, 0.285774, 0.355910
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.142803, 0.252398, 0.334393
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.141585, 0.408286, 0.512325
Valid average loss all      (Triplet)                 : 0.134757

== Recognize ==
Valid average loss Recognize     : 1.636317
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 44.000000 %

== Valid average loss all : 0.134757

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.59922194480896 sec. =
Valid knn accuracy drums     : 67.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.399373292922974 sec. =
Valid knn accuracy bass      : 15.725806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.471681118011475 sec. =
Valid knn accuracy piano     : 33.203125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.566492557525635 sec. =
Valid knn accuracy guitar    : 40.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.344800233840942 sec. =
Valid knn accuracy residuals : 64.0909090909091%

Valid knn accuracy average   : 44.294185499808755%

                                                                      [AEpoch 6: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.660, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.410]Epoch 6: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.660, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.180038, 0.178971, 0.180927, 0.184721
Train average loss UNet                 (all)                : 0.724658

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.078073, 0.227058, 0.591797
Train average loss bass     (Triplet, dist_p, dist_n) : 0.193111, 0.205549, 0.220331
Train average loss piano    (Triplet, dist_p, dist_n) : 0.175096, 0.258251, 0.299581
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.177562, 0.250713, 0.291389
Train average loss residuals(Triplet, dist_p, dist_n) : 0.134680, 0.331799, 0.459848
Train average loss all      (Triplet)                 : 0.152927

== Recognize ==
Train average loss Recognize     : 1.585967
Train average accuracy drums     : 49.704998 %
Train average accuracy bass      : 49.889999 %
Train average accuracy piano     : 49.980000 %
Train average accuracy guitar    : 49.955002 %
Train average accuracy residuals : 50.849998 %

== Train average loss all : 0.152927

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.660, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.660, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]Epoch 7:  16%|█▌        | 50/313 [00:43<03:51,  1.14it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.660, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]Epoch 7:  16%|█▌        | 50/313 [00:43<03:51,  1.14it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.470, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]Epoch 7:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.470, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]Epoch 7:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.530, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]Epoch 7:  48%|████▊     | 150/313 [02:01<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.530, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]Epoch 7:  48%|████▊     | 150/313 [02:01<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.500, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]Epoch 7:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.500, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]Epoch 7:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.640, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]Epoch 7:  80%|███████▉  | 250/313 [03:19<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.640, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]Epoch 7:  80%|███████▉  | 250/313 [03:19<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.701, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.670, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]Epoch 7:  96%|█████████▌| 300/313 [03:58<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.701, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.670, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]Epoch 7:  96%|█████████▌| 300/313 [03:58<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.701, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=1.650, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]Epoch 7: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.701, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=1.650, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]Epoch 7: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.570, Valid/loss_all_step=0.0838, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.0838, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.135, Valid/loss_recog_epoch=1.640, Valid/knn_avr=0.443, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.61it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 19.72it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 17.88it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 17.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.47it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 15.73it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175101, 0.174840, 0.181742, 0.164026
Valid average loss UNet                 (all)                : 0.695709

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083020, 0.219909, 0.627999
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.106799, 0.125296, 0.174320
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.206334, 0.349792, 0.369729
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.168316, 0.294160, 0.333473
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.166722, 0.484192, 0.581654
Valid average loss all      (Triplet)                 : 0.161658

== Recognize ==
Valid average loss Recognize     : 1.777945
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 41.500000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 42.000000 %

== Valid average loss all : 0.161658

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.868871212005615 sec. =
Valid knn accuracy drums     : 63.69565217391304%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.339449644088745 sec. =
Valid knn accuracy bass      : 19.35483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.479166269302368 sec. =
Valid knn accuracy piano     : 31.0546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.721724987030029 sec. =
Valid knn accuracy guitar    : 33.035714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.605203866958618 sec. =
Valid knn accuracy residuals : 66.5909090909091%

Valid knn accuracy average   : 42.746360352042764%

                                                                      [AEpoch 7: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.570, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=1.590]  Epoch 7: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.570, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179867, 0.178803, 0.180762, 0.184043
Train average loss UNet                 (all)                : 0.723475

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.074414, 0.223877, 0.597687
Train average loss bass     (Triplet, dist_p, dist_n) : 0.190434, 0.201035, 0.219093
Train average loss piano    (Triplet, dist_p, dist_n) : 0.173037, 0.258699, 0.302768
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.177394, 0.251707, 0.293065
Train average loss residuals(Triplet, dist_p, dist_n) : 0.126572, 0.326476, 0.466514
Train average loss all      (Triplet)                 : 0.149591

== Recognize ==
Train average loss Recognize     : 1.592829
Train average accuracy drums     : 49.654999 %
Train average accuracy bass      : 50.314999 %
Train average accuracy piano     : 49.669998 %
Train average accuracy guitar    : 49.320000 %
Train average accuracy residuals : 50.125004 %

== Train average loss all : 0.149591

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.570, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.570, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]Epoch 8:  16%|█▌        | 50/313 [00:42<03:42,  1.18it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.570, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]Epoch 8:  16%|█▌        | 50/313 [00:42<03:42,  1.18it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.670, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]Epoch 8:  32%|███▏      | 100/313 [01:21<02:53,  1.23it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.670, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]Epoch 8:  32%|███▏      | 100/313 [01:21<02:53,  1.23it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.760, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]Epoch 8:  48%|████▊     | 150/313 [02:00<02:10,  1.25it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.760, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]Epoch 8:  48%|████▊     | 150/313 [02:00<02:10,  1.25it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.700, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]Epoch 8:  64%|██████▍   | 200/313 [02:38<01:29,  1.26it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.700, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]Epoch 8:  64%|██████▍   | 200/313 [02:38<01:29,  1.26it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.840, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]Epoch 8:  80%|███████▉  | 250/313 [03:17<00:49,  1.27it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.840, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]Epoch 8:  80%|███████▉  | 250/313 [03:17<00:49,  1.27it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.695, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.400, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]Epoch 8:  96%|█████████▌| 300/313 [03:55<00:10,  1.27it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.695, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.400, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]Epoch 8:  96%|█████████▌| 300/313 [03:55<00:10,  1.27it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=1.610, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]Epoch 8: 100%|██████████| 313/313 [04:03<00:00,  1.28it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=1.610, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]Epoch 8: 100%|██████████| 313/313 [04:03<00:00,  1.28it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.860, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.652, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.950, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.427, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 19.70it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 18.62it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 17.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.59it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 18.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175262, 0.175086, 0.181559, 0.173523
Valid average loss UNet                 (all)                : 0.705430

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091575, 0.211646, 0.578174
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.112413, 0.128577, 0.171722
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.152636, 0.322390, 0.378845
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.139415, 0.287564, 0.371062
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.166805, 0.447852, 0.533860
Valid average loss all      (Triplet)                 : 0.134406

== Recognize ==
Valid average loss Recognize     : 1.731420
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 44.000000 %

== Valid average loss all : 0.134406

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.983106374740601 sec. =
Valid knn accuracy drums     : 71.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.186581134796143 sec. =
Valid knn accuracy bass      : 18.548387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.431039333343506 sec. =
Valid knn accuracy piano     : 31.4453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.815670013427734 sec. =
Valid knn accuracy guitar    : 38.392857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.517130136489868 sec. =
Valid knn accuracy residuals : 65.45454545454545%

Valid knn accuracy average   : 45.11604652579187%

                                                                      [AEpoch 8: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.860, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.150, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=1.590]Epoch 8: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.860, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179979, 0.178909, 0.180858, 0.183986
Train average loss UNet                 (all)                : 0.723733

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.072857, 0.230859, 0.609496
Train average loss bass     (Triplet, dist_p, dist_n) : 0.186692, 0.208281, 0.231992
Train average loss piano    (Triplet, dist_p, dist_n) : 0.170185, 0.271677, 0.322127
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.168413, 0.254604, 0.309594
Train average loss residuals(Triplet, dist_p, dist_n) : 0.122588, 0.348230, 0.503689
Train average loss all      (Triplet)                 : 0.145427

== Recognize ==
Train average loss Recognize     : 1.677520
Train average accuracy drums     : 49.865002 %
Train average accuracy bass      : 50.515003 %
Train average accuracy piano     : 49.549999 %
Train average accuracy guitar    : 49.544998 %
Train average accuracy residuals : 49.810001 %

== Train average loss all : 0.145427

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.860, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.860, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]Epoch 9:  16%|█▌        | 50/313 [00:44<03:52,  1.13it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.860, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]Epoch 9:  16%|█▌        | 50/313 [00:44<03:52,  1.13it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=1.760, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]Epoch 9:  32%|███▏      | 100/313 [01:23<02:58,  1.19it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=1.760, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]Epoch 9:  32%|███▏      | 100/313 [01:23<02:58,  1.19it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.700, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]Epoch 9:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.700, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]Epoch 9:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.710, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]Epoch 9:  64%|██████▍   | 200/313 [02:41<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.710, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]Epoch 9:  64%|██████▍   | 200/313 [02:41<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.770, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]Epoch 9:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.770, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]Epoch 9:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.697, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.800, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]Epoch 9:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.697, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.800, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]Epoch 9:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=1.630, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]Epoch 9: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=1.630, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]Epoch 9: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.720, Valid/loss_all_step=0.0935, Valid/loss_unet_all_step=0.687, Valid/loss_triplet_all_step=0.0935, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.451, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.64it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 19.11it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 19.03it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 14.07it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.41it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 18.34it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.173653, 0.173530, 0.180053, 0.163271
Valid average loss UNet                 (all)                : 0.690507

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.117169, 0.202540, 0.535344
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.117925, 0.131465, 0.175128
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.150385, 0.305208, 0.371546
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.157887, 0.305442, 0.404032
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.157445, 0.502091, 0.599472
Valid average loss all      (Triplet)                 : 0.141572

== Recognize ==
Valid average loss Recognize     : 1.706697
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 58.000000 %
Valid average accuracy residuals : 44.000000 %

== Valid average loss all : 0.141572

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.652454853057861 sec. =
Valid knn accuracy drums     : 69.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.23975133895874 sec. =
Valid knn accuracy bass      : 17.741935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.710875749588013 sec. =
Valid knn accuracy piano     : 30.6640625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.649616241455078 sec. =
Valid knn accuracy guitar    : 44.419642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.424915313720703 sec. =
Valid knn accuracy residuals : 65.22727272727272%

Valid knn accuracy average   : 45.52362619191818%

                                                                      [AEpoch 9: 100%|██████████| 313/313 [05:02<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.720, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=1.680]  Epoch 9: 100%|██████████| 313/313 [05:02<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.720, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179912, 0.178881, 0.180806, 0.184418
Train average loss UNet                 (all)                : 0.724016

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.071519, 0.241276, 0.641065
Train average loss bass     (Triplet, dist_p, dist_n) : 0.185631, 0.213163, 0.239409
Train average loss piano    (Triplet, dist_p, dist_n) : 0.166333, 0.282028, 0.339801
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.164594, 0.269542, 0.331976
Train average loss residuals(Triplet, dist_p, dist_n) : 0.119910, 0.363921, 0.526903
Train average loss all      (Triplet)                 : 0.142796

== Recognize ==
Train average loss Recognize     : 1.716624
Train average accuracy drums     : 49.320000 %
Train average accuracy bass      : 49.739998 %
Train average accuracy piano     : 49.579998 %
Train average accuracy guitar    : 49.950001 %
Train average accuracy residuals : 50.735004 %

== Train average loss all : 0.142796

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.720, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.720, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]Epoch 10:  16%|█▌        | 50/313 [00:44<03:52,  1.13it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.720, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]Epoch 10:  16%|█▌        | 50/313 [00:44<03:52,  1.13it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.580, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]Epoch 10:  32%|███▏      | 100/313 [01:23<02:58,  1.20it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.580, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]Epoch 10:  32%|███▏      | 100/313 [01:23<02:58,  1.20it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.620, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]Epoch 10:  48%|████▊     | 150/313 [02:03<02:14,  1.22it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.620, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]Epoch 10:  48%|████▊     | 150/313 [02:03<02:14,  1.22it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.630, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]Epoch 10:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.630, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]Epoch 10:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.790, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]Epoch 10:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.790, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]Epoch 10:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.695, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=2.040, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]Epoch 10:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.695, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=2.040, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]Epoch 10:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.840, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]Epoch 10: 100%|██████████| 313/313 [04:09<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.840, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]Epoch 10: 100%|██████████| 313/313 [04:09<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.0976, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.0976, Train/loss_recog_step=2.020, Valid/loss_all_step=0.097, Valid/loss_unet_all_step=0.623, Valid/loss_triplet_all_step=0.097, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.691, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.57it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 19.16it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 17.24it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 16.84it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.77it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 17.45it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175926, 0.175830, 0.182140, 0.174822
Valid average loss UNet                 (all)                : 0.708718

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.142382, 0.239163, 0.548018
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.118868, 0.140204, 0.179957
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.175607, 0.368937, 0.410151
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.143845, 0.327121, 0.440361
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.147477, 0.476857, 0.626993
Valid average loss all      (Triplet)                 : 0.152440

== Recognize ==
Valid average loss Recognize     : 1.698118
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.152440

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.6890013217926025 sec. =
Valid knn accuracy drums     : 61.95652173913043%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.139833688735962 sec. =
Valid knn accuracy bass      : 30.040322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.749790906906128 sec. =
Valid knn accuracy piano     : 27.9296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.590991258621216 sec. =
Valid knn accuracy guitar    : 42.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.354877233505249 sec. =
Valid knn accuracy residuals : 63.63636363636363%

Valid knn accuracy average   : 45.150079091227845%

                                                                      [AEpoch 10: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0976, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.0976, Train/loss_recog_step=2.020, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.143, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.720]Epoch 10: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0976, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.0976, Train/loss_recog_step=2.020, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179651, 0.178617, 0.180529, 0.183566
Train average loss UNet                 (all)                : 0.722364

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.068922, 0.241214, 0.641062
Train average loss bass     (Triplet, dist_p, dist_n) : 0.184715, 0.224225, 0.251449
Train average loss piano    (Triplet, dist_p, dist_n) : 0.163418, 0.290594, 0.351989
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.162516, 0.276796, 0.344095
Train average loss residuals(Triplet, dist_p, dist_n) : 0.115970, 0.384562, 0.556304
Train average loss all      (Triplet)                 : 0.140443

== Recognize ==
Train average loss Recognize     : 1.802238
Train average accuracy drums     : 50.089996 %
Train average accuracy bass      : 50.225002 %
Train average accuracy piano     : 50.199997 %
Train average accuracy guitar    : 50.089996 %
Train average accuracy residuals : 50.570000 %

== Train average loss all : 0.140443

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0976, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.0976, Train/loss_recog_step=2.020, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0976, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.0976, Train/loss_recog_step=2.020, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]Epoch 11:  16%|█▌        | 50/313 [00:44<03:55,  1.12it/s, v_num=0, Train/loss_all_step=0.0976, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.0976, Train/loss_recog_step=2.020, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]Epoch 11:  16%|█▌        | 50/313 [00:44<03:55,  1.12it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.980, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]  Epoch 11:  32%|███▏      | 100/313 [01:24<02:59,  1.18it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.980, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]Epoch 11:  32%|███▏      | 100/313 [01:24<02:59,  1.18it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=1.810, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]Epoch 11:  48%|████▊     | 150/313 [02:04<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=1.810, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]Epoch 11:  48%|████▊     | 150/313 [02:04<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.0971, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.0971, Train/loss_recog_step=2.030, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]Epoch 11:  64%|██████▍   | 200/313 [02:43<01:32,  1.23it/s, v_num=0, Train/loss_all_step=0.0971, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.0971, Train/loss_recog_step=2.030, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]Epoch 11:  64%|██████▍   | 200/313 [02:43<01:32,  1.23it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=2.070, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]  Epoch 11:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=2.070, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]Epoch 11:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.850, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]Epoch 11:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.850, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]Epoch 11:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.690, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.980, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]Epoch 11: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.690, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.980, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]Epoch 11: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.0993, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0993, Train/loss_recog_step=1.710, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.682, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.152, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.452, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 18.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 19.23it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 18.69it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.58it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 15.61it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175333, 0.175101, 0.181599, 0.177370
Valid average loss UNet                 (all)                : 0.709403

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065334, 0.198705, 0.605517
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.111052, 0.142598, 0.189529
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.205274, 0.397769, 0.423866
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.152193, 0.344243, 0.474761
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.157860, 0.503189, 0.636098
Valid average loss all      (Triplet)                 : 0.151409

== Recognize ==
Valid average loss Recognize     : 1.729476
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.151409

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.820976257324219 sec. =
Valid knn accuracy drums     : 70.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5172436237335205 sec. =
Valid knn accuracy bass      : 18.346774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.47655177116394 sec. =
Valid knn accuracy piano     : 29.1015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.557248830795288 sec. =
Valid knn accuracy guitar    : 41.07142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.300839900970459 sec. =
Valid knn accuracy residuals : 61.36363636363637%

Valid knn accuracy average   : 44.150593369200934%

                                                                      [AEpoch 11: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0993, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0993, Train/loss_recog_step=1.710, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.140, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.800]Epoch 11: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0993, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0993, Train/loss_recog_step=1.710, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179487, 0.178455, 0.180357, 0.184336
Train average loss UNet                 (all)                : 0.722634

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.067993, 0.257621, 0.665778
Train average loss bass     (Triplet, dist_p, dist_n) : 0.179441, 0.231345, 0.266274
Train average loss piano    (Triplet, dist_p, dist_n) : 0.159068, 0.315025, 0.384507
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.154267, 0.297143, 0.379080
Train average loss residuals(Triplet, dist_p, dist_n) : 0.112317, 0.398158, 0.577308
Train average loss all      (Triplet)                 : 0.135903

== Recognize ==
Train average loss Recognize     : 1.912688
Train average accuracy drums     : 49.720001 %
Train average accuracy bass      : 49.799999 %
Train average accuracy piano     : 50.080002 %
Train average accuracy guitar    : 49.919998 %
Train average accuracy residuals : 50.494999 %

== Train average loss all : 0.135903

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0993, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0993, Train/loss_recog_step=1.710, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0993, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0993, Train/loss_recog_step=1.710, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]Epoch 12:  16%|█▌        | 50/313 [00:44<03:56,  1.11it/s, v_num=0, Train/loss_all_step=0.0993, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0993, Train/loss_recog_step=1.710, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]Epoch 12:  16%|█▌        | 50/313 [00:44<03:56,  1.11it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.840, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]  Epoch 12:  32%|███▏      | 100/313 [01:24<02:59,  1.19it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.840, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]Epoch 12:  32%|███▏      | 100/313 [01:24<02:59,  1.19it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.950, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]Epoch 12:  48%|████▊     | 150/313 [02:02<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.950, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]Epoch 12:  48%|████▊     | 150/313 [02:02<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.0884, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0884, Train/loss_recog_step=1.870, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]Epoch 12:  64%|██████▍   | 200/313 [02:41<01:31,  1.24it/s, v_num=0, Train/loss_all_step=0.0884, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0884, Train/loss_recog_step=1.870, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]Epoch 12:  64%|██████▍   | 200/313 [02:41<01:31,  1.24it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=2.110, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]  Epoch 12:  80%|███████▉  | 250/313 [03:20<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=2.110, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]Epoch 12:  80%|███████▉  | 250/313 [03:20<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.693, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.940, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]Epoch 12:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.693, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.940, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]Epoch 12:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.698, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=2.020, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]Epoch 12: 100%|██████████| 313/313 [04:07<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.698, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=2.020, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]Epoch 12: 100%|██████████| 313/313 [04:07<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.084, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.084, Train/loss_recog_step=2.190, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.678, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.490, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.442, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.83it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 19.68it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 12.78it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 19.05it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.97it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 17.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175277, 0.174855, 0.181745, 0.167446
Valid average loss UNet                 (all)                : 0.699323

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099677, 0.267397, 0.662019
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.104886, 0.176322, 0.238533
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.196372, 0.433745, 0.485793
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.152789, 0.373804, 0.518338
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.148397, 0.457890, 0.669794
Valid average loss all      (Triplet)                 : 0.145577

== Recognize ==
Valid average loss Recognize     : 2.253191
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 43.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.145577

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.76866602897644 sec. =
Valid knn accuracy drums     : 68.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.239084959030151 sec. =
Valid knn accuracy bass      : 19.556451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.495769262313843 sec. =
Valid knn accuracy piano     : 29.6875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.8568925857543945 sec. =
Valid knn accuracy guitar    : 41.74107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.8850390911102295 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 45.07447496402616%

                                                                      [AEpoch 12: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.084, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.084, Train/loss_recog_step=2.190, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.910]Epoch 12: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.084, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.084, Train/loss_recog_step=2.190, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179547, 0.178500, 0.180405, 0.183739
Train average loss UNet                 (all)                : 0.722191

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.067288, 0.270637, 0.680632
Train average loss bass     (Triplet, dist_p, dist_n) : 0.175770, 0.247865, 0.289638
Train average loss piano    (Triplet, dist_p, dist_n) : 0.154608, 0.333314, 0.412327
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.151131, 0.318117, 0.407432
Train average loss residuals(Triplet, dist_p, dist_n) : 0.110860, 0.420214, 0.611130
Train average loss all      (Triplet)                 : 0.133308

== Recognize ==
Train average loss Recognize     : 1.961593
Train average accuracy drums     : 49.910000 %
Train average accuracy bass      : 49.590000 %
Train average accuracy piano     : 49.720001 %
Train average accuracy guitar    : 49.630001 %
Train average accuracy residuals : 50.099998 %

== Train average loss all : 0.133308

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.084, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.084, Train/loss_recog_step=2.190, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.084, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.084, Train/loss_recog_step=2.190, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]Epoch 13:  16%|█▌        | 50/313 [00:44<03:51,  1.14it/s, v_num=0, Train/loss_all_step=0.084, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.084, Train/loss_recog_step=2.190, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]Epoch 13:  16%|█▌        | 50/313 [00:44<03:51,  1.14it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.930, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]Epoch 13:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.930, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]Epoch 13:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.733, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=2.040, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]Epoch 13:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.733, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=2.040, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]Epoch 13:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.0935, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.0935, Train/loss_recog_step=2.060, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]Epoch 13:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.0935, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.0935, Train/loss_recog_step=2.060, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]Epoch 13:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=2.050, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]  Epoch 13:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=2.050, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]Epoch 13:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.693, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=2.230, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]Epoch 13:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.693, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=2.230, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]Epoch 13:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.960, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]Epoch 13: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.960, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]Epoch 13: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.0692, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.0692, Train/loss_recog_step=2.140, Valid/loss_all_step=0.0983, Valid/loss_unet_all_step=0.664, Valid/loss_triplet_all_step=0.0983, Valid/loss_recog_step=2.660, Valid/loss_all_epoch=0.146, Valid/loss_unet_all_epoch=0.699, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=2.250, Valid/knn_avr=0.451, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 17.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 18.58it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 19.09it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 18.08it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 17.60it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.176108, 0.175801, 0.182435, 0.168223
Valid average loss UNet                 (all)                : 0.702567

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.112989, 0.273982, 0.643145
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.100196, 0.216498, 0.291770
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.205826, 0.438476, 0.463697
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.130971, 0.347243, 0.503838
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.203978, 0.546394, 0.597647
Valid average loss all      (Triplet)                 : 0.155000

== Recognize ==
Valid average loss Recognize     : 1.977976
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 57.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.155000

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.751319885253906 sec. =
Valid knn accuracy drums     : 63.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5573272705078125 sec. =
Valid knn accuracy bass      : 14.516129032258066%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.056293249130249 sec. =
Valid knn accuracy piano     : 30.078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.55729079246521 sec. =
Valid knn accuracy guitar    : 43.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.389751672744751 sec. =
Valid knn accuracy residuals : 61.81818181818181%

Valid knn accuracy average   : 42.68466108313145%

                                                                      [AEpoch 13: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0692, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.0692, Train/loss_recog_step=2.140, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.133, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.133, Train/loss_recog_epoch=1.960]  Epoch 13: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0692, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.0692, Train/loss_recog_step=2.140, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179481, 0.178453, 0.180354, 0.183628
Train average loss UNet                 (all)                : 0.721915

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.063497, 0.288377, 0.710002
Train average loss bass     (Triplet, dist_p, dist_n) : 0.172772, 0.270288, 0.318765
Train average loss piano    (Triplet, dist_p, dist_n) : 0.151574, 0.357965, 0.444784
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.148477, 0.341891, 0.440926
Train average loss residuals(Triplet, dist_p, dist_n) : 0.106106, 0.439371, 0.645207
Train average loss all      (Triplet)                 : 0.129897

== Recognize ==
Train average loss Recognize     : 2.035348
Train average accuracy drums     : 50.050003 %
Train average accuracy bass      : 50.000000 %
Train average accuracy piano     : 50.225002 %
Train average accuracy guitar    : 49.880001 %
Train average accuracy residuals : 49.985001 %

== Train average loss all : 0.129897

Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0692, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.0692, Train/loss_recog_step=2.140, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]          Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0692, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.0692, Train/loss_recog_step=2.140, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]Epoch 14:  16%|█▌        | 50/313 [00:44<03:53,  1.13it/s, v_num=0, Train/loss_all_step=0.0692, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.0692, Train/loss_recog_step=2.140, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]Epoch 14:  16%|█▌        | 50/313 [00:44<03:53,  1.13it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=2.020, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]  Epoch 14:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=2.020, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]Epoch 14:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=2.030, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]Epoch 14:  48%|████▊     | 150/313 [02:02<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=2.030, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]Epoch 14:  48%|████▊     | 150/313 [02:02<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.0887, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.0887, Train/loss_recog_step=2.280, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]Epoch 14:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.0887, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.0887, Train/loss_recog_step=2.280, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]Epoch 14:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=2.120, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]  Epoch 14:  80%|███████▉  | 250/313 [03:22<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=2.120, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]Epoch 14:  80%|███████▉  | 250/313 [03:22<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.692, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=2.350, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]Epoch 14:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.692, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=2.350, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]Epoch 14:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=2.300, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]Epoch 14: 100%|██████████| 313/313 [04:09<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=2.300, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]Epoch 14: 100%|██████████| 313/313 [04:09<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.095, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.095, Train/loss_recog_step=2.050, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.980, Valid/knn_avr=0.427, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 19.56it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 18.71it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 17.91it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.89it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 16.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175158, 0.174924, 0.181283, 0.165034
Valid average loss UNet                 (all)                : 0.696397

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.084932, 0.277740, 0.741093
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.119463, 0.229518, 0.276266
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.218780, 0.513148, 0.558520
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.144162, 0.452708, 0.591789
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.157878, 0.559289, 0.687740
Valid average loss all      (Triplet)                 : 0.157771

== Recognize ==
Valid average loss Recognize     : 1.998660
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.157771

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.801147699356079 sec. =
Valid knn accuracy drums     : 69.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.419551134109497 sec. =
Valid knn accuracy bass      : 21.370967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.847113370895386 sec. =
Valid knn accuracy piano     : 30.078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.620022535324097 sec. =
Valid knn accuracy guitar    : 44.19642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.459312438964844 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 47.176535092712335%

                                                                      [AEpoch 14: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.095, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.095, Train/loss_recog_step=2.050, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.040]Epoch 14: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.095, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.095, Train/loss_recog_step=2.050, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179642, 0.178616, 0.180509, 0.183329
Train average loss UNet                 (all)                : 0.722097

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.063568, 0.313181, 0.777886
Train average loss bass     (Triplet, dist_p, dist_n) : 0.168931, 0.297746, 0.352855
Train average loss piano    (Triplet, dist_p, dist_n) : 0.148288, 0.390620, 0.486959
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.145229, 0.364015, 0.470717
Train average loss residuals(Triplet, dist_p, dist_n) : 0.101589, 0.463783, 0.687100
Train average loss all      (Triplet)                 : 0.126695

== Recognize ==
Train average loss Recognize     : 2.070804
Train average accuracy drums     : 50.575001 %
Train average accuracy bass      : 50.489998 %
Train average accuracy piano     : 49.869999 %
Train average accuracy guitar    : 50.234997 %
Train average accuracy residuals : 50.255001 %

== Train average loss all : 0.126695

Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.095, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.095, Train/loss_recog_step=2.050, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]          Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.095, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.095, Train/loss_recog_step=2.050, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]Epoch 15:  16%|█▌        | 50/313 [00:45<03:59,  1.10it/s, v_num=0, Train/loss_all_step=0.095, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.095, Train/loss_recog_step=2.050, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]Epoch 15:  16%|█▌        | 50/313 [00:45<03:59,  1.10it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=2.230, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]Epoch 15:  32%|███▏      | 100/313 [01:23<02:58,  1.19it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=2.230, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]Epoch 15:  32%|███▏      | 100/313 [01:23<02:58,  1.19it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=2.110, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]Epoch 15:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=2.110, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]Epoch 15:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.0806, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.0806, Train/loss_recog_step=2.190, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]Epoch 15:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.0806, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.0806, Train/loss_recog_step=2.190, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]Epoch 15:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=2.040, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]  Epoch 15:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=2.040, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]Epoch 15:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.696, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=2.120, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]Epoch 15:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.696, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=2.120, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]Epoch 15:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=2.440, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]Epoch 15: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=2.440, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]Epoch 15: 100%|██████████| 313/313 [04:09<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.094, Train/loss_unet_all_step=0.702, Train/loss_triplet_all_step=0.094, Train/loss_recog_step=2.130, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.690, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.472, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 19.32it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 18.96it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 18.86it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 18.25it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 17.91it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.174916, 0.174592, 0.181192, 0.165375
Valid average loss UNet                 (all)                : 0.696075

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.118302, 0.366354, 0.760812
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.153457, 0.241776, 0.248147
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.210507, 0.586819, 0.624808
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.137230, 0.423591, 0.567731
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.158613, 0.655366, 0.817578
Valid average loss all      (Triplet)                 : 0.165601

== Recognize ==
Valid average loss Recognize     : 2.296451
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.165601

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.669620990753174 sec. =
Valid knn accuracy drums     : 66.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.477949857711792 sec. =
Valid knn accuracy bass      : 16.532258064516128%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.477960109710693 sec. =
Valid knn accuracy piano     : 32.6171875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.622183322906494 sec. =
Valid knn accuracy guitar    : 35.714285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.430241823196411 sec. =
Valid knn accuracy residuals : 62.04545454545455%

Valid knn accuracy average   : 42.599228469199105%

                                                                      [AEpoch 15: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.094, Train/loss_unet_all_step=0.702, Train/loss_triplet_all_step=0.094, Train/loss_recog_step=2.130, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=2.070]Epoch 15: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.094, Train/loss_unet_all_step=0.702, Train/loss_triplet_all_step=0.094, Train/loss_recog_step=2.130, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179633, 0.178599, 0.180509, 0.183848
Train average loss UNet                 (all)                : 0.722589

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.060488, 0.329044, 0.790342
Train average loss bass     (Triplet, dist_p, dist_n) : 0.162001, 0.324130, 0.391428
Train average loss piano    (Triplet, dist_p, dist_n) : 0.144704, 0.402813, 0.504176
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.137604, 0.379864, 0.499942
Train average loss residuals(Triplet, dist_p, dist_n) : 0.096395, 0.482063, 0.714843
Train average loss all      (Triplet)                 : 0.121649

== Recognize ==
Train average loss Recognize     : 2.175085
Train average accuracy drums     : 49.399998 %
Train average accuracy bass      : 50.015003 %
Train average accuracy piano     : 49.579998 %
Train average accuracy guitar    : 50.680000 %
Train average accuracy residuals : 50.209999 %

== Train average loss all : 0.121649

Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.094, Train/loss_unet_all_step=0.702, Train/loss_triplet_all_step=0.094, Train/loss_recog_step=2.130, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]          Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.094, Train/loss_unet_all_step=0.702, Train/loss_triplet_all_step=0.094, Train/loss_recog_step=2.130, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]Epoch 16:  16%|█▌        | 50/313 [00:44<03:52,  1.13it/s, v_num=0, Train/loss_all_step=0.094, Train/loss_unet_all_step=0.702, Train/loss_triplet_all_step=0.094, Train/loss_recog_step=2.130, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]Epoch 16:  16%|█▌        | 50/313 [00:44<03:52,  1.13it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=2.090, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]Epoch 16:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=2.090, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]Epoch 16:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=2.090, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]Epoch 16:  48%|████▊     | 150/313 [02:04<02:15,  1.21it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=2.090, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]Epoch 16:  48%|████▊     | 150/313 [02:04<02:15,  1.21it/s, v_num=0, Train/loss_all_step=0.0954, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.0954, Train/loss_recog_step=2.270, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]Epoch 16:  64%|██████▍   | 200/313 [02:43<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.0954, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.0954, Train/loss_recog_step=2.270, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]Epoch 16:  64%|██████▍   | 200/313 [02:43<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=2.120, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]  Epoch 16:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=2.120, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]Epoch 16:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.0906, Train/loss_unet_all_step=0.689, Train/loss_triplet_all_step=0.0906, Train/loss_recog_step=2.290, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]Epoch 16:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.0906, Train/loss_unet_all_step=0.689, Train/loss_triplet_all_step=0.0906, Train/loss_recog_step=2.290, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]Epoch 16:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.697, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=2.490, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]  Epoch 16: 100%|██████████| 313/313 [04:09<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.697, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=2.490, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]Epoch 16: 100%|██████████| 313/313 [04:09<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.0549, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0549, Train/loss_recog_step=2.480, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.650, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.696, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.426, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 17.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 14.13it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 17.24it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.65it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 13.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175841, 0.175618, 0.181920, 0.171410
Valid average loss UNet                 (all)                : 0.704789

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.125279, 0.352056, 0.726869
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.137340, 0.229945, 0.252258
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.200214, 0.540439, 0.597054
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.128767, 0.473850, 0.667707
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.128707, 0.600141, 0.771812
Valid average loss all      (Triplet)                 : 0.146567

== Recognize ==
Valid average loss Recognize     : 2.240557
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.146567

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.831258773803711 sec. =
Valid knn accuracy drums     : 68.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5244152545928955 sec. =
Valid knn accuracy bass      : 16.733870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.503737926483154 sec. =
Valid knn accuracy piano     : 29.4921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.65883731842041 sec. =
Valid knn accuracy guitar    : 43.080357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.467750310897827 sec. =
Valid knn accuracy residuals : 67.27272727272727%

Valid knn accuracy average   : 45.054959011447885%

                                                                      [AEpoch 16: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0549, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0549, Train/loss_recog_step=2.480, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.180]Epoch 16: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0549, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0549, Train/loss_recog_step=2.480, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179674, 0.178642, 0.180529, 0.183011
Train average loss UNet                 (all)                : 0.721855

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.057158, 0.340075, 0.820761
Train average loss bass     (Triplet, dist_p, dist_n) : 0.158250, 0.337414, 0.411239
Train average loss piano    (Triplet, dist_p, dist_n) : 0.138393, 0.422499, 0.537463
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.136066, 0.398717, 0.525279
Train average loss residuals(Triplet, dist_p, dist_n) : 0.094187, 0.501710, 0.745370
Train average loss all      (Triplet)                 : 0.118092

== Recognize ==
Train average loss Recognize     : 2.224865
Train average accuracy drums     : 50.355000 %
Train average accuracy bass      : 50.365002 %
Train average accuracy piano     : 50.089996 %
Train average accuracy guitar    : 50.414997 %
Train average accuracy residuals : 49.535000 %

== Train average loss all : 0.118092

Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0549, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0549, Train/loss_recog_step=2.480, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]          Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0549, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0549, Train/loss_recog_step=2.480, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]Epoch 17:  16%|█▌        | 50/313 [00:44<03:56,  1.11it/s, v_num=0, Train/loss_all_step=0.0549, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0549, Train/loss_recog_step=2.480, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]Epoch 17:  16%|█▌        | 50/313 [00:44<03:56,  1.11it/s, v_num=0, Train/loss_all_step=0.0818, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0818, Train/loss_recog_step=2.110, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]Epoch 17:  32%|███▏      | 100/313 [01:24<02:59,  1.19it/s, v_num=0, Train/loss_all_step=0.0818, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0818, Train/loss_recog_step=2.110, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]Epoch 17:  32%|███▏      | 100/313 [01:24<02:59,  1.19it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=2.250, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]  Epoch 17:  48%|████▊     | 150/313 [02:03<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=2.250, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]Epoch 17:  48%|████▊     | 150/313 [02:03<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.0973, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.0973, Train/loss_recog_step=2.270, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]Epoch 17:  64%|██████▍   | 200/313 [02:43<01:32,  1.23it/s, v_num=0, Train/loss_all_step=0.0973, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.0973, Train/loss_recog_step=2.270, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]Epoch 17:  64%|██████▍   | 200/313 [02:43<01:32,  1.23it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=2.300, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]  Epoch 17:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=2.300, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]Epoch 17:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=2.190, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]Epoch 17:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=2.190, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]Epoch 17:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=2.240, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]Epoch 17: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=2.240, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]Epoch 17: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=2.240, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.280, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.451, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 19.42it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 17.50it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 15.41it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.27it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 16.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.176197, 0.175909, 0.182436, 0.174646
Valid average loss UNet                 (all)                : 0.709189

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.135246, 0.356143, 0.702606
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.175337, 0.296017, 0.277419
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.205449, 0.615205, 0.690619
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.151953, 0.514500, 0.639042
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.147961, 0.731897, 0.883922
Valid average loss all      (Triplet)                 : 0.173767

== Recognize ==
Valid average loss Recognize     : 2.263732
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.173767

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.7431321144104 sec. =
Valid knn accuracy drums     : 67.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.25235629081726 sec. =
Valid knn accuracy bass      : 16.33064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5464019775390625 sec. =
Valid knn accuracy piano     : 31.4453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.643754243850708 sec. =
Valid knn accuracy guitar    : 44.419642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.5128819942474365 sec. =
Valid knn accuracy residuals : 66.5909090909091%

Valid knn accuracy average   : 45.23556279143367%

                                                                      [AEpoch 17: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=2.240, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.220]Epoch 17: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=2.240, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179696, 0.178667, 0.180556, 0.183721
Train average loss UNet                 (all)                : 0.722640

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.055466, 0.369898, 0.870515
Train average loss bass     (Triplet, dist_p, dist_n) : 0.150526, 0.373925, 0.462978
Train average loss piano    (Triplet, dist_p, dist_n) : 0.133151, 0.465449, 0.593520
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.128960, 0.436729, 0.581899
Train average loss residuals(Triplet, dist_p, dist_n) : 0.089651, 0.537047, 0.799431
Train average loss all      (Triplet)                 : 0.112617

== Recognize ==
Train average loss Recognize     : 2.246037
Train average accuracy drums     : 50.360001 %
Train average accuracy bass      : 49.759998 %
Train average accuracy piano     : 50.185001 %
Train average accuracy guitar    : 50.120003 %
Train average accuracy residuals : 49.884998 %

== Train average loss all : 0.112617

Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=2.240, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]          Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=2.240, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]Epoch 18:  16%|█▌        | 50/313 [00:45<04:00,  1.10it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=2.240, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]Epoch 18:  16%|█▌        | 50/313 [00:45<04:00,  1.10it/s, v_num=0, Train/loss_all_step=0.0894, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.0894, Train/loss_recog_step=2.200, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]Epoch 18:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.0894, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.0894, Train/loss_recog_step=2.200, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]Epoch 18:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=2.430, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]  Epoch 18:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=2.430, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]Epoch 18:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.0915, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.0915, Train/loss_recog_step=2.360, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]Epoch 18:  64%|██████▍   | 200/313 [02:43<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.0915, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.0915, Train/loss_recog_step=2.360, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]Epoch 18:  64%|██████▍   | 200/313 [02:43<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=2.180, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]  Epoch 18:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=2.180, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]Epoch 18:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.698, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=2.390, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]Epoch 18:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.698, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=2.390, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]Epoch 18:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=2.110, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]Epoch 18: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=2.110, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]Epoch 18: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.0406, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0406, Train/loss_recog_step=2.550, Valid/loss_all_step=0.202, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.174, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.452, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.01it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 17.35it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 16.39it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 17.43it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 16.02it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 17.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175961, 0.175671, 0.182215, 0.164008
Valid average loss UNet                 (all)                : 0.697855

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.174486, 0.381598, 0.699278
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.166278, 0.328785, 0.331196
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.221999, 0.689691, 0.716841
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.151532, 0.551767, 0.710162
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.168955, 0.779848, 0.923594
Valid average loss all      (Triplet)                 : 0.178783

== Recognize ==
Valid average loss Recognize     : 2.279756
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.178783

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.841778516769409 sec. =
Valid knn accuracy drums     : 72.60869565217392%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.195493698120117 sec. =
Valid knn accuracy bass      : 18.14516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.434539794921875 sec. =
Valid knn accuracy piano     : 28.90625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.676332473754883 sec. =
Valid knn accuracy guitar    : 45.089285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.583174467086792 sec. =
Valid knn accuracy residuals : 60.0%

Valid knn accuracy average   : 44.94987853135644%

                                                                      [AEpoch 18: 100%|██████████| 313/313 [05:05<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0406, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0406, Train/loss_recog_step=2.550, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.250]Epoch 18: 100%|██████████| 313/313 [05:05<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0406, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0406, Train/loss_recog_step=2.550, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179792, 0.178743, 0.180642, 0.183665
Train average loss UNet                 (all)                : 0.722843

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.053051, 0.413335, 0.951878
Train average loss bass     (Triplet, dist_p, dist_n) : 0.144356, 0.412238, 0.514860
Train average loss piano    (Triplet, dist_p, dist_n) : 0.125109, 0.505339, 0.653131
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.121553, 0.471933, 0.635078
Train average loss residuals(Triplet, dist_p, dist_n) : 0.083729, 0.584715, 0.873210
Train average loss all      (Triplet)                 : 0.106840

== Recognize ==
Train average loss Recognize     : 2.368670
Train average accuracy drums     : 50.370003 %
Train average accuracy bass      : 50.190002 %
Train average accuracy piano     : 49.520000 %
Train average accuracy guitar    : 50.360001 %
Train average accuracy residuals : 49.669998 %

== Train average loss all : 0.106840

Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0406, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0406, Train/loss_recog_step=2.550, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]          Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0406, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0406, Train/loss_recog_step=2.550, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]Epoch 19:  16%|█▌        | 50/313 [00:42<03:43,  1.18it/s, v_num=0, Train/loss_all_step=0.0406, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0406, Train/loss_recog_step=2.550, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]Epoch 19:  16%|█▌        | 50/313 [00:42<03:43,  1.18it/s, v_num=0, Train/loss_all_step=0.0841, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0841, Train/loss_recog_step=2.550, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]Epoch 19:  32%|███▏      | 100/313 [01:20<02:52,  1.24it/s, v_num=0, Train/loss_all_step=0.0841, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.0841, Train/loss_recog_step=2.550, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]Epoch 19:  32%|███▏      | 100/313 [01:20<02:52,  1.24it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.729, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=2.420, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]  Epoch 19:  48%|████▊     | 150/313 [01:59<02:09,  1.25it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.729, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=2.420, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]Epoch 19:  48%|████▊     | 150/313 [01:59<02:09,  1.25it/s, v_num=0, Train/loss_all_step=0.0813, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.0813, Train/loss_recog_step=2.500, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]Epoch 19:  64%|██████▍   | 200/313 [02:38<01:29,  1.26it/s, v_num=0, Train/loss_all_step=0.0813, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.0813, Train/loss_recog_step=2.500, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]Epoch 19:  64%|██████▍   | 200/313 [02:38<01:29,  1.26it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=2.680, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]  Epoch 19:  80%|███████▉  | 250/313 [03:16<00:49,  1.27it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=2.680, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]Epoch 19:  80%|███████▉  | 250/313 [03:16<00:49,  1.27it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.691, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=2.600, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]Epoch 19:  96%|█████████▌| 300/313 [03:55<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.691, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=2.600, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]Epoch 19:  96%|█████████▌| 300/313 [03:55<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.708, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=2.470, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]Epoch 19: 100%|██████████| 313/313 [04:03<00:00,  1.29it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.708, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=2.470, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]Epoch 19: 100%|██████████| 313/313 [04:03<00:00,  1.29it/s, v_num=0, Train/loss_all_step=0.0424, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.0424, Train/loss_recog_step=2.340, Valid/loss_all_step=0.191, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.698, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.280, Valid/knn_avr=0.449, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.64it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 18.84it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 17.42it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 16.09it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.04it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 14.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.176811, 0.176521, 0.183086, 0.176156
Valid average loss UNet                 (all)                : 0.712573

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.114685, 0.455539, 0.937665
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.160321, 0.321200, 0.336141
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.173609, 0.630214, 0.717601
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.163966, 0.577840, 0.717100
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.157976, 0.735408, 0.886694
Valid average loss all      (Triplet)                 : 0.159881

== Recognize ==
Valid average loss Recognize     : 2.300245
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.159881

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.366429567337036 sec. =
Valid knn accuracy drums     : 70.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.264492750167847 sec. =
Valid knn accuracy bass      : 14.717741935483872%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.427934646606445 sec. =
Valid knn accuracy piano     : 26.5625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.598344087600708 sec. =
Valid knn accuracy guitar    : 44.19642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.1128199100494385 sec. =
Valid knn accuracy residuals : 61.59090909090909%

Valid knn accuracy average   : 43.4135159195643%

                                                                      [AEpoch 19: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0424, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.0424, Train/loss_recog_step=2.340, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.370]Epoch 19: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0424, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.0424, Train/loss_recog_step=2.340, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179842, 0.178818, 0.180718, 0.183802
Train average loss UNet                 (all)                : 0.723179

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.052772, 0.444824, 1.004056
Train average loss bass     (Triplet, dist_p, dist_n) : 0.136811, 0.453411, 0.575525
Train average loss piano    (Triplet, dist_p, dist_n) : 0.119906, 0.531640, 0.694958
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.114964, 0.510285, 0.693055
Train average loss residuals(Triplet, dist_p, dist_n) : 0.080849, 0.615586, 0.921986
Train average loss all      (Triplet)                 : 0.102027

== Recognize ==
Train average loss Recognize     : 2.438926
Train average accuracy drums     : 49.755001 %
Train average accuracy bass      : 50.160004 %
Train average accuracy piano     : 49.860001 %
Train average accuracy guitar    : 49.945000 %
Train average accuracy residuals : 50.054996 %

== Train average loss all : 0.102027

Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0424, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.0424, Train/loss_recog_step=2.340, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]          Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0424, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.0424, Train/loss_recog_step=2.340, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]Epoch 20:  16%|█▌        | 50/313 [00:44<03:51,  1.14it/s, v_num=0, Train/loss_all_step=0.0424, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.0424, Train/loss_recog_step=2.340, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]Epoch 20:  16%|█▌        | 50/313 [00:44<03:51,  1.14it/s, v_num=0, Train/loss_all_step=0.0702, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.0702, Train/loss_recog_step=2.330, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]Epoch 20:  32%|███▏      | 100/313 [01:24<02:59,  1.19it/s, v_num=0, Train/loss_all_step=0.0702, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.0702, Train/loss_recog_step=2.330, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]Epoch 20:  32%|███▏      | 100/313 [01:24<02:59,  1.19it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=2.460, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]  Epoch 20:  48%|████▊     | 150/313 [02:03<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=2.460, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]Epoch 20:  48%|████▊     | 150/313 [02:03<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.0818, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.0818, Train/loss_recog_step=2.490, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]Epoch 20:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.0818, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.0818, Train/loss_recog_step=2.490, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]Epoch 20:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.0963, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0963, Train/loss_recog_step=2.500, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]Epoch 20:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.0963, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0963, Train/loss_recog_step=2.500, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]Epoch 20:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.0886, Train/loss_unet_all_step=0.703, Train/loss_triplet_all_step=0.0886, Train/loss_recog_step=2.410, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]Epoch 20:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.0886, Train/loss_unet_all_step=0.703, Train/loss_triplet_all_step=0.0886, Train/loss_recog_step=2.410, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]Epoch 20:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.0858, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.0858, Train/loss_recog_step=2.280, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]Epoch 20: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.0858, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.0858, Train/loss_recog_step=2.280, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]Epoch 20: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.708, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=2.340, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.683, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.713, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.434, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 19.25it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 18.90it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 18.51it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.49it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 17.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.176713, 0.176406, 0.183050, 0.157028
Valid average loss UNet                 (all)                : 0.693196

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.096282, 0.429722, 0.947587
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.168295, 0.365248, 0.379793
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.280723, 0.841245, 0.832929
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.155478, 0.656773, 0.823377
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.131184, 0.827367, 1.095752
Valid average loss all      (Triplet)                 : 0.178132

== Recognize ==
Valid average loss Recognize     : 2.623046
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 43.000000 %

== Valid average loss all : 0.178132

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.898401260375977 sec. =
Valid knn accuracy drums     : 68.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.231841564178467 sec. =
Valid knn accuracy bass      : 15.725806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.559369325637817 sec. =
Valid knn accuracy piano     : 27.1484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.633701324462891 sec. =
Valid knn accuracy guitar    : 45.982142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.304463148117065 sec. =
Valid knn accuracy residuals : 63.40909090909091%

Valid knn accuracy average   : 44.19222597835194%

                                                                      [AEpoch 20: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.708, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=2.340, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.102, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=2.440]Epoch 20: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.708, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=2.340, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179894, 0.178845, 0.180744, 0.183200
Train average loss UNet                 (all)                : 0.722683

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.050739, 0.464047, 1.040546
Train average loss bass     (Triplet, dist_p, dist_n) : 0.128884, 0.478638, 0.616598
Train average loss piano    (Triplet, dist_p, dist_n) : 0.113929, 0.556434, 0.732588
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.109249, 0.544755, 0.739563
Train average loss residuals(Triplet, dist_p, dist_n) : 0.075111, 0.633676, 0.950765
Train average loss all      (Triplet)                 : 0.096489

== Recognize ==
Train average loss Recognize     : 2.466497
Train average accuracy drums     : 49.630001 %
Train average accuracy bass      : 49.570000 %
Train average accuracy piano     : 50.664997 %
Train average accuracy guitar    : 50.809998 %
Train average accuracy residuals : 49.855000 %

== Train average loss all : 0.096489

Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.708, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=2.340, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]          Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.708, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=2.340, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]Epoch 21:  16%|█▌        | 50/313 [00:43<03:50,  1.14it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.708, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=2.340, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]Epoch 21:  16%|█▌        | 50/313 [00:43<03:50,  1.14it/s, v_num=0, Train/loss_all_step=0.0722, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.0722, Train/loss_recog_step=2.420, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]Epoch 21:  32%|███▏      | 100/313 [01:22<02:55,  1.21it/s, v_num=0, Train/loss_all_step=0.0722, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.0722, Train/loss_recog_step=2.420, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]Epoch 21:  32%|███▏      | 100/313 [01:22<02:55,  1.21it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=2.600, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]  Epoch 21:  48%|████▊     | 150/313 [02:01<02:11,  1.24it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=2.600, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]Epoch 21:  48%|████▊     | 150/313 [02:01<02:11,  1.24it/s, v_num=0, Train/loss_all_step=0.0563, Train/loss_unet_all_step=0.727, Train/loss_triplet_all_step=0.0563, Train/loss_recog_step=2.330, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]Epoch 21:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.0563, Train/loss_unet_all_step=0.727, Train/loss_triplet_all_step=0.0563, Train/loss_recog_step=2.330, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]Epoch 21:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.0733, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0733, Train/loss_recog_step=2.270, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]Epoch 21:  80%|███████▉  | 250/313 [03:19<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.0733, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0733, Train/loss_recog_step=2.270, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]Epoch 21:  80%|███████▉  | 250/313 [03:19<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.0654, Train/loss_unet_all_step=0.679, Train/loss_triplet_all_step=0.0654, Train/loss_recog_step=2.710, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]Epoch 21:  96%|█████████▌| 300/313 [03:58<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.0654, Train/loss_unet_all_step=0.679, Train/loss_triplet_all_step=0.0654, Train/loss_recog_step=2.710, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]Epoch 21:  96%|█████████▌| 300/313 [03:58<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.0848, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.0848, Train/loss_recog_step=2.380, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]Epoch 21: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.0848, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.0848, Train/loss_recog_step=2.380, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]Epoch 21: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.0225, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.0225, Train/loss_recog_step=2.890, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.656, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.178, Valid/loss_unet_all_epoch=0.693, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 18.11it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 18.43it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 16.90it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.40it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 15.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.176816, 0.176539, 0.183101, 0.169932
Valid average loss UNet                 (all)                : 0.706388

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.160237, 0.437967, 0.766467
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.148722, 0.363197, 0.394794
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.232515, 0.769436, 0.805850
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.207574, 0.685266, 0.815942
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.160264, 0.880739, 1.118816
Valid average loss all      (Triplet)                 : 0.187346

== Recognize ==
Valid average loss Recognize     : 2.595347
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 42.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.187346

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.975591421127319 sec. =
Valid knn accuracy drums     : 65.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.457088470458984 sec. =
Valid knn accuracy bass      : 15.120967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.497897148132324 sec. =
Valid knn accuracy piano     : 31.4453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.573976516723633 sec. =
Valid knn accuracy guitar    : 39.285714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.739169597625732 sec. =
Valid knn accuracy residuals : 60.22727272727273%

Valid knn accuracy average   : 42.25933171185407%

                                                                      [AEpoch 21: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0225, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.0225, Train/loss_recog_step=2.890, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.0965, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0965, Train/loss_recog_epoch=2.470]Epoch 21: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0225, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.0225, Train/loss_recog_step=2.890, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179952, 0.178913, 0.180823, 0.183576
Train average loss UNet                 (all)                : 0.723263

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.046993, 0.511141, 1.119353
Train average loss bass     (Triplet, dist_p, dist_n) : 0.121394, 0.536259, 0.700444
Train average loss piano    (Triplet, dist_p, dist_n) : 0.102047, 0.613690, 0.822091
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.099767, 0.598437, 0.824133
Train average loss residuals(Triplet, dist_p, dist_n) : 0.069605, 0.702540, 1.053540
Train average loss all      (Triplet)                 : 0.089030

== Recognize ==
Train average loss Recognize     : 2.465753
Train average accuracy drums     : 49.474998 %
Train average accuracy bass      : 50.515003 %
Train average accuracy piano     : 50.414997 %
Train average accuracy guitar    : 49.610001 %
Train average accuracy residuals : 50.300003 %

== Train average loss all : 0.089030

Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0225, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.0225, Train/loss_recog_step=2.890, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]          Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0225, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.0225, Train/loss_recog_step=2.890, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]Epoch 22:  16%|█▌        | 50/313 [00:44<03:52,  1.13it/s, v_num=0, Train/loss_all_step=0.0225, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.0225, Train/loss_recog_step=2.890, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]Epoch 22:  16%|█▌        | 50/313 [00:44<03:52,  1.13it/s, v_num=0, Train/loss_all_step=0.0711, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.0711, Train/loss_recog_step=2.280, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]Epoch 22:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.0711, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.0711, Train/loss_recog_step=2.280, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]Epoch 22:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=2.480, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]  Epoch 22:  48%|████▊     | 150/313 [02:03<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=2.480, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]Epoch 22:  48%|████▊     | 150/313 [02:03<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.0309, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=2.730, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]Epoch 22:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.0309, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=2.730, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]Epoch 22:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.0793, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0793, Train/loss_recog_step=2.500, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]Epoch 22:  80%|███████▉  | 250/313 [03:20<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.0793, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0793, Train/loss_recog_step=2.500, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]Epoch 22:  80%|███████▉  | 250/313 [03:20<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.0686, Train/loss_unet_all_step=0.674, Train/loss_triplet_all_step=0.0686, Train/loss_recog_step=2.880, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]Epoch 22:  96%|█████████▌| 300/313 [03:58<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.0686, Train/loss_unet_all_step=0.674, Train/loss_triplet_all_step=0.0686, Train/loss_recog_step=2.880, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]Epoch 22:  96%|█████████▌| 300/313 [03:58<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.0804, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.0804, Train/loss_recog_step=2.700, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]Epoch 22: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.0804, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.0804, Train/loss_recog_step=2.700, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]Epoch 22: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=2.660, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 18.70it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 15.57it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 18.47it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 13.86it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 18.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.176887, 0.176523, 0.183140, 0.168504
Valid average loss UNet                 (all)                : 0.705055

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.080601, 0.436743, 0.876048
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.167079, 0.405261, 0.421865
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.204605, 0.805418, 0.884148
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.237742, 0.707151, 0.827365
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.164464, 0.920633, 1.099687
Valid average loss all      (Triplet)                 : 0.175533

== Recognize ==
Valid average loss Recognize     : 2.801407
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.175533

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.860063076019287 sec. =
Valid knn accuracy drums     : 64.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.233763933181763 sec. =
Valid knn accuracy bass      : 18.548387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.793776512145996 sec. =
Valid knn accuracy piano     : 30.46875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.657003879547119 sec. =
Valid knn accuracy guitar    : 42.857142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.54149055480957 sec. =
Valid knn accuracy residuals : 59.09090909090909%

Valid knn accuracy average   : 43.062603026356534%

                                                                      [AEpoch 22: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=2.660, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.089, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.089, Train/loss_recog_epoch=2.470]Epoch 22: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=2.660, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179965, 0.178907, 0.180821, 0.183220
Train average loss UNet                 (all)                : 0.722913

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.044456, 0.535061, 1.145684
Train average loss bass     (Triplet, dist_p, dist_n) : 0.113011, 0.577078, 0.761117
Train average loss piano    (Triplet, dist_p, dist_n) : 0.098505, 0.654130, 0.884350
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.094622, 0.646322, 0.896229
Train average loss residuals(Triplet, dist_p, dist_n) : 0.065273, 0.744937, 1.109749
Train average loss all      (Triplet)                 : 0.084194

== Recognize ==
Train average loss Recognize     : 2.572705
Train average accuracy drums     : 50.524998 %
Train average accuracy bass      : 50.089996 %
Train average accuracy piano     : 49.470001 %
Train average accuracy guitar    : 49.840000 %
Train average accuracy residuals : 49.514999 %

== Train average loss all : 0.084194

Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=2.660, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]          Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=2.660, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]Epoch 23:  16%|█▌        | 50/313 [00:43<03:48,  1.15it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=2.660, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]Epoch 23:  16%|█▌        | 50/313 [00:43<03:48,  1.15it/s, v_num=0, Train/loss_all_step=0.060, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.060, Train/loss_recog_step=2.670, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]  Epoch 23:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.060, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.060, Train/loss_recog_step=2.670, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]Epoch 23:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.0983, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.0983, Train/loss_recog_step=2.880, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]Epoch 23:  48%|████▊     | 150/313 [02:01<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.0983, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.0983, Train/loss_recog_step=2.880, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]Epoch 23:  48%|████▊     | 150/313 [02:01<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.0559, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.0559, Train/loss_recog_step=2.240, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]Epoch 23:  64%|██████▍   | 200/313 [02:40<01:30,  1.24it/s, v_num=0, Train/loss_all_step=0.0559, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.0559, Train/loss_recog_step=2.240, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]Epoch 23:  64%|██████▍   | 200/313 [02:40<01:30,  1.24it/s, v_num=0, Train/loss_all_step=0.0714, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0714, Train/loss_recog_step=2.560, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]Epoch 23:  80%|███████▉  | 250/313 [03:19<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.0714, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0714, Train/loss_recog_step=2.560, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]Epoch 23:  80%|███████▉  | 250/313 [03:19<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.0971, Train/loss_unet_all_step=0.698, Train/loss_triplet_all_step=0.0971, Train/loss_recog_step=2.600, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]Epoch 23:  96%|█████████▌| 300/313 [03:58<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.0971, Train/loss_unet_all_step=0.698, Train/loss_triplet_all_step=0.0971, Train/loss_recog_step=2.600, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]Epoch 23:  96%|█████████▌| 300/313 [03:58<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.0789, Train/loss_unet_all_step=0.699, Train/loss_triplet_all_step=0.0789, Train/loss_recog_step=2.610, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]Epoch 23: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.0789, Train/loss_unet_all_step=0.699, Train/loss_triplet_all_step=0.0789, Train/loss_recog_step=2.610, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]Epoch 23: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=2.370, Valid/loss_all_step=0.134, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=2.800, Valid/knn_avr=0.431, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.91it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 16.68it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 19.30it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 18.85it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 17.81it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 17.11it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.176749, 0.176444, 0.183141, 0.169454
Valid average loss UNet                 (all)                : 0.705787

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.189010, 0.566939, 0.925773
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.183168, 0.513247, 0.523999
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.239163, 0.965568, 1.031713
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.249235, 0.855633, 0.944457
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.220181, 1.060075, 1.238815
Valid average loss all      (Triplet)                 : 0.224747

== Recognize ==
Valid average loss Recognize     : 2.619762
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.224747

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.9447314739227295 sec. =
Valid knn accuracy drums     : 67.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.307193040847778 sec. =
Valid knn accuracy bass      : 16.93548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.712852954864502 sec. =
Valid knn accuracy piano     : 33.203125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.643020153045654 sec. =
Valid knn accuracy guitar    : 40.17857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.360660552978516 sec. =
Valid knn accuracy residuals : 62.272727272727266%

Valid knn accuracy average   : 44.03972064488807%

                                                                      [AEpoch 23: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=2.370, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.0842, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0842, Train/loss_recog_epoch=2.570]Epoch 23: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=2.370, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.180214, 0.179175, 0.181095, 0.183557
Train average loss UNet                 (all)                : 0.724041

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.040416, 0.593815, 1.255446
Train average loss bass     (Triplet, dist_p, dist_n) : 0.103660, 0.644143, 0.859205
Train average loss piano    (Triplet, dist_p, dist_n) : 0.089036, 0.733092, 0.999214
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.084683, 0.724046, 1.008469
Train average loss residuals(Triplet, dist_p, dist_n) : 0.057523, 0.834132, 1.244635
Train average loss all      (Triplet)                 : 0.076046

== Recognize ==
Train average loss Recognize     : 2.593022
Train average accuracy drums     : 50.389999 %
Train average accuracy bass      : 50.314999 %
Train average accuracy piano     : 50.204998 %
Train average accuracy guitar    : 49.739998 %
Train average accuracy residuals : 49.759998 %

== Train average loss all : 0.076046

Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=2.370, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]          Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=2.370, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]Epoch 24:  16%|█▌        | 50/313 [00:43<03:50,  1.14it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=2.370, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]Epoch 24:  16%|█▌        | 50/313 [00:43<03:50,  1.14it/s, v_num=0, Train/loss_all_step=0.0574, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.0574, Train/loss_recog_step=2.520, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]Epoch 24:  32%|███▏      | 100/313 [01:22<02:56,  1.21it/s, v_num=0, Train/loss_all_step=0.0574, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.0574, Train/loss_recog_step=2.520, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]Epoch 24:  32%|███▏      | 100/313 [01:22<02:56,  1.21it/s, v_num=0, Train/loss_all_step=0.0901, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.0901, Train/loss_recog_step=2.550, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]Epoch 24:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.0901, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.0901, Train/loss_recog_step=2.550, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]Epoch 24:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.0487, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0487, Train/loss_recog_step=2.460, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]Epoch 24:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.0487, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0487, Train/loss_recog_step=2.460, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]Epoch 24:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.0932, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0932, Train/loss_recog_step=2.590, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]Epoch 24:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.0932, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0932, Train/loss_recog_step=2.590, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]Epoch 24:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.0623, Train/loss_unet_all_step=0.694, Train/loss_triplet_all_step=0.0623, Train/loss_recog_step=2.840, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]Epoch 24:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.0623, Train/loss_unet_all_step=0.694, Train/loss_triplet_all_step=0.0623, Train/loss_recog_step=2.840, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]Epoch 24:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.0799, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.0799, Train/loss_recog_step=2.800, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]Epoch 24: 100%|██████████| 313/313 [04:07<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.0799, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.0799, Train/loss_recog_step=2.800, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]Epoch 24: 100%|██████████| 313/313 [04:07<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.029, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=2.340, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.679, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=2.500, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.225, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.440, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 15.94it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 19.11it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 17.89it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 16.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 13.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.177177, 0.176680, 0.183648, 0.170831
Valid average loss UNet                 (all)                : 0.708336

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.096542, 0.636234, 1.067855
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.145217, 0.543241, 0.607129
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.188257, 1.042017, 1.157433
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.301474, 1.012609, 1.107678
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.175765, 1.103693, 1.476222
Valid average loss all      (Triplet)                 : 0.187096

== Recognize ==
Valid average loss Recognize     : 2.771549
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.187096

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.9611124992370605 sec. =
Valid knn accuracy drums     : 63.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.216840505599976 sec. =
Valid knn accuracy bass      : 20.967741935483872%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.673248767852783 sec. =
Valid knn accuracy piano     : 34.375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.610715389251709 sec. =
Valid knn accuracy guitar    : 35.49107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.39679741859436 sec. =
Valid knn accuracy residuals : 62.727272727272734%

Valid knn accuracy average   : 43.36439113130909%

                                                                      [AEpoch 24: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.029, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=2.340, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=2.860, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.076, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.076, Train/loss_recog_epoch=2.590]Epoch 24: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.029, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=2.340, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=2.860, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.071, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.071, Train/loss_recog_epoch=2.660]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.180525, 0.179469, 0.181368, 0.183321
Train average loss UNet                 (all)                : 0.724682

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.040593, 0.666090, 1.356899
Train average loss bass     (Triplet, dist_p, dist_n) : 0.096873, 0.701277, 0.941528
Train average loss piano    (Triplet, dist_p, dist_n) : 0.082418, 0.816396, 1.115923
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.078426, 0.791684, 1.107105
Train average loss residuals(Triplet, dist_p, dist_n) : 0.054888, 0.909723, 1.356153
Train average loss all      (Triplet)                 : 0.071037

== Recognize ==
Train average loss Recognize     : 2.657361
Train average accuracy drums     : 50.424999 %
Train average accuracy bass      : 50.760002 %
Train average accuracy piano     : 49.910000 %
Train average accuracy guitar    : 50.515003 %
Train average accuracy residuals : 49.389999 %

== Train average loss all : 0.071037

Epoch 24: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.029, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=2.340, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=2.860, Valid/loss_all_epoch=0.187, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=2.770, Valid/knn_avr=0.434, Train/loss_all_epoch=0.071, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.071, Train/loss_recog_epoch=2.660]
[2023-11-05 08:28:07,236][source.train][INFO] - [rank: 0] Starting testing!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
The length of seg for train is 3s.
The length of seg for valid and test is 3s.
----------------------------------------
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s][2023-11-05 08:28:10,891][utils.utils][ERROR] - [rank: 0] 
Traceback (most recent call last):
  File "/nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/utils/utils.py", line 68, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/source/train.py", line 102, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 755, in test
    return call._call_and_handle_interrupt(
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 795, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _run
    results = self._run_stage()
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1029, in _run_stage
    return self._evaluation_loop.run()
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/loops/utilities.py", line 181, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 134, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 391, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 416, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
  File "/nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/model/triplet/triplet.py", line 458, in test_step
    and self.n_sound < 5):
IndexError: too many indices for tensor of dimension 1
[2023-11-05 08:28:10,897][utils.utils][INFO] - [rank: 0] Output dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023-11-05/06-21-20
Testing DataLoader 0:   0%|          | 0/16 [00:01<?, ?it/s]
