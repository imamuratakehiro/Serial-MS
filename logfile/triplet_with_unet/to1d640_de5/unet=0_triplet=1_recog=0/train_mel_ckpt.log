
=== Using cuda(utils.func). ===

[2023-11-07 09:28:58,782][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-07 09:28:58,788][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 5.0e-05                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640                         
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: true                                                             
│         n_mels: 259                                                           
│       ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-11
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 5.0e-05                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/knn_avr                                                
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: 5                                                         
│         mode: max                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/knn_avr                                                
│         min_delta: 0.0                                                        
│         patience: 50                                                          
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 400                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 400                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       load_using_librosa: false                                               
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_psd_train: 3                                                    
│       seconds_psd_valid: 10                                                   
│       seconds_psd_test: 10                                                    
│       offset_psd_train: 1.5                                                   
│       offset_psd_valid: 5.0                                                   
│       offset_psd_test: 10.0                                                   
│       seconds_triplet_train: 3                                                
│       seconds_triplet_valid: 3                                                
│       offset_triplet_train: 1.5                                               
│       offset_triplet_valid: 1.5                                               
│       seconds_c32_train: 3                                                    
│       seconds_c32_valid: 10                                                   
│       seconds_c32_test: 10                                                    
│       offset_c32_train: 1.5                                                   
│       offset_c32_valid: 5.0                                                   
│       offset_c32_test: 10.0                                                   
│       sr: 44100                                                               
│       mel: true                                                               
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640                             
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       lr: 5.0e-05                                                             
│       monitor_es: Valid/knn_avr                                               
│       monitor_mode_es: max                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 0                                                            
│       recog_rate: 0                                                           
│       test_psd_mine: false                                                    
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-07 09:28:58,874][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-07 09:28:58,893][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-07 09:29:03,466][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpgb4q22l5
[2023-11-07 09:29:03,467][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpgb4q22l5/_remote_module_non_scriptable.py
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=3200, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-07 09:29:06,044][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-07 09:29:06,044][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-07 09:29:06,050][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-07 09:29:06,052][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-07 09:29:06,053][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-07 09:29:06,053][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-07 09:29:06,109][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-07 09:29:06,534][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-07 09:29:06,928][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.6675524711608887 sec. *
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 1: 100%|██████████| 2/2 [00:00<00:00,  3.80it/s]Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 2: 100%|██████████| 2/2 [00:01<00:00,  1.11it/s]Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 3: 100%|██████████| 2/2 [00:00<00:00,  3.25it/s]Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 4: 100%|██████████| 2/2 [00:00<00:00,  4.83it/s]Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 5:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 5: 100%|██████████| 2/2 [00:01<00:00,  1.44it/s]

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.205168, 0.203525, 0.199812, 0.223891
Valid average loss UNet                 (all)                : 0.832395

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.145249, 0.148168, 0.204418
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.202464, 0.123607, 0.121143
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.179563, 0.267934, 0.298726
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.132588, 0.247400, 0.331514
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.121433, 0.396820, 0.496423
Valid average loss all      (Triplet)                 : 0.154896

== Recognize ==
Valid average loss Recognize     : 0.841027
Valid average accuracy drums     : 47.656250 %
Valid average accuracy bass      : 44.531250 %
Valid average accuracy piano     : 47.656250 %
Valid average accuracy guitar    : 45.312500 %
Valid average accuracy residuals : 49.218750 %

== Valid average loss all : 0.154896

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 3.043428421020508 sec. =
Valid knn accuracy drums     : 90.625%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.4684901237487793 sec. =
Valid knn accuracy bass      : 53.90625%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 3.070051908493042 sec. =
Valid knn accuracy piano     : 83.59375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.261512279510498 sec. =
Valid knn accuracy guitar    : 64.84375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.514744281768799 sec. =
Valid knn accuracy residuals : 100.0%

Valid knn accuracy average   : 78.59375%
                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [00:57<05:03,  0.87it/s]Epoch 0:  16%|█▌        | 50/313 [00:57<05:03,  0.87it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=0.650]Epoch 0:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=0.650]Epoch 0:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.649]Epoch 0:  48%|████▊     | 150/313 [02:23<02:35,  1.05it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.649]Epoch 0:  48%|████▊     | 150/313 [02:23<02:35,  1.05it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.614]Epoch 0:  64%|██████▍   | 200/313 [03:05<01:45,  1.08it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.614]Epoch 0:  64%|██████▍   | 200/313 [03:05<01:45,  1.08it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.629]Epoch 0:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.629]Epoch 0:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.626]Epoch 0:  96%|█████████▌| 300/313 [04:31<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.626]Epoch 0:  96%|█████████▌| 300/313 [04:31<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=0.642]Epoch 0: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=0.642]Epoch 0: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.646]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.99it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.66it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.08it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.33it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.16it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196016, 0.198447, 0.195332, 0.221806
Valid average loss UNet                 (all)                : 0.811601

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.030925, 0.371090, 0.730939
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.171810, 0.408563, 0.474420
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.146007, 0.500647, 0.580529
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.073729, 0.533124, 0.814431
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.086320, 0.717085, 0.926420
Valid average loss all      (Triplet)                 : 0.097466

== Recognize ==
Valid average loss Recognize     : 0.610422
Valid average accuracy drums     : 70.000000 %
Valid average accuracy bass      : 73.500000 %
Valid average accuracy piano     : 78.000000 %
Valid average accuracy guitar    : 85.000000 %
Valid average accuracy residuals : 92.500000 %

== Valid average loss all : 0.097466

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.803978443145752 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.437276363372803 sec. =
Valid knn accuracy bass      : 47.17741935483871%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.010831356048584 sec. =
Valid knn accuracy piano     : 69.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.003824472427368 sec. =
Valid knn accuracy guitar    : 72.32142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3346946239471436 sec. =
Valid knn accuracy residuals : 92.5%

Valid knn accuracy average   : 73.14093806351431%

                                                                      [AEpoch 0: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.646, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731]Epoch 0: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.646, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198915, 0.199377, 0.199373, 0.218942
Train average loss UNet                 (all)                : 0.816607

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.051490, 0.341049, 0.654657
Train average loss bass     (Triplet, dist_p, dist_n) : 0.158031, 0.367581, 0.444286
Train average loss piano    (Triplet, dist_p, dist_n) : 0.154184, 0.500451, 0.585920
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.129494, 0.509031, 0.656483
Train average loss residuals(Triplet, dist_p, dist_n) : 0.106060, 0.687483, 0.903803
Train average loss all      (Triplet)                 : 0.120692

== Recognize ==
Train average loss Recognize     : 0.640399
Train average accuracy drums     : 57.709999 %
Train average accuracy bass      : 54.615002 %
Train average accuracy piano     : 65.839996 %
Train average accuracy guitar    : 69.959999 %
Train average accuracy residuals : 81.415001 %

== Train average loss all : 0.120692

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.646, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.646, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.646, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.0705, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0705, Train/loss_recog_step=0.633, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.0705, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0705, Train/loss_recog_step=0.633, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.060, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.060, Train/loss_recog_step=0.636, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]  Epoch 1:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.060, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.060, Train/loss_recog_step=0.636, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.075, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.075, Train/loss_recog_step=0.657, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.075, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.075, Train/loss_recog_step=0.657, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.0758, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=0.678, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.0758, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=0.678, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.0775, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0775, Train/loss_recog_step=0.678, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0775, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0775, Train/loss_recog_step=0.678, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0611, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0611, Train/loss_recog_step=0.688, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0611, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0611, Train/loss_recog_step=0.688, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]Epoch 1: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0604, Train/loss_recog_step=0.693, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.0541, Valid/loss_recog_step=0.616, Valid/loss_all_epoch=0.0975, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.0975, Valid/loss_recog_epoch=0.610, Valid/knn_avr=0.731, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.80it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.11it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.81it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.08it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.66it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.41it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195953, 0.198375, 0.195294, 0.223146
Valid average loss UNet                 (all)                : 0.812767

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.031738, 0.549439, 0.949881
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.173711, 0.575423, 0.654099
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.173415, 0.737888, 0.809546
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.081310, 0.747738, 1.071303
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.086739, 0.962071, 1.209916
Valid average loss all      (Triplet)                 : 0.105207

== Recognize ==
Valid average loss Recognize     : 0.665525
Valid average accuracy drums     : 66.000000 %
Valid average accuracy bass      : 61.000000 %
Valid average accuracy piano     : 70.000000 %
Valid average accuracy guitar    : 70.000000 %
Valid average accuracy residuals : 80.500000 %

== Valid average loss all : 0.105207

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9221696853637695 sec. =
Valid knn accuracy drums     : 86.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.354135990142822 sec. =
Valid knn accuracy bass      : 50.201612903225815%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.68219804763794 sec. =
Valid knn accuracy piano     : 69.3359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.098379611968994 sec. =
Valid knn accuracy guitar    : 68.08035714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.241366624832153 sec. =
Valid knn accuracy residuals : 92.04545454545455%

Valid knn accuracy average   : 73.32397676613358%

                                                                      [AEpoch 1: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0604, Train/loss_recog_step=0.693, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.121, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.121, Train/loss_recog_epoch=0.640]  Epoch 1: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0604, Train/loss_recog_step=0.693, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198886, 0.199359, 0.199350, 0.218938
Train average loss UNet                 (all)                : 0.816533

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.022787, 0.464336, 0.934316
Train average loss bass     (Triplet, dist_p, dist_n) : 0.111459, 0.505626, 0.674224
Train average loss piano    (Triplet, dist_p, dist_n) : 0.101106, 0.638090, 0.820611
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.080451, 0.667474, 0.932297
Train average loss residuals(Triplet, dist_p, dist_n) : 0.062709, 0.866227, 1.211678
Train average loss all      (Triplet)                 : 0.076458

== Recognize ==
Train average loss Recognize     : 0.663272
Train average accuracy drums     : 65.665001 %
Train average accuracy bass      : 60.855000 %
Train average accuracy piano     : 67.669998 %
Train average accuracy guitar    : 72.129997 %
Train average accuracy residuals : 76.730003 %

== Train average loss all : 0.076458

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0604, Train/loss_recog_step=0.693, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0604, Train/loss_recog_step=0.693, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]Epoch 2:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0604, Train/loss_recog_step=0.693, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]Epoch 2:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.0347, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0347, Train/loss_recog_step=0.695, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]Epoch 2:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.0347, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0347, Train/loss_recog_step=0.695, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]Epoch 2:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.0461, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0461, Train/loss_recog_step=0.699, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]Epoch 2:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.0461, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0461, Train/loss_recog_step=0.699, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]Epoch 2:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.0432, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.0432, Train/loss_recog_step=0.711, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]Epoch 2:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.0432, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.0432, Train/loss_recog_step=0.711, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]Epoch 2:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.0414, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0414, Train/loss_recog_step=0.777, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]Epoch 2:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.0414, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0414, Train/loss_recog_step=0.777, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]Epoch 2:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.0392, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0392, Train/loss_recog_step=0.739, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]Epoch 2:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.0392, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0392, Train/loss_recog_step=0.739, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]Epoch 2:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.0367, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0367, Train/loss_recog_step=0.760, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]Epoch 2: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0367, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0367, Train/loss_recog_step=0.760, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]Epoch 2: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.699, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.0559, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.105, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.105, Valid/loss_recog_epoch=0.666, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.70it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.51it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.49it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.08it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.81it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196125, 0.198512, 0.195436, 0.211529
Valid average loss UNet                 (all)                : 0.801602

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.033014, 0.799746, 1.253089
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.170503, 0.782183, 0.870992
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.219759, 1.079535, 1.127975
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.088233, 1.040264, 1.400389
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.083814, 1.276145, 1.557846
Valid average loss all      (Triplet)                 : 0.116871

== Recognize ==
Valid average loss Recognize     : 0.756293
Valid average accuracy drums     : 42.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 44.000000 %

== Valid average loss all : 0.116871

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.170715093612671 sec. =
Valid knn accuracy drums     : 88.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.259113788604736 sec. =
Valid knn accuracy bass      : 48.185483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.129793167114258 sec. =
Valid knn accuracy piano     : 69.921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.555492639541626 sec. =
Valid knn accuracy guitar    : 72.09821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.304672718048096 sec. =
Valid knn accuracy residuals : 92.72727272727272%

Valid knn accuracy average   : 74.32569961157355%

                                                                      [AEpoch 2: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.699, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0765, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.663]Epoch 2: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.699, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.199043, 0.199519, 0.199489, 0.218485
Train average loss UNet                 (all)                : 0.816536

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.008064, 0.664424, 1.273032
Train average loss bass     (Triplet, dist_p, dist_n) : 0.074872, 0.700797, 0.953803
Train average loss piano    (Triplet, dist_p, dist_n) : 0.057808, 0.861439, 1.148530
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.041121, 0.903418, 1.285837
Train average loss residuals(Triplet, dist_p, dist_n) : 0.031972, 1.132934, 1.595654
Train average loss all      (Triplet)                 : 0.043423

== Recognize ==
Train average loss Recognize     : 0.729143
Train average accuracy drums     : 63.340004 %
Train average accuracy bass      : 56.204998 %
Train average accuracy piano     : 56.795002 %
Train average accuracy guitar    : 53.509998 %
Train average accuracy residuals : 52.364998 %

== Train average loss all : 0.043423

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.699, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.699, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]Epoch 3:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.699, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]Epoch 3:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.751, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]Epoch 3:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.751, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]Epoch 3:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.721, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]Epoch 3:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.721, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]Epoch 3:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=0.796, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]Epoch 3:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=0.796, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]Epoch 3:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00637, Train/loss_recog_step=0.807, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]Epoch 3:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.00637, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00637, Train/loss_recog_step=0.807, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]Epoch 3:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.784, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]  Epoch 3:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.784, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]Epoch 3:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0239, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=0.776, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]Epoch 3: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0239, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=0.776, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]Epoch 3: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.0808, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.0808, Valid/loss_recog_step=0.772, Valid/loss_all_epoch=0.117, Valid/loss_unet_all_epoch=0.802, Valid/loss_triplet_all_epoch=0.117, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.07it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.49it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.49it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.45it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.31it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.27it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195949, 0.198437, 0.195268, 0.222490
Valid average loss UNet                 (all)                : 0.812145

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.043401, 1.048402, 1.677378
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.188767, 1.036553, 1.122748
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.249498, 1.461668, 1.534625
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.093590, 1.366802, 1.804537
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.096253, 1.650597, 1.920923
Valid average loss all      (Triplet)                 : 0.131952

== Recognize ==
Valid average loss Recognize     : 0.695558
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.131952

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9913489818573 sec. =
Valid knn accuracy drums     : 90.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.041861772537231 sec. =
Valid knn accuracy bass      : 47.37903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.300005197525024 sec. =
Valid knn accuracy piano     : 69.7265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.41840410232544 sec. =
Valid knn accuracy guitar    : 73.21428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.023135423660278 sec. =
Valid knn accuracy residuals : 90.9090909090909%

Valid knn accuracy average   : 74.2892725371578%

                                                                      [AEpoch 3: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0434, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0434, Train/loss_recog_epoch=0.729]Epoch 3: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198971, 0.199441, 0.199429, 0.217988
Train average loss UNet                 (all)                : 0.815829

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002270, 0.901895, 1.684902
Train average loss bass     (Triplet, dist_p, dist_n) : 0.041238, 0.922036, 1.272016
Train average loss piano    (Triplet, dist_p, dist_n) : 0.024078, 1.132456, 1.543329
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.017041, 1.172715, 1.682921
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011160, 1.453456, 2.058488
Train average loss all      (Triplet)                 : 0.019649

== Recognize ==
Train average loss Recognize     : 0.784186
Train average accuracy drums     : 50.765003 %
Train average accuracy bass      : 50.024998 %
Train average accuracy piano     : 50.470001 %
Train average accuracy guitar    : 49.829998 %
Train average accuracy residuals : 49.759998 %

== Train average loss all : 0.019649

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]Epoch 4:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]Epoch 4:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.00107, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=0.804, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]Epoch 4:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.00107, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=0.804, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]Epoch 4:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.0151, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0151, Train/loss_recog_step=0.830, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]  Epoch 4:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.0151, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0151, Train/loss_recog_step=0.830, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]Epoch 4:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.823, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]Epoch 4:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.823, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]Epoch 4:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.003, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.003, Train/loss_recog_step=0.860, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]  Epoch 4:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.003, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.003, Train/loss_recog_step=0.860, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]Epoch 4:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00852, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00852, Train/loss_recog_step=0.849, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]Epoch 4:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.00852, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00852, Train/loss_recog_step=0.849, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]Epoch 4:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00701, Train/loss_recog_step=0.855, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]Epoch 4: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00701, Train/loss_recog_step=0.855, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]Epoch 4: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.827, Valid/loss_all_step=0.0905, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.0905, Valid/loss_recog_step=0.611, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=0.696, Valid/knn_avr=0.743, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.10it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.12it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.46it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.87it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196022, 0.198482, 0.195314, 0.207837
Valid average loss UNet                 (all)                : 0.797655

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.044590, 1.277619, 1.950993
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.187397, 1.318604, 1.420671
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.284887, 1.781762, 1.837813
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.116466, 1.674668, 2.168864
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.090888, 1.996966, 2.323989
Valid average loss all      (Triplet)                 : 0.148122

== Recognize ==
Valid average loss Recognize     : 0.772514
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.148122

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.067824602127075 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.755113363265991 sec. =
Valid knn accuracy bass      : 50.403225806451616%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.039060354232788 sec. =
Valid knn accuracy piano     : 69.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.829293727874756 sec. =
Valid knn accuracy guitar    : 68.52678571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.379061222076416 sec. =
Valid knn accuracy residuals : 89.54545454545455%

Valid knn accuracy average   : 72.8710443001949%

                                                                      [AEpoch 4: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.827, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.0196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0196, Train/loss_recog_epoch=0.784]  Epoch 4: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.827, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198996, 0.199458, 0.199442, 0.218431
Train average loss UNet                 (all)                : 0.816327

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000713, 1.110350, 2.062052
Train average loss bass     (Triplet, dist_p, dist_n) : 0.020175, 1.150311, 1.610843
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009246, 1.378706, 1.908122
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007664, 1.450089, 2.099358
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004025, 1.782694, 2.535619
Train average loss all      (Triplet)                 : 0.008530

== Recognize ==
Train average loss Recognize     : 0.835282
Train average accuracy drums     : 49.820000 %
Train average accuracy bass      : 49.524998 %
Train average accuracy piano     : 50.045002 %
Train average accuracy guitar    : 49.919998 %
Train average accuracy residuals : 49.939999 %

== Train average loss all : 0.008530

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.827, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.827, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]Epoch 5:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.827, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]Epoch 5:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.0078, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0078, Train/loss_recog_step=0.895, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]Epoch 5:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.0078, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0078, Train/loss_recog_step=0.895, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]Epoch 5:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00279, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00279, Train/loss_recog_step=0.875, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]Epoch 5:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.00279, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00279, Train/loss_recog_step=0.875, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]Epoch 5:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.814, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]  Epoch 5:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.814, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]Epoch 5:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.000697, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000697, Train/loss_recog_step=0.843, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]Epoch 5:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.000697, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000697, Train/loss_recog_step=0.843, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]Epoch 5:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00805, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00805, Train/loss_recog_step=0.862, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]  Epoch 5:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.00805, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00805, Train/loss_recog_step=0.862, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]Epoch 5:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]    Epoch 5: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]Epoch 5: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0061, Train/loss_recog_step=0.833, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.832, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.729, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.44it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.99it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.03it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.19it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.57it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.06it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195772, 0.198236, 0.195027, 0.218998
Valid average loss UNet                 (all)                : 0.808033

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067151, 1.510882, 2.312566
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.219364, 1.559407, 1.713337
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.318320, 2.071696, 2.132871
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.102451, 1.984496, 2.572632
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.100213, 2.335968, 2.766589
Valid average loss all      (Triplet)                 : 0.161783

== Recognize ==
Valid average loss Recognize     : 0.758561
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.161783

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.79113245010376 sec. =
Valid knn accuracy drums     : 88.91304347826086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.556809425354004 sec. =
Valid knn accuracy bass      : 44.556451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.121084451675415 sec. =
Valid knn accuracy piano     : 66.796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.637340307235718 sec. =
Valid knn accuracy guitar    : 68.30357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.945404529571533 sec. =
Valid knn accuracy residuals : 90.45454545454545%

Valid knn accuracy average   : 71.8048973948562%

                                                                      [AEpoch 5: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0061, Train/loss_recog_step=0.833, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.835]Epoch 5: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0061, Train/loss_recog_step=0.833, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198942, 0.199412, 0.199402, 0.218598
Train average loss UNet                 (all)                : 0.816355

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000872, 1.305111, 2.371951
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011010, 1.361549, 1.922690
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004643, 1.616841, 2.256346
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004004, 1.716017, 2.493190
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002548, 2.065841, 2.948848
Train average loss all      (Triplet)                 : 0.004746

== Recognize ==
Train average loss Recognize     : 0.854138
Train average accuracy drums     : 49.555000 %
Train average accuracy bass      : 49.974998 %
Train average accuracy piano     : 50.500000 %
Train average accuracy guitar    : 49.980000 %
Train average accuracy residuals : 50.454998 %

== Train average loss all : 0.004746

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0061, Train/loss_recog_step=0.833, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0061, Train/loss_recog_step=0.833, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]Epoch 6:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0061, Train/loss_recog_step=0.833, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]Epoch 6:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.00748, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00748, Train/loss_recog_step=0.851, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]Epoch 6:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.00748, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00748, Train/loss_recog_step=0.851, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]Epoch 6:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.00397, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00397, Train/loss_recog_step=0.880, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]Epoch 6:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.00397, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00397, Train/loss_recog_step=0.880, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]Epoch 6:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.00208, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.00208, Train/loss_recog_step=0.909, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]Epoch 6:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.00208, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.00208, Train/loss_recog_step=0.909, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]Epoch 6:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.878, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]    Epoch 6:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.878, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]Epoch 6:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.00587, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00587, Train/loss_recog_step=0.879, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]Epoch 6:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.00587, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00587, Train/loss_recog_step=0.879, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]Epoch 6:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=0.841, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]Epoch 6: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=0.841, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]Epoch 6: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.120, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.120, Valid/loss_recog_step=0.728, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.759, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.13it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.83it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.84it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195604, 0.198138, 0.194853, 0.223310
Valid average loss UNet                 (all)                : 0.811906

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061728, 1.646333, 2.514207
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.234317, 1.717724, 1.837403
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.338229, 2.322950, 2.396978
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.123206, 2.224524, 2.902690
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.086937, 2.518065, 3.027760
Valid average loss all      (Triplet)                 : 0.169429

== Recognize ==
Valid average loss Recognize     : 0.751769
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 58.499996 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.169429

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.519673585891724 sec. =
Valid knn accuracy drums     : 86.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.136529207229614 sec. =
Valid knn accuracy bass      : 44.75806451612903%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.38670039176941 sec. =
Valid knn accuracy piano     : 69.3359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.166803359985352 sec. =
Valid knn accuracy guitar    : 67.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.595383644104004 sec. =
Valid knn accuracy residuals : 91.5909090909091%

Valid knn accuracy average   : 71.96578656923371%

                                                                      [AEpoch 6: 100%|██████████| 313/313 [05:49<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.854]Epoch 6: 100%|██████████| 313/313 [05:49<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198890, 0.199351, 0.199343, 0.219067
Train average loss UNet                 (all)                : 0.816651

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000520, 1.490138, 2.714751
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007705, 1.578391, 2.249447
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004436, 1.861486, 2.601428
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003054, 1.961069, 2.850509
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001659, 2.343023, 3.360983
Train average loss all      (Triplet)                 : 0.003592

== Recognize ==
Train average loss Recognize     : 0.880637
Train average accuracy drums     : 49.794998 %
Train average accuracy bass      : 49.709999 %
Train average accuracy piano     : 50.535000 %
Train average accuracy guitar    : 49.340000 %
Train average accuracy residuals : 50.524998 %

== Train average loss all : 0.003592

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]Epoch 7:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]Epoch 7:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.00145, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00145, Train/loss_recog_step=0.924, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]Epoch 7:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.00145, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00145, Train/loss_recog_step=0.924, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]Epoch 7:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.878, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]    Epoch 7:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.878, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]Epoch 7:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.00196, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00196, Train/loss_recog_step=0.881, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]Epoch 7:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.00196, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00196, Train/loss_recog_step=0.881, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]Epoch 7:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.0204, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0204, Train/loss_recog_step=0.951, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]  Epoch 7:  80%|███████▉  | 250/313 [03:47<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.0204, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0204, Train/loss_recog_step=0.951, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]Epoch 7:  80%|███████▉  | 250/313 [03:47<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.000954, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000954, Train/loss_recog_step=0.886, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]Epoch 7:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000954, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000954, Train/loss_recog_step=0.886, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]Epoch 7:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000138, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000138, Train/loss_recog_step=0.933, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]Epoch 7: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000138, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000138, Train/loss_recog_step=0.933, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]Epoch 7: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.671, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.169, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.720, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.50it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.09it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.31it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195556, 0.198066, 0.194789, 0.226221
Valid average loss UNet                 (all)                : 0.814632

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062808, 1.740294, 2.581897
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.258432, 1.957947, 2.140123
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.358490, 2.550257, 2.640742
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.116191, 2.408691, 3.088614
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.153199, 2.851316, 3.308123
Valid average loss all      (Triplet)                 : 0.192451

== Recognize ==
Valid average loss Recognize     : 0.828891
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.192451

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.117660999298096 sec. =
Valid knn accuracy drums     : 87.82608695652175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.494061946868896 sec. =
Valid knn accuracy bass      : 44.95967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.131628036499023 sec. =
Valid knn accuracy piano     : 64.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.900310754776001 sec. =
Valid knn accuracy guitar    : 69.86607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.565073013305664 sec. =
Valid knn accuracy residuals : 89.77272727272727%

Valid knn accuracy average   : 71.45366261543506%

                                                                      [AEpoch 7: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00359, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=0.881]Epoch 7: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198835, 0.199310, 0.199284, 0.218937
Train average loss UNet                 (all)                : 0.816366

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000881, 1.646154, 2.930625
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007510, 1.744093, 2.495827
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004314, 2.076518, 2.907631
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004215, 2.155353, 3.128077
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002374, 2.591397, 3.723250
Train average loss all      (Triplet)                 : 0.003878

== Recognize ==
Train average loss Recognize     : 0.899625
Train average accuracy drums     : 50.199997 %
Train average accuracy bass      : 49.840000 %
Train average accuracy piano     : 50.510002 %
Train average accuracy guitar    : 49.759998 %
Train average accuracy residuals : 50.295002 %

== Train average loss all : 0.003878

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]Epoch 8:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]Epoch 8:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]Epoch 8:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]Epoch 8:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.00165, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00165, Train/loss_recog_step=0.951, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]Epoch 8:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00165, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00165, Train/loss_recog_step=0.951, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]Epoch 8:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00153, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.00153, Train/loss_recog_step=0.899, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]Epoch 8:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.00153, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.00153, Train/loss_recog_step=0.899, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]Epoch 8:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.00283, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00283, Train/loss_recog_step=0.944, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]Epoch 8:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00283, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00283, Train/loss_recog_step=0.944, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]Epoch 8:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.931, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]  Epoch 8:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.931, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]Epoch 8:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.00276, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=0.953, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]Epoch 8: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.00276, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=0.953, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]Epoch 8: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.00448, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.889, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.192, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.192, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.67it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.10it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.36it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.28it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.85it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195606, 0.198105, 0.194844, 0.225860
Valid average loss UNet                 (all)                : 0.814414

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.057945, 1.949719, 2.864105
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.266723, 2.090167, 2.260870
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.375754, 2.694371, 2.777816
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.112369, 2.576478, 3.358743
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.106290, 2.990185, 3.497129
Valid average loss all      (Triplet)                 : 0.182618

== Recognize ==
Valid average loss Recognize     : 0.820423
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.182618

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.283311128616333 sec. =
Valid knn accuracy drums     : 87.39130434782608%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.889002323150635 sec. =
Valid knn accuracy bass      : 41.935483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.337473630905151 sec. =
Valid knn accuracy piano     : 67.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.344591856002808 sec. =
Valid knn accuracy guitar    : 70.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.345095157623291 sec. =
Valid knn accuracy residuals : 92.5%

Valid knn accuracy average   : 71.86535764375876%

                                                                      [AEpoch 8: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.00448, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.889, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=0.900]Epoch 8: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.00448, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.889, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198986, 0.199443, 0.199431, 0.218868
Train average loss UNet                 (all)                : 0.816727

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001075, 1.772110, 3.196151
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006857, 1.850339, 2.674019
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004325, 2.199078, 3.086898
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003868, 2.274160, 3.340090
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003094, 2.733353, 3.931413
Train average loss all      (Triplet)                 : 0.003948

== Recognize ==
Train average loss Recognize     : 0.909450
Train average accuracy drums     : 49.794998 %
Train average accuracy bass      : 50.445004 %
Train average accuracy piano     : 50.015003 %
Train average accuracy guitar    : 50.410004 %
Train average accuracy residuals : 49.945000 %

== Train average loss all : 0.003948

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00448, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.889, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00448, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.889, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]Epoch 9:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.00448, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.889, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]Epoch 9:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.00447, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00447, Train/loss_recog_step=0.945, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]Epoch 9:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00447, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00447, Train/loss_recog_step=0.945, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]Epoch 9:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00356, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00356, Train/loss_recog_step=0.967, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]Epoch 9:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00356, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00356, Train/loss_recog_step=0.967, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]Epoch 9:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00505, Train/loss_unet_all_step=0.875, Train/loss_triplet_all_step=0.00505, Train/loss_recog_step=0.994, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]Epoch 9:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.00505, Train/loss_unet_all_step=0.875, Train/loss_triplet_all_step=0.00505, Train/loss_recog_step=0.994, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]Epoch 9:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.00128, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=0.919, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]Epoch 9:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00128, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=0.919, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]Epoch 9:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=0.878, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]Epoch 9:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=0.878, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]Epoch 9:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.00298, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00298, Train/loss_recog_step=0.903, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]Epoch 9: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.00298, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00298, Train/loss_recog_step=0.903, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]Epoch 9: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.127, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.91it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.60it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.80it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.67it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.67it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195835, 0.198354, 0.195085, 0.235518
Valid average loss UNet                 (all)                : 0.824792

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.048227, 1.959870, 3.058603
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.293397, 2.154829, 2.328368
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.348508, 2.877129, 2.982193
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.137425, 2.591988, 3.403527
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.128806, 3.086395, 3.603984
Valid average loss all      (Triplet)                 : 0.190829

== Recognize ==
Valid average loss Recognize     : 0.815610
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.190829

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.647648811340332 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.05917501449585 sec. =
Valid knn accuracy bass      : 51.20967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.35500168800354 sec. =
Valid knn accuracy piano     : 64.2578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.800324201583862 sec. =
Valid knn accuracy guitar    : 69.19642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.717172384262085 sec. =
Valid knn accuracy residuals : 88.86363636363637%

Valid knn accuracy average   : 72.05333705784047%

                                                                      [AEpoch 9: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.909]Epoch 9: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.199026, 0.199491, 0.199474, 0.218640
Train average loss UNet                 (all)                : 0.816631

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001031, 1.898969, 3.447345
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007088, 1.989522, 2.880667
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004610, 2.328403, 3.275178
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004120, 2.419406, 3.551520
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002801, 2.870461, 4.123515
Train average loss all      (Triplet)                 : 0.004013

== Recognize ==
Train average loss Recognize     : 0.933664
Train average accuracy drums     : 49.364998 %
Train average accuracy bass      : 50.045002 %
Train average accuracy piano     : 49.825001 %
Train average accuracy guitar    : 49.889999 %
Train average accuracy residuals : 49.875000 %

== Train average loss all : 0.004013

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]Epoch 10:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]Epoch 10:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.00122, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=0.977, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]Epoch 10:  32%|███▏      | 100/313 [01:34<03:21,  1.06it/s, v_num=0, Train/loss_all_step=0.00122, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=0.977, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]Epoch 10:  32%|███▏      | 100/313 [01:34<03:21,  1.06it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=0.997, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]  Epoch 10:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=0.997, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]Epoch 10:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.00211, Train/loss_unet_all_step=0.867, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.972, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]Epoch 10:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.00211, Train/loss_unet_all_step=0.867, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.972, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]Epoch 10:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.000264, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000264, Train/loss_recog_step=1.030, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]Epoch 10:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000264, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000264, Train/loss_recog_step=1.030, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]Epoch 10:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.00395, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00395, Train/loss_recog_step=0.939, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]  Epoch 10:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.00395, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00395, Train/loss_recog_step=0.939, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]Epoch 10:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.00178, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00178, Train/loss_recog_step=0.971, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]Epoch 10: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.00178, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00178, Train/loss_recog_step=0.971, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]Epoch 10: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.888, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.813, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.740, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.56it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.59it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.26it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.37it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195899, 0.198390, 0.195138, 0.222380
Valid average loss UNet                 (all)                : 0.811807

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.055124, 2.105046, 3.319606
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.354654, 2.334359, 2.430057
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.418425, 3.079343, 3.088019
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.112800, 2.794334, 3.626281
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.104563, 3.369581, 3.956648
Valid average loss all      (Triplet)                 : 0.212687

== Recognize ==
Valid average loss Recognize     : 0.871286
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 43.000000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.212687

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.405346393585205 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.923553228378296 sec. =
Valid knn accuracy bass      : 48.79032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.197012186050415 sec. =
Valid knn accuracy piano     : 67.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.601117134094238 sec. =
Valid knn accuracy guitar    : 66.96428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.75826621055603 sec. =
Valid knn accuracy residuals : 90.22727272727272%

Valid knn accuracy average   : 71.85126750878855%

                                                                      [AEpoch 10: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.888, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.934]Epoch 10: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.888, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.199171, 0.199647, 0.199624, 0.218944
Train average loss UNet                 (all)                : 0.817387

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001142, 1.987875, 3.587137
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006800, 2.076942, 3.003742
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005229, 2.465283, 3.490691
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003510, 2.542597, 3.732792
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001629, 3.013870, 4.365396
Train average loss all      (Triplet)                 : 0.003652

== Recognize ==
Train average loss Recognize     : 0.952406
Train average accuracy drums     : 50.094997 %
Train average accuracy bass      : 50.269997 %
Train average accuracy piano     : 50.155003 %
Train average accuracy guitar    : 49.285000 %
Train average accuracy residuals : 50.204998 %

== Train average loss all : 0.003652

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.888, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.888, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]Epoch 11:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.888, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]Epoch 11:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.00228, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.907, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]Epoch 11:  32%|███▏      | 100/313 [01:35<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.00228, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.907, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]Epoch 11:  32%|███▏      | 100/313 [01:35<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.000984, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000984, Train/loss_recog_step=0.880, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]Epoch 11:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.000984, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000984, Train/loss_recog_step=0.880, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]Epoch 11:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.00276, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=0.976, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]  Epoch 11:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.00276, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=0.976, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]Epoch 11:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00459, Train/loss_recog_step=1.020, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]Epoch 11:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00459, Train/loss_recog_step=1.020, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]Epoch 11:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.000531, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000531, Train/loss_recog_step=0.991, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]Epoch 11:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.000531, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000531, Train/loss_recog_step=0.991, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]Epoch 11:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=1.76e-5, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=1.76e-5, Train/loss_recog_step=1.040, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]  Epoch 11: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=1.76e-5, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=1.76e-5, Train/loss_recog_step=1.040, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]Epoch 11: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.213, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.63it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.02it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.67it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.91it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.23it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195811, 0.198340, 0.195056, 0.221026
Valid average loss UNet                 (all)                : 0.810232

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.058749, 2.199570, 3.477502
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.288442, 2.405461, 2.620021
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.475730, 3.230655, 3.189062
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.134781, 2.921941, 3.754914
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.125756, 3.361765, 4.049292
Valid average loss all      (Triplet)                 : 0.225942

== Recognize ==
Valid average loss Recognize     : 0.861849
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.225942

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.349839687347412 sec. =
Valid knn accuracy drums     : 87.39130434782608%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.142964363098145 sec. =
Valid knn accuracy bass      : 47.58064516129033%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.647879123687744 sec. =
Valid knn accuracy piano     : 70.1171875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.276663541793823 sec. =
Valid knn accuracy guitar    : 66.51785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.561467170715332 sec. =
Valid knn accuracy residuals : 90.45454545454545%

Valid knn accuracy average   : 72.41230792130379%

                                                                      [AEpoch 11: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=0.952]Epoch 11: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.199055, 0.199527, 0.199509, 0.218645
Train average loss UNet                 (all)                : 0.816736

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000956, 2.081692, 3.785149
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004523, 2.186289, 3.198094
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004120, 2.595400, 3.696681
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003625, 2.664708, 3.910153
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002129, 3.146973, 4.557527
Train average loss all      (Triplet)                 : 0.003133

== Recognize ==
Train average loss Recognize     : 0.951520
Train average accuracy drums     : 49.735001 %
Train average accuracy bass      : 50.075001 %
Train average accuracy piano     : 49.625000 %
Train average accuracy guitar    : 50.470001 %
Train average accuracy residuals : 50.010002 %

== Train average loss all : 0.003133

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]Epoch 12:  16%|█▌        | 50/313 [00:50<04:24,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]Epoch 12:  16%|█▌        | 50/313 [00:50<04:24,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]Epoch 12:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]Epoch 12:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00604, Train/loss_recog_step=0.890, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]Epoch 12:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00604, Train/loss_recog_step=0.890, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]Epoch 12:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.966, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]  Epoch 12:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.966, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]Epoch 12:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.00162, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00162, Train/loss_recog_step=0.936, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]Epoch 12:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.00162, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00162, Train/loss_recog_step=0.936, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]Epoch 12:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=0.970, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]  Epoch 12:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=0.970, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]Epoch 12:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.00204, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=0.978, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]Epoch 12: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.00204, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=0.978, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]Epoch 12: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.00883, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00883, Train/loss_recog_step=0.912, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.244, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.862, Valid/knn_avr=0.724, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.31it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.50it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.14it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.56it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195605, 0.198173, 0.194818, 0.216102
Valid average loss UNet                 (all)                : 0.804699

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.089887, 2.293189, 3.647403
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.296216, 2.598905, 2.782676
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.480889, 3.506411, 3.546044
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.115615, 3.130007, 3.947345
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.150220, 3.662305, 4.168915
Valid average loss all      (Triplet)                 : 0.234260

== Recognize ==
Valid average loss Recognize     : 0.883760
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.234260

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.281381845474243 sec. =
Valid knn accuracy drums     : 82.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.796235799789429 sec. =
Valid knn accuracy bass      : 50.201612903225815%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.831546306610107 sec. =
Valid knn accuracy piano     : 67.96875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5670506954193115 sec. =
Valid knn accuracy guitar    : 65.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.781269311904907 sec. =
Valid knn accuracy residuals : 90.68181818181819%

Valid knn accuracy average   : 71.46065360831314%

                                                                      [AEpoch 12: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.00883, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00883, Train/loss_recog_step=0.912, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00313, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00313, Train/loss_recog_epoch=0.952]Epoch 12: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.00883, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00883, Train/loss_recog_step=0.912, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198993, 0.199452, 0.199442, 0.219161
Train average loss UNet                 (all)                : 0.817048

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001730, 2.195914, 3.972940
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006636, 2.312535, 3.341364
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002726, 2.676847, 3.818134
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003226, 2.801141, 4.126149
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003099, 3.280617, 4.753680
Train average loss all      (Triplet)                 : 0.003546

== Recognize ==
Train average loss Recognize     : 0.958956
Train average accuracy drums     : 49.814999 %
Train average accuracy bass      : 49.849998 %
Train average accuracy piano     : 49.980000 %
Train average accuracy guitar    : 50.290001 %
Train average accuracy residuals : 50.054996 %

== Train average loss all : 0.003546

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00883, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00883, Train/loss_recog_step=0.912, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00883, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00883, Train/loss_recog_step=0.912, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]Epoch 13:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.00883, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00883, Train/loss_recog_step=0.912, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]Epoch 13:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00638, Train/loss_recog_step=0.971, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]Epoch 13:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00638, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00638, Train/loss_recog_step=0.971, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]Epoch 13:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00048, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.00048, Train/loss_recog_step=0.879, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]Epoch 13:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.00048, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.00048, Train/loss_recog_step=0.879, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]Epoch 13:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.00183, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.00183, Train/loss_recog_step=0.974, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]Epoch 13:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.00183, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.00183, Train/loss_recog_step=0.974, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]Epoch 13:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.963, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]Epoch 13:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.963, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]Epoch 13:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]    Epoch 13:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]Epoch 13:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.00175, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00175, Train/loss_recog_step=0.958, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]Epoch 13: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.00175, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00175, Train/loss_recog_step=0.958, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]Epoch 13: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.867, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.234, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.234, Valid/loss_recog_epoch=0.884, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.68it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.52it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.67it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.28it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.30it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195618, 0.198209, 0.194842, 0.221184
Valid average loss UNet                 (all)                : 0.809853

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.085919, 2.430975, 3.804944
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.345450, 2.693291, 2.908300
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.486865, 3.515161, 3.542911
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.153487, 3.250287, 4.166453
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.176884, 3.786129, 4.332811
Valid average loss all      (Triplet)                 : 0.251756

== Recognize ==
Valid average loss Recognize     : 0.831882
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.251756

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.425045728683472 sec. =
Valid knn accuracy drums     : 88.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.286456823348999 sec. =
Valid knn accuracy bass      : 48.79032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.855127573013306 sec. =
Valid knn accuracy piano     : 65.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.7322611808776855 sec. =
Valid knn accuracy guitar    : 65.84821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.204706907272339 sec. =
Valid knn accuracy residuals : 93.63636363636364%

Valid knn accuracy average   : 72.3149665135881%

                                                                      [AEpoch 13: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.867, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=0.959]Epoch 13: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.867, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198936, 0.199398, 0.199389, 0.219546
Train average loss UNet                 (all)                : 0.817269

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001331, 2.282448, 4.189588
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004695, 2.413451, 3.529685
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005787, 2.852056, 4.073558
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003400, 2.915020, 4.295960
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003528, 3.410676, 4.943822
Train average loss all      (Triplet)                 : 0.003825

== Recognize ==
Train average loss Recognize     : 0.956592
Train average accuracy drums     : 50.255001 %
Train average accuracy bass      : 50.449997 %
Train average accuracy piano     : 50.379997 %
Train average accuracy guitar    : 50.295002 %
Train average accuracy residuals : 50.330002 %

== Train average loss all : 0.003825

Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.867, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]          Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.867, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]Epoch 14:  16%|█▌        | 50/313 [00:50<04:24,  0.99it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.867, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]Epoch 14:  16%|█▌        | 50/313 [00:50<04:24,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]  Epoch 14:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]Epoch 14:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.00104, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00104, Train/loss_recog_step=0.893, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]Epoch 14:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.00104, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00104, Train/loss_recog_step=0.893, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]Epoch 14:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]    Epoch 14:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]Epoch 14:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=7.61e-5, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=7.61e-5, Train/loss_recog_step=1.000, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]Epoch 14:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=7.61e-5, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=7.61e-5, Train/loss_recog_step=1.000, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]Epoch 14:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.903, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]    Epoch 14:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.903, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]Epoch 14:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.000574, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000574, Train/loss_recog_step=0.993, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]Epoch 14: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000574, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000574, Train/loss_recog_step=0.993, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]Epoch 14: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.252, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.252, Valid/loss_recog_epoch=0.832, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.86it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.28it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.43it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195854, 0.198296, 0.195137, 0.224744
Valid average loss UNet                 (all)                : 0.814031

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.072697, 2.536509, 3.868202
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.365572, 2.736252, 2.933805
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.426138, 3.657667, 3.800695
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.178304, 3.391190, 4.411385
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.179651, 3.877737, 4.457523
Valid average loss all      (Triplet)                 : 0.235168

== Recognize ==
Valid average loss Recognize     : 0.881655
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 41.000000 %

== Valid average loss all : 0.235168

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.296910524368286 sec. =
Valid knn accuracy drums     : 83.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.947057485580444 sec. =
Valid knn accuracy bass      : 48.99193548387097%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.646131038665771 sec. =
Valid knn accuracy piano     : 65.234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.2815961837768555 sec. =
Valid knn accuracy guitar    : 65.84821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.195895910263062 sec. =
Valid knn accuracy residuals : 92.27272727272727%

Valid knn accuracy average   : 71.20858084324512%

                                                                      [AEpoch 14: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.957]Epoch 14: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]    

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198926, 0.199396, 0.199384, 0.218448
Train average loss UNet                 (all)                : 0.816155

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001151, 2.370459, 4.348432
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004126, 2.473490, 3.634785
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004655, 2.944015, 4.209583
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003188, 3.002969, 4.433113
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001929, 3.495250, 5.101019
Train average loss all      (Triplet)                 : 0.002995

== Recognize ==
Train average loss Recognize     : 0.954772
Train average accuracy drums     : 49.665001 %
Train average accuracy bass      : 50.239998 %
Train average accuracy piano     : 49.605000 %
Train average accuracy guitar    : 49.965000 %
Train average accuracy residuals : 50.255001 %

== Train average loss all : 0.002995

Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]          Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]Epoch 15:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]Epoch 15:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.00106, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00106, Train/loss_recog_step=0.936, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]Epoch 15:  32%|███▏      | 100/313 [01:34<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.00106, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00106, Train/loss_recog_step=0.936, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]Epoch 15:  32%|███▏      | 100/313 [01:34<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]    Epoch 15:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]Epoch 15:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.000115, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000115, Train/loss_recog_step=1.100, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]Epoch 15:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.000115, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000115, Train/loss_recog_step=1.100, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]Epoch 15:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.00785, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.00785, Train/loss_recog_step=1.070, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]  Epoch 15:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.00785, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.00785, Train/loss_recog_step=1.070, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]Epoch 15:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]    Epoch 15:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]Epoch 15:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00735, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.992, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]Epoch 15: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.00735, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.992, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]Epoch 15: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.965, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.137, Valid/loss_recog_step=0.785, Valid/loss_all_epoch=0.235, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.712, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.70it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.69it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.49it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.50it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.11it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196083, 0.198520, 0.195369, 0.220227
Valid average loss UNet                 (all)                : 0.810199

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.088203, 2.587788, 3.981346
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.333280, 2.876613, 3.074788
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.436480, 3.757013, 3.874177
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.181981, 3.616037, 4.660868
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.139509, 4.106392, 4.805312
Valid average loss all      (Triplet)                 : 0.227030

== Recognize ==
Valid average loss Recognize     : 0.904411
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.227030

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.257273197174072 sec. =
Valid knn accuracy drums     : 86.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8981122970581055 sec. =
Valid knn accuracy bass      : 50.60483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.364845991134644 sec. =
Valid knn accuracy piano     : 64.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.217076778411865 sec. =
Valid knn accuracy guitar    : 65.84821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.92549729347229 sec. =
Valid knn accuracy residuals : 91.36363636363637%

Valid knn accuracy average   : 71.83643569789257%

                                                                      [AEpoch 15: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.965, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=0.955]Epoch 15: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.965, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.199023, 0.199486, 0.199474, 0.218092
Train average loss UNet                 (all)                : 0.816076

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000748, 2.445159, 4.515062
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005117, 2.586603, 3.781984
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003277, 3.038400, 4.376898
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002611, 3.150359, 4.688223
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002267, 3.602540, 5.256448
Train average loss all      (Triplet)                 : 0.002816

== Recognize ==
Train average loss Recognize     : 0.988925
Train average accuracy drums     : 49.689999 %
Train average accuracy bass      : 49.364998 %
Train average accuracy piano     : 49.665001 %
Train average accuracy guitar    : 50.424999 %
Train average accuracy residuals : 49.790001 %

== Train average loss all : 0.002816

Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.965, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]          Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.965, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]Epoch 16:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.965, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]Epoch 16:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00612, Train/loss_recog_step=1.000, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]Epoch 16:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.00612, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00612, Train/loss_recog_step=1.000, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]Epoch 16:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.000881, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000881, Train/loss_recog_step=0.951, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]Epoch 16:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.000881, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000881, Train/loss_recog_step=0.951, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]Epoch 16:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.00211, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.947, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]  Epoch 16:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.00211, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.947, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]Epoch 16:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.0058, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=1.040, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]  Epoch 16:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.0058, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=1.040, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]Epoch 16:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]  Epoch 16:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]Epoch 16:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]Epoch 16: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]Epoch 16: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.111, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=0.955, Valid/loss_all_epoch=0.227, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.62it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.00it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.48it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.99it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.22it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.73it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196120, 0.198610, 0.195342, 0.214382
Valid average loss UNet                 (all)                : 0.804453

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.088432, 2.815948, 4.181442
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.353547, 2.991182, 3.362219
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.459926, 3.838139, 4.071463
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.187079, 3.735255, 4.815944
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.200490, 4.213150, 4.931923
Valid average loss all      (Triplet)                 : 0.251145

== Recognize ==
Valid average loss Recognize     : 0.905545
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 44.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 56.500000 %

== Valid average loss all : 0.251145

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.97297477722168 sec. =
Valid knn accuracy drums     : 85.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.691420078277588 sec. =
Valid knn accuracy bass      : 51.00806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.437149047851562 sec. =
Valid knn accuracy piano     : 66.6015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.633954286575317 sec. =
Valid knn accuracy guitar    : 66.51785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.542076349258423 sec. =
Valid knn accuracy residuals : 90.68181818181819%

Valid knn accuracy average   : 72.13577351163913%

                                                                      [AEpoch 16: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.989]Epoch 16: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198971, 0.199438, 0.199436, 0.219076
Train average loss UNet                 (all)                : 0.816921

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000854, 2.485988, 4.474943
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004257, 2.684731, 3.942740
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002993, 3.118262, 4.506115
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003846, 3.268533, 4.879803
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001839, 3.695912, 5.399001
Train average loss all      (Triplet)                 : 0.002801

== Recognize ==
Train average loss Recognize     : 0.985765
Train average accuracy drums     : 50.024998 %
Train average accuracy bass      : 49.985001 %
Train average accuracy piano     : 50.349998 %
Train average accuracy guitar    : 50.070000 %
Train average accuracy residuals : 49.645000 %

== Train average loss all : 0.002801

Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]          Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]Epoch 17:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]Epoch 17:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.00805, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.00805, Train/loss_recog_step=0.935, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]Epoch 17:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.00805, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.00805, Train/loss_recog_step=0.935, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]Epoch 17:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.00885, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00885, Train/loss_recog_step=0.997, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]Epoch 17:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.00885, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00885, Train/loss_recog_step=0.997, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]Epoch 17:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.905, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]  Epoch 17:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.873, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.905, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]Epoch 17:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.0022, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=1.090, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]Epoch 17:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.0022, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=1.090, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]Epoch 17:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]  Epoch 17:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]Epoch 17:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.000856, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000856, Train/loss_recog_step=0.990, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]Epoch 17: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000856, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000856, Train/loss_recog_step=0.990, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]Epoch 17: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.110, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.110, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.251, Valid/loss_unet_all_epoch=0.804, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.721, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.70it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.95it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.88it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.80it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.26it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.31it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195484, 0.198092, 0.194632, 0.229293
Valid average loss UNet                 (all)                : 0.817501

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101730, 2.826398, 4.236022
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.345838, 2.924994, 3.255157
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.493771, 3.877728, 4.160108
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.207676, 3.754887, 4.830131
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.196816, 4.268191, 4.927478
Valid average loss all      (Triplet)                 : 0.268219

== Recognize ==
Valid average loss Recognize     : 0.880578
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.268219

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.026533126831055 sec. =
Valid knn accuracy drums     : 84.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.608234167098999 sec. =
Valid knn accuracy bass      : 54.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.852473258972168 sec. =
Valid knn accuracy piano     : 65.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.554306507110596 sec. =
Valid knn accuracy guitar    : 63.61607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.246270656585693 sec. =
Valid knn accuracy residuals : 91.81818181818183%

Valid knn accuracy average   : 71.85763650138432%

                                                                      [AEpoch 17: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.0028, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.0028, Train/loss_recog_epoch=0.986]Epoch 17: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.199081, 0.199552, 0.199533, 0.217785
Train average loss UNet                 (all)                : 0.815952

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001001, 2.579058, 4.621208
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004794, 2.761483, 4.059276
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003475, 3.211415, 4.639198
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003022, 3.319407, 4.975906
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002153, 3.795220, 5.543553
Train average loss all      (Triplet)                 : 0.002971

== Recognize ==
Train average loss Recognize     : 0.989015
Train average accuracy drums     : 50.295002 %
Train average accuracy bass      : 49.230000 %
Train average accuracy piano     : 49.845001 %
Train average accuracy guitar    : 50.550003 %
Train average accuracy residuals : 49.820000 %

== Train average loss all : 0.002971

Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]          Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]Epoch 18:  16%|█▌        | 50/313 [00:49<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]Epoch 18:  16%|█▌        | 50/313 [00:49<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.0052, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0052, Train/loss_recog_step=0.928, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]Epoch 18:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.0052, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0052, Train/loss_recog_step=0.928, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]Epoch 18:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]  Epoch 18:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]Epoch 18:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]Epoch 18:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]Epoch 18:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.000113, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000113, Train/loss_recog_step=1.040, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]Epoch 18:  80%|███████▉  | 250/313 [03:44<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000113, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000113, Train/loss_recog_step=1.040, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]Epoch 18:  80%|███████▉  | 250/313 [03:44<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]      Epoch 18:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]Epoch 18:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.00565, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00565, Train/loss_recog_step=1.000, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]Epoch 18: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.00565, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00565, Train/loss_recog_step=1.000, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]Epoch 18: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.966, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.741, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.881, Valid/knn_avr=0.719, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.90it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.50it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.98it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.17it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195996, 0.198522, 0.195158, 0.225288
Valid average loss UNet                 (all)                : 0.814964

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099281, 3.026119, 4.663608
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.373270, 3.041023, 3.368431
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.451576, 4.084456, 4.281371
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.236286, 3.903616, 5.024550
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.180836, 4.454133, 5.175006
Valid average loss all      (Triplet)                 : 0.262962

== Recognize ==
Valid average loss Recognize     : 0.852747
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.262962

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.802026987075806 sec. =
Valid knn accuracy drums     : 88.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.969305038452148 sec. =
Valid knn accuracy bass      : 55.443548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.544273376464844 sec. =
Valid knn accuracy piano     : 65.8203125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.60808539390564 sec. =
Valid knn accuracy guitar    : 62.27678571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.190502166748047 sec. =
Valid knn accuracy residuals : 89.0909090909091%

Valid knn accuracy average   : 72.22196331237136%

                                                                      [AEpoch 18: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.966, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=0.989]Epoch 18: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.966, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.199017, 0.199492, 0.199481, 0.218680
Train average loss UNet                 (all)                : 0.816671

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001184, 2.693589, 4.891843
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006530, 2.878692, 4.204038
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003429, 3.291568, 4.734472
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003638, 3.486878, 5.208242
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001671, 3.955417, 5.786133
Train average loss all      (Triplet)                 : 0.003366

== Recognize ==
Train average loss Recognize     : 0.997844
Train average accuracy drums     : 49.424999 %
Train average accuracy bass      : 50.465000 %
Train average accuracy piano     : 50.570000 %
Train average accuracy guitar    : 50.340004 %
Train average accuracy residuals : 50.395000 %

== Train average loss all : 0.003366

Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.966, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]          Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.966, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]Epoch 19:  16%|█▌        | 50/313 [00:50<04:27,  0.98it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.966, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]Epoch 19:  16%|█▌        | 50/313 [00:50<04:27,  0.98it/s, v_num=0, Train/loss_all_step=0.00187, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00187, Train/loss_recog_step=1.070, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]Epoch 19:  32%|███▏      | 100/313 [01:34<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.00187, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00187, Train/loss_recog_step=1.070, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]Epoch 19:  32%|███▏      | 100/313 [01:34<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.00193, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=0.939, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]Epoch 19:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.00193, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=0.939, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]Epoch 19:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.870, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]    Epoch 19:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.870, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]Epoch 19:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00661, Train/loss_recog_step=1.110, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]Epoch 19:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00661, Train/loss_recog_step=1.110, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]Epoch 19:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.00144, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=1.070, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]Epoch 19:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.00144, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=1.070, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]Epoch 19:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]    Epoch 19: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]Epoch 19: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.75it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.36it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.91it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.44it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.46it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195613, 0.198226, 0.194821, 0.223015
Valid average loss UNet                 (all)                : 0.811674

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077147, 3.009322, 4.285142
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.416494, 3.079262, 3.336238
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.479429, 4.117909, 4.350403
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.228765, 4.126425, 5.368330
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.249066, 4.679071, 5.289546
Valid average loss all      (Triplet)                 : 0.277404

== Recognize ==
Valid average loss Recognize     : 0.853220
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.277404

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.687062740325928 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.922353982925415 sec. =
Valid knn accuracy bass      : 42.943548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.671396970748901 sec. =
Valid knn accuracy piano     : 64.453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.631081342697144 sec. =
Valid knn accuracy guitar    : 69.64285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.924754858016968 sec. =
Valid knn accuracy residuals : 91.81818181818183%

Valid knn accuracy average   : 70.98893377397498%

                                                                      [AEpoch 19: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=0.998]Epoch 19: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198993, 0.199460, 0.199445, 0.218815
Train average loss UNet                 (all)                : 0.816713

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000753, 2.698695, 4.864636
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005022, 2.918477, 4.286323
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002790, 3.413574, 4.930735
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004609, 3.572554, 5.309143
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003344, 4.046310, 5.958025
Train average loss all      (Triplet)                 : 0.003306

== Recognize ==
Train average loss Recognize     : 1.013969
Train average accuracy drums     : 50.115002 %
Train average accuracy bass      : 49.935001 %
Train average accuracy piano     : 50.410004 %
Train average accuracy guitar    : 49.174999 %
Train average accuracy residuals : 50.139999 %

== Train average loss all : 0.003306

Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]          Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]Epoch 20:  16%|█▌        | 50/313 [00:51<04:31,  0.97it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]Epoch 20:  16%|█▌        | 50/313 [00:51<04:31,  0.97it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.938, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]Epoch 20:  32%|███▏      | 100/313 [01:34<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.938, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]Epoch 20:  32%|███▏      | 100/313 [01:34<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.00195, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00195, Train/loss_recog_step=1.010, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]Epoch 20:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.00195, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00195, Train/loss_recog_step=1.010, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]Epoch 20:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.875, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.980, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]    Epoch 20:  64%|██████▍   | 200/313 [03:02<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.875, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.980, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]Epoch 20:  64%|██████▍   | 200/313 [03:02<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]Epoch 20:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]Epoch 20:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.00528, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00528, Train/loss_recog_step=0.892, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]Epoch 20:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.00528, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00528, Train/loss_recog_step=0.892, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]Epoch 20:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000559, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000559, Train/loss_recog_step=0.950, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]Epoch 20: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000559, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000559, Train/loss_recog_step=0.950, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]Epoch 20: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.187, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=0.683, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.76it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.35it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.26it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.00it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.45it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195383, 0.197998, 0.194519, 0.220661
Valid average loss UNet                 (all)                : 0.808561

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.080885, 3.017266, 4.431159
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.366482, 3.197356, 3.579623
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.582741, 4.387995, 4.561213
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.205365, 4.169059, 5.345684
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.176273, 4.679329, 5.338166
Valid average loss all      (Triplet)                 : 0.277427

== Recognize ==
Valid average loss Recognize     : 0.952673
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.277427

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.944063663482666 sec. =
Valid knn accuracy drums     : 81.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.440145015716553 sec. =
Valid knn accuracy bass      : 48.185483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.940396070480347 sec. =
Valid knn accuracy piano     : 64.2578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.766534090042114 sec. =
Valid knn accuracy guitar    : 67.63392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5925188064575195 sec. =
Valid knn accuracy residuals : 90.22727272727272%

Valid knn accuracy average   : 70.4522038817599%

                                                                      [AEpoch 20: 100%|██████████| 313/313 [05:49<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.010]Epoch 20: 100%|██████████| 313/313 [05:49<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198892, 0.199351, 0.199345, 0.218129
Train average loss UNet                 (all)                : 0.815717

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000792, 2.777832, 5.067286
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003191, 2.986319, 4.406839
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002523, 3.509984, 5.085853
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002614, 3.661368, 5.487493
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002056, 4.157770, 6.150631
Train average loss all      (Triplet)                 : 0.002293

== Recognize ==
Train average loss Recognize     : 1.003627
Train average accuracy drums     : 50.085003 %
Train average accuracy bass      : 49.520000 %
Train average accuracy piano     : 50.075001 %
Train average accuracy guitar    : 50.685001 %
Train average accuracy residuals : 49.294998 %

== Train average loss all : 0.002293

Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]          Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]Epoch 21:  16%|█▌        | 50/313 [00:50<04:24,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]Epoch 21:  16%|█▌        | 50/313 [00:50<04:24,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]Epoch 21:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]Epoch 21:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=1.000, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]Epoch 21:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=1.000, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]Epoch 21:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.00272, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=1.000, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]Epoch 21:  64%|██████▍   | 200/313 [03:02<01:43,  1.10it/s, v_num=0, Train/loss_all_step=0.00272, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=1.000, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]Epoch 21:  64%|██████▍   | 200/313 [03:02<01:43,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]    Epoch 21:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]Epoch 21:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.00105, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00105, Train/loss_recog_step=0.995, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]Epoch 21:  96%|█████████▌| 300/313 [04:31<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00105, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00105, Train/loss_recog_step=0.995, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]Epoch 21:  96%|█████████▌| 300/313 [04:31<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00389, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.937, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]Epoch 21: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.00389, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.937, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]Epoch 21: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.182, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.182, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.705, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.96it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.67it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.50it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.16it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195927, 0.198439, 0.195090, 0.221068
Valid average loss UNet                 (all)                : 0.810523

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.115794, 3.081654, 4.480684
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.383775, 3.398088, 3.751029
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.494770, 4.405868, 4.718653
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.204532, 4.295356, 5.546815
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.178749, 4.593990, 5.276082
Valid average loss all      (Triplet)                 : 0.265517

== Recognize ==
Valid average loss Recognize     : 0.950207
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 42.500000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.265517

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.162830352783203 sec. =
Valid knn accuracy drums     : 85.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.74329400062561 sec. =
Valid knn accuracy bass      : 48.99193548387097%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.862528324127197 sec. =
Valid knn accuracy piano     : 60.3515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.235205888748169 sec. =
Valid knn accuracy guitar    : 68.52678571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.635614633560181 sec. =
Valid knn accuracy residuals : 89.77272727272727%

Valid knn accuracy average   : 70.65903697678549%

                                                                      [AEpoch 21: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.000]Epoch 21: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198747, 0.199219, 0.199205, 0.218625
Train average loss UNet                 (all)                : 0.815795

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000738, 2.841137, 5.184037
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004157, 3.101227, 4.596741
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004874, 3.604501, 5.226007
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002679, 3.765275, 5.642907
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002033, 4.250414, 6.258672
Train average loss all      (Triplet)                 : 0.002971

== Recognize ==
Train average loss Recognize     : 1.013109
Train average accuracy drums     : 49.529999 %
Train average accuracy bass      : 50.325001 %
Train average accuracy piano     : 50.024998 %
Train average accuracy guitar    : 49.244999 %
Train average accuracy residuals : 49.880001 %

== Train average loss all : 0.002971

Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]          Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]Epoch 22:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]Epoch 22:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]Epoch 22:  32%|███▏      | 100/313 [01:37<03:28,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]Epoch 22:  32%|███▏      | 100/313 [01:37<03:28,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]Epoch 22:  48%|████▊     | 150/313 [02:20<02:32,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]Epoch 22:  48%|████▊     | 150/313 [02:20<02:32,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]Epoch 22:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]Epoch 22:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=0.974, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]Epoch 22:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=0.974, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]Epoch 22:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.00807, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00807, Train/loss_recog_step=0.999, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]Epoch 22:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00807, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00807, Train/loss_recog_step=0.999, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]Epoch 22:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00139, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.956, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]Epoch 22: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.00139, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.956, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]Epoch 22: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.943, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.80it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.35it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.43it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.69it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195852, 0.198413, 0.195091, 0.222436
Valid average loss UNet                 (all)                : 0.811792

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.105630, 3.202471, 4.899385
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.296680, 3.400324, 3.748981
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.538568, 4.578843, 4.753174
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.256936, 4.305047, 5.641313
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.201197, 4.762876, 5.374084
Valid average loss all      (Triplet)                 : 0.290853

== Recognize ==
Valid average loss Recognize     : 0.990658
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.290853

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.889507532119751 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.258316993713379 sec. =
Valid knn accuracy bass      : 47.37903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.239245176315308 sec. =
Valid knn accuracy piano     : 59.375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.134988784790039 sec. =
Valid knn accuracy guitar    : 70.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5355212688446045 sec. =
Valid knn accuracy residuals : 90.9090909090909%

Valid knn accuracy average   : 70.94295072038761%

                                                                      [AEpoch 22: 100%|██████████| 313/313 [05:52<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.010]Epoch 22: 100%|██████████| 313/313 [05:52<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198877, 0.199345, 0.199332, 0.219086
Train average loss UNet                 (all)                : 0.816640

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000527, 2.933344, 5.280345
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003879, 3.269594, 4.821171
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004105, 3.709837, 5.392649
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002385, 3.864072, 5.803169
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000859, 4.312030, 6.377054
Train average loss all      (Triplet)                 : 0.002361

== Recognize ==
Train average loss Recognize     : 1.009229
Train average accuracy drums     : 50.795002 %
Train average accuracy bass      : 50.204998 %
Train average accuracy piano     : 50.105000 %
Train average accuracy guitar    : 50.454998 %
Train average accuracy residuals : 50.215000 %

== Train average loss all : 0.002361

Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]          Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]Epoch 23:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]Epoch 23:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.00541, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00541, Train/loss_recog_step=1.020, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]Epoch 23:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.00541, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00541, Train/loss_recog_step=1.020, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]Epoch 23:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.00106, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00106, Train/loss_recog_step=1.050, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]Epoch 23:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.00106, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00106, Train/loss_recog_step=1.050, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]Epoch 23:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=1.040, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]  Epoch 23:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=1.040, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]Epoch 23:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.000645, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000645, Train/loss_recog_step=1.030, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]Epoch 23:  80%|███████▉  | 250/313 [03:44<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000645, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000645, Train/loss_recog_step=1.030, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]Epoch 23:  80%|███████▉  | 250/313 [03:44<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]      Epoch 23:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]Epoch 23:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.00197, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00197, Train/loss_recog_step=0.993, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]Epoch 23: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.00197, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00197, Train/loss_recog_step=0.993, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]Epoch 23: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00483, Train/loss_recog_step=0.965, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.295, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.291, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.291, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.87it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.15it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196088, 0.198538, 0.195292, 0.225296
Valid average loss UNet                 (all)                : 0.815214

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077341, 3.180976, 4.917611
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.386853, 3.608162, 4.002435
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.538993, 4.586846, 4.704134
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.234402, 4.455067, 5.773756
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.174801, 4.786641, 5.510122
Valid average loss all      (Triplet)                 : 0.280126

== Recognize ==
Valid average loss Recognize     : 0.973884
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 44.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.280126

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.164084434509277 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.640051126480103 sec. =
Valid knn accuracy bass      : 47.78225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.774370908737183 sec. =
Valid knn accuracy piano     : 64.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.886946678161621 sec. =
Valid knn accuracy guitar    : 70.53571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.882181167602539 sec. =
Valid knn accuracy residuals : 90.68181818181819%

Valid knn accuracy average   : 71.77312386727928%

                                                                      [AEpoch 23: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00483, Train/loss_recog_step=0.965, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00236, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00236, Train/loss_recog_epoch=1.010]Epoch 23: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00483, Train/loss_recog_step=0.965, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198882, 0.199360, 0.199347, 0.219192
Train average loss UNet                 (all)                : 0.816782

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000702, 2.991606, 5.414194
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004095, 3.271677, 4.855435
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003168, 3.764988, 5.480697
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003661, 3.963825, 5.948161
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001880, 4.333261, 6.392143
Train average loss all      (Triplet)                 : 0.002717

== Recognize ==
Train average loss Recognize     : 1.026298
Train average accuracy drums     : 50.160004 %
Train average accuracy bass      : 50.360001 %
Train average accuracy piano     : 49.709999 %
Train average accuracy guitar    : 49.845001 %
Train average accuracy residuals : 50.355000 %

== Train average loss all : 0.002717

Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00483, Train/loss_recog_step=0.965, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]          Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00483, Train/loss_recog_step=0.965, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]Epoch 24:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00483, Train/loss_recog_step=0.965, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]Epoch 24:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.983, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]    Epoch 24:  32%|███▏      | 100/313 [01:35<03:23,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.983, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]Epoch 24:  32%|███▏      | 100/313 [01:35<03:23,  1.05it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.00354, Train/loss_recog_step=0.943, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]Epoch 24:  48%|████▊     | 150/313 [02:19<02:32,  1.07it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.00354, Train/loss_recog_step=0.943, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]Epoch 24:  48%|████▊     | 150/313 [02:19<02:32,  1.07it/s, v_num=0, Train/loss_all_step=0.00512, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00512, Train/loss_recog_step=1.040, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]Epoch 24:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.00512, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00512, Train/loss_recog_step=1.040, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]Epoch 24:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.975, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]  Epoch 24:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.975, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]Epoch 24:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.00148, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00148, Train/loss_recog_step=0.961, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]Epoch 24:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00148, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00148, Train/loss_recog_step=0.961, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]Epoch 24:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]    Epoch 24: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]Epoch 24: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.206, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.280, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.70it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.90it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.02it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.24it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196223, 0.198731, 0.195436, 0.224457
Valid average loss UNet                 (all)                : 0.814847

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.096316, 3.246870, 5.011703
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.348590, 3.584631, 4.001094
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.401235, 4.478918, 4.818193
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.204159, 4.456184, 5.831406
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.169656, 4.899725, 5.665511
Valid average loss all      (Triplet)                 : 0.219036

== Recognize ==
Valid average loss Recognize     : 0.986202
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.219036

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.1292901039123535 sec. =
Valid knn accuracy drums     : 86.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.871617555618286 sec. =
Valid knn accuracy bass      : 41.33064516129033%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.548121690750122 sec. =
Valid knn accuracy piano     : 63.28125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.594990253448486 sec. =
Valid knn accuracy guitar    : 69.19642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.039343357086182 sec. =
Valid knn accuracy residuals : 87.72727272727273%

Valid knn accuracy average   : 69.61146711808527%

                                                                      [AEpoch 24: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.030]Epoch 24: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198989, 0.199457, 0.199450, 0.218693
Train average loss UNet                 (all)                : 0.816589

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000945, 3.036573, 5.497682
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003799, 3.320613, 4.953614
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003142, 3.725660, 5.446347
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002854, 3.950329, 5.944216
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002003, 4.389461, 6.488889
Train average loss all      (Triplet)                 : 0.002548

== Recognize ==
Train average loss Recognize     : 1.028790
Train average accuracy drums     : 49.474998 %
Train average accuracy bass      : 49.184998 %
Train average accuracy piano     : 50.195004 %
Train average accuracy guitar    : 50.199997 %
Train average accuracy residuals : 49.540001 %

== Train average loss all : 0.002548

Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]          Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]Epoch 25:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]Epoch 25:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000105, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000105, Train/loss_recog_step=1.010, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]Epoch 25:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.000105, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000105, Train/loss_recog_step=1.010, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]Epoch 25:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.00493, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00493, Train/loss_recog_step=1.030, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]  Epoch 25:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.00493, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00493, Train/loss_recog_step=1.030, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]Epoch 25:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.012, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=1.020, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]    Epoch 25:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.012, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=1.020, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]Epoch 25:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]Epoch 25:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]Epoch 25:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00917, Train/loss_recog_step=1.080, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]Epoch 25:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00917, Train/loss_recog_step=1.080, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]Epoch 25:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00698, Train/loss_recog_step=0.977, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]Epoch 25: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.00698, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00698, Train/loss_recog_step=0.977, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]Epoch 25: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00468, Train/loss_recog_step=1.160, Valid/loss_all_step=0.012, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.012, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.815, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.696, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.73it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.92it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.47it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.50it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.49it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.07it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196273, 0.198740, 0.195468, 0.217232
Valid average loss UNet                 (all)                : 0.807713

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.063213, 3.305590, 4.889197
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.371182, 3.657532, 4.051621
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.507028, 4.582146, 4.685315
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.222462, 4.466048, 5.845086
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.208186, 5.043121, 5.662172
Valid average loss all      (Triplet)                 : 0.267618

== Recognize ==
Valid average loss Recognize     : 0.909698
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.267618

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.81857967376709 sec. =
Valid knn accuracy drums     : 86.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.106911659240723 sec. =
Valid knn accuracy bass      : 44.354838709677416%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.811380863189697 sec. =
Valid knn accuracy piano     : 66.2109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.709758520126343 sec. =
Valid knn accuracy guitar    : 67.85714285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.56578516960144 sec. =
Valid knn accuracy residuals : 88.63636363636364%

Valid knn accuracy average   : 70.71620436672373%

                                                                      [AEpoch 25: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00468, Train/loss_recog_step=1.160, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00255, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.030]Epoch 25: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00468, Train/loss_recog_step=1.160, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198948, 0.199425, 0.199409, 0.218047
Train average loss UNet                 (all)                : 0.815830

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000613, 3.078550, 5.602074
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004788, 3.337158, 4.956611
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002249, 3.710431, 5.420794
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003179, 4.005574, 6.081810
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001616, 4.400702, 6.539170
Train average loss all      (Triplet)                 : 0.002489

== Recognize ==
Train average loss Recognize     : 1.031530
Train average accuracy drums     : 50.290001 %
Train average accuracy bass      : 49.285000 %
Train average accuracy piano     : 50.059998 %
Train average accuracy guitar    : 49.689999 %
Train average accuracy residuals : 50.295002 %

== Train average loss all : 0.002489

Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00468, Train/loss_recog_step=1.160, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]          Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00468, Train/loss_recog_step=1.160, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]Epoch 26:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00468, Train/loss_recog_step=1.160, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]Epoch 26:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]    Epoch 26:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]Epoch 26:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]Epoch 26:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]Epoch 26:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.00452, Train/loss_recog_step=1.060, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]Epoch 26:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.00452, Train/loss_recog_step=1.060, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]Epoch 26:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.00217, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00217, Train/loss_recog_step=1.060, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]Epoch 26:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.00217, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00217, Train/loss_recog_step=1.060, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]Epoch 26:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000182, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000182, Train/loss_recog_step=1.050, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]Epoch 26:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000182, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000182, Train/loss_recog_step=1.050, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]Epoch 26:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000238, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000238, Train/loss_recog_step=0.944, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]Epoch 26: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000238, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000238, Train/loss_recog_step=0.944, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]Epoch 26: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.778, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.707, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.36it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.52it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.92it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.38it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195882, 0.198445, 0.195082, 0.218488
Valid average loss UNet                 (all)                : 0.807896

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070012, 3.335426, 4.875965
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.433994, 3.634665, 3.925833
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.543008, 4.580833, 4.724435
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.242919, 4.561140, 5.949357
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.171716, 4.935935, 5.600174
Valid average loss all      (Triplet)                 : 0.296156

== Recognize ==
Valid average loss Recognize     : 0.979192
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 40.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.296156

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.554426670074463 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.463500261306763 sec. =
Valid knn accuracy bass      : 42.943548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.204911231994629 sec. =
Valid knn accuracy piano     : 62.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.154858112335205 sec. =
Valid knn accuracy guitar    : 70.53571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.562548398971558 sec. =
Valid knn accuracy residuals : 89.31818181818181%

Valid knn accuracy average   : 70.1464454199377%

                                                                      [AEpoch 26: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.030]Epoch 26: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198860, 0.199335, 0.199321, 0.219244
Train average loss UNet                 (all)                : 0.816761

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000386, 3.102000, 5.617512
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004180, 3.370700, 4.973021
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002098, 3.816456, 5.577100
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002087, 4.071569, 6.228961
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002415, 4.535692, 6.719922
Train average loss all      (Triplet)                 : 0.002275

== Recognize ==
Train average loss Recognize     : 1.036977
Train average accuracy drums     : 50.085003 %
Train average accuracy bass      : 49.880001 %
Train average accuracy piano     : 49.974998 %
Train average accuracy guitar    : 49.770000 %
Train average accuracy residuals : 50.045002 %

== Train average loss all : 0.002275

Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]          Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]Epoch 27:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]Epoch 27:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.0033, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0033, Train/loss_recog_step=1.030, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]Epoch 27:  32%|███▏      | 100/313 [01:34<03:21,  1.06it/s, v_num=0, Train/loss_all_step=0.0033, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0033, Train/loss_recog_step=1.030, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]Epoch 27:  32%|███▏      | 100/313 [01:34<03:21,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.994, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]  Epoch 27:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.994, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]Epoch 27:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]Epoch 27:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]Epoch 27:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.00228, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=1.080, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]Epoch 27:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.00228, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=1.080, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]Epoch 27:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]    Epoch 27:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]Epoch 27:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]Epoch 27: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]Epoch 27: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.264, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.264, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.296, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.701, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.00it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.67it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.38it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196136, 0.198544, 0.195340, 0.224420
Valid average loss UNet                 (all)                : 0.814439

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.059316, 3.509868, 5.140697
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.448302, 3.808794, 4.187114
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.573812, 4.756913, 4.841719
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.279388, 4.669017, 5.898382
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.327434, 5.206703, 5.776644
Valid average loss all      (Triplet)                 : 0.331906

== Recognize ==
Valid average loss Recognize     : 0.947252
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 43.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.331906

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.340957164764404 sec. =
Valid knn accuracy drums     : 90.43478260869566%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.486398935317993 sec. =
Valid knn accuracy bass      : 38.104838709677416%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.999416589736938 sec. =
Valid knn accuracy piano     : 67.96875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.149942398071289 sec. =
Valid knn accuracy guitar    : 70.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.303282976150513 sec. =
Valid knn accuracy residuals : 90.0%

Valid knn accuracy average   : 71.36417426367461%

                                                                      [AEpoch 27: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.040]Epoch 27: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198882, 0.199348, 0.199335, 0.218590
Train average loss UNet                 (all)                : 0.816156

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000614, 3.140307, 5.702448
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004449, 3.410171, 5.067553
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002486, 3.870454, 5.668515
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002293, 4.108882, 6.222949
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001318, 4.603116, 6.832310
Train average loss all      (Triplet)                 : 0.002296

== Recognize ==
Train average loss Recognize     : 1.045532
Train average accuracy drums     : 50.064999 %
Train average accuracy bass      : 50.360001 %
Train average accuracy piano     : 50.225002 %
Train average accuracy guitar    : 50.860001 %
Train average accuracy residuals : 50.029999 %

== Train average loss all : 0.002296

Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]          Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]Epoch 28:  16%|█▌        | 50/313 [00:50<04:27,  0.98it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]Epoch 28:  16%|█▌        | 50/313 [00:50<04:27,  0.98it/s, v_num=0, Train/loss_all_step=0.00411, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=1.160, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]Epoch 28:  32%|███▏      | 100/313 [01:35<03:24,  1.04it/s, v_num=0, Train/loss_all_step=0.00411, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=1.160, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]Epoch 28:  32%|███▏      | 100/313 [01:35<03:24,  1.04it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=1.020, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]  Epoch 28:  48%|████▊     | 150/313 [02:21<02:33,  1.06it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=1.020, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]Epoch 28:  48%|████▊     | 150/313 [02:21<02:33,  1.06it/s, v_num=0, Train/loss_all_step=0.00969, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.00969, Train/loss_recog_step=0.989, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]Epoch 28:  64%|██████▍   | 200/313 [03:04<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.00969, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.00969, Train/loss_recog_step=0.989, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]Epoch 28:  64%|██████▍   | 200/313 [03:04<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]    Epoch 28:  80%|███████▉  | 250/313 [03:49<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]Epoch 28:  80%|███████▉  | 250/313 [03:49<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.00236, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=0.962, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]Epoch 28:  96%|█████████▌| 300/313 [04:32<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.00236, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=0.962, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]Epoch 28:  96%|█████████▌| 300/313 [04:32<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]    Epoch 28: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]Epoch 28: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.791, Valid/loss_all_epoch=0.332, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.332, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.714, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.93it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.38it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.28it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.66it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195936, 0.198483, 0.195103, 0.223312
Valid average loss UNet                 (all)                : 0.812833

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064055, 3.393444, 5.159058
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.370544, 3.787375, 4.170026
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.680800, 4.928514, 4.901088
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.213068, 4.580850, 6.050445
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.286872, 4.975816, 5.670163
Valid average loss all      (Triplet)                 : 0.326967

== Recognize ==
Valid average loss Recognize     : 0.932543
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 54.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.326967

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.892983675003052 sec. =
Valid knn accuracy drums     : 89.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.64541244506836 sec. =
Valid knn accuracy bass      : 46.774193548387096%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.76415467262268 sec. =
Valid knn accuracy piano     : 65.234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.819112062454224 sec. =
Valid knn accuracy guitar    : 66.51785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.004286050796509 sec. =
Valid knn accuracy residuals : 89.77272727272727%

Valid knn accuracy average   : 71.52939581018559%

                                                                      [AEpoch 28: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.050]Epoch 28: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198899, 0.199364, 0.199351, 0.218697
Train average loss UNet                 (all)                : 0.816311

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000431, 3.123697, 5.777080
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004862, 3.453148, 5.116262
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003381, 3.931075, 5.717704
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002568, 4.156713, 6.274679
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002416, 4.628665, 6.891729
Train average loss all      (Triplet)                 : 0.002741

== Recognize ==
Train average loss Recognize     : 1.054971
Train average accuracy drums     : 50.820000 %
Train average accuracy bass      : 50.054996 %
Train average accuracy piano     : 49.590000 %
Train average accuracy guitar    : 49.669998 %
Train average accuracy residuals : 50.050003 %

== Train average loss all : 0.002741

Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]          Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]Epoch 29:  16%|█▌        | 50/313 [00:49<04:21,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]Epoch 29:  16%|█▌        | 50/313 [00:49<04:21,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]Epoch 29:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]Epoch 29:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]Epoch 29:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]Epoch 29:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.00198, Train/loss_unet_all_step=0.860, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=1.140, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]Epoch 29:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.00198, Train/loss_unet_all_step=0.860, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=1.140, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]Epoch 29:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]    Epoch 29:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]Epoch 29:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.00297, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00297, Train/loss_recog_step=0.987, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]Epoch 29:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.00297, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00297, Train/loss_recog_step=0.987, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]Epoch 29:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.00736, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00736, Train/loss_recog_step=1.130, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]Epoch 29: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.00736, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00736, Train/loss_recog_step=1.130, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]Epoch 29: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.388, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.327, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.89it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.91it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.16it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.67it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195966, 0.198436, 0.195096, 0.228082
Valid average loss UNet                 (all)                : 0.817579

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.066714, 3.533287, 5.124062
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.391830, 3.852941, 4.305887
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.593999, 4.973797, 5.031235
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.199953, 4.653723, 6.077581
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.232170, 5.025398, 5.714327
Valid average loss all      (Triplet)                 : 0.296518

== Recognize ==
Valid average loss Recognize     : 0.945298
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.296518

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.682261943817139 sec. =
Valid knn accuracy drums     : 90.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.147780656814575 sec. =
Valid knn accuracy bass      : 43.54838709677419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.621741533279419 sec. =
Valid knn accuracy piano     : 64.2578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.7220299243927 sec. =
Valid knn accuracy guitar    : 63.61607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.495594501495361 sec. =
Valid knn accuracy residuals : 91.81818181818183%

Valid knn accuracy average   : 70.64809056870548%

                                                                      [AEpoch 29: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.050]Epoch 29: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198839, 0.199312, 0.199300, 0.218493
Train average loss UNet                 (all)                : 0.815945

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000928, 3.212270, 5.899261
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004241, 3.516868, 5.244412
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003529, 4.031577, 5.890306
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002358, 4.187305, 6.363560
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001147, 4.691505, 6.999245
Train average loss all      (Triplet)                 : 0.002438

== Recognize ==
Train average loss Recognize     : 1.059632
Train average accuracy drums     : 49.724998 %
Train average accuracy bass      : 50.215000 %
Train average accuracy piano     : 49.939999 %
Train average accuracy guitar    : 49.845001 %
Train average accuracy residuals : 49.825001 %

== Train average loss all : 0.002438

Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]          Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]Epoch 30:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]Epoch 30:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]Epoch 30:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]Epoch 30:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]Epoch 30:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]Epoch 30:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.000625, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.000625, Train/loss_recog_step=1.030, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]Epoch 30:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.000625, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.000625, Train/loss_recog_step=1.030, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]Epoch 30:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]      Epoch 30:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]Epoch 30:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]Epoch 30:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]Epoch 30:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0066, Train/loss_recog_step=1.080, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]Epoch 30: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0066, Train/loss_recog_step=1.080, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]Epoch 30: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.283, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.46it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.58it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.47it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.35it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.74it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196155, 0.198537, 0.195349, 0.237132
Valid average loss UNet                 (all)                : 0.827173

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.072206, 3.647500, 5.486745
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.336788, 3.911970, 4.391557
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.680776, 5.185495, 5.239157
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.187008, 4.806650, 6.128079
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.220675, 5.312863, 6.077679
Valid average loss all      (Triplet)                 : 0.312862

== Recognize ==
Valid average loss Recognize     : 1.009466
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 41.500000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.312862

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.67507290840149 sec. =
Valid knn accuracy drums     : 90.65217391304347%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.287006616592407 sec. =
Valid knn accuracy bass      : 50.403225806451616%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.352392673492432 sec. =
Valid knn accuracy piano     : 65.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.088671922683716 sec. =
Valid knn accuracy guitar    : 70.08928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.446656227111816 sec. =
Valid knn accuracy residuals : 91.36363636363637%

Valid knn accuracy average   : 73.62666435948343%

                                                                      [AEpoch 30: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.060]Epoch 30: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198889, 0.199365, 0.199348, 0.218260
Train average loss UNet                 (all)                : 0.815862

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000846, 3.274202, 6.022281
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003103, 3.523000, 5.283617
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002895, 4.048841, 5.928740
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001765, 4.211714, 6.422308
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002064, 4.709466, 6.992871
Train average loss all      (Triplet)                 : 0.002176

== Recognize ==
Train average loss Recognize     : 1.060398
Train average accuracy drums     : 50.225002 %
Train average accuracy bass      : 50.040001 %
Train average accuracy piano     : 50.814999 %
Train average accuracy guitar    : 49.810001 %
Train average accuracy residuals : 50.059998 %

== Train average loss all : 0.002176

Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]          Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]Epoch 31:  16%|█▌        | 50/313 [00:49<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]Epoch 31:  16%|█▌        | 50/313 [00:49<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.00552, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00552, Train/loss_recog_step=1.010, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]Epoch 31:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.00552, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00552, Train/loss_recog_step=1.010, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]Epoch 31:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.000131, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.000131, Train/loss_recog_step=1.060, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]Epoch 31:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.000131, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.000131, Train/loss_recog_step=1.060, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]Epoch 31:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]      Epoch 31:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]Epoch 31:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]Epoch 31:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]Epoch 31:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]Epoch 31:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]Epoch 31:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=1.080, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]Epoch 31: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=1.080, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]Epoch 31: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.821, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.736, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.69it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.88it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.49it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195604, 0.198174, 0.194773, 0.219034
Valid average loss UNet                 (all)                : 0.807584

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098945, 3.764871, 6.044721
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.265163, 3.982883, 4.477365
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.726015, 5.169340, 5.222758
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.267265, 4.806105, 6.294113
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.171920, 5.340789, 6.090219
Valid average loss all      (Triplet)                 : 0.333044

== Recognize ==
Valid average loss Recognize     : 1.053677
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.333044

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.338789463043213 sec. =
Valid knn accuracy drums     : 85.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.181933879852295 sec. =
Valid knn accuracy bass      : 47.37903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.677788257598877 sec. =
Valid knn accuracy piano     : 63.8671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.66357684135437 sec. =
Valid knn accuracy guitar    : 66.29464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.136775255203247 sec. =
Valid knn accuracy residuals : 87.5%

Valid knn accuracy average   : 70.18208556651973%

                                                                      [AEpoch 31: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00218, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00218, Train/loss_recog_epoch=1.060]Epoch 31: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198820, 0.199299, 0.199281, 0.219005
Train average loss UNet                 (all)                : 0.816405

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000903, 3.452895, 6.537833
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004053, 3.633162, 5.434390
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002950, 4.136443, 6.037316
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002514, 4.310839, 6.546299
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002097, 4.793092, 7.176922
Train average loss all      (Triplet)                 : 0.002570

== Recognize ==
Train average loss Recognize     : 1.065789
Train average accuracy drums     : 49.834999 %
Train average accuracy bass      : 49.704998 %
Train average accuracy piano     : 49.739998 %
Train average accuracy guitar    : 50.410004 %
Train average accuracy residuals : 50.435001 %

== Train average loss all : 0.002570

Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]          Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]Epoch 32:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]Epoch 32:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.0017, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.943, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]Epoch 32:  32%|███▏      | 100/313 [01:33<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.0017, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.943, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]Epoch 32:  32%|███▏      | 100/313 [01:33<03:20,  1.06it/s, v_num=0, Train/loss_all_step=9.61e-5, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=9.61e-5, Train/loss_recog_step=1.130, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]Epoch 32:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=9.61e-5, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=9.61e-5, Train/loss_recog_step=1.130, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]Epoch 32:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]    Epoch 32:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]Epoch 32:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00658, Train/loss_recog_step=1.140, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]Epoch 32:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.00658, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00658, Train/loss_recog_step=1.140, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]Epoch 32:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]    Epoch 32:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]Epoch 32:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00319, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=1.080, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]Epoch 32: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.00319, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=1.080, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]Epoch 32: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.333, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.69it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.77it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.36it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.34it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195553, 0.198169, 0.194725, 0.229080
Valid average loss UNet                 (all)                : 0.817527

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099050, 3.764832, 5.721195
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.343355, 4.093168, 4.523299
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.636262, 5.241571, 5.487679
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.197660, 4.909213, 6.494835
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.159220, 5.315780, 6.144427
Valid average loss all      (Triplet)                 : 0.294938

== Recognize ==
Valid average loss Recognize     : 0.965066
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.294938

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.331030368804932 sec. =
Valid knn accuracy drums     : 89.56521739130436%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.192078113555908 sec. =
Valid knn accuracy bass      : 43.95161290322581%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.575517177581787 sec. =
Valid knn accuracy piano     : 64.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.603341579437256 sec. =
Valid knn accuracy guitar    : 65.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.487143039703369 sec. =
Valid knn accuracy residuals : 90.22727272727272%

Valid knn accuracy average   : 70.80350810436057%

                                                                      [AEpoch 32: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.00257, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.070]Epoch 32: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198655, 0.199132, 0.199118, 0.218210
Train average loss UNet                 (all)                : 0.815114

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000536, 3.423022, 6.239648
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003248, 3.715279, 5.537025
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002438, 4.223488, 6.175266
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003591, 4.402620, 6.655649
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001917, 4.862054, 7.263019
Train average loss all      (Triplet)                 : 0.002298

== Recognize ==
Train average loss Recognize     : 1.059867
Train average accuracy drums     : 50.545002 %
Train average accuracy bass      : 49.715000 %
Train average accuracy piano     : 50.360001 %
Train average accuracy guitar    : 50.209999 %
Train average accuracy residuals : 49.559998 %

== Train average loss all : 0.002298

Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]          Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]Epoch 33:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]Epoch 33:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]Epoch 33:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]Epoch 33:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]Epoch 33:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]Epoch 33:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.00197, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.00197, Train/loss_recog_step=1.060, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]Epoch 33:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.00197, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.00197, Train/loss_recog_step=1.060, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]Epoch 33:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]    Epoch 33:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]Epoch 33:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]Epoch 33:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]Epoch 33:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]Epoch 33: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]Epoch 33: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.708, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.66it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.02it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.65it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.62it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.34it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.90it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195891, 0.198411, 0.195072, 0.218758
Valid average loss UNet                 (all)                : 0.808132

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.079281, 3.708852, 5.806604
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.386130, 4.011280, 4.358901
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.624380, 5.396131, 5.644713
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.259618, 5.095881, 6.486150
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.215950, 5.354856, 6.191084
Valid average loss all      (Triplet)                 : 0.314774

== Recognize ==
Valid average loss Recognize     : 0.983952
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.314774

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.041880130767822 sec. =
Valid knn accuracy drums     : 92.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.794867277145386 sec. =
Valid knn accuracy bass      : 43.95161290322581%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.666670560836792 sec. =
Valid knn accuracy piano     : 68.9453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.109680652618408 sec. =
Valid knn accuracy guitar    : 70.98214285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.999589920043945 sec. =
Valid knn accuracy residuals : 90.22727272727272%

Valid knn accuracy average   : 73.34300732796306%

                                                                      [AEpoch 33: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.060]Epoch 33: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198734, 0.199217, 0.199199, 0.218946
Train average loss UNet                 (all)                : 0.816096

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000972, 3.435700, 6.284757
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001932, 3.682059, 5.532101
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001678, 4.270599, 6.263847
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002792, 4.443350, 6.755429
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002202, 4.868869, 7.264287
Train average loss all      (Triplet)                 : 0.001969

== Recognize ==
Train average loss Recognize     : 1.061503
Train average accuracy drums     : 49.845001 %
Train average accuracy bass      : 49.869999 %
Train average accuracy piano     : 50.430000 %
Train average accuracy guitar    : 50.669998 %
Train average accuracy residuals : 50.050003 %

== Train average loss all : 0.001969

Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]          Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]Epoch 34:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]Epoch 34:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]Epoch 34:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]Epoch 34:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]Epoch 34:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]Epoch 34:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.000416, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.000416, Train/loss_recog_step=1.040, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]Epoch 34:  64%|██████▍   | 200/313 [03:02<01:43,  1.10it/s, v_num=0, Train/loss_all_step=0.000416, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.000416, Train/loss_recog_step=1.040, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]Epoch 34:  64%|██████▍   | 200/313 [03:02<01:43,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]      Epoch 34:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]Epoch 34:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]Epoch 34:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]Epoch 34:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00103, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00103, Train/loss_recog_step=1.040, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]Epoch 34: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.00103, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00103, Train/loss_recog_step=1.040, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]Epoch 34: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.733, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.84it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.61it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.45it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.38it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195900, 0.198366, 0.195100, 0.223328
Valid average loss UNet                 (all)                : 0.812694

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.086759, 3.705676, 5.962332
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.369863, 4.070919, 4.601203
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.643309, 5.384108, 5.459558
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.274787, 5.034943, 6.584133
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.290867, 5.317943, 6.104580
Valid average loss all      (Triplet)                 : 0.320544

== Recognize ==
Valid average loss Recognize     : 0.961626
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 44.000000 %

== Valid average loss all : 0.320544

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.606548547744751 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.426799297332764 sec. =
Valid knn accuracy bass      : 36.895161290322584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.748729944229126 sec. =
Valid knn accuracy piano     : 63.8671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3475282192230225 sec. =
Valid knn accuracy guitar    : 68.97321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.2034735679626465 sec. =
Valid knn accuracy residuals : 88.18181818181819%

Valid knn accuracy average   : 68.62695451244058%

                                                                      [AEpoch 34: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00197, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.060]Epoch 34: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.199011, 0.199486, 0.199475, 0.218356
Train average loss UNet                 (all)                : 0.816328

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001213, 3.496763, 6.507083
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003137, 3.670432, 5.457006
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003681, 4.298332, 6.308279
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001931, 4.442978, 6.780406
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001938, 4.890737, 7.333051
Train average loss all      (Triplet)                 : 0.002382

== Recognize ==
Train average loss Recognize     : 1.059835
Train average accuracy drums     : 50.660004 %
Train average accuracy bass      : 50.174999 %
Train average accuracy piano     : 50.094997 %
Train average accuracy guitar    : 49.544998 %
Train average accuracy residuals : 49.849998 %

== Train average loss all : 0.002382

Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]          Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]Epoch 35:  16%|█▌        | 50/313 [00:50<04:24,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]Epoch 35:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.00627, Train/loss_recog_step=1.090, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]Epoch 35:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.00627, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.00627, Train/loss_recog_step=1.090, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]Epoch 35:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.00743, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00743, Train/loss_recog_step=1.130, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]Epoch 35:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.00743, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00743, Train/loss_recog_step=1.130, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]Epoch 35:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]    Epoch 35:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]Epoch 35:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]Epoch 35:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]Epoch 35:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]Epoch 35:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]Epoch 35:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=1.110, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]Epoch 35: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=1.110, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]Epoch 35: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.784, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.962, Valid/knn_avr=0.686, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.44it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.98it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.22it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.77it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195592, 0.198165, 0.194741, 0.220281
Valid average loss UNet                 (all)                : 0.808779

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099955, 3.808127, 5.977940
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.356413, 4.103664, 4.660607
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.765016, 5.682297, 5.658544
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.277122, 4.987692, 6.324240
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.443182, 5.631375, 6.278549
Valid average loss all      (Triplet)                 : 0.369632

== Recognize ==
Valid average loss Recognize     : 0.984837
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 60.500000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.369632

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.149407625198364 sec. =
Valid knn accuracy drums     : 87.60869565217392%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.04866909980774 sec. =
Valid knn accuracy bass      : 41.53225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.121143817901611 sec. =
Valid knn accuracy piano     : 64.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.135249137878418 sec. =
Valid knn accuracy guitar    : 72.99107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.367213726043701 sec. =
Valid knn accuracy residuals : 87.5%

Valid knn accuracy average   : 70.85609252905229%

                                                                      [AEpoch 35: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.060]Epoch 35: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198897, 0.199380, 0.199362, 0.219454
Train average loss UNet                 (all)                : 0.817094

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000419, 3.561444, 6.701581
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003145, 3.777921, 5.636129
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001893, 4.309044, 6.310163
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001379, 4.452612, 6.791358
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002237, 4.957942, 7.460330
Train average loss all      (Triplet)                 : 0.001828

== Recognize ==
Train average loss Recognize     : 1.070093
Train average accuracy drums     : 50.459999 %
Train average accuracy bass      : 49.855000 %
Train average accuracy piano     : 49.840000 %
Train average accuracy guitar    : 50.185001 %
Train average accuracy residuals : 50.379997 %

== Train average loss all : 0.001828

Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]          Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]Epoch 36:  16%|█▌        | 50/313 [00:51<04:29,  0.98it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]Epoch 36:  16%|█▌        | 50/313 [00:51<04:29,  0.98it/s, v_num=0, Train/loss_all_step=0.0021, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=1.040, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]Epoch 36:  32%|███▏      | 100/313 [01:34<03:21,  1.06it/s, v_num=0, Train/loss_all_step=0.0021, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=1.040, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]Epoch 36:  32%|███▏      | 100/313 [01:34<03:21,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]  Epoch 36:  48%|████▊     | 150/313 [02:20<02:33,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]Epoch 36:  48%|████▊     | 150/313 [02:20<02:33,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]Epoch 36:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]Epoch 36:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00317, Train/loss_recog_step=1.040, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]Epoch 36:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00317, Train/loss_recog_step=1.040, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]Epoch 36:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.000166, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000166, Train/loss_recog_step=1.070, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]Epoch 36:  96%|█████████▌| 300/313 [04:32<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.000166, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000166, Train/loss_recog_step=1.070, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]Epoch 36:  96%|█████████▌| 300/313 [04:32<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]      Epoch 36: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]Epoch 36: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.431, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.431, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.370, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.370, Valid/loss_recog_epoch=0.985, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.94it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.08it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.45it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.17it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196374, 0.198766, 0.195640, 0.207240
Valid average loss UNet                 (all)                : 0.798020

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.086006, 3.859354, 5.962358
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.418998, 4.143095, 4.644295
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.817674, 5.686131, 5.604114
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.248428, 5.063932, 6.307268
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.406721, 5.691567, 6.270849
Valid average loss all      (Triplet)                 : 0.406987

== Recognize ==
Valid average loss Recognize     : 1.075373
Valid average accuracy drums     : 41.500000 %
Valid average accuracy bass      : 43.000000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.406987

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.421600818634033 sec. =
Valid knn accuracy drums     : 90.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.499048948287964 sec. =
Valid knn accuracy bass      : 36.29032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.014219522476196 sec. =
Valid knn accuracy piano     : 66.015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.576682090759277 sec. =
Valid knn accuracy guitar    : 72.32142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.266618013381958 sec. =
Valid knn accuracy residuals : 85.9090909090909%

Valid knn accuracy average   : 70.15077167310248%

                                                                      [AEpoch 36: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00183, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.070]Epoch 36: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198822, 0.199297, 0.199275, 0.218570
Train average loss UNet                 (all)                : 0.815964

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000449, 3.596796, 6.807588
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004544, 3.809109, 5.674560
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002651, 4.377317, 6.420428
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002194, 4.479507, 6.774241
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001697, 5.028077, 7.566912
Train average loss all      (Triplet)                 : 0.002369

== Recognize ==
Train average loss Recognize     : 1.063776
Train average accuracy drums     : 49.575001 %
Train average accuracy bass      : 50.195004 %
Train average accuracy piano     : 50.355000 %
Train average accuracy guitar    : 50.265003 %
Train average accuracy residuals : 49.919998 %

== Train average loss all : 0.002369

Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]          Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]Epoch 37:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]Epoch 37:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00339, Train/loss_recog_step=1.090, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]Epoch 37:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00339, Train/loss_recog_step=1.090, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]Epoch 37:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0143, Train/loss_recog_step=0.998, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]  Epoch 37:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0143, Train/loss_recog_step=0.998, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]Epoch 37:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00689, Train/loss_recog_step=1.080, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]Epoch 37:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00689, Train/loss_recog_step=1.080, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]Epoch 37:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]    Epoch 37:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]Epoch 37:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000597, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000597, Train/loss_recog_step=1.030, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]Epoch 37:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000597, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000597, Train/loss_recog_step=1.030, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]Epoch 37:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]      Epoch 37: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]Epoch 37: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.527, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.527, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.798, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.702, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.71it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.20it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.11it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.66it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195783, 0.198277, 0.195003, 0.223519
Valid average loss UNet                 (all)                : 0.812582

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.105903, 3.897786, 6.020427
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.406224, 4.195973, 4.682707
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.672187, 5.611169, 5.743408
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.242693, 5.131905, 6.593122
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.216780, 5.571850, 6.384516
Valid average loss all      (Triplet)                 : 0.333764

== Recognize ==
Valid average loss Recognize     : 1.005570
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.333764

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.1892781257629395 sec. =
Valid knn accuracy drums     : 88.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.274068593978882 sec. =
Valid knn accuracy bass      : 34.475806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.506972551345825 sec. =
Valid knn accuracy piano     : 65.8203125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.014758348464966 sec. =
Valid knn accuracy guitar    : 72.32142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6656482219696045 sec. =
Valid knn accuracy residuals : 89.54545454545455%

Valid knn accuracy average   : 70.04129606587311%

                                                                      [AEpoch 37: 100%|██████████| 313/313 [05:49<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.060]Epoch 37: 100%|██████████| 313/313 [05:49<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198860, 0.199329, 0.199317, 0.218654
Train average loss UNet                 (all)                : 0.816160

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000716, 3.563035, 6.716184
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004257, 3.918555, 5.855486
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003301, 4.392753, 6.440636
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001572, 4.513217, 6.830297
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001117, 4.990644, 7.529654
Train average loss all      (Triplet)                 : 0.002205

== Recognize ==
Train average loss Recognize     : 1.063834
Train average accuracy drums     : 49.325001 %
Train average accuracy bass      : 49.965000 %
Train average accuracy piano     : 49.935001 %
Train average accuracy guitar    : 50.300003 %
Train average accuracy residuals : 50.139999 %

== Train average loss all : 0.002205

Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]          Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]Epoch 38:  16%|█▌        | 50/313 [00:51<04:29,  0.98it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]Epoch 38:  16%|█▌        | 50/313 [00:51<04:29,  0.98it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]Epoch 38:  32%|███▏      | 100/313 [01:34<03:21,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]Epoch 38:  32%|███▏      | 100/313 [01:34<03:21,  1.06it/s, v_num=0, Train/loss_all_step=0.000164, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000164, Train/loss_recog_step=1.060, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]Epoch 38:  48%|████▊     | 150/313 [02:18<02:30,  1.09it/s, v_num=0, Train/loss_all_step=0.000164, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000164, Train/loss_recog_step=1.060, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]Epoch 38:  48%|████▊     | 150/313 [02:18<02:30,  1.09it/s, v_num=0, Train/loss_all_step=0.00064, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00064, Train/loss_recog_step=1.020, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]  Epoch 38:  64%|██████▍   | 200/313 [03:02<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.00064, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00064, Train/loss_recog_step=1.020, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]Epoch 38:  64%|██████▍   | 200/313 [03:02<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.00308, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=1.090, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]Epoch 38:  80%|███████▉  | 250/313 [03:47<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.00308, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=1.090, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]Epoch 38:  80%|███████▉  | 250/313 [03:47<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]    Epoch 38:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]Epoch 38:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000653, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000653, Train/loss_recog_step=1.120, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]Epoch 38: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000653, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000653, Train/loss_recog_step=1.120, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]Epoch 38: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000845, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000845, Train/loss_recog_step=1.070, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.700, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.98it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.52it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.79it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195684, 0.198188, 0.194922, 0.221298
Valid average loss UNet                 (all)                : 0.810092

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.069508, 3.860173, 6.037004
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.364477, 4.279745, 4.893096
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.547400, 5.474592, 5.735639
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.250221, 5.380556, 6.796876
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.316077, 5.784317, 6.520741
Valid average loss all      (Triplet)                 : 0.297200

== Recognize ==
Valid average loss Recognize     : 1.018225
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.297200

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5400426387786865 sec. =
Valid knn accuracy drums     : 88.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.267606496810913 sec. =
Valid knn accuracy bass      : 39.516129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.722603559494019 sec. =
Valid knn accuracy piano     : 67.578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.15618896484375 sec. =
Valid knn accuracy guitar    : 67.63392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.961435556411743 sec. =
Valid knn accuracy residuals : 88.63636363636364%

Valid knn accuracy average   : 70.32508316105353%

                                                                      [AEpoch 38: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000845, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000845, Train/loss_recog_step=1.070, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00221, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.060]Epoch 38: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000845, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000845, Train/loss_recog_step=1.070, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198805, 0.199275, 0.199256, 0.218672
Train average loss UNet                 (all)                : 0.816007

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000363, 3.572072, 6.616762
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003559, 3.967928, 5.982047
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002670, 4.431368, 6.492610
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002670, 4.616567, 7.008792
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000903, 5.017237, 7.570203
Train average loss all      (Triplet)                 : 0.002022

== Recognize ==
Train average loss Recognize     : 1.072253
Train average accuracy drums     : 49.595001 %
Train average accuracy bass      : 49.814999 %
Train average accuracy piano     : 49.575001 %
Train average accuracy guitar    : 50.234997 %
Train average accuracy residuals : 49.880001 %

== Train average loss all : 0.002022

Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000845, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000845, Train/loss_recog_step=1.070, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]          Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000845, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000845, Train/loss_recog_step=1.070, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]Epoch 39:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000845, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000845, Train/loss_recog_step=1.070, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]Epoch 39:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]      Epoch 39:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]Epoch 39:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]Epoch 39:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]Epoch 39:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]Epoch 39:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]Epoch 39:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.00499, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00499, Train/loss_recog_step=1.190, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]Epoch 39:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00499, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00499, Train/loss_recog_step=1.190, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]Epoch 39:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00267, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=1.170, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]Epoch 39:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.00267, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=1.170, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]Epoch 39:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.00708, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00708, Train/loss_recog_step=1.060, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]Epoch 39: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.00708, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00708, Train/loss_recog_step=1.060, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]Epoch 39: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.703, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.93it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.30it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.58it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.60it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195596, 0.198136, 0.194794, 0.218684
Valid average loss UNet                 (all)                : 0.807210

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.078494, 4.062092, 6.432760
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.433857, 4.418455, 4.908806
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.536541, 5.619304, 6.012823
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.413340, 5.656010, 6.966003
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.185388, 5.444511, 6.462485
Valid average loss all      (Triplet)                 : 0.328527

== Recognize ==
Valid average loss Recognize     : 1.014408
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.328527

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.230086088180542 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.364354372024536 sec. =
Valid knn accuracy bass      : 39.71774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.954514980316162 sec. =
Valid knn accuracy piano     : 68.1640625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.100549936294556 sec. =
Valid knn accuracy guitar    : 67.85714285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.805517911911011 sec. =
Valid knn accuracy residuals : 91.36363636363637%

Valid knn accuracy average   : 70.63790803560043%

                                                                      [AEpoch 39: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.070]Epoch 39: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198815, 0.199295, 0.199271, 0.218827
Train average loss UNet                 (all)                : 0.816209

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000626, 3.708884, 6.812910
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003538, 4.093760, 6.117492
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002377, 4.519292, 6.636198
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004552, 4.846278, 7.330020
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001614, 5.171762, 7.789141
Train average loss all      (Triplet)                 : 0.002620

== Recognize ==
Train average loss Recognize     : 1.091488
Train average accuracy drums     : 49.735001 %
Train average accuracy bass      : 49.720001 %
Train average accuracy piano     : 49.520000 %
Train average accuracy guitar    : 49.590000 %
Train average accuracy residuals : 49.584999 %

== Train average loss all : 0.002620

Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]          Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]Epoch 40:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]Epoch 40:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.0054, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0054, Train/loss_recog_step=1.070, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]Epoch 40:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.0054, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0054, Train/loss_recog_step=1.070, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]Epoch 40:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.00153, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00153, Train/loss_recog_step=1.160, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]Epoch 40:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.00153, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00153, Train/loss_recog_step=1.160, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]Epoch 40:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]    Epoch 40:  64%|██████▍   | 200/313 [03:02<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]Epoch 40:  64%|██████▍   | 200/313 [03:02<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.00256, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00256, Train/loss_recog_step=1.120, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]Epoch 40:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.00256, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00256, Train/loss_recog_step=1.120, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]Epoch 40:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]    Epoch 40:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]Epoch 40:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.0045, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0045, Train/loss_recog_step=1.080, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]Epoch 40: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.0045, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0045, Train/loss_recog_step=1.080, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]Epoch 40: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.281, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.281, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.329, Valid/loss_unet_all_epoch=0.807, Valid/loss_triplet_all_epoch=0.329, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.706, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.73it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.49it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.94it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.23it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.28it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195948, 0.198469, 0.195101, 0.228974
Valid average loss UNet                 (all)                : 0.818492

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.085771, 4.086908, 6.290797
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.457499, 4.536480, 5.121644
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.648781, 5.885736, 6.116340
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.408175, 5.653014, 6.992065
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.209670, 5.628968, 6.604776
Valid average loss all      (Triplet)                 : 0.360503

== Recognize ==
Valid average loss Recognize     : 0.919830
Valid average accuracy drums     : 56.500000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.360503

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.300255298614502 sec. =
Valid knn accuracy drums     : 89.56521739130436%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.193896770477295 sec. =
Valid knn accuracy bass      : 48.58870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.608999013900757 sec. =
Valid knn accuracy piano     : 66.015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.51816463470459 sec. =
Valid knn accuracy guitar    : 68.97321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.068606615066528 sec. =
Valid knn accuracy residuals : 92.04545454545455%

Valid knn accuracy average   : 73.03764417997851%

                                                                      [AEpoch 40: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00262, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.090]Epoch 40: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198802, 0.199262, 0.199257, 0.218784
Train average loss UNet                 (all)                : 0.816105

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000797, 3.816607, 7.017420
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004377, 4.115354, 6.115257
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001857, 4.581925, 6.729046
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001811, 4.925999, 7.496443
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001444, 5.293672, 7.960125
Train average loss all      (Triplet)                 : 0.002145

== Recognize ==
Train average loss Recognize     : 1.088629
Train average accuracy drums     : 50.180000 %
Train average accuracy bass      : 50.459999 %
Train average accuracy piano     : 49.889999 %
Train average accuracy guitar    : 49.709999 %
Train average accuracy residuals : 49.750000 %

== Train average loss all : 0.002145

Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]          Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]Epoch 41:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]Epoch 41:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.0027, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=1.080, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]Epoch 41:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.0027, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=1.080, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]Epoch 41:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]  Epoch 41:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]Epoch 41:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.00968, Train/loss_unet_all_step=0.867, Train/loss_triplet_all_step=0.00968, Train/loss_recog_step=1.030, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]Epoch 41:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.00968, Train/loss_unet_all_step=0.867, Train/loss_triplet_all_step=0.00968, Train/loss_recog_step=1.030, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]Epoch 41:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]    Epoch 41:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]Epoch 41:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]Epoch 41:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]Epoch 41:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0062, Train/loss_recog_step=1.100, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]Epoch 41: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.0062, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0062, Train/loss_recog_step=1.100, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]Epoch 41: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.00506, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00506, Train/loss_recog_step=1.090, Valid/loss_all_step=0.322, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.322, Valid/loss_recog_step=0.897, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.730, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.69it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.13it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.53it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.51it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.28it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196219, 0.198639, 0.195424, 0.230587
Valid average loss UNet                 (all)                : 0.820870

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060223, 4.035924, 6.334887
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.391218, 4.534672, 5.207788
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.748068, 5.767155, 5.892272
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.443889, 5.722812, 7.016809
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.226085, 5.653933, 6.670426
Valid average loss all      (Triplet)                 : 0.376442

== Recognize ==
Valid average loss Recognize     : 0.914188
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.376442

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.178556203842163 sec. =
Valid knn accuracy drums     : 90.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.178738117218018 sec. =
Valid knn accuracy bass      : 41.33064516129033%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.644838571548462 sec. =
Valid knn accuracy piano     : 65.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.087167739868164 sec. =
Valid knn accuracy guitar    : 66.51785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.594677209854126 sec. =
Valid knn accuracy residuals : 91.13636363636364%

Valid knn accuracy average   : 70.92197318810221%

                                                                      [AEpoch 41: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.00506, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00506, Train/loss_recog_step=1.090, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.090]Epoch 41: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.00506, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00506, Train/loss_recog_step=1.090, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198892, 0.199358, 0.199345, 0.218053
Train average loss UNet                 (all)                : 0.815648

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000457, 3.851373, 7.107115
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005373, 4.213042, 6.282785
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002915, 4.653197, 6.815838
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002417, 4.900261, 7.475803
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000934, 5.313724, 7.997265
Train average loss all      (Triplet)                 : 0.002465

== Recognize ==
Train average loss Recognize     : 1.085225
Train average accuracy drums     : 50.129997 %
Train average accuracy bass      : 50.760002 %
Train average accuracy piano     : 49.939999 %
Train average accuracy guitar    : 50.715000 %
Train average accuracy residuals : 49.704998 %

== Train average loss all : 0.002465

Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00506, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00506, Train/loss_recog_step=1.090, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]          Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00506, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00506, Train/loss_recog_step=1.090, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]Epoch 42:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.00506, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00506, Train/loss_recog_step=1.090, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]Epoch 42:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00346, Train/loss_recog_step=1.100, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]Epoch 42:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00346, Train/loss_recog_step=1.100, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]Epoch 42:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]    Epoch 42:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]Epoch 42:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]Epoch 42:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]Epoch 42:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]Epoch 42:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]Epoch 42:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]Epoch 42:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]Epoch 42:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]Epoch 42: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]Epoch 42: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.0292, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=1.010, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=0.704, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.709, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.64it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.64it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.19it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.97it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195872, 0.198354, 0.195093, 0.222520
Valid average loss UNet                 (all)                : 0.811839

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.096175, 4.195774, 6.409247
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.434157, 4.384744, 5.042139
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.787221, 5.893711, 6.001141
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.307732, 5.561520, 7.024000
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.261251, 5.829045, 7.005923
Valid average loss all      (Triplet)                 : 0.386893

== Recognize ==
Valid average loss Recognize     : 1.017916
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.386893

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.815815210342407 sec. =
Valid knn accuracy drums     : 89.56521739130436%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.45217514038086 sec. =
Valid knn accuracy bass      : 46.57258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.92838716506958 sec. =
Valid knn accuracy piano     : 66.40625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.679382562637329 sec. =
Valid knn accuracy guitar    : 68.52678571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.809724569320679 sec. =
Valid knn accuracy residuals : 92.04545454545455%

Valid knn accuracy average   : 72.62325765924118%

                                                                      [AEpoch 42: 100%|██████████| 313/313 [05:49<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0292, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=1.010, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.090]Epoch 42: 100%|██████████| 313/313 [05:49<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0292, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=1.010, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198803, 0.199285, 0.199269, 0.218134
Train average loss UNet                 (all)                : 0.815490

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001310, 3.847707, 7.180247
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003383, 4.153131, 6.245145
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002983, 4.708815, 6.892733
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001305, 4.877899, 7.466061
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002182, 5.330660, 8.026492
Train average loss all      (Triplet)                 : 0.002302

== Recognize ==
Train average loss Recognize     : 1.093694
Train average accuracy drums     : 49.930000 %
Train average accuracy bass      : 50.645000 %
Train average accuracy piano     : 49.259998 %
Train average accuracy guitar    : 50.285000 %
Train average accuracy residuals : 49.285000 %

== Train average loss all : 0.002302

Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0292, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=1.010, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]          Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0292, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=1.010, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]Epoch 43:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.0292, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=1.010, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]Epoch 43:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.00285, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00285, Train/loss_recog_step=1.090, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]Epoch 43:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.00285, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00285, Train/loss_recog_step=1.090, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]Epoch 43:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]    Epoch 43:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]Epoch 43:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]Epoch 43:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]Epoch 43:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.000274, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000274, Train/loss_recog_step=1.030, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]Epoch 43:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000274, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000274, Train/loss_recog_step=1.030, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]Epoch 43:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]      Epoch 43:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]Epoch 43:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]Epoch 43: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]Epoch 43: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.366, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.387, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.726, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.58it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.34it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.94it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196393, 0.198832, 0.195637, 0.226691
Valid average loss UNet                 (all)                : 0.817553

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.111850, 4.345315, 6.738605
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.393442, 4.587471, 5.213679
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.767057, 5.785872, 5.825009
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.375648, 5.694540, 6.970448
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.267367, 5.740748, 6.763911
Valid average loss all      (Triplet)                 : 0.402080

== Recognize ==
Valid average loss Recognize     : 1.027230
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.402080

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.161116600036621 sec. =
Valid knn accuracy drums     : 90.8695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.032605409622192 sec. =
Valid knn accuracy bass      : 47.17741935483871%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.645798683166504 sec. =
Valid knn accuracy piano     : 66.2109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.876636266708374 sec. =
Valid knn accuracy guitar    : 64.95535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.337337970733643 sec. =
Valid knn accuracy residuals : 89.54545454545455%

Valid knn accuracy average   : 71.75174675210833%

                                                                      [AEpoch 43: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.0023, Train/loss_unet_all_epoch=0.815, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.090]Epoch 43: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198859, 0.199339, 0.199327, 0.219318
Train average loss UNet                 (all)                : 0.816844

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000622, 3.873515, 7.173576
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003695, 4.176646, 6.255481
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002593, 4.706221, 6.918316
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001821, 4.818602, 7.329256
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001593, 5.323216, 8.077689
Train average loss all      (Triplet)                 : 0.002037

== Recognize ==
Train average loss Recognize     : 1.085845
Train average accuracy drums     : 50.615002 %
Train average accuracy bass      : 49.860001 %
Train average accuracy piano     : 49.980000 %
Train average accuracy guitar    : 49.384998 %
Train average accuracy residuals : 50.064999 %

== Train average loss all : 0.002037

Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]          Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]Epoch 44:  16%|█▌        | 50/313 [00:49<04:21,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]Epoch 44:  16%|█▌        | 50/313 [00:49<04:21,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]Epoch 44:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]Epoch 44:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.0023, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0023, Train/loss_recog_step=1.110, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]Epoch 44:  48%|████▊     | 150/313 [02:18<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.0023, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0023, Train/loss_recog_step=1.110, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]Epoch 44:  48%|████▊     | 150/313 [02:18<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]  Epoch 44:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]Epoch 44:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.00426, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00426, Train/loss_recog_step=1.060, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]Epoch 44:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.00426, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00426, Train/loss_recog_step=1.060, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]Epoch 44:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]    Epoch 44:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]Epoch 44:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]Epoch 44: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]Epoch 44: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.718, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.53it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.07it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195746, 0.198259, 0.194867, 0.224406
Valid average loss UNet                 (all)                : 0.813278

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.111504, 4.403996, 6.919666
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.412185, 4.701769, 5.245902
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.787995, 6.009235, 6.000741
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.369972, 5.736879, 6.979843
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.227624, 6.090806, 7.104072
Valid average loss all      (Triplet)                 : 0.410193

== Recognize ==
Valid average loss Recognize     : 1.059404
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.410193

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.349043130874634 sec. =
Valid knn accuracy drums     : 90.65217391304347%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.396894454956055 sec. =
Valid knn accuracy bass      : 46.16935483870967%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.601846694946289 sec. =
Valid knn accuracy piano     : 71.6796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.122359037399292 sec. =
Valid knn accuracy guitar    : 65.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.153259992599487 sec. =
Valid knn accuracy residuals : 86.5909090909091%

Valid knn accuracy average   : 72.14342506853247%

                                                                      [AEpoch 44: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00204, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00204, Train/loss_recog_epoch=1.090]Epoch 44: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.199041, 0.199520, 0.199502, 0.219401
Train average loss UNet                 (all)                : 0.817465

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000643, 3.996420, 7.487318
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002321, 4.365525, 6.566806
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002698, 4.800101, 7.014734
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002501, 5.018070, 7.621547
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001319, 5.479202, 8.268251
Train average loss all      (Triplet)                 : 0.001913

== Recognize ==
Train average loss Recognize     : 1.098516
Train average accuracy drums     : 50.019997 %
Train average accuracy bass      : 50.370003 %
Train average accuracy piano     : 49.779999 %
Train average accuracy guitar    : 49.485001 %
Train average accuracy residuals : 49.955002 %

== Train average loss all : 0.001913

Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]          Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]Epoch 45:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]Epoch 45:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]Epoch 45:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]Epoch 45:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]Epoch 45:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]Epoch 45:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]Epoch 45:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]Epoch 45:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.0049, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0049, Train/loss_recog_step=1.000, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]Epoch 45:  80%|███████▉  | 250/313 [03:44<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.0049, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0049, Train/loss_recog_step=1.000, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]Epoch 45:  80%|███████▉  | 250/313 [03:44<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00632, Train/loss_recog_step=1.150, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]Epoch 45:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.00632, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00632, Train/loss_recog_step=1.150, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]Epoch 45:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]    Epoch 45: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]Epoch 45: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.65it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.63it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.18it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.99it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.39it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.10it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196170, 0.198598, 0.195382, 0.225583
Valid average loss UNet                 (all)                : 0.815732

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.123009, 4.395765, 6.724597
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.415042, 4.701081, 5.280931
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.817723, 6.174880, 6.301965
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.346824, 5.809860, 7.170779
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.339498, 6.157040, 7.017097
Valid average loss all      (Triplet)                 : 0.406818

== Recognize ==
Valid average loss Recognize     : 1.003641
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.406818

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.049588918685913 sec. =
Valid knn accuracy drums     : 91.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.145325183868408 sec. =
Valid knn accuracy bass      : 45.36290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.638142824172974 sec. =
Valid knn accuracy piano     : 66.9921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5045390129089355 sec. =
Valid knn accuracy guitar    : 68.08035714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.165618896484375 sec. =
Valid knn accuracy residuals : 90.0%

Valid knn accuracy average   : 72.30448087808054%

                                                                      [AEpoch 45: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00191, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.100]Epoch 45: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198949, 0.199431, 0.199400, 0.218709
Train average loss UNet                 (all)                : 0.816489

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000377, 3.984217, 7.479636
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002091, 4.251484, 6.386584
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003560, 4.880854, 7.188160
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002360, 5.043693, 7.684290
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001592, 5.461622, 8.251912
Train average loss all      (Triplet)                 : 0.001963

== Recognize ==
Train average loss Recognize     : 1.095193
Train average accuracy drums     : 49.575001 %
Train average accuracy bass      : 50.445004 %
Train average accuracy piano     : 49.829998 %
Train average accuracy guitar    : 50.239998 %
Train average accuracy residuals : 49.974998 %

== Train average loss all : 0.001963

Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]          Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]Epoch 46:  16%|█▌        | 50/313 [00:50<04:24,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]Epoch 46:  16%|█▌        | 50/313 [00:50<04:24,  0.99it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00459, Train/loss_recog_step=1.150, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]Epoch 46:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00459, Train/loss_recog_step=1.150, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]Epoch 46:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]    Epoch 46:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]Epoch 46:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.00955, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.00955, Train/loss_recog_step=1.040, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]Epoch 46:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.00955, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.00955, Train/loss_recog_step=1.040, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]Epoch 46:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]    Epoch 46:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]Epoch 46:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000526, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000526, Train/loss_recog_step=1.150, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]Epoch 46:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000526, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000526, Train/loss_recog_step=1.150, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]Epoch 46:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]      Epoch 46: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]Epoch 46: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.407, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.51it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.80it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.67it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.68it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195950, 0.198476, 0.195147, 0.222507
Valid average loss UNet                 (all)                : 0.812081

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.139435, 4.301554, 6.771980
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.445498, 4.717351, 5.156019
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.886628, 6.259738, 6.187958
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.360916, 5.795739, 7.097072
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.241553, 5.988993, 6.954327
Valid average loss all      (Triplet)                 : 0.409240

== Recognize ==
Valid average loss Recognize     : 0.996215
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.409240

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.942294120788574 sec. =
Valid knn accuracy drums     : 91.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.045759201049805 sec. =
Valid knn accuracy bass      : 44.75806451612903%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.388987302780151 sec. =
Valid knn accuracy piano     : 69.7265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.994814157485962 sec. =
Valid knn accuracy guitar    : 64.73214285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.317304372787476 sec. =
Valid knn accuracy residuals : 87.5%

Valid knn accuracy average   : 71.64770180074133%

                                                                      [AEpoch 46: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.100]Epoch 46: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198890, 0.199379, 0.199364, 0.219118
Train average loss UNet                 (all)                : 0.816751

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000152, 3.975530, 7.307265
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003089, 4.329529, 6.476718
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002313, 4.870652, 7.203743
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001584, 5.120855, 7.819480
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001837, 5.516393, 8.348690
Train average loss all      (Triplet)                 : 0.001775

== Recognize ==
Train average loss Recognize     : 1.107782
Train average accuracy drums     : 50.005001 %
Train average accuracy bass      : 50.435001 %
Train average accuracy piano     : 49.915001 %
Train average accuracy guitar    : 50.024998 %
Train average accuracy residuals : 49.880001 %

== Train average loss all : 0.001775

Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]          Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]Epoch 47:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]Epoch 47:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]Epoch 47:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]Epoch 47:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]Epoch 47:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]Epoch 47:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.00129, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.00129, Train/loss_recog_step=1.140, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]Epoch 47:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.00129, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.00129, Train/loss_recog_step=1.140, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]Epoch 47:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=7.77e-5, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=7.77e-5, Train/loss_recog_step=1.130, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]Epoch 47:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=7.77e-5, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=7.77e-5, Train/loss_recog_step=1.130, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]Epoch 47:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000275, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000275, Train/loss_recog_step=1.090, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]Epoch 47:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000275, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000275, Train/loss_recog_step=1.090, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]Epoch 47:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]      Epoch 47: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]Epoch 47: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.409, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.716, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.02it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.18it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.85it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.29it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.13it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.196364, 0.198782, 0.195587, 0.221806
Valid average loss UNet                 (all)                : 0.812539

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.156873, 4.692321, 6.931468
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.439274, 4.843122, 5.335781
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.661983, 6.157919, 6.380575
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.334447, 5.781856, 7.488486
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.243044, 6.235524, 7.227580
Valid average loss all      (Triplet)                 : 0.367667

== Recognize ==
Valid average loss Recognize     : 1.036771
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.367667

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5075461864471436 sec. =
Valid knn accuracy drums     : 93.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.386659145355225 sec. =
Valid knn accuracy bass      : 40.12096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.590352058410645 sec. =
Valid knn accuracy piano     : 63.0859375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.475542068481445 sec. =
Valid knn accuracy guitar    : 68.08035714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.19938063621521 sec. =
Valid knn accuracy residuals : 90.22727272727272%

Valid knn accuracy average   : 71.04203745719569%

                                                                      [AEpoch 47: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00177, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00177, Train/loss_recog_epoch=1.110]Epoch 47: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198903, 0.199379, 0.199372, 0.218810
Train average loss UNet                 (all)                : 0.816464

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000407, 4.055329, 7.486416
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004104, 4.397903, 6.554884
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002037, 4.927596, 7.303461
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002072, 5.238523, 8.032022
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001782, 5.611324, 8.544984
Train average loss all      (Triplet)                 : 0.002075

== Recognize ==
Train average loss Recognize     : 1.110563
Train average accuracy drums     : 49.735001 %
Train average accuracy bass      : 49.990002 %
Train average accuracy piano     : 49.895000 %
Train average accuracy guitar    : 50.155003 %
Train average accuracy residuals : 49.799999 %

== Train average loss all : 0.002075

Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]          Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 48:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 48:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 48:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 48:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.000835, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000835, Train/loss_recog_step=1.180, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 48:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.000835, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000835, Train/loss_recog_step=1.180, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 48:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.00168, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=1.110, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]  Epoch 48:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.00168, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=1.110, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 48:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]    Epoch 48:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 48:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00302, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00302, Train/loss_recog_step=1.020, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 48:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.00302, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00302, Train/loss_recog_step=1.020, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 48:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.00314, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00314, Train/loss_recog_step=1.040, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 48: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.00314, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00314, Train/loss_recog_step=1.040, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 48: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.710, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.12it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.18it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.96it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.29it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195842, 0.198376, 0.194992, 0.225148
Valid average loss UNet                 (all)                : 0.814359

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.134635, 4.438098, 6.717252
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.423127, 4.746390, 5.199843
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.686873, 6.028628, 6.289914
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.357173, 5.754175, 7.480416
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.219113, 6.102944, 7.145148
Valid average loss all      (Triplet)                 : 0.355633

== Recognize ==
Valid average loss Recognize     : 1.009494
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.355633

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.726665258407593 sec. =
Valid knn accuracy drums     : 88.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.770816802978516 sec. =
Valid knn accuracy bass      : 47.37903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.324023485183716 sec. =
Valid knn accuracy piano     : 61.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.711837291717529 sec. =
Valid knn accuracy guitar    : 69.86607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.011755704879761 sec. =
Valid knn accuracy residuals : 88.63636363636364%

Valid knn accuracy average   : 71.05502987764339%

                                                                      [AEpoch 48: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 48: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198933, 0.199410, 0.199390, 0.219158
Train average loss UNet                 (all)                : 0.816891

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000391, 4.091574, 7.580009
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003695, 4.506155, 6.797954
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002661, 4.983504, 7.376385
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002645, 5.265797, 8.108891
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000896, 5.605103, 8.513479
Train average loss all      (Triplet)                 : 0.002076

== Recognize ==
Train average loss Recognize     : 1.107077
Train average accuracy drums     : 49.900002 %
Train average accuracy bass      : 49.559998 %
Train average accuracy piano     : 49.645000 %
Train average accuracy guitar    : 49.610001 %
Train average accuracy residuals : 50.295002 %

== Train average loss all : 0.002076

Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]          Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 49:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 49:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.00365, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00365, Train/loss_recog_step=1.180, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 49:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00365, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00365, Train/loss_recog_step=1.180, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 49:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]    Epoch 49:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 49:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 49:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 49:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 49:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 49:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00936, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00936, Train/loss_recog_step=1.130, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 49:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.00936, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00936, Train/loss_recog_step=1.130, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 49:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]    Epoch 49: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 49: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.238, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.356, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.711, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.72it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.92it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.95it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.11it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.08it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195917, 0.198435, 0.195099, 0.218276
Valid average loss UNet                 (all)                : 0.807727

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.200845, 4.486015, 6.648004
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.425745, 4.811889, 5.332155
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.692695, 6.103722, 6.353700
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.355994, 5.782430, 7.403317
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.205127, 6.136947, 7.159176
Valid average loss all      (Triplet)                 : 0.377624

== Recognize ==
Valid average loss Recognize     : 0.949790
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.377624

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.069758892059326 sec. =
Valid knn accuracy drums     : 88.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.385634183883667 sec. =
Valid knn accuracy bass      : 47.58064516129033%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.764040231704712 sec. =
Valid knn accuracy piano     : 66.796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.541150808334351 sec. =
Valid knn accuracy guitar    : 70.98214285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.288149833679199 sec. =
Valid knn accuracy residuals : 87.95454545454545%

Valid knn accuracy average   : 72.27153734676963%

                                                                      [AEpoch 49: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.110]Epoch 49: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.199046, 0.199542, 0.199511, 0.218616
Train average loss UNet                 (all)                : 0.816716

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000190, 4.022210, 7.426650
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003476, 4.464102, 6.681659
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002467, 4.989333, 7.388982
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002207, 5.223722, 8.014795
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001453, 5.565271, 8.447742
Train average loss all      (Triplet)                 : 0.001975

== Recognize ==
Train average loss Recognize     : 1.106592
Train average accuracy drums     : 50.355000 %
Train average accuracy bass      : 50.305004 %
Train average accuracy piano     : 49.294998 %
Train average accuracy guitar    : 50.120003 %
Train average accuracy residuals : 49.489998 %

== Train average loss all : 0.001975

Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]          Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]Epoch 50:  16%|█▌        | 50/313 [00:52<04:34,  0.96it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]Epoch 50:  16%|█▌        | 50/313 [00:52<04:34,  0.96it/s, v_num=0, Train/loss_all_step=0.00127, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=1.070, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]Epoch 50:  32%|███▏      | 100/313 [01:36<03:26,  1.03it/s, v_num=0, Train/loss_all_step=0.00127, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=1.070, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]Epoch 50:  32%|███▏      | 100/313 [01:36<03:26,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]    Epoch 50:  48%|████▊     | 150/313 [02:20<02:33,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]Epoch 50:  48%|████▊     | 150/313 [02:20<02:33,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.863, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]Epoch 50:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.863, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]Epoch 50:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.00146, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=1.250, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]Epoch 50:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.00146, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=1.250, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]Epoch 50:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]    Epoch 50:  96%|█████████▌| 300/313 [04:33<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]Epoch 50:  96%|█████████▌| 300/313 [04:33<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]Epoch 50: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]Epoch 50: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.00243, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=1.120, Valid/loss_all_step=0.285, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=0.754, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.808, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.723, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.68it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.12it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.14it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.42it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195659, 0.198204, 0.194817, 0.221737
Valid average loss UNet                 (all)                : 0.810417

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.196652, 4.540109, 6.649370
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.468633, 4.967157, 5.469733
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.679792, 6.451500, 6.656452
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.358602, 6.089786, 7.924399
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.212819, 6.324996, 7.347150
Valid average loss all      (Triplet)                 : 0.372118

== Recognize ==
Valid average loss Recognize     : 1.038652
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.372118

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.225614070892334 sec. =
Valid knn accuracy drums     : 88.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.963628768920898 sec. =
Valid knn accuracy bass      : 45.16129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.483729362487793 sec. =
Valid knn accuracy piano     : 67.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.972500801086426 sec. =
Valid knn accuracy guitar    : 67.63392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.865596771240234 sec. =
Valid knn accuracy residuals : 88.63636363636364%

Valid knn accuracy average   : 71.46294694085718%

                                                                      [AEpoch 50: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00243, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=1.120, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00198, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.110]Epoch 50: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00243, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=1.120, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198752, 0.199238, 0.199221, 0.219137
Train average loss UNet                 (all)                : 0.816348

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000150, 4.034413, 7.372247
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002380, 4.562973, 6.845983
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003065, 5.099949, 7.566037
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002839, 5.311896, 8.160207
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001679, 5.718612, 8.680060
Train average loss all      (Triplet)                 : 0.002018

== Recognize ==
Train average loss Recognize     : 1.111079
Train average accuracy drums     : 50.400002 %
Train average accuracy bass      : 49.994999 %
Train average accuracy piano     : 50.129997 %
Train average accuracy guitar    : 49.889999 %
Train average accuracy residuals : 50.185001 %

== Train average loss all : 0.002018

Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00243, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=1.120, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]          Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00243, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=1.120, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]Epoch 51:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.00243, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=1.120, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]Epoch 51:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]    Epoch 51:  32%|███▏      | 100/313 [01:33<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]Epoch 51:  32%|███▏      | 100/313 [01:33<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.0205, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0205, Train/loss_recog_step=1.150, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]Epoch 51:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.0205, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0205, Train/loss_recog_step=1.150, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]Epoch 51:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]  Epoch 51:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.869, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]Epoch 51:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]Epoch 51:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]Epoch 51:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.00731, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00731, Train/loss_recog_step=1.060, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]Epoch 51:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.00731, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00731, Train/loss_recog_step=1.060, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]Epoch 51:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.000207, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000207, Train/loss_recog_step=1.110, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]Epoch 51: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000207, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000207, Train/loss_recog_step=1.110, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]Epoch 51: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.036, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.036, Train/loss_recog_step=1.210, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.810, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.715, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.75it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.13it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.15it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.91it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195388, 0.197993, 0.194532, 0.224051
Valid average loss UNet                 (all)                : 0.811963

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.192129, 4.630292, 6.734154
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.419186, 5.032042, 5.609124
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.774536, 6.686000, 6.848462
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.356257, 6.299288, 8.032433
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.278909, 6.828025, 7.785203
Valid average loss all      (Triplet)                 : 0.414627

== Recognize ==
Valid average loss Recognize     : 1.042962
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.414627

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.919834613800049 sec. =
Valid knn accuracy drums     : 91.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.763280391693115 sec. =
Valid knn accuracy bass      : 51.20967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.60236382484436 sec. =
Valid knn accuracy piano     : 65.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.107717275619507 sec. =
Valid knn accuracy guitar    : 65.40178571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.019248723983765 sec. =
Valid knn accuracy residuals : 87.72727272727273%

Valid knn accuracy average   : 72.09295097653047%

                                                                      [AEpoch 51: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.036, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.036, Train/loss_recog_step=1.210, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.110]Epoch 51: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.036, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.036, Train/loss_recog_step=1.210, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198686, 0.199161, 0.199145, 0.219080
Train average loss UNet                 (all)                : 0.816072

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000887, 4.159547, 7.543630
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002008, 4.626046, 6.907035
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002905, 5.195272, 7.634302
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002863, 5.463046, 8.342758
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001321, 5.913560, 8.979571
Train average loss all      (Triplet)                 : 0.002016

== Recognize ==
Train average loss Recognize     : 1.137943
Train average accuracy drums     : 49.505001 %
Train average accuracy bass      : 49.884998 %
Train average accuracy piano     : 49.955002 %
Train average accuracy guitar    : 49.959999 %
Train average accuracy residuals : 49.770000 %

== Train average loss all : 0.002016

Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.036, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.036, Train/loss_recog_step=1.210, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]          Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.036, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.036, Train/loss_recog_step=1.210, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]Epoch 52:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.036, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.036, Train/loss_recog_step=1.210, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]Epoch 52:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00321, Train/loss_recog_step=1.150, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]Epoch 52:  32%|███▏      | 100/313 [01:35<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00321, Train/loss_recog_step=1.150, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]Epoch 52:  32%|███▏      | 100/313 [01:35<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]    Epoch 52:  48%|████▊     | 150/313 [02:18<02:30,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]Epoch 52:  48%|████▊     | 150/313 [02:18<02:30,  1.09it/s, v_num=0, Train/loss_all_step=0.00574, Train/loss_unet_all_step=0.860, Train/loss_triplet_all_step=0.00574, Train/loss_recog_step=1.150, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]Epoch 52:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.00574, Train/loss_unet_all_step=0.860, Train/loss_triplet_all_step=0.00574, Train/loss_recog_step=1.150, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]Epoch 52:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]    Epoch 52:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]Epoch 52:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.00729, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=1.100, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]Epoch 52:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00729, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=1.100, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]Epoch 52:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=1.150, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]Epoch 52: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=1.150, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]Epoch 52: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.812, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.721, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.94it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.33it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.07it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.63it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.195865, 0.198433, 0.195072, 0.226643
Valid average loss UNet                 (all)                : 0.816013

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.202931, 4.576081, 6.762851
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.376567, 5.031295, 5.660127
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.741860, 6.659446, 6.825138
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.340889, 6.157624, 8.011223
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.265839, 6.615510, 7.493471
Valid average loss all      (Triplet)                 : 0.389601

== Recognize ==
Valid average loss Recognize     : 1.066403
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 41.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.389601

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.775976419448853 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.338821649551392 sec. =
Valid knn accuracy bass      : 47.17741935483871%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.36812949180603 sec. =
Valid knn accuracy piano     : 66.2109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.523338556289673 sec. =
Valid knn accuracy guitar    : 70.53571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.676939249038696 sec. =
Valid knn accuracy residuals : 90.22727272727272%

Valid knn accuracy average   : 72.17809486052167%

                                                                      [AEpoch 52: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00202, Train/loss_unet_all_epoch=0.816, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.140]Epoch 52: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.198899, 0.199387, 0.199366, 0.218886
Train average loss UNet                 (all)                : 0.816538

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001171, 4.192282, 7.711021
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002831, 4.678829, 7.067723
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002881, 5.305524, 7.826897
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002819, 5.503412, 8.452075
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001114, 5.846973, 8.889165
Train average loss all      (Triplet)                 : 0.002114

== Recognize ==
Train average loss Recognize     : 1.136612
Train average accuracy drums     : 50.050003 %
Train average accuracy bass      : 50.335003 %
Train average accuracy piano     : 49.639999 %
Train average accuracy guitar    : 50.290001 %
Train average accuracy residuals : 50.204998 %

== Train average loss all : 0.002114

Epoch 52: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.270, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.816, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.722, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.817, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.140]
[2023-11-07 14:37:52,162][source.train][INFO] - [rank: 0] Starting testing!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0: 100%|██████████| 16/16 [00:09<00:00,  1.70it/s]Testing DataLoader 0:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 1: 100%|██████████| 15/15 [00:11<00:00,  1.34it/s]Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 2:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 2: 100%|██████████| 15/15 [00:04<00:00,  3.15it/s]Testing DataLoader 2:   0%|          | 0/13 [00:00<?, ?it/s]         Testing DataLoader 3:   0%|          | 0/13 [00:00<?, ?it/s]Testing DataLoader 3: 100%|██████████| 13/13 [00:03<00:00,  3.74it/s]Testing DataLoader 3:   0%|          | 0/14 [00:00<?, ?it/s]         Testing DataLoader 4:   0%|          | 0/14 [00:00<?, ?it/s]Testing DataLoader 4: 100%|██████████| 14/14 [00:03<00:00,  4.47it/s]Testing DataLoader 4:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 5:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 5: 100%|██████████| 15/15 [00:03<00:00,  4.41it/s]
Test average accuracy drums     :  50.700005 %
Test average accuracy bass      :  57.400002 %
Test average accuracy piano     :  48.799999 %
Test average accuracy guitar    :  51.899998 %
Test average accuracy residuals :  49.200001 %
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.697171449661255 sec. =
Test knn accuracy drums     : 92.46724890829694%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.539466857910156 sec. =
Test knn accuracy bass      : 52.71317829457365%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.967914581298828 sec. =
Test knn accuracy piano     : 49.27007299270073%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.755891561508179 sec. =
Test knn accuracy guitar    : 51.80995475113123%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.69172978401184 sec. =
Test knn accuracy residuals : 84.17653390742734%

Test knn accuracy average   : 66.08739777082597%
Testing DataLoader 5: 100%|██████████| 15/15 [01:37<00:00,  0.15it/s]
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 0    ┃   DataLoader 1    ┃   DataLoader 2   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.66087394952774… │ 0.66087394952774… │ 0.6608739495277… │
│   Test/knn_bass   │ 0.52713179588317… │ 0.52713179588317… │ 0.5271317958831… │
│  Test/knn_drums   │ 0.92467248439788… │ 0.92467248439788… │ 0.9246724843978… │
│  Test/knn_guitar  │ 0.51809954643249… │ 0.51809954643249… │ 0.5180995464324… │
│  Test/knn_piano   │ 0.49270072579383… │ 0.49270072579383… │ 0.4927007257938… │
│ Test/knn_residua… │ 0.84176534414291… │ 0.84176534414291… │ 0.8417653441429… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 3    ┃   DataLoader 4    ┃   DataLoader 5   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.66087394952774… │ 0.66087394952774… │ 0.6608739495277… │
│   Test/knn_bass   │ 0.52713179588317… │ 0.52713179588317… │ 0.5271317958831… │
│  Test/knn_drums   │ 0.92467248439788… │ 0.92467248439788… │ 0.9246724843978… │
│  Test/knn_guitar  │ 0.51809954643249… │ 0.51809954643249… │ 0.5180995464324… │
│  Test/knn_piano   │ 0.49270072579383… │ 0.49270072579383… │ 0.4927007257938… │
│ Test/knn_residua… │ 0.84176534414291… │ 0.84176534414291… │ 0.8417653441429… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
[2023-11-07 14:40:34,037][source.train][INFO] - [rank: 0] Best ckpt path: /nas02/homes/imamura23-1000067/outputs/triplet_with_unet/runs/2023-11-07/09-28-58/checkpoints/epoch_002.ckpt
[2023-11-07 14:40:34,039][utils.utils][INFO] - [rank: 0] Output dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023-11-07/09-28-58
[2023-11-07 14:40:34,045][utils.utils][INFO] - [rank: 0] Metric name is None! Skipping metric value retrieval...

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Time taken to study : 05:11:35

All prosess was Done!
