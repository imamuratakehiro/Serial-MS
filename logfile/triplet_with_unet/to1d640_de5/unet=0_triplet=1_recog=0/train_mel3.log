
=== Using cuda(utils.func). ===


=== Using cuda(utils.logger). ===

[2023-11-05 04:40:06,311][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-05 04:40:06,335][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 100                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         train_dirname: 3s_on1.5                                               
│         test_dirname: 3s_on1.5                                                
│         load_using_librosa: true                                              
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_train: 3                                                      
│         seconds_test: 3                                                       
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 5.0e-05                                                           
│         monitor_es: Valid/loss_all                                            
│         monitor_mode_es: min                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640                         
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: true                                                             
│         n_mels: 259                                                           
│       cfg:                                                                    
│         n_epoch: 100                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         train_dirname: 3s_on1.5                                               
│         test_dirname: 3s_on1.5                                                
│         load_using_librosa: true                                              
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_train: 3                                                      
│         seconds_test: 3                                                       
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 5.0e-05                                                           
│         monitor_es: Valid/loss_all                                            
│         monitor_mode_es: min                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/loss_all                                               
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: 1                                                         
│         mode: min                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/loss_all                                               
│         min_delta: 0.0                                                        
│         patience: 10                                                          
│         verbose: true                                                         
│         mode: min                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 100                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 100                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       train_dirname: 3s_on1.5                                                 
│       test_dirname: 3s_on1.5                                                  
│       load_using_librosa: true                                                
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_train: 3                                                        
│       seconds_test: 3                                                         
│       sr: 44100                                                               
│       mel: true                                                               
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640                             
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       lr: 5.0e-05                                                             
│       monitor_es: Valid/loss_all                                              
│       monitor_mode_es: min                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 0                                                            
│       recog_rate: 0                                                           
│       test_psd_mine: false                                                    
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-05 04:40:06,417][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-05 04:40:06,443][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-05 04:40:10,080][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpsey9ducl
[2023-11-05 04:40:10,081][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpsey9ducl/_remote_module_non_scriptable.py
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=3200, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-05 04:40:10,944][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-05 04:40:10,944][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-05 04:40:10,952][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-05 04:40:10,954][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-05 04:40:10,954][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-05 04:40:10,954][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-05 04:40:11,015][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-05 04:40:11,384][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-05 04:40:11,713][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
The length of seg for train is 3s.
The length of seg for valid and test is 3s.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.7936663627624512 sec. *
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:08<00:00,  0.23it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 1: 100%|██████████| 2/2 [00:00<00:00,  9.12it/s]Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 2: 100%|██████████| 2/2 [00:00<00:00, 12.74it/s]Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 3: 100%|██████████| 2/2 [00:00<00:00, 11.80it/s]Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 4: 100%|██████████| 2/2 [00:00<00:00, 11.34it/s]Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 5:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 5: 100%|██████████| 2/2 [00:00<00:00,  8.78it/s]

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.174821, 0.172476, 0.170551, 0.174964
Valid average loss UNet                 (all)                : 0.692812

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.200144, 0.001751, 0.001607
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.200198, 0.001920, 0.001722
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.199749, 0.001655, 0.001907
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.199695, 0.001766, 0.002071
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.200008, 0.001933, 0.001925
Valid average loss all      (Triplet)                 : 0.199993

== Recognize ==
Valid average loss Recognize     : 1.107778
Valid average accuracy drums     : 55.468750 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 53.125000 %
Valid average accuracy guitar    : 53.906250 %
Valid average accuracy residuals : 46.875000 %

== Valid average loss all : 0.199993

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 3.0082409381866455 sec. =
Valid knn accuracy drums     : 42.1875%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.4632365703582764 sec. =
Valid knn accuracy bass      : 16.40625%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.741358995437622 sec. =
Valid knn accuracy piano     : 27.34375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.4206361770629883 sec. =
Valid knn accuracy guitar    : 37.5%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.3663434982299805 sec. =
Valid knn accuracy residuals : 86.71875%

Valid knn accuracy average   : 42.03125%
                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [01:07<05:54,  0.74it/s]Epoch 0:  16%|█▌        | 50/313 [01:07<05:54,  0.74it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.250, Train/loss_recog_step=1.180]Epoch 0:  32%|███▏      | 100/313 [01:52<04:00,  0.89it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.250, Train/loss_recog_step=1.180]Epoch 0:  32%|███▏      | 100/313 [01:52<04:00,  0.89it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=1.220]Epoch 0:  48%|████▊     | 150/313 [02:38<02:51,  0.95it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=1.220]Epoch 0:  48%|████▊     | 150/313 [02:38<02:51,  0.95it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.170]Epoch 0:  64%|██████▍   | 200/313 [03:24<01:55,  0.98it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.170]Epoch 0:  64%|██████▍   | 200/313 [03:24<01:55,  0.98it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=1.330]Epoch 0:  80%|███████▉  | 250/313 [04:09<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=1.330]Epoch 0:  80%|███████▉  | 250/313 [04:09<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.693, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.400]Epoch 0:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.693, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.400]Epoch 0:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=1.250]Epoch 0: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=1.250]Epoch 0: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.69it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 15.87it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 12.97it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 13.10it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 14.85it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 14.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175449, 0.175349, 0.183024, 0.181860
Valid average loss UNet                 (all)                : 0.715682

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113823, 0.282931, 0.530918
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.152553, 0.134207, 0.131654
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.205861, 0.268527, 0.267886
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.119609, 0.224732, 0.346715
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.136541, 0.393627, 0.478871
Valid average loss all      (Triplet)                 : 0.152928

== Recognize ==
Valid average loss Recognize     : 1.126492
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.152928

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.86713719367981 sec. =
Valid knn accuracy drums     : 53.04347826086957%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.381213188171387 sec. =
Valid knn accuracy bass      : 13.306451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.63256549835205 sec. =
Valid knn accuracy piano     : 42.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.796968460083008 sec. =
Valid knn accuracy guitar    : 36.160714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.4990129470825195 sec. =
Valid knn accuracy residuals : 60.22727272727273%

Valid knn accuracy average   : 40.98508337735196%

                                                                      [AEpoch 0: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410]Epoch 0: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.182268, 0.181112, 0.183077, 0.186695
Train average loss UNet                 (all)                : 0.733153

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.175196, 0.411289, 0.523960
Train average loss bass     (Triplet, dist_p, dist_n) : 0.241478, 0.371260, 0.350913
Train average loss piano    (Triplet, dist_p, dist_n) : 0.223123, 0.394333, 0.400127
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.225953, 0.394797, 0.399716
Train average loss residuals(Triplet, dist_p, dist_n) : 0.188273, 0.443720, 0.511420
Train average loss all      (Triplet)                 : 0.210967

== Recognize ==
Train average loss Recognize     : 1.238225
Train average accuracy drums     : 50.255001 %
Train average accuracy bass      : 49.660000 %
Train average accuracy piano     : 50.389999 %
Train average accuracy guitar    : 50.215000 %
Train average accuracy residuals : 50.410004 %

== Train average loss all : 0.210967

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]Epoch 1:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]Epoch 1:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]Epoch 1:  32%|███▏      | 100/313 [01:38<03:29,  1.02it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]Epoch 1:  32%|███▏      | 100/313 [01:38<03:29,  1.02it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.734, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]Epoch 1:  48%|████▊     | 150/313 [02:23<02:35,  1.05it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.734, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]Epoch 1:  48%|████▊     | 150/313 [02:23<02:35,  1.05it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.178, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]Epoch 1:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.178, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]Epoch 1:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]Epoch 1:  80%|███████▉  | 250/313 [03:57<00:59,  1.05it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]Epoch 1:  80%|███████▉  | 250/313 [03:57<00:59,  1.05it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]Epoch 1:  96%|█████████▌| 300/313 [04:41<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]Epoch 1:  96%|█████████▌| 300/313 [04:41<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]Epoch 1: 100%|██████████| 313/313 [04:50<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]Epoch 1: 100%|██████████| 313/313 [04:50<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0974, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.0974, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.716, Valid/loss_triplet_all_epoch=0.153, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.410, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.66it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 14.29it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 13.70it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 14.82it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 11.91it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 13.94it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.177844, 0.177623, 0.185609, 0.170759
Valid average loss UNet                 (all)                : 0.711836

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070042, 0.146920, 0.380154
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.131398, 0.112634, 0.135437
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.180669, 0.175148, 0.196717
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.160234, 0.208508, 0.255702
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.191819, 0.324419, 0.357156
Valid average loss all      (Triplet)                 : 0.155159

== Recognize ==
Valid average loss Recognize     : 1.527282
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 43.500000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.155159

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.570483446121216 sec. =
Valid knn accuracy drums     : 53.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.583563566207886 sec. =
Valid knn accuracy bass      : 22.177419354838708%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.957757234573364 sec. =
Valid knn accuracy piano     : 28.7109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5717949867248535 sec. =
Valid knn accuracy guitar    : 37.05357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.372870445251465 sec. =
Valid knn accuracy residuals : 56.81818181818182%

Valid knn accuracy average   : 39.64767419423144%

                                                                      [AEpoch 1: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.360, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.733, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=1.240]  Epoch 1: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.360, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.181750, 0.180643, 0.182526, 0.184668
Train average loss UNet                 (all)                : 0.729587

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.097739, 0.227826, 0.468254
Train average loss bass     (Triplet, dist_p, dist_n) : 0.207119, 0.171531, 0.169319
Train average loss piano    (Triplet, dist_p, dist_n) : 0.197672, 0.209825, 0.220219
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.198359, 0.214004, 0.224375
Train average loss residuals(Triplet, dist_p, dist_n) : 0.156686, 0.285214, 0.366554
Train average loss all      (Triplet)                 : 0.172702

== Recognize ==
Train average loss Recognize     : 1.348171
Train average accuracy drums     : 49.004997 %
Train average accuracy bass      : 49.689999 %
Train average accuracy piano     : 50.645000 %
Train average accuracy guitar    : 49.674999 %
Train average accuracy residuals : 49.509998 %

== Train average loss all : 0.172702

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.360, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.360, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]Epoch 2:  16%|█▌        | 50/313 [00:54<04:48,  0.91it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.360, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]Epoch 2:  16%|█▌        | 50/313 [00:54<04:48,  0.91it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=1.540, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]Epoch 2:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=1.540, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]Epoch 2:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.330, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]Epoch 2:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.330, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]Epoch 2:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=1.380, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]Epoch 2:  64%|██████▍   | 200/313 [03:12<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=1.380, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]Epoch 2:  64%|██████▍   | 200/313 [03:12<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=1.370, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]Epoch 2:  80%|███████▉  | 250/313 [03:57<00:59,  1.05it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=1.370, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]Epoch 2:  80%|███████▉  | 250/313 [03:57<00:59,  1.05it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.440, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]Epoch 2:  96%|█████████▌| 300/313 [04:42<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.440, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]Epoch 2:  96%|█████████▌| 300/313 [04:42<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=1.410, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]Epoch 2: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=1.410, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]Epoch 2: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.310, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.672, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.470, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=1.530, Valid/knn_avr=0.396, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 17.21it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 15.04it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 14.93it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 14.12it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 13.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175776, 0.175621, 0.183423, 0.168323
Valid average loss UNet                 (all)                : 0.703143

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070820, 0.229387, 0.602293
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.153054, 0.120122, 0.123812
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.147594, 0.245057, 0.325582
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.141702, 0.247020, 0.321716
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.127294, 0.309847, 0.407720
Valid average loss all      (Triplet)                 : 0.136687

== Recognize ==
Valid average loss Recognize     : 1.445149
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.136687

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8022706508636475 sec. =
Valid knn accuracy drums     : 65.8695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.407069444656372 sec. =
Valid knn accuracy bass      : 21.16935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.04493522644043 sec. =
Valid knn accuracy piano     : 24.4140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.556191921234131 sec. =
Valid knn accuracy guitar    : 34.82142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.368744134902954 sec. =
Valid knn accuracy residuals : 63.40909090909091%

Valid knn accuracy average   : 41.93670040732408%

                                                                      [AEpoch 2: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.310, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.173, Train/loss_recog_epoch=1.350]Epoch 2: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.310, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.182396, 0.181234, 0.183095, 0.185010
Train average loss UNet                 (all)                : 0.731735

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.084875, 0.213667, 0.497718
Train average loss bass     (Triplet, dist_p, dist_n) : 0.207798, 0.147247, 0.143397
Train average loss piano    (Triplet, dist_p, dist_n) : 0.189984, 0.198649, 0.218685
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.188703, 0.213018, 0.235327
Train average loss residuals(Triplet, dist_p, dist_n) : 0.145817, 0.285646, 0.388765
Train average loss all      (Triplet)                 : 0.164745

== Recognize ==
Train average loss Recognize     : 1.370278
Train average accuracy drums     : 50.629997 %
Train average accuracy bass      : 50.430000 %
Train average accuracy piano     : 49.380001 %
Train average accuracy guitar    : 50.185001 %
Train average accuracy residuals : 50.134998 %

== Train average loss all : 0.164745

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.310, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.310, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]Epoch 3:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.310, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]Epoch 3:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.500, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]Epoch 3:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.500, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]Epoch 3:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.500, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]Epoch 3:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.500, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]Epoch 3:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.729, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.700, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]Epoch 3:  64%|██████▍   | 200/313 [03:08<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.729, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.700, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]Epoch 3:  64%|██████▍   | 200/313 [03:08<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.630, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]Epoch 3:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.630, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]Epoch 3:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.697, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.540, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]Epoch 3:  96%|█████████▌| 300/313 [04:40<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.697, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.540, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]Epoch 3:  96%|█████████▌| 300/313 [04:40<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.340, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]Epoch 3: 100%|██████████| 313/313 [04:49<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.340, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]Epoch 3: 100%|██████████| 313/313 [04:49<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.550, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.659, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.419, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.72it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 17.33it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 15.55it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 14.33it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 11.87it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 15.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.177266, 0.176882, 0.184851, 0.177784
Valid average loss UNet                 (all)                : 0.716783

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.069888, 0.191003, 0.614169
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.126008, 0.083778, 0.109207
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.169480, 0.240545, 0.278765
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.166235, 0.239831, 0.289125
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.142343, 0.349376, 0.438197
Valid average loss all      (Triplet)                 : 0.147065

== Recognize ==
Valid average loss Recognize     : 1.442280
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 56.500000 %

== Valid average loss all : 0.147065

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.61761474609375 sec. =
Valid knn accuracy drums     : 61.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.401080131530762 sec. =
Valid knn accuracy bass      : 17.137096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.940686225891113 sec. =
Valid knn accuracy piano     : 35.15625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6562042236328125 sec. =
Valid knn accuracy guitar    : 48.214285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.306800127029419 sec. =
Valid knn accuracy residuals : 58.18181818181818%

Valid knn accuracy average   : 43.95528143840732%

                                                                      [AEpoch 3: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.550, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.165, Train/loss_unet_all_epoch=0.732, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.370]Epoch 3: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.550, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.182397, 0.181232, 0.183070, 0.183718
Train average loss UNet                 (all)                : 0.730417

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.081473, 0.210308, 0.504538
Train average loss bass     (Triplet, dist_p, dist_n) : 0.207055, 0.144782, 0.139950
Train average loss piano    (Triplet, dist_p, dist_n) : 0.187816, 0.217270, 0.239732
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.179849, 0.220826, 0.257925
Train average loss residuals(Triplet, dist_p, dist_n) : 0.144173, 0.279819, 0.384870
Train average loss all      (Triplet)                 : 0.161292

== Recognize ==
Train average loss Recognize     : 1.476333
Train average accuracy drums     : 50.155003 %
Train average accuracy bass      : 49.904999 %
Train average accuracy piano     : 50.265003 %
Train average accuracy guitar    : 49.794998 %
Train average accuracy residuals : 49.654999 %

== Train average loss all : 0.161292

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.550, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.550, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]Epoch 4:  16%|█▌        | 50/313 [00:53<04:41,  0.93it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.550, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]Epoch 4:  16%|█▌        | 50/313 [00:53<04:41,  0.93it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.540, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]Epoch 4:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.540, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]Epoch 4:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.460, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]Epoch 4:  48%|████▊     | 150/313 [02:25<02:38,  1.03it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.460, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]Epoch 4:  48%|████▊     | 150/313 [02:25<02:38,  1.03it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.600, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]Epoch 4:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.600, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]Epoch 4:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.500, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]Epoch 4:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.500, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]Epoch 4:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.699, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.680, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]Epoch 4:  96%|█████████▌| 300/313 [04:42<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.699, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.680, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]Epoch 4:  96%|█████████▌| 300/313 [04:42<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.600, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]Epoch 4: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.600, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]Epoch 4: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.530, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.717, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.440, Valid/knn_avr=0.440, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.57it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 15.54it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 14.38it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 15.87it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 11.04it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 14.20it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.174797, 0.174437, 0.182388, 0.172996
Valid average loss UNet                 (all)                : 0.704617

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061869, 0.162288, 0.523517
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.142628, 0.098755, 0.106290
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.194289, 0.285012, 0.294832
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.130671, 0.241053, 0.352332
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.132725, 0.372925, 0.481620
Valid average loss all      (Triplet)                 : 0.138866

== Recognize ==
Valid average loss Recognize     : 1.604630
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.138866

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.683933734893799 sec. =
Valid knn accuracy drums     : 54.347826086956516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.474480390548706 sec. =
Valid knn accuracy bass      : 21.572580645161292%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.868776798248291 sec. =
Valid knn accuracy piano     : 36.71875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.705407619476318 sec. =
Valid knn accuracy guitar    : 39.955357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.487285137176514 sec. =
Valid knn accuracy residuals : 59.09090909090909%

Valid knn accuracy average   : 42.33708459317681%

                                                                      [AEpoch 4: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.530, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.730, Train/loss_triplet_all_epoch=0.161, Train/loss_recog_epoch=1.480]Epoch 4: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.530, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.182323, 0.181159, 0.182996, 0.184176
Train average loss UNet                 (all)                : 0.730654

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.075460, 0.218111, 0.536745
Train average loss bass     (Triplet, dist_p, dist_n) : 0.202523, 0.150111, 0.152125
Train average loss piano    (Triplet, dist_p, dist_n) : 0.183575, 0.233311, 0.262469
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.174582, 0.228916, 0.276590
Train average loss residuals(Triplet, dist_p, dist_n) : 0.136515, 0.294344, 0.414529
Train average loss all      (Triplet)                 : 0.156083

== Recognize ==
Train average loss Recognize     : 1.528118
Train average accuracy drums     : 50.199997 %
Train average accuracy bass      : 50.054996 %
Train average accuracy piano     : 49.810001 %
Train average accuracy guitar    : 49.375000 %
Train average accuracy residuals : 50.360001 %

== Train average loss all : 0.156083

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.530, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.530, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]Epoch 5:  16%|█▌        | 50/313 [00:52<04:38,  0.94it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.530, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]Epoch 5:  16%|█▌        | 50/313 [00:52<04:38,  0.94it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.580, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]Epoch 5:  32%|███▏      | 100/313 [01:38<03:28,  1.02it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.580, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]Epoch 5:  32%|███▏      | 100/313 [01:38<03:28,  1.02it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.660, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]Epoch 5:  48%|████▊     | 150/313 [02:23<02:35,  1.05it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.660, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]Epoch 5:  48%|████▊     | 150/313 [02:23<02:35,  1.05it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.510, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]Epoch 5:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.510, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]Epoch 5:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=1.800, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]Epoch 5:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=1.800, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]Epoch 5:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=1.690, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]Epoch 5:  96%|█████████▌| 300/313 [04:40<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=1.690, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]Epoch 5:  96%|█████████▌| 300/313 [04:40<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.530, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]Epoch 5: 100%|██████████| 313/313 [04:49<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.530, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]Epoch 5: 100%|██████████| 313/313 [04:49<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.580, Valid/loss_all_step=0.077, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=1.700, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.423, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 16.92it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.17it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 15.22it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 14.84it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 11.27it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.174628, 0.174478, 0.182093, 0.171582
Valid average loss UNet                 (all)                : 0.702782

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.072758, 0.190506, 0.567488
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.094801, 0.103046, 0.179890
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.206189, 0.312842, 0.324076
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.111004, 0.237409, 0.358034
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.190339, 0.449596, 0.510775
Valid average loss all      (Triplet)                 : 0.143526

== Recognize ==
Valid average loss Recognize     : 1.548942
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.143526

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.488896369934082 sec. =
Valid knn accuracy drums     : 64.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.579919338226318 sec. =
Valid knn accuracy bass      : 18.951612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.90310263633728 sec. =
Valid knn accuracy piano     : 37.3046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.607224225997925 sec. =
Valid knn accuracy guitar    : 39.955357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.433505058288574 sec. =
Valid knn accuracy residuals : 64.54545454545455%

Valid knn accuracy average   : 45.02098763569881%

                                                                      [AEpoch 5: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.580, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.156, Train/loss_unet_all_epoch=0.731, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.530]Epoch 5: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.580, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.181943, 0.180758, 0.182607, 0.183986
Train average loss UNet                 (all)                : 0.729293

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.072099, 0.211973, 0.557664
Train average loss bass     (Triplet, dist_p, dist_n) : 0.200858, 0.149492, 0.154067
Train average loss piano    (Triplet, dist_p, dist_n) : 0.181388, 0.233064, 0.267063
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.171841, 0.224218, 0.275329
Train average loss residuals(Triplet, dist_p, dist_n) : 0.136693, 0.299450, 0.425277
Train average loss all      (Triplet)                 : 0.154160

== Recognize ==
Train average loss Recognize     : 1.604130
Train average accuracy drums     : 49.344997 %
Train average accuracy bass      : 50.015003 %
Train average accuracy piano     : 50.040001 %
Train average accuracy guitar    : 49.959999 %
Train average accuracy residuals : 49.360001 %

== Train average loss all : 0.154160

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.580, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.580, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]Epoch 6:  16%|█▌        | 50/313 [00:53<04:42,  0.93it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.580, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]Epoch 6:  16%|█▌        | 50/313 [00:53<04:42,  0.93it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=1.700, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]Epoch 6:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=1.700, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]Epoch 6:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.650, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]Epoch 6:  48%|████▊     | 150/313 [02:26<02:38,  1.03it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.650, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]Epoch 6:  48%|████▊     | 150/313 [02:26<02:38,  1.03it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.740, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]Epoch 6:  64%|██████▍   | 200/313 [03:11<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.740, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]Epoch 6:  64%|██████▍   | 200/313 [03:11<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.600, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]Epoch 6:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.600, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]Epoch 6:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.699, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.780, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]Epoch 6:  96%|█████████▌| 300/313 [04:40<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.699, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.780, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]Epoch 6:  96%|█████████▌| 300/313 [04:40<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.696, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.630, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]Epoch 6: 100%|██████████| 313/313 [04:49<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.696, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.630, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]Epoch 6: 100%|██████████| 313/313 [04:49<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.860, Valid/loss_all_step=0.130, Valid/loss_unet_all_step=0.677, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=1.530, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.703, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.450, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 13.63it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 15.33it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 15.57it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 14.13it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 10.61it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175685, 0.175351, 0.183254, 0.167848
Valid average loss UNet                 (all)                : 0.702138

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064657, 0.236572, 0.654935
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.122480, 0.096716, 0.126139
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.193375, 0.335209, 0.360761
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.109725, 0.238896, 0.382377
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.173430, 0.400618, 0.472755
Valid average loss all      (Triplet)                 : 0.139144

== Recognize ==
Valid average loss Recognize     : 1.809303
Valid average accuracy drums     : 43.500000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 41.500000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 56.500000 %

== Valid average loss all : 0.139144

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.532294034957886 sec. =
Valid knn accuracy drums     : 56.086956521739125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.729666471481323 sec. =
Valid knn accuracy bass      : 28.830645161290324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.674653053283691 sec. =
Valid knn accuracy piano     : 39.0625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.630626678466797 sec. =
Valid knn accuracy guitar    : 39.50892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.533281564712524 sec. =
Valid knn accuracy residuals : 62.95454545454545%

Valid knn accuracy average   : 45.28871514180069%

                                                                      [AEpoch 6: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.860, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.729, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.600]Epoch 6: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.860, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.181682, 0.180547, 0.182396, 0.183182
Train average loss UNet                 (all)                : 0.727808

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.068216, 0.222320, 0.585979
Train average loss bass     (Triplet, dist_p, dist_n) : 0.202404, 0.153496, 0.156137
Train average loss piano    (Triplet, dist_p, dist_n) : 0.178618, 0.250465, 0.288163
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.168328, 0.241980, 0.300378
Train average loss residuals(Triplet, dist_p, dist_n) : 0.131596, 0.312816, 0.449168
Train average loss all      (Triplet)                 : 0.151453

== Recognize ==
Train average loss Recognize     : 1.696653
Train average accuracy drums     : 49.704998 %
Train average accuracy bass      : 50.330002 %
Train average accuracy piano     : 49.744999 %
Train average accuracy guitar    : 49.860001 %
Train average accuracy residuals : 49.434998 %

== Train average loss all : 0.151453

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.860, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.860, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]Epoch 7:  16%|█▌        | 50/313 [00:53<04:42,  0.93it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.860, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]Epoch 7:  16%|█▌        | 50/313 [00:53<04:42,  0.93it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=1.760, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]Epoch 7:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=1.760, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]Epoch 7:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.750, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]Epoch 7:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.750, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]Epoch 7:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.530, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]Epoch 7:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.530, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]Epoch 7:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.730, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]Epoch 7:  80%|███████▉  | 250/313 [03:54<00:59,  1.07it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.730, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]Epoch 7:  80%|███████▉  | 250/313 [03:54<00:59,  1.07it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.780, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]Epoch 7:  96%|█████████▌| 300/313 [04:39<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.780, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]Epoch 7:  96%|█████████▌| 300/313 [04:39<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.750, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]Epoch 7: 100%|██████████| 313/313 [04:48<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.750, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]Epoch 7: 100%|██████████| 313/313 [04:48<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.820, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.666, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.139, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.139, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.453, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 17.09it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 15.49it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 16.63it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 14.93it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 13.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.174147, 0.174079, 0.181675, 0.176324
Valid average loss UNet                 (all)                : 0.706226

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083105, 0.300251, 0.803431
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.107370, 0.125826, 0.180016
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.156430, 0.322234, 0.384506
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.136428, 0.286593, 0.405544
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.145951, 0.431274, 0.583866
Valid average loss all      (Triplet)                 : 0.133069

== Recognize ==
Valid average loss Recognize     : 1.837488
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.133069

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6786744594573975 sec. =
Valid knn accuracy drums     : 59.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.613993644714355 sec. =
Valid knn accuracy bass      : 19.556451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.651289939880371 sec. =
Valid knn accuracy piano     : 37.3046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.530686378479004 sec. =
Valid knn accuracy guitar    : 39.285714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.794170141220093 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 44.37166316984208%

                                                                      [AEpoch 7: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.820, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.151, Train/loss_unet_all_epoch=0.728, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.700]Epoch 7: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.820, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.181295, 0.180119, 0.182017, 0.183631
Train average loss UNet                 (all)                : 0.727062

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.066071, 0.231901, 0.602992
Train average loss bass     (Triplet, dist_p, dist_n) : 0.196086, 0.163316, 0.175686
Train average loss piano    (Triplet, dist_p, dist_n) : 0.174346, 0.254646, 0.297790
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.163024, 0.242240, 0.310363
Train average loss residuals(Triplet, dist_p, dist_n) : 0.126670, 0.313265, 0.454841
Train average loss all      (Triplet)                 : 0.146754

== Recognize ==
Train average loss Recognize     : 1.764941
Train average accuracy drums     : 50.019997 %
Train average accuracy bass      : 50.015003 %
Train average accuracy piano     : 49.974998 %
Train average accuracy guitar    : 50.370003 %
Train average accuracy residuals : 50.440002 %

== Train average loss all : 0.146754

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.820, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.820, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]Epoch 8:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.820, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]Epoch 8:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.610, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]Epoch 8:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.610, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]Epoch 8:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.780, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]Epoch 8:  48%|████▊     | 150/313 [02:25<02:38,  1.03it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.780, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]Epoch 8:  48%|████▊     | 150/313 [02:25<02:38,  1.03it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.690, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]Epoch 8:  64%|██████▍   | 200/313 [03:11<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.690, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]Epoch 8:  64%|██████▍   | 200/313 [03:11<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.710, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]Epoch 8:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.710, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]Epoch 8:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.701, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.890, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]Epoch 8:  96%|█████████▌| 300/313 [04:42<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.701, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.890, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]Epoch 8:  96%|█████████▌| 300/313 [04:42<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.697, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.890, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]Epoch 8: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.697, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.890, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]Epoch 8: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=1.840, Valid/loss_all_step=0.0601, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.0601, Valid/loss_recog_step=2.120, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=1.840, Valid/knn_avr=0.444, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 14.50it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 14.86it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 16.07it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 12.49it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 14.11it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.173430, 0.173087, 0.181056, 0.174757
Valid average loss UNet                 (all)                : 0.702330

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.069071, 0.232368, 0.684710
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.150637, 0.161884, 0.182871
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.241534, 0.402827, 0.388970
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.123245, 0.299138, 0.440748
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.155009, 0.409400, 0.516817
Valid average loss all      (Triplet)                 : 0.164622

== Recognize ==
Valid average loss Recognize     : 1.803396
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.164622

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.957077980041504 sec. =
Valid knn accuracy drums     : 61.30434782608696%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.400110483169556 sec. =
Valid knn accuracy bass      : 20.766129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.571028470993042 sec. =
Valid knn accuracy piano     : 32.03125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.886196613311768 sec. =
Valid knn accuracy guitar    : 35.9375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.529072999954224 sec. =
Valid knn accuracy residuals : 68.63636363636364%

Valid knn accuracy average   : 43.73511809894174%

                                                                      [AEpoch 8: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=1.840, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.147, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.760]  Epoch 8: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=1.840, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.180992, 0.179844, 0.181726, 0.183964
Train average loss UNet                 (all)                : 0.726526

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.064889, 0.241621, 0.622790
Train average loss bass     (Triplet, dist_p, dist_n) : 0.193448, 0.172877, 0.190195
Train average loss piano    (Triplet, dist_p, dist_n) : 0.171536, 0.265306, 0.314414
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.162491, 0.256730, 0.327653
Train average loss residuals(Triplet, dist_p, dist_n) : 0.127166, 0.327109, 0.472652
Train average loss all      (Triplet)                 : 0.145559

== Recognize ==
Train average loss Recognize     : 1.784685
Train average accuracy drums     : 49.695000 %
Train average accuracy bass      : 50.024998 %
Train average accuracy piano     : 50.430000 %
Train average accuracy guitar    : 50.230003 %
Train average accuracy residuals : 49.480000 %

== Train average loss all : 0.145559

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=1.840, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=1.840, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]Epoch 9:  16%|█▌        | 50/313 [00:52<04:35,  0.95it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=1.840, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]Epoch 9:  16%|█▌        | 50/313 [00:52<04:35,  0.95it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.143, Train/loss_recog_step=1.710, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]Epoch 9:  32%|███▏      | 100/313 [01:37<03:27,  1.03it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.143, Train/loss_recog_step=1.710, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]Epoch 9:  32%|███▏      | 100/313 [01:37<03:27,  1.03it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.890, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]Epoch 9:  48%|████▊     | 150/313 [02:23<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.890, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]Epoch 9:  48%|████▊     | 150/313 [02:23<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.728, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=1.910, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]Epoch 9:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.728, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=1.910, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]Epoch 9:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.810, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]Epoch 9:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.810, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]Epoch 9:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.703, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.770, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]Epoch 9:  96%|█████████▌| 300/313 [04:39<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.703, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.770, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]Epoch 9:  96%|█████████▌| 300/313 [04:39<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=1.900, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]Epoch 9: 100%|██████████| 313/313 [04:48<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=1.900, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]Epoch 9: 100%|██████████| 313/313 [04:48<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=2.100, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.670, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.890, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.702, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=1.800, Valid/knn_avr=0.437, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.78it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 16.95it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 15.04it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 15.46it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 11.68it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 11.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.176381, 0.175845, 0.184013, 0.176245
Valid average loss UNet                 (all)                : 0.712484

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073087, 0.259261, 0.745939
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.144417, 0.134494, 0.145329
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.185565, 0.363104, 0.404106
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.110464, 0.275821, 0.438579
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.153596, 0.431307, 0.540352
Valid average loss all      (Triplet)                 : 0.149405

== Recognize ==
Valid average loss Recognize     : 1.947884
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 54.500000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.149405

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.562015533447266 sec. =
Valid knn accuracy drums     : 48.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.548837661743164 sec. =
Valid knn accuracy bass      : 22.177419354838708%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.552236795425415 sec. =
Valid knn accuracy piano     : 36.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9043128490448 sec. =
Valid knn accuracy guitar    : 44.419642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.405407428741455 sec. =
Valid knn accuracy residuals : 70.22727272727273%

Valid knn accuracy average   : 44.28708166176391%

                                                                      [AEpoch 9: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=2.100, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.146, Train/loss_unet_all_epoch=0.727, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=1.780]Epoch 9: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=2.100, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.180508, 0.179340, 0.181266, 0.184276
Train average loss UNet                 (all)                : 0.725390

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.061336, 0.251264, 0.656442
Train average loss bass     (Triplet, dist_p, dist_n) : 0.191406, 0.167735, 0.186657
Train average loss piano    (Triplet, dist_p, dist_n) : 0.168743, 0.275985, 0.329287
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.159730, 0.260164, 0.336942
Train average loss residuals(Triplet, dist_p, dist_n) : 0.120637, 0.336489, 0.490547
Train average loss all      (Triplet)                 : 0.141865

== Recognize ==
Train average loss Recognize     : 1.857930
Train average accuracy drums     : 50.230003 %
Train average accuracy bass      : 49.599998 %
Train average accuracy piano     : 50.105000 %
Train average accuracy guitar    : 50.085003 %
Train average accuracy residuals : 49.910000 %

== Train average loss all : 0.141865

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=2.100, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=2.100, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]Epoch 10:  16%|█▌        | 50/313 [00:54<04:44,  0.93it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=2.100, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]Epoch 10:  16%|█▌        | 50/313 [00:54<04:44,  0.93it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.830, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]Epoch 10:  32%|███▏      | 100/313 [01:40<03:33,  1.00it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.830, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]Epoch 10:  32%|███▏      | 100/313 [01:40<03:33,  1.00it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=2.150, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]Epoch 10:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=2.150, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]Epoch 10:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.727, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=2.220, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]Epoch 10:  64%|██████▍   | 200/313 [03:14<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.727, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=2.220, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]Epoch 10:  64%|██████▍   | 200/313 [03:14<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.950, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]Epoch 10:  80%|███████▉  | 250/313 [04:01<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.950, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]Epoch 10:  80%|███████▉  | 250/313 [04:01<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.730, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]Epoch 10:  96%|█████████▌| 300/313 [04:48<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.730, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]Epoch 10:  96%|█████████▌| 300/313 [04:48<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.820, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]Epoch 10: 100%|██████████| 313/313 [04:57<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.820, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]Epoch 10: 100%|██████████| 313/313 [04:57<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.880, Valid/loss_all_step=0.123, Valid/loss_unet_all_step=0.684, Valid/loss_triplet_all_step=0.123, Valid/loss_recog_step=1.980, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.712, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.950, Valid/knn_avr=0.443, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.75it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 11.69it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 13.78it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 13.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 13.95it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 13.16it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.174713, 0.174637, 0.182239, 0.177016
Valid average loss UNet                 (all)                : 0.708604

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077133, 0.278976, 0.781099
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.132445, 0.120331, 0.154918
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.224789, 0.459912, 0.471049
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.116393, 0.317732, 0.485917
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.173221, 0.509128, 0.612477
Valid average loss all      (Triplet)                 : 0.158447

== Recognize ==
Valid average loss Recognize     : 1.963670
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 42.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.158447

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.642024278640747 sec. =
Valid knn accuracy drums     : 63.69565217391304%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.186158418655396 sec. =
Valid knn accuracy bass      : 24.39516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.97783899307251 sec. =
Valid knn accuracy piano     : 41.015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.638329267501831 sec. =
Valid knn accuracy guitar    : 44.419642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.35532021522522 sec. =
Valid knn accuracy residuals : 59.31818181818181%

Valid knn accuracy average   : 46.56885262791206%

                                                                      [AEpoch 10: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.880, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.142, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.142, Train/loss_recog_epoch=1.860]Epoch 10: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.880, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.180877, 0.179726, 0.181646, 0.183540
Train average loss UNet                 (all)                : 0.725790

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.059588, 0.255973, 0.669385
Train average loss bass     (Triplet, dist_p, dist_n) : 0.188178, 0.180644, 0.204486
Train average loss piano    (Triplet, dist_p, dist_n) : 0.166939, 0.284983, 0.341467
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.154317, 0.268964, 0.355329
Train average loss residuals(Triplet, dist_p, dist_n) : 0.117743, 0.359969, 0.526934
Train average loss all      (Triplet)                 : 0.138943

== Recognize ==
Train average loss Recognize     : 1.962500
Train average accuracy drums     : 50.110001 %
Train average accuracy bass      : 49.334999 %
Train average accuracy piano     : 50.045002 %
Train average accuracy guitar    : 49.794998 %
Train average accuracy residuals : 50.234997 %

== Train average loss all : 0.138943

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.880, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.880, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]Epoch 11:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.880, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]Epoch 11:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.710, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=2.040, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]Epoch 11:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.710, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=2.040, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]Epoch 11:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.736, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.910, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]Epoch 11:  48%|████▊     | 150/313 [02:25<02:38,  1.03it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.736, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.910, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]Epoch 11:  48%|████▊     | 150/313 [02:25<02:38,  1.03it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=2.120, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]Epoch 11:  64%|██████▍   | 200/313 [03:12<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=2.120, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]Epoch 11:  64%|██████▍   | 200/313 [03:12<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.960, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]Epoch 11:  80%|███████▉  | 250/313 [03:57<00:59,  1.05it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.960, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]Epoch 11:  80%|███████▉  | 250/313 [03:57<00:59,  1.05it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.870, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]Epoch 11:  96%|█████████▌| 300/313 [04:45<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.870, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]Epoch 11:  96%|█████████▌| 300/313 [04:45<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.697, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=2.030, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]Epoch 11: 100%|██████████| 313/313 [04:53<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.697, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=2.030, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]Epoch 11: 100%|██████████| 313/313 [04:53<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.860, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.691, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=1.900, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.466, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.76it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 16.01it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 16.34it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 13.77it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 15.25it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 14.27it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175019, 0.174885, 0.182324, 0.178799
Valid average loss UNet                 (all)                : 0.711026

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077466, 0.268933, 0.712783
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.115789, 0.118912, 0.165935
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.158264, 0.370168, 0.430129
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.136556, 0.298903, 0.419500
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.139563, 0.494347, 0.629575
Valid average loss all      (Triplet)                 : 0.136402

== Recognize ==
Valid average loss Recognize     : 1.958643
Valid average accuracy drums     : 57.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.136402

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.65888786315918 sec. =
Valid knn accuracy drums     : 58.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.594439506530762 sec. =
Valid knn accuracy bass      : 23.991935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.002946138381958 sec. =
Valid knn accuracy piano     : 43.5546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.55847954750061 sec. =
Valid knn accuracy guitar    : 44.419642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.463152885437012 sec. =
Valid knn accuracy residuals : 69.54545454545455%

Valid knn accuracy average   : 47.91103972946759%

                                                                      [AEpoch 11: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.860, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.726, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=1.960]Epoch 11: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.860, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.180628, 0.179468, 0.181366, 0.183548
Train average loss UNet                 (all)                : 0.725011

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.057532, 0.266414, 0.688132
Train average loss bass     (Triplet, dist_p, dist_n) : 0.184477, 0.189932, 0.220339
Train average loss piano    (Triplet, dist_p, dist_n) : 0.162476, 0.301099, 0.366606
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.152339, 0.275670, 0.365480
Train average loss residuals(Triplet, dist_p, dist_n) : 0.115037, 0.379116, 0.553742
Train average loss all      (Triplet)                 : 0.135695

== Recognize ==
Train average loss Recognize     : 2.018605
Train average accuracy drums     : 50.325001 %
Train average accuracy bass      : 50.195004 %
Train average accuracy piano     : 50.094997 %
Train average accuracy guitar    : 50.459999 %
Train average accuracy residuals : 50.494999 %

== Train average loss all : 0.135695

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.860, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.860, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]Epoch 12:  16%|█▌        | 50/313 [00:55<04:54,  0.89it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.860, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]Epoch 12:  16%|█▌        | 50/313 [00:56<04:54,  0.89it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=2.070, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]Epoch 12:  32%|███▏      | 100/313 [01:42<03:38,  0.98it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=2.070, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]Epoch 12:  32%|███▏      | 100/313 [01:42<03:38,  0.98it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=2.160, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]Epoch 12:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=2.160, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]Epoch 12:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.0972, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.0972, Train/loss_recog_step=2.100, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]Epoch 12:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0972, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.0972, Train/loss_recog_step=2.100, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]Epoch 12:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=2.090, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]  Epoch 12:  80%|███████▉  | 250/313 [04:01<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=2.090, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]Epoch 12:  80%|███████▉  | 250/313 [04:01<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.702, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=2.090, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]Epoch 12:  96%|█████████▌| 300/313 [04:46<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.702, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=2.090, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]Epoch 12:  96%|█████████▌| 300/313 [04:46<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=2.080, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]Epoch 12: 100%|██████████| 313/313 [04:55<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=2.080, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]Epoch 12: 100%|██████████| 313/313 [04:55<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.700, Valid/loss_all_step=0.103, Valid/loss_unet_all_step=0.694, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.960, Valid/knn_avr=0.479, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 13.52it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 13.80it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 14.42it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 15.52it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 14.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175483, 0.175070, 0.182986, 0.173890
Valid average loss UNet                 (all)                : 0.707429

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.068290, 0.274515, 0.775176
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.123108, 0.126886, 0.160468
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.196138, 0.419639, 0.460601
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.114332, 0.326667, 0.471061
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.146767, 0.482712, 0.621280
Valid average loss all      (Triplet)                 : 0.137903

== Recognize ==
Valid average loss Recognize     : 2.206013
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.137903

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.569308042526245 sec. =
Valid knn accuracy drums     : 59.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.53594446182251 sec. =
Valid knn accuracy bass      : 26.209677419354836%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.115755558013916 sec. =
Valid knn accuracy piano     : 39.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.669877767562866 sec. =
Valid knn accuracy guitar    : 48.88392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.414937496185303 sec. =
Valid knn accuracy residuals : 70.9090909090909%

Valid knn accuracy average   : 49.125811119105286%

                                                                      [AEpoch 12: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.700, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.136, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=2.020]Epoch 12: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.700, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.180273, 0.179093, 0.180993, 0.184554
Train average loss UNet                 (all)                : 0.724913

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.054523, 0.282275, 0.720747
Train average loss bass     (Triplet, dist_p, dist_n) : 0.186322, 0.184695, 0.211771
Train average loss piano    (Triplet, dist_p, dist_n) : 0.157710, 0.311504, 0.385432
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.150162, 0.288251, 0.384703
Train average loss residuals(Triplet, dist_p, dist_n) : 0.113326, 0.387159, 0.567399
Train average loss all      (Triplet)                 : 0.133951

== Recognize ==
Train average loss Recognize     : 2.051198
Train average accuracy drums     : 50.570000 %
Train average accuracy bass      : 50.019997 %
Train average accuracy piano     : 50.674999 %
Train average accuracy guitar    : 50.129997 %
Train average accuracy residuals : 50.370003 %

== Train average loss all : 0.133951

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.700, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.700, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]Epoch 13:  16%|█▌        | 50/313 [00:54<04:44,  0.92it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.700, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]Epoch 13:  16%|█▌        | 50/313 [00:54<04:45,  0.92it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=2.130, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]Epoch 13:  32%|███▏      | 100/313 [01:40<03:33,  1.00it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=2.130, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]Epoch 13:  32%|███▏      | 100/313 [01:40<03:33,  1.00it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=2.280, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]Epoch 13:  48%|████▊     | 150/313 [02:24<02:37,  1.03it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=2.280, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]Epoch 13:  48%|████▊     | 150/313 [02:24<02:37,  1.03it/s, v_num=0, Train/loss_all_step=0.0865, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.0865, Train/loss_recog_step=2.080, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]Epoch 13:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0865, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.0865, Train/loss_recog_step=2.080, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]Epoch 13:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=2.200, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]  Epoch 13:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=2.200, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]Epoch 13:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=2.150, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]Epoch 13:  96%|█████████▌| 300/313 [04:41<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=2.150, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]Epoch 13:  96%|█████████▌| 300/313 [04:41<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=1.880, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]Epoch 13: 100%|██████████| 313/313 [04:50<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=1.880, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]Epoch 13: 100%|██████████| 313/313 [04:50<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.0999, Train/loss_unet_all_step=0.693, Train/loss_triplet_all_step=0.0999, Train/loss_recog_step=2.300, Valid/loss_all_step=0.0894, Valid/loss_unet_all_step=0.655, Valid/loss_triplet_all_step=0.0894, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.138, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.138, Valid/loss_recog_epoch=2.210, Valid/knn_avr=0.491, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.76it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 13.38it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 14.83it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 16.55it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 15.02it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 15.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175302, 0.175021, 0.182756, 0.172690
Valid average loss UNet                 (all)                : 0.705768

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091227, 0.320375, 0.911589
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.108213, 0.150494, 0.207757
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.167258, 0.389392, 0.464734
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.162473, 0.406978, 0.530543
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.155386, 0.553836, 0.689398
Valid average loss all      (Triplet)                 : 0.153738

== Recognize ==
Valid average loss Recognize     : 2.074027
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.153738

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.586428880691528 sec. =
Valid knn accuracy drums     : 59.56521739130435%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.891233921051025 sec. =
Valid knn accuracy bass      : 17.741935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.760023355484009 sec. =
Valid knn accuracy piano     : 39.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5348052978515625 sec. =
Valid knn accuracy guitar    : 42.63392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.346551418304443 sec. =
Valid knn accuracy residuals : 73.63636363636363%

Valid knn accuracy average   : 46.64517651659351%

                                                                      [AEpoch 13: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0999, Train/loss_unet_all_step=0.693, Train/loss_triplet_all_step=0.0999, Train/loss_recog_step=2.300, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.725, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=2.050]  Epoch 13: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0999, Train/loss_unet_all_step=0.693, Train/loss_triplet_all_step=0.0999, Train/loss_recog_step=2.300, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.180255, 0.179100, 0.181017, 0.183995
Train average loss UNet                 (all)                : 0.724366

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.052525, 0.307565, 0.782809
Train average loss bass     (Triplet, dist_p, dist_n) : 0.180130, 0.201476, 0.236732
Train average loss piano    (Triplet, dist_p, dist_n) : 0.155519, 0.320234, 0.400775
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.146636, 0.305280, 0.409949
Train average loss residuals(Triplet, dist_p, dist_n) : 0.109998, 0.404923, 0.597206
Train average loss all      (Triplet)                 : 0.130420

== Recognize ==
Train average loss Recognize     : 2.134724
Train average accuracy drums     : 50.480003 %
Train average accuracy bass      : 50.064999 %
Train average accuracy piano     : 49.974998 %
Train average accuracy guitar    : 50.344997 %
Train average accuracy residuals : 50.365002 %

== Train average loss all : 0.130420

Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0999, Train/loss_unet_all_step=0.693, Train/loss_triplet_all_step=0.0999, Train/loss_recog_step=2.300, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]          Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0999, Train/loss_unet_all_step=0.693, Train/loss_triplet_all_step=0.0999, Train/loss_recog_step=2.300, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]Epoch 14:  16%|█▌        | 50/313 [00:53<04:42,  0.93it/s, v_num=0, Train/loss_all_step=0.0999, Train/loss_unet_all_step=0.693, Train/loss_triplet_all_step=0.0999, Train/loss_recog_step=2.300, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]Epoch 14:  16%|█▌        | 50/313 [00:53<04:42,  0.93it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=2.090, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]  Epoch 14:  32%|███▏      | 100/313 [01:38<03:29,  1.02it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=2.090, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]Epoch 14:  32%|███▏      | 100/313 [01:38<03:29,  1.02it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=2.370, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]Epoch 14:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=2.370, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]Epoch 14:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.0873, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.0873, Train/loss_recog_step=2.430, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]Epoch 14:  64%|██████▍   | 200/313 [03:09<01:47,  1.06it/s, v_num=0, Train/loss_all_step=0.0873, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.0873, Train/loss_recog_step=2.430, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]Epoch 14:  64%|██████▍   | 200/313 [03:09<01:47,  1.06it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=2.220, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]  Epoch 14:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=2.220, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]Epoch 14:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=2.170, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]Epoch 14:  96%|█████████▌| 300/313 [04:40<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=2.170, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]Epoch 14:  96%|█████████▌| 300/313 [04:40<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.690, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=2.230, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]Epoch 14: 100%|██████████| 313/313 [04:48<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.690, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=2.230, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]Epoch 14: 100%|██████████| 313/313 [04:48<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=2.300, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.880, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.78it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 16.07it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 15.02it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 14.94it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 15.10it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 15.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.174167, 0.174036, 0.181435, 0.170060
Valid average loss UNet                 (all)                : 0.699699

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091370, 0.332876, 0.915915
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.114859, 0.156283, 0.212110
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.169623, 0.422221, 0.496654
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.135626, 0.343845, 0.482409
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.139433, 0.514190, 0.650594
Valid average loss all      (Triplet)                 : 0.141603

== Recognize ==
Valid average loss Recognize     : 2.231208
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.141603

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.936529874801636 sec. =
Valid knn accuracy drums     : 67.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.606539964675903 sec. =
Valid knn accuracy bass      : 24.39516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.661311864852905 sec. =
Valid knn accuracy piano     : 40.234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.593544006347656 sec. =
Valid knn accuracy guitar    : 44.86607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.701112747192383 sec. =
Valid knn accuracy residuals : 70.68181818181817%

Valid knn accuracy average   : 49.51374604970766%

                                                                      [AEpoch 14: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=2.300, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.130, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=2.130]Epoch 14: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=2.300, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.180257, 0.179091, 0.180989, 0.183628
Train average loss UNet                 (all)                : 0.723965

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.052350, 0.315602, 0.803186
Train average loss bass     (Triplet, dist_p, dist_n) : 0.177265, 0.224865, 0.266384
Train average loss piano    (Triplet, dist_p, dist_n) : 0.152542, 0.337333, 0.420313
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.144570, 0.319378, 0.430375
Train average loss residuals(Triplet, dist_p, dist_n) : 0.105099, 0.435436, 0.641863
Train average loss all      (Triplet)                 : 0.127912

== Recognize ==
Train average loss Recognize     : 2.209504
Train average accuracy drums     : 49.184998 %
Train average accuracy bass      : 50.220001 %
Train average accuracy piano     : 50.120003 %
Train average accuracy guitar    : 50.309998 %
Train average accuracy residuals : 49.910000 %

== Train average loss all : 0.127912

Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=2.300, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]          Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=2.300, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]Epoch 15:  16%|█▌        | 50/313 [00:53<04:43,  0.93it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=2.300, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]Epoch 15:  16%|█▌        | 50/313 [00:53<04:43,  0.93it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=2.040, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]Epoch 15:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.722, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=2.040, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]Epoch 15:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=2.090, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]Epoch 15:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.144, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=2.090, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]Epoch 15:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.0829, Train/loss_unet_all_step=0.724, Train/loss_triplet_all_step=0.0829, Train/loss_recog_step=1.990, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]Epoch 15:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0829, Train/loss_unet_all_step=0.724, Train/loss_triplet_all_step=0.0829, Train/loss_recog_step=1.990, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]Epoch 15:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=2.110, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]  Epoch 15:  80%|███████▉  | 250/313 [03:54<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=2.110, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]Epoch 15:  80%|███████▉  | 250/313 [03:54<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=2.290, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]Epoch 15:  96%|█████████▌| 300/313 [04:40<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=2.290, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]Epoch 15:  96%|█████████▌| 300/313 [04:40<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=2.450, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]Epoch 15: 100%|██████████| 313/313 [04:49<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=2.450, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]Epoch 15: 100%|██████████| 313/313 [04:49<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.0996, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0996, Train/loss_recog_step=2.330, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.671, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.700, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=2.230, Valid/knn_avr=0.495, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.75it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 17.24it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 17.11it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 15.65it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00,  9.46it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 13.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.174717, 0.174794, 0.182129, 0.177107
Valid average loss UNet                 (all)                : 0.708747

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.092358, 0.336165, 1.017720
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.131340, 0.180486, 0.214439
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.168466, 0.470817, 0.541297
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.107451, 0.375976, 0.568217
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.180859, 0.585448, 0.668229
Valid average loss all      (Triplet)                 : 0.143315

== Recognize ==
Valid average loss Recognize     : 2.446028
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 44.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.143315

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.947296380996704 sec. =
Valid knn accuracy drums     : 61.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.588035345077515 sec. =
Valid knn accuracy bass      : 24.39516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.70069694519043 sec. =
Valid knn accuracy piano     : 40.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.750235080718994 sec. =
Valid knn accuracy guitar    : 39.50892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.335665941238403 sec. =
Valid knn accuracy residuals : 73.86363636363636%

Valid knn accuracy average   : 47.90918383203403%

                                                                      [AEpoch 15: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0996, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0996, Train/loss_recog_step=2.330, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=2.210]Epoch 15: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0996, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0996, Train/loss_recog_step=2.330, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.180197, 0.179026, 0.180936, 0.183824
Train average loss UNet                 (all)                : 0.723983

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.050197, 0.320862, 0.809183
Train average loss bass     (Triplet, dist_p, dist_n) : 0.176676, 0.229633, 0.274707
Train average loss piano    (Triplet, dist_p, dist_n) : 0.147867, 0.342077, 0.434735
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.141304, 0.319099, 0.437997
Train average loss residuals(Triplet, dist_p, dist_n) : 0.102572, 0.436794, 0.645504
Train average loss all      (Triplet)                 : 0.125241

== Recognize ==
Train average loss Recognize     : 2.251490
Train average accuracy drums     : 50.070000 %
Train average accuracy bass      : 49.204998 %
Train average accuracy piano     : 49.855000 %
Train average accuracy guitar    : 50.064999 %
Train average accuracy residuals : 50.064999 %

== Train average loss all : 0.125241

Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0996, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0996, Train/loss_recog_step=2.330, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]          Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0996, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0996, Train/loss_recog_step=2.330, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]Epoch 16:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.0996, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0996, Train/loss_recog_step=2.330, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]Epoch 16:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=2.300, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]  Epoch 16:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=2.300, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]Epoch 16:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=2.640, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]Epoch 16:  48%|████▊     | 150/313 [02:25<02:37,  1.03it/s, v_num=0, Train/loss_all_step=0.127, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=2.640, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]Epoch 16:  48%|████▊     | 150/313 [02:25<02:37,  1.03it/s, v_num=0, Train/loss_all_step=0.0884, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.0884, Train/loss_recog_step=2.380, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]Epoch 16:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0884, Train/loss_unet_all_step=0.716, Train/loss_triplet_all_step=0.0884, Train/loss_recog_step=2.380, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]Epoch 16:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=2.310, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]  Epoch 16:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=2.310, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]Epoch 16:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.701, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=2.360, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]Epoch 16:  96%|█████████▌| 300/313 [04:38<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.701, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=2.360, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]Epoch 16:  96%|█████████▌| 300/313 [04:38<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=2.430, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]Epoch 16: 100%|██████████| 313/313 [04:47<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.715, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=2.430, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]Epoch 16: 100%|██████████| 313/313 [04:47<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=2.430, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.697, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.143, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.479, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.75it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 16.14it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 11.73it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 15.63it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 14.40it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 12.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175714, 0.175591, 0.183006, 0.176714
Valid average loss UNet                 (all)                : 0.711024

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087793, 0.322119, 1.043285
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.115128, 0.201251, 0.253846
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.149078, 0.443119, 0.543871
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.096166, 0.364811, 0.567715
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.134315, 0.554920, 0.720274
Valid average loss all      (Triplet)                 : 0.123225

== Recognize ==
Valid average loss Recognize     : 2.501123
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.123225

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.920410394668579 sec. =
Valid knn accuracy drums     : 63.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.507111310958862 sec. =
Valid knn accuracy bass      : 20.766129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.596438884735107 sec. =
Valid knn accuracy piano     : 38.28125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.915674448013306 sec. =
Valid knn accuracy guitar    : 42.410714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.273942708969116 sec. =
Valid knn accuracy residuals : 75.22727272727273%

Valid knn accuracy average   : 48.032725382962056%

                                                                      [AEpoch 16: 100%|██████████| 313/313 [05:57<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=2.430, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.125, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=2.250]Epoch 16: 100%|██████████| 313/313 [05:57<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=2.430, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.180022, 0.178852, 0.180778, 0.184068
Train average loss UNet                 (all)                : 0.723720

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.048259, 0.336158, 0.856308
Train average loss bass     (Triplet, dist_p, dist_n) : 0.174738, 0.248056, 0.295660
Train average loss piano    (Triplet, dist_p, dist_n) : 0.145914, 0.370217, 0.470110
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.136644, 0.338793, 0.464433
Train average loss residuals(Triplet, dist_p, dist_n) : 0.099037, 0.468454, 0.689414
Train average loss all      (Triplet)                 : 0.122284

== Recognize ==
Train average loss Recognize     : 2.385176
Train average accuracy drums     : 50.480003 %
Train average accuracy bass      : 49.785000 %
Train average accuracy piano     : 50.384998 %
Train average accuracy guitar    : 50.125004 %
Train average accuracy residuals : 49.514999 %

== Train average loss all : 0.122284

Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=2.430, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]          Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=2.430, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]Epoch 17:  16%|█▌        | 50/313 [00:53<04:43,  0.93it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=2.430, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]Epoch 17:  16%|█▌        | 50/313 [00:53<04:43,  0.93it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=2.320, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]Epoch 17:  32%|███▏      | 100/313 [01:39<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=2.320, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]Epoch 17:  32%|███▏      | 100/313 [01:39<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=2.210, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]Epoch 17:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=2.210, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]Epoch 17:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.0859, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.0859, Train/loss_recog_step=2.550, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]Epoch 17:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0859, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.0859, Train/loss_recog_step=2.550, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]Epoch 17:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=2.760, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]  Epoch 17:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=2.760, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]Epoch 17:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.0935, Train/loss_unet_all_step=0.702, Train/loss_triplet_all_step=0.0935, Train/loss_recog_step=2.430, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]Epoch 17:  96%|█████████▌| 300/313 [04:39<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.0935, Train/loss_unet_all_step=0.702, Train/loss_triplet_all_step=0.0935, Train/loss_recog_step=2.430, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]Epoch 17:  96%|█████████▌| 300/313 [04:39<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=2.540, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]  Epoch 17: 100%|██████████| 313/313 [04:48<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=2.540, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]Epoch 17: 100%|██████████| 313/313 [04:48<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.0908, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.0908, Train/loss_recog_step=2.440, Valid/loss_all_step=0.0614, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.0614, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.123, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.123, Valid/loss_recog_epoch=2.500, Valid/knn_avr=0.480, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.79it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 15.45it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 13.24it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 16.64it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 14.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 14.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175506, 0.175410, 0.182858, 0.173966
Valid average loss UNet                 (all)                : 0.707740

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.071029, 0.341962, 1.004401
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.119859, 0.210277, 0.258422
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.140788, 0.483676, 0.594863
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.106277, 0.393223, 0.568571
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.140163, 0.635624, 0.800860
Valid average loss all      (Triplet)                 : 0.124593

== Recognize ==
Valid average loss Recognize     : 2.613906
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.124593

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.999235391616821 sec. =
Valid knn accuracy drums     : 61.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.427699089050293 sec. =
Valid knn accuracy bass      : 18.14516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.04962420463562 sec. =
Valid knn accuracy piano     : 38.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.616454124450684 sec. =
Valid knn accuracy guitar    : 41.74107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.788891315460205 sec. =
Valid knn accuracy residuals : 70.22727272727273%

Valid knn accuracy average   : 45.97446739358118%

                                                                      [AEpoch 17: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0908, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.0908, Train/loss_recog_step=2.440, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=2.390]Epoch 17: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0908, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.0908, Train/loss_recog_step=2.440, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179892, 0.178735, 0.180671, 0.183718
Train average loss UNet                 (all)                : 0.723016

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.048126, 0.359215, 0.894524
Train average loss bass     (Triplet, dist_p, dist_n) : 0.169328, 0.265675, 0.323439
Train average loss piano    (Triplet, dist_p, dist_n) : 0.137963, 0.389092, 0.503216
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.133769, 0.358536, 0.495244
Train average loss residuals(Triplet, dist_p, dist_n) : 0.095654, 0.495702, 0.732773
Train average loss all      (Triplet)                 : 0.118412

== Recognize ==
Train average loss Recognize     : 2.459209
Train average accuracy drums     : 49.689999 %
Train average accuracy bass      : 50.029999 %
Train average accuracy piano     : 50.340004 %
Train average accuracy guitar    : 50.155003 %
Train average accuracy residuals : 49.764999 %

== Train average loss all : 0.118412

Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0908, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.0908, Train/loss_recog_step=2.440, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]          Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0908, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.0908, Train/loss_recog_step=2.440, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]Epoch 18:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.0908, Train/loss_unet_all_step=0.721, Train/loss_triplet_all_step=0.0908, Train/loss_recog_step=2.440, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]Epoch 18:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=2.540, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]  Epoch 18:  32%|███▏      | 100/313 [01:41<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.712, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=2.540, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]Epoch 18:  32%|███▏      | 100/313 [01:41<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=2.720, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]Epoch 18:  48%|████▊     | 150/313 [02:27<02:40,  1.01it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.730, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=2.720, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]Epoch 18:  48%|████▊     | 150/313 [02:27<02:40,  1.01it/s, v_num=0, Train/loss_all_step=0.0758, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=2.420, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]Epoch 18:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0758, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=2.420, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]Epoch 18:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=2.870, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]  Epoch 18:  80%|███████▉  | 250/313 [03:59<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=2.870, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]Epoch 18:  80%|███████▉  | 250/313 [03:59<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0891, Train/loss_unet_all_step=0.685, Train/loss_triplet_all_step=0.0891, Train/loss_recog_step=2.740, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]Epoch 18:  96%|█████████▌| 300/313 [04:45<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.0891, Train/loss_unet_all_step=0.685, Train/loss_triplet_all_step=0.0891, Train/loss_recog_step=2.740, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]Epoch 18:  96%|█████████▌| 300/313 [04:45<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.699, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=2.650, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]  Epoch 18: 100%|██████████| 313/313 [04:53<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.699, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=2.650, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]Epoch 18: 100%|██████████| 313/313 [04:53<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.0883, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0883, Train/loss_recog_step=2.600, Valid/loss_all_step=0.0711, Valid/loss_unet_all_step=0.669, Valid/loss_triplet_all_step=0.0711, Valid/loss_recog_step=2.920, Valid/loss_all_epoch=0.125, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.125, Valid/loss_recog_epoch=2.610, Valid/knn_avr=0.460, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.49it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 13.21it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.46it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 16.54it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 13.58it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 13.17it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175846, 0.175561, 0.183111, 0.172923
Valid average loss UNet                 (all)                : 0.707441

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.080836, 0.343794, 1.115943
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.110924, 0.228556, 0.297717
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.151186, 0.503730, 0.589169
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.112542, 0.424902, 0.602969
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.145113, 0.639752, 0.870364
Valid average loss all      (Triplet)                 : 0.132593

== Recognize ==
Valid average loss Recognize     : 2.448169
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.132593

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5967116355896 sec. =
Valid knn accuracy drums     : 56.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.971383094787598 sec. =
Valid knn accuracy bass      : 18.14516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.752086400985718 sec. =
Valid knn accuracy piano     : 38.0859375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.622593879699707 sec. =
Valid knn accuracy guitar    : 42.410714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.398066282272339 sec. =
Valid knn accuracy residuals : 70.68181818181817%

Valid knn accuracy average   : 45.25603059939709%

                                                                      [AEpoch 18: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.0883, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0883, Train/loss_recog_step=2.600, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=2.460]Epoch 18: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.0883, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0883, Train/loss_recog_step=2.600, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179878, 0.178723, 0.180664, 0.183612
Train average loss UNet                 (all)                : 0.722877

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.046803, 0.378276, 0.936491
Train average loss bass     (Triplet, dist_p, dist_n) : 0.168795, 0.284070, 0.343257
Train average loss piano    (Triplet, dist_p, dist_n) : 0.134296, 0.416896, 0.540478
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.127164, 0.379696, 0.533305
Train average loss residuals(Triplet, dist_p, dist_n) : 0.091267, 0.542177, 0.799931
Train average loss all      (Triplet)                 : 0.114853

== Recognize ==
Train average loss Recognize     : 2.519835
Train average accuracy drums     : 49.665001 %
Train average accuracy bass      : 50.094997 %
Train average accuracy piano     : 50.389999 %
Train average accuracy guitar    : 50.199997 %
Train average accuracy residuals : 49.595001 %

== Train average loss all : 0.114853

Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0883, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0883, Train/loss_recog_step=2.600, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]          Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0883, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0883, Train/loss_recog_step=2.600, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]Epoch 19:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.0883, Train/loss_unet_all_step=0.726, Train/loss_triplet_all_step=0.0883, Train/loss_recog_step=2.600, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]Epoch 19:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.710, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=2.560, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]  Epoch 19:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.710, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=2.560, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]Epoch 19:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=2.540, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]Epoch 19:  48%|████▊     | 150/313 [02:24<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=2.540, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]Epoch 19:  48%|████▊     | 150/313 [02:24<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.0875, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.0875, Train/loss_recog_step=2.490, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]Epoch 19:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0875, Train/loss_unet_all_step=0.720, Train/loss_triplet_all_step=0.0875, Train/loss_recog_step=2.490, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]Epoch 19:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=2.570, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]  Epoch 19:  80%|███████▉  | 250/313 [03:54<00:59,  1.07it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=2.570, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]Epoch 19:  80%|███████▉  | 250/313 [03:54<00:59,  1.07it/s, v_num=0, Train/loss_all_step=0.083, Train/loss_unet_all_step=0.697, Train/loss_triplet_all_step=0.083, Train/loss_recog_step=2.610, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]Epoch 19:  96%|█████████▌| 300/313 [04:39<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.083, Train/loss_unet_all_step=0.697, Train/loss_triplet_all_step=0.083, Train/loss_recog_step=2.610, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]Epoch 19:  96%|█████████▌| 300/313 [04:39<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=2.630, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]Epoch 19: 100%|██████████| 313/313 [04:48<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=2.630, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]Epoch 19: 100%|██████████| 313/313 [04:48<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.0746, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0746, Train/loss_recog_step=2.600, Valid/loss_all_step=0.0989, Valid/loss_unet_all_step=0.692, Valid/loss_triplet_all_step=0.0989, Valid/loss_recog_step=1.810, Valid/loss_all_epoch=0.133, Valid/loss_unet_all_epoch=0.707, Valid/loss_triplet_all_epoch=0.133, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.453, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 15.61it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 16.48it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 12.50it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 12.24it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 13.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175739, 0.175558, 0.183136, 0.173117
Valid average loss UNet                 (all)                : 0.707550

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.080659, 0.370224, 1.067899
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.119312, 0.258485, 0.318665
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.175773, 0.533359, 0.628061
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.099549, 0.443436, 0.660995
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.153650, 0.662854, 0.860020
Valid average loss all      (Triplet)                 : 0.132084

== Recognize ==
Valid average loss Recognize     : 2.671262
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.132084

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.635094404220581 sec. =
Valid knn accuracy drums     : 60.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.89322280883789 sec. =
Valid knn accuracy bass      : 18.548387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.828907012939453 sec. =
Valid knn accuracy piano     : 37.109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.605966091156006 sec. =
Valid knn accuracy guitar    : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.406851768493652 sec. =
Valid knn accuracy residuals : 73.63636363636363%

Valid knn accuracy average   : 47.095238190105825%

                                                                      [AEpoch 19: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0746, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0746, Train/loss_recog_step=2.600, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.115, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=2.520]Epoch 19: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0746, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0746, Train/loss_recog_step=2.600, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179988, 0.178827, 0.180767, 0.184094
Train average loss UNet                 (all)                : 0.723677

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.045494, 0.391999, 0.952216
Train average loss bass     (Triplet, dist_p, dist_n) : 0.168549, 0.299464, 0.360425
Train average loss piano    (Triplet, dist_p, dist_n) : 0.129013, 0.433551, 0.567787
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.125613, 0.399371, 0.556027
Train average loss residuals(Triplet, dist_p, dist_n) : 0.088489, 0.556827, 0.828880
Train average loss all      (Triplet)                 : 0.112838

== Recognize ==
Train average loss Recognize     : 2.545473
Train average accuracy drums     : 50.089996 %
Train average accuracy bass      : 49.759998 %
Train average accuracy piano     : 50.125004 %
Train average accuracy guitar    : 49.860001 %
Train average accuracy residuals : 50.524998 %

== Train average loss all : 0.112838

Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0746, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0746, Train/loss_recog_step=2.600, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]          Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0746, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0746, Train/loss_recog_step=2.600, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]Epoch 20:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.0746, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0746, Train/loss_recog_step=2.600, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]Epoch 20:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.0975, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.0975, Train/loss_recog_step=2.690, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]Epoch 20:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.0975, Train/loss_unet_all_step=0.718, Train/loss_triplet_all_step=0.0975, Train/loss_recog_step=2.690, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]Epoch 20:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.727, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=2.560, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]  Epoch 20:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.727, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=2.560, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]Epoch 20:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.0746, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.0746, Train/loss_recog_step=2.860, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]Epoch 20:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0746, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.0746, Train/loss_recog_step=2.860, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]Epoch 20:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=2.730, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]  Epoch 20:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=2.730, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]Epoch 20:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.0865, Train/loss_unet_all_step=0.697, Train/loss_triplet_all_step=0.0865, Train/loss_recog_step=2.690, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]Epoch 20:  96%|█████████▌| 300/313 [04:41<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.0865, Train/loss_unet_all_step=0.697, Train/loss_triplet_all_step=0.0865, Train/loss_recog_step=2.690, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]Epoch 20:  96%|█████████▌| 300/313 [04:41<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=2.590, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]  Epoch 20: 100%|██████████| 313/313 [04:50<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=2.590, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]Epoch 20: 100%|██████████| 313/313 [04:50<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.0625, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.0625, Train/loss_recog_step=2.510, Valid/loss_all_step=0.0554, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.0554, Valid/loss_recog_step=3.080, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.471, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.75it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 15.62it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 12.40it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 14.34it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 14.14it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 14.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175216, 0.175014, 0.182731, 0.176542
Valid average loss UNet                 (all)                : 0.709503

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.086542, 0.384368, 1.127313
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.128497, 0.262576, 0.307468
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.201893, 0.610317, 0.674425
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.136717, 0.482710, 0.636335
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.139399, 0.708086, 0.935443
Valid average loss all      (Triplet)                 : 0.143574

== Recognize ==
Valid average loss Recognize     : 2.709886
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.143574

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.605949401855469 sec. =
Valid knn accuracy drums     : 58.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.860995531082153 sec. =
Valid knn accuracy bass      : 19.758064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.679084062576294 sec. =
Valid knn accuracy piano     : 38.4765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.649317264556885 sec. =
Valid knn accuracy guitar    : 40.17857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.465403318405151 sec. =
Valid knn accuracy residuals : 70.9090909090909%

Valid knn accuracy average   : 45.473153522932186%

                                                                      [AEpoch 20: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0625, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.0625, Train/loss_recog_step=2.510, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.113, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=2.550]Epoch 20: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0625, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.0625, Train/loss_recog_step=2.510, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179909, 0.178757, 0.180705, 0.184356
Train average loss UNet                 (all)                : 0.723727

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.043205, 0.409474, 1.003887
Train average loss bass     (Triplet, dist_p, dist_n) : 0.162683, 0.321131, 0.393393
Train average loss piano    (Triplet, dist_p, dist_n) : 0.123494, 0.470993, 0.623856
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.119177, 0.419521, 0.587962
Train average loss residuals(Triplet, dist_p, dist_n) : 0.083419, 0.581218, 0.868847
Train average loss all      (Triplet)                 : 0.107470

== Recognize ==
Train average loss Recognize     : 2.584177
Train average accuracy drums     : 50.050003 %
Train average accuracy bass      : 50.494999 %
Train average accuracy piano     : 50.085003 %
Train average accuracy guitar    : 50.389999 %
Train average accuracy residuals : 50.575001 %

== Train average loss all : 0.107470

Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0625, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.0625, Train/loss_recog_step=2.510, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]          Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0625, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.0625, Train/loss_recog_step=2.510, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]Epoch 21:  16%|█▌        | 50/313 [00:54<04:44,  0.92it/s, v_num=0, Train/loss_all_step=0.0625, Train/loss_unet_all_step=0.717, Train/loss_triplet_all_step=0.0625, Train/loss_recog_step=2.510, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]Epoch 21:  16%|█▌        | 50/313 [00:54<04:44,  0.92it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=2.550, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]  Epoch 21:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.706, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=2.550, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]Epoch 21:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=2.550, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]Epoch 21:  48%|████▊     | 150/313 [02:24<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=2.550, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]Epoch 21:  48%|████▊     | 150/313 [02:24<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.0739, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.0739, Train/loss_recog_step=2.720, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]Epoch 21:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0739, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.0739, Train/loss_recog_step=2.720, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]Epoch 21:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=2.580, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]  Epoch 21:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=2.580, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]Epoch 21:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.088, Train/loss_unet_all_step=0.710, Train/loss_triplet_all_step=0.088, Train/loss_recog_step=2.770, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]Epoch 21:  96%|█████████▌| 300/313 [04:40<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.088, Train/loss_unet_all_step=0.710, Train/loss_triplet_all_step=0.088, Train/loss_recog_step=2.770, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]Epoch 21:  96%|█████████▌| 300/313 [04:40<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.695, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=2.940, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]Epoch 21: 100%|██████████| 313/313 [04:49<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.695, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=2.940, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]Epoch 21: 100%|██████████| 313/313 [04:49<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.0495, Train/loss_unet_all_step=0.689, Train/loss_triplet_all_step=0.0495, Train/loss_recog_step=2.950, Valid/loss_all_step=0.0737, Valid/loss_unet_all_step=0.681, Valid/loss_triplet_all_step=0.0737, Valid/loss_recog_step=2.790, Valid/loss_all_epoch=0.144, Valid/loss_unet_all_epoch=0.710, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=2.710, Valid/knn_avr=0.455, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.72it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 16.68it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 15.40it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00,  9.24it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 14.09it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 14.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.174995, 0.174865, 0.182533, 0.178546
Valid average loss UNet                 (all)                : 0.710940

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083833, 0.498902, 1.229900
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.123351, 0.299857, 0.350536
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.199273, 0.656692, 0.723966
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.124484, 0.517033, 0.709089
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.132746, 0.681038, 1.001058
Valid average loss all      (Triplet)                 : 0.131663

== Recognize ==
Valid average loss Recognize     : 2.681192
Valid average accuracy drums     : 56.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.131663

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.865545988082886 sec. =
Valid knn accuracy drums     : 63.69565217391304%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.50312328338623 sec. =
Valid knn accuracy bass      : 17.338709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.75913691520691 sec. =
Valid knn accuracy piano     : 38.4765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.599736213684082 sec. =
Valid knn accuracy guitar    : 46.205357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.740191459655762 sec. =
Valid knn accuracy residuals : 71.13636363636363%

Valid knn accuracy average   : 47.37052902611064%

                                                                      [AEpoch 21: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0495, Train/loss_unet_all_step=0.689, Train/loss_triplet_all_step=0.0495, Train/loss_recog_step=2.950, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=2.580]Epoch 21: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0495, Train/loss_unet_all_step=0.689, Train/loss_triplet_all_step=0.0495, Train/loss_recog_step=2.950, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179768, 0.178605, 0.180585, 0.184041
Train average loss UNet                 (all)                : 0.722999

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.040869, 0.433404, 1.051332
Train average loss bass     (Triplet, dist_p, dist_n) : 0.157815, 0.348174, 0.430160
Train average loss piano    (Triplet, dist_p, dist_n) : 0.111732, 0.505879, 0.686283
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.110412, 0.454844, 0.650800
Train average loss residuals(Triplet, dist_p, dist_n) : 0.079302, 0.619639, 0.928800
Train average loss all      (Triplet)                 : 0.101313

== Recognize ==
Train average loss Recognize     : 2.688314
Train average accuracy drums     : 50.035000 %
Train average accuracy bass      : 50.225002 %
Train average accuracy piano     : 50.050003 %
Train average accuracy guitar    : 50.384998 %
Train average accuracy residuals : 49.230000 %

== Train average loss all : 0.101313

Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0495, Train/loss_unet_all_step=0.689, Train/loss_triplet_all_step=0.0495, Train/loss_recog_step=2.950, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]          Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0495, Train/loss_unet_all_step=0.689, Train/loss_triplet_all_step=0.0495, Train/loss_recog_step=2.950, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]Epoch 22:  16%|█▌        | 50/313 [00:53<04:40,  0.94it/s, v_num=0, Train/loss_all_step=0.0495, Train/loss_unet_all_step=0.689, Train/loss_triplet_all_step=0.0495, Train/loss_recog_step=2.950, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]Epoch 22:  16%|█▌        | 50/313 [00:53<04:40,  0.94it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=2.880, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]  Epoch 22:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.704, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=2.880, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]Epoch 22:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.0898, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.0898, Train/loss_recog_step=2.660, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]Epoch 22:  48%|████▊     | 150/313 [02:24<02:37,  1.03it/s, v_num=0, Train/loss_all_step=0.0898, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.0898, Train/loss_recog_step=2.660, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]Epoch 22:  48%|████▊     | 150/313 [02:24<02:37,  1.03it/s, v_num=0, Train/loss_all_step=0.070, Train/loss_unet_all_step=0.727, Train/loss_triplet_all_step=0.070, Train/loss_recog_step=2.740, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]  Epoch 22:  64%|██████▍   | 200/313 [03:11<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.070, Train/loss_unet_all_step=0.727, Train/loss_triplet_all_step=0.070, Train/loss_recog_step=2.740, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]Epoch 22:  64%|██████▍   | 200/313 [03:11<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=2.710, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]Epoch 22:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=2.710, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]Epoch 22:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.0891, Train/loss_unet_all_step=0.695, Train/loss_triplet_all_step=0.0891, Train/loss_recog_step=2.580, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]Epoch 22:  96%|█████████▌| 300/313 [04:43<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.0891, Train/loss_unet_all_step=0.695, Train/loss_triplet_all_step=0.0891, Train/loss_recog_step=2.580, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]Epoch 22:  96%|█████████▌| 300/313 [04:43<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=2.560, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]  Epoch 22: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.709, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=2.560, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]Epoch 22: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.0399, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.0399, Train/loss_recog_step=3.070, Valid/loss_all_step=0.0385, Valid/loss_unet_all_step=0.680, Valid/loss_triplet_all_step=0.0385, Valid/loss_recog_step=3.090, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.711, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.67it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 14.78it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 16.04it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 11.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 11.95it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 13.95it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175463, 0.175466, 0.182964, 0.163032
Valid average loss UNet                 (all)                : 0.696925

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.079434, 0.517897, 1.201488
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.143185, 0.333373, 0.372154
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.229946, 0.700286, 0.792068
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.142855, 0.581182, 0.748287
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.145745, 0.757920, 1.007224
Valid average loss all      (Triplet)                 : 0.154512

== Recognize ==
Valid average loss Recognize     : 3.028190
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.154512

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.957464218139648 sec. =
Valid knn accuracy drums     : 63.69565217391304%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.544949293136597 sec. =
Valid knn accuracy bass      : 18.346774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.77581238746643 sec. =
Valid knn accuracy piano     : 37.890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.655449151992798 sec. =
Valid knn accuracy guitar    : 46.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.763545751571655 sec. =
Valid knn accuracy residuals : 70.22727272727273%

Valid knn accuracy average   : 47.40706481894683%

                                                                      [AEpoch 22: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.0399, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.0399, Train/loss_recog_step=3.070, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.101, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.101, Train/loss_recog_epoch=2.690]Epoch 22: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.0399, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.0399, Train/loss_recog_step=3.070, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179828, 0.178659, 0.180638, 0.184810
Train average loss UNet                 (all)                : 0.723935

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.039700, 0.462270, 1.099014
Train average loss bass     (Triplet, dist_p, dist_n) : 0.152268, 0.377551, 0.467903
Train average loss piano    (Triplet, dist_p, dist_n) : 0.108937, 0.544285, 0.736766
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.106240, 0.503053, 0.715294
Train average loss residuals(Triplet, dist_p, dist_n) : 0.074613, 0.651715, 0.977288
Train average loss all      (Triplet)                 : 0.097440

== Recognize ==
Train average loss Recognize     : 2.735267
Train average accuracy drums     : 50.449997 %
Train average accuracy bass      : 50.250000 %
Train average accuracy piano     : 50.305004 %
Train average accuracy guitar    : 49.695000 %
Train average accuracy residuals : 49.570000 %

== Train average loss all : 0.097440

Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0399, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.0399, Train/loss_recog_step=3.070, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]          Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0399, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.0399, Train/loss_recog_step=3.070, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]Epoch 23:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.0399, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.0399, Train/loss_recog_step=3.070, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]Epoch 23:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.0933, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.0933, Train/loss_recog_step=2.620, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]Epoch 23:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.0933, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.0933, Train/loss_recog_step=2.620, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]Epoch 23:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=2.940, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]  Epoch 23:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=2.940, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]Epoch 23:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.708, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=2.740, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]Epoch 23:  64%|██████▍   | 200/313 [03:12<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.708, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=2.740, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]Epoch 23:  64%|██████▍   | 200/313 [03:12<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=3.000, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]Epoch 23:  80%|███████▉  | 250/313 [03:57<00:59,  1.05it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=3.000, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]Epoch 23:  80%|███████▉  | 250/313 [03:57<00:59,  1.05it/s, v_num=0, Train/loss_all_step=0.0976, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.0976, Train/loss_recog_step=2.690, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]Epoch 23:  96%|█████████▌| 300/313 [04:41<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.0976, Train/loss_unet_all_step=0.705, Train/loss_triplet_all_step=0.0976, Train/loss_recog_step=2.690, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]Epoch 23:  96%|█████████▌| 300/313 [04:41<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=2.520, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]  Epoch 23: 100%|██████████| 313/313 [04:50<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.707, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=2.520, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]Epoch 23: 100%|██████████| 313/313 [04:50<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.0497, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.0497, Train/loss_recog_step=2.440, Valid/loss_all_step=0.0922, Valid/loss_unet_all_step=0.632, Valid/loss_triplet_all_step=0.0922, Valid/loss_recog_step=3.690, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.697, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.474, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.75it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 17.05it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 16.29it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 16.21it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 13.87it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 13.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.174991, 0.175038, 0.182496, 0.173007
Valid average loss UNet                 (all)                : 0.705531

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.069587, 0.549712, 1.212521
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.145380, 0.353298, 0.385669
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.220072, 0.701951, 0.767666
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.179932, 0.575241, 0.702324
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.227124, 0.824673, 0.900529
Valid average loss all      (Triplet)                 : 0.168322

== Recognize ==
Valid average loss Recognize     : 2.859181
Valid average accuracy drums     : 42.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.168322

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9039576053619385 sec. =
Valid knn accuracy drums     : 66.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.461604118347168 sec. =
Valid knn accuracy bass      : 21.370967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.80111813545227 sec. =
Valid knn accuracy piano     : 35.7421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.00668215751648 sec. =
Valid knn accuracy guitar    : 39.50892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.480585336685181 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 46.132717157929726%

                                                                      [AEpoch 23: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0497, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.0497, Train/loss_recog_step=2.440, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0974, Train/loss_unet_all_epoch=0.724, Train/loss_triplet_all_epoch=0.0974, Train/loss_recog_epoch=2.740]  Epoch 23: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0497, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.0497, Train/loss_recog_step=2.440, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179668, 0.178518, 0.180482, 0.184463
Train average loss UNet                 (all)                : 0.723130

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.038693, 0.502991, 1.191813
Train average loss bass     (Triplet, dist_p, dist_n) : 0.147533, 0.411191, 0.512438
Train average loss piano    (Triplet, dist_p, dist_n) : 0.098131, 0.581115, 0.798823
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.102554, 0.540135, 0.769564
Train average loss residuals(Triplet, dist_p, dist_n) : 0.071229, 0.697396, 1.047833
Train average loss all      (Triplet)                 : 0.092611

== Recognize ==
Train average loss Recognize     : 2.770579
Train average accuracy drums     : 49.579998 %
Train average accuracy bass      : 50.040001 %
Train average accuracy piano     : 49.875000 %
Train average accuracy guitar    : 49.709999 %
Train average accuracy residuals : 49.990002 %

== Train average loss all : 0.092611

Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0497, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.0497, Train/loss_recog_step=2.440, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]          Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0497, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.0497, Train/loss_recog_step=2.440, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]Epoch 24:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.0497, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.0497, Train/loss_recog_step=2.440, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]Epoch 24:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.095, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.095, Train/loss_recog_step=2.850, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]  Epoch 24:  32%|███▏      | 100/313 [01:38<03:29,  1.02it/s, v_num=0, Train/loss_all_step=0.095, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.095, Train/loss_recog_step=2.850, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]Epoch 24:  32%|███▏      | 100/313 [01:38<03:29,  1.02it/s, v_num=0, Train/loss_all_step=0.099, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.099, Train/loss_recog_step=2.690, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]Epoch 24:  48%|████▊     | 150/313 [02:22<02:34,  1.05it/s, v_num=0, Train/loss_all_step=0.099, Train/loss_unet_all_step=0.732, Train/loss_triplet_all_step=0.099, Train/loss_recog_step=2.690, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]Epoch 24:  48%|████▊     | 150/313 [02:22<02:34,  1.05it/s, v_num=0, Train/loss_all_step=0.0772, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0772, Train/loss_recog_step=2.930, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]Epoch 24:  64%|██████▍   | 200/313 [03:07<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.0772, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0772, Train/loss_recog_step=2.930, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]Epoch 24:  64%|██████▍   | 200/313 [03:07<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=2.770, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]  Epoch 24:  80%|███████▉  | 250/313 [03:52<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=2.770, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]Epoch 24:  80%|███████▉  | 250/313 [03:52<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=2.670, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]Epoch 24:  96%|█████████▌| 300/313 [04:37<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.711, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=2.670, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]Epoch 24:  96%|█████████▌| 300/313 [04:37<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.701, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=2.760, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]Epoch 24: 100%|██████████| 313/313 [04:45<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.701, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=2.760, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]Epoch 24: 100%|██████████| 313/313 [04:45<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=2.890, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.662, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.706, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=2.860, Valid/knn_avr=0.461, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.71it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 10.97it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 10.07it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 12.47it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 14.35it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 14.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.175548, 0.175422, 0.182794, 0.174159
Valid average loss UNet                 (all)                : 0.707923

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101108, 0.621434, 1.213945
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.152158, 0.394418, 0.435786
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.291265, 0.773522, 0.771158
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.183886, 0.623375, 0.736257
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.140371, 0.757288, 1.032884
Valid average loss all      (Triplet)                 : 0.178645

== Recognize ==
Valid average loss Recognize     : 2.887133
Valid average accuracy drums     : 44.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.178645

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.032878875732422 sec. =
Valid knn accuracy drums     : 60.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.564240455627441 sec. =
Valid knn accuracy bass      : 17.943548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.71778154373169 sec. =
Valid knn accuracy piano     : 35.3515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.019903421401978 sec. =
Valid knn accuracy guitar    : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.514934539794922 sec. =
Valid knn accuracy residuals : 72.27272727272728%

Valid knn accuracy average   : 46.176067631964806%

                                                                      [AEpoch 24: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=2.890, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0926, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0926, Train/loss_recog_epoch=2.770]Epoch 24: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=2.890, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179438, 0.178299, 0.180281, 0.184830
Train average loss UNet                 (all)                : 0.722848

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.036668, 0.542102, 1.274558
Train average loss bass     (Triplet, dist_p, dist_n) : 0.141869, 0.463856, 0.582674
Train average loss piano    (Triplet, dist_p, dist_n) : 0.092450, 0.637693, 0.881639
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.095231, 0.570938, 0.820554
Train average loss residuals(Triplet, dist_p, dist_n) : 0.067779, 0.752861, 1.123962
Train average loss all      (Triplet)                 : 0.087635

== Recognize ==
Train average loss Recognize     : 2.825297
Train average accuracy drums     : 49.990002 %
Train average accuracy bass      : 50.050003 %
Train average accuracy piano     : 49.869999 %
Train average accuracy guitar    : 50.085003 %
Train average accuracy residuals : 49.965000 %

== Train average loss all : 0.087635

Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=2.890, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]          Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=2.890, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]Epoch 25:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.731, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=2.890, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]Epoch 25:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.0996, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.0996, Train/loss_recog_step=2.850, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]Epoch 25:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.0996, Train/loss_unet_all_step=0.719, Train/loss_triplet_all_step=0.0996, Train/loss_recog_step=2.850, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]Epoch 25:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.0796, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.0796, Train/loss_recog_step=3.110, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]Epoch 25:  48%|████▊     | 150/313 [02:24<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.0796, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.0796, Train/loss_recog_step=3.110, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]Epoch 25:  48%|████▊     | 150/313 [02:24<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.0843, Train/loss_unet_all_step=0.710, Train/loss_triplet_all_step=0.0843, Train/loss_recog_step=3.190, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]Epoch 25:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0843, Train/loss_unet_all_step=0.710, Train/loss_triplet_all_step=0.0843, Train/loss_recog_step=3.190, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]Epoch 25:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0934, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0934, Train/loss_recog_step=3.070, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]Epoch 25:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.0934, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0934, Train/loss_recog_step=3.070, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]Epoch 25:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.695, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=2.890, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]  Epoch 25:  96%|█████████▌| 300/313 [04:42<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.695, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=2.890, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]Epoch 25:  96%|█████████▌| 300/313 [04:42<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=3.060, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]Epoch 25: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.700, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=3.060, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]Epoch 25: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.0286, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=3.140, Valid/loss_all_step=0.138, Valid/loss_unet_all_step=0.673, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.179, Valid/loss_unet_all_epoch=0.708, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.462, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.60it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 12.23it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 15.76it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 15.88it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 14.33it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 12.02it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.174862, 0.174845, 0.182384, 0.177140
Valid average loss UNet                 (all)                : 0.709231

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061227, 0.613548, 1.262878
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.171037, 0.462154, 0.490125
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.316088, 0.958511, 1.012668
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.194268, 0.752617, 0.888367
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.177610, 0.989376, 1.237509
Valid average loss all      (Triplet)                 : 0.185091

== Recognize ==
Valid average loss Recognize     : 2.933451
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.185091

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6682188510894775 sec. =
Valid knn accuracy drums     : 63.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.489365816116333 sec. =
Valid knn accuracy bass      : 18.951612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.289389371871948 sec. =
Valid knn accuracy piano     : 34.9609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.0904221534729 sec. =
Valid knn accuracy guitar    : 39.732142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.463998556137085 sec. =
Valid knn accuracy residuals : 70.9090909090909%

Valid knn accuracy average   : 45.56293074693539%

                                                                      [AEpoch 25: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0286, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=3.140, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0876, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0876, Train/loss_recog_epoch=2.830]Epoch 25: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0286, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=3.140, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179468, 0.178324, 0.180308, 0.184498
Train average loss UNet                 (all)                : 0.722599

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.033460, 0.591989, 1.361019
Train average loss bass     (Triplet, dist_p, dist_n) : 0.134913, 0.510289, 0.644247
Train average loss piano    (Triplet, dist_p, dist_n) : 0.086326, 0.698042, 0.970191
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.088449, 0.634731, 0.913128
Train average loss residuals(Triplet, dist_p, dist_n) : 0.058998, 0.827417, 1.236971
Train average loss all      (Triplet)                 : 0.081430

== Recognize ==
Train average loss Recognize     : 2.943850
Train average accuracy drums     : 50.129997 %
Train average accuracy bass      : 50.330002 %
Train average accuracy piano     : 49.915001 %
Train average accuracy guitar    : 49.625000 %
Train average accuracy residuals : 50.075001 %

== Train average loss all : 0.081430

Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0286, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=3.140, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]          Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0286, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=3.140, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]Epoch 26:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.0286, Train/loss_unet_all_step=0.713, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=3.140, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]Epoch 26:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.0755, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.0755, Train/loss_recog_step=2.960, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]Epoch 26:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0755, Train/loss_unet_all_step=0.723, Train/loss_triplet_all_step=0.0755, Train/loss_recog_step=2.960, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]Epoch 26:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0891, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0891, Train/loss_recog_step=3.040, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]Epoch 26:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.0891, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0891, Train/loss_recog_step=3.040, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]Epoch 26:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.0718, Train/loss_unet_all_step=0.725, Train/loss_triplet_all_step=0.0718, Train/loss_recog_step=3.110, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]Epoch 26:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0718, Train/loss_unet_all_step=0.725, Train/loss_triplet_all_step=0.0718, Train/loss_recog_step=3.110, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]Epoch 26:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0958, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0958, Train/loss_recog_step=2.880, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]Epoch 26:  80%|███████▉  | 250/313 [04:00<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0958, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0958, Train/loss_recog_step=2.880, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]Epoch 26:  80%|███████▉  | 250/313 [04:00<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0954, Train/loss_unet_all_step=0.693, Train/loss_triplet_all_step=0.0954, Train/loss_recog_step=3.050, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]Epoch 26:  96%|█████████▌| 300/313 [04:47<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0954, Train/loss_unet_all_step=0.693, Train/loss_triplet_all_step=0.0954, Train/loss_recog_step=3.050, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]Epoch 26:  96%|█████████▌| 300/313 [04:47<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0939, Train/loss_unet_all_step=0.710, Train/loss_triplet_all_step=0.0939, Train/loss_recog_step=3.010, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]Epoch 26: 100%|██████████| 313/313 [04:55<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.0939, Train/loss_unet_all_step=0.710, Train/loss_triplet_all_step=0.0939, Train/loss_recog_step=3.010, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]Epoch 26: 100%|██████████| 313/313 [04:55<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.0325, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.0325, Train/loss_recog_step=3.400, Valid/loss_all_step=0.114, Valid/loss_unet_all_step=0.675, Valid/loss_triplet_all_step=0.114, Valid/loss_recog_step=2.810, Valid/loss_all_epoch=0.185, Valid/loss_unet_all_epoch=0.709, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.456, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:00<00:00, 16.59it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:00<00:00, 12.61it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:00<00:00, 13.03it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:00<00:00, 12.09it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:00<00:00, 14.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.174624, 0.174792, 0.182163, 0.173128
Valid average loss UNet                 (all)                : 0.704707

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070544, 0.712783, 1.399095
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.161750, 0.528710, 0.599034
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.309088, 1.070239, 1.085042
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.214547, 0.849818, 0.953093
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.289250, 1.092504, 1.152558
Valid average loss all      (Triplet)                 : 0.210300

== Recognize ==
Valid average loss Recognize     : 2.895823
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.210300

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6652398109436035 sec. =
Valid knn accuracy drums     : 57.608695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.5514817237854 sec. =
Valid knn accuracy bass      : 17.943548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.783153295516968 sec. =
Valid knn accuracy piano     : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.10813283920288 sec. =
Valid knn accuracy guitar    : 40.401785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.526972055435181 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 44.19080595071128%

                                                                      [AEpoch 26: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.0325, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.0325, Train/loss_recog_step=3.400, Valid/loss_all_step=0.212, Valid/loss_unet_all_step=0.667, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0814, Train/loss_unet_all_epoch=0.723, Train/loss_triplet_all_epoch=0.0814, Train/loss_recog_epoch=2.940]Epoch 26: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.0325, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.0325, Train/loss_recog_step=3.400, Valid/loss_all_step=0.212, Valid/loss_unet_all_step=0.667, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0767, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.0767, Train/loss_recog_epoch=3.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.179564, 0.178421, 0.180379, 0.184003
Train average loss UNet                 (all)                : 0.722366

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.033483, 0.635699, 1.419970
Train average loss bass     (Triplet, dist_p, dist_n) : 0.127507, 0.560331, 0.711749
Train average loss piano    (Triplet, dist_p, dist_n) : 0.083447, 0.751535, 1.045570
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.079648, 0.675655, 0.982885
Train average loss residuals(Triplet, dist_p, dist_n) : 0.055365, 0.887944, 1.334218
Train average loss all      (Triplet)                 : 0.076749

== Recognize ==
Train average loss Recognize     : 3.018661
Train average accuracy drums     : 49.739998 %
Train average accuracy bass      : 49.845001 %
Train average accuracy piano     : 49.634998 %
Train average accuracy guitar    : 50.024998 %
Train average accuracy residuals : 49.544998 %

== Train average loss all : 0.076749

Epoch 26: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.0325, Train/loss_unet_all_step=0.714, Train/loss_triplet_all_step=0.0325, Train/loss_recog_step=3.400, Valid/loss_all_step=0.212, Valid/loss_unet_all_step=0.667, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.210, Valid/loss_unet_all_epoch=0.705, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.442, Train/loss_all_epoch=0.0767, Train/loss_unet_all_epoch=0.722, Train/loss_triplet_all_epoch=0.0767, Train/loss_recog_epoch=3.020]
[2023-11-05 07:23:20,726][source.train][INFO] - [rank: 0] Starting testing!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
The length of seg for train is 3s.
The length of seg for valid and test is 3s.
----------------------------------------
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s][2023-11-05 07:23:26,508][utils.utils][ERROR] - [rank: 0] 
Traceback (most recent call last):
  File "/nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/utils/utils.py", line 68, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/source/train.py", line 102, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 755, in test
    return call._call_and_handle_interrupt(
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 795, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 990, in _run
    results = self._run_stage()
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1029, in _run_stage
    return self._evaluation_loop.run()
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/loops/utilities.py", line 181, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 134, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 391, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 416, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
  File "/nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/model/triplet/triplet.py", line 458, in test_step
    sound = istft(cases_x[idx], self.cfg, phase[idx], param[idx,0], param[idx,1])
IndexError: too many indices for tensor of dimension 1
[2023-11-05 07:23:26,514][utils.utils][INFO] - [rank: 0] Output dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023-11-05/04-40-06
Testing DataLoader 0:   0%|          | 0/16 [00:01<?, ?it/s]
