
=== Using cuda(utils.func). ===


=== Using cuda(utils.logger). ===

[2023-11-03 08:19:59,793][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 08:19:59,801][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 100                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 20                                                       
│         batch_test: 64                                                        
│         num_workers: 2                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         train_dirname: 3s_on1.5                                               
│         test_dirname: 3s_on1.5                                                
│         load_using_librosa: true                                              
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_train: 3                                                      
│         seconds_test: 3                                                       
│         sr: 44100                                                             
│         mel: false                                                            
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 0.001                                                             
│         monitor_es: Valid/loss_all                                            
│         monitor_mode_es: min                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640                         
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│       cfg:                                                                    
│         n_epoch: 100                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 20                                                       
│         batch_test: 64                                                        
│         num_workers: 2                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         train_dirname: 3s_on1.5                                               
│         test_dirname: 3s_on1.5                                                
│         load_using_librosa: true                                              
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_train: 3                                                      
│         seconds_test: 3                                                       
│         sr: 44100                                                             
│         mel: false                                                            
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 0.001                                                             
│         monitor_es: Valid/loss_all                                            
│         monitor_mode_es: min                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/loss_all                                               
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: 1                                                         
│         mode: min                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/loss_all                                               
│         min_delta: 0.0                                                        
│         patience: 10                                                          
│         verbose: true                                                         
│         mode: min                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 100                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 100                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 20                                                         
│       batch_test: 64                                                          
│       num_workers: 2                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       train_dirname: 3s_on1.5                                                 
│       test_dirname: 3s_on1.5                                                  
│       load_using_librosa: true                                                
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_train: 3                                                        
│       seconds_test: 3                                                         
│       sr: 44100                                                               
│       mel: false                                                              
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640                             
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       lr: 0.001                                                               
│       monitor_es: Valid/loss_all                                              
│       monitor_mode_es: min                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 0                                                            
│       recog_rate: 0                                                           
│       test_psd_mine: false                                                    
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── /home/imamura23/nas02home/outputs/2023-10-29/18-45-05/checkpoints/epoch_
└── seed
    └── None                                                                    
[2023-11-03 08:19:59,882][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-03 08:19:59,895][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-03 08:20:01,382][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpznkzb9yg
[2023-11-03 08:20:01,382][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpznkzb9yg/_remote_module_non_scriptable.py
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=10880, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-03 08:20:01,475][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-03 08:20:01,475][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 08:20:01,479][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 08:20:01,481][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 08:20:01,482][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-03 08:20:01,482][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-03 08:20:01,530][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-03 08:20:02,030][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-03 08:20:02,283][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
The length of seg for train is 3s.
The length of seg for valid and test is 3s.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.5692586898803711 sec. *
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:04<00:00,  0.43it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 1: 100%|██████████| 2/2 [00:00<00:00,  2.87it/s]Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 2: 100%|██████████| 2/2 [00:00<00:00,  2.91it/s]Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 3: 100%|██████████| 2/2 [00:00<00:00,  2.56it/s]Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 4: 100%|██████████| 2/2 [00:00<00:00,  3.51it/s]Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 5:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 5: 100%|██████████| 2/2 [00:00<00:00,  2.79it/s]

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.081837, 0.081783, 0.081486, 0.050628
Valid average loss UNet                 (all)                : 0.295734

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.160017, 0.140253, 0.190814
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.207794, 0.184290, 0.176496
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.139280, 0.272901, 0.341317
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.179440, 0.249681, 0.270241
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.207207, 0.276249, 0.269042
Valid average loss all      (Triplet)                 : 0.182526

== Recognize ==
Valid average loss Recognize     : 0.949304
Valid average accuracy drums     : 53.125000 %
Valid average accuracy bass      : 48.437500 %
Valid average accuracy piano     : 54.687500 %
Valid average accuracy guitar    : 40.625000 %
Valid average accuracy residuals : 48.437500 %

== Valid average loss all : 0.182526

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 7.393624305725098 sec. =
Valid knn accuracy drums     : 50.78125%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 5.272411584854126 sec. =
Valid knn accuracy bass      : 46.875%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.642360210418701 sec. =
Valid knn accuracy piano     : 55.46875%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.866624116897583 sec. =
Valid knn accuracy guitar    : 69.53125%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.6029341220855713 sec. =
Valid knn accuracy residuals : 90.625%

Valid knn accuracy average   : 62.65625%
                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/1000 [00:00<?, ?it/s]Epoch 7:   0%|          | 0/1000 [00:00<?, ?it/s] Epoch 7:   5%|▌         | 50/1000 [02:56<56:00,  0.28it/s]Epoch 7:   5%|▌         | 50/1000 [02:56<56:00,  0.28it/s, v_num=0, Train/loss_all_step=0.657, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.657, Train/loss_recog_step=1.460]Epoch 7:  10%|█         | 100/1000 [05:40<51:07,  0.29it/s, v_num=0, Train/loss_all_step=0.657, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.657, Train/loss_recog_step=1.460]Epoch 7:  10%|█         | 100/1000 [05:40<51:07,  0.29it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=0.967]Epoch 7:  15%|█▌        | 150/1000 [08:42<49:18,  0.29it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=0.967]Epoch 7:  15%|█▌        | 150/1000 [08:42<49:18,  0.29it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.228, Train/loss_recog_step=0.888]Epoch 7:  20%|██        | 200/1000 [11:44<46:56,  0.28it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.228, Train/loss_recog_step=0.888]Epoch 7:  20%|██        | 200/1000 [11:44<46:56,  0.28it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.323, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.010]Epoch 7:  25%|██▌       | 250/1000 [14:45<44:16,  0.28it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.323, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.010]Epoch 7:  25%|██▌       | 250/1000 [14:45<44:16,  0.28it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.204, Train/loss_recog_step=1.250]Epoch 7:  30%|███       | 300/1000 [17:49<41:34,  0.28it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.204, Train/loss_recog_step=1.250]Epoch 7:  30%|███       | 300/1000 [17:49<41:34,  0.28it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.966]Epoch 7:  35%|███▌      | 350/1000 [20:52<38:45,  0.28it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.966]Epoch 7:  35%|███▌      | 350/1000 [20:52<38:45,  0.28it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=1.150]Epoch 7:  40%|████      | 400/1000 [23:52<35:48,  0.28it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=1.150]Epoch 7:  40%|████      | 400/1000 [23:52<35:48,  0.28it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.020]Epoch 7:  45%|████▌     | 450/1000 [26:53<32:52,  0.28it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.328, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.020]Epoch 7:  45%|████▌     | 450/1000 [26:53<32:52,  0.28it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=1.140]Epoch 7:  50%|█████     | 500/1000 [29:55<29:55,  0.28it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=1.140]Epoch 7:  50%|█████     | 500/1000 [29:55<29:55,  0.28it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.215, Train/loss_recog_step=1.000]Epoch 7:  55%|█████▌    | 550/1000 [32:50<26:52,  0.28it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.215, Train/loss_recog_step=1.000]Epoch 7:  55%|█████▌    | 550/1000 [32:50<26:52,  0.28it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=1.070]Epoch 7:  60%|██████    | 600/1000 [35:36<23:44,  0.28it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=1.070]Epoch 7:  60%|██████    | 600/1000 [35:36<23:44,  0.28it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=1.050]Epoch 7:  65%|██████▌   | 650/1000 [38:15<20:36,  0.28it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=1.050]Epoch 7:  65%|██████▌   | 650/1000 [38:15<20:36,  0.28it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.912]Epoch 7:  70%|███████   | 700/1000 [41:02<17:35,  0.28it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.912]Epoch 7:  70%|███████   | 700/1000 [41:02<17:35,  0.28it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=0.785]Epoch 7:  75%|███████▌  | 750/1000 [43:55<14:38,  0.28it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=0.785]Epoch 7:  75%|███████▌  | 750/1000 [43:55<14:38,  0.28it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.935]Epoch 7:  80%|████████  | 800/1000 [46:51<11:42,  0.28it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.935]Epoch 7:  80%|████████  | 800/1000 [46:51<11:42,  0.28it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.241, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.876]Epoch 7:  85%|████████▌ | 850/1000 [49:46<08:47,  0.28it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.241, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.876]Epoch 7:  85%|████████▌ | 850/1000 [49:46<08:47,  0.28it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.070]Epoch 7:  90%|█████████ | 900/1000 [52:41<05:51,  0.28it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.070]Epoch 7:  90%|█████████ | 900/1000 [52:41<05:51,  0.28it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=1.170]Epoch 7:  95%|█████████▌| 950/1000 [55:35<02:55,  0.28it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=1.170]Epoch 7:  95%|█████████▌| 950/1000 [55:35<02:55,  0.28it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=0.870]Epoch 7: 100%|██████████| 1000/1000 [58:24<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=0.870]Epoch 7: 100%|██████████| 1000/1000 [58:24<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.278, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.020]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:20<00:00,  0.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.53it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.52it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078672, 0.085241, 0.084107, 0.053761
Valid average loss UNet                 (all)                : 0.301781

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.076343, 0.336095, 0.619474
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.149137, 0.191734, 0.192597
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.202128, 0.377388, 0.392452
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.130041, 0.336558, 0.467227
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.219284, 0.528878, 0.562401
Valid average loss all      (Triplet)                 : 0.161971

== Recognize ==
Valid average loss Recognize     : 0.974861
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.161971

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.613277673721313 sec. =
Valid knn accuracy drums     : 67.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.006917476654053 sec. =
Valid knn accuracy bass      : 27.21774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.116530656814575 sec. =
Valid knn accuracy piano     : 33.59375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.821646690368652 sec. =
Valid knn accuracy guitar    : 57.58928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.211775541305542 sec. =
Valid knn accuracy residuals : 74.54545454545455%

Valid knn accuracy average   : 52.11098556947962%

                                                                      [AEpoch 7: 100%|██████████| 1000/1000 [1:01:51<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.278, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.020, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521]Epoch 7: 100%|██████████| 1000/1000 [1:01:51<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.278, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.020, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082306, 0.082210, 0.082472, 0.065466
Train average loss UNet                 (all)                : 0.312454

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.156822, 0.491208, 0.641719
Train average loss bass     (Triplet, dist_p, dist_n) : 0.254693, 0.487818, 0.466335
Train average loss piano    (Triplet, dist_p, dist_n) : 0.230358, 0.548610, 0.563062
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.219828, 0.526538, 0.544162
Train average loss residuals(Triplet, dist_p, dist_n) : 0.182710, 0.584064, 0.686687
Train average loss all      (Triplet)                 : 0.211234

== Recognize ==
Train average loss Recognize     : 0.996622
Train average accuracy drums     : 49.349998 %
Train average accuracy bass      : 50.040001 %
Train average accuracy piano     : 49.845001 %
Train average accuracy guitar    : 49.625000 %
Train average accuracy residuals : 49.439999 %

== Train average loss all : 0.211234

Epoch 7:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.278, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.020, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]             Epoch 8:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.278, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.020, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:   5%|▌         | 50/1000 [03:00<57:07,  0.28it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.278, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.020, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:   5%|▌         | 50/1000 [03:00<57:07,  0.28it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.080, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  10%|█         | 100/1000 [05:51<52:46,  0.28it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.080, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  10%|█         | 100/1000 [05:51<52:46,  0.28it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=0.937, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  15%|█▌        | 150/1000 [08:38<49:00,  0.29it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=0.937, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  15%|█▌        | 150/1000 [08:38<49:00,  0.29it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.040, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  20%|██        | 200/1000 [11:24<45:39,  0.29it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.040, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  20%|██        | 200/1000 [11:24<45:39,  0.29it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=1.010, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  25%|██▌       | 250/1000 [14:20<43:02,  0.29it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=1.010, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  25%|██▌       | 250/1000 [14:20<43:02,  0.29it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.060, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  30%|███       | 300/1000 [17:12<40:10,  0.29it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.060, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  30%|███       | 300/1000 [17:12<40:10,  0.29it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.930, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  35%|███▌      | 350/1000 [20:09<37:25,  0.29it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.930, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  35%|███▌      | 350/1000 [20:09<37:25,  0.29it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.900, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  40%|████      | 400/1000 [23:05<34:38,  0.29it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.900, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  40%|████      | 400/1000 [23:05<34:38,  0.29it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.887, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  45%|████▌     | 450/1000 [26:00<31:47,  0.29it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.887, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  45%|████▌     | 450/1000 [26:00<31:47,  0.29it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.060, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  50%|█████     | 500/1000 [28:56<28:56,  0.29it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.060, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  50%|█████     | 500/1000 [28:56<28:56,  0.29it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=1.020, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  55%|█████▌    | 550/1000 [31:51<26:03,  0.29it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=1.020, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  55%|█████▌    | 550/1000 [31:51<26:03,  0.29it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.925, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  60%|██████    | 600/1000 [34:48<23:12,  0.29it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.925, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  60%|██████    | 600/1000 [34:48<23:12,  0.29it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.010, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  65%|██████▌   | 650/1000 [37:36<20:14,  0.29it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.010, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  65%|██████▌   | 650/1000 [37:36<20:14,  0.29it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.080, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  70%|███████   | 700/1000 [40:20<17:17,  0.29it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.080, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  70%|███████   | 700/1000 [40:20<17:17,  0.29it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.264, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=0.941, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  75%|███████▌  | 750/1000 [43:07<14:22,  0.29it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.264, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=0.941, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  75%|███████▌  | 750/1000 [43:07<14:22,  0.29it/s, v_num=0, Train/loss_all_step=0.0965, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.0965, Train/loss_recog_step=1.070, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  80%|████████  | 800/1000 [45:55<11:28,  0.29it/s, v_num=0, Train/loss_all_step=0.0965, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.0965, Train/loss_recog_step=1.070, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  80%|████████  | 800/1000 [45:55<11:28,  0.29it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.250, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.100, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]  Epoch 8:  85%|████████▌ | 850/1000 [48:52<08:37,  0.29it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.250, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.100, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  85%|████████▌ | 850/1000 [48:52<08:37,  0.29it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=1.080, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  90%|█████████ | 900/1000 [51:48<05:45,  0.29it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=1.080, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  90%|█████████ | 900/1000 [51:48<05:45,  0.29it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.985, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  95%|█████████▌| 950/1000 [54:46<02:52,  0.29it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.985, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8:  95%|█████████▌| 950/1000 [54:46<02:52,  0.29it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.040, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8: 100%|██████████| 1000/1000 [57:43<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.040, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8: 100%|██████████| 1000/1000 [57:43<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.924, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.941, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.521, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.55it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.53it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078589, 0.085078, 0.084073, 0.054416
Valid average loss UNet                 (all)                : 0.302156

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061247, 0.380986, 0.721858
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.144595, 0.288017, 0.296684
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.227675, 0.510949, 0.501689
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.129976, 0.452702, 0.622800
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.246186, 0.706242, 0.713041
Valid average loss all      (Triplet)                 : 0.169561

== Recognize ==
Valid average loss Recognize     : 0.996318
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 54.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.169561

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.34656023979187 sec. =
Valid knn accuracy drums     : 74.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.18493938446045 sec. =
Valid knn accuracy bass      : 30.040322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.318633794784546 sec. =
Valid knn accuracy piano     : 40.4296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.139665126800537 sec. =
Valid knn accuracy guitar    : 57.58928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.393049001693726 sec. =
Valid knn accuracy residuals : 74.54545454545455%

Valid knn accuracy average   : 55.43399354633796%

                                                                      [AEpoch 8: 100%|██████████| 1000/1000 [1:01:11<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.924, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.211, Train/loss_recog_epoch=0.997]Epoch 8: 100%|██████████| 1000/1000 [1:01:11<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.924, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082247, 0.082147, 0.082399, 0.065635
Train average loss UNet                 (all)                : 0.312428

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.076445, 0.341708, 0.621448
Train average loss bass     (Triplet, dist_p, dist_n) : 0.201861, 0.349110, 0.351915
Train average loss piano    (Triplet, dist_p, dist_n) : 0.173969, 0.407947, 0.457476
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.156783, 0.408816, 0.491631
Train average loss residuals(Triplet, dist_p, dist_n) : 0.125600, 0.466474, 0.618919
Train average loss all      (Triplet)                 : 0.148536

== Recognize ==
Train average loss Recognize     : 0.984589
Train average accuracy drums     : 50.535000 %
Train average accuracy bass      : 49.720001 %
Train average accuracy piano     : 49.849998 %
Train average accuracy guitar    : 49.744999 %
Train average accuracy residuals : 50.075001 %

== Train average loss all : 0.148536

Epoch 8:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.924, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]             Epoch 9:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.924, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:   5%|▌         | 50/1000 [03:00<57:14,  0.28it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.924, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:   5%|▌         | 50/1000 [03:00<57:14,  0.28it/s, v_num=0, Train/loss_all_step=0.0988, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.0988, Train/loss_recog_step=1.090, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  10%|█         | 100/1000 [05:58<53:44,  0.28it/s, v_num=0, Train/loss_all_step=0.0988, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.0988, Train/loss_recog_step=1.090, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  10%|█         | 100/1000 [05:58<53:44,  0.28it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.991, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]  Epoch 9:  15%|█▌        | 150/1000 [08:56<50:39,  0.28it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.991, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  15%|█▌        | 150/1000 [08:56<50:39,  0.28it/s, v_num=0, Train/loss_all_step=0.0731, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.0731, Train/loss_recog_step=1.090, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  20%|██        | 200/1000 [11:48<47:15,  0.28it/s, v_num=0, Train/loss_all_step=0.0731, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.0731, Train/loss_recog_step=1.090, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  20%|██        | 200/1000 [11:48<47:15,  0.28it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=0.955, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]  Epoch 9:  25%|██▌       | 250/1000 [14:36<43:48,  0.29it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=0.955, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  25%|██▌       | 250/1000 [14:36<43:48,  0.29it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.180, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  30%|███       | 300/1000 [17:21<40:29,  0.29it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.180, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  30%|███       | 300/1000 [17:21<40:29,  0.29it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.934, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  35%|███▌      | 350/1000 [20:15<37:37,  0.29it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.934, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  35%|███▌      | 350/1000 [20:15<37:37,  0.29it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=0.848, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  40%|████      | 400/1000 [23:10<34:46,  0.29it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=0.848, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  40%|████      | 400/1000 [23:10<34:46,  0.29it/s, v_num=0, Train/loss_all_step=0.0874, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.0874, Train/loss_recog_step=0.973, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  45%|████▌     | 450/1000 [26:06<31:54,  0.29it/s, v_num=0, Train/loss_all_step=0.0874, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.0874, Train/loss_recog_step=0.973, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  45%|████▌     | 450/1000 [26:06<31:54,  0.29it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.010, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]  Epoch 9:  50%|█████     | 500/1000 [29:02<29:02,  0.29it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.010, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  50%|█████     | 500/1000 [29:02<29:02,  0.29it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.180, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  55%|█████▌    | 550/1000 [31:58<26:09,  0.29it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.180, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  55%|█████▌    | 550/1000 [31:58<26:09,  0.29it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=1.160, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  60%|██████    | 600/1000 [34:55<23:17,  0.29it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=1.160, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  60%|██████    | 600/1000 [34:55<23:17,  0.29it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.080, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  65%|██████▌   | 650/1000 [37:47<20:20,  0.29it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.080, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  65%|██████▌   | 650/1000 [37:47<20:20,  0.29it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=1.090, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  70%|███████   | 700/1000 [40:43<17:27,  0.29it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=1.090, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  70%|███████   | 700/1000 [40:43<17:27,  0.29it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.266, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=1.010, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  75%|███████▌  | 750/1000 [43:38<14:32,  0.29it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.266, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=1.010, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  75%|███████▌  | 750/1000 [43:38<14:32,  0.29it/s, v_num=0, Train/loss_all_step=0.0469, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.0469, Train/loss_recog_step=1.110, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  80%|████████  | 800/1000 [46:26<11:36,  0.29it/s, v_num=0, Train/loss_all_step=0.0469, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.0469, Train/loss_recog_step=1.110, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  80%|████████  | 800/1000 [46:26<11:36,  0.29it/s, v_num=0, Train/loss_all_step=0.0979, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.0979, Train/loss_recog_step=1.100, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  85%|████████▌ | 850/1000 [49:11<08:40,  0.29it/s, v_num=0, Train/loss_all_step=0.0979, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.0979, Train/loss_recog_step=1.100, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  85%|████████▌ | 850/1000 [49:11<08:40,  0.29it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=1.150, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]  Epoch 9:  90%|█████████ | 900/1000 [51:57<05:46,  0.29it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=1.150, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  90%|█████████ | 900/1000 [51:57<05:46,  0.29it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.070, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  95%|█████████▌| 950/1000 [54:54<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.070, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9:  95%|█████████▌| 950/1000 [54:54<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.308, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=1.010, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9: 100%|██████████| 1000/1000 [57:49<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.308, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=1.010, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9: 100%|██████████| 1000/1000 [57:49<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.130, Valid/loss_all_step=0.180, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.180, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.554, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:21<00:00,  0.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.56it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.49it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:12<00:00,  0.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078523, 0.084982, 0.084001, 0.051173
Valid average loss UNet                 (all)                : 0.298679

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.084520, 0.537302, 0.809478
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.154676, 0.392019, 0.396354
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.182781, 0.631230, 0.680357
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.110967, 0.558675, 0.739044
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.240623, 0.767632, 0.783446
Valid average loss all      (Triplet)                 : 0.153718

== Recognize ==
Valid average loss Recognize     : 1.192121
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.153718

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.008666753768921 sec. =
Valid knn accuracy drums     : 78.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.289223432540894 sec. =
Valid knn accuracy bass      : 32.25806451612903%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.273582696914673 sec. =
Valid knn accuracy piano     : 39.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.565749406814575 sec. =
Valid knn accuracy guitar    : 54.91071428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.736961841583252 sec. =
Valid knn accuracy residuals : 75.22727272727273%

Valid knn accuracy average   : 56.06107171886669%

                                                                      [AEpoch 9: 100%|██████████| 1000/1000 [1:01:14<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.130, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.149, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.985]Epoch 9: 100%|██████████| 1000/1000 [1:01:14<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.130, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082229, 0.082125, 0.082377, 0.065928
Train average loss UNet                 (all)                : 0.312659

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.053945, 0.426402, 0.809395
Train average loss bass     (Triplet, dist_p, dist_n) : 0.185319, 0.467641, 0.496720
Train average loss piano    (Triplet, dist_p, dist_n) : 0.148898, 0.528238, 0.626674
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.135091, 0.520681, 0.656298
Train average loss residuals(Triplet, dist_p, dist_n) : 0.105309, 0.582045, 0.791242
Train average loss all      (Triplet)                 : 0.126592

== Recognize ==
Train average loss Recognize     : 1.041786
Train average accuracy drums     : 50.370003 %
Train average accuracy bass      : 49.955002 %
Train average accuracy piano     : 50.300003 %
Train average accuracy guitar    : 49.649998 %
Train average accuracy residuals : 50.524998 %

== Train average loss all : 0.126592

Epoch 9:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.130, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]             Epoch 10:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.130, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:   5%|▌         | 50/1000 [03:00<57:05,  0.28it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.280, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.130, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:   5%|▌         | 50/1000 [03:00<57:05,  0.28it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.170, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  10%|█         | 100/1000 [05:56<53:26,  0.28it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.170, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  10%|█         | 100/1000 [05:56<53:26,  0.28it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.976, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  15%|█▌        | 150/1000 [08:53<50:21,  0.28it/s, v_num=0, Train/loss_all_step=0.112, Train/loss_unet_all_step=0.360, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.976, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  15%|█▌        | 150/1000 [08:53<50:21,  0.28it/s, v_num=0, Train/loss_all_step=0.0485, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.0485, Train/loss_recog_step=1.260, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  20%|██        | 200/1000 [11:48<47:15,  0.28it/s, v_num=0, Train/loss_all_step=0.0485, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.0485, Train/loss_recog_step=1.260, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  20%|██        | 200/1000 [11:48<47:15,  0.28it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=1.080, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]  Epoch 10:  25%|██▌       | 250/1000 [14:45<44:15,  0.28it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=1.080, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  25%|██▌       | 250/1000 [14:45<44:15,  0.28it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.110, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  30%|███       | 300/1000 [17:37<41:07,  0.28it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.110, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  30%|███       | 300/1000 [17:37<41:07,  0.28it/s, v_num=0, Train/loss_all_step=0.0925, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.0925, Train/loss_recog_step=1.140, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  35%|███▌      | 350/1000 [20:23<37:51,  0.29it/s, v_num=0, Train/loss_all_step=0.0925, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.0925, Train/loss_recog_step=1.140, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  35%|███▌      | 350/1000 [20:23<37:51,  0.29it/s, v_num=0, Train/loss_all_step=0.0962, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.0962, Train/loss_recog_step=1.210, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  40%|████      | 400/1000 [23:09<34:44,  0.29it/s, v_num=0, Train/loss_all_step=0.0962, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.0962, Train/loss_recog_step=1.210, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  40%|████      | 400/1000 [23:09<34:44,  0.29it/s, v_num=0, Train/loss_all_step=0.0965, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.0965, Train/loss_recog_step=1.000, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  45%|████▌     | 450/1000 [26:00<31:47,  0.29it/s, v_num=0, Train/loss_all_step=0.0965, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.0965, Train/loss_recog_step=1.000, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  45%|████▌     | 450/1000 [26:00<31:47,  0.29it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.0656, Train/loss_recog_step=0.987, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  50%|█████     | 500/1000 [28:57<28:57,  0.29it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.0656, Train/loss_recog_step=0.987, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  50%|█████     | 500/1000 [28:57<28:57,  0.29it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.210, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]  Epoch 10:  55%|█████▌    | 550/1000 [31:53<26:05,  0.29it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.210, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  55%|█████▌    | 550/1000 [31:53<26:05,  0.29it/s, v_num=0, Train/loss_all_step=0.0807, Train/loss_unet_all_step=0.308, Train/loss_triplet_all_step=0.0807, Train/loss_recog_step=1.270, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  60%|██████    | 600/1000 [34:49<23:12,  0.29it/s, v_num=0, Train/loss_all_step=0.0807, Train/loss_unet_all_step=0.308, Train/loss_triplet_all_step=0.0807, Train/loss_recog_step=1.270, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  60%|██████    | 600/1000 [34:49<23:12,  0.29it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=1.290, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]  Epoch 10:  65%|██████▌   | 650/1000 [37:38<20:15,  0.29it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=1.290, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  65%|██████▌   | 650/1000 [37:38<20:15,  0.29it/s, v_num=0, Train/loss_all_step=0.0945, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.0945, Train/loss_recog_step=1.150, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  70%|███████   | 700/1000 [40:31<17:22,  0.29it/s, v_num=0, Train/loss_all_step=0.0945, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.0945, Train/loss_recog_step=1.150, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  70%|███████   | 700/1000 [40:31<17:22,  0.29it/s, v_num=0, Train/loss_all_step=0.0725, Train/loss_unet_all_step=0.268, Train/loss_triplet_all_step=0.0725, Train/loss_recog_step=1.180, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  75%|███████▌  | 750/1000 [43:29<14:29,  0.29it/s, v_num=0, Train/loss_all_step=0.0725, Train/loss_unet_all_step=0.268, Train/loss_triplet_all_step=0.0725, Train/loss_recog_step=1.180, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  75%|███████▌  | 750/1000 [43:29<14:29,  0.29it/s, v_num=0, Train/loss_all_step=0.0482, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.0482, Train/loss_recog_step=1.080, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  80%|████████  | 800/1000 [46:24<11:36,  0.29it/s, v_num=0, Train/loss_all_step=0.0482, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.0482, Train/loss_recog_step=1.080, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  80%|████████  | 800/1000 [46:24<11:36,  0.29it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.248, Train/loss_triplet_all_step=0.0706, Train/loss_recog_step=1.070, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  85%|████████▌ | 850/1000 [49:19<08:42,  0.29it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.248, Train/loss_triplet_all_step=0.0706, Train/loss_recog_step=1.070, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  85%|████████▌ | 850/1000 [49:19<08:42,  0.29it/s, v_num=0, Train/loss_all_step=0.0863, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.0863, Train/loss_recog_step=1.030, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  90%|█████████ | 900/1000 [52:13<05:48,  0.29it/s, v_num=0, Train/loss_all_step=0.0863, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.0863, Train/loss_recog_step=1.030, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  90%|█████████ | 900/1000 [52:13<05:48,  0.29it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.250, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]  Epoch 10:  95%|█████████▌| 950/1000 [55:00<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.250, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10:  95%|█████████▌| 950/1000 [55:00<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.0747, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.0747, Train/loss_recog_step=1.200, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10: 100%|██████████| 1000/1000 [57:45<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0747, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.0747, Train/loss_recog_step=1.200, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10: 100%|██████████| 1000/1000 [57:45<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.320, Valid/loss_all_step=0.146, Valid/loss_unet_all_step=0.291, Valid/loss_triplet_all_step=0.146, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.561, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.55it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:15<00:00,  0.52it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.47it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078737, 0.085192, 0.084225, 0.058052
Valid average loss UNet                 (all)                : 0.306205

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067754, 0.664257, 0.981566
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.145118, 0.514609, 0.547853
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.213807, 0.832710, 0.880772
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.112637, 0.764008, 0.957010
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.296468, 0.901297, 0.873841
Valid average loss all      (Triplet)                 : 0.166989

== Recognize ==
Valid average loss Recognize     : 1.239385
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 56.000000 %
Valid average accuracy piano     : 42.000000 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.166989

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.931857824325562 sec. =
Valid knn accuracy drums     : 74.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.136014938354492 sec. =
Valid knn accuracy bass      : 23.588709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.15701174736023 sec. =
Valid knn accuracy piano     : 46.2890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.337504386901855 sec. =
Valid knn accuracy guitar    : 57.14285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.362638473510742 sec. =
Valid knn accuracy residuals : 76.5909090909091%

Valid knn accuracy average   : 55.63535116049799%

                                                                      [AEpoch 10: 100%|██████████| 1000/1000 [1:01:12<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.320, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.127, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.127, Train/loss_recog_epoch=1.040]Epoch 10: 100%|██████████| 1000/1000 [1:01:12<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.320, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082225, 0.082124, 0.082380, 0.064974
Train average loss UNet                 (all)                : 0.311702

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.038323, 0.562974, 1.053392
Train average loss bass     (Triplet, dist_p, dist_n) : 0.163279, 0.610073, 0.676610
Train average loss piano    (Triplet, dist_p, dist_n) : 0.124040, 0.689736, 0.847192
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.111281, 0.676691, 0.874015
Train average loss residuals(Triplet, dist_p, dist_n) : 0.084198, 0.737351, 1.010679
Train average loss all      (Triplet)                 : 0.105601

== Recognize ==
Train average loss Recognize     : 1.108492
Train average accuracy drums     : 50.255001 %
Train average accuracy bass      : 50.190002 %
Train average accuracy piano     : 50.024998 %
Train average accuracy guitar    : 49.685001 %
Train average accuracy residuals : 49.399998 %

== Train average loss all : 0.105601

Epoch 10:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.320, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]             Epoch 11:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.320, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:   5%|▌         | 50/1000 [02:58<56:26,  0.28it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.320, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:   5%|▌         | 50/1000 [02:58<56:26,  0.28it/s, v_num=0, Train/loss_all_step=0.0943, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.0943, Train/loss_recog_step=0.981, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  10%|█         | 100/1000 [05:55<53:16,  0.28it/s, v_num=0, Train/loss_all_step=0.0943, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.0943, Train/loss_recog_step=0.981, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  10%|█         | 100/1000 [05:55<53:16,  0.28it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.935, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]  Epoch 11:  15%|█▌        | 150/1000 [08:49<50:02,  0.28it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.935, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  15%|█▌        | 150/1000 [08:49<50:02,  0.28it/s, v_num=0, Train/loss_all_step=0.083, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.083, Train/loss_recog_step=1.210, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  20%|██        | 200/1000 [11:44<46:58,  0.28it/s, v_num=0, Train/loss_all_step=0.083, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.083, Train/loss_recog_step=1.210, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  20%|██        | 200/1000 [11:44<46:58,  0.28it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=1.080, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  25%|██▌       | 250/1000 [14:41<44:05,  0.28it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=1.080, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  25%|██▌       | 250/1000 [14:41<44:05,  0.28it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.110, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  30%|███       | 300/1000 [17:38<41:10,  0.28it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.110, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  30%|███       | 300/1000 [17:38<41:10,  0.28it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.0771, Train/loss_recog_step=1.170, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  35%|███▌      | 350/1000 [20:35<38:15,  0.28it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.0771, Train/loss_recog_step=1.170, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  35%|███▌      | 350/1000 [20:35<38:15,  0.28it/s, v_num=0, Train/loss_all_step=0.0879, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.0879, Train/loss_recog_step=1.220, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  40%|████      | 400/1000 [23:30<35:15,  0.28it/s, v_num=0, Train/loss_all_step=0.0879, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.0879, Train/loss_recog_step=1.220, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  40%|████      | 400/1000 [23:30<35:15,  0.28it/s, v_num=0, Train/loss_all_step=0.086, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.086, Train/loss_recog_step=1.090, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]  Epoch 11:  45%|████▌     | 450/1000 [26:18<32:08,  0.29it/s, v_num=0, Train/loss_all_step=0.086, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.086, Train/loss_recog_step=1.090, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  45%|████▌     | 450/1000 [26:18<32:08,  0.29it/s, v_num=0, Train/loss_all_step=0.0657, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.0657, Train/loss_recog_step=1.100, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  50%|█████     | 500/1000 [29:03<29:03,  0.29it/s, v_num=0, Train/loss_all_step=0.0657, Train/loss_unet_all_step=0.281, Train/loss_triplet_all_step=0.0657, Train/loss_recog_step=1.100, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  50%|█████     | 500/1000 [29:03<29:03,  0.29it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.120, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]  Epoch 11:  55%|█████▌    | 550/1000 [31:50<26:03,  0.29it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.120, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  55%|█████▌    | 550/1000 [31:50<26:03,  0.29it/s, v_num=0, Train/loss_all_step=0.0906, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.0906, Train/loss_recog_step=1.230, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  60%|██████    | 600/1000 [34:47<23:11,  0.29it/s, v_num=0, Train/loss_all_step=0.0906, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.0906, Train/loss_recog_step=1.230, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  60%|██████    | 600/1000 [34:47<23:11,  0.29it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.0573, Train/loss_recog_step=1.050, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  65%|██████▌   | 650/1000 [37:36<20:14,  0.29it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.0573, Train/loss_recog_step=1.050, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  65%|██████▌   | 650/1000 [37:36<20:14,  0.29it/s, v_num=0, Train/loss_all_step=0.0763, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.0763, Train/loss_recog_step=1.210, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  70%|███████   | 700/1000 [40:29<17:21,  0.29it/s, v_num=0, Train/loss_all_step=0.0763, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.0763, Train/loss_recog_step=1.210, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  70%|███████   | 700/1000 [40:29<17:21,  0.29it/s, v_num=0, Train/loss_all_step=0.059, Train/loss_unet_all_step=0.271, Train/loss_triplet_all_step=0.059, Train/loss_recog_step=1.300, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]  Epoch 11:  75%|███████▌  | 750/1000 [43:26<14:28,  0.29it/s, v_num=0, Train/loss_all_step=0.059, Train/loss_unet_all_step=0.271, Train/loss_triplet_all_step=0.059, Train/loss_recog_step=1.300, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  75%|███████▌  | 750/1000 [43:26<14:28,  0.29it/s, v_num=0, Train/loss_all_step=0.0411, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.0411, Train/loss_recog_step=1.270, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  80%|████████  | 800/1000 [46:19<11:34,  0.29it/s, v_num=0, Train/loss_all_step=0.0411, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.0411, Train/loss_recog_step=1.270, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  80%|████████  | 800/1000 [46:19<11:34,  0.29it/s, v_num=0, Train/loss_all_step=0.0712, Train/loss_unet_all_step=0.253, Train/loss_triplet_all_step=0.0712, Train/loss_recog_step=1.360, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  85%|████████▌ | 850/1000 [49:15<08:41,  0.29it/s, v_num=0, Train/loss_all_step=0.0712, Train/loss_unet_all_step=0.253, Train/loss_triplet_all_step=0.0712, Train/loss_recog_step=1.360, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  85%|████████▌ | 850/1000 [49:15<08:41,  0.29it/s, v_num=0, Train/loss_all_step=0.0788, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.0788, Train/loss_recog_step=1.150, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  90%|█████████ | 900/1000 [52:11<05:47,  0.29it/s, v_num=0, Train/loss_all_step=0.0788, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.0788, Train/loss_recog_step=1.150, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  90%|█████████ | 900/1000 [52:11<05:47,  0.29it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.390, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]  Epoch 11:  95%|█████████▌| 950/1000 [55:04<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.390, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11:  95%|█████████▌| 950/1000 [55:04<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.0596, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.0596, Train/loss_recog_step=1.230, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11: 100%|██████████| 1000/1000 [57:55<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0596, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.0596, Train/loss_recog_step=1.230, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11: 100%|██████████| 1000/1000 [57:55<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0855, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0855, Train/loss_recog_step=1.350, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.315, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.306, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.556, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:13<00:00,  0.59it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:13<00:00,  0.57it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.57it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:13<00:00,  0.52it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078562, 0.085001, 0.084035, 0.050053
Valid average loss UNet                 (all)                : 0.297651

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.055995, 0.840365, 1.292647
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.131403, 0.641735, 0.687972
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.221331, 1.082878, 1.157510
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.126514, 0.925439, 1.090264
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.215390, 1.119601, 1.192222
Valid average loss all      (Triplet)                 : 0.148718

== Recognize ==
Valid average loss Recognize     : 1.357238
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.148718

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.678863048553467 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.37166428565979 sec. =
Valid knn accuracy bass      : 22.782258064516128%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.691451787948608 sec. =
Valid knn accuracy piano     : 45.8984375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.74293565750122 sec. =
Valid knn accuracy guitar    : 58.48214285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.41618037223816 sec. =
Valid knn accuracy residuals : 80.22727272727272%

Valid knn accuracy average   : 57.99976136022112%

                                                                      [AEpoch 11: 100%|██████████| 1000/1000 [1:01:13<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0855, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0855, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.106, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=1.110]Epoch 11: 100%|██████████| 1000/1000 [1:01:13<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0855, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0855, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082224, 0.082123, 0.082375, 0.065343
Train average loss UNet                 (all)                : 0.312065

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.027902, 0.728113, 1.342347
Train average loss bass     (Triplet, dist_p, dist_n) : 0.139263, 0.779995, 0.895382
Train average loss piano    (Triplet, dist_p, dist_n) : 0.098956, 0.868004, 1.095741
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.091074, 0.845247, 1.106335
Train average loss residuals(Triplet, dist_p, dist_n) : 0.067540, 0.922719, 1.273453
Train average loss all      (Triplet)                 : 0.086673

== Recognize ==
Train average loss Recognize     : 1.167985
Train average accuracy drums     : 50.054996 %
Train average accuracy bass      : 50.424999 %
Train average accuracy piano     : 49.340000 %
Train average accuracy guitar    : 50.274998 %
Train average accuracy residuals : 49.965000 %

== Train average loss all : 0.086673

Epoch 11:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0855, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0855, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]             Epoch 12:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0855, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0855, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:   5%|▌         | 50/1000 [02:51<54:09,  0.29it/s, v_num=0, Train/loss_all_step=0.0855, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0855, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:   5%|▌         | 50/1000 [02:51<54:09,  0.29it/s, v_num=0, Train/loss_all_step=0.068, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.068, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]  Epoch 12:  10%|█         | 100/1000 [05:42<51:25,  0.29it/s, v_num=0, Train/loss_all_step=0.068, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.068, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  10%|█         | 100/1000 [05:42<51:25,  0.29it/s, v_num=0, Train/loss_all_step=0.085, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.085, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  15%|█▌        | 150/1000 [08:40<49:08,  0.29it/s, v_num=0, Train/loss_all_step=0.085, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.085, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  15%|█▌        | 150/1000 [08:40<49:08,  0.29it/s, v_num=0, Train/loss_all_step=0.0576, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.0576, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  20%|██        | 200/1000 [11:35<46:23,  0.29it/s, v_num=0, Train/loss_all_step=0.0576, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.0576, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  20%|██        | 200/1000 [11:35<46:23,  0.29it/s, v_num=0, Train/loss_all_step=0.0748, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.0748, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  25%|██▌       | 250/1000 [14:32<43:37,  0.29it/s, v_num=0, Train/loss_all_step=0.0748, Train/loss_unet_all_step=0.312, Train/loss_triplet_all_step=0.0748, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  25%|██▌       | 250/1000 [14:32<43:37,  0.29it/s, v_num=0, Train/loss_all_step=0.0979, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.0979, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  30%|███       | 300/1000 [17:30<40:50,  0.29it/s, v_num=0, Train/loss_all_step=0.0979, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.0979, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  30%|███       | 300/1000 [17:30<40:50,  0.29it/s, v_num=0, Train/loss_all_step=0.0323, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0323, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  35%|███▌      | 350/1000 [20:26<37:57,  0.29it/s, v_num=0, Train/loss_all_step=0.0323, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0323, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  35%|███▌      | 350/1000 [20:26<37:57,  0.29it/s, v_num=0, Train/loss_all_step=0.0624, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.0624, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  40%|████      | 400/1000 [23:20<35:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0624, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.0624, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  40%|████      | 400/1000 [23:20<35:00,  0.29it/s, v_num=0, Train/loss_all_step=0.069, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.069, Train/loss_recog_step=0.983, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]  Epoch 12:  45%|████▌     | 450/1000 [26:16<32:06,  0.29it/s, v_num=0, Train/loss_all_step=0.069, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.069, Train/loss_recog_step=0.983, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  45%|████▌     | 450/1000 [26:16<32:06,  0.29it/s, v_num=0, Train/loss_all_step=0.0326, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.0326, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  50%|█████     | 500/1000 [29:14<29:14,  0.28it/s, v_num=0, Train/loss_all_step=0.0326, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.0326, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  50%|█████     | 500/1000 [29:14<29:14,  0.28it/s, v_num=0, Train/loss_all_step=0.0958, Train/loss_unet_all_step=0.316, Train/loss_triplet_all_step=0.0958, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  55%|█████▌    | 550/1000 [32:03<26:13,  0.29it/s, v_num=0, Train/loss_all_step=0.0958, Train/loss_unet_all_step=0.316, Train/loss_triplet_all_step=0.0958, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  55%|█████▌    | 550/1000 [32:03<26:13,  0.29it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.308, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]  Epoch 12:  60%|██████    | 600/1000 [34:48<23:12,  0.29it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.308, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  60%|██████    | 600/1000 [34:48<23:12,  0.29it/s, v_num=0, Train/loss_all_step=0.0557, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.0557, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  65%|██████▌   | 650/1000 [37:29<20:11,  0.29it/s, v_num=0, Train/loss_all_step=0.0557, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.0557, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  65%|██████▌   | 650/1000 [37:29<20:11,  0.29it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]  Epoch 12:  70%|███████   | 700/1000 [40:18<17:16,  0.29it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  70%|███████   | 700/1000 [40:18<17:16,  0.29it/s, v_num=0, Train/loss_all_step=0.0277, Train/loss_unet_all_step=0.268, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  75%|███████▌  | 750/1000 [43:14<14:24,  0.29it/s, v_num=0, Train/loss_all_step=0.0277, Train/loss_unet_all_step=0.268, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  75%|███████▌  | 750/1000 [43:14<14:24,  0.29it/s, v_num=0, Train/loss_all_step=0.0547, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.0547, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  80%|████████  | 800/1000 [46:08<11:32,  0.29it/s, v_num=0, Train/loss_all_step=0.0547, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.0547, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  80%|████████  | 800/1000 [46:08<11:32,  0.29it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.255, Train/loss_triplet_all_step=0.0618, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  85%|████████▌ | 850/1000 [49:00<08:38,  0.29it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.255, Train/loss_triplet_all_step=0.0618, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  85%|████████▌ | 850/1000 [49:00<08:38,  0.29it/s, v_num=0, Train/loss_all_step=0.0616, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.0616, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  90%|█████████ | 900/1000 [51:54<05:46,  0.29it/s, v_num=0, Train/loss_all_step=0.0616, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.0616, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  90%|█████████ | 900/1000 [51:54<05:46,  0.29it/s, v_num=0, Train/loss_all_step=0.0694, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.0694, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  95%|█████████▌| 950/1000 [54:48<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.0694, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.0694, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12:  95%|█████████▌| 950/1000 [54:48<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.064, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.064, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]  Epoch 12: 100%|██████████| 1000/1000 [57:41<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.064, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.064, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12: 100%|██████████| 1000/1000 [57:41<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0819, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.0819, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0992, Valid/loss_unet_all_step=0.290, Valid/loss_triplet_all_step=0.0992, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:20<00:00,  0.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.55it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.49it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078545, 0.084996, 0.084032, 0.051984
Valid average loss UNet                 (all)                : 0.299556

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062086, 1.192974, 1.820787
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.155550, 0.908650, 0.957038
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.230131, 1.374926, 1.499734
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.168832, 1.302809, 1.476444
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.268573, 1.436975, 1.490312
Valid average loss all      (Triplet)                 : 0.171762

== Recognize ==
Valid average loss Recognize     : 1.167288
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 57.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 43.000000 %

== Valid average loss all : 0.171762

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.472851991653442 sec. =
Valid knn accuracy drums     : 74.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.491807222366333 sec. =
Valid knn accuracy bass      : 25.201612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.307037353515625 sec. =
Valid knn accuracy piano     : 41.40625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.14480972290039 sec. =
Valid knn accuracy guitar    : 53.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.410207986831665 sec. =
Valid knn accuracy residuals : 79.77272727272727%

Valid knn accuracy average   : 54.946925488606766%

                                                                      [AEpoch 12: 100%|██████████| 1000/1000 [1:01:09<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0819, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.0819, Train/loss_recog_step=1.130, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0867, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0867, Train/loss_recog_epoch=1.170]Epoch 12: 100%|██████████| 1000/1000 [1:01:09<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0819, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.0819, Train/loss_recog_step=1.130, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082208, 0.082101, 0.082355, 0.065328
Train average loss UNet                 (all)                : 0.311993

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.018820, 0.956927, 1.722085
Train average loss bass     (Triplet, dist_p, dist_n) : 0.114760, 0.993838, 1.172120
Train average loss piano    (Triplet, dist_p, dist_n) : 0.077216, 1.093216, 1.401176
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.070923, 1.074034, 1.417195
Train average loss residuals(Triplet, dist_p, dist_n) : 0.050220, 1.156142, 1.597497
Train average loss all      (Triplet)                 : 0.067995

== Recognize ==
Train average loss Recognize     : 1.222829
Train average accuracy drums     : 50.344997 %
Train average accuracy bass      : 49.904999 %
Train average accuracy piano     : 49.775002 %
Train average accuracy guitar    : 49.654999 %
Train average accuracy residuals : 50.204998 %

== Train average loss all : 0.067995

Epoch 12:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0819, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.0819, Train/loss_recog_step=1.130, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]             Epoch 13:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0819, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.0819, Train/loss_recog_step=1.130, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:   5%|▌         | 50/1000 [02:58<56:29,  0.28it/s, v_num=0, Train/loss_all_step=0.0819, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.0819, Train/loss_recog_step=1.130, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:   5%|▌         | 50/1000 [02:58<56:29,  0.28it/s, v_num=0, Train/loss_all_step=0.074, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.074, Train/loss_recog_step=1.160, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]  Epoch 13:  10%|█         | 100/1000 [05:44<51:43,  0.29it/s, v_num=0, Train/loss_all_step=0.074, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.074, Train/loss_recog_step=1.160, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  10%|█         | 100/1000 [05:44<51:43,  0.29it/s, v_num=0, Train/loss_all_step=0.0539, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.0539, Train/loss_recog_step=1.130, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  15%|█▌        | 150/1000 [08:32<48:23,  0.29it/s, v_num=0, Train/loss_all_step=0.0539, Train/loss_unet_all_step=0.351, Train/loss_triplet_all_step=0.0539, Train/loss_recog_step=1.130, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  15%|█▌        | 150/1000 [08:32<48:23,  0.29it/s, v_num=0, Train/loss_all_step=0.020, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.020, Train/loss_recog_step=1.360, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]  Epoch 13:  20%|██        | 200/1000 [11:22<45:30,  0.29it/s, v_num=0, Train/loss_all_step=0.020, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.020, Train/loss_recog_step=1.360, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  20%|██        | 200/1000 [11:22<45:30,  0.29it/s, v_num=0, Train/loss_all_step=0.0502, Train/loss_unet_all_step=0.319, Train/loss_triplet_all_step=0.0502, Train/loss_recog_step=1.400, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  25%|██▌       | 250/1000 [14:18<42:54,  0.29it/s, v_num=0, Train/loss_all_step=0.0502, Train/loss_unet_all_step=0.319, Train/loss_triplet_all_step=0.0502, Train/loss_recog_step=1.400, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  25%|██▌       | 250/1000 [14:18<42:54,  0.29it/s, v_num=0, Train/loss_all_step=0.0408, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.0408, Train/loss_recog_step=1.270, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  30%|███       | 300/1000 [17:14<40:14,  0.29it/s, v_num=0, Train/loss_all_step=0.0408, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.0408, Train/loss_recog_step=1.270, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  30%|███       | 300/1000 [17:14<40:14,  0.29it/s, v_num=0, Train/loss_all_step=0.0544, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.0544, Train/loss_recog_step=1.320, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  35%|███▌      | 350/1000 [20:10<37:28,  0.29it/s, v_num=0, Train/loss_all_step=0.0544, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.0544, Train/loss_recog_step=1.320, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  35%|███▌      | 350/1000 [20:10<37:28,  0.29it/s, v_num=0, Train/loss_all_step=0.0497, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.0497, Train/loss_recog_step=1.210, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  40%|████      | 400/1000 [23:07<34:41,  0.29it/s, v_num=0, Train/loss_all_step=0.0497, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.0497, Train/loss_recog_step=1.210, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  40%|████      | 400/1000 [23:07<34:41,  0.29it/s, v_num=0, Train/loss_all_step=0.0997, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.0997, Train/loss_recog_step=1.180, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  45%|████▌     | 450/1000 [26:03<31:50,  0.29it/s, v_num=0, Train/loss_all_step=0.0997, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.0997, Train/loss_recog_step=1.180, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  45%|████▌     | 450/1000 [26:03<31:50,  0.29it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=1.060, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  50%|█████     | 500/1000 [29:00<29:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.296, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=1.060, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  50%|█████     | 500/1000 [29:00<29:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0793, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.0793, Train/loss_recog_step=1.290, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  55%|█████▌    | 550/1000 [31:56<26:07,  0.29it/s, v_num=0, Train/loss_all_step=0.0793, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.0793, Train/loss_recog_step=1.290, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  55%|█████▌    | 550/1000 [31:56<26:07,  0.29it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.0663, Train/loss_recog_step=1.120, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  60%|██████    | 600/1000 [34:53<23:15,  0.29it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.0663, Train/loss_recog_step=1.120, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  60%|██████    | 600/1000 [34:53<23:15,  0.29it/s, v_num=0, Train/loss_all_step=0.0371, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.0371, Train/loss_recog_step=1.190, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  65%|██████▌   | 650/1000 [37:38<20:16,  0.29it/s, v_num=0, Train/loss_all_step=0.0371, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.0371, Train/loss_recog_step=1.190, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  65%|██████▌   | 650/1000 [37:38<20:16,  0.29it/s, v_num=0, Train/loss_all_step=0.0395, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.0395, Train/loss_recog_step=1.400, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  70%|███████   | 700/1000 [40:21<17:17,  0.29it/s, v_num=0, Train/loss_all_step=0.0395, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.0395, Train/loss_recog_step=1.400, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  70%|███████   | 700/1000 [40:21<17:17,  0.29it/s, v_num=0, Train/loss_all_step=0.00876, Train/loss_unet_all_step=0.264, Train/loss_triplet_all_step=0.00876, Train/loss_recog_step=1.200, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  75%|███████▌  | 750/1000 [43:09<14:23,  0.29it/s, v_num=0, Train/loss_all_step=0.00876, Train/loss_unet_all_step=0.264, Train/loss_triplet_all_step=0.00876, Train/loss_recog_step=1.200, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  75%|███████▌  | 750/1000 [43:09<14:23,  0.29it/s, v_num=0, Train/loss_all_step=0.0441, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.0441, Train/loss_recog_step=1.290, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]  Epoch 13:  80%|████████  | 800/1000 [46:01<11:30,  0.29it/s, v_num=0, Train/loss_all_step=0.0441, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.0441, Train/loss_recog_step=1.290, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  80%|████████  | 800/1000 [46:01<11:30,  0.29it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.244, Train/loss_triplet_all_step=0.0268, Train/loss_recog_step=1.350, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  85%|████████▌ | 850/1000 [48:57<08:38,  0.29it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.244, Train/loss_triplet_all_step=0.0268, Train/loss_recog_step=1.350, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  85%|████████▌ | 850/1000 [48:57<08:38,  0.29it/s, v_num=0, Train/loss_all_step=0.0507, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0507, Train/loss_recog_step=1.130, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  90%|█████████ | 900/1000 [51:55<05:46,  0.29it/s, v_num=0, Train/loss_all_step=0.0507, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0507, Train/loss_recog_step=1.130, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  90%|█████████ | 900/1000 [51:55<05:46,  0.29it/s, v_num=0, Train/loss_all_step=0.067, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.067, Train/loss_recog_step=1.370, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]  Epoch 13:  95%|█████████▌| 950/1000 [54:53<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.067, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.067, Train/loss_recog_step=1.370, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13:  95%|█████████▌| 950/1000 [54:53<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.0412, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.0412, Train/loss_recog_step=0.948, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13: 100%|██████████| 1000/1000 [57:48<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0412, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.0412, Train/loss_recog_step=0.948, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13: 100%|██████████| 1000/1000 [57:48<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.0583, Train/loss_recog_step=1.160, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.300, Valid/loss_triplet_all_step=0.121, Valid/loss_recog_step=0.835, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.300, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.549, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:20<00:00,  0.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.56it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.55it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.53it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.47it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078511, 0.084935, 0.083937, 0.055259
Valid average loss UNet                 (all)                : 0.302642

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.068155, 1.440776, 2.162322
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.177328, 1.073545, 1.139436
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.257974, 1.694094, 1.813952
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.161056, 1.469191, 1.746114
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.276111, 1.695438, 1.803031
Valid average loss all      (Triplet)                 : 0.192920

== Recognize ==
Valid average loss Recognize     : 1.229173
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.192920

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.908464670181274 sec. =
Valid knn accuracy drums     : 81.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.421520948410034 sec. =
Valid knn accuracy bass      : 27.21774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.682818174362183 sec. =
Valid knn accuracy piano     : 43.9453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.750060558319092 sec. =
Valid knn accuracy guitar    : 53.34821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.448462009429932 sec. =
Valid knn accuracy residuals : 77.95454545454545%

Valid knn accuracy average   : 56.840988922105254%

                                                                      [AEpoch 13: 100%|██████████| 1000/1000 [1:01:18<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.0583, Train/loss_recog_step=1.160, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.068, Train/loss_recog_epoch=1.220]Epoch 13: 100%|██████████| 1000/1000 [1:01:18<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.0583, Train/loss_recog_step=1.160, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082204, 0.082100, 0.082353, 0.065156
Train average loss UNet                 (all)                : 0.311813

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.016190, 1.187001, 2.113638
Train average loss bass     (Triplet, dist_p, dist_n) : 0.098149, 1.221723, 1.459243
Train average loss piano    (Triplet, dist_p, dist_n) : 0.062209, 1.329859, 1.720650
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.055412, 1.314736, 1.748481
Train average loss residuals(Triplet, dist_p, dist_n) : 0.038872, 1.391637, 1.931856
Train average loss all      (Triplet)                 : 0.055435

== Recognize ==
Train average loss Recognize     : 1.241531
Train average accuracy drums     : 49.865002 %
Train average accuracy bass      : 49.759998 %
Train average accuracy piano     : 50.110001 %
Train average accuracy guitar    : 49.805000 %
Train average accuracy residuals : 50.225002 %

== Train average loss all : 0.055435

Epoch 13:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.0583, Train/loss_recog_step=1.160, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]             Epoch 14:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.0583, Train/loss_recog_step=1.160, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:   5%|▌         | 50/1000 [03:02<57:54,  0.27it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.0583, Train/loss_recog_step=1.160, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:   5%|▌         | 50/1000 [03:02<57:54,  0.27it/s, v_num=0, Train/loss_all_step=0.0438, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.0438, Train/loss_recog_step=1.390, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  10%|█         | 100/1000 [06:00<54:02,  0.28it/s, v_num=0, Train/loss_all_step=0.0438, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.0438, Train/loss_recog_step=1.390, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  10%|█         | 100/1000 [06:00<54:02,  0.28it/s, v_num=0, Train/loss_all_step=0.0665, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.0665, Train/loss_recog_step=1.220, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  15%|█▌        | 150/1000 [08:54<50:31,  0.28it/s, v_num=0, Train/loss_all_step=0.0665, Train/loss_unet_all_step=0.346, Train/loss_triplet_all_step=0.0665, Train/loss_recog_step=1.220, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  15%|█▌        | 150/1000 [08:54<50:31,  0.28it/s, v_num=0, Train/loss_all_step=0.0422, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.0422, Train/loss_recog_step=1.350, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  20%|██        | 200/1000 [11:45<47:02,  0.28it/s, v_num=0, Train/loss_all_step=0.0422, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.0422, Train/loss_recog_step=1.350, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  20%|██        | 200/1000 [11:45<47:02,  0.28it/s, v_num=0, Train/loss_all_step=0.0423, Train/loss_unet_all_step=0.316, Train/loss_triplet_all_step=0.0423, Train/loss_recog_step=1.440, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  25%|██▌       | 250/1000 [14:34<43:43,  0.29it/s, v_num=0, Train/loss_all_step=0.0423, Train/loss_unet_all_step=0.316, Train/loss_triplet_all_step=0.0423, Train/loss_recog_step=1.440, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  25%|██▌       | 250/1000 [14:34<43:43,  0.29it/s, v_num=0, Train/loss_all_step=0.0809, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.0809, Train/loss_recog_step=1.170, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  30%|███       | 300/1000 [17:23<40:35,  0.29it/s, v_num=0, Train/loss_all_step=0.0809, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.0809, Train/loss_recog_step=1.170, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  30%|███       | 300/1000 [17:23<40:35,  0.29it/s, v_num=0, Train/loss_all_step=0.0669, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.0669, Train/loss_recog_step=1.140, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  35%|███▌      | 350/1000 [20:21<37:47,  0.29it/s, v_num=0, Train/loss_all_step=0.0669, Train/loss_unet_all_step=0.288, Train/loss_triplet_all_step=0.0669, Train/loss_recog_step=1.140, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  35%|███▌      | 350/1000 [20:21<37:47,  0.29it/s, v_num=0, Train/loss_all_step=0.0272, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.0272, Train/loss_recog_step=1.460, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  40%|████      | 400/1000 [23:18<34:57,  0.29it/s, v_num=0, Train/loss_all_step=0.0272, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.0272, Train/loss_recog_step=1.460, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  40%|████      | 400/1000 [23:18<34:57,  0.29it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.0586, Train/loss_recog_step=1.140, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  45%|████▌     | 450/1000 [26:14<32:04,  0.29it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.0586, Train/loss_recog_step=1.140, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  45%|████▌     | 450/1000 [26:14<32:04,  0.29it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=1.330, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  50%|█████     | 500/1000 [29:11<29:11,  0.29it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=1.330, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  50%|█████     | 500/1000 [29:11<29:11,  0.29it/s, v_num=0, Train/loss_all_step=0.0782, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.0782, Train/loss_recog_step=1.330, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  55%|█████▌    | 550/1000 [32:08<26:17,  0.29it/s, v_num=0, Train/loss_all_step=0.0782, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.0782, Train/loss_recog_step=1.330, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  55%|█████▌    | 550/1000 [32:08<26:17,  0.29it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.308, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=1.420, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  60%|██████    | 600/1000 [35:05<23:23,  0.29it/s, v_num=0, Train/loss_all_step=0.0162, Train/loss_unet_all_step=0.308, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=1.420, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  60%|██████    | 600/1000 [35:05<23:23,  0.29it/s, v_num=0, Train/loss_all_step=0.0488, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.0488, Train/loss_recog_step=1.480, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  65%|██████▌   | 650/1000 [37:59<20:27,  0.29it/s, v_num=0, Train/loss_all_step=0.0488, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.0488, Train/loss_recog_step=1.480, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  65%|██████▌   | 650/1000 [37:59<20:27,  0.29it/s, v_num=0, Train/loss_all_step=0.00817, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.00817, Train/loss_recog_step=1.360, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  70%|███████   | 700/1000 [40:51<17:30,  0.29it/s, v_num=0, Train/loss_all_step=0.00817, Train/loss_unet_all_step=0.355, Train/loss_triplet_all_step=0.00817, Train/loss_recog_step=1.360, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  70%|███████   | 700/1000 [40:51<17:30,  0.29it/s, v_num=0, Train/loss_all_step=0.0347, Train/loss_unet_all_step=0.262, Train/loss_triplet_all_step=0.0347, Train/loss_recog_step=1.360, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]  Epoch 14:  75%|███████▌  | 750/1000 [43:45<14:35,  0.29it/s, v_num=0, Train/loss_all_step=0.0347, Train/loss_unet_all_step=0.262, Train/loss_triplet_all_step=0.0347, Train/loss_recog_step=1.360, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  75%|███████▌  | 750/1000 [43:45<14:35,  0.29it/s, v_num=0, Train/loss_all_step=0.00166, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.00166, Train/loss_recog_step=1.290, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  80%|████████  | 800/1000 [46:35<11:38,  0.29it/s, v_num=0, Train/loss_all_step=0.00166, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.00166, Train/loss_recog_step=1.290, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  80%|████████  | 800/1000 [46:35<11:38,  0.29it/s, v_num=0, Train/loss_all_step=0.00393, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=1.180, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  85%|████████▌ | 850/1000 [49:23<08:42,  0.29it/s, v_num=0, Train/loss_all_step=0.00393, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=1.180, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  85%|████████▌ | 850/1000 [49:23<08:42,  0.29it/s, v_num=0, Train/loss_all_step=0.0151, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.0151, Train/loss_recog_step=1.370, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]  Epoch 14:  90%|█████████ | 900/1000 [52:16<05:48,  0.29it/s, v_num=0, Train/loss_all_step=0.0151, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.0151, Train/loss_recog_step=1.370, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  90%|█████████ | 900/1000 [52:16<05:48,  0.29it/s, v_num=0, Train/loss_all_step=0.0406, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.0406, Train/loss_recog_step=1.370, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  95%|█████████▌| 950/1000 [55:12<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.0406, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.0406, Train/loss_recog_step=1.370, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14:  95%|█████████▌| 950/1000 [55:12<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.0447, Train/loss_unet_all_step=0.308, Train/loss_triplet_all_step=0.0447, Train/loss_recog_step=1.220, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14: 100%|██████████| 1000/1000 [58:06<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0447, Train/loss_unet_all_step=0.308, Train/loss_triplet_all_step=0.0447, Train/loss_recog_step=1.220, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14: 100%|██████████| 1000/1000 [58:06<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=1.320, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.306, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.193, Valid/loss_unet_all_epoch=0.303, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.568, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:20<00:00,  0.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:15<00:00,  0.52it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078647, 0.085068, 0.084062, 0.053898
Valid average loss UNet                 (all)                : 0.301676

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070620, 1.672921, 2.436385
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.137302, 1.181111, 1.301080
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.339241, 1.910341, 2.006318
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.175591, 1.763053, 1.987438
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.306403, 1.927314, 1.977258
Valid average loss all      (Triplet)                 : 0.207387

== Recognize ==
Valid average loss Recognize     : 1.276004
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.207387

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.512755155563354 sec. =
Valid knn accuracy drums     : 81.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.81171202659607 sec. =
Valid knn accuracy bass      : 21.572580645161292%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.857686042785645 sec. =
Valid knn accuracy piano     : 44.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.198916673660278 sec. =
Valid knn accuracy guitar    : 56.69642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.725158452987671 sec. =
Valid knn accuracy residuals : 78.86363636363637%

Valid knn accuracy average   : 56.515523681262636%

                                                                      [AEpoch 14: 100%|██████████| 1000/1000 [1:01:36<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=1.320, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0554, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0554, Train/loss_recog_epoch=1.240]Epoch 14: 100%|██████████| 1000/1000 [1:01:36<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=1.320, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082194, 0.082091, 0.082348, 0.064987
Train average loss UNet                 (all)                : 0.311620

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.012737, 1.452507, 2.565636
Train average loss bass     (Triplet, dist_p, dist_n) : 0.079297, 1.451934, 1.762896
Train average loss piano    (Triplet, dist_p, dist_n) : 0.048488, 1.574590, 2.060532
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.044518, 1.570688, 2.089898
Train average loss residuals(Triplet, dist_p, dist_n) : 0.031699, 1.667999, 2.313821
Train average loss all      (Triplet)                 : 0.043947

== Recognize ==
Train average loss Recognize     : 1.291040
Train average accuracy drums     : 49.270000 %
Train average accuracy bass      : 49.450001 %
Train average accuracy piano     : 50.370003 %
Train average accuracy guitar    : 49.344997 %
Train average accuracy residuals : 49.649998 %

== Train average loss all : 0.043947

Epoch 14:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=1.320, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]             Epoch 15:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=1.320, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:   5%|▌         | 50/1000 [03:03<57:58,  0.27it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=1.320, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:   5%|▌         | 50/1000 [03:03<57:58,  0.27it/s, v_num=0, Train/loss_all_step=0.0552, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.0552, Train/loss_recog_step=1.310, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  10%|█         | 100/1000 [05:58<53:43,  0.28it/s, v_num=0, Train/loss_all_step=0.0552, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.0552, Train/loss_recog_step=1.310, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  10%|█         | 100/1000 [05:58<53:43,  0.28it/s, v_num=0, Train/loss_all_step=0.0257, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.0257, Train/loss_recog_step=1.520, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  15%|█▌        | 150/1000 [08:54<50:30,  0.28it/s, v_num=0, Train/loss_all_step=0.0257, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.0257, Train/loss_recog_step=1.520, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  15%|█▌        | 150/1000 [08:54<50:30,  0.28it/s, v_num=0, Train/loss_all_step=0.0215, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=1.220, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  20%|██        | 200/1000 [11:53<47:35,  0.28it/s, v_num=0, Train/loss_all_step=0.0215, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=1.220, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  20%|██        | 200/1000 [11:53<47:35,  0.28it/s, v_num=0, Train/loss_all_step=0.0557, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.0557, Train/loss_recog_step=1.190, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  25%|██▌       | 250/1000 [14:50<44:30,  0.28it/s, v_num=0, Train/loss_all_step=0.0557, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.0557, Train/loss_recog_step=1.190, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  25%|██▌       | 250/1000 [14:50<44:30,  0.28it/s, v_num=0, Train/loss_all_step=0.0396, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.0396, Train/loss_recog_step=1.430, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  30%|███       | 300/1000 [17:40<41:13,  0.28it/s, v_num=0, Train/loss_all_step=0.0396, Train/loss_unet_all_step=0.335, Train/loss_triplet_all_step=0.0396, Train/loss_recog_step=1.430, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  30%|███       | 300/1000 [17:40<41:13,  0.28it/s, v_num=0, Train/loss_all_step=0.00927, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.00927, Train/loss_recog_step=1.160, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  35%|███▌      | 350/1000 [20:27<38:00,  0.29it/s, v_num=0, Train/loss_all_step=0.00927, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.00927, Train/loss_recog_step=1.160, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  35%|███▌      | 350/1000 [20:27<38:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0261, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.0261, Train/loss_recog_step=1.190, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]  Epoch 15:  40%|████      | 400/1000 [23:17<34:56,  0.29it/s, v_num=0, Train/loss_all_step=0.0261, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.0261, Train/loss_recog_step=1.190, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  40%|████      | 400/1000 [23:17<34:56,  0.29it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.0684, Train/loss_recog_step=1.370, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  45%|████▌     | 450/1000 [26:13<32:03,  0.29it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.0684, Train/loss_recog_step=1.370, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  45%|████▌     | 450/1000 [26:13<32:03,  0.29it/s, v_num=0, Train/loss_all_step=0.00828, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.00828, Train/loss_recog_step=1.230, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  50%|█████     | 500/1000 [29:13<29:13,  0.29it/s, v_num=0, Train/loss_all_step=0.00828, Train/loss_unet_all_step=0.298, Train/loss_triplet_all_step=0.00828, Train/loss_recog_step=1.230, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  50%|█████     | 500/1000 [29:13<29:13,  0.29it/s, v_num=0, Train/loss_all_step=0.0483, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.0483, Train/loss_recog_step=1.330, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]  Epoch 15:  55%|█████▌    | 550/1000 [32:10<26:19,  0.28it/s, v_num=0, Train/loss_all_step=0.0483, Train/loss_unet_all_step=0.327, Train/loss_triplet_all_step=0.0483, Train/loss_recog_step=1.330, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  55%|█████▌    | 550/1000 [32:10<26:19,  0.28it/s, v_num=0, Train/loss_all_step=0.0308, Train/loss_unet_all_step=0.310, Train/loss_triplet_all_step=0.0308, Train/loss_recog_step=1.400, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  60%|██████    | 600/1000 [35:09<23:26,  0.28it/s, v_num=0, Train/loss_all_step=0.0308, Train/loss_unet_all_step=0.310, Train/loss_triplet_all_step=0.0308, Train/loss_recog_step=1.400, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  60%|██████    | 600/1000 [35:09<23:26,  0.28it/s, v_num=0, Train/loss_all_step=0.0368, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.0368, Train/loss_recog_step=1.230, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  65%|██████▌   | 650/1000 [38:04<20:29,  0.28it/s, v_num=0, Train/loss_all_step=0.0368, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.0368, Train/loss_recog_step=1.230, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  65%|██████▌   | 650/1000 [38:04<20:29,  0.28it/s, v_num=0, Train/loss_all_step=0.0348, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.0348, Train/loss_recog_step=1.080, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  70%|███████   | 700/1000 [40:56<17:32,  0.29it/s, v_num=0, Train/loss_all_step=0.0348, Train/loss_unet_all_step=0.365, Train/loss_triplet_all_step=0.0348, Train/loss_recog_step=1.080, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  70%|███████   | 700/1000 [40:56<17:32,  0.29it/s, v_num=0, Train/loss_all_step=0.0425, Train/loss_unet_all_step=0.260, Train/loss_triplet_all_step=0.0425, Train/loss_recog_step=1.240, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  75%|███████▌  | 750/1000 [43:53<14:37,  0.28it/s, v_num=0, Train/loss_all_step=0.0425, Train/loss_unet_all_step=0.260, Train/loss_triplet_all_step=0.0425, Train/loss_recog_step=1.240, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  75%|███████▌  | 750/1000 [43:53<14:37,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]  Epoch 15:  80%|████████  | 800/1000 [46:51<11:42,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  80%|████████  | 800/1000 [46:51<11:42,  0.28it/s, v_num=0, Train/loss_all_step=0.00923, Train/loss_unet_all_step=0.252, Train/loss_triplet_all_step=0.00923, Train/loss_recog_step=1.410, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  85%|████████▌ | 850/1000 [49:46<08:47,  0.28it/s, v_num=0, Train/loss_all_step=0.00923, Train/loss_unet_all_step=0.252, Train/loss_triplet_all_step=0.00923, Train/loss_recog_step=1.410, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  85%|████████▌ | 850/1000 [49:46<08:47,  0.28it/s, v_num=0, Train/loss_all_step=0.0555, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.0555, Train/loss_recog_step=1.350, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]  Epoch 15:  90%|█████████ | 900/1000 [52:36<05:50,  0.29it/s, v_num=0, Train/loss_all_step=0.0555, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.0555, Train/loss_recog_step=1.350, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  90%|█████████ | 900/1000 [52:36<05:50,  0.29it/s, v_num=0, Train/loss_all_step=0.0313, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.0313, Train/loss_recog_step=1.180, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  95%|█████████▌| 950/1000 [55:23<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.0313, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.0313, Train/loss_recog_step=1.180, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15:  95%|█████████▌| 950/1000 [55:23<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.170, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15: 100%|██████████| 1000/1000 [58:16<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.170, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15: 100%|██████████| 1000/1000 [58:16<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0496, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.0496, Train/loss_recog_step=1.330, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.303, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:20<00:00,  0.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:15<00:00,  0.52it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.52it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.49it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078592, 0.085047, 0.084002, 0.054249
Valid average loss UNet                 (all)                : 0.301889

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.126111, 1.978921, 2.773938
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.173766, 1.437076, 1.543765
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.331578, 2.264716, 2.426272
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.190444, 1.987086, 2.322255
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.191646, 2.164632, 2.383466
Valid average loss all      (Triplet)                 : 0.203710

== Recognize ==
Valid average loss Recognize     : 1.257142
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.203710

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.904961585998535 sec. =
Valid knn accuracy drums     : 78.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.66881775856018 sec. =
Valid knn accuracy bass      : 22.379032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.77426290512085 sec. =
Valid knn accuracy piano     : 46.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.12575387954712 sec. =
Valid knn accuracy guitar    : 56.69642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.460731029510498 sec. =
Valid knn accuracy residuals : 77.5%

Valid knn accuracy average   : 56.29878781807254%

                                                                      [AEpoch 15: 100%|██████████| 1000/1000 [1:01:48<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0496, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.0496, Train/loss_recog_step=1.330, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0439, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0439, Train/loss_recog_epoch=1.290]Epoch 15: 100%|██████████| 1000/1000 [1:01:48<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0496, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.0496, Train/loss_recog_step=1.330, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082179, 0.082083, 0.082336, 0.065404
Train average loss UNet                 (all)                : 0.312001

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.010635, 1.704454, 3.010717
Train average loss bass     (Triplet, dist_p, dist_n) : 0.065002, 1.713798, 2.103849
Train average loss piano    (Triplet, dist_p, dist_n) : 0.042515, 1.855757, 2.428352
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.036495, 1.810342, 2.437260
Train average loss residuals(Triplet, dist_p, dist_n) : 0.023090, 1.941917, 2.718489
Train average loss all      (Triplet)                 : 0.036211

== Recognize ==
Train average loss Recognize     : 1.309663
Train average accuracy drums     : 50.875004 %
Train average accuracy bass      : 49.724998 %
Train average accuracy piano     : 49.424999 %
Train average accuracy guitar    : 50.150002 %
Train average accuracy residuals : 49.610001 %

== Train average loss all : 0.036211

Epoch 15:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0496, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.0496, Train/loss_recog_step=1.330, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]             Epoch 16:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0496, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.0496, Train/loss_recog_step=1.330, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:   5%|▌         | 50/1000 [03:01<57:29,  0.28it/s, v_num=0, Train/loss_all_step=0.0496, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.0496, Train/loss_recog_step=1.330, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:   5%|▌         | 50/1000 [03:01<57:29,  0.28it/s, v_num=0, Train/loss_all_step=0.0276, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.0276, Train/loss_recog_step=1.400, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  10%|█         | 100/1000 [05:57<53:40,  0.28it/s, v_num=0, Train/loss_all_step=0.0276, Train/loss_unet_all_step=0.341, Train/loss_triplet_all_step=0.0276, Train/loss_recog_step=1.400, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  10%|█         | 100/1000 [05:57<53:40,  0.28it/s, v_num=0, Train/loss_all_step=0.0341, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.0341, Train/loss_recog_step=1.350, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  15%|█▌        | 150/1000 [08:54<50:29,  0.28it/s, v_num=0, Train/loss_all_step=0.0341, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.0341, Train/loss_recog_step=1.350, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  15%|█▌        | 150/1000 [08:54<50:29,  0.28it/s, v_num=0, Train/loss_all_step=0.0092, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.0092, Train/loss_recog_step=1.370, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  20%|██        | 200/1000 [11:51<47:27,  0.28it/s, v_num=0, Train/loss_all_step=0.0092, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.0092, Train/loss_recog_step=1.370, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  20%|██        | 200/1000 [11:51<47:27,  0.28it/s, v_num=0, Train/loss_all_step=0.0249, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.0249, Train/loss_recog_step=1.240, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  25%|██▌       | 250/1000 [14:51<44:33,  0.28it/s, v_num=0, Train/loss_all_step=0.0249, Train/loss_unet_all_step=0.342, Train/loss_triplet_all_step=0.0249, Train/loss_recog_step=1.240, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  25%|██▌       | 250/1000 [14:51<44:33,  0.28it/s, v_num=0, Train/loss_all_step=0.0737, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0737, Train/loss_recog_step=1.200, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  30%|███       | 300/1000 [17:50<41:38,  0.28it/s, v_num=0, Train/loss_all_step=0.0737, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0737, Train/loss_recog_step=1.200, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  30%|███       | 300/1000 [17:50<41:38,  0.28it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.00341, Train/loss_recog_step=1.270, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  35%|███▌      | 350/1000 [20:45<38:32,  0.28it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.00341, Train/loss_recog_step=1.270, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  35%|███▌      | 350/1000 [20:45<38:32,  0.28it/s, v_num=0, Train/loss_all_step=0.0468, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.0468, Train/loss_recog_step=1.350, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]  Epoch 16:  40%|████      | 400/1000 [23:35<35:23,  0.28it/s, v_num=0, Train/loss_all_step=0.0468, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.0468, Train/loss_recog_step=1.350, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  40%|████      | 400/1000 [23:35<35:23,  0.28it/s, v_num=0, Train/loss_all_step=0.0758, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=1.420, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  45%|████▌     | 450/1000 [26:24<32:16,  0.28it/s, v_num=0, Train/loss_all_step=0.0758, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=1.420, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  45%|████▌     | 450/1000 [26:24<32:16,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]  Epoch 16:  50%|█████     | 500/1000 [29:16<29:16,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  50%|█████     | 500/1000 [29:16<29:16,  0.28it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.0604, Train/loss_recog_step=1.430, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  55%|█████▌    | 550/1000 [32:11<26:20,  0.28it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.332, Train/loss_triplet_all_step=0.0604, Train/loss_recog_step=1.430, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  55%|█████▌    | 550/1000 [32:11<26:20,  0.28it/s, v_num=0, Train/loss_all_step=0.0522, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.0522, Train/loss_recog_step=1.430, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  60%|██████    | 600/1000 [35:06<23:24,  0.28it/s, v_num=0, Train/loss_all_step=0.0522, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.0522, Train/loss_recog_step=1.430, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  60%|██████    | 600/1000 [35:06<23:24,  0.28it/s, v_num=0, Train/loss_all_step=0.00938, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.00938, Train/loss_recog_step=1.260, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  65%|██████▌   | 650/1000 [37:57<20:26,  0.29it/s, v_num=0, Train/loss_all_step=0.00938, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.00938, Train/loss_recog_step=1.260, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  65%|██████▌   | 650/1000 [37:57<20:26,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]    Epoch 16:  70%|███████   | 700/1000 [40:52<17:30,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  70%|███████   | 700/1000 [40:52<17:30,  0.29it/s, v_num=0, Train/loss_all_step=0.0397, Train/loss_unet_all_step=0.256, Train/loss_triplet_all_step=0.0397, Train/loss_recog_step=1.270, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  75%|███████▌  | 750/1000 [43:49<14:36,  0.29it/s, v_num=0, Train/loss_all_step=0.0397, Train/loss_unet_all_step=0.256, Train/loss_triplet_all_step=0.0397, Train/loss_recog_step=1.270, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  75%|███████▌  | 750/1000 [43:49<14:36,  0.29it/s, v_num=0, Train/loss_all_step=0.0371, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.0371, Train/loss_recog_step=1.710, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  80%|████████  | 800/1000 [46:46<11:41,  0.29it/s, v_num=0, Train/loss_all_step=0.0371, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.0371, Train/loss_recog_step=1.710, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  80%|████████  | 800/1000 [46:46<11:41,  0.29it/s, v_num=0, Train/loss_all_step=0.0217, Train/loss_unet_all_step=0.249, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=1.490, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  85%|████████▌ | 850/1000 [49:42<08:46,  0.29it/s, v_num=0, Train/loss_all_step=0.0217, Train/loss_unet_all_step=0.249, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=1.490, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  85%|████████▌ | 850/1000 [49:42<08:46,  0.29it/s, v_num=0, Train/loss_all_step=0.0588, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.0588, Train/loss_recog_step=1.400, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  90%|█████████ | 900/1000 [52:38<05:50,  0.28it/s, v_num=0, Train/loss_all_step=0.0588, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.0588, Train/loss_recog_step=1.400, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  90%|█████████ | 900/1000 [52:38<05:50,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]  Epoch 16:  95%|█████████▌| 950/1000 [55:33<02:55,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16:  95%|█████████▌| 950/1000 [55:33<02:55,  0.29it/s, v_num=0, Train/loss_all_step=0.0541, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.0541, Train/loss_recog_step=1.430, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16: 100%|██████████| 1000/1000 [58:19<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0541, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.0541, Train/loss_recog_step=1.430, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16: 100%|██████████| 1000/1000 [58:19<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0321, Train/loss_unet_all_step=0.277, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=1.410, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.295, Valid/loss_triplet_all_step=0.112, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.302, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.563, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:13<00:00,  0.57it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:13<00:00,  0.58it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:13<00:00,  0.52it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:12<00:00,  0.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078669, 0.085137, 0.084077, 0.051241
Valid average loss UNet                 (all)                : 0.299123

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.081455, 2.229003, 3.360783
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.241323, 1.697481, 1.726026
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.272858, 2.566411, 2.738764
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.140248, 2.257758, 2.663793
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.229773, 2.436485, 2.646869
Valid average loss all      (Triplet)                 : 0.201330

== Recognize ==
Valid average loss Recognize     : 1.211975
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.201330

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.630902528762817 sec. =
Valid knn accuracy drums     : 82.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.46981167793274 sec. =
Valid knn accuracy bass      : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.856914758682251 sec. =
Valid knn accuracy piano     : 45.703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.152008533477783 sec. =
Valid knn accuracy guitar    : 48.88392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.555654048919678 sec. =
Valid knn accuracy residuals : 76.36363636363637%

Valid knn accuracy average   : 55.755355378317326%

                                                                      [AEpoch 16: 100%|██████████| 1000/1000 [1:01:39<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0321, Train/loss_unet_all_step=0.277, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=1.310]Epoch 16: 100%|██████████| 1000/1000 [1:01:39<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0321, Train/loss_unet_all_step=0.277, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082163, 0.082062, 0.082316, 0.065429
Train average loss UNet                 (all)                : 0.311969

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.012017, 1.955313, 3.475094
Train average loss bass     (Triplet, dist_p, dist_n) : 0.055862, 1.940253, 2.399655
Train average loss piano    (Triplet, dist_p, dist_n) : 0.031975, 2.101099, 2.791629
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.027451, 2.059427, 2.781832
Train average loss residuals(Triplet, dist_p, dist_n) : 0.023616, 2.200376, 3.056051
Train average loss all      (Triplet)                 : 0.031378

== Recognize ==
Train average loss Recognize     : 1.330173
Train average accuracy drums     : 50.580002 %
Train average accuracy bass      : 50.169998 %
Train average accuracy piano     : 49.970001 %
Train average accuracy guitar    : 50.089996 %
Train average accuracy residuals : 49.910000 %

== Train average loss all : 0.031378

Epoch 16:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0321, Train/loss_unet_all_step=0.277, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]             Epoch 17:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0321, Train/loss_unet_all_step=0.277, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:   5%|▌         | 50/1000 [02:58<56:30,  0.28it/s, v_num=0, Train/loss_all_step=0.0321, Train/loss_unet_all_step=0.277, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:   5%|▌         | 50/1000 [02:58<56:30,  0.28it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.0176, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  10%|█         | 100/1000 [05:56<53:30,  0.28it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.345, Train/loss_triplet_all_step=0.0176, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  10%|█         | 100/1000 [05:56<53:30,  0.28it/s, v_num=0, Train/loss_all_step=0.0323, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.0323, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  15%|█▌        | 150/1000 [08:53<50:23,  0.28it/s, v_num=0, Train/loss_all_step=0.0323, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.0323, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  15%|█▌        | 150/1000 [08:53<50:23,  0.28it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.0182, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  20%|██        | 200/1000 [11:49<47:19,  0.28it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.0182, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  20%|██        | 200/1000 [11:49<47:19,  0.28it/s, v_num=0, Train/loss_all_step=0.00373, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.00373, Train/loss_recog_step=1.550, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  25%|██▌       | 250/1000 [14:48<44:25,  0.28it/s, v_num=0, Train/loss_all_step=0.00373, Train/loss_unet_all_step=0.315, Train/loss_triplet_all_step=0.00373, Train/loss_recog_step=1.550, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  25%|██▌       | 250/1000 [14:48<44:25,  0.28it/s, v_num=0, Train/loss_all_step=0.0213, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.0213, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]  Epoch 17:  30%|███       | 300/1000 [17:46<41:27,  0.28it/s, v_num=0, Train/loss_all_step=0.0213, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.0213, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  30%|███       | 300/1000 [17:46<41:27,  0.28it/s, v_num=0, Train/loss_all_step=0.0388, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.0388, Train/loss_recog_step=1.490, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  35%|███▌      | 350/1000 [20:42<38:27,  0.28it/s, v_num=0, Train/loss_all_step=0.0388, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.0388, Train/loss_recog_step=1.490, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  35%|███▌      | 350/1000 [20:42<38:27,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]  Epoch 17:  40%|████      | 400/1000 [23:41<35:32,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.294, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  40%|████      | 400/1000 [23:41<35:32,  0.28it/s, v_num=0, Train/loss_all_step=0.0789, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.0789, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  45%|████▌     | 450/1000 [26:39<32:34,  0.28it/s, v_num=0, Train/loss_all_step=0.0789, Train/loss_unet_all_step=0.322, Train/loss_triplet_all_step=0.0789, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  45%|████▌     | 450/1000 [26:39<32:34,  0.28it/s, v_num=0, Train/loss_all_step=0.0193, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  50%|█████     | 500/1000 [29:31<29:31,  0.28it/s, v_num=0, Train/loss_all_step=0.0193, Train/loss_unet_all_step=0.284, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  50%|█████     | 500/1000 [29:31<29:31,  0.28it/s, v_num=0, Train/loss_all_step=0.0348, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.0348, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  55%|█████▌    | 550/1000 [32:18<26:26,  0.28it/s, v_num=0, Train/loss_all_step=0.0348, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.0348, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  55%|█████▌    | 550/1000 [32:18<26:26,  0.28it/s, v_num=0, Train/loss_all_step=0.0455, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.0455, Train/loss_recog_step=1.440, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  60%|██████    | 600/1000 [35:05<23:23,  0.28it/s, v_num=0, Train/loss_all_step=0.0455, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.0455, Train/loss_recog_step=1.440, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  60%|██████    | 600/1000 [35:05<23:23,  0.28it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  65%|██████▌   | 650/1000 [37:56<20:25,  0.29it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  65%|██████▌   | 650/1000 [37:56<20:25,  0.29it/s, v_num=0, Train/loss_all_step=0.0972, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.0972, Train/loss_recog_step=1.440, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  70%|███████   | 700/1000 [40:53<17:31,  0.29it/s, v_num=0, Train/loss_all_step=0.0972, Train/loss_unet_all_step=0.363, Train/loss_triplet_all_step=0.0972, Train/loss_recog_step=1.440, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  70%|███████   | 700/1000 [40:53<17:31,  0.29it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.261, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=1.540, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  75%|███████▌  | 750/1000 [43:50<14:36,  0.29it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.261, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=1.540, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  75%|███████▌  | 750/1000 [43:50<14:36,  0.29it/s, v_num=0, Train/loss_all_step=0.00901, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00901, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  80%|████████  | 800/1000 [46:46<11:41,  0.29it/s, v_num=0, Train/loss_all_step=0.00901, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00901, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  80%|████████  | 800/1000 [46:46<11:41,  0.29it/s, v_num=0, Train/loss_all_step=0.0262, Train/loss_unet_all_step=0.259, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]  Epoch 17:  85%|████████▌ | 850/1000 [49:42<08:46,  0.28it/s, v_num=0, Train/loss_all_step=0.0262, Train/loss_unet_all_step=0.259, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  85%|████████▌ | 850/1000 [49:42<08:46,  0.28it/s, v_num=0, Train/loss_all_step=0.00118, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.00118, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  90%|█████████ | 900/1000 [52:39<05:51,  0.28it/s, v_num=0, Train/loss_all_step=0.00118, Train/loss_unet_all_step=0.339, Train/loss_triplet_all_step=0.00118, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  90%|█████████ | 900/1000 [52:39<05:51,  0.28it/s, v_num=0, Train/loss_all_step=0.0271, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0271, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]  Epoch 17:  95%|█████████▌| 950/1000 [55:37<02:55,  0.28it/s, v_num=0, Train/loss_all_step=0.0271, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0271, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17:  95%|█████████▌| 950/1000 [55:37<02:55,  0.28it/s, v_num=0, Train/loss_all_step=0.034, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.034, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]  Epoch 17: 100%|██████████| 1000/1000 [58:31<00:00,  0.28it/s, v_num=0, Train/loss_all_step=0.034, Train/loss_unet_all_step=0.306, Train/loss_triplet_all_step=0.034, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17: 100%|██████████| 1000/1000 [58:31<00:00,  0.28it/s, v_num=0, Train/loss_all_step=0.0519, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.0519, Train/loss_recog_step=1.460, Valid/loss_all_step=0.0779, Valid/loss_unet_all_step=0.297, Valid/loss_triplet_all_step=0.0779, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.201, Valid/loss_unet_all_epoch=0.299, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:20<00:00,  0.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.52it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078590, 0.085005, 0.084003, 0.053515
Valid average loss UNet                 (all)                : 0.301112

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.107300, 2.308336, 3.705098
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.237456, 1.787117, 1.831120
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.409647, 2.732595, 2.817490
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.145370, 2.366571, 2.800085
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.326932, 2.620560, 2.670012
Valid average loss all      (Triplet)                 : 0.252702

== Recognize ==
Valid average loss Recognize     : 1.275815
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.252702

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.769665479660034 sec. =
Valid knn accuracy drums     : 81.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.055975914001465 sec. =
Valid knn accuracy bass      : 21.370967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.66799020767212 sec. =
Valid knn accuracy piano     : 45.8984375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.026980638504028 sec. =
Valid knn accuracy guitar    : 51.78571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.700804233551025 sec. =
Valid knn accuracy residuals : 76.36363636363637%

Valid knn accuracy average   : 55.47505552608332%

                                                                      [AEpoch 17: 100%|██████████| 1000/1000 [1:02:02<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0519, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.0519, Train/loss_recog_step=1.460, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.0314, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0314, Train/loss_recog_epoch=1.330]Epoch 17: 100%|██████████| 1000/1000 [1:02:02<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0519, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.0519, Train/loss_recog_step=1.460, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082193, 0.082092, 0.082339, 0.065413
Train average loss UNet                 (all)                : 0.312037

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006937, 2.143680, 3.810221
Train average loss bass     (Triplet, dist_p, dist_n) : 0.050964, 2.167559, 2.698201
Train average loss piano    (Triplet, dist_p, dist_n) : 0.029673, 2.329615, 3.101331
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.026146, 2.304767, 3.121058
Train average loss residuals(Triplet, dist_p, dist_n) : 0.018533, 2.419654, 3.377147
Train average loss all      (Triplet)                 : 0.027036

== Recognize ==
Train average loss Recognize     : 1.362836
Train average accuracy drums     : 49.865002 %
Train average accuracy bass      : 50.290001 %
Train average accuracy piano     : 50.174999 %
Train average accuracy guitar    : 49.775002 %
Train average accuracy residuals : 50.285000 %

== Train average loss all : 0.027036

Epoch 17:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0519, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.0519, Train/loss_recog_step=1.460, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]             Epoch 18:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0519, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.0519, Train/loss_recog_step=1.460, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:   5%|▌         | 50/1000 [02:53<55:02,  0.29it/s, v_num=0, Train/loss_all_step=0.0519, Train/loss_unet_all_step=0.275, Train/loss_triplet_all_step=0.0519, Train/loss_recog_step=1.460, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:   5%|▌         | 50/1000 [02:53<55:02,  0.29it/s, v_num=0, Train/loss_all_step=0.00136, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.00136, Train/loss_recog_step=1.320, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  10%|█         | 100/1000 [05:42<51:21,  0.29it/s, v_num=0, Train/loss_all_step=0.00136, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.00136, Train/loss_recog_step=1.320, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  10%|█         | 100/1000 [05:42<51:21,  0.29it/s, v_num=0, Train/loss_all_step=0.00877, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00877, Train/loss_recog_step=1.220, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  15%|█▌        | 150/1000 [08:36<48:49,  0.29it/s, v_num=0, Train/loss_all_step=0.00877, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.00877, Train/loss_recog_step=1.220, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  15%|█▌        | 150/1000 [08:36<48:49,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]    Epoch 18:  20%|██        | 200/1000 [11:35<46:20,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  20%|██        | 200/1000 [11:35<46:20,  0.29it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.0246, Train/loss_recog_step=1.100, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  25%|██▌       | 250/1000 [14:32<43:38,  0.29it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.0246, Train/loss_recog_step=1.100, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  25%|██▌       | 250/1000 [14:32<43:38,  0.29it/s, v_num=0, Train/loss_all_step=0.0222, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.0222, Train/loss_recog_step=1.400, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  30%|███       | 300/1000 [17:27<40:43,  0.29it/s, v_num=0, Train/loss_all_step=0.0222, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.0222, Train/loss_recog_step=1.400, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  30%|███       | 300/1000 [17:27<40:43,  0.29it/s, v_num=0, Train/loss_all_step=0.0524, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.0524, Train/loss_recog_step=1.390, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  35%|███▌      | 350/1000 [20:21<37:48,  0.29it/s, v_num=0, Train/loss_all_step=0.0524, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.0524, Train/loss_recog_step=1.390, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  35%|███▌      | 350/1000 [20:21<37:48,  0.29it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=1.430, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  40%|████      | 400/1000 [23:17<34:55,  0.29it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=1.430, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  40%|████      | 400/1000 [23:17<34:55,  0.29it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.0059, Train/loss_recog_step=1.430, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  45%|████▌     | 450/1000 [26:13<32:03,  0.29it/s, v_num=0, Train/loss_all_step=0.0059, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.0059, Train/loss_recog_step=1.430, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  45%|████▌     | 450/1000 [26:13<32:03,  0.29it/s, v_num=0, Train/loss_all_step=0.00266, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.00266, Train/loss_recog_step=1.470, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  50%|█████     | 500/1000 [29:10<29:10,  0.29it/s, v_num=0, Train/loss_all_step=0.00266, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.00266, Train/loss_recog_step=1.470, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  50%|█████     | 500/1000 [29:10<29:10,  0.29it/s, v_num=0, Train/loss_all_step=0.0221, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.0221, Train/loss_recog_step=1.390, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]  Epoch 18:  55%|█████▌    | 550/1000 [32:06<26:16,  0.29it/s, v_num=0, Train/loss_all_step=0.0221, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.0221, Train/loss_recog_step=1.390, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  55%|█████▌    | 550/1000 [32:06<26:16,  0.29it/s, v_num=0, Train/loss_all_step=0.0423, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.0423, Train/loss_recog_step=1.330, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  60%|██████    | 600/1000 [34:55<23:16,  0.29it/s, v_num=0, Train/loss_all_step=0.0423, Train/loss_unet_all_step=0.313, Train/loss_triplet_all_step=0.0423, Train/loss_recog_step=1.330, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  60%|██████    | 600/1000 [34:55<23:16,  0.29it/s, v_num=0, Train/loss_all_step=0.0351, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.0351, Train/loss_recog_step=1.530, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  65%|██████▌   | 650/1000 [37:36<20:15,  0.29it/s, v_num=0, Train/loss_all_step=0.0351, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.0351, Train/loss_recog_step=1.530, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  65%|██████▌   | 650/1000 [37:36<20:15,  0.29it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=1.330, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  70%|███████   | 700/1000 [40:24<17:19,  0.29it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.350, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=1.330, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  70%|███████   | 700/1000 [40:24<17:19,  0.29it/s, v_num=0, Train/loss_all_step=0.015, Train/loss_unet_all_step=0.264, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=1.370, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]  Epoch 18:  75%|███████▌  | 750/1000 [43:23<14:27,  0.29it/s, v_num=0, Train/loss_all_step=0.015, Train/loss_unet_all_step=0.264, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=1.370, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  75%|███████▌  | 750/1000 [43:23<14:27,  0.29it/s, v_num=0, Train/loss_all_step=0.0769, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.0769, Train/loss_recog_step=0.956, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  80%|████████  | 800/1000 [46:20<11:35,  0.29it/s, v_num=0, Train/loss_all_step=0.0769, Train/loss_unet_all_step=0.354, Train/loss_triplet_all_step=0.0769, Train/loss_recog_step=0.956, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  80%|████████  | 800/1000 [46:20<11:35,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.254, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]  Epoch 18:  85%|████████▌ | 850/1000 [49:16<08:41,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.254, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  85%|████████▌ | 850/1000 [49:16<08:41,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  90%|█████████ | 900/1000 [52:11<05:47,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  90%|█████████ | 900/1000 [52:11<05:47,  0.29it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=1.340, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  95%|█████████▌| 950/1000 [55:08<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=1.340, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18:  95%|█████████▌| 950/1000 [55:08<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=1.310, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18: 100%|██████████| 1000/1000 [58:03<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=1.310, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18: 100%|██████████| 1000/1000 [58:03<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0754, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0754, Train/loss_recog_step=1.200, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.302, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.301, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.555, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:20<00:00,  0.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.53it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.53it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:14<00:00,  0.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078546, 0.084982, 0.083921, 0.049678
Valid average loss UNet                 (all)                : 0.297127

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.138449, 2.625253, 3.624294
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.245271, 1.975928, 2.037160
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.497376, 3.128181, 3.056055
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.278987, 2.698488, 2.992575
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.219919, 2.765670, 3.002564
Valid average loss all      (Triplet)                 : 0.278741

== Recognize ==
Valid average loss Recognize     : 1.341007
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 42.500000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.278741

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.656816244125366 sec. =
Valid knn accuracy drums     : 81.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.97710132598877 sec. =
Valid knn accuracy bass      : 23.18548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.76393723487854 sec. =
Valid knn accuracy piano     : 48.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.369206190109253 sec. =
Valid knn accuracy guitar    : 57.36607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.540579080581665 sec. =
Valid knn accuracy residuals : 79.0909090909091%

Valid knn accuracy average   : 57.96381896504618%

                                                                      [AEpoch 18: 100%|██████████| 1000/1000 [1:01:37<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0754, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0754, Train/loss_recog_step=1.200, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.027, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.027, Train/loss_recog_epoch=1.360]Epoch 18: 100%|██████████| 1000/1000 [1:01:37<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0754, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0754, Train/loss_recog_step=1.200, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082157, 0.082057, 0.082308, 0.065294
Train average loss UNet                 (all)                : 0.311816

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.008468, 2.296942, 4.080407
Train average loss bass     (Triplet, dist_p, dist_n) : 0.041250, 2.309010, 2.905402
Train average loss piano    (Triplet, dist_p, dist_n) : 0.025725, 2.482068, 3.313714
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.022987, 2.459049, 3.320502
Train average loss residuals(Triplet, dist_p, dist_n) : 0.016338, 2.564706, 3.600844
Train average loss all      (Triplet)                 : 0.023099

== Recognize ==
Train average loss Recognize     : 1.377867
Train average accuracy drums     : 50.370003 %
Train average accuracy bass      : 49.945000 %
Train average accuracy piano     : 50.355000 %
Train average accuracy guitar    : 49.544998 %
Train average accuracy residuals : 49.145000 %

== Train average loss all : 0.023099

Epoch 18:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0754, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0754, Train/loss_recog_step=1.200, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]             Epoch 19:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0754, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0754, Train/loss_recog_step=1.200, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:   5%|▌         | 50/1000 [03:01<57:27,  0.28it/s, v_num=0, Train/loss_all_step=0.0754, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0754, Train/loss_recog_step=1.200, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:   5%|▌         | 50/1000 [03:01<57:27,  0.28it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=1.410, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  10%|█         | 100/1000 [05:57<53:37,  0.28it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=1.410, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  10%|█         | 100/1000 [05:57<53:37,  0.28it/s, v_num=0, Train/loss_all_step=0.0048, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.0048, Train/loss_recog_step=1.540, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  15%|█▌        | 150/1000 [08:46<49:43,  0.28it/s, v_num=0, Train/loss_all_step=0.0048, Train/loss_unet_all_step=0.329, Train/loss_triplet_all_step=0.0048, Train/loss_recog_step=1.540, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  15%|█▌        | 150/1000 [08:46<49:43,  0.28it/s, v_num=0, Train/loss_all_step=0.00738, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.00738, Train/loss_recog_step=1.460, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  20%|██        | 200/1000 [11:35<46:20,  0.29it/s, v_num=0, Train/loss_all_step=0.00738, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.00738, Train/loss_recog_step=1.460, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  20%|██        | 200/1000 [11:35<46:20,  0.29it/s, v_num=0, Train/loss_all_step=0.0338, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.0338, Train/loss_recog_step=1.620, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]  Epoch 19:  25%|██▌       | 250/1000 [14:28<43:25,  0.29it/s, v_num=0, Train/loss_all_step=0.0338, Train/loss_unet_all_step=0.318, Train/loss_triplet_all_step=0.0338, Train/loss_recog_step=1.620, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  25%|██▌       | 250/1000 [14:28<43:25,  0.29it/s, v_num=0, Train/loss_all_step=0.0183, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=1.430, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  30%|███       | 300/1000 [17:25<40:40,  0.29it/s, v_num=0, Train/loss_all_step=0.0183, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=1.430, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  30%|███       | 300/1000 [17:25<40:40,  0.29it/s, v_num=0, Train/loss_all_step=0.00774, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.00774, Train/loss_recog_step=1.310, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  35%|███▌      | 350/1000 [20:24<37:53,  0.29it/s, v_num=0, Train/loss_all_step=0.00774, Train/loss_unet_all_step=0.286, Train/loss_triplet_all_step=0.00774, Train/loss_recog_step=1.310, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  35%|███▌      | 350/1000 [20:24<37:53,  0.29it/s, v_num=0, Train/loss_all_step=0.0175, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=1.440, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]  Epoch 19:  40%|████      | 400/1000 [23:21<35:01,  0.29it/s, v_num=0, Train/loss_all_step=0.0175, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=1.440, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  40%|████      | 400/1000 [23:21<35:01,  0.29it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=1.470, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  45%|████▌     | 450/1000 [26:18<32:09,  0.29it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=1.470, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  45%|████▌     | 450/1000 [26:18<32:09,  0.29it/s, v_num=0, Train/loss_all_step=0.0566, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.0566, Train/loss_recog_step=1.340, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  50%|█████     | 500/1000 [29:15<29:15,  0.28it/s, v_num=0, Train/loss_all_step=0.0566, Train/loss_unet_all_step=0.282, Train/loss_triplet_all_step=0.0566, Train/loss_recog_step=1.340, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  50%|█████     | 500/1000 [29:15<29:15,  0.28it/s, v_num=0, Train/loss_all_step=0.0454, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.0454, Train/loss_recog_step=1.370, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  55%|█████▌    | 550/1000 [32:13<26:22,  0.28it/s, v_num=0, Train/loss_all_step=0.0454, Train/loss_unet_all_step=0.334, Train/loss_triplet_all_step=0.0454, Train/loss_recog_step=1.370, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  55%|█████▌    | 550/1000 [32:13<26:22,  0.28it/s, v_num=0, Train/loss_all_step=0.0224, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.0224, Train/loss_recog_step=1.350, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  60%|██████    | 600/1000 [35:08<23:25,  0.28it/s, v_num=0, Train/loss_all_step=0.0224, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.0224, Train/loss_recog_step=1.350, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  60%|██████    | 600/1000 [35:08<23:25,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.620, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]  Epoch 19:  65%|██████▌   | 650/1000 [37:58<20:26,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.620, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  65%|██████▌   | 650/1000 [37:58<20:26,  0.29it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=1.530, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  70%|███████   | 700/1000 [40:50<17:30,  0.29it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.358, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=1.530, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  70%|███████   | 700/1000 [40:50<17:30,  0.29it/s, v_num=0, Train/loss_all_step=0.0776, Train/loss_unet_all_step=0.264, Train/loss_triplet_all_step=0.0776, Train/loss_recog_step=1.550, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  75%|███████▌  | 750/1000 [43:39<14:33,  0.29it/s, v_num=0, Train/loss_all_step=0.0776, Train/loss_unet_all_step=0.264, Train/loss_triplet_all_step=0.0776, Train/loss_recog_step=1.550, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  75%|███████▌  | 750/1000 [43:39<14:33,  0.29it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=1.340, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  80%|████████  | 800/1000 [46:27<11:36,  0.29it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=1.340, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  80%|████████  | 800/1000 [46:27<11:36,  0.29it/s, v_num=0, Train/loss_all_step=0.0521, Train/loss_unet_all_step=0.252, Train/loss_triplet_all_step=0.0521, Train/loss_recog_step=1.280, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  85%|████████▌ | 850/1000 [49:23<08:43,  0.29it/s, v_num=0, Train/loss_all_step=0.0521, Train/loss_unet_all_step=0.252, Train/loss_triplet_all_step=0.0521, Train/loss_recog_step=1.280, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  85%|████████▌ | 850/1000 [49:23<08:43,  0.29it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=1.440, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  90%|█████████ | 900/1000 [52:22<05:49,  0.29it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.338, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=1.440, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  90%|█████████ | 900/1000 [52:22<05:49,  0.29it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.00348, Train/loss_recog_step=1.310, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  95%|█████████▌| 950/1000 [55:18<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.293, Train/loss_triplet_all_step=0.00348, Train/loss_recog_step=1.310, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19:  95%|█████████▌| 950/1000 [55:18<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.0547, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.0547, Train/loss_recog_step=1.510, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]  Epoch 19: 100%|██████████| 1000/1000 [58:16<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0547, Train/loss_unet_all_step=0.304, Train/loss_triplet_all_step=0.0547, Train/loss_recog_step=1.510, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19: 100%|██████████| 1000/1000 [58:16<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.276, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:21<00:00,  0.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.54it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:15<00:00,  0.50it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.52it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:15<00:00,  0.46it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078418, 0.084867, 0.083786, 0.051371
Valid average loss UNet                 (all)                : 0.298442

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.080240, 2.630170, 4.033175
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.270222, 2.050772, 2.129472
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.474241, 3.139905, 3.223092
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.210138, 2.780653, 3.184364
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.387793, 3.190259, 3.287462
Valid average loss all      (Triplet)                 : 0.286122

== Recognize ==
Valid average loss Recognize     : 1.343755
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.286122

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.154216289520264 sec. =
Valid knn accuracy drums     : 80.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.400023698806763 sec. =
Valid knn accuracy bass      : 20.56451612903226%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.976049900054932 sec. =
Valid knn accuracy piano     : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.040014743804932 sec. =
Valid knn accuracy guitar    : 52.90178571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.319317817687988 sec. =
Valid knn accuracy residuals : 80.22727272727272%

Valid knn accuracy average   : 55.844693174987704%

                                                                      [AEpoch 19: 100%|██████████| 1000/1000 [1:01:50<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.276, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0231, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0231, Train/loss_recog_epoch=1.380]Epoch 19: 100%|██████████| 1000/1000 [1:01:50<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.276, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082169, 0.082067, 0.082317, 0.065256
Train average loss UNet                 (all)                : 0.311811

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.009699, 2.459405, 4.305079
Train average loss bass     (Triplet, dist_p, dist_n) : 0.033217, 2.474447, 3.144121
Train average loss piano    (Triplet, dist_p, dist_n) : 0.024111, 2.667534, 3.563007
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.020162, 2.616920, 3.571983
Train average loss residuals(Triplet, dist_p, dist_n) : 0.018411, 2.772082, 3.878907
Train average loss all      (Triplet)                 : 0.021625

== Recognize ==
Train average loss Recognize     : 1.392091
Train average accuracy drums     : 50.145000 %
Train average accuracy bass      : 50.244999 %
Train average accuracy piano     : 50.559998 %
Train average accuracy guitar    : 49.215000 %
Train average accuracy residuals : 50.094997 %

== Train average loss all : 0.021625

Epoch 19:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.276, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]             Epoch 20:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.276, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:   5%|▌         | 50/1000 [03:03<58:04,  0.27it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.276, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:   5%|▌         | 50/1000 [03:03<58:04,  0.27it/s, v_num=0, Train/loss_all_step=0.0363, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.0363, Train/loss_recog_step=1.460, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  10%|█         | 100/1000 [06:00<54:07,  0.28it/s, v_num=0, Train/loss_all_step=0.0363, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.0363, Train/loss_recog_step=1.460, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  10%|█         | 100/1000 [06:00<54:07,  0.28it/s, v_num=0, Train/loss_all_step=0.00173, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.00173, Train/loss_recog_step=1.510, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  15%|█▌        | 150/1000 [08:57<50:48,  0.28it/s, v_num=0, Train/loss_all_step=0.00173, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.00173, Train/loss_recog_step=1.510, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  15%|█▌        | 150/1000 [08:57<50:48,  0.28it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=1.440, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]  Epoch 20:  20%|██        | 200/1000 [11:52<47:29,  0.28it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.292, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=1.440, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  20%|██        | 200/1000 [11:52<47:29,  0.28it/s, v_num=0, Train/loss_all_step=0.0443, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.0443, Train/loss_recog_step=1.320, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  25%|██▌       | 250/1000 [14:41<44:03,  0.28it/s, v_num=0, Train/loss_all_step=0.0443, Train/loss_unet_all_step=0.320, Train/loss_triplet_all_step=0.0443, Train/loss_recog_step=1.320, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  25%|██▌       | 250/1000 [14:41<44:03,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]  Epoch 20:  30%|███       | 300/1000 [17:26<40:42,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.336, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  30%|███       | 300/1000 [17:26<40:42,  0.29it/s, v_num=0, Train/loss_all_step=0.0306, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.0306, Train/loss_recog_step=1.210, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  35%|███▌      | 350/1000 [20:16<37:38,  0.29it/s, v_num=0, Train/loss_all_step=0.0306, Train/loss_unet_all_step=0.291, Train/loss_triplet_all_step=0.0306, Train/loss_recog_step=1.210, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  35%|███▌      | 350/1000 [20:16<37:38,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]  Epoch 20:  40%|████      | 400/1000 [23:11<34:47,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.303, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  40%|████      | 400/1000 [23:11<34:47,  0.29it/s, v_num=0, Train/loss_all_step=0.0288, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.0288, Train/loss_recog_step=1.300, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  45%|████▌     | 450/1000 [26:06<31:55,  0.29it/s, v_num=0, Train/loss_all_step=0.0288, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.0288, Train/loss_recog_step=1.300, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  45%|████▌     | 450/1000 [26:06<31:55,  0.29it/s, v_num=0, Train/loss_all_step=0.0217, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=1.410, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  50%|█████     | 500/1000 [29:04<29:04,  0.29it/s, v_num=0, Train/loss_all_step=0.0217, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=1.410, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  50%|█████     | 500/1000 [29:04<29:04,  0.29it/s, v_num=0, Train/loss_all_step=0.0498, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.0498, Train/loss_recog_step=1.620, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  55%|█████▌    | 550/1000 [31:59<26:10,  0.29it/s, v_num=0, Train/loss_all_step=0.0498, Train/loss_unet_all_step=0.326, Train/loss_triplet_all_step=0.0498, Train/loss_recog_step=1.620, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  55%|█████▌    | 550/1000 [31:59<26:10,  0.29it/s, v_num=0, Train/loss_all_step=0.0092, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.0092, Train/loss_recog_step=1.440, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  60%|██████    | 600/1000 [34:52<23:15,  0.29it/s, v_num=0, Train/loss_all_step=0.0092, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.0092, Train/loss_recog_step=1.440, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  60%|██████    | 600/1000 [34:52<23:15,  0.29it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=1.340, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  65%|██████▌   | 650/1000 [37:40<20:17,  0.29it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.302, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=1.340, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  65%|██████▌   | 650/1000 [37:40<20:17,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]    Epoch 20:  70%|███████   | 700/1000 [40:38<17:25,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.348, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  70%|███████   | 700/1000 [40:38<17:25,  0.29it/s, v_num=0, Train/loss_all_step=0.00293, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.00293, Train/loss_recog_step=1.540, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  75%|███████▌  | 750/1000 [43:34<14:31,  0.29it/s, v_num=0, Train/loss_all_step=0.00293, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.00293, Train/loss_recog_step=1.540, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  75%|███████▌  | 750/1000 [43:34<14:31,  0.29it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.00917, Train/loss_recog_step=1.410, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  80%|████████  | 800/1000 [46:25<11:36,  0.29it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.337, Train/loss_triplet_all_step=0.00917, Train/loss_recog_step=1.410, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  80%|████████  | 800/1000 [46:25<11:36,  0.29it/s, v_num=0, Train/loss_all_step=0.000766, Train/loss_unet_all_step=0.260, Train/loss_triplet_all_step=0.000766, Train/loss_recog_step=1.390, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  85%|████████▌ | 850/1000 [49:11<08:40,  0.29it/s, v_num=0, Train/loss_all_step=0.000766, Train/loss_unet_all_step=0.260, Train/loss_triplet_all_step=0.000766, Train/loss_recog_step=1.390, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  85%|████████▌ | 850/1000 [49:11<08:40,  0.29it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.00644, Train/loss_recog_step=1.410, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]  Epoch 20:  90%|█████████ | 900/1000 [51:59<05:46,  0.29it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.343, Train/loss_triplet_all_step=0.00644, Train/loss_recog_step=1.410, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  90%|█████████ | 900/1000 [51:59<05:46,  0.29it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=1.390, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]  Epoch 20:  95%|█████████▌| 950/1000 [54:54<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.295, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=1.390, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20:  95%|█████████▌| 950/1000 [54:54<02:53,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.680, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]  Epoch 20: 100%|██████████| 1000/1000 [57:52<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.680, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20: 100%|██████████| 1000/1000 [57:52<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0283, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.0283, Train/loss_recog_step=1.720, Valid/loss_all_step=0.266, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.286, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.286, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:21<00:00,  0.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:15<00:00,  0.52it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.55it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.52it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.47it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078605, 0.085012, 0.083890, 0.049608
Valid average loss UNet                 (all)                : 0.297116

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098129, 2.899363, 4.216953
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.229404, 2.201473, 2.280819
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.466659, 3.318240, 3.468135
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.193682, 3.001417, 3.554824
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.241993, 3.175163, 3.406440
Valid average loss all      (Triplet)                 : 0.241057

== Recognize ==
Valid average loss Recognize     : 1.447807
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.241057

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.011803150177002 sec. =
Valid knn accuracy drums     : 77.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.008631229400635 sec. =
Valid knn accuracy bass      : 23.991935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.67285442352295 sec. =
Valid knn accuracy piano     : 47.4609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.960480213165283 sec. =
Valid knn accuracy guitar    : 54.46428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.604923963546753 sec. =
Valid knn accuracy residuals : 77.27272727272727%

Valid knn accuracy average   : 56.072759802872454%

                                                                      [AEpoch 20: 100%|██████████| 1000/1000 [1:01:21<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0283, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.0283, Train/loss_recog_step=1.720, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=1.390]Epoch 20: 100%|██████████| 1000/1000 [1:01:21<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.0283, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.0283, Train/loss_recog_step=1.720, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082143, 0.082040, 0.082294, 0.065373
Train average loss UNet                 (all)                : 0.311849

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007151, 2.580806, 4.540758
Train average loss bass     (Triplet, dist_p, dist_n) : 0.033978, 2.627032, 3.327796
Train average loss piano    (Triplet, dist_p, dist_n) : 0.022674, 2.795032, 3.742341
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.020366, 2.766650, 3.781996
Train average loss residuals(Triplet, dist_p, dist_n) : 0.015773, 2.899065, 4.064485
Train average loss all      (Triplet)                 : 0.020138

== Recognize ==
Train average loss Recognize     : 1.415572
Train average accuracy drums     : 49.619999 %
Train average accuracy bass      : 49.785000 %
Train average accuracy piano     : 50.050003 %
Train average accuracy guitar    : 50.300003 %
Train average accuracy residuals : 50.134998 %

== Train average loss all : 0.020138

Epoch 20:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0283, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.0283, Train/loss_recog_step=1.720, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]             Epoch 21:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0283, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.0283, Train/loss_recog_step=1.720, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:   5%|▌         | 50/1000 [03:01<57:22,  0.28it/s, v_num=0, Train/loss_all_step=0.0283, Train/loss_unet_all_step=0.273, Train/loss_triplet_all_step=0.0283, Train/loss_recog_step=1.720, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:   5%|▌         | 50/1000 [03:01<57:22,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]  Epoch 21:  10%|█         | 100/1000 [05:55<53:15,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.340, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  10%|█         | 100/1000 [05:55<53:15,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  15%|█▌        | 150/1000 [08:54<50:26,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.344, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  15%|█▌        | 150/1000 [08:54<50:26,  0.28it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.0128, Train/loss_recog_step=1.410, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  20%|██        | 200/1000 [11:52<47:29,  0.28it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.0128, Train/loss_recog_step=1.410, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  20%|██        | 200/1000 [11:52<47:29,  0.28it/s, v_num=0, Train/loss_all_step=0.0399, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.0399, Train/loss_recog_step=1.340, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  25%|██▌       | 250/1000 [14:49<44:28,  0.28it/s, v_num=0, Train/loss_all_step=0.0399, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.0399, Train/loss_recog_step=1.340, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  25%|██▌       | 250/1000 [14:49<44:28,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.700, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]  Epoch 21:  30%|███       | 300/1000 [17:46<41:28,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.321, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.700, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  30%|███       | 300/1000 [17:46<41:28,  0.28it/s, v_num=0, Train/loss_all_step=0.0458, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0458, Train/loss_recog_step=1.580, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  35%|███▌      | 350/1000 [20:38<38:19,  0.28it/s, v_num=0, Train/loss_all_step=0.0458, Train/loss_unet_all_step=0.289, Train/loss_triplet_all_step=0.0458, Train/loss_recog_step=1.580, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  35%|███▌      | 350/1000 [20:38<38:19,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.500, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]  Epoch 21:  40%|████      | 400/1000 [23:26<35:09,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.500, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  40%|████      | 400/1000 [23:26<35:09,  0.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  45%|████▌     | 450/1000 [26:15<32:05,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  45%|████▌     | 450/1000 [26:15<32:05,  0.29it/s, v_num=0, Train/loss_all_step=0.00567, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.00567, Train/loss_recog_step=1.720, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  50%|█████     | 500/1000 [29:10<29:10,  0.29it/s, v_num=0, Train/loss_all_step=0.00567, Train/loss_unet_all_step=0.290, Train/loss_triplet_all_step=0.00567, Train/loss_recog_step=1.720, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  50%|█████     | 500/1000 [29:10<29:10,  0.29it/s, v_num=0, Train/loss_all_step=0.0841, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.0841, Train/loss_recog_step=1.340, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]  Epoch 21:  55%|█████▌    | 550/1000 [32:07<26:17,  0.29it/s, v_num=0, Train/loss_all_step=0.0841, Train/loss_unet_all_step=0.330, Train/loss_triplet_all_step=0.0841, Train/loss_recog_step=1.340, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  55%|█████▌    | 550/1000 [32:07<26:17,  0.29it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.316, Train/loss_triplet_all_step=0.00671, Train/loss_recog_step=1.330, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  60%|██████    | 600/1000 [35:02<23:21,  0.29it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.316, Train/loss_triplet_all_step=0.00671, Train/loss_recog_step=1.330, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  60%|██████    | 600/1000 [35:02<23:21,  0.29it/s, v_num=0, Train/loss_all_step=0.0297, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.0297, Train/loss_recog_step=1.460, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]  Epoch 21:  65%|██████▌   | 650/1000 [37:50<20:22,  0.29it/s, v_num=0, Train/loss_all_step=0.0297, Train/loss_unet_all_step=0.301, Train/loss_triplet_all_step=0.0297, Train/loss_recog_step=1.460, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  65%|██████▌   | 650/1000 [37:50<20:22,  0.29it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=1.730, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  70%|███████   | 700/1000 [40:45<17:28,  0.29it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.349, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=1.730, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  70%|███████   | 700/1000 [40:45<17:28,  0.29it/s, v_num=0, Train/loss_all_step=0.00509, Train/loss_unet_all_step=0.264, Train/loss_triplet_all_step=0.00509, Train/loss_recog_step=1.700, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  75%|███████▌  | 750/1000 [43:44<14:34,  0.29it/s, v_num=0, Train/loss_all_step=0.00509, Train/loss_unet_all_step=0.264, Train/loss_triplet_all_step=0.00509, Train/loss_recog_step=1.700, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  75%|███████▌  | 750/1000 [43:44<14:34,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]    Epoch 21:  80%|████████  | 800/1000 [46:40<11:40,  0.29it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.347, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  80%|████████  | 800/1000 [46:40<11:40,  0.29it/s, v_num=0, Train/loss_all_step=0.00465, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.00465, Train/loss_recog_step=1.390, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  85%|████████▌ | 850/1000 [49:35<08:45,  0.29it/s, v_num=0, Train/loss_all_step=0.00465, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.00465, Train/loss_recog_step=1.390, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  85%|████████▌ | 850/1000 [49:35<08:45,  0.29it/s, v_num=0, Train/loss_all_step=0.0273, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.0273, Train/loss_recog_step=1.300, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]  Epoch 21:  90%|█████████ | 900/1000 [52:28<05:49,  0.29it/s, v_num=0, Train/loss_all_step=0.0273, Train/loss_unet_all_step=0.333, Train/loss_triplet_all_step=0.0273, Train/loss_recog_step=1.300, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  90%|█████████ | 900/1000 [52:28<05:49,  0.29it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=1.380, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  95%|█████████▌| 950/1000 [55:18<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.297, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=1.380, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21:  95%|█████████▌| 950/1000 [55:18<02:54,  0.29it/s, v_num=0, Train/loss_all_step=0.0461, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.0461, Train/loss_recog_step=1.450, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21: 100%|██████████| 1000/1000 [58:05<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0461, Train/loss_unet_all_step=0.305, Train/loss_triplet_all_step=0.0461, Train/loss_recog_step=1.450, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21: 100%|██████████| 1000/1000 [58:05<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.00371, Train/loss_recog_step=1.280, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.520, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.297, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=1.450, Valid/knn_avr=0.561, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:13<00:00,  0.58it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:13<00:00,  0.59it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:13<00:00,  0.58it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:14<00:00,  0.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078458, 0.084893, 0.083815, 0.050846
Valid average loss UNet                 (all)                : 0.298013

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.068479, 2.940063, 4.004566
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.256320, 2.336428, 2.385548
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.396660, 3.410750, 3.583416
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.170815, 2.994601, 3.573197
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.296584, 3.157511, 3.402770
Valid average loss all      (Triplet)                 : 0.232155

== Recognize ==
Valid average loss Recognize     : 1.494717
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 43.000000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.232155

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.669668912887573 sec. =
Valid knn accuracy drums     : 77.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.567953109741211 sec. =
Valid knn accuracy bass      : 21.572580645161292%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.701537609100342 sec. =
Valid knn accuracy piano     : 51.3671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.395405292510986 sec. =
Valid knn accuracy guitar    : 56.47321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.223651885986328 sec. =
Valid knn accuracy residuals : 80.22727272727272%

Valid knn accuracy average   : 57.44979016206444%

                                                                      [AEpoch 21: 100%|██████████| 1000/1000 [1:01:28<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.00371, Train/loss_recog_step=1.280, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.232, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.574, Train/loss_all_epoch=0.0201, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0201, Train/loss_recog_epoch=1.420]Epoch 21: 100%|██████████| 1000/1000 [1:01:28<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.00371, Train/loss_recog_step=1.280, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.232, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.574, Train/loss_all_epoch=0.0172, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0172, Train/loss_recog_epoch=1.400]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.082176, 0.082079, 0.082325, 0.065401
Train average loss UNet                 (all)                : 0.311980

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004582, 2.693801, 4.751695
Train average loss bass     (Triplet, dist_p, dist_n) : 0.031713, 2.773203, 3.536562
Train average loss piano    (Triplet, dist_p, dist_n) : 0.021308, 2.939321, 3.970557
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.015854, 2.899088, 3.997917
Train average loss residuals(Triplet, dist_p, dist_n) : 0.013542, 3.031609, 4.289334
Train average loss all      (Triplet)                 : 0.017195

== Recognize ==
Train average loss Recognize     : 1.402128
Train average accuracy drums     : 49.840000 %
Train average accuracy bass      : 50.349998 %
Train average accuracy piano     : 50.250000 %
Train average accuracy guitar    : 50.465000 %
Train average accuracy residuals : 50.075001 %

== Train average loss all : 0.017195

Epoch 21: 100%|██████████| 1000/1000 [1:01:28<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.287, Train/loss_triplet_all_step=0.00371, Train/loss_recog_step=1.280, Valid/loss_all_step=0.155, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=1.500, Valid/loss_all_epoch=0.232, Valid/loss_unet_all_epoch=0.298, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.574, Train/loss_all_epoch=0.0172, Train/loss_unet_all_epoch=0.312, Train/loss_triplet_all_epoch=0.0172, Train/loss_recog_epoch=1.400]
[2023-11-03 23:44:27,104][source.train][INFO] - [rank: 0] Starting testing!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
The length of seg for train is 3s.
The length of seg for valid and test is 3s.
----------------------------------------
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]ディレクトリを作成します
ディレクトリを作成します
ディレクトリを作成します
ディレクトリを作成します
ディレクトリを作成します
ディレクトリを作成します
Testing DataLoader 0: 100%|██████████| 16/16 [00:42<00:00,  0.37it/s]Testing DataLoader 0:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 1: 100%|██████████| 15/15 [00:35<00:00,  0.42it/s]Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 2:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 2: 100%|██████████| 15/15 [00:30<00:00,  0.49it/s]Testing DataLoader 2:   0%|          | 0/13 [00:00<?, ?it/s]         Testing DataLoader 3:   0%|          | 0/13 [00:00<?, ?it/s]Testing DataLoader 3: 100%|██████████| 13/13 [00:29<00:00,  0.44it/s]Testing DataLoader 3:   0%|          | 0/14 [00:00<?, ?it/s]         Testing DataLoader 4:   0%|          | 0/14 [00:00<?, ?it/s]Testing DataLoader 4: 100%|██████████| 14/14 [00:29<00:00,  0.47it/s]Testing DataLoader 4:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 5:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 5: 100%|██████████| 15/15 [00:31<00:00,  0.47it/s]
Test average accuracy drums     :  49.700001 %
Test average accuracy bass      :  52.100002 %
Test average accuracy piano     :  48.100002 %
Test average accuracy guitar    :  52.200001 %
Test average accuracy residuals :  49.099998 %
= T-SNE...
T-SNE was finished!
= T-SNE time is 22.292211294174194 sec. =
Test knn accuracy drums     : 54.58515283842795%
= T-SNE...
T-SNE was finished!
= T-SNE time is 22.118629217147827 sec. =
Test knn accuracy bass      : 16.389811738648948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.158724546432495 sec. =
Test knn accuracy piano     : 37.104622871046224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 21.300527334213257 sec. =
Test knn accuracy guitar    : 24.43438914027149%
= T-SNE...
T-SNE was finished!
= T-SNE time is 22.318966388702393 sec. =
Test knn accuracy residuals : 46.716899892357375%

Test knn accuracy average   : 35.8461752961504%
Testing DataLoader 5: 100%|██████████| 15/15 [02:28<00:00,  0.10it/s]
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 0    ┃   DataLoader 1    ┃   DataLoader 2   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.35846176743507… │ 0.35846176743507… │ 0.3584617674350… │
│   Test/knn_bass   │ 0.16389811038970… │ 0.16389811038970… │ 0.1638981103897… │
│  Test/knn_drums   │ 0.54585152864456… │ 0.54585152864456… │ 0.5458515286445… │
│  Test/knn_guitar  │ 0.24434389173984… │ 0.24434389173984… │ 0.2443438917398… │
│  Test/knn_piano   │ 0.37104621529579… │ 0.37104621529579… │ 0.3710462152957… │
│ Test/knn_residua… │ 0.46716898679733… │ 0.46716898679733… │ 0.4671689867973… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 3    ┃   DataLoader 4    ┃   DataLoader 5   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.35846176743507… │ 0.35846176743507… │ 0.3584617674350… │
│   Test/knn_bass   │ 0.16389811038970… │ 0.16389811038970… │ 0.1638981103897… │
│  Test/knn_drums   │ 0.54585152864456… │ 0.54585152864456… │ 0.5458515286445… │
│  Test/knn_guitar  │ 0.24434389173984… │ 0.24434389173984… │ 0.2443438917398… │
│  Test/knn_piano   │ 0.37104621529579… │ 0.37104621529579… │ 0.3710462152957… │
│ Test/knn_residua… │ 0.46716898679733… │ 0.46716898679733… │ 0.4671689867973… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
[2023-11-03 23:50:25,134][source.train][INFO] - [rank: 0] Best ckpt path: /nas02/homes/imamura23-1000067/outputs/triplet_with_unet/runs/2023-11-03/08-19-59/checkpoints/epoch_011.ckpt
[2023-11-03 23:50:25,136][utils.utils][INFO] - [rank: 0] Output dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023-11-03/08-19-59
[2023-11-03 23:50:25,141][utils.utils][INFO] - [rank: 0] Metric name is None! Skipping metric value retrieval...

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Time taken to study : 15:30:25

All prosess was Done!
